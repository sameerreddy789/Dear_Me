(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();function mN(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var lS={exports:{}},vd={};var BM;function r6(){if(BM)return vd;BM=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(r,i,s){var o=null;if(s!==void 0&&(o=""+s),i.key!==void 0&&(o=""+i.key),"key"in i){s={};for(var l in i)l!=="key"&&(s[l]=i[l])}else s=i;return i=s.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:s}}return vd.Fragment=t,vd.jsx=e,vd.jsxs=e,vd}var FM;function i6(){return FM||(FM=1,lS.exports=r6()),lS.exports}var z=i6(),cS={exports:{}},Ft={};var UM;function s6(){if(UM)return Ft;UM=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),g=Symbol.iterator;function v($){return $===null||typeof $!="object"?null:($=g&&$[g]||$["@@iterator"],typeof $=="function"?$:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,w={};function E($,ot,dt){this.props=$,this.context=ot,this.refs=w,this.updater=dt||T}E.prototype.isReactComponent={},E.prototype.setState=function($,ot){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,ot,"setState")},E.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function R(){}R.prototype=E.prototype;function P($,ot,dt){this.props=$,this.context=ot,this.refs=w,this.updater=dt||T}var j=P.prototype=new R;j.constructor=P,S(j,E.prototype),j.isPureReactComponent=!0;var N=Array.isArray;function W(){}var M={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function O($,ot,dt){var mt=dt.ref;return{$$typeof:n,type:$,key:ot,ref:mt!==void 0?mt:null,props:dt}}function B($,ot){return O($.type,ot,$.props)}function F($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function H($){var ot={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(dt){return ot[dt]})}var V=/\/+/g;function yt($,ot){return typeof $=="object"&&$!==null&&$.key!=null?H(""+$.key):ot.toString(36)}function xt($){switch($.status){case"fulfilled":return $.value;case"rejected":throw $.reason;default:switch(typeof $.status=="string"?$.then(W,W):($.status="pending",$.then(function(ot){$.status==="pending"&&($.status="fulfilled",$.value=ot)},function(ot){$.status==="pending"&&($.status="rejected",$.reason=ot)})),$.status){case"fulfilled":return $.value;case"rejected":throw $.reason}}throw $}function J($,ot,dt,mt,Dt){var It=typeof $;(It==="undefined"||It==="boolean")&&($=null);var Ut=!1;if($===null)Ut=!0;else switch(It){case"bigint":case"string":case"number":Ut=!0;break;case"object":switch($.$$typeof){case n:case t:Ut=!0;break;case d:return Ut=$._init,J(Ut($._payload),ot,dt,mt,Dt)}}if(Ut)return Dt=Dt($),Ut=mt===""?"."+yt($,0):mt,N(Dt)?(dt="",Ut!=null&&(dt=Ut.replace(V,"$&/")+"/"),J(Dt,ot,dt,"",function(Rt){return Rt})):Dt!=null&&(F(Dt)&&(Dt=B(Dt,dt+(Dt.key==null||$&&$.key===Dt.key?"":(""+Dt.key).replace(V,"$&/")+"/")+Ut)),ot.push(Dt)),1;Ut=0;var Ve=mt===""?".":mt+":";if(N($))for(var ce=0;ce<$.length;ce++)mt=$[ce],It=Ve+yt(mt,ce),Ut+=J(mt,ot,dt,It,Dt);else if(ce=v($),typeof ce=="function")for($=ce.call($),ce=0;!(mt=$.next()).done;)mt=mt.value,It=Ve+yt(mt,ce++),Ut+=J(mt,ot,dt,It,Dt);else if(It==="object"){if(typeof $.then=="function")return J(xt($),ot,dt,mt,Dt);throw ot=String($),Error("Objects are not valid as a React child (found: "+(ot==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":ot)+"). If you meant to render a collection of children, use an array instead.")}return Ut}function st($,ot,dt){if($==null)return $;var mt=[],Dt=0;return J($,mt,"","",function(It){return ot.call(dt,It,Dt++)}),mt}function ht($){if($._status===-1){var ot=$._result;ot=ot(),ot.then(function(dt){($._status===0||$._status===-1)&&($._status=1,$._result=dt)},function(dt){($._status===0||$._status===-1)&&($._status=2,$._result=dt)}),$._status===-1&&($._status=0,$._result=ot)}if($._status===1)return $._result.default;throw $._result}var Ct=typeof reportError=="function"?reportError:function($){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ot=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof $=="object"&&$!==null&&typeof $.message=="string"?String($.message):String($),error:$});if(!window.dispatchEvent(ot))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",$);return}console.error($)},Vt={map:st,forEach:function($,ot,dt){st($,function(){ot.apply(this,arguments)},dt)},count:function($){var ot=0;return st($,function(){ot++}),ot},toArray:function($){return st($,function(ot){return ot})||[]},only:function($){if(!F($))throw Error("React.Children.only expected to receive a single React element child.");return $}};return Ft.Activity=m,Ft.Children=Vt,Ft.Component=E,Ft.Fragment=e,Ft.Profiler=i,Ft.PureComponent=P,Ft.StrictMode=r,Ft.Suspense=u,Ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Ft.__COMPILER_RUNTIME={__proto__:null,c:function($){return M.H.useMemoCache($)}},Ft.cache=function($){return function(){return $.apply(null,arguments)}},Ft.cacheSignal=function(){return null},Ft.cloneElement=function($,ot,dt){if($==null)throw Error("The argument must be a React element, but you passed "+$+".");var mt=S({},$.props),Dt=$.key;if(ot!=null)for(It in ot.key!==void 0&&(Dt=""+ot.key),ot)!k.call(ot,It)||It==="key"||It==="__self"||It==="__source"||It==="ref"&&ot.ref===void 0||(mt[It]=ot[It]);var It=arguments.length-2;if(It===1)mt.children=dt;else if(1<It){for(var Ut=Array(It),Ve=0;Ve<It;Ve++)Ut[Ve]=arguments[Ve+2];mt.children=Ut}return O($.type,Dt,mt)},Ft.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null},$.Provider=$,$.Consumer={$$typeof:s,_context:$},$},Ft.createElement=function($,ot,dt){var mt,Dt={},It=null;if(ot!=null)for(mt in ot.key!==void 0&&(It=""+ot.key),ot)k.call(ot,mt)&&mt!=="key"&&mt!=="__self"&&mt!=="__source"&&(Dt[mt]=ot[mt]);var Ut=arguments.length-2;if(Ut===1)Dt.children=dt;else if(1<Ut){for(var Ve=Array(Ut),ce=0;ce<Ut;ce++)Ve[ce]=arguments[ce+2];Dt.children=Ve}if($&&$.defaultProps)for(mt in Ut=$.defaultProps,Ut)Dt[mt]===void 0&&(Dt[mt]=Ut[mt]);return O($,It,Dt)},Ft.createRef=function(){return{current:null}},Ft.forwardRef=function($){return{$$typeof:l,render:$}},Ft.isValidElement=F,Ft.lazy=function($){return{$$typeof:d,_payload:{_status:-1,_result:$},_init:ht}},Ft.memo=function($,ot){return{$$typeof:h,type:$,compare:ot===void 0?null:ot}},Ft.startTransition=function($){var ot=M.T,dt={};M.T=dt;try{var mt=$(),Dt=M.S;Dt!==null&&Dt(dt,mt),typeof mt=="object"&&mt!==null&&typeof mt.then=="function"&&mt.then(W,Ct)}catch(It){Ct(It)}finally{ot!==null&&dt.types!==null&&(ot.types=dt.types),M.T=ot}},Ft.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},Ft.use=function($){return M.H.use($)},Ft.useActionState=function($,ot,dt){return M.H.useActionState($,ot,dt)},Ft.useCallback=function($,ot){return M.H.useCallback($,ot)},Ft.useContext=function($){return M.H.useContext($)},Ft.useDebugValue=function(){},Ft.useDeferredValue=function($,ot){return M.H.useDeferredValue($,ot)},Ft.useEffect=function($,ot){return M.H.useEffect($,ot)},Ft.useEffectEvent=function($){return M.H.useEffectEvent($)},Ft.useId=function(){return M.H.useId()},Ft.useImperativeHandle=function($,ot,dt){return M.H.useImperativeHandle($,ot,dt)},Ft.useInsertionEffect=function($,ot){return M.H.useInsertionEffect($,ot)},Ft.useLayoutEffect=function($,ot){return M.H.useLayoutEffect($,ot)},Ft.useMemo=function($,ot){return M.H.useMemo($,ot)},Ft.useOptimistic=function($,ot){return M.H.useOptimistic($,ot)},Ft.useReducer=function($,ot,dt){return M.H.useReducer($,ot,dt)},Ft.useRef=function($){return M.H.useRef($)},Ft.useState=function($){return M.H.useState($)},Ft.useSyncExternalStore=function($,ot,dt){return M.H.useSyncExternalStore($,ot,dt)},Ft.useTransition=function(){return M.H.useTransition()},Ft.version="19.2.4",Ft}var zM;function Zp(){return zM||(zM=1,cS.exports=s6()),cS.exports}var L=Zp();const zc=mN(L);var uS={exports:{}},bd={},hS={exports:{}},fS={};var HM;function o6(){return HM||(HM=1,(function(n){function t(J,st){var ht=J.length;J.push(st);t:for(;0<ht;){var Ct=ht-1>>>1,Vt=J[Ct];if(0<i(Vt,st))J[Ct]=st,J[ht]=Vt,ht=Ct;else break t}}function e(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var st=J[0],ht=J.pop();if(ht!==st){J[0]=ht;t:for(var Ct=0,Vt=J.length,$=Vt>>>1;Ct<$;){var ot=2*(Ct+1)-1,dt=J[ot],mt=ot+1,Dt=J[mt];if(0>i(dt,ht))mt<Vt&&0>i(Dt,dt)?(J[Ct]=Dt,J[mt]=ht,Ct=mt):(J[Ct]=dt,J[ot]=ht,Ct=ot);else if(mt<Vt&&0>i(Dt,ht))J[Ct]=Dt,J[mt]=ht,Ct=mt;else break t}}return st}function i(J,st){var ht=J.sortIndex-st.sortIndex;return ht!==0?ht:J.id-st.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],d=1,m=null,g=3,v=!1,T=!1,S=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function j(J){for(var st=e(h);st!==null;){if(st.callback===null)r(h);else if(st.startTime<=J)r(h),st.sortIndex=st.expirationTime,t(u,st);else break;st=e(h)}}function N(J){if(S=!1,j(J),!T)if(e(u)!==null)T=!0,W||(W=!0,H());else{var st=e(h);st!==null&&xt(N,st.startTime-J)}}var W=!1,M=-1,k=5,O=-1;function B(){return w?!0:!(n.unstable_now()-O<k)}function F(){if(w=!1,W){var J=n.unstable_now();O=J;var st=!0;try{t:{T=!1,S&&(S=!1,R(M),M=-1),v=!0;var ht=g;try{e:{for(j(J),m=e(u);m!==null&&!(m.expirationTime>J&&B());){var Ct=m.callback;if(typeof Ct=="function"){m.callback=null,g=m.priorityLevel;var Vt=Ct(m.expirationTime<=J);if(J=n.unstable_now(),typeof Vt=="function"){m.callback=Vt,j(J),st=!0;break e}m===e(u)&&r(u),j(J)}else r(u);m=e(u)}if(m!==null)st=!0;else{var $=e(h);$!==null&&xt(N,$.startTime-J),st=!1}}break t}finally{m=null,g=ht,v=!1}st=void 0}}finally{st?H():W=!1}}}var H;if(typeof P=="function")H=function(){P(F)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,yt=V.port2;V.port1.onmessage=F,H=function(){yt.postMessage(null)}}else H=function(){E(F,0)};function xt(J,st){M=E(function(){J(n.unstable_now())},st)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_next=function(J){switch(g){case 1:case 2:case 3:var st=3;break;default:st=g}var ht=g;g=st;try{return J()}finally{g=ht}},n.unstable_requestPaint=function(){w=!0},n.unstable_runWithPriority=function(J,st){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ht=g;g=J;try{return st()}finally{g=ht}},n.unstable_scheduleCallback=function(J,st,ht){var Ct=n.unstable_now();switch(typeof ht=="object"&&ht!==null?(ht=ht.delay,ht=typeof ht=="number"&&0<ht?Ct+ht:Ct):ht=Ct,J){case 1:var Vt=-1;break;case 2:Vt=250;break;case 5:Vt=1073741823;break;case 4:Vt=1e4;break;default:Vt=5e3}return Vt=ht+Vt,J={id:d++,callback:st,priorityLevel:J,startTime:ht,expirationTime:Vt,sortIndex:-1},ht>Ct?(J.sortIndex=ht,t(h,J),e(u)===null&&J===e(h)&&(S?(R(M),M=-1):S=!0,xt(N,ht-Ct))):(J.sortIndex=Vt,t(u,J),T||v||(T=!0,W||(W=!0,H()))),J},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(J){var st=g;return function(){var ht=g;g=st;try{return J.apply(this,arguments)}finally{g=ht}}}})(fS)),fS}var $M;function a6(){return $M||($M=1,hS.exports=o6()),hS.exports}var dS={exports:{}},Qn={};var qM;function l6(){if(qM)return Qn;qM=1;var n=Zp();function t(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)h+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var r={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(u,h,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:m==null?null:""+m,children:u,containerInfo:h,implementation:d}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Qn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Qn.createPortal=function(u,h){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return s(u,h,null,d)},Qn.flushSync=function(u){var h=o.T,d=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=h,r.p=d,r.d.f()}},Qn.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,r.d.C(u,h))},Qn.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Qn.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var d=h.as,m=l(d,h.crossOrigin),g=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;d==="style"?r.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:m,integrity:g,fetchPriority:v}):d==="script"&&r.d.X(u,{crossOrigin:m,integrity:g,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Qn.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var d=l(h.as,h.crossOrigin);r.d.M(u,{crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&r.d.M(u)},Qn.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var d=h.as,m=l(d,h.crossOrigin);r.d.L(u,d,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Qn.preloadModule=function(u,h){if(typeof u=="string")if(h){var d=l(h.as,h.crossOrigin);r.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else r.d.m(u)},Qn.requestFormReset=function(u){r.d.r(u)},Qn.unstable_batchedUpdates=function(u,h){return u(h)},Qn.useFormState=function(u,h,d){return o.H.useFormState(u,h,d)},Qn.useFormStatus=function(){return o.H.useHostTransitionStatus()},Qn.version="19.2.4",Qn}var GM;function gN(){if(GM)return dS.exports;GM=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),dS.exports=l6(),dS.exports}var WM;function c6(){if(WM)return bd;WM=1;var n=a6(),t=Zp(),e=gN();function r(a){var c="https://react.dev/errors/"+a;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var c=a,f=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(f=c.return),a=c.return;while(a)}return c.tag===3?f:null}function o(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function l(a){if(a.tag===31){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function u(a){if(s(a)!==a)throw Error(r(188))}function h(a){var c=a.alternate;if(!c){if(c=s(a),c===null)throw Error(r(188));return c!==a?null:a}for(var f=a,p=c;;){var b=f.return;if(b===null)break;var _=b.alternate;if(_===null){if(p=b.return,p!==null){f=p;continue}break}if(b.child===_.child){for(_=b.child;_;){if(_===f)return u(b),a;if(_===p)return u(b),c;_=_.sibling}throw Error(r(188))}if(f.return!==p.return)f=b,p=_;else{for(var C=!1,D=b.child;D;){if(D===f){C=!0,f=b,p=_;break}if(D===p){C=!0,p=b,f=_;break}D=D.sibling}if(!C){for(D=_.child;D;){if(D===f){C=!0,f=_,p=b;break}if(D===p){C=!0,p=_,f=b;break}D=D.sibling}if(!C)throw Error(r(189))}}if(f.alternate!==p)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?a:c}function d(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a;for(a=a.child;a!==null;){if(c=d(a),c!==null)return c;a=a.sibling}return null}var m=Object.assign,g=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),P=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function H(a){return a===null||typeof a!="object"?null:(a=F&&a[F]||a["@@iterator"],typeof a=="function"?a:null)}var V=Symbol.for("react.client.reference");function yt(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===V?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case S:return"Fragment";case E:return"Profiler";case w:return"StrictMode";case N:return"Suspense";case W:return"SuspenseList";case O:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case T:return"Portal";case P:return a.displayName||"Context";case R:return(a._context.displayName||"Context")+".Consumer";case j:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case M:return c=a.displayName||null,c!==null?c:yt(a.type)||"Memo";case k:c=a._payload,a=a._init;try{return yt(a(c))}catch{}}return null}var xt=Array.isArray,J=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,st=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ht={pending:!1,data:null,method:null,action:null},Ct=[],Vt=-1;function $(a){return{current:a}}function ot(a){0>Vt||(a.current=Ct[Vt],Ct[Vt]=null,Vt--)}function dt(a,c){Vt++,Ct[Vt]=a.current,a.current=c}var mt=$(null),Dt=$(null),It=$(null),Ut=$(null);function Ve(a,c){switch(dt(It,c),dt(Dt,a),dt(mt,null),c.nodeType){case 9:case 11:a=(a=c.documentElement)&&(a=a.namespaceURI)?lM(a):0;break;default:if(a=c.tagName,c=c.namespaceURI)c=lM(c),a=cM(c,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}ot(mt),dt(mt,a)}function ce(){ot(mt),ot(Dt),ot(It)}function Rt(a){a.memoizedState!==null&&dt(Ut,a);var c=mt.current,f=cM(c,a.type);c!==f&&(dt(Dt,a),dt(mt,f))}function ge(a){Dt.current===a&&(ot(mt),ot(Dt)),Ut.current===a&&(ot(Ut),pd._currentValue=ht)}var Re,Sr;function ri(a){if(Re===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);Re=c&&c[1]||"",Sr=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Re+a+Sr}var pf=!1;function Vl(a,c){if(!a||pf)return"";pf=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(c){var lt=function(){throw Error()};if(Object.defineProperty(lt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(lt,[])}catch(nt){var Z=nt}Reflect.construct(a,[],lt)}else{try{lt.call()}catch(nt){Z=nt}a.call(lt.prototype)}}else{try{throw Error()}catch(nt){Z=nt}(lt=a())&&typeof lt.catch=="function"&&lt.catch(function(){})}}catch(nt){if(nt&&Z&&typeof nt.stack=="string")return[nt.stack,Z.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=p.DetermineComponentFrameRoot(),C=_[0],D=_[1];if(C&&D){var U=C.split(`
`),Q=D.split(`
`);for(b=p=0;p<U.length&&!U[p].includes("DetermineComponentFrameRoot");)p++;for(;b<Q.length&&!Q[b].includes("DetermineComponentFrameRoot");)b++;if(p===U.length||b===Q.length)for(p=U.length-1,b=Q.length-1;1<=p&&0<=b&&U[p]!==Q[b];)b--;for(;1<=p&&0<=b;p--,b--)if(U[p]!==Q[b]){if(p!==1||b!==1)do if(p--,b--,0>b||U[p]!==Q[b]){var rt=`
`+U[p].replace(" at new "," at ");return a.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",a.displayName)),rt}while(1<=p&&0<=b);break}}}finally{pf=!1,Error.prepareStackTrace=f}return(f=a?a.displayName||a.name:"")?ri(f):""}function mf(a,c){switch(a.tag){case 26:case 27:case 5:return ri(a.type);case 16:return ri("Lazy");case 13:return a.child!==c&&c!==null?ri("Suspense Fallback"):ri("Suspense");case 19:return ri("SuspenseList");case 0:case 15:return Vl(a.type,!1);case 11:return Vl(a.type.render,!1);case 1:return Vl(a.type,!0);case 31:return ri("Activity");default:return""}}function gf(a){try{var c="",f=null;do c+=mf(a,f),f=a,a=a.return;while(a);return c}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var on=Object.prototype.hasOwnProperty,Tn=n.unstable_scheduleCallback,ta=n.unstable_cancelCallback,u_=n.unstable_shouldYield,Am=n.unstable_requestPaint,or=n.unstable_now,jl=n.unstable_getCurrentPriorityLevel,yf=n.unstable_ImmediatePriority,vf=n.unstable_UserBlockingPriority,ea=n.unstable_NormalPriority,h_=n.unstable_LowPriority,km=n.unstable_IdlePriority,Rm=n.log,Mm=n.unstable_setDisableYieldValue,Di=null,Ln=null;function ii(a){if(typeof Rm=="function"&&Mm(a),Ln&&typeof Ln.setStrictMode=="function")try{Ln.setStrictMode(Di,a)}catch{}}var Je=Math.clz32?Math.clz32:Om,Dm=Math.log,hu=Math.LN2;function Om(a){return a>>>=0,a===0?32:31-(Dm(a)/hu|0)|0}var cs=256,Bl=262144,an=4194304;function us(a){var c=a&42;if(c!==0)return c;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function hs(a,c,f){var p=a.pendingLanes;if(p===0)return 0;var b=0,_=a.suspendedLanes,C=a.pingedLanes;a=a.warmLanes;var D=p&134217727;return D!==0?(p=D&~_,p!==0?b=us(p):(C&=D,C!==0?b=us(C):f||(f=D&~a,f!==0&&(b=us(f))))):(D=p&~_,D!==0?b=us(D):C!==0?b=us(C):f||(f=p&~a,f!==0&&(b=us(f)))),b===0?0:c!==0&&c!==b&&(c&_)===0&&(_=b&-b,f=c&-c,_>=f||_===32&&(f&4194048)!==0)?c:b}function Oi(a,c){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&c)===0}function f_(a,c){switch(a){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Im(){var a=an;return an<<=1,(an&62914560)===0&&(an=4194304),a}function fs(a){for(var c=[],f=0;31>f;f++)c.push(a);return c}function Fl(a,c){a.pendingLanes|=c,c!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function d_(a,c,f,p,b,_){var C=a.pendingLanes;a.pendingLanes=f,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=f,a.entangledLanes&=f,a.errorRecoveryDisabledLanes&=f,a.shellSuspendCounter=0;var D=a.entanglements,U=a.expirationTimes,Q=a.hiddenUpdates;for(f=C&~f;0<f;){var rt=31-Je(f),lt=1<<rt;D[rt]=0,U[rt]=-1;var Z=Q[rt];if(Z!==null)for(Q[rt]=null,rt=0;rt<Z.length;rt++){var nt=Z[rt];nt!==null&&(nt.lane&=-536870913)}f&=~lt}p!==0&&Ul(a,p,0),_!==0&&b===0&&a.tag!==0&&(a.suspendedLanes|=_&~(C&~c))}function Ul(a,c,f){a.pendingLanes|=c,a.suspendedLanes&=~c;var p=31-Je(c);a.entangledLanes|=c,a.entanglements[p]=a.entanglements[p]|1073741824|f&261930}function bf(a,c){var f=a.entangledLanes|=c;for(a=a.entanglements;f;){var p=31-Je(f),b=1<<p;b&c|a[p]&c&&(a[p]|=c),f&=~b}}function _f(a,c){var f=c&-c;return f=(f&42)!==0?1:zl(f),(f&(a.suspendedLanes|c))!==0?0:f}function zl(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function to(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Pm(){var a=st.p;return a!==0?a:(a=window.event,a===void 0?32:OM(a.type))}function Ii(a,c){var f=st.p;try{return st.p=a,c()}finally{st.p=f}}var Pi=Math.random().toString(36).slice(2),ln="__reactFiber$"+Pi,An="__reactProps$"+Pi,ds="__reactContainer$"+Pi,fu="__reactEvents$"+Pi,p_="__reactListeners$"+Pi,Nm="__reactHandles$"+Pi,Lm="__reactResources$"+Pi,ps="__reactMarker$"+Pi;function du(a){delete a[ln],delete a[An],delete a[fu],delete a[p_],delete a[Nm]}function ms(a){var c=a[ln];if(c)return c;for(var f=a.parentNode;f;){if(c=f[ds]||f[ln]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(a=gM(a);a!==null;){if(f=a[ln])return f;a=gM(a)}return c}a=f,f=a.parentNode}return null}function si(a){if(a=a[ln]||a[ds]){var c=a.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return a}return null}function jr(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a.stateNode;throw Error(r(33))}function gs(a){var c=a[Lm];return c||(c=a[Lm]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function cn(a){a[ps]=!0}var Tf=new Set,Sf={};function ys(a,c){vs(a,c),vs(a+"Capture",c)}function vs(a,c){for(Sf[a]=c,a=0;a<c.length;a++)Tf.add(c[a])}var wf=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xf={},Ef={};function Vm(a){return on.call(Ef,a)?!0:on.call(xf,a)?!1:wf.test(a)?Ef[a]=!0:(xf[a]=!0,!1)}function pu(a,c,f){if(Vm(c))if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":a.removeAttribute(c);return;case"boolean":var p=c.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){a.removeAttribute(c);return}}a.setAttribute(c,""+f)}}function Br(a,c,f){if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttribute(c,""+f)}}function un(a,c,f,p){if(p===null)a.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(f);return}a.setAttributeNS(c,f,""+p)}}function kn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function na(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Cf(a,c,f){var p=Object.getOwnPropertyDescriptor(a.constructor.prototype,c);if(!a.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var b=p.get,_=p.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return b.call(this)},set:function(C){f=""+C,_.call(this,C)}}),Object.defineProperty(a,c,{enumerable:p.enumerable}),{getValue:function(){return f},setValue:function(C){f=""+C},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function he(a){if(!a._valueTracker){var c=na(a)?"checked":"value";a._valueTracker=Cf(a,c,""+a[c])}}function Hl(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var f=c.getValue(),p="";return a&&(p=na(a)?a.checked?"true":"false":a.value),a=p,a!==f?(c.setValue(a),!0):!1}function bs(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var $l=/[\n"\\]/g;function wr(a){return a.replace($l,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function mu(a,c,f,p,b,_,C,D){a.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?a.type=C:a.removeAttribute("type"),c!=null?C==="number"?(c===0&&a.value===""||a.value!=c)&&(a.value=""+kn(c)):a.value!==""+kn(c)&&(a.value=""+kn(c)):C!=="submit"&&C!=="reset"||a.removeAttribute("value"),c!=null?Af(a,C,kn(c)):f!=null?Af(a,C,kn(f)):p!=null&&a.removeAttribute("value"),b==null&&_!=null&&(a.defaultChecked=!!_),b!=null&&(a.checked=b&&typeof b!="function"&&typeof b!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?a.name=""+kn(D):a.removeAttribute("name")}function jm(a,c,f,p,b,_,C,D){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(a.type=_),c!=null||f!=null){if(!(_!=="submit"&&_!=="reset"||c!=null)){he(a);return}f=f!=null?""+kn(f):"",c=c!=null?""+kn(c):f,D||c===a.value||(a.value=c),a.defaultValue=c}p=p??b,p=typeof p!="function"&&typeof p!="symbol"&&!!p,a.checked=D?a.checked:!!p,a.defaultChecked=!!p,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(a.name=C),he(a)}function Af(a,c,f){c==="number"&&bs(a.ownerDocument)===a||a.defaultValue===""+f||(a.defaultValue=""+f)}function ra(a,c,f,p){if(a=a.options,c){c={};for(var b=0;b<f.length;b++)c["$"+f[b]]=!0;for(f=0;f<a.length;f++)b=c.hasOwnProperty("$"+a[f].value),a[f].selected!==b&&(a[f].selected=b),b&&p&&(a[f].defaultSelected=!0)}else{for(f=""+kn(f),c=null,b=0;b<a.length;b++){if(a[b].value===f){a[b].selected=!0,p&&(a[b].defaultSelected=!0);return}c!==null||a[b].disabled||(c=a[b])}c!==null&&(c.selected=!0)}}function Bm(a,c,f){if(c!=null&&(c=""+kn(c),c!==a.value&&(a.value=c),f==null)){a.defaultValue!==c&&(a.defaultValue=c);return}a.defaultValue=f!=null?""+kn(f):""}function ia(a,c,f,p){if(c==null){if(p!=null){if(f!=null)throw Error(r(92));if(xt(p)){if(1<p.length)throw Error(r(93));p=p[0]}f=p}f==null&&(f=""),c=f}f=kn(c),a.defaultValue=f,p=a.textContent,p===f&&p!==""&&p!==null&&(a.value=p),he(a)}function xr(a,c){if(c){var f=a.firstChild;if(f&&f===a.lastChild&&f.nodeType===3){f.nodeValue=c;return}}a.textContent=c}var Fm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kf(a,c,f){var p=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?p?a.setProperty(c,""):c==="float"?a.cssFloat="":a[c]="":p?a.setProperty(c,f):typeof f!="number"||f===0||Fm.has(c)?c==="float"?a.cssFloat=f:a[c]=(""+f).trim():a[c]=f+"px"}function Rf(a,c,f){if(c!=null&&typeof c!="object")throw Error(r(62));if(a=a.style,f!=null){for(var p in f)!f.hasOwnProperty(p)||c!=null&&c.hasOwnProperty(p)||(p.indexOf("--")===0?a.setProperty(p,""):p==="float"?a.cssFloat="":a[p]="");for(var b in c)p=c[b],c.hasOwnProperty(b)&&f[b]!==p&&kf(a,b,p)}else for(var _ in c)c.hasOwnProperty(_)&&kf(a,_,c[_])}function gu(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Um=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),sa=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yu(a){return sa.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Ni(){}var Mf=null;function oi(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var oa=null,_s=null;function ql(a){var c=si(a);if(c&&(a=c.stateNode)){var f=a[An]||null;t:switch(a=c.stateNode,c.type){case"input":if(mu(a,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=a;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+wr(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var p=f[c];if(p!==a&&p.form===a.form){var b=p[An]||null;if(!b)throw Error(r(90));mu(p,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(c=0;c<f.length;c++)p=f[c],p.form===a.form&&Hl(p)}break t;case"textarea":Bm(a,f.value,f.defaultValue);break t;case"select":c=f.value,c!=null&&ra(a,!!f.multiple,c,!1)}}}var vu=!1;function aa(a,c,f){if(vu)return a(c,f);vu=!0;try{var p=a(c);return p}finally{if(vu=!1,(oa!==null||_s!==null)&&(Pg(),oa&&(c=oa,a=_s,_s=oa=null,ql(c),a)))for(c=0;c<a.length;c++)ql(a[c])}}function Li(a,c){var f=a.stateNode;if(f===null)return null;var p=f[An]||null;if(p===null)return null;f=p[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(a=a.type,p=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!p;break t;default:a=!1}if(a)return null;if(f&&typeof f!="function")throw Error(r(231,c,typeof f));return f}var ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gl=!1;if(ai)try{var ye={};Object.defineProperty(ye,"passive",{get:function(){Gl=!0}}),window.addEventListener("test",ye,ye),window.removeEventListener("test",ye,ye)}catch{Gl=!1}var Ts=null,Df=null,Wl=null;function Of(){if(Wl)return Wl;var a,c=Df,f=c.length,p,b="value"in Ts?Ts.value:Ts.textContent,_=b.length;for(a=0;a<f&&c[a]===b[a];a++);var C=f-a;for(p=1;p<=C&&c[f-p]===b[_-p];p++);return Wl=b.slice(a,1<p?1-p:void 0)}function Yl(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function eo(){return!0}function Vi(){return!1}function Vn(a){function c(f,p,b,_,C){this._reactName=f,this._targetInst=b,this.type=p,this.nativeEvent=_,this.target=C,this.currentTarget=null;for(var D in a)a.hasOwnProperty(D)&&(f=a[D],this[D]=f?f(_):_[D]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?eo:Vi,this.isPropagationStopped=Vi,this}return m(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=eo)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=eo)},persist:function(){},isPersistent:eo}),c}var no={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ss=Vn(no),la=m({},no,{view:0,detail:0}),If=Vn(la),ca,bu,ws,_u=m({},la,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ua,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ws&&(ws&&a.type==="mousemove"?(ca=a.screenX-ws.screenX,bu=a.screenY-ws.screenY):bu=ca=0,ws=a),ca)},movementY:function(a){return"movementY"in a?a.movementY:bu}}),Pf=Vn(_u),Kl=m({},_u,{dataTransfer:0}),zm=Vn(Kl),Hm=m({},la,{relatedTarget:0}),Xl=Vn(Hm),Nf=m({},no,{animationName:0,elapsedTime:0,pseudoElement:0}),$m=Vn(Nf),Tu=m({},no,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),qm=Vn(Tu),Gm=m({},no,{data:0}),xs=Vn(Gm),Wm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ym={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Km={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xm(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=Km[a])?!!c[a]:!1}function ua(){return Xm}var ar=m({},la,{key:function(a){if(a.key){var c=Wm[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=Yl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Ym[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ua,charCode:function(a){return a.type==="keypress"?Yl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Yl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Qm=Vn(ar),Jm=m({},_u,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ro=Vn(Jm),y=m({},la,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ua}),x=Vn(y),A=m({},no,{propertyName:0,elapsedTime:0,pseudoElement:0}),I=Vn(A),K=m({},_u,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),et=Vn(K),pt=m({},no,{newState:0,oldState:0}),zt=Vn(pt),Ze=[9,13,27,32],ae=ai&&"CompositionEvent"in window,Ie=null;ai&&"documentMode"in document&&(Ie=document.documentMode);var li=ai&&"TextEvent"in window&&!Ie,Es=ai&&(!ae||Ie&&8<Ie&&11>=Ie),ji=" ",Bi=!1;function Ql(a,c){switch(a){case"keyup":return Ze.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Su(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var wu=!1;function AU(a,c){switch(a){case"compositionend":return Su(c);case"keypress":return c.which!==32?null:(Bi=!0,ji);case"textInput":return a=c.data,a===ji&&Bi?null:a;default:return null}}function kU(a,c){if(wu)return a==="compositionend"||!ae&&Ql(a,c)?(a=Of(),Wl=Df=Ts=null,wu=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Es&&c.locale!=="ko"?null:c.data;default:return null}}var RU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bA(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!RU[a.type]:c==="textarea"}function _A(a,c,f,p){oa?_s?_s.push(p):_s=[p]:oa=p,c=Ug(c,"onChange"),0<c.length&&(f=new Ss("onChange","change",null,f,p),a.push({event:f,listeners:c}))}var Lf=null,Vf=null;function MU(a){nM(a,0)}function Zm(a){var c=jr(a);if(Hl(c))return a}function TA(a,c){if(a==="change")return c}var SA=!1;if(ai){var m_;if(ai){var g_="oninput"in document;if(!g_){var wA=document.createElement("div");wA.setAttribute("oninput","return;"),g_=typeof wA.oninput=="function"}m_=g_}else m_=!1;SA=m_&&(!document.documentMode||9<document.documentMode)}function xA(){Lf&&(Lf.detachEvent("onpropertychange",EA),Vf=Lf=null)}function EA(a){if(a.propertyName==="value"&&Zm(Vf)){var c=[];_A(c,Vf,a,oi(a)),aa(MU,c)}}function DU(a,c,f){a==="focusin"?(xA(),Lf=c,Vf=f,Lf.attachEvent("onpropertychange",EA)):a==="focusout"&&xA()}function OU(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Zm(Vf)}function IU(a,c){if(a==="click")return Zm(c)}function PU(a,c){if(a==="input"||a==="change")return Zm(c)}function NU(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var Fr=typeof Object.is=="function"?Object.is:NU;function jf(a,c){if(Fr(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var f=Object.keys(a),p=Object.keys(c);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var b=f[p];if(!on.call(c,b)||!Fr(a[b],c[b]))return!1}return!0}function CA(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function AA(a,c){var f=CA(a);a=0;for(var p;f;){if(f.nodeType===3){if(p=a+f.textContent.length,a<=c&&p>=c)return{node:f,offset:c-a};a=p}t:{for(;f;){if(f.nextSibling){f=f.nextSibling;break t}f=f.parentNode}f=void 0}f=CA(f)}}function kA(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?kA(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function RA(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var c=bs(a.document);c instanceof a.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)a=c.contentWindow;else break;c=bs(a.document)}return c}function y_(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}var LU=ai&&"documentMode"in document&&11>=document.documentMode,xu=null,v_=null,Bf=null,b_=!1;function MA(a,c,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;b_||xu==null||xu!==bs(p)||(p=xu,"selectionStart"in p&&y_(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Bf&&jf(Bf,p)||(Bf=p,p=Ug(v_,"onSelect"),0<p.length&&(c=new Ss("onSelect","select",null,c,f),a.push({event:c,listeners:p}),c.target=xu)))}function Jl(a,c){var f={};return f[a.toLowerCase()]=c.toLowerCase(),f["Webkit"+a]="webkit"+c,f["Moz"+a]="moz"+c,f}var Eu={animationend:Jl("Animation","AnimationEnd"),animationiteration:Jl("Animation","AnimationIteration"),animationstart:Jl("Animation","AnimationStart"),transitionrun:Jl("Transition","TransitionRun"),transitionstart:Jl("Transition","TransitionStart"),transitioncancel:Jl("Transition","TransitionCancel"),transitionend:Jl("Transition","TransitionEnd")},__={},DA={};ai&&(DA=document.createElement("div").style,"AnimationEvent"in window||(delete Eu.animationend.animation,delete Eu.animationiteration.animation,delete Eu.animationstart.animation),"TransitionEvent"in window||delete Eu.transitionend.transition);function Zl(a){if(__[a])return __[a];if(!Eu[a])return a;var c=Eu[a],f;for(f in c)if(c.hasOwnProperty(f)&&f in DA)return __[a]=c[f];return a}var OA=Zl("animationend"),IA=Zl("animationiteration"),PA=Zl("animationstart"),VU=Zl("transitionrun"),jU=Zl("transitionstart"),BU=Zl("transitioncancel"),NA=Zl("transitionend"),LA=new Map,T_="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");T_.push("scrollEnd");function Fi(a,c){LA.set(a,c),ys(c,[a])}var tg=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},ci=[],Cu=0,S_=0;function eg(){for(var a=Cu,c=S_=Cu=0;c<a;){var f=ci[c];ci[c++]=null;var p=ci[c];ci[c++]=null;var b=ci[c];ci[c++]=null;var _=ci[c];if(ci[c++]=null,p!==null&&b!==null){var C=p.pending;C===null?b.next=b:(b.next=C.next,C.next=b),p.pending=b}_!==0&&VA(f,b,_)}}function ng(a,c,f,p){ci[Cu++]=a,ci[Cu++]=c,ci[Cu++]=f,ci[Cu++]=p,S_|=p,a.lanes|=p,a=a.alternate,a!==null&&(a.lanes|=p)}function w_(a,c,f,p){return ng(a,c,f,p),rg(a)}function tc(a,c){return ng(a,null,null,c),rg(a)}function VA(a,c,f){a.lanes|=f;var p=a.alternate;p!==null&&(p.lanes|=f);for(var b=!1,_=a.return;_!==null;)_.childLanes|=f,p=_.alternate,p!==null&&(p.childLanes|=f),_.tag===22&&(a=_.stateNode,a===null||a._visibility&1||(b=!0)),a=_,_=_.return;return a.tag===3?(_=a.stateNode,b&&c!==null&&(b=31-Je(f),a=_.hiddenUpdates,p=a[b],p===null?a[b]=[c]:p.push(c),c.lane=f|536870912),_):null}function rg(a){if(50<ad)throw ad=0,OT=null,Error(r(185));for(var c=a.return;c!==null;)a=c,c=a.return;return a.tag===3?a.stateNode:null}var Au={};function FU(a,c,f,p){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ur(a,c,f,p){return new FU(a,c,f,p)}function x_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function io(a,c){var f=a.alternate;return f===null?(f=Ur(a.tag,c,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=c,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&65011712,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,c=a.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f.refCleanup=a.refCleanup,f}function jA(a,c){a.flags&=65011714;var f=a.alternate;return f===null?(a.childLanes=0,a.lanes=c,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=f.childLanes,a.lanes=f.lanes,a.child=f.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=f.memoizedProps,a.memoizedState=f.memoizedState,a.updateQueue=f.updateQueue,a.type=f.type,c=f.dependencies,a.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),a}function ig(a,c,f,p,b,_){var C=0;if(p=a,typeof a=="function")x_(a)&&(C=1);else if(typeof a=="string")C=qz(a,f,mt.current)?26:a==="html"||a==="head"||a==="body"?27:5;else t:switch(a){case O:return a=Ur(31,f,c,b),a.elementType=O,a.lanes=_,a;case S:return ec(f.children,b,_,c);case w:C=8,b|=24;break;case E:return a=Ur(12,f,c,b|2),a.elementType=E,a.lanes=_,a;case N:return a=Ur(13,f,c,b),a.elementType=N,a.lanes=_,a;case W:return a=Ur(19,f,c,b),a.elementType=W,a.lanes=_,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case P:C=10;break t;case R:C=9;break t;case j:C=11;break t;case M:C=14;break t;case k:C=16,p=null;break t}C=29,f=Error(r(130,a===null?"null":typeof a,"")),p=null}return c=Ur(C,f,c,b),c.elementType=a,c.type=p,c.lanes=_,c}function ec(a,c,f,p){return a=Ur(7,a,p,c),a.lanes=f,a}function E_(a,c,f){return a=Ur(6,a,null,c),a.lanes=f,a}function BA(a){var c=Ur(18,null,null,0);return c.stateNode=a,c}function C_(a,c,f){return c=Ur(4,a.children!==null?a.children:[],a.key,c),c.lanes=f,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}var FA=new WeakMap;function ui(a,c){if(typeof a=="object"&&a!==null){var f=FA.get(a);return f!==void 0?f:(c={value:a,source:c,stack:gf(c)},FA.set(a,c),c)}return{value:a,source:c,stack:gf(c)}}var ku=[],Ru=0,sg=null,Ff=0,hi=[],fi=0,ha=null,Cs=1,As="";function so(a,c){ku[Ru++]=Ff,ku[Ru++]=sg,sg=a,Ff=c}function UA(a,c,f){hi[fi++]=Cs,hi[fi++]=As,hi[fi++]=ha,ha=a;var p=Cs;a=As;var b=32-Je(p)-1;p&=~(1<<b),f+=1;var _=32-Je(c)+b;if(30<_){var C=b-b%5;_=(p&(1<<C)-1).toString(32),p>>=C,b-=C,Cs=1<<32-Je(c)+b|f<<b|p,As=_+a}else Cs=1<<_|f<<b|p,As=a}function A_(a){a.return!==null&&(so(a,1),UA(a,1,0))}function k_(a){for(;a===sg;)sg=ku[--Ru],ku[Ru]=null,Ff=ku[--Ru],ku[Ru]=null;for(;a===ha;)ha=hi[--fi],hi[fi]=null,As=hi[--fi],hi[fi]=null,Cs=hi[--fi],hi[fi]=null}function zA(a,c){hi[fi++]=Cs,hi[fi++]=As,hi[fi++]=ha,Cs=c.id,As=c.overflow,ha=a}var jn=null,Me=null,ee=!1,fa=null,di=!1,R_=Error(r(519));function da(a){var c=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Uf(ui(c,a)),R_}function HA(a){var c=a.stateNode,f=a.type,p=a.memoizedProps;switch(c[ln]=a,c[An]=p,f){case"dialog":Kt("cancel",c),Kt("close",c);break;case"iframe":case"object":case"embed":Kt("load",c);break;case"video":case"audio":for(f=0;f<cd.length;f++)Kt(cd[f],c);break;case"source":Kt("error",c);break;case"img":case"image":case"link":Kt("error",c),Kt("load",c);break;case"details":Kt("toggle",c);break;case"input":Kt("invalid",c),jm(c,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":Kt("invalid",c);break;case"textarea":Kt("invalid",c),ia(c,p.value,p.defaultValue,p.children)}f=p.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||p.suppressHydrationWarning===!0||oM(c.textContent,f)?(p.popover!=null&&(Kt("beforetoggle",c),Kt("toggle",c)),p.onScroll!=null&&Kt("scroll",c),p.onScrollEnd!=null&&Kt("scrollend",c),p.onClick!=null&&(c.onclick=Ni),c=!0):c=!1,c||da(a,!0)}function $A(a){for(jn=a.return;jn;)switch(jn.tag){case 5:case 31:case 13:di=!1;return;case 27:case 3:di=!0;return;default:jn=jn.return}}function Mu(a){if(a!==jn)return!1;if(!ee)return $A(a),ee=!0,!1;var c=a.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=a.type,f=!(f!=="form"&&f!=="button")||WT(a.type,a.memoizedProps)),f=!f),f&&Me&&da(a),$A(a),c===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));Me=mM(a)}else if(c===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));Me=mM(a)}else c===27?(c=Me,Aa(a.type)?(a=JT,JT=null,Me=a):Me=c):Me=jn?mi(a.stateNode.nextSibling):null;return!0}function nc(){Me=jn=null,ee=!1}function M_(){var a=fa;return a!==null&&(kr===null?kr=a:kr.push.apply(kr,a),fa=null),a}function Uf(a){fa===null?fa=[a]:fa.push(a)}var D_=$(null),rc=null,oo=null;function pa(a,c,f){dt(D_,c._currentValue),c._currentValue=f}function ao(a){a._currentValue=D_.current,ot(D_)}function O_(a,c,f){for(;a!==null;){var p=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,p!==null&&(p.childLanes|=c)):p!==null&&(p.childLanes&c)!==c&&(p.childLanes|=c),a===f)break;a=a.return}}function I_(a,c,f,p){var b=a.child;for(b!==null&&(b.return=a);b!==null;){var _=b.dependencies;if(_!==null){var C=b.child;_=_.firstContext;t:for(;_!==null;){var D=_;_=b;for(var U=0;U<c.length;U++)if(D.context===c[U]){_.lanes|=f,D=_.alternate,D!==null&&(D.lanes|=f),O_(_.return,f,a),p||(C=null);break t}_=D.next}}else if(b.tag===18){if(C=b.return,C===null)throw Error(r(341));C.lanes|=f,_=C.alternate,_!==null&&(_.lanes|=f),O_(C,f,a),C=null}else C=b.child;if(C!==null)C.return=b;else for(C=b;C!==null;){if(C===a){C=null;break}if(b=C.sibling,b!==null){b.return=C.return,C=b;break}C=C.return}b=C}}function Du(a,c,f,p){a=null;for(var b=c,_=!1;b!==null;){if(!_){if((b.flags&524288)!==0)_=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var C=b.alternate;if(C===null)throw Error(r(387));if(C=C.memoizedProps,C!==null){var D=b.type;Fr(b.pendingProps.value,C.value)||(a!==null?a.push(D):a=[D])}}else if(b===Ut.current){if(C=b.alternate,C===null)throw Error(r(387));C.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(a!==null?a.push(pd):a=[pd])}b=b.return}a!==null&&I_(c,a,f,p),c.flags|=262144}function og(a){for(a=a.firstContext;a!==null;){if(!Fr(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function ic(a){rc=a,oo=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Bn(a){return qA(rc,a)}function ag(a,c){return rc===null&&ic(a),qA(a,c)}function qA(a,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},oo===null){if(a===null)throw Error(r(308));oo=c,a.dependencies={lanes:0,firstContext:c},a.flags|=524288}else oo=oo.next=c;return f}var UU=typeof AbortController<"u"?AbortController:function(){var a=[],c=this.signal={aborted:!1,addEventListener:function(f,p){a.push(p)}};this.abort=function(){c.aborted=!0,a.forEach(function(f){return f()})}},zU=n.unstable_scheduleCallback,HU=n.unstable_NormalPriority,hn={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function P_(){return{controller:new UU,data:new Map,refCount:0}}function zf(a){a.refCount--,a.refCount===0&&zU(HU,function(){a.controller.abort()})}var Hf=null,N_=0,Ou=0,Iu=null;function $U(a,c){if(Hf===null){var f=Hf=[];N_=0,Ou=jT(),Iu={status:"pending",value:void 0,then:function(p){f.push(p)}}}return N_++,c.then(GA,GA),c}function GA(){if(--N_===0&&Hf!==null){Iu!==null&&(Iu.status="fulfilled");var a=Hf;Hf=null,Ou=0,Iu=null;for(var c=0;c<a.length;c++)(0,a[c])()}}function qU(a,c){var f=[],p={status:"pending",value:null,reason:null,then:function(b){f.push(b)}};return a.then(function(){p.status="fulfilled",p.value=c;for(var b=0;b<f.length;b++)(0,f[b])(c)},function(b){for(p.status="rejected",p.reason=b,b=0;b<f.length;b++)(0,f[b])(void 0)}),p}var WA=J.S;J.S=function(a,c){MR=or(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&$U(a,c),WA!==null&&WA(a,c)};var sc=$(null);function L_(){var a=sc.current;return a!==null?a:xe.pooledCache}function lg(a,c){c===null?dt(sc,sc.current):dt(sc,c.pool)}function YA(){var a=L_();return a===null?null:{parent:hn._currentValue,pool:a}}var Pu=Error(r(460)),V_=Error(r(474)),cg=Error(r(542)),ug={then:function(){}};function KA(a){return a=a.status,a==="fulfilled"||a==="rejected"}function XA(a,c,f){switch(f=a[f],f===void 0?a.push(c):f!==c&&(c.then(Ni,Ni),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,JA(a),a;default:if(typeof c.status=="string")c.then(Ni,Ni);else{if(a=xe,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=c,a.status="pending",a.then(function(p){if(c.status==="pending"){var b=c;b.status="fulfilled",b.value=p}},function(p){if(c.status==="pending"){var b=c;b.status="rejected",b.reason=p}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,JA(a),a}throw ac=c,Pu}}function oc(a){try{var c=a._init;return c(a._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(ac=f,Pu):f}}var ac=null;function QA(){if(ac===null)throw Error(r(459));var a=ac;return ac=null,a}function JA(a){if(a===Pu||a===cg)throw Error(r(483))}var Nu=null,$f=0;function hg(a){var c=$f;return $f+=1,Nu===null&&(Nu=[]),XA(Nu,a,c)}function qf(a,c){c=c.props.ref,a.ref=c!==void 0?c:null}function fg(a,c){throw c.$$typeof===g?Error(r(525)):(a=Object.prototype.toString.call(c),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a)))}function ZA(a){function c(Y,G){if(a){var X=Y.deletions;X===null?(Y.deletions=[G],Y.flags|=16):X.push(G)}}function f(Y,G){if(!a)return null;for(;G!==null;)c(Y,G),G=G.sibling;return null}function p(Y){for(var G=new Map;Y!==null;)Y.key!==null?G.set(Y.key,Y):G.set(Y.index,Y),Y=Y.sibling;return G}function b(Y,G){return Y=io(Y,G),Y.index=0,Y.sibling=null,Y}function _(Y,G,X){return Y.index=X,a?(X=Y.alternate,X!==null?(X=X.index,X<G?(Y.flags|=67108866,G):X):(Y.flags|=67108866,G)):(Y.flags|=1048576,G)}function C(Y){return a&&Y.alternate===null&&(Y.flags|=67108866),Y}function D(Y,G,X,at){return G===null||G.tag!==6?(G=E_(X,Y.mode,at),G.return=Y,G):(G=b(G,X),G.return=Y,G)}function U(Y,G,X,at){var kt=X.type;return kt===S?rt(Y,G,X.props.children,at,X.key):G!==null&&(G.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===k&&oc(kt)===G.type)?(G=b(G,X.props),qf(G,X),G.return=Y,G):(G=ig(X.type,X.key,X.props,null,Y.mode,at),qf(G,X),G.return=Y,G)}function Q(Y,G,X,at){return G===null||G.tag!==4||G.stateNode.containerInfo!==X.containerInfo||G.stateNode.implementation!==X.implementation?(G=C_(X,Y.mode,at),G.return=Y,G):(G=b(G,X.children||[]),G.return=Y,G)}function rt(Y,G,X,at,kt){return G===null||G.tag!==7?(G=ec(X,Y.mode,at,kt),G.return=Y,G):(G=b(G,X),G.return=Y,G)}function lt(Y,G,X){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=E_(""+G,Y.mode,X),G.return=Y,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case v:return X=ig(G.type,G.key,G.props,null,Y.mode,X),qf(X,G),X.return=Y,X;case T:return G=C_(G,Y.mode,X),G.return=Y,G;case k:return G=oc(G),lt(Y,G,X)}if(xt(G)||H(G))return G=ec(G,Y.mode,X,null),G.return=Y,G;if(typeof G.then=="function")return lt(Y,hg(G),X);if(G.$$typeof===P)return lt(Y,ag(Y,G),X);fg(Y,G)}return null}function Z(Y,G,X,at){var kt=G!==null?G.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return kt!==null?null:D(Y,G,""+X,at);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case v:return X.key===kt?U(Y,G,X,at):null;case T:return X.key===kt?Q(Y,G,X,at):null;case k:return X=oc(X),Z(Y,G,X,at)}if(xt(X)||H(X))return kt!==null?null:rt(Y,G,X,at,null);if(typeof X.then=="function")return Z(Y,G,hg(X),at);if(X.$$typeof===P)return Z(Y,G,ag(Y,X),at);fg(Y,X)}return null}function nt(Y,G,X,at,kt){if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return Y=Y.get(X)||null,D(G,Y,""+at,kt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case v:return Y=Y.get(at.key===null?X:at.key)||null,U(G,Y,at,kt);case T:return Y=Y.get(at.key===null?X:at.key)||null,Q(G,Y,at,kt);case k:return at=oc(at),nt(Y,G,X,at,kt)}if(xt(at)||H(at))return Y=Y.get(X)||null,rt(G,Y,at,kt,null);if(typeof at.then=="function")return nt(Y,G,X,hg(at),kt);if(at.$$typeof===P)return nt(Y,G,X,ag(G,at),kt);fg(G,at)}return null}function Tt(Y,G,X,at){for(var kt=null,se=null,wt=G,$t=G=0,Qt=null;wt!==null&&$t<X.length;$t++){wt.index>$t?(Qt=wt,wt=null):Qt=wt.sibling;var oe=Z(Y,wt,X[$t],at);if(oe===null){wt===null&&(wt=Qt);break}a&&wt&&oe.alternate===null&&c(Y,wt),G=_(oe,G,$t),se===null?kt=oe:se.sibling=oe,se=oe,wt=Qt}if($t===X.length)return f(Y,wt),ee&&so(Y,$t),kt;if(wt===null){for(;$t<X.length;$t++)wt=lt(Y,X[$t],at),wt!==null&&(G=_(wt,G,$t),se===null?kt=wt:se.sibling=wt,se=wt);return ee&&so(Y,$t),kt}for(wt=p(wt);$t<X.length;$t++)Qt=nt(wt,Y,$t,X[$t],at),Qt!==null&&(a&&Qt.alternate!==null&&wt.delete(Qt.key===null?$t:Qt.key),G=_(Qt,G,$t),se===null?kt=Qt:se.sibling=Qt,se=Qt);return a&&wt.forEach(function(Oa){return c(Y,Oa)}),ee&&so(Y,$t),kt}function Pt(Y,G,X,at){if(X==null)throw Error(r(151));for(var kt=null,se=null,wt=G,$t=G=0,Qt=null,oe=X.next();wt!==null&&!oe.done;$t++,oe=X.next()){wt.index>$t?(Qt=wt,wt=null):Qt=wt.sibling;var Oa=Z(Y,wt,oe.value,at);if(Oa===null){wt===null&&(wt=Qt);break}a&&wt&&Oa.alternate===null&&c(Y,wt),G=_(Oa,G,$t),se===null?kt=Oa:se.sibling=Oa,se=Oa,wt=Qt}if(oe.done)return f(Y,wt),ee&&so(Y,$t),kt;if(wt===null){for(;!oe.done;$t++,oe=X.next())oe=lt(Y,oe.value,at),oe!==null&&(G=_(oe,G,$t),se===null?kt=oe:se.sibling=oe,se=oe);return ee&&so(Y,$t),kt}for(wt=p(wt);!oe.done;$t++,oe=X.next())oe=nt(wt,Y,$t,oe.value,at),oe!==null&&(a&&oe.alternate!==null&&wt.delete(oe.key===null?$t:oe.key),G=_(oe,G,$t),se===null?kt=oe:se.sibling=oe,se=oe);return a&&wt.forEach(function(n6){return c(Y,n6)}),ee&&so(Y,$t),kt}function _e(Y,G,X,at){if(typeof X=="object"&&X!==null&&X.type===S&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case v:t:{for(var kt=X.key;G!==null;){if(G.key===kt){if(kt=X.type,kt===S){if(G.tag===7){f(Y,G.sibling),at=b(G,X.props.children),at.return=Y,Y=at;break t}}else if(G.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===k&&oc(kt)===G.type){f(Y,G.sibling),at=b(G,X.props),qf(at,X),at.return=Y,Y=at;break t}f(Y,G);break}else c(Y,G);G=G.sibling}X.type===S?(at=ec(X.props.children,Y.mode,at,X.key),at.return=Y,Y=at):(at=ig(X.type,X.key,X.props,null,Y.mode,at),qf(at,X),at.return=Y,Y=at)}return C(Y);case T:t:{for(kt=X.key;G!==null;){if(G.key===kt)if(G.tag===4&&G.stateNode.containerInfo===X.containerInfo&&G.stateNode.implementation===X.implementation){f(Y,G.sibling),at=b(G,X.children||[]),at.return=Y,Y=at;break t}else{f(Y,G);break}else c(Y,G);G=G.sibling}at=C_(X,Y.mode,at),at.return=Y,Y=at}return C(Y);case k:return X=oc(X),_e(Y,G,X,at)}if(xt(X))return Tt(Y,G,X,at);if(H(X)){if(kt=H(X),typeof kt!="function")throw Error(r(150));return X=kt.call(X),Pt(Y,G,X,at)}if(typeof X.then=="function")return _e(Y,G,hg(X),at);if(X.$$typeof===P)return _e(Y,G,ag(Y,X),at);fg(Y,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,G!==null&&G.tag===6?(f(Y,G.sibling),at=b(G,X),at.return=Y,Y=at):(f(Y,G),at=E_(X,Y.mode,at),at.return=Y,Y=at),C(Y)):f(Y,G)}return function(Y,G,X,at){try{$f=0;var kt=_e(Y,G,X,at);return Nu=null,kt}catch(wt){if(wt===Pu||wt===cg)throw wt;var se=Ur(29,wt,null,Y.mode);return se.lanes=at,se.return=Y,se}}}var lc=ZA(!0),tk=ZA(!1),ma=!1;function j_(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function B_(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function ga(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function ya(a,c,f){var p=a.updateQueue;if(p===null)return null;if(p=p.shared,(le&2)!==0){var b=p.pending;return b===null?c.next=c:(c.next=b.next,b.next=c),p.pending=c,c=rg(a),VA(a,null,f),c}return ng(a,p,c,f),rg(a)}function Gf(a,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var p=c.lanes;p&=a.pendingLanes,f|=p,c.lanes=f,bf(a,f)}}function F_(a,c){var f=a.updateQueue,p=a.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var b=null,_=null;if(f=f.firstBaseUpdate,f!==null){do{var C={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};_===null?b=_=C:_=_.next=C,f=f.next}while(f!==null);_===null?b=_=c:_=_.next=c}else b=_=c;f={baseState:p.baseState,firstBaseUpdate:b,lastBaseUpdate:_,shared:p.shared,callbacks:p.callbacks},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=c:a.next=c,f.lastBaseUpdate=c}var U_=!1;function Wf(){if(U_){var a=Iu;if(a!==null)throw a}}function Yf(a,c,f,p){U_=!1;var b=a.updateQueue;ma=!1;var _=b.firstBaseUpdate,C=b.lastBaseUpdate,D=b.shared.pending;if(D!==null){b.shared.pending=null;var U=D,Q=U.next;U.next=null,C===null?_=Q:C.next=Q,C=U;var rt=a.alternate;rt!==null&&(rt=rt.updateQueue,D=rt.lastBaseUpdate,D!==C&&(D===null?rt.firstBaseUpdate=Q:D.next=Q,rt.lastBaseUpdate=U))}if(_!==null){var lt=b.baseState;C=0,rt=Q=U=null,D=_;do{var Z=D.lane&-536870913,nt=Z!==D.lane;if(nt?(Xt&Z)===Z:(p&Z)===Z){Z!==0&&Z===Ou&&(U_=!0),rt!==null&&(rt=rt.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});t:{var Tt=a,Pt=D;Z=c;var _e=f;switch(Pt.tag){case 1:if(Tt=Pt.payload,typeof Tt=="function"){lt=Tt.call(_e,lt,Z);break t}lt=Tt;break t;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=Pt.payload,Z=typeof Tt=="function"?Tt.call(_e,lt,Z):Tt,Z==null)break t;lt=m({},lt,Z);break t;case 2:ma=!0}}Z=D.callback,Z!==null&&(a.flags|=64,nt&&(a.flags|=8192),nt=b.callbacks,nt===null?b.callbacks=[Z]:nt.push(Z))}else nt={lane:Z,tag:D.tag,payload:D.payload,callback:D.callback,next:null},rt===null?(Q=rt=nt,U=lt):rt=rt.next=nt,C|=Z;if(D=D.next,D===null){if(D=b.shared.pending,D===null)break;nt=D,D=nt.next,nt.next=null,b.lastBaseUpdate=nt,b.shared.pending=null}}while(!0);rt===null&&(U=lt),b.baseState=U,b.firstBaseUpdate=Q,b.lastBaseUpdate=rt,_===null&&(b.shared.lanes=0),Sa|=C,a.lanes=C,a.memoizedState=lt}}function ek(a,c){if(typeof a!="function")throw Error(r(191,a));a.call(c)}function nk(a,c){var f=a.callbacks;if(f!==null)for(a.callbacks=null,a=0;a<f.length;a++)ek(f[a],c)}var Lu=$(null),dg=$(0);function rk(a,c){a=yo,dt(dg,a),dt(Lu,c),yo=a|c.baseLanes}function z_(){dt(dg,yo),dt(Lu,Lu.current)}function H_(){yo=dg.current,ot(Lu),ot(dg)}var zr=$(null),pi=null;function va(a){var c=a.alternate;dt(tn,tn.current&1),dt(zr,a),pi===null&&(c===null||Lu.current!==null||c.memoizedState!==null)&&(pi=a)}function $_(a){dt(tn,tn.current),dt(zr,a),pi===null&&(pi=a)}function ik(a){a.tag===22?(dt(tn,tn.current),dt(zr,a),pi===null&&(pi=a)):ba()}function ba(){dt(tn,tn.current),dt(zr,zr.current)}function Hr(a){ot(zr),pi===a&&(pi=null),ot(tn)}var tn=$(0);function pg(a){for(var c=a;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||XT(f)||QT(f)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var lo=0,Ht=null,ve=null,fn=null,mg=!1,Vu=!1,cc=!1,gg=0,Kf=0,ju=null,GU=0;function He(){throw Error(r(321))}function q_(a,c){if(c===null)return!1;for(var f=0;f<c.length&&f<a.length;f++)if(!Fr(a[f],c[f]))return!1;return!0}function G_(a,c,f,p,b,_){return lo=_,Ht=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,J.H=a===null||a.memoizedState===null?Uk:aT,cc=!1,_=f(p,b),cc=!1,Vu&&(_=ok(c,f,p,b)),sk(a),_}function sk(a){J.H=Jf;var c=ve!==null&&ve.next!==null;if(lo=0,fn=ve=Ht=null,mg=!1,Kf=0,ju=null,c)throw Error(r(300));a===null||dn||(a=a.dependencies,a!==null&&og(a)&&(dn=!0))}function ok(a,c,f,p){Ht=a;var b=0;do{if(Vu&&(ju=null),Kf=0,Vu=!1,25<=b)throw Error(r(301));if(b+=1,fn=ve=null,a.updateQueue!=null){var _=a.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}J.H=zk,_=c(f,p)}while(Vu);return _}function WU(){var a=J.H,c=a.useState()[0];return c=typeof c.then=="function"?Xf(c):c,a=a.useState()[0],(ve!==null?ve.memoizedState:null)!==a&&(Ht.flags|=1024),c}function W_(){var a=gg!==0;return gg=0,a}function Y_(a,c,f){c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~f}function K_(a){if(mg){for(a=a.memoizedState;a!==null;){var c=a.queue;c!==null&&(c.pending=null),a=a.next}mg=!1}lo=0,fn=ve=Ht=null,Vu=!1,Kf=gg=0,ju=null}function lr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?Ht.memoizedState=fn=a:fn=fn.next=a,fn}function en(){if(ve===null){var a=Ht.alternate;a=a!==null?a.memoizedState:null}else a=ve.next;var c=fn===null?Ht.memoizedState:fn.next;if(c!==null)fn=c,ve=a;else{if(a===null)throw Ht.alternate===null?Error(r(467)):Error(r(310));ve=a,a={memoizedState:ve.memoizedState,baseState:ve.baseState,baseQueue:ve.baseQueue,queue:ve.queue,next:null},fn===null?Ht.memoizedState=fn=a:fn=fn.next=a}return fn}function yg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xf(a){var c=Kf;return Kf+=1,ju===null&&(ju=[]),a=XA(ju,a,c),c=Ht,(fn===null?c.memoizedState:fn.next)===null&&(c=c.alternate,J.H=c===null||c.memoizedState===null?Uk:aT),a}function vg(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Xf(a);if(a.$$typeof===P)return Bn(a)}throw Error(r(438,String(a)))}function X_(a){var c=null,f=Ht.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var p=Ht.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(c={data:p.data.map(function(b){return b.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=yg(),Ht.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(a),p=0;p<a;p++)f[p]=B;return c.index++,f}function co(a,c){return typeof c=="function"?c(a):c}function bg(a){var c=en();return Q_(c,ve,a)}function Q_(a,c,f){var p=a.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=f;var b=a.baseQueue,_=p.pending;if(_!==null){if(b!==null){var C=b.next;b.next=_.next,_.next=C}c.baseQueue=b=_,p.pending=null}if(_=a.baseState,b===null)a.memoizedState=_;else{c=b.next;var D=C=null,U=null,Q=c,rt=!1;do{var lt=Q.lane&-536870913;if(lt!==Q.lane?(Xt&lt)===lt:(lo&lt)===lt){var Z=Q.revertLane;if(Z===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),lt===Ou&&(rt=!0);else if((lo&Z)===Z){Q=Q.next,Z===Ou&&(rt=!0);continue}else lt={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},U===null?(D=U=lt,C=_):U=U.next=lt,Ht.lanes|=Z,Sa|=Z;lt=Q.action,cc&&f(_,lt),_=Q.hasEagerState?Q.eagerState:f(_,lt)}else Z={lane:lt,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},U===null?(D=U=Z,C=_):U=U.next=Z,Ht.lanes|=lt,Sa|=lt;Q=Q.next}while(Q!==null&&Q!==c);if(U===null?C=_:U.next=D,!Fr(_,a.memoizedState)&&(dn=!0,rt&&(f=Iu,f!==null)))throw f;a.memoizedState=_,a.baseState=C,a.baseQueue=U,p.lastRenderedState=_}return b===null&&(p.lanes=0),[a.memoizedState,p.dispatch]}function J_(a){var c=en(),f=c.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=a;var p=f.dispatch,b=f.pending,_=c.memoizedState;if(b!==null){f.pending=null;var C=b=b.next;do _=a(_,C.action),C=C.next;while(C!==b);Fr(_,c.memoizedState)||(dn=!0),c.memoizedState=_,c.baseQueue===null&&(c.baseState=_),f.lastRenderedState=_}return[_,p]}function ak(a,c,f){var p=Ht,b=en(),_=ee;if(_){if(f===void 0)throw Error(r(407));f=f()}else f=c();var C=!Fr((ve||b).memoizedState,f);if(C&&(b.memoizedState=f,dn=!0),b=b.queue,eT(uk.bind(null,p,b,a),[a]),b.getSnapshot!==c||C||fn!==null&&fn.memoizedState.tag&1){if(p.flags|=2048,Bu(9,{destroy:void 0},ck.bind(null,p,b,f,c),null),xe===null)throw Error(r(349));_||(lo&127)!==0||lk(p,c,f)}return f}function lk(a,c,f){a.flags|=16384,a={getSnapshot:c,value:f},c=Ht.updateQueue,c===null?(c=yg(),Ht.updateQueue=c,c.stores=[a]):(f=c.stores,f===null?c.stores=[a]:f.push(a))}function ck(a,c,f,p){c.value=f,c.getSnapshot=p,hk(c)&&fk(a)}function uk(a,c,f){return f(function(){hk(c)&&fk(a)})}function hk(a){var c=a.getSnapshot;a=a.value;try{var f=c();return!Fr(a,f)}catch{return!0}}function fk(a){var c=tc(a,2);c!==null&&Rr(c,a,2)}function Z_(a){var c=lr();if(typeof a=="function"){var f=a;if(a=f(),cc){ii(!0);try{f()}finally{ii(!1)}}}return c.memoizedState=c.baseState=a,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:co,lastRenderedState:a},c}function dk(a,c,f,p){return a.baseState=f,Q_(a,ve,typeof p=="function"?p:co)}function YU(a,c,f,p,b){if(Sg(a))throw Error(r(485));if(a=c.action,a!==null){var _={payload:b,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){_.listeners.push(C)}};J.T!==null?f(!0):_.isTransition=!1,p(_),f=c.pending,f===null?(_.next=c.pending=_,pk(c,_)):(_.next=f.next,c.pending=f.next=_)}}function pk(a,c){var f=c.action,p=c.payload,b=a.state;if(c.isTransition){var _=J.T,C={};J.T=C;try{var D=f(b,p),U=J.S;U!==null&&U(C,D),mk(a,c,D)}catch(Q){tT(a,c,Q)}finally{_!==null&&C.types!==null&&(_.types=C.types),J.T=_}}else try{_=f(b,p),mk(a,c,_)}catch(Q){tT(a,c,Q)}}function mk(a,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(p){gk(a,c,p)},function(p){return tT(a,c,p)}):gk(a,c,f)}function gk(a,c,f){c.status="fulfilled",c.value=f,yk(c),a.state=f,c=a.pending,c!==null&&(f=c.next,f===c?a.pending=null:(f=f.next,c.next=f,pk(a,f)))}function tT(a,c,f){var p=a.pending;if(a.pending=null,p!==null){p=p.next;do c.status="rejected",c.reason=f,yk(c),c=c.next;while(c!==p)}a.action=null}function yk(a){a=a.listeners;for(var c=0;c<a.length;c++)(0,a[c])()}function vk(a,c){return c}function bk(a,c){if(ee){var f=xe.formState;if(f!==null){t:{var p=Ht;if(ee){if(Me){e:{for(var b=Me,_=di;b.nodeType!==8;){if(!_){b=null;break e}if(b=mi(b.nextSibling),b===null){b=null;break e}}_=b.data,b=_==="F!"||_==="F"?b:null}if(b){Me=mi(b.nextSibling),p=b.data==="F!";break t}}da(p)}p=!1}p&&(c=f[0])}}return f=lr(),f.memoizedState=f.baseState=c,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vk,lastRenderedState:c},f.queue=p,f=jk.bind(null,Ht,p),p.dispatch=f,p=Z_(!1),_=oT.bind(null,Ht,!1,p.queue),p=lr(),b={state:c,dispatch:null,action:a,pending:null},p.queue=b,f=YU.bind(null,Ht,b,_,f),b.dispatch=f,p.memoizedState=a,[c,f,!1]}function _k(a){var c=en();return Tk(c,ve,a)}function Tk(a,c,f){if(c=Q_(a,c,vk)[0],a=bg(co)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var p=Xf(c)}catch(C){throw C===Pu?cg:C}else p=c;c=en();var b=c.queue,_=b.dispatch;return f!==c.memoizedState&&(Ht.flags|=2048,Bu(9,{destroy:void 0},KU.bind(null,b,f),null)),[p,_,a]}function KU(a,c){a.action=c}function Sk(a){var c=en(),f=ve;if(f!==null)return Tk(c,f,a);en(),c=c.memoizedState,f=en();var p=f.queue.dispatch;return f.memoizedState=a,[c,p,!1]}function Bu(a,c,f,p){return a={tag:a,create:f,deps:p,inst:c,next:null},c=Ht.updateQueue,c===null&&(c=yg(),Ht.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=a.next=a:(p=f.next,f.next=a,a.next=p,c.lastEffect=a),a}function wk(){return en().memoizedState}function _g(a,c,f,p){var b=lr();Ht.flags|=a,b.memoizedState=Bu(1|c,{destroy:void 0},f,p===void 0?null:p)}function Tg(a,c,f,p){var b=en();p=p===void 0?null:p;var _=b.memoizedState.inst;ve!==null&&p!==null&&q_(p,ve.memoizedState.deps)?b.memoizedState=Bu(c,_,f,p):(Ht.flags|=a,b.memoizedState=Bu(1|c,_,f,p))}function xk(a,c){_g(8390656,8,a,c)}function eT(a,c){Tg(2048,8,a,c)}function XU(a){Ht.flags|=4;var c=Ht.updateQueue;if(c===null)c=yg(),Ht.updateQueue=c,c.events=[a];else{var f=c.events;f===null?c.events=[a]:f.push(a)}}function Ek(a){var c=en().memoizedState;return XU({ref:c,nextImpl:a}),function(){if((le&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}function Ck(a,c){return Tg(4,2,a,c)}function Ak(a,c){return Tg(4,4,a,c)}function kk(a,c){if(typeof c=="function"){a=a();var f=c(a);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function Rk(a,c,f){f=f!=null?f.concat([a]):null,Tg(4,4,kk.bind(null,c,a),f)}function nT(){}function Mk(a,c){var f=en();c=c===void 0?null:c;var p=f.memoizedState;return c!==null&&q_(c,p[1])?p[0]:(f.memoizedState=[a,c],a)}function Dk(a,c){var f=en();c=c===void 0?null:c;var p=f.memoizedState;if(c!==null&&q_(c,p[1]))return p[0];if(p=a(),cc){ii(!0);try{a()}finally{ii(!1)}}return f.memoizedState=[p,c],p}function rT(a,c,f){return f===void 0||(lo&1073741824)!==0&&(Xt&261930)===0?a.memoizedState=c:(a.memoizedState=f,a=OR(),Ht.lanes|=a,Sa|=a,f)}function Ok(a,c,f,p){return Fr(f,c)?f:Lu.current!==null?(a=rT(a,f,p),Fr(a,c)||(dn=!0),a):(lo&42)===0||(lo&1073741824)!==0&&(Xt&261930)===0?(dn=!0,a.memoizedState=f):(a=OR(),Ht.lanes|=a,Sa|=a,c)}function Ik(a,c,f,p,b){var _=st.p;st.p=_!==0&&8>_?_:8;var C=J.T,D={};J.T=D,oT(a,!1,c,f);try{var U=b(),Q=J.S;if(Q!==null&&Q(D,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var rt=qU(U,p);Qf(a,c,rt,Gr(a))}else Qf(a,c,p,Gr(a))}catch(lt){Qf(a,c,{then:function(){},status:"rejected",reason:lt},Gr())}finally{st.p=_,C!==null&&D.types!==null&&(C.types=D.types),J.T=C}}function QU(){}function iT(a,c,f,p){if(a.tag!==5)throw Error(r(476));var b=Pk(a).queue;Ik(a,b,c,ht,f===null?QU:function(){return Nk(a),f(p)})}function Pk(a){var c=a.memoizedState;if(c!==null)return c;c={memoizedState:ht,baseState:ht,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:co,lastRenderedState:ht},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:co,lastRenderedState:f},next:null},a.memoizedState=c,a=a.alternate,a!==null&&(a.memoizedState=c),c}function Nk(a){var c=Pk(a);c.next===null&&(c=a.alternate.memoizedState),Qf(a,c.next.queue,{},Gr())}function sT(){return Bn(pd)}function Lk(){return en().memoizedState}function Vk(){return en().memoizedState}function JU(a){for(var c=a.return;c!==null;){switch(c.tag){case 24:case 3:var f=Gr();a=ga(f);var p=ya(c,a,f);p!==null&&(Rr(p,c,f),Gf(p,c,f)),c={cache:P_()},a.payload=c;return}c=c.return}}function ZU(a,c,f){var p=Gr();f={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Sg(a)?Bk(c,f):(f=w_(a,c,f,p),f!==null&&(Rr(f,a,p),Fk(f,c,p)))}function jk(a,c,f){var p=Gr();Qf(a,c,f,p)}function Qf(a,c,f,p){var b={lane:p,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Sg(a))Bk(c,b);else{var _=a.alternate;if(a.lanes===0&&(_===null||_.lanes===0)&&(_=c.lastRenderedReducer,_!==null))try{var C=c.lastRenderedState,D=_(C,f);if(b.hasEagerState=!0,b.eagerState=D,Fr(D,C))return ng(a,c,b,0),xe===null&&eg(),!1}catch{}if(f=w_(a,c,b,p),f!==null)return Rr(f,a,p),Fk(f,c,p),!0}return!1}function oT(a,c,f,p){if(p={lane:2,revertLane:jT(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Sg(a)){if(c)throw Error(r(479))}else c=w_(a,f,p,2),c!==null&&Rr(c,a,2)}function Sg(a){var c=a.alternate;return a===Ht||c!==null&&c===Ht}function Bk(a,c){Vu=mg=!0;var f=a.pending;f===null?c.next=c:(c.next=f.next,f.next=c),a.pending=c}function Fk(a,c,f){if((f&4194048)!==0){var p=c.lanes;p&=a.pendingLanes,f|=p,c.lanes=f,bf(a,f)}}var Jf={readContext:Bn,use:vg,useCallback:He,useContext:He,useEffect:He,useImperativeHandle:He,useLayoutEffect:He,useInsertionEffect:He,useMemo:He,useReducer:He,useRef:He,useState:He,useDebugValue:He,useDeferredValue:He,useTransition:He,useSyncExternalStore:He,useId:He,useHostTransitionStatus:He,useFormState:He,useActionState:He,useOptimistic:He,useMemoCache:He,useCacheRefresh:He};Jf.useEffectEvent=He;var Uk={readContext:Bn,use:vg,useCallback:function(a,c){return lr().memoizedState=[a,c===void 0?null:c],a},useContext:Bn,useEffect:xk,useImperativeHandle:function(a,c,f){f=f!=null?f.concat([a]):null,_g(4194308,4,kk.bind(null,c,a),f)},useLayoutEffect:function(a,c){return _g(4194308,4,a,c)},useInsertionEffect:function(a,c){_g(4,2,a,c)},useMemo:function(a,c){var f=lr();c=c===void 0?null:c;var p=a();if(cc){ii(!0);try{a()}finally{ii(!1)}}return f.memoizedState=[p,c],p},useReducer:function(a,c,f){var p=lr();if(f!==void 0){var b=f(c);if(cc){ii(!0);try{f(c)}finally{ii(!1)}}}else b=c;return p.memoizedState=p.baseState=b,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:b},p.queue=a,a=a.dispatch=ZU.bind(null,Ht,a),[p.memoizedState,a]},useRef:function(a){var c=lr();return a={current:a},c.memoizedState=a},useState:function(a){a=Z_(a);var c=a.queue,f=jk.bind(null,Ht,c);return c.dispatch=f,[a.memoizedState,f]},useDebugValue:nT,useDeferredValue:function(a,c){var f=lr();return rT(f,a,c)},useTransition:function(){var a=Z_(!1);return a=Ik.bind(null,Ht,a.queue,!0,!1),lr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,c,f){var p=Ht,b=lr();if(ee){if(f===void 0)throw Error(r(407));f=f()}else{if(f=c(),xe===null)throw Error(r(349));(Xt&127)!==0||lk(p,c,f)}b.memoizedState=f;var _={value:f,getSnapshot:c};return b.queue=_,xk(uk.bind(null,p,_,a),[a]),p.flags|=2048,Bu(9,{destroy:void 0},ck.bind(null,p,_,f,c),null),f},useId:function(){var a=lr(),c=xe.identifierPrefix;if(ee){var f=As,p=Cs;f=(p&~(1<<32-Je(p)-1)).toString(32)+f,c="_"+c+"R_"+f,f=gg++,0<f&&(c+="H"+f.toString(32)),c+="_"}else f=GU++,c="_"+c+"r_"+f.toString(32)+"_";return a.memoizedState=c},useHostTransitionStatus:sT,useFormState:bk,useActionState:bk,useOptimistic:function(a){var c=lr();c.memoizedState=c.baseState=a;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=oT.bind(null,Ht,!0,f),f.dispatch=c,[a,c]},useMemoCache:X_,useCacheRefresh:function(){return lr().memoizedState=JU.bind(null,Ht)},useEffectEvent:function(a){var c=lr(),f={impl:a};return c.memoizedState=f,function(){if((le&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},aT={readContext:Bn,use:vg,useCallback:Mk,useContext:Bn,useEffect:eT,useImperativeHandle:Rk,useInsertionEffect:Ck,useLayoutEffect:Ak,useMemo:Dk,useReducer:bg,useRef:wk,useState:function(){return bg(co)},useDebugValue:nT,useDeferredValue:function(a,c){var f=en();return Ok(f,ve.memoizedState,a,c)},useTransition:function(){var a=bg(co)[0],c=en().memoizedState;return[typeof a=="boolean"?a:Xf(a),c]},useSyncExternalStore:ak,useId:Lk,useHostTransitionStatus:sT,useFormState:_k,useActionState:_k,useOptimistic:function(a,c){var f=en();return dk(f,ve,a,c)},useMemoCache:X_,useCacheRefresh:Vk};aT.useEffectEvent=Ek;var zk={readContext:Bn,use:vg,useCallback:Mk,useContext:Bn,useEffect:eT,useImperativeHandle:Rk,useInsertionEffect:Ck,useLayoutEffect:Ak,useMemo:Dk,useReducer:J_,useRef:wk,useState:function(){return J_(co)},useDebugValue:nT,useDeferredValue:function(a,c){var f=en();return ve===null?rT(f,a,c):Ok(f,ve.memoizedState,a,c)},useTransition:function(){var a=J_(co)[0],c=en().memoizedState;return[typeof a=="boolean"?a:Xf(a),c]},useSyncExternalStore:ak,useId:Lk,useHostTransitionStatus:sT,useFormState:Sk,useActionState:Sk,useOptimistic:function(a,c){var f=en();return ve!==null?dk(f,ve,a,c):(f.baseState=a,[a,f.queue.dispatch])},useMemoCache:X_,useCacheRefresh:Vk};zk.useEffectEvent=Ek;function lT(a,c,f,p){c=a.memoizedState,f=f(p,c),f=f==null?c:m({},c,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var cT={enqueueSetState:function(a,c,f){a=a._reactInternals;var p=Gr(),b=ga(p);b.payload=c,f!=null&&(b.callback=f),c=ya(a,b,p),c!==null&&(Rr(c,a,p),Gf(c,a,p))},enqueueReplaceState:function(a,c,f){a=a._reactInternals;var p=Gr(),b=ga(p);b.tag=1,b.payload=c,f!=null&&(b.callback=f),c=ya(a,b,p),c!==null&&(Rr(c,a,p),Gf(c,a,p))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var f=Gr(),p=ga(f);p.tag=2,c!=null&&(p.callback=c),c=ya(a,p,f),c!==null&&(Rr(c,a,f),Gf(c,a,f))}};function Hk(a,c,f,p,b,_,C){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(p,_,C):c.prototype&&c.prototype.isPureReactComponent?!jf(f,p)||!jf(b,_):!0}function $k(a,c,f,p){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,p),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,p),c.state!==a&&cT.enqueueReplaceState(c,c.state,null)}function uc(a,c){var f=c;if("ref"in c){f={};for(var p in c)p!=="ref"&&(f[p]=c[p])}if(a=a.defaultProps){f===c&&(f=m({},f));for(var b in a)f[b]===void 0&&(f[b]=a[b])}return f}function qk(a){tg(a)}function Gk(a){console.error(a)}function Wk(a){tg(a)}function wg(a,c){try{var f=a.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(p){setTimeout(function(){throw p})}}function Yk(a,c,f){try{var p=a.onCaughtError;p(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function uT(a,c,f){return f=ga(f),f.tag=3,f.payload={element:null},f.callback=function(){wg(a,c)},f}function Kk(a){return a=ga(a),a.tag=3,a}function Xk(a,c,f,p){var b=f.type.getDerivedStateFromError;if(typeof b=="function"){var _=p.value;a.payload=function(){return b(_)},a.callback=function(){Yk(c,f,p)}}var C=f.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(a.callback=function(){Yk(c,f,p),typeof b!="function"&&(wa===null?wa=new Set([this]):wa.add(this));var D=p.stack;this.componentDidCatch(p.value,{componentStack:D!==null?D:""})})}function tz(a,c,f,p,b){if(f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(c=f.alternate,c!==null&&Du(c,f,b,!0),f=zr.current,f!==null){switch(f.tag){case 31:case 13:return pi===null?Ng():f.alternate===null&&$e===0&&($e=3),f.flags&=-257,f.flags|=65536,f.lanes=b,p===ug?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([p]):c.add(p),NT(a,p,b)),!1;case 22:return f.flags|=65536,p===ug?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([p])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([p]):f.add(p)),NT(a,p,b)),!1}throw Error(r(435,f.tag))}return NT(a,p,b),Ng(),!1}if(ee)return c=zr.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=b,p!==R_&&(a=Error(r(422),{cause:p}),Uf(ui(a,f)))):(p!==R_&&(c=Error(r(423),{cause:p}),Uf(ui(c,f))),a=a.current.alternate,a.flags|=65536,b&=-b,a.lanes|=b,p=ui(p,f),b=uT(a.stateNode,p,b),F_(a,b),$e!==4&&($e=2)),!1;var _=Error(r(520),{cause:p});if(_=ui(_,f),od===null?od=[_]:od.push(_),$e!==4&&($e=2),c===null)return!0;p=ui(p,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,a=b&-b,f.lanes|=a,a=uT(f.stateNode,p,a),F_(f,a),!1;case 1:if(c=f.type,_=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(wa===null||!wa.has(_))))return f.flags|=65536,b&=-b,f.lanes|=b,b=Kk(b),Xk(b,a,f,p),F_(f,b),!1}f=f.return}while(f!==null);return!1}var hT=Error(r(461)),dn=!1;function Fn(a,c,f,p){c.child=a===null?tk(c,null,f,p):lc(c,a.child,f,p)}function Qk(a,c,f,p,b){f=f.render;var _=c.ref;if("ref"in p){var C={};for(var D in p)D!=="ref"&&(C[D]=p[D])}else C=p;return ic(c),p=G_(a,c,f,C,_,b),D=W_(),a!==null&&!dn?(Y_(a,c,b),uo(a,c,b)):(ee&&D&&A_(c),c.flags|=1,Fn(a,c,p,b),c.child)}function Jk(a,c,f,p,b){if(a===null){var _=f.type;return typeof _=="function"&&!x_(_)&&_.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=_,Zk(a,c,_,p,b)):(a=ig(f.type,null,p,c,c.mode,b),a.ref=c.ref,a.return=c,c.child=a)}if(_=a.child,!bT(a,b)){var C=_.memoizedProps;if(f=f.compare,f=f!==null?f:jf,f(C,p)&&a.ref===c.ref)return uo(a,c,b)}return c.flags|=1,a=io(_,p),a.ref=c.ref,a.return=c,c.child=a}function Zk(a,c,f,p,b){if(a!==null){var _=a.memoizedProps;if(jf(_,p)&&a.ref===c.ref)if(dn=!1,c.pendingProps=p=_,bT(a,b))(a.flags&131072)!==0&&(dn=!0);else return c.lanes=a.lanes,uo(a,c,b)}return fT(a,c,f,p,b)}function tR(a,c,f,p){var b=p.children,_=a!==null?a.memoizedState:null;if(a===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((c.flags&128)!==0){if(_=_!==null?_.baseLanes|f:f,a!==null){for(p=c.child=a.child,b=0;p!==null;)b=b|p.lanes|p.childLanes,p=p.sibling;p=b&~_}else p=0,c.child=null;return eR(a,c,_,f,p)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},a!==null&&lg(c,_!==null?_.cachePool:null),_!==null?rk(c,_):z_(),ik(c);else return p=c.lanes=536870912,eR(a,c,_!==null?_.baseLanes|f:f,f,p)}else _!==null?(lg(c,_.cachePool),rk(c,_),ba(),c.memoizedState=null):(a!==null&&lg(c,null),z_(),ba());return Fn(a,c,b,f),c.child}function Zf(a,c){return a!==null&&a.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function eR(a,c,f,p,b){var _=L_();return _=_===null?null:{parent:hn._currentValue,pool:_},c.memoizedState={baseLanes:f,cachePool:_},a!==null&&lg(c,null),z_(),ik(c),a!==null&&Du(a,c,p,!0),c.childLanes=b,null}function xg(a,c){return c=Cg({mode:c.mode,children:c.children},a.mode),c.ref=a.ref,a.child=c,c.return=a,c}function nR(a,c,f){return lc(c,a.child,null,f),a=xg(c,c.pendingProps),a.flags|=2,Hr(c),c.memoizedState=null,a}function ez(a,c,f){var p=c.pendingProps,b=(c.flags&128)!==0;if(c.flags&=-129,a===null){if(ee){if(p.mode==="hidden")return a=xg(c,p),c.lanes=536870912,Zf(null,a);if($_(c),(a=Me)?(a=pM(a,di),a=a!==null&&a.data==="&"?a:null,a!==null&&(c.memoizedState={dehydrated:a,treeContext:ha!==null?{id:Cs,overflow:As}:null,retryLane:536870912,hydrationErrors:null},f=BA(a),f.return=c,c.child=f,jn=c,Me=null)):a=null,a===null)throw da(c);return c.lanes=536870912,null}return xg(c,p)}var _=a.memoizedState;if(_!==null){var C=_.dehydrated;if($_(c),b)if(c.flags&256)c.flags&=-257,c=nR(a,c,f);else if(c.memoizedState!==null)c.child=a.child,c.flags|=128,c=null;else throw Error(r(558));else if(dn||Du(a,c,f,!1),b=(f&a.childLanes)!==0,dn||b){if(p=xe,p!==null&&(C=_f(p,f),C!==0&&C!==_.retryLane))throw _.retryLane=C,tc(a,C),Rr(p,a,C),hT;Ng(),c=nR(a,c,f)}else a=_.treeContext,Me=mi(C.nextSibling),jn=c,ee=!0,fa=null,di=!1,a!==null&&zA(c,a),c=xg(c,p),c.flags|=4096;return c}return a=io(a.child,{mode:p.mode,children:p.children}),a.ref=c.ref,c.child=a,a.return=c,a}function Eg(a,c){var f=c.ref;if(f===null)a!==null&&a.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(a===null||a.ref!==f)&&(c.flags|=4194816)}}function fT(a,c,f,p,b){return ic(c),f=G_(a,c,f,p,void 0,b),p=W_(),a!==null&&!dn?(Y_(a,c,b),uo(a,c,b)):(ee&&p&&A_(c),c.flags|=1,Fn(a,c,f,b),c.child)}function rR(a,c,f,p,b,_){return ic(c),c.updateQueue=null,f=ok(c,p,f,b),sk(a),p=W_(),a!==null&&!dn?(Y_(a,c,_),uo(a,c,_)):(ee&&p&&A_(c),c.flags|=1,Fn(a,c,f,_),c.child)}function iR(a,c,f,p,b){if(ic(c),c.stateNode===null){var _=Au,C=f.contextType;typeof C=="object"&&C!==null&&(_=Bn(C)),_=new f(p,_),c.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=cT,c.stateNode=_,_._reactInternals=c,_=c.stateNode,_.props=p,_.state=c.memoizedState,_.refs={},j_(c),C=f.contextType,_.context=typeof C=="object"&&C!==null?Bn(C):Au,_.state=c.memoizedState,C=f.getDerivedStateFromProps,typeof C=="function"&&(lT(c,f,C,p),_.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(C=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),C!==_.state&&cT.enqueueReplaceState(_,_.state,null),Yf(c,p,_,b),Wf(),_.state=c.memoizedState),typeof _.componentDidMount=="function"&&(c.flags|=4194308),p=!0}else if(a===null){_=c.stateNode;var D=c.memoizedProps,U=uc(f,D);_.props=U;var Q=_.context,rt=f.contextType;C=Au,typeof rt=="object"&&rt!==null&&(C=Bn(rt));var lt=f.getDerivedStateFromProps;rt=typeof lt=="function"||typeof _.getSnapshotBeforeUpdate=="function",D=c.pendingProps!==D,rt||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(D||Q!==C)&&$k(c,_,p,C),ma=!1;var Z=c.memoizedState;_.state=Z,Yf(c,p,_,b),Wf(),Q=c.memoizedState,D||Z!==Q||ma?(typeof lt=="function"&&(lT(c,f,lt,p),Q=c.memoizedState),(U=ma||Hk(c,f,U,p,Z,Q,C))?(rt||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(c.flags|=4194308)):(typeof _.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=p,c.memoizedState=Q),_.props=p,_.state=Q,_.context=C,p=U):(typeof _.componentDidMount=="function"&&(c.flags|=4194308),p=!1)}else{_=c.stateNode,B_(a,c),C=c.memoizedProps,rt=uc(f,C),_.props=rt,lt=c.pendingProps,Z=_.context,Q=f.contextType,U=Au,typeof Q=="object"&&Q!==null&&(U=Bn(Q)),D=f.getDerivedStateFromProps,(Q=typeof D=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(C!==lt||Z!==U)&&$k(c,_,p,U),ma=!1,Z=c.memoizedState,_.state=Z,Yf(c,p,_,b),Wf();var nt=c.memoizedState;C!==lt||Z!==nt||ma||a!==null&&a.dependencies!==null&&og(a.dependencies)?(typeof D=="function"&&(lT(c,f,D,p),nt=c.memoizedState),(rt=ma||Hk(c,f,rt,p,Z,nt,U)||a!==null&&a.dependencies!==null&&og(a.dependencies))?(Q||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(p,nt,U),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(p,nt,U)),typeof _.componentDidUpdate=="function"&&(c.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof _.componentDidUpdate!="function"||C===a.memoizedProps&&Z===a.memoizedState||(c.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||C===a.memoizedProps&&Z===a.memoizedState||(c.flags|=1024),c.memoizedProps=p,c.memoizedState=nt),_.props=p,_.state=nt,_.context=U,p=rt):(typeof _.componentDidUpdate!="function"||C===a.memoizedProps&&Z===a.memoizedState||(c.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||C===a.memoizedProps&&Z===a.memoizedState||(c.flags|=1024),p=!1)}return _=p,Eg(a,c),p=(c.flags&128)!==0,_||p?(_=c.stateNode,f=p&&typeof f.getDerivedStateFromError!="function"?null:_.render(),c.flags|=1,a!==null&&p?(c.child=lc(c,a.child,null,b),c.child=lc(c,null,f,b)):Fn(a,c,f,b),c.memoizedState=_.state,a=c.child):a=uo(a,c,b),a}function sR(a,c,f,p){return nc(),c.flags|=256,Fn(a,c,f,p),c.child}var dT={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function pT(a){return{baseLanes:a,cachePool:YA()}}function mT(a,c,f){return a=a!==null?a.childLanes&~f:0,c&&(a|=qr),a}function oR(a,c,f){var p=c.pendingProps,b=!1,_=(c.flags&128)!==0,C;if((C=_)||(C=a!==null&&a.memoizedState===null?!1:(tn.current&2)!==0),C&&(b=!0,c.flags&=-129),C=(c.flags&32)!==0,c.flags&=-33,a===null){if(ee){if(b?va(c):ba(),(a=Me)?(a=pM(a,di),a=a!==null&&a.data!=="&"?a:null,a!==null&&(c.memoizedState={dehydrated:a,treeContext:ha!==null?{id:Cs,overflow:As}:null,retryLane:536870912,hydrationErrors:null},f=BA(a),f.return=c,c.child=f,jn=c,Me=null)):a=null,a===null)throw da(c);return QT(a)?c.lanes=32:c.lanes=536870912,null}var D=p.children;return p=p.fallback,b?(ba(),b=c.mode,D=Cg({mode:"hidden",children:D},b),p=ec(p,b,f,null),D.return=c,p.return=c,D.sibling=p,c.child=D,p=c.child,p.memoizedState=pT(f),p.childLanes=mT(a,C,f),c.memoizedState=dT,Zf(null,p)):(va(c),gT(c,D))}var U=a.memoizedState;if(U!==null&&(D=U.dehydrated,D!==null)){if(_)c.flags&256?(va(c),c.flags&=-257,c=yT(a,c,f)):c.memoizedState!==null?(ba(),c.child=a.child,c.flags|=128,c=null):(ba(),D=p.fallback,b=c.mode,p=Cg({mode:"visible",children:p.children},b),D=ec(D,b,f,null),D.flags|=2,p.return=c,D.return=c,p.sibling=D,c.child=p,lc(c,a.child,null,f),p=c.child,p.memoizedState=pT(f),p.childLanes=mT(a,C,f),c.memoizedState=dT,c=Zf(null,p));else if(va(c),QT(D)){if(C=D.nextSibling&&D.nextSibling.dataset,C)var Q=C.dgst;C=Q,p=Error(r(419)),p.stack="",p.digest=C,Uf({value:p,source:null,stack:null}),c=yT(a,c,f)}else if(dn||Du(a,c,f,!1),C=(f&a.childLanes)!==0,dn||C){if(C=xe,C!==null&&(p=_f(C,f),p!==0&&p!==U.retryLane))throw U.retryLane=p,tc(a,p),Rr(C,a,p),hT;XT(D)||Ng(),c=yT(a,c,f)}else XT(D)?(c.flags|=192,c.child=a.child,c=null):(a=U.treeContext,Me=mi(D.nextSibling),jn=c,ee=!0,fa=null,di=!1,a!==null&&zA(c,a),c=gT(c,p.children),c.flags|=4096);return c}return b?(ba(),D=p.fallback,b=c.mode,U=a.child,Q=U.sibling,p=io(U,{mode:"hidden",children:p.children}),p.subtreeFlags=U.subtreeFlags&65011712,Q!==null?D=io(Q,D):(D=ec(D,b,f,null),D.flags|=2),D.return=c,p.return=c,p.sibling=D,c.child=p,Zf(null,p),p=c.child,D=a.child.memoizedState,D===null?D=pT(f):(b=D.cachePool,b!==null?(U=hn._currentValue,b=b.parent!==U?{parent:U,pool:U}:b):b=YA(),D={baseLanes:D.baseLanes|f,cachePool:b}),p.memoizedState=D,p.childLanes=mT(a,C,f),c.memoizedState=dT,Zf(a.child,p)):(va(c),f=a.child,a=f.sibling,f=io(f,{mode:"visible",children:p.children}),f.return=c,f.sibling=null,a!==null&&(C=c.deletions,C===null?(c.deletions=[a],c.flags|=16):C.push(a)),c.child=f,c.memoizedState=null,f)}function gT(a,c){return c=Cg({mode:"visible",children:c},a.mode),c.return=a,a.child=c}function Cg(a,c){return a=Ur(22,a,null,c),a.lanes=0,a}function yT(a,c,f){return lc(c,a.child,null,f),a=gT(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function aR(a,c,f){a.lanes|=c;var p=a.alternate;p!==null&&(p.lanes|=c),O_(a.return,c,f)}function vT(a,c,f,p,b,_){var C=a.memoizedState;C===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:b,treeForkCount:_}:(C.isBackwards=c,C.rendering=null,C.renderingStartTime=0,C.last=p,C.tail=f,C.tailMode=b,C.treeForkCount=_)}function lR(a,c,f){var p=c.pendingProps,b=p.revealOrder,_=p.tail;p=p.children;var C=tn.current,D=(C&2)!==0;if(D?(C=C&1|2,c.flags|=128):C&=1,dt(tn,C),Fn(a,c,p,f),p=ee?Ff:0,!D&&a!==null&&(a.flags&128)!==0)t:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&aR(a,f,c);else if(a.tag===19)aR(a,f,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break t;for(;a.sibling===null;){if(a.return===null||a.return===c)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(b){case"forwards":for(f=c.child,b=null;f!==null;)a=f.alternate,a!==null&&pg(a)===null&&(b=f),f=f.sibling;f=b,f===null?(b=c.child,c.child=null):(b=f.sibling,f.sibling=null),vT(c,!1,b,f,_,p);break;case"backwards":case"unstable_legacy-backwards":for(f=null,b=c.child,c.child=null;b!==null;){if(a=b.alternate,a!==null&&pg(a)===null){c.child=b;break}a=b.sibling,b.sibling=f,f=b,b=a}vT(c,!0,f,null,_,p);break;case"together":vT(c,!1,null,null,void 0,p);break;default:c.memoizedState=null}return c.child}function uo(a,c,f){if(a!==null&&(c.dependencies=a.dependencies),Sa|=c.lanes,(f&c.childLanes)===0)if(a!==null){if(Du(a,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(a!==null&&c.child!==a.child)throw Error(r(153));if(c.child!==null){for(a=c.child,f=io(a,a.pendingProps),c.child=f,f.return=c;a.sibling!==null;)a=a.sibling,f=f.sibling=io(a,a.pendingProps),f.return=c;f.sibling=null}return c.child}function bT(a,c){return(a.lanes&c)!==0?!0:(a=a.dependencies,!!(a!==null&&og(a)))}function nz(a,c,f){switch(c.tag){case 3:Ve(c,c.stateNode.containerInfo),pa(c,hn,a.memoizedState.cache),nc();break;case 27:case 5:Rt(c);break;case 4:Ve(c,c.stateNode.containerInfo);break;case 10:pa(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,$_(c),null;break;case 13:var p=c.memoizedState;if(p!==null)return p.dehydrated!==null?(va(c),c.flags|=128,null):(f&c.child.childLanes)!==0?oR(a,c,f):(va(c),a=uo(a,c,f),a!==null?a.sibling:null);va(c);break;case 19:var b=(a.flags&128)!==0;if(p=(f&c.childLanes)!==0,p||(Du(a,c,f,!1),p=(f&c.childLanes)!==0),b){if(p)return lR(a,c,f);c.flags|=128}if(b=c.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),dt(tn,tn.current),p)break;return null;case 22:return c.lanes=0,tR(a,c,f,c.pendingProps);case 24:pa(c,hn,a.memoizedState.cache)}return uo(a,c,f)}function cR(a,c,f){if(a!==null)if(a.memoizedProps!==c.pendingProps)dn=!0;else{if(!bT(a,f)&&(c.flags&128)===0)return dn=!1,nz(a,c,f);dn=(a.flags&131072)!==0}else dn=!1,ee&&(c.flags&1048576)!==0&&UA(c,Ff,c.index);switch(c.lanes=0,c.tag){case 16:t:{var p=c.pendingProps;if(a=oc(c.elementType),c.type=a,typeof a=="function")x_(a)?(p=uc(a,p),c.tag=1,c=iR(null,c,a,p,f)):(c.tag=0,c=fT(null,c,a,p,f));else{if(a!=null){var b=a.$$typeof;if(b===j){c.tag=11,c=Qk(null,c,a,p,f);break t}else if(b===M){c.tag=14,c=Jk(null,c,a,p,f);break t}}throw c=yt(a)||a,Error(r(306,c,""))}}return c;case 0:return fT(a,c,c.type,c.pendingProps,f);case 1:return p=c.type,b=uc(p,c.pendingProps),iR(a,c,p,b,f);case 3:t:{if(Ve(c,c.stateNode.containerInfo),a===null)throw Error(r(387));p=c.pendingProps;var _=c.memoizedState;b=_.element,B_(a,c),Yf(c,p,null,f);var C=c.memoizedState;if(p=C.cache,pa(c,hn,p),p!==_.cache&&I_(c,[hn],f,!0),Wf(),p=C.element,_.isDehydrated)if(_={element:p,isDehydrated:!1,cache:C.cache},c.updateQueue.baseState=_,c.memoizedState=_,c.flags&256){c=sR(a,c,p,f);break t}else if(p!==b){b=ui(Error(r(424)),c),Uf(b),c=sR(a,c,p,f);break t}else for(a=c.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,Me=mi(a.firstChild),jn=c,ee=!0,fa=null,di=!0,f=tk(c,null,p,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(nc(),p===b){c=uo(a,c,f);break t}Fn(a,c,p,f)}c=c.child}return c;case 26:return Eg(a,c),a===null?(f=_M(c.type,null,c.pendingProps,null))?c.memoizedState=f:ee||(f=c.type,a=c.pendingProps,p=zg(It.current).createElement(f),p[ln]=c,p[An]=a,Un(p,f,a),cn(p),c.stateNode=p):c.memoizedState=_M(c.type,a.memoizedProps,c.pendingProps,a.memoizedState),null;case 27:return Rt(c),a===null&&ee&&(p=c.stateNode=yM(c.type,c.pendingProps,It.current),jn=c,di=!0,b=Me,Aa(c.type)?(JT=b,Me=mi(p.firstChild)):Me=b),Fn(a,c,c.pendingProps.children,f),Eg(a,c),a===null&&(c.flags|=4194304),c.child;case 5:return a===null&&ee&&((b=p=Me)&&(p=Oz(p,c.type,c.pendingProps,di),p!==null?(c.stateNode=p,jn=c,Me=mi(p.firstChild),di=!1,b=!0):b=!1),b||da(c)),Rt(c),b=c.type,_=c.pendingProps,C=a!==null?a.memoizedProps:null,p=_.children,WT(b,_)?p=null:C!==null&&WT(b,C)&&(c.flags|=32),c.memoizedState!==null&&(b=G_(a,c,WU,null,null,f),pd._currentValue=b),Eg(a,c),Fn(a,c,p,f),c.child;case 6:return a===null&&ee&&((a=f=Me)&&(f=Iz(f,c.pendingProps,di),f!==null?(c.stateNode=f,jn=c,Me=null,a=!0):a=!1),a||da(c)),null;case 13:return oR(a,c,f);case 4:return Ve(c,c.stateNode.containerInfo),p=c.pendingProps,a===null?c.child=lc(c,null,p,f):Fn(a,c,p,f),c.child;case 11:return Qk(a,c,c.type,c.pendingProps,f);case 7:return Fn(a,c,c.pendingProps,f),c.child;case 8:return Fn(a,c,c.pendingProps.children,f),c.child;case 12:return Fn(a,c,c.pendingProps.children,f),c.child;case 10:return p=c.pendingProps,pa(c,c.type,p.value),Fn(a,c,p.children,f),c.child;case 9:return b=c.type._context,p=c.pendingProps.children,ic(c),b=Bn(b),p=p(b),c.flags|=1,Fn(a,c,p,f),c.child;case 14:return Jk(a,c,c.type,c.pendingProps,f);case 15:return Zk(a,c,c.type,c.pendingProps,f);case 19:return lR(a,c,f);case 31:return ez(a,c,f);case 22:return tR(a,c,f,c.pendingProps);case 24:return ic(c),p=Bn(hn),a===null?(b=L_(),b===null&&(b=xe,_=P_(),b.pooledCache=_,_.refCount++,_!==null&&(b.pooledCacheLanes|=f),b=_),c.memoizedState={parent:p,cache:b},j_(c),pa(c,hn,b)):((a.lanes&f)!==0&&(B_(a,c),Yf(c,null,null,f),Wf()),b=a.memoizedState,_=c.memoizedState,b.parent!==p?(b={parent:p,cache:p},c.memoizedState=b,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=b),pa(c,hn,p)):(p=_.cache,pa(c,hn,p),p!==b.cache&&I_(c,[hn],f,!0))),Fn(a,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function ho(a){a.flags|=4}function _T(a,c,f,p,b){if((c=(a.mode&32)!==0)&&(c=!1),c){if(a.flags|=16777216,(b&335544128)===b)if(a.stateNode.complete)a.flags|=8192;else if(LR())a.flags|=8192;else throw ac=ug,V_}else a.flags&=-16777217}function uR(a,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!EM(c))if(LR())a.flags|=8192;else throw ac=ug,V_}function Ag(a,c){c!==null&&(a.flags|=4),a.flags&16384&&(c=a.tag!==22?Im():536870912,a.lanes|=c,Hu|=c)}function td(a,c){if(!ee)switch(a.tailMode){case"hidden":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:p.sibling=null}}function De(a){var c=a.alternate!==null&&a.alternate.child===a.child,f=0,p=0;if(c)for(var b=a.child;b!==null;)f|=b.lanes|b.childLanes,p|=b.subtreeFlags&65011712,p|=b.flags&65011712,b.return=a,b=b.sibling;else for(b=a.child;b!==null;)f|=b.lanes|b.childLanes,p|=b.subtreeFlags,p|=b.flags,b.return=a,b=b.sibling;return a.subtreeFlags|=p,a.childLanes=f,c}function rz(a,c,f){var p=c.pendingProps;switch(k_(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return De(c),null;case 1:return De(c),null;case 3:return f=c.stateNode,p=null,a!==null&&(p=a.memoizedState.cache),c.memoizedState.cache!==p&&(c.flags|=2048),ao(hn),ce(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(a===null||a.child===null)&&(Mu(c)?ho(c):a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,M_())),De(c),null;case 26:var b=c.type,_=c.memoizedState;return a===null?(ho(c),_!==null?(De(c),uR(c,_)):(De(c),_T(c,b,null,p,f))):_?_!==a.memoizedState?(ho(c),De(c),uR(c,_)):(De(c),c.flags&=-16777217):(a=a.memoizedProps,a!==p&&ho(c),De(c),_T(c,b,a,p,f)),null;case 27:if(ge(c),f=It.current,b=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==p&&ho(c);else{if(!p){if(c.stateNode===null)throw Error(r(166));return De(c),null}a=mt.current,Mu(c)?HA(c):(a=yM(b,p,f),c.stateNode=a,ho(c))}return De(c),null;case 5:if(ge(c),b=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==p&&ho(c);else{if(!p){if(c.stateNode===null)throw Error(r(166));return De(c),null}if(_=mt.current,Mu(c))HA(c);else{var C=zg(It.current);switch(_){case 1:_=C.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:_=C.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":_=C.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":_=C.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":_=C.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof p.is=="string"?C.createElement("select",{is:p.is}):C.createElement("select"),p.multiple?_.multiple=!0:p.size&&(_.size=p.size);break;default:_=typeof p.is=="string"?C.createElement(b,{is:p.is}):C.createElement(b)}}_[ln]=c,_[An]=p;t:for(C=c.child;C!==null;){if(C.tag===5||C.tag===6)_.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===c)break t;for(;C.sibling===null;){if(C.return===null||C.return===c)break t;C=C.return}C.sibling.return=C.return,C=C.sibling}c.stateNode=_;t:switch(Un(_,b,p),b){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break t;case"img":p=!0;break t;default:p=!1}p&&ho(c)}}return De(c),_T(c,c.type,a===null?null:a.memoizedProps,c.pendingProps,f),null;case 6:if(a&&c.stateNode!=null)a.memoizedProps!==p&&ho(c);else{if(typeof p!="string"&&c.stateNode===null)throw Error(r(166));if(a=It.current,Mu(c)){if(a=c.stateNode,f=c.memoizedProps,p=null,b=jn,b!==null)switch(b.tag){case 27:case 5:p=b.memoizedProps}a[ln]=c,a=!!(a.nodeValue===f||p!==null&&p.suppressHydrationWarning===!0||oM(a.nodeValue,f)),a||da(c,!0)}else a=zg(a).createTextNode(p),a[ln]=c,c.stateNode=a}return De(c),null;case 31:if(f=c.memoizedState,a===null||a.memoizedState!==null){if(p=Mu(c),f!==null){if(a===null){if(!p)throw Error(r(318));if(a=c.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[ln]=c}else nc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;De(c),a=!1}else f=M_(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=f),a=!0;if(!a)return c.flags&256?(Hr(c),c):(Hr(c),null);if((c.flags&128)!==0)throw Error(r(558))}return De(c),null;case 13:if(p=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(b=Mu(c),p!==null&&p.dehydrated!==null){if(a===null){if(!b)throw Error(r(318));if(b=c.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));b[ln]=c}else nc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;De(c),b=!1}else b=M_(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=b),b=!0;if(!b)return c.flags&256?(Hr(c),c):(Hr(c),null)}return Hr(c),(c.flags&128)!==0?(c.lanes=f,c):(f=p!==null,a=a!==null&&a.memoizedState!==null,f&&(p=c.child,b=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(b=p.alternate.memoizedState.cachePool.pool),_=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),_!==b&&(p.flags|=2048)),f!==a&&f&&(c.child.flags|=8192),Ag(c,c.updateQueue),De(c),null);case 4:return ce(),a===null&&zT(c.stateNode.containerInfo),De(c),null;case 10:return ao(c.type),De(c),null;case 19:if(ot(tn),p=c.memoizedState,p===null)return De(c),null;if(b=(c.flags&128)!==0,_=p.rendering,_===null)if(b)td(p,!1);else{if($e!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(_=pg(a),_!==null){for(c.flags|=128,td(p,!1),a=_.updateQueue,c.updateQueue=a,Ag(c,a),c.subtreeFlags=0,a=f,f=c.child;f!==null;)jA(f,a),f=f.sibling;return dt(tn,tn.current&1|2),ee&&so(c,p.treeForkCount),c.child}a=a.sibling}p.tail!==null&&or()>Og&&(c.flags|=128,b=!0,td(p,!1),c.lanes=4194304)}else{if(!b)if(a=pg(_),a!==null){if(c.flags|=128,b=!0,a=a.updateQueue,c.updateQueue=a,Ag(c,a),td(p,!0),p.tail===null&&p.tailMode==="hidden"&&!_.alternate&&!ee)return De(c),null}else 2*or()-p.renderingStartTime>Og&&f!==536870912&&(c.flags|=128,b=!0,td(p,!1),c.lanes=4194304);p.isBackwards?(_.sibling=c.child,c.child=_):(a=p.last,a!==null?a.sibling=_:c.child=_,p.last=_)}return p.tail!==null?(a=p.tail,p.rendering=a,p.tail=a.sibling,p.renderingStartTime=or(),a.sibling=null,f=tn.current,dt(tn,b?f&1|2:f&1),ee&&so(c,p.treeForkCount),a):(De(c),null);case 22:case 23:return Hr(c),H_(),p=c.memoizedState!==null,a!==null?a.memoizedState!==null!==p&&(c.flags|=8192):p&&(c.flags|=8192),p?(f&536870912)!==0&&(c.flags&128)===0&&(De(c),c.subtreeFlags&6&&(c.flags|=8192)):De(c),f=c.updateQueue,f!==null&&Ag(c,f.retryQueue),f=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(f=a.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048),a!==null&&ot(sc),null;case 24:return f=null,a!==null&&(f=a.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),ao(hn),De(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function iz(a,c){switch(k_(c),c.tag){case 1:return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return ao(hn),ce(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 26:case 27:case 5:return ge(c),null;case 31:if(c.memoizedState!==null){if(Hr(c),c.alternate===null)throw Error(r(340));nc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 13:if(Hr(c),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(r(340));nc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return ot(tn),null;case 4:return ce(),null;case 10:return ao(c.type),null;case 22:case 23:return Hr(c),H_(),a!==null&&ot(sc),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 24:return ao(hn),null;case 25:return null;default:return null}}function hR(a,c){switch(k_(c),c.tag){case 3:ao(hn),ce();break;case 26:case 27:case 5:ge(c);break;case 4:ce();break;case 31:c.memoizedState!==null&&Hr(c);break;case 13:Hr(c);break;case 19:ot(tn);break;case 10:ao(c.type);break;case 22:case 23:Hr(c),H_(),a!==null&&ot(sc);break;case 24:ao(hn)}}function ed(a,c){try{var f=c.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var b=p.next;f=b;do{if((f.tag&a)===a){p=void 0;var _=f.create,C=f.inst;p=_(),C.destroy=p}f=f.next}while(f!==b)}}catch(D){de(c,c.return,D)}}function _a(a,c,f){try{var p=c.updateQueue,b=p!==null?p.lastEffect:null;if(b!==null){var _=b.next;p=_;do{if((p.tag&a)===a){var C=p.inst,D=C.destroy;if(D!==void 0){C.destroy=void 0,b=c;var U=f,Q=D;try{Q()}catch(rt){de(b,U,rt)}}}p=p.next}while(p!==_)}}catch(rt){de(c,c.return,rt)}}function fR(a){var c=a.updateQueue;if(c!==null){var f=a.stateNode;try{nk(c,f)}catch(p){de(a,a.return,p)}}}function dR(a,c,f){f.props=uc(a.type,a.memoizedProps),f.state=a.memoizedState;try{f.componentWillUnmount()}catch(p){de(a,c,p)}}function nd(a,c){try{var f=a.ref;if(f!==null){switch(a.tag){case 26:case 27:case 5:var p=a.stateNode;break;case 30:p=a.stateNode;break;default:p=a.stateNode}typeof f=="function"?a.refCleanup=f(p):f.current=p}}catch(b){de(a,c,b)}}function ks(a,c){var f=a.ref,p=a.refCleanup;if(f!==null)if(typeof p=="function")try{p()}catch(b){de(a,c,b)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(b){de(a,c,b)}else f.current=null}function pR(a){var c=a.type,f=a.memoizedProps,p=a.stateNode;try{t:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&p.focus();break t;case"img":f.src?p.src=f.src:f.srcSet&&(p.srcset=f.srcSet)}}catch(b){de(a,a.return,b)}}function TT(a,c,f){try{var p=a.stateNode;Cz(p,a.type,f,c),p[An]=c}catch(b){de(a,a.return,b)}}function mR(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Aa(a.type)||a.tag===4}function ST(a){t:for(;;){for(;a.sibling===null;){if(a.return===null||mR(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Aa(a.type)||a.flags&2||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function wT(a,c,f){var p=a.tag;if(p===5||p===6)a=a.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(a,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(a),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=Ni));else if(p!==4&&(p===27&&Aa(a.type)&&(f=a.stateNode,c=null),a=a.child,a!==null))for(wT(a,c,f),a=a.sibling;a!==null;)wT(a,c,f),a=a.sibling}function kg(a,c,f){var p=a.tag;if(p===5||p===6)a=a.stateNode,c?f.insertBefore(a,c):f.appendChild(a);else if(p!==4&&(p===27&&Aa(a.type)&&(f=a.stateNode),a=a.child,a!==null))for(kg(a,c,f),a=a.sibling;a!==null;)kg(a,c,f),a=a.sibling}function gR(a){var c=a.stateNode,f=a.memoizedProps;try{for(var p=a.type,b=c.attributes;b.length;)c.removeAttributeNode(b[0]);Un(c,p,f),c[ln]=a,c[An]=f}catch(_){de(a,a.return,_)}}var fo=!1,pn=!1,xT=!1,yR=typeof WeakSet=="function"?WeakSet:Set,Rn=null;function sz(a,c){if(a=a.containerInfo,qT=Kg,a=RA(a),y_(a)){if("selectionStart"in a)var f={start:a.selectionStart,end:a.selectionEnd};else t:{f=(f=a.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var b=p.anchorOffset,_=p.focusNode;p=p.focusOffset;try{f.nodeType,_.nodeType}catch{f=null;break t}var C=0,D=-1,U=-1,Q=0,rt=0,lt=a,Z=null;e:for(;;){for(var nt;lt!==f||b!==0&&lt.nodeType!==3||(D=C+b),lt!==_||p!==0&&lt.nodeType!==3||(U=C+p),lt.nodeType===3&&(C+=lt.nodeValue.length),(nt=lt.firstChild)!==null;)Z=lt,lt=nt;for(;;){if(lt===a)break e;if(Z===f&&++Q===b&&(D=C),Z===_&&++rt===p&&(U=C),(nt=lt.nextSibling)!==null)break;lt=Z,Z=lt.parentNode}lt=nt}f=D===-1||U===-1?null:{start:D,end:U}}else f=null}f=f||{start:0,end:0}}else f=null;for(GT={focusedElem:a,selectionRange:f},Kg=!1,Rn=c;Rn!==null;)if(c=Rn,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,Rn=a;else for(;Rn!==null;){switch(c=Rn,_=c.alternate,a=c.flags,c.tag){case 0:if((a&4)!==0&&(a=c.updateQueue,a=a!==null?a.events:null,a!==null))for(f=0;f<a.length;f++)b=a[f],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&_!==null){a=void 0,f=c,b=_.memoizedProps,_=_.memoizedState,p=f.stateNode;try{var Tt=uc(f.type,b);a=p.getSnapshotBeforeUpdate(Tt,_),p.__reactInternalSnapshotBeforeUpdate=a}catch(Pt){de(f,f.return,Pt)}}break;case 3:if((a&1024)!==0){if(a=c.stateNode.containerInfo,f=a.nodeType,f===9)KT(a);else if(f===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":KT(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=c.sibling,a!==null){a.return=c.return,Rn=a;break}Rn=c.return}}function vR(a,c,f){var p=f.flags;switch(f.tag){case 0:case 11:case 15:mo(a,f),p&4&&ed(5,f);break;case 1:if(mo(a,f),p&4)if(a=f.stateNode,c===null)try{a.componentDidMount()}catch(C){de(f,f.return,C)}else{var b=uc(f.type,c.memoizedProps);c=c.memoizedState;try{a.componentDidUpdate(b,c,a.__reactInternalSnapshotBeforeUpdate)}catch(C){de(f,f.return,C)}}p&64&&fR(f),p&512&&nd(f,f.return);break;case 3:if(mo(a,f),p&64&&(a=f.updateQueue,a!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{nk(a,c)}catch(C){de(f,f.return,C)}}break;case 27:c===null&&p&4&&gR(f);case 26:case 5:mo(a,f),c===null&&p&4&&pR(f),p&512&&nd(f,f.return);break;case 12:mo(a,f);break;case 31:mo(a,f),p&4&&TR(a,f);break;case 13:mo(a,f),p&4&&SR(a,f),p&64&&(a=f.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(f=pz.bind(null,f),Pz(a,f))));break;case 22:if(p=f.memoizedState!==null||fo,!p){c=c!==null&&c.memoizedState!==null||pn,b=fo;var _=pn;fo=p,(pn=c)&&!_?go(a,f,(f.subtreeFlags&8772)!==0):mo(a,f),fo=b,pn=_}break;case 30:break;default:mo(a,f)}}function bR(a){var c=a.alternate;c!==null&&(a.alternate=null,bR(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&du(c)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Pe=null,Er=!1;function po(a,c,f){for(f=f.child;f!==null;)_R(a,c,f),f=f.sibling}function _R(a,c,f){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(Di,f)}catch{}switch(f.tag){case 26:pn||ks(f,c),po(a,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:pn||ks(f,c);var p=Pe,b=Er;Aa(f.type)&&(Pe=f.stateNode,Er=!1),po(a,c,f),hd(f.stateNode),Pe=p,Er=b;break;case 5:pn||ks(f,c);case 6:if(p=Pe,b=Er,Pe=null,po(a,c,f),Pe=p,Er=b,Pe!==null)if(Er)try{(Pe.nodeType===9?Pe.body:Pe.nodeName==="HTML"?Pe.ownerDocument.body:Pe).removeChild(f.stateNode)}catch(_){de(f,c,_)}else try{Pe.removeChild(f.stateNode)}catch(_){de(f,c,_)}break;case 18:Pe!==null&&(Er?(a=Pe,fM(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,f.stateNode),Qu(a)):fM(Pe,f.stateNode));break;case 4:p=Pe,b=Er,Pe=f.stateNode.containerInfo,Er=!0,po(a,c,f),Pe=p,Er=b;break;case 0:case 11:case 14:case 15:_a(2,f,c),pn||_a(4,f,c),po(a,c,f);break;case 1:pn||(ks(f,c),p=f.stateNode,typeof p.componentWillUnmount=="function"&&dR(f,c,p)),po(a,c,f);break;case 21:po(a,c,f);break;case 22:pn=(p=pn)||f.memoizedState!==null,po(a,c,f),pn=p;break;default:po(a,c,f)}}function TR(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Qu(a)}catch(f){de(c,c.return,f)}}}function SR(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Qu(a)}catch(f){de(c,c.return,f)}}function oz(a){switch(a.tag){case 31:case 13:case 19:var c=a.stateNode;return c===null&&(c=a.stateNode=new yR),c;case 22:return a=a.stateNode,c=a._retryCache,c===null&&(c=a._retryCache=new yR),c;default:throw Error(r(435,a.tag))}}function Rg(a,c){var f=oz(a);c.forEach(function(p){if(!f.has(p)){f.add(p);var b=mz.bind(null,a,p);p.then(b,b)}})}function Cr(a,c){var f=c.deletions;if(f!==null)for(var p=0;p<f.length;p++){var b=f[p],_=a,C=c,D=C;t:for(;D!==null;){switch(D.tag){case 27:if(Aa(D.type)){Pe=D.stateNode,Er=!1;break t}break;case 5:Pe=D.stateNode,Er=!1;break t;case 3:case 4:Pe=D.stateNode.containerInfo,Er=!0;break t}D=D.return}if(Pe===null)throw Error(r(160));_R(_,C,b),Pe=null,Er=!1,_=b.alternate,_!==null&&(_.return=null),b.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)wR(c,a),c=c.sibling}var Ui=null;function wR(a,c){var f=a.alternate,p=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Cr(c,a),Ar(a),p&4&&(_a(3,a,a.return),ed(3,a),_a(5,a,a.return));break;case 1:Cr(c,a),Ar(a),p&512&&(pn||f===null||ks(f,f.return)),p&64&&fo&&(a=a.updateQueue,a!==null&&(p=a.callbacks,p!==null&&(f=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=f===null?p:f.concat(p))));break;case 26:var b=Ui;if(Cr(c,a),Ar(a),p&512&&(pn||f===null||ks(f,f.return)),p&4){var _=f!==null?f.memoizedState:null;if(p=a.memoizedState,f===null)if(p===null)if(a.stateNode===null){t:{p=a.type,f=a.memoizedProps,b=b.ownerDocument||b;e:switch(p){case"title":_=b.getElementsByTagName("title")[0],(!_||_[ps]||_[ln]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=b.createElement(p),b.head.insertBefore(_,b.querySelector("head > title"))),Un(_,p,f),_[ln]=a,cn(_),p=_;break t;case"link":var C=wM("link","href",b).get(p+(f.href||""));if(C){for(var D=0;D<C.length;D++)if(_=C[D],_.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&_.getAttribute("rel")===(f.rel==null?null:f.rel)&&_.getAttribute("title")===(f.title==null?null:f.title)&&_.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){C.splice(D,1);break e}}_=b.createElement(p),Un(_,p,f),b.head.appendChild(_);break;case"meta":if(C=wM("meta","content",b).get(p+(f.content||""))){for(D=0;D<C.length;D++)if(_=C[D],_.getAttribute("content")===(f.content==null?null:""+f.content)&&_.getAttribute("name")===(f.name==null?null:f.name)&&_.getAttribute("property")===(f.property==null?null:f.property)&&_.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&_.getAttribute("charset")===(f.charSet==null?null:f.charSet)){C.splice(D,1);break e}}_=b.createElement(p),Un(_,p,f),b.head.appendChild(_);break;default:throw Error(r(468,p))}_[ln]=a,cn(_),p=_}a.stateNode=p}else xM(b,a.type,a.stateNode);else a.stateNode=SM(b,p,a.memoizedProps);else _!==p?(_===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):_.count--,p===null?xM(b,a.type,a.stateNode):SM(b,p,a.memoizedProps)):p===null&&a.stateNode!==null&&TT(a,a.memoizedProps,f.memoizedProps)}break;case 27:Cr(c,a),Ar(a),p&512&&(pn||f===null||ks(f,f.return)),f!==null&&p&4&&TT(a,a.memoizedProps,f.memoizedProps);break;case 5:if(Cr(c,a),Ar(a),p&512&&(pn||f===null||ks(f,f.return)),a.flags&32){b=a.stateNode;try{xr(b,"")}catch(Tt){de(a,a.return,Tt)}}p&4&&a.stateNode!=null&&(b=a.memoizedProps,TT(a,b,f!==null?f.memoizedProps:b)),p&1024&&(xT=!0);break;case 6:if(Cr(c,a),Ar(a),p&4){if(a.stateNode===null)throw Error(r(162));p=a.memoizedProps,f=a.stateNode;try{f.nodeValue=p}catch(Tt){de(a,a.return,Tt)}}break;case 3:if(qg=null,b=Ui,Ui=Hg(c.containerInfo),Cr(c,a),Ui=b,Ar(a),p&4&&f!==null&&f.memoizedState.isDehydrated)try{Qu(c.containerInfo)}catch(Tt){de(a,a.return,Tt)}xT&&(xT=!1,xR(a));break;case 4:p=Ui,Ui=Hg(a.stateNode.containerInfo),Cr(c,a),Ar(a),Ui=p;break;case 12:Cr(c,a),Ar(a);break;case 31:Cr(c,a),Ar(a),p&4&&(p=a.updateQueue,p!==null&&(a.updateQueue=null,Rg(a,p)));break;case 13:Cr(c,a),Ar(a),a.child.flags&8192&&a.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Dg=or()),p&4&&(p=a.updateQueue,p!==null&&(a.updateQueue=null,Rg(a,p)));break;case 22:b=a.memoizedState!==null;var U=f!==null&&f.memoizedState!==null,Q=fo,rt=pn;if(fo=Q||b,pn=rt||U,Cr(c,a),pn=rt,fo=Q,Ar(a),p&8192)t:for(c=a.stateNode,c._visibility=b?c._visibility&-2:c._visibility|1,b&&(f===null||U||fo||pn||hc(a)),f=null,c=a;;){if(c.tag===5||c.tag===26){if(f===null){U=f=c;try{if(_=U.stateNode,b)C=_.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{D=U.stateNode;var lt=U.memoizedProps.style,Z=lt!=null&&lt.hasOwnProperty("display")?lt.display:null;D.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(Tt){de(U,U.return,Tt)}}}else if(c.tag===6){if(f===null){U=c;try{U.stateNode.nodeValue=b?"":U.memoizedProps}catch(Tt){de(U,U.return,Tt)}}}else if(c.tag===18){if(f===null){U=c;try{var nt=U.stateNode;b?dM(nt,!0):dM(U.stateNode,!1)}catch(Tt){de(U,U.return,Tt)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===a)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break t;for(;c.sibling===null;){if(c.return===null||c.return===a)break t;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}p&4&&(p=a.updateQueue,p!==null&&(f=p.retryQueue,f!==null&&(p.retryQueue=null,Rg(a,f))));break;case 19:Cr(c,a),Ar(a),p&4&&(p=a.updateQueue,p!==null&&(a.updateQueue=null,Rg(a,p)));break;case 30:break;case 21:break;default:Cr(c,a),Ar(a)}}function Ar(a){var c=a.flags;if(c&2){try{for(var f,p=a.return;p!==null;){if(mR(p)){f=p;break}p=p.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var b=f.stateNode,_=ST(a);kg(a,_,b);break;case 5:var C=f.stateNode;f.flags&32&&(xr(C,""),f.flags&=-33);var D=ST(a);kg(a,D,C);break;case 3:case 4:var U=f.stateNode.containerInfo,Q=ST(a);wT(a,Q,U);break;default:throw Error(r(161))}}catch(rt){de(a,a.return,rt)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function xR(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var c=a;xR(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),a=a.sibling}}function mo(a,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)vR(a,c.alternate,c),c=c.sibling}function hc(a){for(a=a.child;a!==null;){var c=a;switch(c.tag){case 0:case 11:case 14:case 15:_a(4,c,c.return),hc(c);break;case 1:ks(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&dR(c,c.return,f),hc(c);break;case 27:hd(c.stateNode);case 26:case 5:ks(c,c.return),hc(c);break;case 22:c.memoizedState===null&&hc(c);break;case 30:hc(c);break;default:hc(c)}a=a.sibling}}function go(a,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var p=c.alternate,b=a,_=c,C=_.flags;switch(_.tag){case 0:case 11:case 15:go(b,_,f),ed(4,_);break;case 1:if(go(b,_,f),p=_,b=p.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(Q){de(p,p.return,Q)}if(p=_,b=p.updateQueue,b!==null){var D=p.stateNode;try{var U=b.shared.hiddenCallbacks;if(U!==null)for(b.shared.hiddenCallbacks=null,b=0;b<U.length;b++)ek(U[b],D)}catch(Q){de(p,p.return,Q)}}f&&C&64&&fR(_),nd(_,_.return);break;case 27:gR(_);case 26:case 5:go(b,_,f),f&&p===null&&C&4&&pR(_),nd(_,_.return);break;case 12:go(b,_,f);break;case 31:go(b,_,f),f&&C&4&&TR(b,_);break;case 13:go(b,_,f),f&&C&4&&SR(b,_);break;case 22:_.memoizedState===null&&go(b,_,f),nd(_,_.return);break;case 30:break;default:go(b,_,f)}c=c.sibling}}function ET(a,c){var f=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(f=a.memoizedState.cachePool.pool),a=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(a=c.memoizedState.cachePool.pool),a!==f&&(a!=null&&a.refCount++,f!=null&&zf(f))}function CT(a,c){a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&zf(a))}function zi(a,c,f,p){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)ER(a,c,f,p),c=c.sibling}function ER(a,c,f,p){var b=c.flags;switch(c.tag){case 0:case 11:case 15:zi(a,c,f,p),b&2048&&ed(9,c);break;case 1:zi(a,c,f,p);break;case 3:zi(a,c,f,p),b&2048&&(a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&zf(a)));break;case 12:if(b&2048){zi(a,c,f,p),a=c.stateNode;try{var _=c.memoizedProps,C=_.id,D=_.onPostCommit;typeof D=="function"&&D(C,c.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(U){de(c,c.return,U)}}else zi(a,c,f,p);break;case 31:zi(a,c,f,p);break;case 13:zi(a,c,f,p);break;case 23:break;case 22:_=c.stateNode,C=c.alternate,c.memoizedState!==null?_._visibility&2?zi(a,c,f,p):rd(a,c):_._visibility&2?zi(a,c,f,p):(_._visibility|=2,Fu(a,c,f,p,(c.subtreeFlags&10256)!==0||!1)),b&2048&&ET(C,c);break;case 24:zi(a,c,f,p),b&2048&&CT(c.alternate,c);break;default:zi(a,c,f,p)}}function Fu(a,c,f,p,b){for(b=b&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var _=a,C=c,D=f,U=p,Q=C.flags;switch(C.tag){case 0:case 11:case 15:Fu(_,C,D,U,b),ed(8,C);break;case 23:break;case 22:var rt=C.stateNode;C.memoizedState!==null?rt._visibility&2?Fu(_,C,D,U,b):rd(_,C):(rt._visibility|=2,Fu(_,C,D,U,b)),b&&Q&2048&&ET(C.alternate,C);break;case 24:Fu(_,C,D,U,b),b&&Q&2048&&CT(C.alternate,C);break;default:Fu(_,C,D,U,b)}c=c.sibling}}function rd(a,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=a,p=c,b=p.flags;switch(p.tag){case 22:rd(f,p),b&2048&&ET(p.alternate,p);break;case 24:rd(f,p),b&2048&&CT(p.alternate,p);break;default:rd(f,p)}c=c.sibling}}var id=8192;function Uu(a,c,f){if(a.subtreeFlags&id)for(a=a.child;a!==null;)CR(a,c,f),a=a.sibling}function CR(a,c,f){switch(a.tag){case 26:Uu(a,c,f),a.flags&id&&a.memoizedState!==null&&Gz(f,Ui,a.memoizedState,a.memoizedProps);break;case 5:Uu(a,c,f);break;case 3:case 4:var p=Ui;Ui=Hg(a.stateNode.containerInfo),Uu(a,c,f),Ui=p;break;case 22:a.memoizedState===null&&(p=a.alternate,p!==null&&p.memoizedState!==null?(p=id,id=16777216,Uu(a,c,f),id=p):Uu(a,c,f));break;default:Uu(a,c,f)}}function AR(a){var c=a.alternate;if(c!==null&&(a=c.child,a!==null)){c.child=null;do c=a.sibling,a.sibling=null,a=c;while(a!==null)}}function sd(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];Rn=p,RR(p,a)}AR(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)kR(a),a=a.sibling}function kR(a){switch(a.tag){case 0:case 11:case 15:sd(a),a.flags&2048&&_a(9,a,a.return);break;case 3:sd(a);break;case 12:sd(a);break;case 22:var c=a.stateNode;a.memoizedState!==null&&c._visibility&2&&(a.return===null||a.return.tag!==13)?(c._visibility&=-3,Mg(a)):sd(a);break;default:sd(a)}}function Mg(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var p=c[f];Rn=p,RR(p,a)}AR(a)}for(a=a.child;a!==null;){switch(c=a,c.tag){case 0:case 11:case 15:_a(8,c,c.return),Mg(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,Mg(c));break;default:Mg(c)}a=a.sibling}}function RR(a,c){for(;Rn!==null;){var f=Rn;switch(f.tag){case 0:case 11:case 15:_a(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var p=f.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:zf(f.memoizedState.cache)}if(p=f.child,p!==null)p.return=f,Rn=p;else t:for(f=a;Rn!==null;){p=Rn;var b=p.sibling,_=p.return;if(bR(p),p===f){Rn=null;break t}if(b!==null){b.return=_,Rn=b;break t}Rn=_}}}var az={getCacheForType:function(a){var c=Bn(hn),f=c.data.get(a);return f===void 0&&(f=a(),c.data.set(a,f)),f},cacheSignal:function(){return Bn(hn).controller.signal}},lz=typeof WeakMap=="function"?WeakMap:Map,le=0,xe=null,Yt=null,Xt=0,fe=0,$r=null,Ta=!1,zu=!1,AT=!1,yo=0,$e=0,Sa=0,fc=0,kT=0,qr=0,Hu=0,od=null,kr=null,RT=!1,Dg=0,MR=0,Og=1/0,Ig=null,wa=null,Sn=0,xa=null,$u=null,vo=0,MT=0,DT=null,DR=null,ad=0,OT=null;function Gr(){return(le&2)!==0&&Xt!==0?Xt&-Xt:J.T!==null?jT():Pm()}function OR(){if(qr===0)if((Xt&536870912)===0||ee){var a=Bl;Bl<<=1,(Bl&3932160)===0&&(Bl=262144),qr=a}else qr=536870912;return a=zr.current,a!==null&&(a.flags|=32),qr}function Rr(a,c,f){(a===xe&&(fe===2||fe===9)||a.cancelPendingCommit!==null)&&(qu(a,0),Ea(a,Xt,qr,!1)),Fl(a,f),((le&2)===0||a!==xe)&&(a===xe&&((le&2)===0&&(fc|=f),$e===4&&Ea(a,Xt,qr,!1)),Rs(a))}function IR(a,c,f){if((le&6)!==0)throw Error(r(327));var p=!f&&(c&127)===0&&(c&a.expiredLanes)===0||Oi(a,c),b=p?hz(a,c):PT(a,c,!0),_=p;do{if(b===0){zu&&!p&&Ea(a,c,0,!1);break}else{if(f=a.current.alternate,_&&!cz(f)){b=PT(a,c,!1),_=!1;continue}if(b===2){if(_=c,a.errorRecoveryDisabledLanes&_)var C=0;else C=a.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){c=C;t:{var D=a;b=od;var U=D.current.memoizedState.isDehydrated;if(U&&(qu(D,C).flags|=256),C=PT(D,C,!1),C!==2){if(AT&&!U){D.errorRecoveryDisabledLanes|=_,fc|=_,b=4;break t}_=kr,kr=b,_!==null&&(kr===null?kr=_:kr.push.apply(kr,_))}b=C}if(_=!1,b!==2)continue}}if(b===1){qu(a,0),Ea(a,c,0,!0);break}t:{switch(p=a,_=b,_){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Ea(p,c,qr,!Ta);break t;case 2:kr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(b=Dg+300-or(),10<b)){if(Ea(p,c,qr,!Ta),hs(p,0,!0)!==0)break t;vo=c,p.timeoutHandle=uM(PR.bind(null,p,f,kr,Ig,RT,c,qr,fc,Hu,Ta,_,"Throttled",-0,0),b);break t}PR(p,f,kr,Ig,RT,c,qr,fc,Hu,Ta,_,null,-0,0)}}break}while(!0);Rs(a)}function PR(a,c,f,p,b,_,C,D,U,Q,rt,lt,Z,nt){if(a.timeoutHandle=-1,lt=c.subtreeFlags,lt&8192||(lt&16785408)===16785408){lt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ni},CR(c,_,lt);var Tt=(_&62914560)===_?Dg-or():(_&4194048)===_?MR-or():0;if(Tt=Wz(lt,Tt),Tt!==null){vo=_,a.cancelPendingCommit=Tt(zR.bind(null,a,c,_,f,p,b,C,D,U,rt,lt,null,Z,nt)),Ea(a,_,C,!Q);return}}zR(a,c,_,f,p,b,C,D,U)}function cz(a){for(var c=a;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var p=0;p<f.length;p++){var b=f[p],_=b.getSnapshot;b=b.value;try{if(!Fr(_(),b))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Ea(a,c,f,p){c&=~kT,c&=~fc,a.suspendedLanes|=c,a.pingedLanes&=~c,p&&(a.warmLanes|=c),p=a.expirationTimes;for(var b=c;0<b;){var _=31-Je(b),C=1<<_;p[_]=-1,b&=~C}f!==0&&Ul(a,f,c)}function Pg(){return(le&6)===0?(ld(0),!1):!0}function IT(){if(Yt!==null){if(fe===0)var a=Yt.return;else a=Yt,oo=rc=null,K_(a),Nu=null,$f=0,a=Yt;for(;a!==null;)hR(a.alternate,a),a=a.return;Yt=null}}function qu(a,c){var f=a.timeoutHandle;f!==-1&&(a.timeoutHandle=-1,Rz(f)),f=a.cancelPendingCommit,f!==null&&(a.cancelPendingCommit=null,f()),vo=0,IT(),xe=a,Yt=f=io(a.current,null),Xt=c,fe=0,$r=null,Ta=!1,zu=Oi(a,c),AT=!1,Hu=qr=kT=fc=Sa=$e=0,kr=od=null,RT=!1,(c&8)!==0&&(c|=c&32);var p=a.entangledLanes;if(p!==0)for(a=a.entanglements,p&=c;0<p;){var b=31-Je(p),_=1<<b;c|=a[b],p&=~_}return yo=c,eg(),f}function NR(a,c){Ht=null,J.H=Jf,c===Pu||c===cg?(c=QA(),fe=3):c===V_?(c=QA(),fe=4):fe=c===hT?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,$r=c,Yt===null&&($e=1,wg(a,ui(c,a.current)))}function LR(){var a=zr.current;return a===null?!0:(Xt&4194048)===Xt?pi===null:(Xt&62914560)===Xt||(Xt&536870912)!==0?a===pi:!1}function VR(){var a=J.H;return J.H=Jf,a===null?Jf:a}function jR(){var a=J.A;return J.A=az,a}function Ng(){$e=4,Ta||(Xt&4194048)!==Xt&&zr.current!==null||(zu=!0),(Sa&134217727)===0&&(fc&134217727)===0||xe===null||Ea(xe,Xt,qr,!1)}function PT(a,c,f){var p=le;le|=2;var b=VR(),_=jR();(xe!==a||Xt!==c)&&(Ig=null,qu(a,c)),c=!1;var C=$e;t:do try{if(fe!==0&&Yt!==null){var D=Yt,U=$r;switch(fe){case 8:IT(),C=6;break t;case 3:case 2:case 9:case 6:zr.current===null&&(c=!0);var Q=fe;if(fe=0,$r=null,Gu(a,D,U,Q),f&&zu){C=0;break t}break;default:Q=fe,fe=0,$r=null,Gu(a,D,U,Q)}}uz(),C=$e;break}catch(rt){NR(a,rt)}while(!0);return c&&a.shellSuspendCounter++,oo=rc=null,le=p,J.H=b,J.A=_,Yt===null&&(xe=null,Xt=0,eg()),C}function uz(){for(;Yt!==null;)BR(Yt)}function hz(a,c){var f=le;le|=2;var p=VR(),b=jR();xe!==a||Xt!==c?(Ig=null,Og=or()+500,qu(a,c)):zu=Oi(a,c);t:do try{if(fe!==0&&Yt!==null){c=Yt;var _=$r;e:switch(fe){case 1:fe=0,$r=null,Gu(a,c,_,1);break;case 2:case 9:if(KA(_)){fe=0,$r=null,FR(c);break}c=function(){fe!==2&&fe!==9||xe!==a||(fe=7),Rs(a)},_.then(c,c);break t;case 3:fe=7;break t;case 4:fe=5;break t;case 7:KA(_)?(fe=0,$r=null,FR(c)):(fe=0,$r=null,Gu(a,c,_,7));break;case 5:var C=null;switch(Yt.tag){case 26:C=Yt.memoizedState;case 5:case 27:var D=Yt;if(C?EM(C):D.stateNode.complete){fe=0,$r=null;var U=D.sibling;if(U!==null)Yt=U;else{var Q=D.return;Q!==null?(Yt=Q,Lg(Q)):Yt=null}break e}}fe=0,$r=null,Gu(a,c,_,5);break;case 6:fe=0,$r=null,Gu(a,c,_,6);break;case 8:IT(),$e=6;break t;default:throw Error(r(462))}}fz();break}catch(rt){NR(a,rt)}while(!0);return oo=rc=null,J.H=p,J.A=b,le=f,Yt!==null?0:(xe=null,Xt=0,eg(),$e)}function fz(){for(;Yt!==null&&!u_();)BR(Yt)}function BR(a){var c=cR(a.alternate,a,yo);a.memoizedProps=a.pendingProps,c===null?Lg(a):Yt=c}function FR(a){var c=a,f=c.alternate;switch(c.tag){case 15:case 0:c=rR(f,c,c.pendingProps,c.type,void 0,Xt);break;case 11:c=rR(f,c,c.pendingProps,c.type.render,c.ref,Xt);break;case 5:K_(c);default:hR(f,c),c=Yt=jA(c,yo),c=cR(f,c,yo)}a.memoizedProps=a.pendingProps,c===null?Lg(a):Yt=c}function Gu(a,c,f,p){oo=rc=null,K_(c),Nu=null,$f=0;var b=c.return;try{if(tz(a,b,c,f,Xt)){$e=1,wg(a,ui(f,a.current)),Yt=null;return}}catch(_){if(b!==null)throw Yt=b,_;$e=1,wg(a,ui(f,a.current)),Yt=null;return}c.flags&32768?(ee||p===1?a=!0:zu||(Xt&536870912)!==0?a=!1:(Ta=a=!0,(p===2||p===9||p===3||p===6)&&(p=zr.current,p!==null&&p.tag===13&&(p.flags|=16384))),UR(c,a)):Lg(c)}function Lg(a){var c=a;do{if((c.flags&32768)!==0){UR(c,Ta);return}a=c.return;var f=rz(c.alternate,c,yo);if(f!==null){Yt=f;return}if(c=c.sibling,c!==null){Yt=c;return}Yt=c=a}while(c!==null);$e===0&&($e=5)}function UR(a,c){do{var f=iz(a.alternate,a);if(f!==null){f.flags&=32767,Yt=f;return}if(f=a.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(a=a.sibling,a!==null)){Yt=a;return}Yt=a=f}while(a!==null);$e=6,Yt=null}function zR(a,c,f,p,b,_,C,D,U){a.cancelPendingCommit=null;do Vg();while(Sn!==0);if((le&6)!==0)throw Error(r(327));if(c!==null){if(c===a.current)throw Error(r(177));if(_=c.lanes|c.childLanes,_|=S_,d_(a,f,_,C,D,U),a===xe&&(Yt=xe=null,Xt=0),$u=c,xa=a,vo=f,MT=_,DT=b,DR=p,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,gz(ea,function(){return WR(),null})):(a.callbackNode=null,a.callbackPriority=0),p=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||p){p=J.T,J.T=null,b=st.p,st.p=2,C=le,le|=4;try{sz(a,c,f)}finally{le=C,st.p=b,J.T=p}}Sn=1,HR(),$R(),qR()}}function HR(){if(Sn===1){Sn=0;var a=xa,c=$u,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=J.T,J.T=null;var p=st.p;st.p=2;var b=le;le|=4;try{wR(c,a);var _=GT,C=RA(a.containerInfo),D=_.focusedElem,U=_.selectionRange;if(C!==D&&D&&D.ownerDocument&&kA(D.ownerDocument.documentElement,D)){if(U!==null&&y_(D)){var Q=U.start,rt=U.end;if(rt===void 0&&(rt=Q),"selectionStart"in D)D.selectionStart=Q,D.selectionEnd=Math.min(rt,D.value.length);else{var lt=D.ownerDocument||document,Z=lt&&lt.defaultView||window;if(Z.getSelection){var nt=Z.getSelection(),Tt=D.textContent.length,Pt=Math.min(U.start,Tt),_e=U.end===void 0?Pt:Math.min(U.end,Tt);!nt.extend&&Pt>_e&&(C=_e,_e=Pt,Pt=C);var Y=AA(D,Pt),G=AA(D,_e);if(Y&&G&&(nt.rangeCount!==1||nt.anchorNode!==Y.node||nt.anchorOffset!==Y.offset||nt.focusNode!==G.node||nt.focusOffset!==G.offset)){var X=lt.createRange();X.setStart(Y.node,Y.offset),nt.removeAllRanges(),Pt>_e?(nt.addRange(X),nt.extend(G.node,G.offset)):(X.setEnd(G.node,G.offset),nt.addRange(X))}}}}for(lt=[],nt=D;nt=nt.parentNode;)nt.nodeType===1&&lt.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<lt.length;D++){var at=lt[D];at.element.scrollLeft=at.left,at.element.scrollTop=at.top}}Kg=!!qT,GT=qT=null}finally{le=b,st.p=p,J.T=f}}a.current=c,Sn=2}}function $R(){if(Sn===2){Sn=0;var a=xa,c=$u,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=J.T,J.T=null;var p=st.p;st.p=2;var b=le;le|=4;try{vR(a,c.alternate,c)}finally{le=b,st.p=p,J.T=f}}Sn=3}}function qR(){if(Sn===4||Sn===3){Sn=0,Am();var a=xa,c=$u,f=vo,p=DR;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Sn=5:(Sn=0,$u=xa=null,GR(a,a.pendingLanes));var b=a.pendingLanes;if(b===0&&(wa=null),to(f),c=c.stateNode,Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(Di,c,void 0,(c.current.flags&128)===128)}catch{}if(p!==null){c=J.T,b=st.p,st.p=2,J.T=null;try{for(var _=a.onRecoverableError,C=0;C<p.length;C++){var D=p[C];_(D.value,{componentStack:D.stack})}}finally{J.T=c,st.p=b}}(vo&3)!==0&&Vg(),Rs(a),b=a.pendingLanes,(f&261930)!==0&&(b&42)!==0?a===OT?ad++:(ad=0,OT=a):ad=0,ld(0)}}function GR(a,c){(a.pooledCacheLanes&=c)===0&&(c=a.pooledCache,c!=null&&(a.pooledCache=null,zf(c)))}function Vg(){return HR(),$R(),qR(),WR()}function WR(){if(Sn!==5)return!1;var a=xa,c=MT;MT=0;var f=to(vo),p=J.T,b=st.p;try{st.p=32>f?32:f,J.T=null,f=DT,DT=null;var _=xa,C=vo;if(Sn=0,$u=xa=null,vo=0,(le&6)!==0)throw Error(r(331));var D=le;if(le|=4,kR(_.current),ER(_,_.current,C,f),le=D,ld(0,!1),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(Di,_)}catch{}return!0}finally{st.p=b,J.T=p,GR(a,c)}}function YR(a,c,f){c=ui(f,c),c=uT(a.stateNode,c,2),a=ya(a,c,2),a!==null&&(Fl(a,2),Rs(a))}function de(a,c,f){if(a.tag===3)YR(a,a,f);else for(;c!==null;){if(c.tag===3){YR(c,a,f);break}else if(c.tag===1){var p=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(wa===null||!wa.has(p))){a=ui(f,a),f=Kk(2),p=ya(c,f,2),p!==null&&(Xk(f,p,c,a),Fl(p,2),Rs(p));break}}c=c.return}}function NT(a,c,f){var p=a.pingCache;if(p===null){p=a.pingCache=new lz;var b=new Set;p.set(c,b)}else b=p.get(c),b===void 0&&(b=new Set,p.set(c,b));b.has(f)||(AT=!0,b.add(f),a=dz.bind(null,a,c,f),c.then(a,a))}function dz(a,c,f){var p=a.pingCache;p!==null&&p.delete(c),a.pingedLanes|=a.suspendedLanes&f,a.warmLanes&=~f,xe===a&&(Xt&f)===f&&($e===4||$e===3&&(Xt&62914560)===Xt&&300>or()-Dg?(le&2)===0&&qu(a,0):kT|=f,Hu===Xt&&(Hu=0)),Rs(a)}function KR(a,c){c===0&&(c=Im()),a=tc(a,c),a!==null&&(Fl(a,c),Rs(a))}function pz(a){var c=a.memoizedState,f=0;c!==null&&(f=c.retryLane),KR(a,f)}function mz(a,c){var f=0;switch(a.tag){case 31:case 13:var p=a.stateNode,b=a.memoizedState;b!==null&&(f=b.retryLane);break;case 19:p=a.stateNode;break;case 22:p=a.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(c),KR(a,f)}function gz(a,c){return Tn(a,c)}var jg=null,Wu=null,LT=!1,Bg=!1,VT=!1,Ca=0;function Rs(a){a!==Wu&&a.next===null&&(Wu===null?jg=Wu=a:Wu=Wu.next=a),Bg=!0,LT||(LT=!0,vz())}function ld(a,c){if(!VT&&Bg){VT=!0;do for(var f=!1,p=jg;p!==null;){if(a!==0){var b=p.pendingLanes;if(b===0)var _=0;else{var C=p.suspendedLanes,D=p.pingedLanes;_=(1<<31-Je(42|a)+1)-1,_&=b&~(C&~D),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(f=!0,ZR(p,_))}else _=Xt,_=hs(p,p===xe?_:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(_&3)===0||Oi(p,_)||(f=!0,ZR(p,_));p=p.next}while(f);VT=!1}}function yz(){XR()}function XR(){Bg=LT=!1;var a=0;Ca!==0&&kz()&&(a=Ca);for(var c=or(),f=null,p=jg;p!==null;){var b=p.next,_=QR(p,c);_===0?(p.next=null,f===null?jg=b:f.next=b,b===null&&(Wu=f)):(f=p,(a!==0||(_&3)!==0)&&(Bg=!0)),p=b}Sn!==0&&Sn!==5||ld(a),Ca!==0&&(Ca=0)}function QR(a,c){for(var f=a.suspendedLanes,p=a.pingedLanes,b=a.expirationTimes,_=a.pendingLanes&-62914561;0<_;){var C=31-Je(_),D=1<<C,U=b[C];U===-1?((D&f)===0||(D&p)!==0)&&(b[C]=f_(D,c)):U<=c&&(a.expiredLanes|=D),_&=~D}if(c=xe,f=Xt,f=hs(a,a===c?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),p=a.callbackNode,f===0||a===c&&(fe===2||fe===9)||a.cancelPendingCommit!==null)return p!==null&&p!==null&&ta(p),a.callbackNode=null,a.callbackPriority=0;if((f&3)===0||Oi(a,f)){if(c=f&-f,c===a.callbackPriority)return c;switch(p!==null&&ta(p),to(f)){case 2:case 8:f=vf;break;case 32:f=ea;break;case 268435456:f=km;break;default:f=ea}return p=JR.bind(null,a),f=Tn(f,p),a.callbackPriority=c,a.callbackNode=f,c}return p!==null&&p!==null&&ta(p),a.callbackPriority=2,a.callbackNode=null,2}function JR(a,c){if(Sn!==0&&Sn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var f=a.callbackNode;if(Vg()&&a.callbackNode!==f)return null;var p=Xt;return p=hs(a,a===xe?p:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),p===0?null:(IR(a,p,c),QR(a,or()),a.callbackNode!=null&&a.callbackNode===f?JR.bind(null,a):null)}function ZR(a,c){if(Vg())return null;IR(a,c,!0)}function vz(){Mz(function(){(le&6)!==0?Tn(yf,yz):XR()})}function jT(){if(Ca===0){var a=Ou;a===0&&(a=cs,cs<<=1,(cs&261888)===0&&(cs=256)),Ca=a}return Ca}function tM(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:yu(""+a)}function eM(a,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,a.id&&f.setAttribute("form",a.id),c.parentNode.insertBefore(f,c),a=new FormData(a),f.parentNode.removeChild(f),a}function bz(a,c,f,p,b){if(c==="submit"&&f&&f.stateNode===b){var _=tM((b[An]||null).action),C=p.submitter;C&&(c=(c=C[An]||null)?tM(c.formAction):C.getAttribute("formAction"),c!==null&&(_=c,C=null));var D=new Ss("action","action",null,p,b);a.push({event:D,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Ca!==0){var U=C?eM(b,C):new FormData(b);iT(f,{pending:!0,data:U,method:b.method,action:_},null,U)}}else typeof _=="function"&&(D.preventDefault(),U=C?eM(b,C):new FormData(b),iT(f,{pending:!0,data:U,method:b.method,action:_},_,U))},currentTarget:b}]})}}for(var BT=0;BT<T_.length;BT++){var FT=T_[BT],_z=FT.toLowerCase(),Tz=FT[0].toUpperCase()+FT.slice(1);Fi(_z,"on"+Tz)}Fi(OA,"onAnimationEnd"),Fi(IA,"onAnimationIteration"),Fi(PA,"onAnimationStart"),Fi("dblclick","onDoubleClick"),Fi("focusin","onFocus"),Fi("focusout","onBlur"),Fi(VU,"onTransitionRun"),Fi(jU,"onTransitionStart"),Fi(BU,"onTransitionCancel"),Fi(NA,"onTransitionEnd"),vs("onMouseEnter",["mouseout","mouseover"]),vs("onMouseLeave",["mouseout","mouseover"]),vs("onPointerEnter",["pointerout","pointerover"]),vs("onPointerLeave",["pointerout","pointerover"]),ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ys("onBeforeInput",["compositionend","keypress","textInput","paste"]),ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sz=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cd));function nM(a,c){c=(c&4)!==0;for(var f=0;f<a.length;f++){var p=a[f],b=p.event;p=p.listeners;t:{var _=void 0;if(c)for(var C=p.length-1;0<=C;C--){var D=p[C],U=D.instance,Q=D.currentTarget;if(D=D.listener,U!==_&&b.isPropagationStopped())break t;_=D,b.currentTarget=Q;try{_(b)}catch(rt){tg(rt)}b.currentTarget=null,_=U}else for(C=0;C<p.length;C++){if(D=p[C],U=D.instance,Q=D.currentTarget,D=D.listener,U!==_&&b.isPropagationStopped())break t;_=D,b.currentTarget=Q;try{_(b)}catch(rt){tg(rt)}b.currentTarget=null,_=U}}}}function Kt(a,c){var f=c[fu];f===void 0&&(f=c[fu]=new Set);var p=a+"__bubble";f.has(p)||(rM(c,a,2,!1),f.add(p))}function UT(a,c,f){var p=0;c&&(p|=4),rM(f,a,p,c)}var Fg="_reactListening"+Math.random().toString(36).slice(2);function zT(a){if(!a[Fg]){a[Fg]=!0,Tf.forEach(function(f){f!=="selectionchange"&&(Sz.has(f)||UT(f,!1,a),UT(f,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Fg]||(c[Fg]=!0,UT("selectionchange",!1,c))}}function rM(a,c,f,p){switch(OM(c)){case 2:var b=Xz;break;case 8:b=Qz;break;default:b=rS}f=b.bind(null,c,f,a),b=void 0,!Gl||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(b=!0),p?b!==void 0?a.addEventListener(c,f,{capture:!0,passive:b}):a.addEventListener(c,f,!0):b!==void 0?a.addEventListener(c,f,{passive:b}):a.addEventListener(c,f,!1)}function HT(a,c,f,p,b){var _=p;if((c&1)===0&&(c&2)===0&&p!==null)t:for(;;){if(p===null)return;var C=p.tag;if(C===3||C===4){var D=p.stateNode.containerInfo;if(D===b)break;if(C===4)for(C=p.return;C!==null;){var U=C.tag;if((U===3||U===4)&&C.stateNode.containerInfo===b)return;C=C.return}for(;D!==null;){if(C=ms(D),C===null)return;if(U=C.tag,U===5||U===6||U===26||U===27){p=_=C;continue t}D=D.parentNode}}p=p.return}aa(function(){var Q=_,rt=oi(f),lt=[];t:{var Z=LA.get(a);if(Z!==void 0){var nt=Ss,Tt=a;switch(a){case"keypress":if(Yl(f)===0)break t;case"keydown":case"keyup":nt=Qm;break;case"focusin":Tt="focus",nt=Xl;break;case"focusout":Tt="blur",nt=Xl;break;case"beforeblur":case"afterblur":nt=Xl;break;case"click":if(f.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Pf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=zm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=x;break;case OA:case IA:case PA:nt=$m;break;case NA:nt=I;break;case"scroll":case"scrollend":nt=If;break;case"wheel":nt=et;break;case"copy":case"cut":case"paste":nt=qm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=ro;break;case"toggle":case"beforetoggle":nt=zt}var Pt=(c&4)!==0,_e=!Pt&&(a==="scroll"||a==="scrollend"),Y=Pt?Z!==null?Z+"Capture":null:Z;Pt=[];for(var G=Q,X;G!==null;){var at=G;if(X=at.stateNode,at=at.tag,at!==5&&at!==26&&at!==27||X===null||Y===null||(at=Li(G,Y),at!=null&&Pt.push(ud(G,at,X))),_e)break;G=G.return}0<Pt.length&&(Z=new nt(Z,Tt,null,f,rt),lt.push({event:Z,listeners:Pt}))}}if((c&7)===0){t:{if(Z=a==="mouseover"||a==="pointerover",nt=a==="mouseout"||a==="pointerout",Z&&f!==Mf&&(Tt=f.relatedTarget||f.fromElement)&&(ms(Tt)||Tt[ds]))break t;if((nt||Z)&&(Z=rt.window===rt?rt:(Z=rt.ownerDocument)?Z.defaultView||Z.parentWindow:window,nt?(Tt=f.relatedTarget||f.toElement,nt=Q,Tt=Tt?ms(Tt):null,Tt!==null&&(_e=s(Tt),Pt=Tt.tag,Tt!==_e||Pt!==5&&Pt!==27&&Pt!==6)&&(Tt=null)):(nt=null,Tt=Q),nt!==Tt)){if(Pt=Pf,at="onMouseLeave",Y="onMouseEnter",G="mouse",(a==="pointerout"||a==="pointerover")&&(Pt=ro,at="onPointerLeave",Y="onPointerEnter",G="pointer"),_e=nt==null?Z:jr(nt),X=Tt==null?Z:jr(Tt),Z=new Pt(at,G+"leave",nt,f,rt),Z.target=_e,Z.relatedTarget=X,at=null,ms(rt)===Q&&(Pt=new Pt(Y,G+"enter",Tt,f,rt),Pt.target=X,Pt.relatedTarget=_e,at=Pt),_e=at,nt&&Tt)e:{for(Pt=wz,Y=nt,G=Tt,X=0,at=Y;at;at=Pt(at))X++;at=0;for(var kt=G;kt;kt=Pt(kt))at++;for(;0<X-at;)Y=Pt(Y),X--;for(;0<at-X;)G=Pt(G),at--;for(;X--;){if(Y===G||G!==null&&Y===G.alternate){Pt=Y;break e}Y=Pt(Y),G=Pt(G)}Pt=null}else Pt=null;nt!==null&&iM(lt,Z,nt,Pt,!1),Tt!==null&&_e!==null&&iM(lt,_e,Tt,Pt,!0)}}t:{if(Z=Q?jr(Q):window,nt=Z.nodeName&&Z.nodeName.toLowerCase(),nt==="select"||nt==="input"&&Z.type==="file")var se=TA;else if(bA(Z))if(SA)se=PU;else{se=OU;var wt=DU}else nt=Z.nodeName,!nt||nt.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?Q&&gu(Q.elementType)&&(se=TA):se=IU;if(se&&(se=se(a,Q))){_A(lt,se,f,rt);break t}wt&&wt(a,Z,Q),a==="focusout"&&Q&&Z.type==="number"&&Q.memoizedProps.value!=null&&Af(Z,"number",Z.value)}switch(wt=Q?jr(Q):window,a){case"focusin":(bA(wt)||wt.contentEditable==="true")&&(xu=wt,v_=Q,Bf=null);break;case"focusout":Bf=v_=xu=null;break;case"mousedown":b_=!0;break;case"contextmenu":case"mouseup":case"dragend":b_=!1,MA(lt,f,rt);break;case"selectionchange":if(LU)break;case"keydown":case"keyup":MA(lt,f,rt)}var $t;if(ae)t:{switch(a){case"compositionstart":var Qt="onCompositionStart";break t;case"compositionend":Qt="onCompositionEnd";break t;case"compositionupdate":Qt="onCompositionUpdate";break t}Qt=void 0}else wu?Ql(a,f)&&(Qt="onCompositionEnd"):a==="keydown"&&f.keyCode===229&&(Qt="onCompositionStart");Qt&&(Es&&f.locale!=="ko"&&(wu||Qt!=="onCompositionStart"?Qt==="onCompositionEnd"&&wu&&($t=Of()):(Ts=rt,Df="value"in Ts?Ts.value:Ts.textContent,wu=!0)),wt=Ug(Q,Qt),0<wt.length&&(Qt=new xs(Qt,a,null,f,rt),lt.push({event:Qt,listeners:wt}),$t?Qt.data=$t:($t=Su(f),$t!==null&&(Qt.data=$t)))),($t=li?AU(a,f):kU(a,f))&&(Qt=Ug(Q,"onBeforeInput"),0<Qt.length&&(wt=new xs("onBeforeInput","beforeinput",null,f,rt),lt.push({event:wt,listeners:Qt}),wt.data=$t)),bz(lt,a,Q,f,rt)}nM(lt,c)})}function ud(a,c,f){return{instance:a,listener:c,currentTarget:f}}function Ug(a,c){for(var f=c+"Capture",p=[];a!==null;){var b=a,_=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||_===null||(b=Li(a,f),b!=null&&p.unshift(ud(a,b,_)),b=Li(a,c),b!=null&&p.push(ud(a,b,_))),a.tag===3)return p;a=a.return}return[]}function wz(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function iM(a,c,f,p,b){for(var _=c._reactName,C=[];f!==null&&f!==p;){var D=f,U=D.alternate,Q=D.stateNode;if(D=D.tag,U!==null&&U===p)break;D!==5&&D!==26&&D!==27||Q===null||(U=Q,b?(Q=Li(f,_),Q!=null&&C.unshift(ud(f,Q,U))):b||(Q=Li(f,_),Q!=null&&C.push(ud(f,Q,U)))),f=f.return}C.length!==0&&a.push({event:c,listeners:C})}var xz=/\r\n?/g,Ez=/\u0000|\uFFFD/g;function sM(a){return(typeof a=="string"?a:""+a).replace(xz,`
`).replace(Ez,"")}function oM(a,c){return c=sM(c),sM(a)===c}function be(a,c,f,p,b,_){switch(f){case"children":typeof p=="string"?c==="body"||c==="textarea"&&p===""||xr(a,p):(typeof p=="number"||typeof p=="bigint")&&c!=="body"&&xr(a,""+p);break;case"className":Br(a,"class",p);break;case"tabIndex":Br(a,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Br(a,f,p);break;case"style":Rf(a,p,_);break;case"data":if(c!=="object"){Br(a,"data",p);break}case"src":case"href":if(p===""&&(c!=="a"||f!=="href")){a.removeAttribute(f);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){a.removeAttribute(f);break}p=yu(""+p),a.setAttribute(f,p);break;case"action":case"formAction":if(typeof p=="function"){a.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(f==="formAction"?(c!=="input"&&be(a,c,"name",b.name,b,null),be(a,c,"formEncType",b.formEncType,b,null),be(a,c,"formMethod",b.formMethod,b,null),be(a,c,"formTarget",b.formTarget,b,null)):(be(a,c,"encType",b.encType,b,null),be(a,c,"method",b.method,b,null),be(a,c,"target",b.target,b,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){a.removeAttribute(f);break}p=yu(""+p),a.setAttribute(f,p);break;case"onClick":p!=null&&(a.onclick=Ni);break;case"onScroll":p!=null&&Kt("scroll",a);break;case"onScrollEnd":p!=null&&Kt("scrollend",a);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(f=p.__html,f!=null){if(b.children!=null)throw Error(r(60));a.innerHTML=f}}break;case"multiple":a.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":a.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){a.removeAttribute("xlink:href");break}f=yu(""+p),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?a.setAttribute(f,""+p):a.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?a.setAttribute(f,""):a.removeAttribute(f);break;case"capture":case"download":p===!0?a.setAttribute(f,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?a.setAttribute(f,p):a.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?a.setAttribute(f,p):a.removeAttribute(f);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?a.removeAttribute(f):a.setAttribute(f,p);break;case"popover":Kt("beforetoggle",a),Kt("toggle",a),pu(a,"popover",p);break;case"xlinkActuate":un(a,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":un(a,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":un(a,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":un(a,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":un(a,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":un(a,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":un(a,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":un(a,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":un(a,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":pu(a,"is",p);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Um.get(f)||f,pu(a,f,p))}}function $T(a,c,f,p,b,_){switch(f){case"style":Rf(a,p,_);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(f=p.__html,f!=null){if(b.children!=null)throw Error(r(60));a.innerHTML=f}}break;case"children":typeof p=="string"?xr(a,p):(typeof p=="number"||typeof p=="bigint")&&xr(a,""+p);break;case"onScroll":p!=null&&Kt("scroll",a);break;case"onScrollEnd":p!=null&&Kt("scrollend",a);break;case"onClick":p!=null&&(a.onclick=Ni);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Sf.hasOwnProperty(f))t:{if(f[0]==="o"&&f[1]==="n"&&(b=f.endsWith("Capture"),c=f.slice(2,b?f.length-7:void 0),_=a[An]||null,_=_!=null?_[f]:null,typeof _=="function"&&a.removeEventListener(c,_,b),typeof p=="function")){typeof _!="function"&&_!==null&&(f in a?a[f]=null:a.hasAttribute(f)&&a.removeAttribute(f)),a.addEventListener(c,p,b);break t}f in a?a[f]=p:p===!0?a.setAttribute(f,""):pu(a,f,p)}}}function Un(a,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Kt("error",a),Kt("load",a);var p=!1,b=!1,_;for(_ in f)if(f.hasOwnProperty(_)){var C=f[_];if(C!=null)switch(_){case"src":p=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:be(a,c,_,C,f,null)}}b&&be(a,c,"srcSet",f.srcSet,f,null),p&&be(a,c,"src",f.src,f,null);return;case"input":Kt("invalid",a);var D=_=C=b=null,U=null,Q=null;for(p in f)if(f.hasOwnProperty(p)){var rt=f[p];if(rt!=null)switch(p){case"name":b=rt;break;case"type":C=rt;break;case"checked":U=rt;break;case"defaultChecked":Q=rt;break;case"value":_=rt;break;case"defaultValue":D=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(r(137,c));break;default:be(a,c,p,rt,f,null)}}jm(a,_,D,U,Q,C,b,!1);return;case"select":Kt("invalid",a),p=C=_=null;for(b in f)if(f.hasOwnProperty(b)&&(D=f[b],D!=null))switch(b){case"value":_=D;break;case"defaultValue":C=D;break;case"multiple":p=D;default:be(a,c,b,D,f,null)}c=_,f=C,a.multiple=!!p,c!=null?ra(a,!!p,c,!1):f!=null&&ra(a,!!p,f,!0);return;case"textarea":Kt("invalid",a),_=b=p=null;for(C in f)if(f.hasOwnProperty(C)&&(D=f[C],D!=null))switch(C){case"value":p=D;break;case"defaultValue":b=D;break;case"children":_=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(r(91));break;default:be(a,c,C,D,f,null)}ia(a,p,b,_);return;case"option":for(U in f)f.hasOwnProperty(U)&&(p=f[U],p!=null)&&(U==="selected"?a.selected=p&&typeof p!="function"&&typeof p!="symbol":be(a,c,U,p,f,null));return;case"dialog":Kt("beforetoggle",a),Kt("toggle",a),Kt("cancel",a),Kt("close",a);break;case"iframe":case"object":Kt("load",a);break;case"video":case"audio":for(p=0;p<cd.length;p++)Kt(cd[p],a);break;case"image":Kt("error",a),Kt("load",a);break;case"details":Kt("toggle",a);break;case"embed":case"source":case"link":Kt("error",a),Kt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in f)if(f.hasOwnProperty(Q)&&(p=f[Q],p!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:be(a,c,Q,p,f,null)}return;default:if(gu(c)){for(rt in f)f.hasOwnProperty(rt)&&(p=f[rt],p!==void 0&&$T(a,c,rt,p,f,void 0));return}}for(D in f)f.hasOwnProperty(D)&&(p=f[D],p!=null&&be(a,c,D,p,f,null))}function Cz(a,c,f,p){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,_=null,C=null,D=null,U=null,Q=null,rt=null;for(nt in f){var lt=f[nt];if(f.hasOwnProperty(nt)&&lt!=null)switch(nt){case"checked":break;case"value":break;case"defaultValue":U=lt;default:p.hasOwnProperty(nt)||be(a,c,nt,null,p,lt)}}for(var Z in p){var nt=p[Z];if(lt=f[Z],p.hasOwnProperty(Z)&&(nt!=null||lt!=null))switch(Z){case"type":_=nt;break;case"name":b=nt;break;case"checked":Q=nt;break;case"defaultChecked":rt=nt;break;case"value":C=nt;break;case"defaultValue":D=nt;break;case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(r(137,c));break;default:nt!==lt&&be(a,c,Z,nt,p,lt)}}mu(a,C,D,U,Q,rt,_,b);return;case"select":nt=C=D=Z=null;for(_ in f)if(U=f[_],f.hasOwnProperty(_)&&U!=null)switch(_){case"value":break;case"multiple":nt=U;default:p.hasOwnProperty(_)||be(a,c,_,null,p,U)}for(b in p)if(_=p[b],U=f[b],p.hasOwnProperty(b)&&(_!=null||U!=null))switch(b){case"value":Z=_;break;case"defaultValue":D=_;break;case"multiple":C=_;default:_!==U&&be(a,c,b,_,p,U)}c=D,f=C,p=nt,Z!=null?ra(a,!!f,Z,!1):!!p!=!!f&&(c!=null?ra(a,!!f,c,!0):ra(a,!!f,f?[]:"",!1));return;case"textarea":nt=Z=null;for(D in f)if(b=f[D],f.hasOwnProperty(D)&&b!=null&&!p.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:be(a,c,D,null,p,b)}for(C in p)if(b=p[C],_=f[C],p.hasOwnProperty(C)&&(b!=null||_!=null))switch(C){case"value":Z=b;break;case"defaultValue":nt=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(r(91));break;default:b!==_&&be(a,c,C,b,p,_)}Bm(a,Z,nt);return;case"option":for(var Tt in f)Z=f[Tt],f.hasOwnProperty(Tt)&&Z!=null&&!p.hasOwnProperty(Tt)&&(Tt==="selected"?a.selected=!1:be(a,c,Tt,null,p,Z));for(U in p)Z=p[U],nt=f[U],p.hasOwnProperty(U)&&Z!==nt&&(Z!=null||nt!=null)&&(U==="selected"?a.selected=Z&&typeof Z!="function"&&typeof Z!="symbol":be(a,c,U,Z,p,nt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pt in f)Z=f[Pt],f.hasOwnProperty(Pt)&&Z!=null&&!p.hasOwnProperty(Pt)&&be(a,c,Pt,null,p,Z);for(Q in p)if(Z=p[Q],nt=f[Q],p.hasOwnProperty(Q)&&Z!==nt&&(Z!=null||nt!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(137,c));break;default:be(a,c,Q,Z,p,nt)}return;default:if(gu(c)){for(var _e in f)Z=f[_e],f.hasOwnProperty(_e)&&Z!==void 0&&!p.hasOwnProperty(_e)&&$T(a,c,_e,void 0,p,Z);for(rt in p)Z=p[rt],nt=f[rt],!p.hasOwnProperty(rt)||Z===nt||Z===void 0&&nt===void 0||$T(a,c,rt,Z,p,nt);return}}for(var Y in f)Z=f[Y],f.hasOwnProperty(Y)&&Z!=null&&!p.hasOwnProperty(Y)&&be(a,c,Y,null,p,Z);for(lt in p)Z=p[lt],nt=f[lt],!p.hasOwnProperty(lt)||Z===nt||Z==null&&nt==null||be(a,c,lt,Z,p,nt)}function aM(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Az(){if(typeof performance.getEntriesByType=="function"){for(var a=0,c=0,f=performance.getEntriesByType("resource"),p=0;p<f.length;p++){var b=f[p],_=b.transferSize,C=b.initiatorType,D=b.duration;if(_&&D&&aM(C)){for(C=0,D=b.responseEnd,p+=1;p<f.length;p++){var U=f[p],Q=U.startTime;if(Q>D)break;var rt=U.transferSize,lt=U.initiatorType;rt&&aM(lt)&&(U=U.responseEnd,C+=rt*(U<D?1:(D-Q)/(U-Q)))}if(--p,c+=8*(_+C)/(b.duration/1e3),a++,10<a)break}}if(0<a)return c/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var qT=null,GT=null;function zg(a){return a.nodeType===9?a:a.ownerDocument}function lM(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cM(a,c){if(a===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&c==="foreignObject"?0:a}function WT(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var YT=null;function kz(){var a=window.event;return a&&a.type==="popstate"?a===YT?!1:(YT=a,!0):(YT=null,!1)}var uM=typeof setTimeout=="function"?setTimeout:void 0,Rz=typeof clearTimeout=="function"?clearTimeout:void 0,hM=typeof Promise=="function"?Promise:void 0,Mz=typeof queueMicrotask=="function"?queueMicrotask:typeof hM<"u"?function(a){return hM.resolve(null).then(a).catch(Dz)}:uM;function Dz(a){setTimeout(function(){throw a})}function Aa(a){return a==="head"}function fM(a,c){var f=c,p=0;do{var b=f.nextSibling;if(a.removeChild(f),b&&b.nodeType===8)if(f=b.data,f==="/$"||f==="/&"){if(p===0){a.removeChild(b),Qu(c);return}p--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")p++;else if(f==="html")hd(a.ownerDocument.documentElement);else if(f==="head"){f=a.ownerDocument.head,hd(f);for(var _=f.firstChild;_;){var C=_.nextSibling,D=_.nodeName;_[ps]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&_.rel.toLowerCase()==="stylesheet"||f.removeChild(_),_=C}}else f==="body"&&hd(a.ownerDocument.body);f=b}while(f);Qu(c)}function dM(a,c){var f=a;a=0;do{var p=f.nextSibling;if(f.nodeType===1?c?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(c?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),p&&p.nodeType===8)if(f=p.data,f==="/$"){if(a===0)break;a--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||a++;f=p}while(f)}function KT(a){var c=a.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":KT(f),du(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}a.removeChild(f)}}function Oz(a,c,f,p){for(;a.nodeType===1;){var b=f;if(a.nodeName.toLowerCase()!==c.toLowerCase()){if(!p&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(p){if(!a[ps])switch(c){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(_=a.getAttribute("rel"),_==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(_!==b.rel||a.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||a.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||a.getAttribute("title")!==(b.title==null?null:b.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(_=a.getAttribute("src"),(_!==(b.src==null?null:b.src)||a.getAttribute("type")!==(b.type==null?null:b.type)||a.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&_&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(c==="input"&&a.type==="hidden"){var _=b.name==null?null:""+b.name;if(b.type==="hidden"&&a.getAttribute("name")===_)return a}else return a;if(a=mi(a.nextSibling),a===null)break}return null}function Iz(a,c,f){if(c==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!f||(a=mi(a.nextSibling),a===null))return null;return a}function pM(a,c){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=mi(a.nextSibling),a===null))return null;return a}function XT(a){return a.data==="$?"||a.data==="$~"}function QT(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function Pz(a,c){var f=a.ownerDocument;if(a.data==="$~")a._reactRetry=c;else if(a.data!=="$?"||f.readyState!=="loading")c();else{var p=function(){c(),f.removeEventListener("DOMContentLoaded",p)};f.addEventListener("DOMContentLoaded",p),a._reactRetry=p}}function mi(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return a}var JT=null;function mM(a){a=a.nextSibling;for(var c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="/$"||f==="/&"){if(c===0)return mi(a.nextSibling);c--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||c++}a=a.nextSibling}return null}function gM(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(c===0)return a;c--}else f!=="/$"&&f!=="/&"||c++}a=a.previousSibling}return null}function yM(a,c,f){switch(c=zg(f),a){case"html":if(a=c.documentElement,!a)throw Error(r(452));return a;case"head":if(a=c.head,!a)throw Error(r(453));return a;case"body":if(a=c.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function hd(a){for(var c=a.attributes;c.length;)a.removeAttributeNode(c[0]);du(a)}var gi=new Map,vM=new Set;function Hg(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var bo=st.d;st.d={f:Nz,r:Lz,D:Vz,C:jz,L:Bz,m:Fz,X:zz,S:Uz,M:Hz};function Nz(){var a=bo.f(),c=Pg();return a||c}function Lz(a){var c=si(a);c!==null&&c.tag===5&&c.type==="form"?Nk(c):bo.r(a)}var Yu=typeof document>"u"?null:document;function bM(a,c,f){var p=Yu;if(p&&typeof c=="string"&&c){var b=wr(c);b='link[rel="'+a+'"][href="'+b+'"]',typeof f=="string"&&(b+='[crossorigin="'+f+'"]'),vM.has(b)||(vM.add(b),a={rel:a,crossOrigin:f,href:c},p.querySelector(b)===null&&(c=p.createElement("link"),Un(c,"link",a),cn(c),p.head.appendChild(c)))}}function Vz(a){bo.D(a),bM("dns-prefetch",a,null)}function jz(a,c){bo.C(a,c),bM("preconnect",a,c)}function Bz(a,c,f){bo.L(a,c,f);var p=Yu;if(p&&a&&c){var b='link[rel="preload"][as="'+wr(c)+'"]';c==="image"&&f&&f.imageSrcSet?(b+='[imagesrcset="'+wr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(b+='[imagesizes="'+wr(f.imageSizes)+'"]')):b+='[href="'+wr(a)+'"]';var _=b;switch(c){case"style":_=Ku(a);break;case"script":_=Xu(a)}gi.has(_)||(a=m({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:a,as:c},f),gi.set(_,a),p.querySelector(b)!==null||c==="style"&&p.querySelector(fd(_))||c==="script"&&p.querySelector(dd(_))||(c=p.createElement("link"),Un(c,"link",a),cn(c),p.head.appendChild(c)))}}function Fz(a,c){bo.m(a,c);var f=Yu;if(f&&a){var p=c&&typeof c.as=="string"?c.as:"script",b='link[rel="modulepreload"][as="'+wr(p)+'"][href="'+wr(a)+'"]',_=b;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Xu(a)}if(!gi.has(_)&&(a=m({rel:"modulepreload",href:a},c),gi.set(_,a),f.querySelector(b)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(dd(_)))return}p=f.createElement("link"),Un(p,"link",a),cn(p),f.head.appendChild(p)}}}function Uz(a,c,f){bo.S(a,c,f);var p=Yu;if(p&&a){var b=gs(p).hoistableStyles,_=Ku(a);c=c||"default";var C=b.get(_);if(!C){var D={loading:0,preload:null};if(C=p.querySelector(fd(_)))D.loading=5;else{a=m({rel:"stylesheet",href:a,"data-precedence":c},f),(f=gi.get(_))&&ZT(a,f);var U=C=p.createElement("link");cn(U),Un(U,"link",a),U._p=new Promise(function(Q,rt){U.onload=Q,U.onerror=rt}),U.addEventListener("load",function(){D.loading|=1}),U.addEventListener("error",function(){D.loading|=2}),D.loading|=4,$g(C,c,p)}C={type:"stylesheet",instance:C,count:1,state:D},b.set(_,C)}}}function zz(a,c){bo.X(a,c);var f=Yu;if(f&&a){var p=gs(f).hoistableScripts,b=Xu(a),_=p.get(b);_||(_=f.querySelector(dd(b)),_||(a=m({src:a,async:!0},c),(c=gi.get(b))&&tS(a,c),_=f.createElement("script"),cn(_),Un(_,"link",a),f.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},p.set(b,_))}}function Hz(a,c){bo.M(a,c);var f=Yu;if(f&&a){var p=gs(f).hoistableScripts,b=Xu(a),_=p.get(b);_||(_=f.querySelector(dd(b)),_||(a=m({src:a,async:!0,type:"module"},c),(c=gi.get(b))&&tS(a,c),_=f.createElement("script"),cn(_),Un(_,"link",a),f.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},p.set(b,_))}}function _M(a,c,f,p){var b=(b=It.current)?Hg(b):null;if(!b)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=Ku(f.href),f=gs(b).hoistableStyles,p=f.get(c),p||(p={type:"style",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){a=Ku(f.href);var _=gs(b).hoistableStyles,C=_.get(a);if(C||(b=b.ownerDocument||b,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(a,C),(_=b.querySelector(fd(a)))&&!_._p&&(C.instance=_,C.state.loading=5),gi.has(a)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},gi.set(a,f),_||$z(b,a,f,C.state))),c&&p===null)throw Error(r(528,""));return C}if(c&&p!==null)throw Error(r(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Xu(f),f=gs(b).hoistableScripts,p=f.get(c),p||(p={type:"script",instance:null,count:0,state:null},f.set(c,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function Ku(a){return'href="'+wr(a)+'"'}function fd(a){return'link[rel="stylesheet"]['+a+"]"}function TM(a){return m({},a,{"data-precedence":a.precedence,precedence:null})}function $z(a,c,f,p){a.querySelector('link[rel="preload"][as="style"]['+c+"]")?p.loading=1:(c=a.createElement("link"),p.preload=c,c.addEventListener("load",function(){return p.loading|=1}),c.addEventListener("error",function(){return p.loading|=2}),Un(c,"link",f),cn(c),a.head.appendChild(c))}function Xu(a){return'[src="'+wr(a)+'"]'}function dd(a){return"script[async]"+a}function SM(a,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var p=a.querySelector('style[data-href~="'+wr(f.href)+'"]');if(p)return c.instance=p,cn(p),p;var b=m({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return p=(a.ownerDocument||a).createElement("style"),cn(p),Un(p,"style",b),$g(p,f.precedence,a),c.instance=p;case"stylesheet":b=Ku(f.href);var _=a.querySelector(fd(b));if(_)return c.state.loading|=4,c.instance=_,cn(_),_;p=TM(f),(b=gi.get(b))&&ZT(p,b),_=(a.ownerDocument||a).createElement("link"),cn(_);var C=_;return C._p=new Promise(function(D,U){C.onload=D,C.onerror=U}),Un(_,"link",p),c.state.loading|=4,$g(_,f.precedence,a),c.instance=_;case"script":return _=Xu(f.src),(b=a.querySelector(dd(_)))?(c.instance=b,cn(b),b):(p=f,(b=gi.get(_))&&(p=m({},f),tS(p,b)),a=a.ownerDocument||a,b=a.createElement("script"),cn(b),Un(b,"link",p),a.head.appendChild(b),c.instance=b);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(p=c.instance,c.state.loading|=4,$g(p,f.precedence,a));return c.instance}function $g(a,c,f){for(var p=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=p.length?p[p.length-1]:null,_=b,C=0;C<p.length;C++){var D=p[C];if(D.dataset.precedence===c)_=D;else if(_!==b)break}_?_.parentNode.insertBefore(a,_.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(a,c.firstChild))}function ZT(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.title==null&&(a.title=c.title)}function tS(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.integrity==null&&(a.integrity=c.integrity)}var qg=null;function wM(a,c,f){if(qg===null){var p=new Map,b=qg=new Map;b.set(f,p)}else b=qg,p=b.get(f),p||(p=new Map,b.set(f,p));if(p.has(a))return p;for(p.set(a,null),f=f.getElementsByTagName(a),b=0;b<f.length;b++){var _=f[b];if(!(_[ps]||_[ln]||a==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var C=_.getAttribute(c)||"";C=a+C;var D=p.get(C);D?D.push(_):p.set(C,[_])}}return p}function xM(a,c,f){a=a.ownerDocument||a,a.head.insertBefore(f,c==="title"?a.querySelector("head > title"):null)}function qz(a,c,f){if(f===1||c.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(a=c.disabled,typeof c.precedence=="string"&&a==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function EM(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function Gz(a,c,f,p){if(f.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var b=Ku(p.href),_=c.querySelector(fd(b));if(_){c=_._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(a.count++,a=Gg.bind(a),c.then(a,a)),f.state.loading|=4,f.instance=_,cn(_);return}_=c.ownerDocument||c,p=TM(p),(b=gi.get(b))&&ZT(p,b),_=_.createElement("link"),cn(_);var C=_;C._p=new Promise(function(D,U){C.onload=D,C.onerror=U}),Un(_,"link",p),f.instance=_}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(a.count++,f=Gg.bind(a),c.addEventListener("load",f),c.addEventListener("error",f))}}var eS=0;function Wz(a,c){return a.stylesheets&&a.count===0&&Yg(a,a.stylesheets),0<a.count||0<a.imgCount?function(f){var p=setTimeout(function(){if(a.stylesheets&&Yg(a,a.stylesheets),a.unsuspend){var _=a.unsuspend;a.unsuspend=null,_()}},6e4+c);0<a.imgBytes&&eS===0&&(eS=62500*Az());var b=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&Yg(a,a.stylesheets),a.unsuspend)){var _=a.unsuspend;a.unsuspend=null,_()}},(a.imgBytes>eS?50:800)+c);return a.unsuspend=f,function(){a.unsuspend=null,clearTimeout(p),clearTimeout(b)}}:null}function Gg(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Yg(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Wg=null;function Yg(a,c){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Wg=new Map,c.forEach(Yz,a),Wg=null,Gg.call(a))}function Yz(a,c){if(!(c.state.loading&4)){var f=Wg.get(a);if(f)var p=f.get(null);else{f=new Map,Wg.set(a,f);for(var b=a.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<b.length;_++){var C=b[_];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(f.set(C.dataset.precedence,C),p=C)}p&&f.set(null,p)}b=c.instance,C=b.getAttribute("data-precedence"),_=f.get(C)||p,_===p&&f.set(null,b),f.set(C,b),this.count++,p=Gg.bind(this),b.addEventListener("load",p),b.addEventListener("error",p),_?_.parentNode.insertBefore(b,_.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(b,a.firstChild)),c.state.loading|=4}}var pd={$$typeof:P,Provider:null,Consumer:null,_currentValue:ht,_currentValue2:ht,_threadCount:0};function Kz(a,c,f,p,b,_,C,D,U){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fs(0),this.hiddenUpdates=fs(null),this.identifierPrefix=p,this.onUncaughtError=b,this.onCaughtError=_,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function CM(a,c,f,p,b,_,C,D,U,Q,rt,lt){return a=new Kz(a,c,f,C,U,Q,rt,lt,D),c=1,_===!0&&(c|=24),_=Ur(3,null,null,c),a.current=_,_.stateNode=a,c=P_(),c.refCount++,a.pooledCache=c,c.refCount++,_.memoizedState={element:p,isDehydrated:f,cache:c},j_(_),a}function AM(a){return a?(a=Au,a):Au}function kM(a,c,f,p,b,_){b=AM(b),p.context===null?p.context=b:p.pendingContext=b,p=ga(c),p.payload={element:f},_=_===void 0?null:_,_!==null&&(p.callback=_),f=ya(a,p,c),f!==null&&(Rr(f,a,c),Gf(f,a,c))}function RM(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<c?f:c}}function nS(a,c){RM(a,c),(a=a.alternate)&&RM(a,c)}function MM(a){if(a.tag===13||a.tag===31){var c=tc(a,67108864);c!==null&&Rr(c,a,67108864),nS(a,67108864)}}function DM(a){if(a.tag===13||a.tag===31){var c=Gr();c=zl(c);var f=tc(a,c);f!==null&&Rr(f,a,c),nS(a,c)}}var Kg=!0;function Xz(a,c,f,p){var b=J.T;J.T=null;var _=st.p;try{st.p=2,rS(a,c,f,p)}finally{st.p=_,J.T=b}}function Qz(a,c,f,p){var b=J.T;J.T=null;var _=st.p;try{st.p=8,rS(a,c,f,p)}finally{st.p=_,J.T=b}}function rS(a,c,f,p){if(Kg){var b=iS(p);if(b===null)HT(a,c,p,Xg,f),IM(a,p);else if(Zz(b,a,c,f,p))p.stopPropagation();else if(IM(a,p),c&4&&-1<Jz.indexOf(a)){for(;b!==null;){var _=si(b);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var C=us(_.pendingLanes);if(C!==0){var D=_;for(D.pendingLanes|=2,D.entangledLanes|=2;C;){var U=1<<31-Je(C);D.entanglements[1]|=U,C&=~U}Rs(_),(le&6)===0&&(Og=or()+500,ld(0))}}break;case 31:case 13:D=tc(_,2),D!==null&&Rr(D,_,2),Pg(),nS(_,2)}if(_=iS(p),_===null&&HT(a,c,p,Xg,f),_===b)break;b=_}b!==null&&p.stopPropagation()}else HT(a,c,p,null,f)}}function iS(a){return a=oi(a),sS(a)}var Xg=null;function sS(a){if(Xg=null,a=ms(a),a!==null){var c=s(a);if(c===null)a=null;else{var f=c.tag;if(f===13){if(a=o(c),a!==null)return a;a=null}else if(f===31){if(a=l(c),a!==null)return a;a=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null)}}return Xg=a,null}function OM(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(jl()){case yf:return 2;case vf:return 8;case ea:case h_:return 32;case km:return 268435456;default:return 32}default:return 32}}var oS=!1,ka=null,Ra=null,Ma=null,md=new Map,gd=new Map,Da=[],Jz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function IM(a,c){switch(a){case"focusin":case"focusout":ka=null;break;case"dragenter":case"dragleave":Ra=null;break;case"mouseover":case"mouseout":Ma=null;break;case"pointerover":case"pointerout":md.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":gd.delete(c.pointerId)}}function yd(a,c,f,p,b,_){return a===null||a.nativeEvent!==_?(a={blockedOn:c,domEventName:f,eventSystemFlags:p,nativeEvent:_,targetContainers:[b]},c!==null&&(c=si(c),c!==null&&MM(c)),a):(a.eventSystemFlags|=p,c=a.targetContainers,b!==null&&c.indexOf(b)===-1&&c.push(b),a)}function Zz(a,c,f,p,b){switch(c){case"focusin":return ka=yd(ka,a,c,f,p,b),!0;case"dragenter":return Ra=yd(Ra,a,c,f,p,b),!0;case"mouseover":return Ma=yd(Ma,a,c,f,p,b),!0;case"pointerover":var _=b.pointerId;return md.set(_,yd(md.get(_)||null,a,c,f,p,b)),!0;case"gotpointercapture":return _=b.pointerId,gd.set(_,yd(gd.get(_)||null,a,c,f,p,b)),!0}return!1}function PM(a){var c=ms(a.target);if(c!==null){var f=s(c);if(f!==null){if(c=f.tag,c===13){if(c=o(f),c!==null){a.blockedOn=c,Ii(a.priority,function(){DM(f)});return}}else if(c===31){if(c=l(f),c!==null){a.blockedOn=c,Ii(a.priority,function(){DM(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){a.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Qg(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var f=iS(a.nativeEvent);if(f===null){f=a.nativeEvent;var p=new f.constructor(f.type,f);Mf=p,f.target.dispatchEvent(p),Mf=null}else return c=si(f),c!==null&&MM(c),a.blockedOn=f,!1;c.shift()}return!0}function NM(a,c,f){Qg(a)&&f.delete(c)}function t6(){oS=!1,ka!==null&&Qg(ka)&&(ka=null),Ra!==null&&Qg(Ra)&&(Ra=null),Ma!==null&&Qg(Ma)&&(Ma=null),md.forEach(NM),gd.forEach(NM)}function Jg(a,c){a.blockedOn===c&&(a.blockedOn=null,oS||(oS=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,t6)))}var Zg=null;function LM(a){Zg!==a&&(Zg=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Zg===a&&(Zg=null);for(var c=0;c<a.length;c+=3){var f=a[c],p=a[c+1],b=a[c+2];if(typeof p!="function"){if(sS(p||f)===null)continue;break}var _=si(f);_!==null&&(a.splice(c,3),c-=3,iT(_,{pending:!0,data:b,method:f.method,action:p},p,b))}}))}function Qu(a){function c(U){return Jg(U,a)}ka!==null&&Jg(ka,a),Ra!==null&&Jg(Ra,a),Ma!==null&&Jg(Ma,a),md.forEach(c),gd.forEach(c);for(var f=0;f<Da.length;f++){var p=Da[f];p.blockedOn===a&&(p.blockedOn=null)}for(;0<Da.length&&(f=Da[0],f.blockedOn===null);)PM(f),f.blockedOn===null&&Da.shift();if(f=(a.ownerDocument||a).$$reactFormReplay,f!=null)for(p=0;p<f.length;p+=3){var b=f[p],_=f[p+1],C=b[An]||null;if(typeof _=="function")C||LM(f);else if(C){var D=null;if(_&&_.hasAttribute("formAction")){if(b=_,C=_[An]||null)D=C.formAction;else if(sS(b)!==null)continue}else D=C.action;typeof D=="function"?f[p+1]=D:(f.splice(p,3),p-=3),LM(f)}}}function VM(){function a(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(C){return b=C})},focusReset:"manual",scroll:"manual"})}function c(){b!==null&&(b(),b=null),p||setTimeout(f,20)}function f(){if(!p&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,b=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(f,100),function(){p=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),b!==null&&(b(),b=null)}}}function aS(a){this._internalRoot=a}ty.prototype.render=aS.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(r(409));var f=c.current,p=Gr();kM(f,p,a,c,null,null)},ty.prototype.unmount=aS.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;kM(a.current,2,null,a,null,null),Pg(),c[ds]=null}};function ty(a){this._internalRoot=a}ty.prototype.unstable_scheduleHydration=function(a){if(a){var c=Pm();a={blockedOn:null,target:a,priority:c};for(var f=0;f<Da.length&&c!==0&&c<Da[f].priority;f++);Da.splice(f,0,a),f===0&&PM(a)}};var jM=t.version;if(jM!=="19.2.4")throw Error(r(527,jM,"19.2.4"));st.findDOMNode=function(a){var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=h(c),a=a!==null?d(a):null,a=a===null?null:a.stateNode,a};var e6={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ey=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ey.isDisabled&&ey.supportsFiber)try{Di=ey.inject(e6),Ln=ey}catch{}}return bd.createRoot=function(a,c){if(!i(a))throw Error(r(299));var f=!1,p="",b=qk,_=Gk,C=Wk;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(_=c.onCaughtError),c.onRecoverableError!==void 0&&(C=c.onRecoverableError)),c=CM(a,1,!1,null,null,f,p,null,b,_,C,VM),a[ds]=c.current,zT(a),new aS(c)},bd.hydrateRoot=function(a,c,f){if(!i(a))throw Error(r(299));var p=!1,b="",_=qk,C=Gk,D=Wk,U=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(b=f.identifierPrefix),f.onUncaughtError!==void 0&&(_=f.onUncaughtError),f.onCaughtError!==void 0&&(C=f.onCaughtError),f.onRecoverableError!==void 0&&(D=f.onRecoverableError),f.formState!==void 0&&(U=f.formState)),c=CM(a,1,!0,c,f??null,p,b,U,_,C,D,VM),c.context=AM(null),f=c.current,p=Gr(),p=zl(p),b=ga(p),b.callback=null,ya(f,b,p),f=p,c.current.lanes=f,Fl(c,f),Rs(c),a[ds]=c.current,zT(a),new ty(c)},bd.version="19.2.4",bd}var YM;function u6(){if(YM)return uS.exports;YM=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),uS.exports=c6(),uS.exports}var h6=u6();var KM="popstate";function f6(n={}){function t(r,i){let{pathname:s,search:o,hash:l}=r.location;return Vw("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function e(r,i){return typeof i=="string"?i:bp(i)}return p6(t,e,null,n)}function Ne(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function as(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function d6(){return Math.random().toString(36).substring(2,10)}function XM(n,t){return{usr:n.state,key:n.key,idx:t}}function Vw(n,t,e=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof t=="string"?Gh(t):t,state:e,key:t&&t.key||r||d6()}}function bp({pathname:n="/",search:t="",hash:e=""}){return t&&t!=="?"&&(n+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(n+=e.charAt(0)==="#"?e:"#"+e),n}function Gh(n){let t={};if(n){let e=n.indexOf("#");e>=0&&(t.hash=n.substring(e),n=n.substring(0,e));let r=n.indexOf("?");r>=0&&(t.search=n.substring(r),n=n.substring(0,r)),n&&(t.pathname=n)}return t}function p6(n,t,e,r={}){let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,l="POP",u=null,h=d();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function d(){return(o.state||{idx:null}).idx}function m(){l="POP";let w=d(),E=w==null?null:w-h;h=w,u&&u({action:l,location:S.location,delta:E})}function g(w,E){l="PUSH";let R=Vw(S.location,w,E);h=d()+1;let P=XM(R,h),j=S.createHref(R);try{o.pushState(P,"",j)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(j)}s&&u&&u({action:l,location:S.location,delta:1})}function v(w,E){l="REPLACE";let R=Vw(S.location,w,E);h=d();let P=XM(R,h),j=S.createHref(R);o.replaceState(P,"",j),s&&u&&u({action:l,location:S.location,delta:0})}function T(w){return m6(w)}let S={get action(){return l},get location(){return n(i,o)},listen(w){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(KM,m),u=w,()=>{i.removeEventListener(KM,m),u=null}},createHref(w){return t(i,w)},createURL:T,encodeLocation(w){let E=T(w);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:g,replace:v,go(w){return o.go(w)}};return S}function m6(n,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Ne(e,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:bp(n);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=e+r),new URL(r,e)}function yN(n,t,e="/"){return g6(n,t,e,!1)}function g6(n,t,e,r){let i=typeof t=="string"?Gh(t):t,s=Uo(i.pathname||"/",e);if(s==null)return null;let o=vN(n);y6(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let h=k6(s);l=C6(o[u],h,r)}return l}function vN(n,t=[],e=[],r="",i=!1){let s=(o,l,u=i,h)=>{let d={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(r)&&u)return;Ne(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length)}let m=No([r,d.relativePath]),g=e.concat(d);o.children&&o.children.length>0&&(Ne(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),vN(o.children,t,g,m,u)),!(o.path==null&&!o.index)&&t.push({path:m,score:x6(m,o.index),routesMeta:g})};return n.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))s(o,l);else for(let u of bN(o.path))s(o,l,!0,u)}),t}function bN(n){let t=n.split("/");if(t.length===0)return[];let[e,...r]=t,i=e.endsWith("?"),s=e.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=bN(r.join("/")),l=[];return l.push(...o.map(u=>u===""?s:[s,u].join("/"))),i&&l.push(...o),l.map(u=>n.startsWith("/")&&u===""?"/":u)}function y6(n){n.sort((t,e)=>t.score!==e.score?e.score-t.score:E6(t.routesMeta.map(r=>r.childrenIndex),e.routesMeta.map(r=>r.childrenIndex)))}var v6=/^:[\w-]+$/,b6=3,_6=2,T6=1,S6=10,w6=-2,QM=n=>n==="*";function x6(n,t){let e=n.split("/"),r=e.length;return e.some(QM)&&(r+=w6),t&&(r+=_6),e.filter(i=>!QM(i)).reduce((i,s)=>i+(v6.test(s)?b6:s===""?T6:S6),r)}function E6(n,t){return n.length===t.length&&n.slice(0,-1).every((r,i)=>r===t[i])?n[n.length-1]-t[t.length-1]:0}function C6(n,t,e=!1){let{routesMeta:r}=n,i={},s="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],h=l===r.length-1,d=s==="/"?t:t.slice(s.length)||"/",m=k0({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},d),g=u.route;if(!m&&h&&e&&!r[r.length-1].route.index&&(m=k0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!m)return null;Object.assign(i,m.params),o.push({params:i,pathname:No([s,m.pathname]),pathnameBase:O6(No([s,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(s=No([s,m.pathnameBase]))}return o}function k0(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[e,r]=A6(n.path,n.caseSensitive,n.end),i=t.match(e);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((h,{paramName:d,isOptional:m},g)=>{if(d==="*"){let T=l[g]||"";o=s.slice(0,s.length-T.length).replace(/(.)\/+$/,"$1")}const v=l[g];return m&&!v?h[d]=void 0:h[d]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:o,pattern:n}}function A6(n,t=!1,e=!0){as(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function k6(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return as(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),n}}function Uo(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,r=n.charAt(e);return r&&r!=="/"?null:n.slice(e)||"/"}var R6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function M6(n,t="/"){let{pathname:e,search:r="",hash:i=""}=typeof n=="string"?Gh(n):n,s;return e?(e=e.replace(/\/\/+/g,"/"),e.startsWith("/")?s=JM(e.substring(1),"/"):s=JM(e,t)):s=t,{pathname:s,search:I6(r),hash:P6(i)}}function JM(n,t){let e=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?e.length>1&&e.pop():i!=="."&&e.push(i)}),e.length>1?e.join("/"):"/"}function pS(n,t,e,r){return`Cannot include a '${n}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function D6(n){return n.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function xE(n){let t=D6(n);return t.map((e,r)=>r===t.length-1?e.pathname:e.pathnameBase)}function EE(n,t,e,r=!1){let i;typeof n=="string"?i=Gh(n):(i={...n},Ne(!i.pathname||!i.pathname.includes("?"),pS("?","pathname","search",i)),Ne(!i.pathname||!i.pathname.includes("#"),pS("#","pathname","hash",i)),Ne(!i.search||!i.search.includes("#"),pS("#","search","hash",i)));let s=n===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=e;else{let m=t.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;i.pathname=g.join("/")}l=m>=0?t[m]:"/"}let u=M6(i,l),h=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&e.endsWith("/");return!u.pathname.endsWith("/")&&(h||d)&&(u.pathname+="/"),u}var No=n=>n.join("/").replace(/\/\/+/g,"/"),O6=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),I6=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,P6=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,N6=class{constructor(n,t,e,r=!1){this.status=n,this.statusText=t||"",this.internal=r,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function L6(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function V6(n){return n.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var _N=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function TN(n,t){let e=n;if(typeof e!="string"||!R6.test(e))return{absoluteURL:void 0,isExternal:!1,to:e};let r=e,i=!1;if(_N)try{let s=new URL(window.location.href),o=e.startsWith("//")?new URL(s.protocol+e):new URL(e),l=Uo(o.pathname,t);o.origin===s.origin&&l!=null?e=l+o.search+o.hash:i=!0}catch{as(!1,`<Link to="${e}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var SN=["POST","PUT","PATCH","DELETE"];new Set(SN);var j6=["GET",...SN];new Set(j6);var Wh=L.createContext(null);Wh.displayName="DataRouter";var ab=L.createContext(null);ab.displayName="DataRouterState";var B6=L.createContext(!1),wN=L.createContext({isTransitioning:!1});wN.displayName="ViewTransition";var F6=L.createContext(new Map);F6.displayName="Fetchers";var U6=L.createContext(null);U6.displayName="Await";var ei=L.createContext(null);ei.displayName="Navigation";var tm=L.createContext(null);tm.displayName="Location";var Mi=L.createContext({outlet:null,matches:[],isDataRoute:!1});Mi.displayName="Route";var CE=L.createContext(null);CE.displayName="RouteError";var xN="REACT_ROUTER_ERROR",z6="REDIRECT",H6="ROUTE_ERROR_RESPONSE";function $6(n){if(n.startsWith(`${xN}:${z6}:{`))try{let t=JSON.parse(n.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function q6(n){if(n.startsWith(`${xN}:${H6}:{`))try{let t=JSON.parse(n.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new N6(t.status,t.statusText,t.data)}catch{}}function G6(n,{relative:t}={}){Ne(Yh(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:r}=L.useContext(ei),{hash:i,pathname:s,search:o}=nm(n,{relative:t}),l=s;return e!=="/"&&(l=s==="/"?e:No([e,s])),r.createHref({pathname:l,search:o,hash:i})}function Yh(){return L.useContext(tm)!=null}function xl(){return Ne(Yh(),"useLocation() may be used only in the context of a <Router> component."),L.useContext(tm).location}var EN="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function CN(n){L.useContext(ei).static||L.useLayoutEffect(n)}function em(){let{isDataRoute:n}=L.useContext(Mi);return n?lH():W6()}function W6(){Ne(Yh(),"useNavigate() may be used only in the context of a <Router> component.");let n=L.useContext(Wh),{basename:t,navigator:e}=L.useContext(ei),{matches:r}=L.useContext(Mi),{pathname:i}=xl(),s=JSON.stringify(xE(r)),o=L.useRef(!1);return CN(()=>{o.current=!0}),L.useCallback((u,h={})=>{if(as(o.current,EN),!o.current)return;if(typeof u=="number"){e.go(u);return}let d=EE(u,JSON.parse(s),i,h.relative==="path");n==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:No([t,d.pathname])),(h.replace?e.replace:e.push)(d,h.state,h)},[t,e,s,i,n])}var Y6=L.createContext(null);function K6(n){let t=L.useContext(Mi).outlet;return L.useMemo(()=>t&&L.createElement(Y6.Provider,{value:n},t),[t,n])}function X6(){let{matches:n}=L.useContext(Mi),t=n[n.length-1];return t?t.params:{}}function nm(n,{relative:t}={}){let{matches:e}=L.useContext(Mi),{pathname:r}=xl(),i=JSON.stringify(xE(e));return L.useMemo(()=>EE(n,JSON.parse(i),r,t==="path"),[n,i,r,t])}function Q6(n,t){return AN(n,t)}function AN(n,t,e,r,i){Ne(Yh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=L.useContext(ei),{matches:o}=L.useContext(Mi),l=o[o.length-1],u=l?l.params:{},h=l?l.pathname:"/",d=l?l.pathnameBase:"/",m=l&&l.route;{let R=m&&m.path||"";RN(h,!m||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let g=xl(),v;if(t){let R=typeof t=="string"?Gh(t):t;Ne(d==="/"||R.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${R.pathname}" was given in the \`location\` prop.`),v=R}else v=g;let T=v.pathname||"/",S=T;if(d!=="/"){let R=d.replace(/^\//,"").split("/");S="/"+T.replace(/^\//,"").split("/").slice(R.length).join("/")}let w=yN(n,{pathname:S});as(m||w!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),as(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=nH(w&&w.map(R=>Object.assign({},R,{params:Object.assign({},u,R.params),pathname:No([d,s.encodeLocation?s.encodeLocation(R.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?d:No([d,s.encodeLocation?s.encodeLocation(R.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathnameBase])})),o,e,r,i);return t&&E?L.createElement(tm.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function J6(){let n=aH(),t=L6(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),e=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=L.createElement(L.Fragment,null,L.createElement("p",null," Hey developer "),L.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",L.createElement("code",{style:s},"ErrorBoundary")," or"," ",L.createElement("code",{style:s},"errorElement")," prop on your route.")),L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},t),e?L.createElement("pre",{style:i},e):null,o)}var Z6=L.createElement(J6,null),kN=class extends L.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,t){return t.location!==n.location||t.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:t.error,location:t.location,revalidation:n.revalidation||t.revalidation}}componentDidCatch(n,t){this.props.onError?this.props.onError(n,t):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const e=q6(n.digest);e&&(n=e)}let t=n!==void 0?L.createElement(Mi.Provider,{value:this.props.routeContext},L.createElement(CE.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?L.createElement(tH,{error:n},t):t}};kN.contextType=B6;var mS=new WeakMap;function tH({children:n,error:t}){let{basename:e}=L.useContext(ei);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let r=$6(t.digest);if(r){let i=mS.get(t);if(i)throw i;let s=TN(r.location,e);if(_N&&!mS.get(t))if(s.isExternal||r.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:r.replace}));throw mS.set(t,o),o}return L.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return n}function eH({routeContext:n,match:t,children:e}){let r=L.useContext(Wh);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),L.createElement(Mi.Provider,{value:n},e)}function nH(n,t=[],e=null,r=null,i=null){if(n==null){if(!e)return null;if(e.errors)n=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)n=e.matches;else return null}let s=n,o=e?.errors;if(o!=null){let d=s.findIndex(m=>m.route.id&&o?.[m.route.id]!==void 0);Ne(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,d+1))}let l=!1,u=-1;if(e)for(let d=0;d<s.length;d++){let m=s[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=d),m.route.id){let{loaderData:g,errors:v}=e,T=m.route.loader&&!g.hasOwnProperty(m.route.id)&&(!v||v[m.route.id]===void 0);if(m.route.lazy||T){l=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}let h=e&&r?(d,m)=>{r(d,{location:e.location,params:e.matches?.[0]?.params??{},unstable_pattern:V6(e.matches),errorInfo:m})}:void 0;return s.reduceRight((d,m,g)=>{let v,T=!1,S=null,w=null;e&&(v=o&&m.route.id?o[m.route.id]:void 0,S=m.route.errorElement||Z6,l&&(u<0&&g===0?(RN("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),T=!0,w=null):u===g&&(T=!0,w=m.route.hydrateFallbackElement||null)));let E=t.concat(s.slice(0,g+1)),R=()=>{let P;return v?P=S:T?P=w:m.route.Component?P=L.createElement(m.route.Component,null):m.route.element?P=m.route.element:P=d,L.createElement(eH,{match:m,routeContext:{outlet:d,matches:E,isDataRoute:e!=null},children:P})};return e&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?L.createElement(kN,{location:e.location,revalidation:e.revalidation,component:S,error:v,children:R(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:h}):R()},null)}function AE(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rH(n){let t=L.useContext(Wh);return Ne(t,AE(n)),t}function iH(n){let t=L.useContext(ab);return Ne(t,AE(n)),t}function sH(n){let t=L.useContext(Mi);return Ne(t,AE(n)),t}function kE(n){let t=sH(n),e=t.matches[t.matches.length-1];return Ne(e.route.id,`${n} can only be used on routes that contain a unique "id"`),e.route.id}function oH(){return kE("useRouteId")}function aH(){let n=L.useContext(CE),t=iH("useRouteError"),e=kE("useRouteError");return n!==void 0?n:t.errors?.[e]}function lH(){let{router:n}=rH("useNavigate"),t=kE("useNavigate"),e=L.useRef(!1);return CN(()=>{e.current=!0}),L.useCallback(async(i,s={})=>{as(e.current,EN),e.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:t,...s}))},[n,t])}var ZM={};function RN(n,t,e){!t&&!ZM[n]&&(ZM[n]=!0,as(!1,e))}L.memo(cH);function cH({routes:n,future:t,state:e,onError:r}){return AN(n,void 0,e,r,t)}function MN({to:n,replace:t,state:e,relative:r}){Ne(Yh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=L.useContext(ei);as(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=L.useContext(Mi),{pathname:o}=xl(),l=em(),u=EE(n,xE(s),o,r==="path"),h=JSON.stringify(u);return L.useEffect(()=>{l(JSON.parse(h),{replace:t,state:e,relative:r})},[l,h,r,t,e]),null}function DN(n){return K6(n.context)}function Va(n){Ne(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function uH({basename:n="/",children:t=null,location:e,navigationType:r="POP",navigator:i,static:s=!1,unstable_useTransitions:o}){Ne(!Yh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),u=L.useMemo(()=>({basename:l,navigator:i,static:s,unstable_useTransitions:o,future:{}}),[l,i,s,o]);typeof e=="string"&&(e=Gh(e));let{pathname:h="/",search:d="",hash:m="",state:g=null,key:v="default"}=e,T=L.useMemo(()=>{let S=Uo(h,l);return S==null?null:{location:{pathname:S,search:d,hash:m,state:g,key:v},navigationType:r}},[l,h,d,m,g,v,r]);return as(T!=null,`<Router basename="${l}"> is not able to match the URL "${h}${d}${m}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:L.createElement(ei.Provider,{value:u},L.createElement(tm.Provider,{children:t,value:T}))}function hH({children:n,location:t}){return Q6(jw(n),t)}function jw(n,t=[]){let e=[];return L.Children.forEach(n,(r,i)=>{if(!L.isValidElement(r))return;let s=[...t,i];if(r.type===L.Fragment){e.push.apply(e,jw(r.props.children,s));return}Ne(r.type===Va,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ne(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=jw(r.props.children,s)),e.push(o)}),e}var Zy="get",t0="application/x-www-form-urlencoded";function lb(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function fH(n){return lb(n)&&n.tagName.toLowerCase()==="button"}function dH(n){return lb(n)&&n.tagName.toLowerCase()==="form"}function pH(n){return lb(n)&&n.tagName.toLowerCase()==="input"}function mH(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function gH(n,t){return n.button===0&&(!t||t==="_self")&&!mH(n)}var ny=null;function yH(){if(ny===null)try{new FormData(document.createElement("form"),0),ny=!1}catch{ny=!0}return ny}var vH=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function gS(n){return n!=null&&!vH.has(n)?(as(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${t0}"`),null):n}function bH(n,t){let e,r,i,s,o;if(dH(n)){let l=n.getAttribute("action");r=l?Uo(l,t):null,e=n.getAttribute("method")||Zy,i=gS(n.getAttribute("enctype"))||t0,s=new FormData(n)}else if(fH(n)||pH(n)&&(n.type==="submit"||n.type==="image")){let l=n.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||l.getAttribute("action");if(r=u?Uo(u,t):null,e=n.getAttribute("formmethod")||l.getAttribute("method")||Zy,i=gS(n.getAttribute("formenctype"))||gS(l.getAttribute("enctype"))||t0,s=new FormData(l,n),!yH()){let{name:h,type:d,value:m}=n;if(d==="image"){let g=h?`${h}.`:"";s.append(`${g}x`,"0"),s.append(`${g}y`,"0")}else h&&s.append(h,m)}}else{if(lb(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Zy,r=null,i=t0,o=n}return s&&i==="text/plain"&&(o=s,s=void 0),{action:r,method:e.toLowerCase(),encType:i,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function RE(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function _H(n,t,e,r){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:t&&Uo(i.pathname,t)==="/"?i.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function TH(n,t){if(n.id in t)return t[n.id];try{let e=await import(n.module);return t[n.id]=e,e}catch(e){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function SH(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function wH(n,t,e){let r=await Promise.all(n.map(async i=>{let s=t.routes[i.route.id];if(s){let o=await TH(s,e);return o.links?o.links():[]}return[]}));return AH(r.flat(1).filter(SH).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function tD(n,t,e,r,i,s){let o=(u,h)=>e[h]?u.route.id!==e[h].route.id:!0,l=(u,h)=>e[h].pathname!==u.pathname||e[h].route.path?.endsWith("*")&&e[h].params["*"]!==u.params["*"];return s==="assets"?t.filter((u,h)=>o(u,h)||l(u,h)):s==="data"?t.filter((u,h)=>{let d=r.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(o(u,h)||l(u,h))return!0;if(u.route.shouldRevalidate){let m=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function xH(n,t,{includeHydrateFallback:e}={}){return EH(n.map(r=>{let i=t.routes[r.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),e&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function EH(n){return[...new Set(n)]}function CH(n){let t={},e=Object.keys(n).sort();for(let r of e)t[r]=n[r];return t}function AH(n,t){let e=new Set;return new Set(t),n.reduce((r,i)=>{let s=JSON.stringify(CH(i));return e.has(s)||(e.add(s),r.push({key:s,link:i})),r},[])}function ON(){let n=L.useContext(Wh);return RE(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function kH(){let n=L.useContext(ab);return RE(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var ME=L.createContext(void 0);ME.displayName="FrameworkContext";function IN(){let n=L.useContext(ME);return RE(n,"You must render this element inside a <HydratedRouter> element"),n}function RH(n,t){let e=L.useContext(ME),[r,i]=L.useState(!1),[s,o]=L.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:h,onMouseLeave:d,onTouchStart:m}=t,g=L.useRef(null);L.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let S=E=>{E.forEach(R=>{o(R.isIntersecting)})},w=new IntersectionObserver(S,{threshold:.5});return g.current&&w.observe(g.current),()=>{w.disconnect()}}},[n]),L.useEffect(()=>{if(r){let S=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(S)}}},[r]);let v=()=>{i(!0)},T=()=>{i(!1),o(!1)};return e?n!=="intent"?[s,g,{}]:[s,g,{onFocus:_d(l,v),onBlur:_d(u,T),onMouseEnter:_d(h,v),onMouseLeave:_d(d,T),onTouchStart:_d(m,v)}]:[!1,g,{}]}function _d(n,t){return e=>{n&&n(e),e.defaultPrevented||t(e)}}function MH({page:n,...t}){let{router:e}=ON(),r=L.useMemo(()=>yN(e.routes,n,e.basename),[e.routes,n,e.basename]);return r?L.createElement(OH,{page:n,matches:r,...t}):null}function DH(n){let{manifest:t,routeModules:e}=IN(),[r,i]=L.useState([]);return L.useEffect(()=>{let s=!1;return wH(n,t,e).then(o=>{s||i(o)}),()=>{s=!0}},[n,t,e]),r}function OH({page:n,matches:t,...e}){let r=xl(),{future:i,manifest:s,routeModules:o}=IN(),{basename:l}=ON(),{loaderData:u,matches:h}=kH(),d=L.useMemo(()=>tD(n,t,h,s,r,"data"),[n,t,h,s,r]),m=L.useMemo(()=>tD(n,t,h,s,r,"assets"),[n,t,h,s,r]),g=L.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let S=new Set,w=!1;if(t.forEach(R=>{let P=s.routes[R.route.id];!P||!P.hasLoader||(!d.some(j=>j.route.id===R.route.id)&&R.route.id in u&&o[R.route.id]?.shouldRevalidate||P.hasClientLoader?w=!0:S.add(R.route.id))}),S.size===0)return[];let E=_H(n,l,i.unstable_trailingSlashAwareDataRequests,"data");return w&&S.size>0&&E.searchParams.set("_routes",t.filter(R=>S.has(R.route.id)).map(R=>R.route.id).join(",")),[E.pathname+E.search]},[l,i.unstable_trailingSlashAwareDataRequests,u,r,s,d,t,n,o]),v=L.useMemo(()=>xH(m,s),[m,s]),T=DH(m);return L.createElement(L.Fragment,null,g.map(S=>L.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...e})),v.map(S=>L.createElement("link",{key:S,rel:"modulepreload",href:S,...e})),T.map(({key:S,link:w})=>L.createElement("link",{key:S,nonce:e.nonce,...w,crossOrigin:w.crossOrigin??e.crossOrigin})))}function IH(...n){return t=>{n.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var PH=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{PH&&(window.__reactRouterVersion="7.13.0")}catch{}function NH({basename:n,children:t,unstable_useTransitions:e,window:r}){let i=L.useRef();i.current==null&&(i.current=f6({window:r,v5Compat:!0}));let s=i.current,[o,l]=L.useState({action:s.action,location:s.location}),u=L.useCallback(h=>{e===!1?l(h):L.startTransition(()=>l(h))},[e]);return L.useLayoutEffect(()=>s.listen(u),[s,u]),L.createElement(uH,{basename:n,children:t,location:o.location,navigationType:o.action,navigator:s,unstable_useTransitions:e})}var PN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,DE=L.forwardRef(function({onClick:t,discover:e="render",prefetch:r="none",relative:i,reloadDocument:s,replace:o,state:l,target:u,to:h,preventScrollReset:d,viewTransition:m,unstable_defaultShouldRevalidate:g,...v},T){let{basename:S,unstable_useTransitions:w}=L.useContext(ei),E=typeof h=="string"&&PN.test(h),R=TN(h,S);h=R.to;let P=G6(h,{relative:i}),[j,N,W]=RH(r,v),M=jH(h,{replace:o,state:l,target:u,preventScrollReset:d,relative:i,viewTransition:m,unstable_defaultShouldRevalidate:g,unstable_useTransitions:w});function k(B){t&&t(B),B.defaultPrevented||M(B)}let O=L.createElement("a",{...v,...W,href:R.absoluteURL||P,onClick:R.isExternal||s?t:k,ref:IH(T,N),target:u,"data-discover":!E&&e==="render"?"true":void 0});return j&&!E?L.createElement(L.Fragment,null,O,L.createElement(MH,{page:P})):O});DE.displayName="Link";var NN=L.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:r="",end:i=!1,style:s,to:o,viewTransition:l,children:u,...h},d){let m=nm(o,{relative:h.relative}),g=xl(),v=L.useContext(ab),{navigator:T,basename:S}=L.useContext(ei),w=v!=null&&HH(m)&&l===!0,E=T.encodeLocation?T.encodeLocation(m).pathname:m.pathname,R=g.pathname,P=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;e||(R=R.toLowerCase(),P=P?P.toLowerCase():null,E=E.toLowerCase()),P&&S&&(P=Uo(P,S)||P);const j=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let N=R===E||!i&&R.startsWith(E)&&R.charAt(j)==="/",W=P!=null&&(P===E||!i&&P.startsWith(E)&&P.charAt(E.length)==="/"),M={isActive:N,isPending:W,isTransitioning:w},k=N?t:void 0,O;typeof r=="function"?O=r(M):O=[r,N?"active":null,W?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let B=typeof s=="function"?s(M):s;return L.createElement(DE,{...h,"aria-current":k,className:O,ref:d,style:B,to:o,viewTransition:l},typeof u=="function"?u(M):u)});NN.displayName="NavLink";var LH=L.forwardRef(({discover:n="render",fetcherKey:t,navigate:e,reloadDocument:r,replace:i,state:s,method:o=Zy,action:l,onSubmit:u,relative:h,preventScrollReset:d,viewTransition:m,unstable_defaultShouldRevalidate:g,...v},T)=>{let{unstable_useTransitions:S}=L.useContext(ei),w=UH(),E=zH(l,{relative:h}),R=o.toLowerCase()==="get"?"get":"post",P=typeof l=="string"&&PN.test(l),j=N=>{if(u&&u(N),N.defaultPrevented)return;N.preventDefault();let W=N.nativeEvent.submitter,M=W?.getAttribute("formmethod")||o,k=()=>w(W||N.currentTarget,{fetcherKey:t,method:M,navigate:e,replace:i,state:s,relative:h,preventScrollReset:d,viewTransition:m,unstable_defaultShouldRevalidate:g});S&&e!==!1?L.startTransition(()=>k()):k()};return L.createElement("form",{ref:T,method:R,action:E,onSubmit:r?u:j,...v,"data-discover":!P&&n==="render"?"true":void 0})});LH.displayName="Form";function VH(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function LN(n){let t=L.useContext(Wh);return Ne(t,VH(n)),t}function jH(n,{target:t,replace:e,state:r,preventScrollReset:i,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:l,unstable_useTransitions:u}={}){let h=em(),d=xl(),m=nm(n,{relative:s});return L.useCallback(g=>{if(gH(g,t)){g.preventDefault();let v=e!==void 0?e:bp(d)===bp(m),T=()=>h(n,{replace:v,state:r,preventScrollReset:i,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:l});u?L.startTransition(()=>T()):T()}},[d,h,m,e,r,t,n,i,s,o,l,u])}var BH=0,FH=()=>`__${String(++BH)}__`;function UH(){let{router:n}=LN("useSubmit"),{basename:t}=L.useContext(ei),e=oH(),r=n.fetch,i=n.navigate;return L.useCallback(async(s,o={})=>{let{action:l,method:u,encType:h,formData:d,body:m}=bH(s,t);if(o.navigate===!1){let g=o.fetcherKey||FH();await r(g,e,o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:m,formMethod:o.method||u,formEncType:o.encType||h,flushSync:o.flushSync})}else await i(o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:m,formMethod:o.method||u,formEncType:o.encType||h,replace:o.replace,state:o.state,fromRouteId:e,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,t,e])}function zH(n,{relative:t}={}){let{basename:e}=L.useContext(ei),r=L.useContext(Mi);Ne(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s={...nm(n||".",{relative:t})},o=xl();if(n==null){s.search=o.search;let l=new URLSearchParams(s.search),u=l.getAll("index");if(u.some(d=>d==="")){l.delete("index"),u.filter(m=>m).forEach(m=>l.append("index",m));let d=l.toString();s.search=d?`?${d}`:""}}return(!n||n===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(s.pathname=s.pathname==="/"?e:No([e,s.pathname])),bp(s)}function HH(n,{relative:t}={}){let e=L.useContext(wN);Ne(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=LN("useViewTransitionState"),i=nm(n,{relative:t});if(!e.isTransitioning)return!1;let s=Uo(e.currentLocation.pathname,r)||e.currentLocation.pathname,o=Uo(e.nextLocation.pathname,r)||e.nextLocation.pathname;return k0(i.pathname,o)!=null||k0(i.pathname,s)!=null}var $H=gN();const qH=mN($H),GH=()=>{};var eD={};const VN=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},WH=function(n){const t=[];let e=0,r=0;for(;e<n.length;){const i=n[e++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[e++];t[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[e++],o=n[e++],l=n[e++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(u&1023))}else{const s=n[e++],o=n[e++];t[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},jN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,l=o?n[i+1]:0,u=i+2<n.length,h=u?n[i+2]:0,d=s>>2,m=(s&3)<<4|l>>4;let g=(l&15)<<2|h>>6,v=h&63;u||(v=64,o||(g=64)),r.push(e[d],e[m],e[g],e[v])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(VN(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):WH(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=e[n.charAt(i++)],l=i<n.length?e[n.charAt(i)]:0;++i;const h=i<n.length?e[n.charAt(i)]:64;++i;const m=i<n.length?e[n.charAt(i)]:64;if(++i,s==null||l==null||h==null||m==null)throw new YH;const g=s<<2|l>>4;if(r.push(g),h!==64){const v=l<<4&240|h>>2;if(r.push(v),m!==64){const T=h<<6&192|m;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class YH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KH=function(n){const t=VN(n);return jN.encodeByteArray(t,!0)},R0=function(n){return KH(n).replace(/\./g,"")},BN=function(n){try{return jN.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function XH(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const QH=()=>XH().__FIREBASE_DEFAULTS__,JH=()=>{if(typeof process>"u"||typeof eD>"u")return;const n=eD.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ZH=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&BN(n[1]);return t&&JSON.parse(t)},cb=()=>{try{return GH()||QH()||JH()||ZH()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},FN=n=>cb()?.emulatorHosts?.[n],UN=n=>{const t=FN(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),r]:[t.substring(0,e),r]},zN=()=>cb()?.config,HN=n=>cb()?.[`_${n}`];class t9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,r))}}}function El(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function OE(n){return(await fetch(n,{credentials:"include"})).ok}function $N(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},r=t||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[R0(JSON.stringify(e)),R0(JSON.stringify(o)),""].join(".")}const Gd={};function e9(){const n={prod:[],emulator:[]};for(const t of Object.keys(Gd))Gd[t]?n.emulator.push(t):n.prod.push(t);return n}function n9(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let nD=!1;function IE(n,t){if(typeof window>"u"||typeof document>"u"||!El(window.location.host)||Gd[n]===t||Gd[n]||nD)return;Gd[n]=t;function e(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=e9().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{nD=!0,o()},g}function d(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=n9(r),v=e("text"),T=document.getElementById(v)||document.createElement("span"),S=e("learnmore"),w=document.getElementById(S)||document.createElement("a"),E=e("preprendIcon"),R=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const P=g.element;l(P),d(w,S);const j=h();u(R,E),P.append(R,T,w,j),document.body.appendChild(P)}s?(T.innerText="Preview backend disconnected.",R.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(R.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function rr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function r9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(rr())}function i9(){const n=cb()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function s9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function o9(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function a9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function l9(){const n=rr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function c9(){return!i9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function u9(){try{return typeof indexedDB=="object"}catch{return!1}}function h9(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}const f9="FirebaseError";class Zs extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=f9,Object.setPrototypeOf(this,Zs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,rm.prototype.create)}}class rm{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?d9(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Zs(i,l,r)}}function d9(n,t){return n.replace(p9,(e,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const p9=/\{\$([^}]+)}/g;function m9(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function Hc(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const i of e){if(!r.includes(i))return!1;const s=n[i],o=t[i];if(rD(s)&&rD(o)){if(!Hc(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!e.includes(i))return!1;return!0}function rD(n){return n!==null&&typeof n=="object"}function im(n){const t=[];for(const[e,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Id(n){const t={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");t[decodeURIComponent(i)]=decodeURIComponent(s)}}),t}function Pd(n){const t=n.indexOf("?");if(!t)return"";const e=n.indexOf("#",t);return n.substring(t,e>0?e:void 0)}function g9(n,t){const e=new y9(n,t);return e.subscribe.bind(e)}class y9{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let i;if(t===void 0&&e===void 0&&r===void 0)throw new Error("Missing Observer.");v9(t,["next","error","complete"])?i=t:i={next:t,error:e,complete:r},i.next===void 0&&(i.next=yS),i.error===void 0&&(i.error=yS),i.complete===void 0&&(i.complete=yS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function v9(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function yS(){}function Le(n){return n&&n._delegate?n._delegate:n}class ul{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const gc="[DEFAULT]";class b9{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new t9;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),r=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(T9(t))try{this.getOrInitializeService({instanceIdentifier:gc})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(t=gc){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=gc){return this.instances.has(t)}getOptions(t=gc){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(t,e){const r=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(r)??new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const i of r)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:_9(t),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=gc){return this.component?this.component.multipleInstances?t:gc:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _9(n){return n===gc?void 0:n}function T9(n){return n.instantiationMode==="EAGER"}class S9{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new b9(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var Jt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Jt||(Jt={}));const w9={debug:Jt.DEBUG,verbose:Jt.VERBOSE,info:Jt.INFO,warn:Jt.WARN,error:Jt.ERROR,silent:Jt.SILENT},x9=Jt.INFO,E9={[Jt.DEBUG]:"log",[Jt.VERBOSE]:"log",[Jt.INFO]:"info",[Jt.WARN]:"warn",[Jt.ERROR]:"error"},C9=(n,t,...e)=>{if(t<n.logLevel)return;const r=new Date().toISOString(),i=E9[t];if(i)console[i](`[${r}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class PE{constructor(t){this.name=t,this._logLevel=x9,this._logHandler=C9,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Jt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?w9[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Jt.DEBUG,...t),this._logHandler(this,Jt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Jt.VERBOSE,...t),this._logHandler(this,Jt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Jt.INFO,...t),this._logHandler(this,Jt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Jt.WARN,...t),this._logHandler(this,Jt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Jt.ERROR,...t),this._logHandler(this,Jt.ERROR,...t)}}const A9=(n,t)=>t.some(e=>n instanceof e);let iD,sD;function k9(){return iD||(iD=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function R9(){return sD||(sD=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qN=new WeakMap,Bw=new WeakMap,GN=new WeakMap,vS=new WeakMap,NE=new WeakMap;function M9(n){const t=new Promise((e,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{e(el(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&qN.set(e,n)}).catch(()=>{}),NE.set(t,n),t}function D9(n){if(Bw.has(n))return;const t=new Promise((e,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{e(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Bw.set(n,t)}let Fw={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Bw.get(n);if(t==="objectStoreNames")return n.objectStoreNames||GN.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return el(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function O9(n){Fw=n(Fw)}function I9(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const r=n.call(bS(this),t,...e);return GN.set(r,t.sort?t.sort():[t]),el(r)}:R9().includes(n)?function(...t){return n.apply(bS(this),t),el(qN.get(this))}:function(...t){return el(n.apply(bS(this),t))}}function P9(n){return typeof n=="function"?I9(n):(n instanceof IDBTransaction&&D9(n),A9(n,k9())?new Proxy(n,Fw):n)}function el(n){if(n instanceof IDBRequest)return M9(n);if(vS.has(n))return vS.get(n);const t=P9(n);return t!==n&&(vS.set(n,t),NE.set(t,n)),t}const bS=n=>NE.get(n);function N9(n,t,{blocked:e,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,t),l=el(o);return r&&o.addEventListener("upgradeneeded",u=>{r(el(o.result),u.oldVersion,u.newVersion,el(o.transaction),u)}),e&&o.addEventListener("blocked",u=>e(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const L9=["get","getKey","getAll","getAllKeys","count"],V9=["put","add","delete","clear"],_S=new Map;function oD(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(_S.get(t))return _S.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,i=V9.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!(i||L9.includes(e)))return;const s=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[e](...l),i&&u.done]))[0]};return _S.set(t,s),s}O9(n=>({...n,get:(t,e,r)=>oD(t,e)||n.get(t,e,r),has:(t,e)=>!!oD(t,e)||n.has(t,e)}));class j9{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(B9(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(e=>e).join(" ")}}function B9(n){return n.getComponent()?.type==="VERSION"}const Uw="@firebase/app",aD="0.14.8";const zo=new PE("@firebase/app"),F9="@firebase/app-compat",U9="@firebase/analytics-compat",z9="@firebase/analytics",H9="@firebase/app-check-compat",$9="@firebase/app-check",q9="@firebase/auth",G9="@firebase/auth-compat",W9="@firebase/database",Y9="@firebase/data-connect",K9="@firebase/database-compat",X9="@firebase/functions",Q9="@firebase/functions-compat",J9="@firebase/installations",Z9="@firebase/installations-compat",t$="@firebase/messaging",e$="@firebase/messaging-compat",n$="@firebase/performance",r$="@firebase/performance-compat",i$="@firebase/remote-config",s$="@firebase/remote-config-compat",o$="@firebase/storage",a$="@firebase/storage-compat",l$="@firebase/firestore",c$="@firebase/ai",u$="@firebase/firestore-compat",h$="firebase",f$="12.9.0";const zw="[DEFAULT]",d$={[Uw]:"fire-core",[F9]:"fire-core-compat",[z9]:"fire-analytics",[U9]:"fire-analytics-compat",[$9]:"fire-app-check",[H9]:"fire-app-check-compat",[q9]:"fire-auth",[G9]:"fire-auth-compat",[W9]:"fire-rtdb",[Y9]:"fire-data-connect",[K9]:"fire-rtdb-compat",[X9]:"fire-fn",[Q9]:"fire-fn-compat",[J9]:"fire-iid",[Z9]:"fire-iid-compat",[t$]:"fire-fcm",[e$]:"fire-fcm-compat",[n$]:"fire-perf",[r$]:"fire-perf-compat",[i$]:"fire-rc",[s$]:"fire-rc-compat",[o$]:"fire-gcs",[a$]:"fire-gcs-compat",[l$]:"fire-fst",[u$]:"fire-fst-compat",[c$]:"fire-vertex","fire-js":"fire-js",[h$]:"fire-js-all"};const M0=new Map,p$=new Map,Hw=new Map;function lD(n,t){try{n.container.addComponent(t)}catch(e){zo.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function $c(n){const t=n.name;if(Hw.has(t))return zo.debug(`There were multiple attempts to register component ${t}.`),!1;Hw.set(t,n);for(const e of M0.values())lD(e,n);for(const e of p$.values())lD(e,n);return!0}function ub(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function Ir(n){return n==null?!1:n.settings!==void 0}const m$={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},nl=new rm("app","Firebase",m$);class g${constructor(t,e,r){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ul("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw nl.create("app-deleted",{appName:this._name})}}const su=f$;function WN(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const r={name:zw,automaticDataCollectionEnabled:!0,...t},i=r.name;if(typeof i!="string"||!i)throw nl.create("bad-app-name",{appName:String(i)});if(e||(e=zN()),!e)throw nl.create("no-options");const s=M0.get(i);if(s){if(Hc(e,s.options)&&Hc(r,s.config))return s;throw nl.create("duplicate-app",{appName:i})}const o=new S9(i);for(const u of Hw.values())o.addComponent(u);const l=new g$(e,r,o);return M0.set(i,l),l}function LE(n=zw){const t=M0.get(n);if(!t&&n===zw&&zN())return WN();if(!t)throw nl.create("no-app",{appName:n});return t}function Fs(n,t,e){let r=d$[n]??n;e&&(r+=`-${e}`);const i=r.match(/\s|\//),s=t.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${t}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),zo.warn(o.join(" "));return}$c(new ul(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const y$="firebase-heartbeat-database",v$=1,_p="firebase-heartbeat-store";let TS=null;function YN(){return TS||(TS=N9(y$,v$,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(_p)}catch(e){console.warn(e)}}}}).catch(n=>{throw nl.create("idb-open",{originalErrorMessage:n.message})})),TS}async function b$(n){try{const e=(await YN()).transaction(_p),r=await e.objectStore(_p).get(KN(n));return await e.done,r}catch(t){if(t instanceof Zs)zo.warn(t.message);else{const e=nl.create("idb-get",{originalErrorMessage:t?.message});zo.warn(e.message)}}}async function cD(n,t){try{const r=(await YN()).transaction(_p,"readwrite");await r.objectStore(_p).put(t,KN(n)),await r.done}catch(e){if(e instanceof Zs)zo.warn(e.message);else{const r=nl.create("idb-set",{originalErrorMessage:e?.message});zo.warn(r.message)}}}function KN(n){return`${n.name}!${n.options.appId}`}const _$=1024,T$=30;class S${constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new x$(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=uD();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:e}),this._heartbeatsCache.heartbeats.length>T$){const i=E$(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){zo.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=uD(),{heartbeatsToSend:e,unsentEntries:r}=w$(this._heartbeatsCache.heartbeats),i=R0(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return zo.warn(t),""}}}function uD(){return new Date().toISOString().substring(0,10)}function w$(n,t=_$){const e=[];let r=n.slice();for(const i of n){const s=e.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),hD(e)>t){s.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),hD(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}class x${constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return u9()?h9().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await b$(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return cD(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return cD(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function hD(n){return R0(JSON.stringify({version:2,heartbeats:n})).length}function E$(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let r=1;r<n.length;r++)n[r].date<e&&(e=n[r].date,t=r);return t}function C$(n){$c(new ul("platform-logger",t=>new j9(t),"PRIVATE")),$c(new ul("heartbeat",t=>new S$(t),"PRIVATE")),Fs(Uw,aD,n),Fs(Uw,aD,"esm2020"),Fs("fire-js","")}C$("");function XN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const A$=XN,QN=new rm("auth","Firebase",XN());const D0=new PE("@firebase/auth");function k$(n,...t){D0.logLevel<=Jt.WARN&&D0.warn(`Auth (${su}): ${n}`,...t)}function e0(n,...t){D0.logLevel<=Jt.ERROR&&D0.error(`Auth (${su}): ${n}`,...t)}function Ai(n,...t){throw jE(n,...t)}function ts(n,...t){return jE(n,...t)}function VE(n,t,e){const r={...A$(),[t]:e};return new rm("auth","Firebase",r).create(t,{appName:n.name})}function Lo(n){return VE(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function R$(n,t,e){const r=e;if(!(t instanceof r))throw r.name!==t.constructor.name&&Ai(n,"argument-error"),VE(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function jE(n,...t){if(typeof n!="string"){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(e,...r)}return QN.create(n,...t)}function Lt(n,t,...e){if(!n)throw jE(t,...e)}function Mo(n){const t="INTERNAL ASSERTION FAILED: "+n;throw e0(t),new Error(t)}function Ho(n,t){n||Mo(t)}function $w(){return typeof self<"u"&&self.location?.href||""}function M$(){return fD()==="http:"||fD()==="https:"}function fD(){return typeof self<"u"&&self.location?.protocol||null}function D$(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(M$()||o9()||"connection"in navigator)?navigator.onLine:!0}function O$(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class sm{constructor(t,e){this.shortDelay=t,this.longDelay=e,Ho(e>t,"Short delay should be less than long delay!"),this.isMobile=r9()||a9()}get(){return D$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function BE(n,t){Ho(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class JN{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Mo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Mo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Mo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const I$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const P$=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],N$=new sm(3e4,6e4);function Cl(n,t){return n.tenantId&&!t.tenantId?{...t,tenantId:n.tenantId}:t}async function Al(n,t,e,r,i={}){return ZN(n,i,async()=>{let s={},o={};r&&(t==="GET"?o=r:s={body:JSON.stringify(r)});const l=im({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:t,headers:u,...s};return s9()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&El(n.emulatorConfig.host)&&(h.credentials="include"),JN.fetch()(await tL(n,n.config.apiHost,e,l),h)})}async function ZN(n,t,e){n._canInitEmulator=!1;const r={...I$,...t};try{const i=new V$(n),s=await Promise.race([e(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw ry(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ry(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw ry(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw ry(n,"user-disabled",o);const d=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw VE(n,d,h);Ai(n,d)}}catch(i){if(i instanceof Zs)throw i;Ai(n,"network-request-failed",{message:String(i)})}}async function om(n,t,e,r,i={}){const s=await Al(n,t,e,r,i);return"mfaPendingCredential"in s&&Ai(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function tL(n,t,e,r){const i=`${t}${e}?${r}`,s=n,o=s.config.emulator?BE(n.config,i):`${n.config.apiScheme}://${i}`;return P$.includes(e)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function L$(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class V${clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(ts(this.auth,"network-request-failed")),N$.get())})}}function ry(n,t,e){const r={appName:n.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const i=ts(n,t,r);return i.customData._tokenResponse=e,i}function dD(n){return n!==void 0&&n.enterprise!==void 0}class j${constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return L$(e.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function B$(n,t){return Al(n,"GET","/v2/recaptchaConfig",Cl(n,t))}async function F$(n,t){return Al(n,"POST","/v1/accounts:delete",t)}async function O0(n,t){return Al(n,"POST","/v1/accounts:lookup",t)}function Wd(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function U$(n,t=!1){const e=Le(n),r=await e.getIdToken(t),i=FE(r);Lt(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Wd(SS(i.auth_time)),issuedAtTime:Wd(SS(i.iat)),expirationTime:Wd(SS(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function SS(n){return Number(n)*1e3}function FE(n){const[t,e,r]=n.split(".");if(t===void 0||e===void 0||r===void 0)return e0("JWT malformed, contained fewer than 3 sections"),null;try{const i=BN(e);return i?JSON.parse(i):(e0("Failed to decode base64 JWT payload"),null)}catch(i){return e0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function pD(n){const t=FE(n);return Lt(t,"internal-error"),Lt(typeof t.exp<"u","internal-error"),Lt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function Tp(n,t,e=!1){if(e)return t;try{return await t}catch(r){throw r instanceof Zs&&z$(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function z$({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class H${constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class qw{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wd(this.lastLoginAt),this.creationTime=Wd(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function I0(n){const t=n.auth,e=await n.getIdToken(),r=await Tp(n,O0(t,{idToken:e}));Lt(r?.users.length,t,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?eL(i.providerUserInfo):[],o=q$(n.providerData,s),l=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,h=l?u:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new qw(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function $$(n){const t=Le(n);await I0(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function q$(n,t){return[...n.filter(r=>!t.some(i=>i.providerId===r.providerId)),...t]}function eL(n){return n.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}async function G$(n,t){const e=await ZN(n,{},async()=>{const r=im({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await tL(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return n.emulatorConfig&&El(n.emulatorConfig.host)&&(u.credentials="include"),JN.fetch()(o,u)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function W$(n,t){return Al(n,"POST","/v2/accounts:revokeToken",Cl(n,t))}class _h{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Lt(t.idToken,"internal-error"),Lt(typeof t.idToken<"u","internal-error"),Lt(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):pD(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){Lt(t.length!==0,"internal-error");const e=pD(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(Lt(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:r,refreshToken:i,expiresIn:s}=await G$(t,e);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(t,e){const{refreshToken:r,accessToken:i,expirationTime:s}=e,o=new _h;return r&&(Lt(typeof r=="string","internal-error",{appName:t}),o.refreshToken=r),i&&(Lt(typeof i=="string","internal-error",{appName:t}),o.accessToken=i),s&&(Lt(typeof s=="number","internal-error",{appName:t}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new _h,this.toJSON())}_performRefresh(){return Mo("not implemented")}}function Ia(n,t){Lt(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class Xi{constructor({uid:t,auth:e,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new H$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new qw(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(t){const e=await Tp(this,this.stsTokenManager.getToken(this.auth,t));return Lt(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return U$(this,t)}reload(){return $$(this)}_assign(t){this!==t&&(Lt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Xi({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){Lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let r=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),e&&await I0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ir(this.auth.app))return Promise.reject(Lo(this.auth));const t=await this.getIdToken();return await Tp(this,F$(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const r=e.displayName??void 0,i=e.email??void 0,s=e.phoneNumber??void 0,o=e.photoURL??void 0,l=e.tenantId??void 0,u=e._redirectEventId??void 0,h=e.createdAt??void 0,d=e.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:v,providerData:T,stsTokenManager:S}=e;Lt(m&&S,t,"internal-error");const w=_h.fromJSON(this.name,S);Lt(typeof m=="string",t,"internal-error"),Ia(r,t.name),Ia(i,t.name),Lt(typeof g=="boolean",t,"internal-error"),Lt(typeof v=="boolean",t,"internal-error"),Ia(s,t.name),Ia(o,t.name),Ia(l,t.name),Ia(u,t.name),Ia(h,t.name),Ia(d,t.name);const E=new Xi({uid:m,auth:t,email:i,emailVerified:g,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:w,createdAt:h,lastLoginAt:d});return T&&Array.isArray(T)&&(E.providerData=T.map(R=>({...R}))),u&&(E._redirectEventId=u),E}static async _fromIdTokenResponse(t,e,r=!1){const i=new _h;i.updateFromServerResponse(e);const s=new Xi({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:r});return await I0(s),s}static async _fromGetAccountInfoResponse(t,e,r){const i=e.users[0];Lt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?eL(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,l=new _h;l.updateFromIdToken(r);const u=new Xi({uid:i.localId,auth:t,stsTokenManager:l,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new qw(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const mD=new Map;function Do(n){Ho(n instanceof Function,"Expected a class definition");let t=mD.get(n);return t?(Ho(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,mD.set(n,t),t)}class nL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}nL.type="NONE";const gD=nL;function n0(n,t,e){return`firebase:${n}:${t}:${e}`}class Th{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=n0(this.userKey,i.apiKey,s),this.fullPersistenceKey=n0("persistence",i.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await O0(this.auth,{idToken:t}).catch(()=>{});return e?Xi._fromGetAccountInfoResponse(this.auth,e,t):null}return Xi._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,r="authUser"){if(!e.length)return new Th(Do(gD),t,r);const i=(await Promise.all(e.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=i[0]||Do(gD);const o=n0(r,t.config.apiKey,t.name);let l=null;for(const h of e)try{const d=await h._get(o);if(d){let m;if(typeof d=="string"){const g=await O0(t,{idToken:d}).catch(()=>{});if(!g)break;m=await Xi._fromGetAccountInfoResponse(t,g,d)}else m=Xi._fromJSON(t,d);h!==s&&(l=m),s=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Th(s,t,r):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(e.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Th(s,t,r))}}function yD(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(oL(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(rL(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(lL(t))return"Blackberry";if(cL(t))return"Webos";if(iL(t))return"Safari";if((t.includes("chrome/")||sL(t))&&!t.includes("edge/"))return"Chrome";if(aL(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(e);if(r?.length===2)return r[1]}return"Other"}function rL(n=rr()){return/firefox\//i.test(n)}function iL(n=rr()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function sL(n=rr()){return/crios\//i.test(n)}function oL(n=rr()){return/iemobile/i.test(n)}function aL(n=rr()){return/android/i.test(n)}function lL(n=rr()){return/blackberry/i.test(n)}function cL(n=rr()){return/webos/i.test(n)}function UE(n=rr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Y$(n=rr()){return UE(n)&&!!window.navigator?.standalone}function K$(){return l9()&&document.documentMode===10}function uL(n=rr()){return UE(n)||aL(n)||cL(n)||lL(n)||/windows phone/i.test(n)||oL(n)}function hL(n,t=[]){let e;switch(n){case"Browser":e=yD(rr());break;case"Worker":e=`${yD(rr())}-${n}`;break;default:e=n}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${su}/${r}`}class X${constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=s=>new Promise((o,l)=>{try{const u=t(s);o(u)}catch(u){l(u)}});r.onAbort=e,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const r of this.queue)await r(t),r.onAbort&&e.push(r.onAbort)}catch(r){e.reverse();for(const i of e)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function Q$(n,t={}){return Al(n,"GET","/v2/passwordPolicy",Cl(n,t))}const J$=6;class Z${constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??J$,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(e.meetsMinPasswordLength=t.length>=r),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let r;for(let i=0;i<t.length;i++)r=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(t,e,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}class t8{constructor(t,e,r,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new vD(this),this.idTokenSubscription=new vD(this),this.beforeStateQueue=new X$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=QN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Do(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Th.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await O0(this,{idToken:t}),r=await Xi._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(Ir(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let r=e,i=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,l=await this.tryRedirectSignIn(t);(!s||s===o)&&l?.user&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await I0(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=O$()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Ir(this.app))return Promise.reject(Lo(this));const e=t?Le(t):null;return e&&Lt(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Lt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Ir(this.app)?Promise.reject(Lo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Ir(this.app)?Promise.reject(Lo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Do(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await Q$(this),e=new Z$(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new rm("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const r=this.onAuthStateChanged(()=>{r(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(r.tenantId=this.tenantId),await W$(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const r=await this.getOrInitRedirectPersistenceManager(e);return t===null?r.removeCurrentUser():r.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Do(t)||this._popupRedirectResolver;Lt(e,this,"argument-error"),this.redirectPersistenceManager=await Th.create(this,[Do(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,i){if(this._deleted)return()=>{};const s=typeof e=="function"?e:e.next.bind(e);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Lt(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof e=="function"){const u=t.addObserver(e,r,i);return()=>{o=!0,u()}}else{const u=t.addObserver(e);return()=>{o=!0,u()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=hL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){if(Ir(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&k$(`Error while retrieving App Check token: ${t.error}`),t?.token}}function kl(n){return Le(n)}class vD{constructor(t){this.auth=t,this.observer=null,this.addObserver=g9(e=>this.observer=e)}get next(){return Lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let hb={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function e8(n){hb=n}function fL(n){return hb.loadJS(n)}function n8(){return hb.recaptchaEnterpriseScript}function r8(){return hb.gapiScript}function i8(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class s8{constructor(){this.enterprise=new o8}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class o8{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const a8="recaptcha-enterprise",dL="NO_RECAPTCHA";class l8{constructor(t){this.type=a8,this.auth=kl(t)}async verify(t="verify",e=!1){async function r(s){if(!e){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{B$(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const h=new j$(u);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(u=>{l(u)})})}function i(s,o,l){const u=window.grecaptcha;dD(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:t}).then(h=>{o(h)}).catch(()=>{o(dL)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new s8().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(l=>{if(!e&&dD(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=n8();u.length!==0&&(u+=l),fL(u).then(()=>{i(l,s,o)}).catch(h=>{o(h)})}}).catch(l=>{o(l)})})}}async function bD(n,t,e,r=!1,i=!1){const s=new l8(n);let o;if(i)o=dL;else try{o=await s.verify(e)}catch{o=await s.verify(e,!0)}const l={...t};if(e==="mfaSmsEnrollment"||e==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,h=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Gw(n,t,e,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await bD(n,t,e,e==="getOobCode");return r(n,s)}else return r(n,t).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${e} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await bD(n,t,e,e==="getOobCode");return r(n,o)}else return Promise.reject(s)})}function c8(n,t){const e=ub(n,"auth");if(e.isInitialized()){const i=e.getImmediate(),s=e.getOptions();if(Hc(s,t??{}))return i;Ai(i,"already-initialized")}return e.initialize({options:t})}function u8(n,t){const e=t?.persistence||[],r=(Array.isArray(e)?e:[e]).map(Do);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(r,t?.popupRedirectResolver)}function h8(n,t,e){const r=kl(n);Lt(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!1,s=pL(t),{host:o,port:l}=f8(t),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},d=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Lt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Lt(Hc(h,r.config.emulator)&&Hc(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,El(o)?(OE(`${s}//${o}${u}`),IE("Auth",!0)):d8()}function pL(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function f8(n){const t=pL(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:_D(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:_D(o)}}}function _D(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function d8(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class zE{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Mo("not implemented")}_getIdTokenResponse(t){return Mo("not implemented")}_linkToIdToken(t,e){return Mo("not implemented")}_getReauthenticationResolver(t){return Mo("not implemented")}}async function p8(n,t){return Al(n,"POST","/v1/accounts:signUp",t)}async function m8(n,t){return om(n,"POST","/v1/accounts:signInWithPassword",Cl(n,t))}async function g8(n,t){return om(n,"POST","/v1/accounts:signInWithEmailLink",Cl(n,t))}async function y8(n,t){return om(n,"POST","/v1/accounts:signInWithEmailLink",Cl(n,t))}class Sp extends zE{constructor(t,e,r,i=null){super("password",r),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Sp(t,e,"password")}static _fromEmailAndCode(t,e,r=null){return new Sp(t,e,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t;if(e?.email&&e?.password){if(e.signInMethod==="password")return this._fromEmailAndPassword(e.email,e.password);if(e.signInMethod==="emailLink")return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const e={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Gw(t,e,"signInWithPassword",m8);case"emailLink":return g8(t,{email:this._email,oobCode:this._password});default:Ai(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":const r={idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Gw(t,r,"signUpPassword",p8);case"emailLink":return y8(t,{idToken:e,email:this._email,oobCode:this._password});default:Ai(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function Sh(n,t){return om(n,"POST","/v1/accounts:signInWithIdp",Cl(n,t))}const v8="http://localhost";class qc extends zE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new qc(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Ai("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:r,signInMethod:i,...s}=e;if(!r||!i)return null;const o=new qc(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(t){const e=this.buildRequest();return Sh(t,e)}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,Sh(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Sh(t,e)}buildRequest(){const t={requestUri:v8,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=im(e)}return t}}function b8(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _8(n){const t=Id(Pd(n)).link,e=t?Id(Pd(t)).deep_link_id:null,r=Id(Pd(n)).deep_link_id;return(r?Id(Pd(r)).link:null)||r||e||t||n}class HE{constructor(t){const e=Id(Pd(t)),r=e.apiKey??null,i=e.oobCode??null,s=b8(e.mode??null);Lt(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=e.continueUrl??null,this.languageCode=e.lang??null,this.tenantId=e.tenantId??null}static parseLink(t){const e=_8(t);try{return new HE(e)}catch{return null}}}class Kh{constructor(){this.providerId=Kh.PROVIDER_ID}static credential(t,e){return Sp._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const r=HE.parseLink(e);return Lt(r,"argument-error"),Sp._fromEmailAndCode(t,r.code,r.tenantId)}}Kh.PROVIDER_ID="password";Kh.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Kh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class $E{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class am extends $E{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class Ha extends am{constructor(){super("facebook.com")}static credential(t){return qc._fromParams({providerId:Ha.PROVIDER_ID,signInMethod:Ha.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ha.credentialFromTaggedObject(t)}static credentialFromError(t){return Ha.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ha.credential(t.oauthAccessToken)}catch{return null}}}Ha.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ha.PROVIDER_ID="facebook.com";class Ro extends am{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return qc._fromParams({providerId:Ro.PROVIDER_ID,signInMethod:Ro.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Ro.credentialFromTaggedObject(t)}static credentialFromError(t){return Ro.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:r}=t;if(!e&&!r)return null;try{return Ro.credential(e,r)}catch{return null}}}Ro.GOOGLE_SIGN_IN_METHOD="google.com";Ro.PROVIDER_ID="google.com";class $a extends am{constructor(){super("github.com")}static credential(t){return qc._fromParams({providerId:$a.PROVIDER_ID,signInMethod:$a.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return $a.credentialFromTaggedObject(t)}static credentialFromError(t){return $a.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return $a.credential(t.oauthAccessToken)}catch{return null}}}$a.GITHUB_SIGN_IN_METHOD="github.com";$a.PROVIDER_ID="github.com";class qa extends am{constructor(){super("twitter.com")}static credential(t,e){return qc._fromParams({providerId:qa.PROVIDER_ID,signInMethod:qa.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return qa.credentialFromTaggedObject(t)}static credentialFromError(t){return qa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:r}=t;if(!e||!r)return null;try{return qa.credential(e,r)}catch{return null}}}qa.TWITTER_SIGN_IN_METHOD="twitter.com";qa.PROVIDER_ID="twitter.com";async function T8(n,t){return om(n,"POST","/v1/accounts:signUp",Cl(n,t))}class Gc{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,r,i=!1){const s=await Xi._fromIdTokenResponse(t,r,i),o=TD(r);return new Gc({user:s,providerId:o,_tokenResponse:r,operationType:e})}static async _forOperation(t,e,r){await t._updateTokensIfNecessary(r,!0);const i=TD(r);return new Gc({user:t,providerId:i,_tokenResponse:r,operationType:e})}}function TD(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class P0 extends Zs{constructor(t,e,r,i){super(e.code,e.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,P0.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,i){return new P0(t,e,r,i)}}function mL(n,t,e,r){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?P0._fromErrorAndOperation(n,s,t,r):s})}async function S8(n,t,e=!1){const r=await Tp(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return Gc._forOperation(n,"link",r)}async function w8(n,t,e=!1){const{auth:r}=n;if(Ir(r.app))return Promise.reject(Lo(r));const i="reauthenticate";try{const s=await Tp(n,mL(r,i,t,n),e);Lt(s.idToken,r,"internal-error");const o=FE(s.idToken);Lt(o,r,"internal-error");const{sub:l}=o;return Lt(n.uid===l,r,"user-mismatch"),Gc._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Ai(r,"user-mismatch"),s}}async function gL(n,t,e=!1){if(Ir(n.app))return Promise.reject(Lo(n));const r="signIn",i=await mL(n,r,t),s=await Gc._fromIdTokenResponse(n,r,i);return e||await n._updateCurrentUser(s.user),s}async function x8(n,t){return gL(kl(n),t)}async function yL(n){const t=kl(n);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function E8(n,t,e){if(Ir(n.app))return Promise.reject(Lo(n));const r=kl(n),o=await Gw(r,{returnSecureToken:!0,email:t,password:e,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",T8).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&yL(n),u}),l=await Gc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function C8(n,t,e){return Ir(n.app)?Promise.reject(Lo(n)):x8(Le(n),Kh.credential(t,e)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&yL(n),r})}function A8(n,t,e,r){return Le(n).onIdTokenChanged(t,e,r)}function k8(n,t,e){return Le(n).beforeAuthStateChanged(t,e)}function R8(n,t,e,r){return Le(n).onAuthStateChanged(t,e,r)}function M8(n){return Le(n).signOut()}const N0="__sak";class vL{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(N0,"1"),this.storage.removeItem(N0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const D8=1e3,O8=10;class bL extends vL{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=uL(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const r=this.storage.getItem(e),i=this.localCache[e];r!==i&&t(e,i,r)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=t.key;e?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!e&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);K$()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,O8):i()}notifyListeners(t,e){this.localCache[t]=e;const r=this.listeners[t];if(r)for(const i of Array.from(r))i(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:r}),!0)})},D8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}bL.type="LOCAL";const I8=bL;class _L extends vL{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}_L.type="SESSION";const TL=_L;function P8(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}class fb{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(i=>i.isListeningto(t));if(e)return e;const r=new fb(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:r,eventType:i,data:s}=e.data,o=this.handlersMap[i];if(!o?.size)return;e.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async h=>h(e.origin,s)),u=await P8(l);e.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}fb.receivers=[];function qE(n="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(Math.random()*10);return n+e}class N8{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=qE("",20);i.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){const g=m;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(d),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:h,data:e},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Us(){return window}function L8(n){Us().location.href=n}function SL(){return typeof Us().WorkerGlobalScope<"u"&&typeof Us().importScripts=="function"}async function V8(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function j8(){return navigator?.serviceWorker?.controller||null}function B8(){return SL()?self:null}const wL="firebaseLocalStorageDb",F8=1,L0="firebaseLocalStorage",xL="fbase_key";class lm{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function db(n,t){return n.transaction([L0],t?"readwrite":"readonly").objectStore(L0)}function U8(){const n=indexedDB.deleteDatabase(wL);return new lm(n).toPromise()}function Ww(){const n=indexedDB.open(wL,F8);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(L0,{keyPath:xL})}catch(i){e(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(L0)?t(r):(r.close(),await U8(),t(await Ww()))})})}async function SD(n,t,e){const r=db(n,!0).put({[xL]:t,value:e});return new lm(r).toPromise()}async function z8(n,t){const e=db(n,!1).get(t),r=await new lm(e).toPromise();return r===void 0?null:r.value}function wD(n,t){const e=db(n,!0).delete(t);return new lm(e).toPromise()}const H8=800,$8=3;class EL{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ww(),this.db)}async _withRetries(t){let e=0;for(;;)try{const r=await this._openDb();return await t(r)}catch(r){if(e++>$8)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return SL()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=fb._getInstance(B8()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await V8(),!this.activeServiceWorker)return;this.sender=new N8(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||j8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Ww();return await SD(t,N0,"1"),await wD(t,N0),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(r=>SD(r,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(r=>z8(r,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>wD(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const s=db(i,!1).getAll();return new lm(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],r=new Set;if(t.length!==0)for(const{fbase_key:i,value:s}of t)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),e.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),e.push(i));return e}notifyListeners(t,e){this.localCache[t]=e;const r=this.listeners[t];if(r)for(const i of Array.from(r))i(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),H8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}EL.type="LOCAL";const q8=EL;new sm(3e4,6e4);function CL(n,t){return t?Do(t):(Lt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class GE extends zE{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Sh(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Sh(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Sh(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function G8(n){return gL(n.auth,new GE(n),n.bypassAuthState)}function W8(n){const{auth:t,user:e}=n;return Lt(e,t,"internal-error"),w8(e,new GE(n),n.bypassAuthState)}async function Y8(n){const{auth:t,user:e}=n;return Lt(e,t,"internal-error"),S8(e,new GE(n),n.bypassAuthState)}class AL{constructor(t,e,r,i,s=!1){this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=t;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:e,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return G8;case"linkViaPopup":case"linkViaRedirect":return Y8;case"reauthViaPopup":case"reauthViaRedirect":return W8;default:Ai(this.auth,"internal-error")}}resolve(t){Ho(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Ho(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const K8=new sm(2e3,1e4);async function X8(n,t,e){if(Ir(n.app))return Promise.reject(ts(n,"operation-not-supported-in-this-environment"));const r=kl(n);R$(n,t,$E);const i=CL(r,e);return new wc(r,"signInViaPopup",t,i).executeNotNull()}class wc extends AL{constructor(t,e,r,i,s){super(t,e,i,s),this.provider=r,this.authWindow=null,this.pollId=null,wc.currentPopupAction&&wc.currentPopupAction.cancel(),wc.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Lt(t,this.auth,"internal-error"),t}async onExecution(){Ho(this.filter.length===1,"Popup operations only handle one event");const t=qE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(ts(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ts(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,wc.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ts(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,K8.get())};t()}}wc.currentPopupAction=null;const Q8="pendingRedirect",r0=new Map;class J8 extends AL{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}async execute(){let t=r0.get(this.auth._key());if(!t){try{const r=await Z8(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(r)}catch(e){t=()=>Promise.reject(e)}r0.set(this.auth._key(),t)}return this.bypassAuthState||r0.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Z8(n,t){const e=nq(t),r=eq(n);if(!await r._isAvailable())return!1;const i=await r._get(e)==="true";return await r._remove(e),i}function tq(n,t){r0.set(n._key(),t)}function eq(n){return Do(n._redirectPersistence)}function nq(n){return n0(Q8,n.config.apiKey,n.name)}async function rq(n,t,e=!1){if(Ir(n.app))return Promise.reject(Lo(n));const r=kl(n),i=CL(r,t),o=await new J8(r,i,e).execute();return o&&!e&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}const iq=600*1e3;class sq{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!oq(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!kL(t)){const r=t.error.code?.split("auth/")[1]||"internal-error";e.onError(ts(this.auth,r))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=iq&&this.cachedEventUids.clear(),this.cachedEventUids.has(xD(t))}saveEventToCache(t){this.cachedEventUids.add(xD(t)),this.lastProcessedEventTime=Date.now()}}function xD(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function kL({type:n,error:t}){return n==="unknown"&&t?.code==="auth/no-auth-event"}function oq(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return kL(n);default:return!1}}async function aq(n,t={}){return Al(n,"GET","/v1/projects",t)}const lq=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,cq=/^https?/;async function uq(n){if(n.config.emulator)return;const{authorizedDomains:t}=await aq(n);for(const e of t)try{if(hq(e))return}catch{}Ai(n,"unauthorized-domain")}function hq(n){const t=$w(),{protocol:e,hostname:r}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&o.hostname===r}if(!cq.test(e))return!1;if(lq.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const fq=new sm(3e4,6e4);function ED(){const n=Us().___jsl;if(n?.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function dq(n){return new Promise((t,e)=>{function r(){ED(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{ED(),e(ts(n,"network-request-failed"))},timeout:fq.get()})}if(Us().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(Us().gapi?.load)r();else{const i=i8("iframefcb");return Us()[i]=()=>{gapi.load?r():e(ts(n,"network-request-failed"))},fL(`${r8()}?onload=${i}`).catch(s=>e(s))}}).catch(t=>{throw i0=null,t})}let i0=null;function pq(n){return i0=i0||dq(n),i0}const mq=new sm(5e3,15e3),gq="__/auth/iframe",yq="emulator/auth/iframe",vq={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _q(n){const t=n.config;Lt(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?BE(t,yq):`https://${n.config.authDomain}/${gq}`,r={apiKey:t.apiKey,appName:n.name,v:su},i=bq.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${e}?${im(r).slice(1)}`}async function Tq(n){const t=await pq(n),e=Us().gapi;return Lt(e,n,"internal-error"),t.open({where:document.body,url:_q(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vq,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=ts(n,"network-request-failed"),l=Us().setTimeout(()=>{s(o)},mq.get());function u(){Us().clearTimeout(l),i(r)}r.ping(u).then(u,()=>{s(o)})}))}const Sq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wq=500,xq=600,Eq="_blank",Cq="http://localhost";class CD{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Aq(n,t,e,r=wq,i=xq){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u={...Sq,width:r.toString(),height:i.toString(),top:s,left:o},h=rr().toLowerCase();e&&(l=sL(h)?Eq:e),rL(h)&&(t=t||Cq,u.scrollbars="yes");const d=Object.entries(u).reduce((g,[v,T])=>`${g}${v}=${T},`,"");if(Y$(h)&&l!=="_self")return kq(t||"",l),new CD(null);const m=window.open(t||"",l,d);Lt(m,n,"popup-blocked");try{m.focus()}catch{}return new CD(m)}function kq(n,t){const e=document.createElement("a");e.href=n,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}const Rq="__/auth/handler",Mq="emulator/auth/handler",Dq=encodeURIComponent("fac");async function AD(n,t,e,r,i,s){Lt(n.config.authDomain,n,"auth-domain-config-required"),Lt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:r,v:su,eventId:i};if(t instanceof $E){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",m9(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[d,m]of Object.entries({}))o[d]=m}if(t instanceof am){const d=t.getScopes().filter(m=>m!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const u=await n._getAppCheckToken(),h=u?`#${Dq}=${encodeURIComponent(u)}`:"";return`${Oq(n)}?${im(l).slice(1)}${h}`}function Oq({config:n}){return n.emulator?BE(n,Mq):`https://${n.authDomain}/${Rq}`}const wS="webStorageSupport";class Iq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=TL,this._completeRedirectFn=rq,this._overrideRedirectResult=tq}async _openPopup(t,e,r,i){Ho(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const s=await AD(t,e,r,$w(),i);return Aq(t,s,qE())}async _openRedirect(t,e,r,i){await this._originValidation(t);const s=await AD(t,e,r,$w(),i);return L8(s),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:i,promise:s}=this.eventManagers[e];return i?Promise.resolve(i):(Ho(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}async initAndGetManager(t){const e=await Tq(t),r=new sq(t);return e.register("authEvent",i=>(Lt(i?.authEvent,t,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=e,r}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(wS,{type:wS},i=>{const s=i?.[0]?.[wS];s!==void 0&&e(!!s),Ai(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=uq(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return uL()||iL()||UE()}}const Pq=Iq;var kD="@firebase/auth",RD="1.12.0";class Nq{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{t(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Lq(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Vq(n){$c(new ul("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Lt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hL(n)},h=new t8(r,i,s,u);return u8(h,e),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),$c(new ul("auth-internal",t=>{const e=kl(t.getProvider("auth").getImmediate());return(r=>new Nq(r))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fs(kD,RD,Lq(n)),Fs(kD,RD,"esm2020")}const jq=300,Bq=HN("authIdTokenMaxAge")||jq;let MD=null;const Fq=n=>async t=>{const e=t&&await t.getIdTokenResult(),r=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(r&&r>Bq)return;const i=e?.token;MD!==i&&(MD=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Uq(n=LE()){const t=ub(n,"auth");if(t.isInitialized())return t.getImmediate();const e=c8(n,{popupRedirectResolver:Pq,persistence:[q8,I8,TL]}),r=HN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=Fq(s.toString());k8(e,o,()=>o(e.currentUser)),A8(e,l=>o(l))}}const i=FN("auth");return i&&h8(e,`http://${i}`),e}function zq(){return document.getElementsByTagName("head")?.[0]??document}e8({loadJS(n){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=t,r.onerror=i=>{const s=ts("internal-error");s.customData=i,e(s)},r.type="text/javascript",r.charset="UTF-8",zq().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Vq("Browser");var DD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var rl,RL;(function(){var n;function t(M,k){function O(){}O.prototype=k.prototype,M.F=k.prototype,M.prototype=new O,M.prototype.constructor=M,M.D=function(B,F,H){for(var V=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)V[yt-2]=arguments[yt];return k.prototype[F].apply(B,V)}}function e(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(r,e),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(M,k,O){O||(O=0);const B=Array(16);if(typeof k=="string")for(var F=0;F<16;++F)B[F]=k.charCodeAt(O++)|k.charCodeAt(O++)<<8|k.charCodeAt(O++)<<16|k.charCodeAt(O++)<<24;else for(F=0;F<16;++F)B[F]=k[O++]|k[O++]<<8|k[O++]<<16|k[O++]<<24;k=M.g[0],O=M.g[1],F=M.g[2];let H=M.g[3],V;V=k+(H^O&(F^H))+B[0]+3614090360&4294967295,k=O+(V<<7&4294967295|V>>>25),V=H+(F^k&(O^F))+B[1]+3905402710&4294967295,H=k+(V<<12&4294967295|V>>>20),V=F+(O^H&(k^O))+B[2]+606105819&4294967295,F=H+(V<<17&4294967295|V>>>15),V=O+(k^F&(H^k))+B[3]+3250441966&4294967295,O=F+(V<<22&4294967295|V>>>10),V=k+(H^O&(F^H))+B[4]+4118548399&4294967295,k=O+(V<<7&4294967295|V>>>25),V=H+(F^k&(O^F))+B[5]+1200080426&4294967295,H=k+(V<<12&4294967295|V>>>20),V=F+(O^H&(k^O))+B[6]+2821735955&4294967295,F=H+(V<<17&4294967295|V>>>15),V=O+(k^F&(H^k))+B[7]+4249261313&4294967295,O=F+(V<<22&4294967295|V>>>10),V=k+(H^O&(F^H))+B[8]+1770035416&4294967295,k=O+(V<<7&4294967295|V>>>25),V=H+(F^k&(O^F))+B[9]+2336552879&4294967295,H=k+(V<<12&4294967295|V>>>20),V=F+(O^H&(k^O))+B[10]+4294925233&4294967295,F=H+(V<<17&4294967295|V>>>15),V=O+(k^F&(H^k))+B[11]+2304563134&4294967295,O=F+(V<<22&4294967295|V>>>10),V=k+(H^O&(F^H))+B[12]+1804603682&4294967295,k=O+(V<<7&4294967295|V>>>25),V=H+(F^k&(O^F))+B[13]+4254626195&4294967295,H=k+(V<<12&4294967295|V>>>20),V=F+(O^H&(k^O))+B[14]+2792965006&4294967295,F=H+(V<<17&4294967295|V>>>15),V=O+(k^F&(H^k))+B[15]+1236535329&4294967295,O=F+(V<<22&4294967295|V>>>10),V=k+(F^H&(O^F))+B[1]+4129170786&4294967295,k=O+(V<<5&4294967295|V>>>27),V=H+(O^F&(k^O))+B[6]+3225465664&4294967295,H=k+(V<<9&4294967295|V>>>23),V=F+(k^O&(H^k))+B[11]+643717713&4294967295,F=H+(V<<14&4294967295|V>>>18),V=O+(H^k&(F^H))+B[0]+3921069994&4294967295,O=F+(V<<20&4294967295|V>>>12),V=k+(F^H&(O^F))+B[5]+3593408605&4294967295,k=O+(V<<5&4294967295|V>>>27),V=H+(O^F&(k^O))+B[10]+38016083&4294967295,H=k+(V<<9&4294967295|V>>>23),V=F+(k^O&(H^k))+B[15]+3634488961&4294967295,F=H+(V<<14&4294967295|V>>>18),V=O+(H^k&(F^H))+B[4]+3889429448&4294967295,O=F+(V<<20&4294967295|V>>>12),V=k+(F^H&(O^F))+B[9]+568446438&4294967295,k=O+(V<<5&4294967295|V>>>27),V=H+(O^F&(k^O))+B[14]+3275163606&4294967295,H=k+(V<<9&4294967295|V>>>23),V=F+(k^O&(H^k))+B[3]+4107603335&4294967295,F=H+(V<<14&4294967295|V>>>18),V=O+(H^k&(F^H))+B[8]+1163531501&4294967295,O=F+(V<<20&4294967295|V>>>12),V=k+(F^H&(O^F))+B[13]+2850285829&4294967295,k=O+(V<<5&4294967295|V>>>27),V=H+(O^F&(k^O))+B[2]+4243563512&4294967295,H=k+(V<<9&4294967295|V>>>23),V=F+(k^O&(H^k))+B[7]+1735328473&4294967295,F=H+(V<<14&4294967295|V>>>18),V=O+(H^k&(F^H))+B[12]+2368359562&4294967295,O=F+(V<<20&4294967295|V>>>12),V=k+(O^F^H)+B[5]+4294588738&4294967295,k=O+(V<<4&4294967295|V>>>28),V=H+(k^O^F)+B[8]+2272392833&4294967295,H=k+(V<<11&4294967295|V>>>21),V=F+(H^k^O)+B[11]+1839030562&4294967295,F=H+(V<<16&4294967295|V>>>16),V=O+(F^H^k)+B[14]+4259657740&4294967295,O=F+(V<<23&4294967295|V>>>9),V=k+(O^F^H)+B[1]+2763975236&4294967295,k=O+(V<<4&4294967295|V>>>28),V=H+(k^O^F)+B[4]+1272893353&4294967295,H=k+(V<<11&4294967295|V>>>21),V=F+(H^k^O)+B[7]+4139469664&4294967295,F=H+(V<<16&4294967295|V>>>16),V=O+(F^H^k)+B[10]+3200236656&4294967295,O=F+(V<<23&4294967295|V>>>9),V=k+(O^F^H)+B[13]+681279174&4294967295,k=O+(V<<4&4294967295|V>>>28),V=H+(k^O^F)+B[0]+3936430074&4294967295,H=k+(V<<11&4294967295|V>>>21),V=F+(H^k^O)+B[3]+3572445317&4294967295,F=H+(V<<16&4294967295|V>>>16),V=O+(F^H^k)+B[6]+76029189&4294967295,O=F+(V<<23&4294967295|V>>>9),V=k+(O^F^H)+B[9]+3654602809&4294967295,k=O+(V<<4&4294967295|V>>>28),V=H+(k^O^F)+B[12]+3873151461&4294967295,H=k+(V<<11&4294967295|V>>>21),V=F+(H^k^O)+B[15]+530742520&4294967295,F=H+(V<<16&4294967295|V>>>16),V=O+(F^H^k)+B[2]+3299628645&4294967295,O=F+(V<<23&4294967295|V>>>9),V=k+(F^(O|~H))+B[0]+4096336452&4294967295,k=O+(V<<6&4294967295|V>>>26),V=H+(O^(k|~F))+B[7]+1126891415&4294967295,H=k+(V<<10&4294967295|V>>>22),V=F+(k^(H|~O))+B[14]+2878612391&4294967295,F=H+(V<<15&4294967295|V>>>17),V=O+(H^(F|~k))+B[5]+4237533241&4294967295,O=F+(V<<21&4294967295|V>>>11),V=k+(F^(O|~H))+B[12]+1700485571&4294967295,k=O+(V<<6&4294967295|V>>>26),V=H+(O^(k|~F))+B[3]+2399980690&4294967295,H=k+(V<<10&4294967295|V>>>22),V=F+(k^(H|~O))+B[10]+4293915773&4294967295,F=H+(V<<15&4294967295|V>>>17),V=O+(H^(F|~k))+B[1]+2240044497&4294967295,O=F+(V<<21&4294967295|V>>>11),V=k+(F^(O|~H))+B[8]+1873313359&4294967295,k=O+(V<<6&4294967295|V>>>26),V=H+(O^(k|~F))+B[15]+4264355552&4294967295,H=k+(V<<10&4294967295|V>>>22),V=F+(k^(H|~O))+B[6]+2734768916&4294967295,F=H+(V<<15&4294967295|V>>>17),V=O+(H^(F|~k))+B[13]+1309151649&4294967295,O=F+(V<<21&4294967295|V>>>11),V=k+(F^(O|~H))+B[4]+4149444226&4294967295,k=O+(V<<6&4294967295|V>>>26),V=H+(O^(k|~F))+B[11]+3174756917&4294967295,H=k+(V<<10&4294967295|V>>>22),V=F+(k^(H|~O))+B[2]+718787259&4294967295,F=H+(V<<15&4294967295|V>>>17),V=O+(H^(F|~k))+B[9]+3951481745&4294967295,M.g[0]=M.g[0]+k&4294967295,M.g[1]=M.g[1]+(F+(V<<21&4294967295|V>>>11))&4294967295,M.g[2]=M.g[2]+F&4294967295,M.g[3]=M.g[3]+H&4294967295}r.prototype.v=function(M,k){k===void 0&&(k=M.length);const O=k-this.blockSize,B=this.C;let F=this.h,H=0;for(;H<k;){if(F==0)for(;H<=O;)i(this,M,H),H+=this.blockSize;if(typeof M=="string"){for(;H<k;)if(B[F++]=M.charCodeAt(H++),F==this.blockSize){i(this,B),F=0;break}}else for(;H<k;)if(B[F++]=M[H++],F==this.blockSize){i(this,B),F=0;break}}this.h=F,this.o+=k},r.prototype.A=function(){var M=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);M[0]=128;for(var k=1;k<M.length-8;++k)M[k]=0;k=this.o*8;for(var O=M.length-8;O<M.length;++O)M[O]=k&255,k/=256;for(this.v(M),M=Array(16),k=0,O=0;O<4;++O)for(let B=0;B<32;B+=8)M[k++]=this.g[O]>>>B&255;return M};function s(M,k){var O=l;return Object.prototype.hasOwnProperty.call(O,M)?O[M]:O[M]=k(M)}function o(M,k){this.h=k;const O=[];let B=!0;for(let F=M.length-1;F>=0;F--){const H=M[F]|0;B&&H==k||(O[F]=H,B=!1)}this.g=O}var l={};function u(M){return-128<=M&&M<128?s(M,function(k){return new o([k|0],k<0?-1:0)}):new o([M|0],M<0?-1:0)}function h(M){if(isNaN(M)||!isFinite(M))return m;if(M<0)return w(h(-M));const k=[];let O=1;for(let B=0;M>=O;B++)k[B]=M/O|0,O*=4294967296;return new o(k,0)}function d(M,k){if(M.length==0)throw Error("number format error: empty string");if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(M.charAt(0)=="-")return w(d(M.substring(1),k));if(M.indexOf("-")>=0)throw Error('number format error: interior "-" character');const O=h(Math.pow(k,8));let B=m;for(let H=0;H<M.length;H+=8){var F=Math.min(8,M.length-H);const V=parseInt(M.substring(H,H+F),k);F<8?(F=h(Math.pow(k,F)),B=B.j(F).add(h(V))):(B=B.j(O),B=B.add(h(V)))}return B}var m=u(0),g=u(1),v=u(16777216);n=o.prototype,n.m=function(){if(S(this))return-w(this).m();let M=0,k=1;for(let O=0;O<this.g.length;O++){const B=this.i(O);M+=(B>=0?B:4294967296+B)*k,k*=4294967296}return M},n.toString=function(M){if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(T(this))return"0";if(S(this))return"-"+w(this).toString(M);const k=h(Math.pow(M,6));var O=this;let B="";for(;;){const F=j(O,k).g;O=E(O,F.j(k));let H=((O.g.length>0?O.g[0]:O.h)>>>0).toString(M);if(O=F,T(O))return H+B;for(;H.length<6;)H="0"+H;B=H+B}},n.i=function(M){return M<0?0:M<this.g.length?this.g[M]:this.h};function T(M){if(M.h!=0)return!1;for(let k=0;k<M.g.length;k++)if(M.g[k]!=0)return!1;return!0}function S(M){return M.h==-1}n.l=function(M){return M=E(this,M),S(M)?-1:T(M)?0:1};function w(M){const k=M.g.length,O=[];for(let B=0;B<k;B++)O[B]=~M.g[B];return new o(O,~M.h).add(g)}n.abs=function(){return S(this)?w(this):this},n.add=function(M){const k=Math.max(this.g.length,M.g.length),O=[];let B=0;for(let F=0;F<=k;F++){let H=B+(this.i(F)&65535)+(M.i(F)&65535),V=(H>>>16)+(this.i(F)>>>16)+(M.i(F)>>>16);B=V>>>16,H&=65535,V&=65535,O[F]=V<<16|H}return new o(O,O[O.length-1]&-2147483648?-1:0)};function E(M,k){return M.add(w(k))}n.j=function(M){if(T(this)||T(M))return m;if(S(this))return S(M)?w(this).j(w(M)):w(w(this).j(M));if(S(M))return w(this.j(w(M)));if(this.l(v)<0&&M.l(v)<0)return h(this.m()*M.m());const k=this.g.length+M.g.length,O=[];for(var B=0;B<2*k;B++)O[B]=0;for(B=0;B<this.g.length;B++)for(let F=0;F<M.g.length;F++){const H=this.i(B)>>>16,V=this.i(B)&65535,yt=M.i(F)>>>16,xt=M.i(F)&65535;O[2*B+2*F]+=V*xt,R(O,2*B+2*F),O[2*B+2*F+1]+=H*xt,R(O,2*B+2*F+1),O[2*B+2*F+1]+=V*yt,R(O,2*B+2*F+1),O[2*B+2*F+2]+=H*yt,R(O,2*B+2*F+2)}for(M=0;M<k;M++)O[M]=O[2*M+1]<<16|O[2*M];for(M=k;M<2*k;M++)O[M]=0;return new o(O,0)};function R(M,k){for(;(M[k]&65535)!=M[k];)M[k+1]+=M[k]>>>16,M[k]&=65535,k++}function P(M,k){this.g=M,this.h=k}function j(M,k){if(T(k))throw Error("division by zero");if(T(M))return new P(m,m);if(S(M))return k=j(w(M),k),new P(w(k.g),w(k.h));if(S(k))return k=j(M,w(k)),new P(w(k.g),k.h);if(M.g.length>30){if(S(M)||S(k))throw Error("slowDivide_ only works with positive integers.");for(var O=g,B=k;B.l(M)<=0;)O=N(O),B=N(B);var F=W(O,1),H=W(B,1);for(B=W(B,2),O=W(O,2);!T(B);){var V=H.add(B);V.l(M)<=0&&(F=F.add(O),H=V),B=W(B,1),O=W(O,1)}return k=E(M,F.j(k)),new P(F,k)}for(F=m;M.l(k)>=0;){for(O=Math.max(1,Math.floor(M.m()/k.m())),B=Math.ceil(Math.log(O)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),H=h(O),V=H.j(k);S(V)||V.l(M)>0;)O-=B,H=h(O),V=H.j(k);T(H)&&(H=g),F=F.add(H),M=E(M,V)}return new P(F,M)}n.B=function(M){return j(this,M).h},n.and=function(M){const k=Math.max(this.g.length,M.g.length),O=[];for(let B=0;B<k;B++)O[B]=this.i(B)&M.i(B);return new o(O,this.h&M.h)},n.or=function(M){const k=Math.max(this.g.length,M.g.length),O=[];for(let B=0;B<k;B++)O[B]=this.i(B)|M.i(B);return new o(O,this.h|M.h)},n.xor=function(M){const k=Math.max(this.g.length,M.g.length),O=[];for(let B=0;B<k;B++)O[B]=this.i(B)^M.i(B);return new o(O,this.h^M.h)};function N(M){const k=M.g.length+1,O=[];for(let B=0;B<k;B++)O[B]=M.i(B)<<1|M.i(B-1)>>>31;return new o(O,M.h)}function W(M,k){const O=k>>5;k%=32;const B=M.g.length-O,F=[];for(let H=0;H<B;H++)F[H]=k>0?M.i(H+O)>>>k|M.i(H+O+1)<<32-k:M.i(H+O);return new o(F,M.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,RL=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,rl=o}).apply(typeof DD<"u"?DD:typeof self<"u"?self:typeof window<"u"?window:{});var iy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ML,Nd,DL,s0,Yw,OL,IL,PL;(function(){var n,t=Object.defineProperty;function e(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof iy=="object"&&iy];for(var x=0;x<y.length;++x){var A=y[x];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var r=e(this);function i(y,x){if(x)t:{var A=r;y=y.split(".");for(var I=0;I<y.length-1;I++){var K=y[I];if(!(K in A))break t;A=A[K]}y=y[y.length-1],I=A[y],x=x(I),x!=I&&x!=null&&t(A,y,{configurable:!0,writable:!0,value:x})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(x){var A=[],I;for(I in x)Object.prototype.hasOwnProperty.call(x,I)&&A.push([I,x[I]]);return A}});var s=s||{},o=this||self;function l(y){var x=typeof y;return x=="object"&&y!=null||x=="function"}function u(y,x,A){return y.call.apply(y.bind,arguments)}function h(y,x,A){return h=u,h.apply(null,arguments)}function d(y,x){var A=Array.prototype.slice.call(arguments,1);return function(){var I=A.slice();return I.push.apply(I,arguments),y.apply(this,I)}}function m(y,x){function A(){}A.prototype=x.prototype,y.Z=x.prototype,y.prototype=new A,y.prototype.constructor=y,y.Ob=function(I,K,et){for(var pt=Array(arguments.length-2),zt=2;zt<arguments.length;zt++)pt[zt-2]=arguments[zt];return x.prototype[K].apply(I,pt)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function v(y){const x=y.length;if(x>0){const A=Array(x);for(let I=0;I<x;I++)A[I]=y[I];return A}return[]}function T(y,x){for(let I=1;I<arguments.length;I++){const K=arguments[I];var A=typeof K;if(A=A!="object"?A:K?Array.isArray(K)?"array":A:"null",A=="array"||A=="object"&&typeof K.length=="number"){A=y.length||0;const et=K.length||0;y.length=A+et;for(let pt=0;pt<et;pt++)y[A+pt]=K[pt]}else y.push(K)}}class S{constructor(x,A){this.i=x,this.j=A,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function w(y){o.setTimeout(()=>{throw y},0)}function E(){var y=M;let x=null;return y.g&&(x=y.g,y.g=y.g.next,y.g||(y.h=null),x.next=null),x}class R{constructor(){this.h=this.g=null}add(x,A){const I=P.get();I.set(x,A),this.h?this.h.next=I:this.g=I,this.h=I}}var P=new S(()=>new j,y=>y.reset());class j{constructor(){this.next=this.g=this.h=null}set(x,A){this.h=x,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let N,W=!1,M=new R,k=()=>{const y=Promise.resolve(void 0);N=()=>{y.then(O)}};function O(){for(var y;y=E();){try{y.h.call(y.g)}catch(A){w(A)}var x=P;x.j(y),x.h<100&&(x.h++,y.next=x.g,x.g=y)}W=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(y,x){this.type=y,this.g=this.target=x,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var H=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var y=!1,x=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const A=()=>{};o.addEventListener("test",A,x),o.removeEventListener("test",A,x)}catch{}return y})();function V(y){return/^[\s\xa0]*$/.test(y)}function yt(y,x){F.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,x)}m(yt,F),yt.prototype.init=function(y,x){const A=this.type=y.type,I=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=x,x=y.relatedTarget,x||(A=="mouseover"?x=y.fromElement:A=="mouseout"&&(x=y.toElement)),this.relatedTarget=x,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&yt.Z.h.call(this)},yt.prototype.h=function(){yt.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var xt="closure_listenable_"+(Math.random()*1e6|0),J=0;function st(y,x,A,I,K){this.listener=y,this.proxy=null,this.src=x,this.type=A,this.capture=!!I,this.ha=K,this.key=++J,this.da=this.fa=!1}function ht(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function Ct(y,x,A){for(const I in y)x.call(A,y[I],I,y)}function Vt(y,x){for(const A in y)x.call(void 0,y[A],A,y)}function $(y){const x={};for(const A in y)x[A]=y[A];return x}const ot="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function dt(y,x){let A,I;for(let K=1;K<arguments.length;K++){I=arguments[K];for(A in I)y[A]=I[A];for(let et=0;et<ot.length;et++)A=ot[et],Object.prototype.hasOwnProperty.call(I,A)&&(y[A]=I[A])}}function mt(y){this.src=y,this.g={},this.h=0}mt.prototype.add=function(y,x,A,I,K){const et=y.toString();y=this.g[et],y||(y=this.g[et]=[],this.h++);const pt=It(y,x,I,K);return pt>-1?(x=y[pt],A||(x.fa=!1)):(x=new st(x,this.src,et,!!I,K),x.fa=A,y.push(x)),x};function Dt(y,x){const A=x.type;if(A in y.g){var I=y.g[A],K=Array.prototype.indexOf.call(I,x,void 0),et;(et=K>=0)&&Array.prototype.splice.call(I,K,1),et&&(ht(x),y.g[A].length==0&&(delete y.g[A],y.h--))}}function It(y,x,A,I){for(let K=0;K<y.length;++K){const et=y[K];if(!et.da&&et.listener==x&&et.capture==!!A&&et.ha==I)return K}return-1}var Ut="closure_lm_"+(Math.random()*1e6|0),Ve={};function ce(y,x,A,I,K){if(Array.isArray(x)){for(let et=0;et<x.length;et++)ce(y,x[et],A,I,K);return null}return A=gf(A),y&&y[xt]?y.J(x,A,l(I)?!!I.capture:!1,K):Rt(y,x,A,!1,I,K)}function Rt(y,x,A,I,K,et){if(!x)throw Error("Invalid event type");const pt=l(K)?!!K.capture:!!K;let zt=Vl(y);if(zt||(y[Ut]=zt=new mt(y)),A=zt.add(x,A,I,pt,et),A.proxy)return A;if(I=ge(),A.proxy=I,I.src=y,I.listener=A,y.addEventListener)H||(K=pt),K===void 0&&(K=!1),y.addEventListener(x.toString(),I,K);else if(y.attachEvent)y.attachEvent(ri(x.toString()),I);else if(y.addListener&&y.removeListener)y.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return A}function ge(){function y(A){return x.call(y.src,y.listener,A)}const x=pf;return y}function Re(y,x,A,I,K){if(Array.isArray(x))for(var et=0;et<x.length;et++)Re(y,x[et],A,I,K);else I=l(I)?!!I.capture:!!I,A=gf(A),y&&y[xt]?(y=y.i,et=String(x).toString(),et in y.g&&(x=y.g[et],A=It(x,A,I,K),A>-1&&(ht(x[A]),Array.prototype.splice.call(x,A,1),x.length==0&&(delete y.g[et],y.h--)))):y&&(y=Vl(y))&&(x=y.g[x.toString()],y=-1,x&&(y=It(x,A,I,K)),(A=y>-1?x[y]:null)&&Sr(A))}function Sr(y){if(typeof y!="number"&&y&&!y.da){var x=y.src;if(x&&x[xt])Dt(x.i,y);else{var A=y.type,I=y.proxy;x.removeEventListener?x.removeEventListener(A,I,y.capture):x.detachEvent?x.detachEvent(ri(A),I):x.addListener&&x.removeListener&&x.removeListener(I),(A=Vl(x))?(Dt(A,y),A.h==0&&(A.src=null,x[Ut]=null)):ht(y)}}}function ri(y){return y in Ve?Ve[y]:Ve[y]="on"+y}function pf(y,x){if(y.da)y=!0;else{x=new yt(x,this);const A=y.listener,I=y.ha||y.src;y.fa&&Sr(y),y=A.call(I,x)}return y}function Vl(y){return y=y[Ut],y instanceof mt?y:null}var mf="__closure_events_fn_"+(Math.random()*1e9>>>0);function gf(y){return typeof y=="function"?y:(y[mf]||(y[mf]=function(x){return y.handleEvent(x)}),y[mf])}function on(){B.call(this),this.i=new mt(this),this.M=this,this.G=null}m(on,B),on.prototype[xt]=!0,on.prototype.removeEventListener=function(y,x,A,I){Re(this,y,x,A,I)};function Tn(y,x){var A,I=y.G;if(I)for(A=[];I;I=I.G)A.push(I);if(y=y.M,I=x.type||x,typeof x=="string")x=new F(x,y);else if(x instanceof F)x.target=x.target||y;else{var K=x;x=new F(I,y),dt(x,K)}K=!0;let et,pt;if(A)for(pt=A.length-1;pt>=0;pt--)et=x.g=A[pt],K=ta(et,I,!0,x)&&K;if(et=x.g=y,K=ta(et,I,!0,x)&&K,K=ta(et,I,!1,x)&&K,A)for(pt=0;pt<A.length;pt++)et=x.g=A[pt],K=ta(et,I,!1,x)&&K}on.prototype.N=function(){if(on.Z.N.call(this),this.i){var y=this.i;for(const x in y.g){const A=y.g[x];for(let I=0;I<A.length;I++)ht(A[I]);delete y.g[x],y.h--}}this.G=null},on.prototype.J=function(y,x,A,I){return this.i.add(String(y),x,!1,A,I)},on.prototype.K=function(y,x,A,I){return this.i.add(String(y),x,!0,A,I)};function ta(y,x,A,I){if(x=y.i.g[String(x)],!x)return!0;x=x.concat();let K=!0;for(let et=0;et<x.length;++et){const pt=x[et];if(pt&&!pt.da&&pt.capture==A){const zt=pt.listener,Ze=pt.ha||pt.src;pt.fa&&Dt(y.i,pt),K=zt.call(Ze,I)!==!1&&K}}return K&&!I.defaultPrevented}function u_(y,x){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=h(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:o.setTimeout(y,x||0)}function Am(y){y.g=u_(()=>{y.g=null,y.i&&(y.i=!1,Am(y))},y.l);const x=y.h;y.h=null,y.m.apply(null,x)}class or extends B{constructor(x,A){super(),this.m=x,this.l=A,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Am(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function jl(y){B.call(this),this.h=y,this.g={}}m(jl,B);var yf=[];function vf(y){Ct(y.g,function(x,A){this.g.hasOwnProperty(A)&&Sr(x)},y),y.g={}}jl.prototype.N=function(){jl.Z.N.call(this),vf(this)},jl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ea=o.JSON.stringify,h_=o.JSON.parse,km=class{stringify(y){return o.JSON.stringify(y,void 0)}parse(y){return o.JSON.parse(y,void 0)}};function Rm(){}function Mm(){}var Di={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ln(){F.call(this,"d")}m(Ln,F);function ii(){F.call(this,"c")}m(ii,F);var Je={},Dm=null;function hu(){return Dm=Dm||new on}Je.Ia="serverreachability";function Om(y){F.call(this,Je.Ia,y)}m(Om,F);function cs(y){const x=hu();Tn(x,new Om(x))}Je.STAT_EVENT="statevent";function Bl(y,x){F.call(this,Je.STAT_EVENT,y),this.stat=x}m(Bl,F);function an(y){const x=hu();Tn(x,new Bl(x,y))}Je.Ja="timingevent";function us(y,x){F.call(this,Je.Ja,y),this.size=x}m(us,F);function hs(y,x){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){y()},x)}function Oi(){this.g=!0}Oi.prototype.ua=function(){this.g=!1};function f_(y,x,A,I,K,et){y.info(function(){if(y.g)if(et){var pt="",zt=et.split("&");for(let ae=0;ae<zt.length;ae++){var Ze=zt[ae].split("=");if(Ze.length>1){const Ie=Ze[0];Ze=Ze[1];const li=Ie.split("_");pt=li.length>=2&&li[1]=="type"?pt+(Ie+"="+Ze+"&"):pt+(Ie+"=redacted&")}}}else pt=null;else pt=et;return"XMLHTTP REQ ("+I+") [attempt "+K+"]: "+x+`
`+A+`
`+pt})}function Im(y,x,A,I,K,et,pt){y.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+K+"]: "+x+`
`+A+`
`+et+" "+pt})}function fs(y,x,A,I){y.info(function(){return"XMLHTTP TEXT ("+x+"): "+d_(y,A)+(I?" "+I:"")})}function Fl(y,x){y.info(function(){return"TIMEOUT: "+x})}Oi.prototype.info=function(){};function d_(y,x){if(!y.g)return x;if(!x)return null;try{const et=JSON.parse(x);if(et){for(y=0;y<et.length;y++)if(Array.isArray(et[y])){var A=et[y];if(!(A.length<2)){var I=A[1];if(Array.isArray(I)&&!(I.length<1)){var K=I[0];if(K!="noop"&&K!="stop"&&K!="close")for(let pt=1;pt<I.length;pt++)I[pt]=""}}}}return ea(et)}catch{return x}}var Ul={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},bf={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},_f;function zl(){}m(zl,Rm),zl.prototype.g=function(){return new XMLHttpRequest},_f=new zl;function to(y){return encodeURIComponent(String(y))}function Pm(y){var x=1;y=y.split(":");const A=[];for(;x>0&&y.length;)A.push(y.shift()),x--;return y.length&&A.push(y.join(":")),A}function Ii(y,x,A,I){this.j=y,this.i=x,this.l=A,this.S=I||1,this.V=new jl(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pi}function Pi(){this.i=null,this.g="",this.h=!1}var ln={},An={};function ds(y,x,A){y.M=1,y.A=Hl(un(x)),y.u=A,y.R=!0,fu(y,null)}function fu(y,x){y.F=Date.now(),ps(y),y.B=un(y.A);var A=y.B,I=y.S;Array.isArray(I)||(I=[String(I)]),gu(A.i,"t",I),y.C=0,A=y.j.L,y.h=new Pi,y.g=Km(y.j,A?x:null,!y.u),y.P>0&&(y.O=new or(h(y.Y,y,y.g),y.P)),x=y.V,A=y.g,I=y.ba;var K="readystatechange";Array.isArray(K)||(K&&(yf[0]=K.toString()),K=yf);for(let et=0;et<K.length;et++){const pt=ce(A,K[et],I||x.handleEvent,!1,x.h||x);if(!pt)break;x.g[pt.key]=pt}x=y.J?$(y.J):{},y.u?(y.v||(y.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,x)):(y.v="GET",y.g.ea(y.B,y.v,null,x)),cs(),f_(y.i,y.v,y.B,y.l,y.S,y.u)}Ii.prototype.ba=function(y){y=y.target;const x=this.O;x&&Vi(y)==3?x.j():this.Y(y)},Ii.prototype.Y=function(y){try{if(y==this.g)t:{const zt=Vi(this.g),Ze=this.g.ya(),ae=this.g.ca();if(!(zt<3)&&(zt!=3||this.g&&(this.h.h||this.g.la()||Vn(this.g)))){this.K||zt!=4||Ze==7||(Ze==8||ae<=0?cs(3):cs(2)),ms(this);var x=this.g.ca();this.X=x;var A=p_(this);if(this.o=x==200,Im(this.i,this.v,this.B,this.l,this.S,zt,x),this.o){if(this.U&&!this.L){e:{if(this.g){var I,K=this.g;if((I=K.g?K.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(I)){var et=I;break e}}et=null}if(y=et)fs(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,gs(this,y);else{this.o=!1,this.m=3,an(12),jr(this),si(this);break t}}if(this.R){y=!0;let Ie;for(;!this.K&&this.C<A.length;)if(Ie=Lm(this,A),Ie==An){zt==4&&(this.m=4,an(14),y=!1),fs(this.i,this.l,null,"[Incomplete Response]");break}else if(Ie==ln){this.m=4,an(15),fs(this.i,this.l,A,"[Invalid Chunk]"),y=!1;break}else fs(this.i,this.l,Ie,null),gs(this,Ie);if(Nm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),zt!=4||A.length!=0||this.h.h||(this.m=1,an(16),y=!1),this.o=this.o&&y,!y)fs(this.i,this.l,A,"[Invalid Chunked Response]"),jr(this),si(this);else if(A.length>0&&!this.W){this.W=!0;var pt=this.j;pt.g==this&&pt.aa&&!pt.P&&(pt.j.info("Great, no buffering proxy detected. Bytes received: "+A.length),Nf(pt),pt.P=!0,an(11))}}else fs(this.i,this.l,A,null),gs(this,A);zt==4&&jr(this),this.o&&!this.K&&(zt==4?qm(this.j,this):(this.o=!1,ps(this)))}else no(this.g),x==400&&A.indexOf("Unknown SID")>0?(this.m=3,an(12)):(this.m=0,an(13)),jr(this),si(this)}}}catch{}};function p_(y){if(!Nm(y))return y.g.la();const x=Vn(y.g);if(x==="")return"";let A="";const I=x.length,K=Vi(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return jr(y),si(y),"";y.h.i=new o.TextDecoder}for(let et=0;et<I;et++)y.h.h=!0,A+=y.h.i.decode(x[et],{stream:!(K&&et==I-1)});return x.length=0,y.h.g+=A,y.C=0,y.h.g}function Nm(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function Lm(y,x){var A=y.C,I=x.indexOf(`
`,A);return I==-1?An:(A=Number(x.substring(A,I)),isNaN(A)?ln:(I+=1,I+A>x.length?An:(x=x.slice(I,I+A),y.C=I+A,x)))}Ii.prototype.cancel=function(){this.K=!0,jr(this)};function ps(y){y.T=Date.now()+y.H,du(y,y.H)}function du(y,x){if(y.D!=null)throw Error("WatchDog timer not null");y.D=hs(h(y.aa,y),x)}function ms(y){y.D&&(o.clearTimeout(y.D),y.D=null)}Ii.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(Fl(this.i,this.B),this.M!=2&&(cs(),an(17)),jr(this),this.m=2,si(this)):du(this,this.T-y)};function si(y){y.j.I==0||y.K||qm(y.j,y)}function jr(y){ms(y);var x=y.O;x&&typeof x.dispose=="function"&&x.dispose(),y.O=null,vf(y.V),y.g&&(x=y.g,y.g=null,x.abort(),x.dispose())}function gs(y,x){try{var A=y.j;if(A.I!=0&&(A.g==y||vs(A.h,y))){if(!y.L&&vs(A.h,y)&&A.I==3){try{var I=A.Ba.g.parse(x)}catch{I=null}if(Array.isArray(I)&&I.length==3){var K=I;if(K[0]==0){t:if(!A.v){if(A.g)if(A.g.F+3e3<y.F)Tu(A),ca(A);else break t;Xl(A),an(18)}}else A.xa=K[1],0<A.xa-A.K&&K[2]<37500&&A.F&&A.A==0&&!A.C&&(A.C=hs(h(A.Va,A),6e3));ys(A.h)<=1&&A.ta&&(A.ta=void 0)}else xs(A,11)}else if((y.L||A.g==y)&&Tu(A),!V(x))for(K=A.Ba.g.parse(x),x=0;x<K.length;x++){let ae=K[x];const Ie=ae[0];if(!(Ie<=A.K))if(A.K=Ie,ae=ae[1],A.I==2)if(ae[0]=="c"){A.M=ae[1],A.ba=ae[2];const li=ae[3];li!=null&&(A.ka=li,A.j.info("VER="+A.ka));const Es=ae[4];Es!=null&&(A.za=Es,A.j.info("SVER="+A.za));const ji=ae[5];ji!=null&&typeof ji=="number"&&ji>0&&(I=1.5*ji,A.O=I,A.j.info("backChannelRequestTimeoutMs_="+I)),I=A;const Bi=y.g;if(Bi){const Ql=Bi.g?Bi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ql){var et=I.h;et.g||Ql.indexOf("spdy")==-1&&Ql.indexOf("quic")==-1&&Ql.indexOf("h2")==-1||(et.j=et.l,et.g=new Set,et.h&&(wf(et,et.h),et.h=null))}if(I.G){const Su=Bi.g?Bi.g.getResponseHeader("X-HTTP-Session-Id"):null;Su&&(I.wa=Su,he(I.J,I.G,Su))}}A.I=3,A.l&&A.l.ra(),A.aa&&(A.T=Date.now()-y.F,A.j.info("Handshake RTT: "+A.T+"ms")),I=A;var pt=y;if(I.na=Ym(I,I.L?I.ba:null,I.W),pt.L){xf(I.h,pt);var zt=pt,Ze=I.O;Ze&&(zt.H=Ze),zt.D&&(ms(zt),ps(zt)),I.g=pt}else Hm(I);A.i.length>0&&ws(A)}else ae[0]!="stop"&&ae[0]!="close"||xs(A,7);else A.I==3&&(ae[0]=="stop"||ae[0]=="close"?ae[0]=="stop"?xs(A,7):If(A):ae[0]!="noop"&&A.l&&A.l.qa(ae),A.A=0)}}cs(4)}catch{}}var cn=class{constructor(y,x){this.g=y,this.map=x}};function Tf(y){this.l=y||10,o.PerformanceNavigationTiming?(y=o.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Sf(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function ys(y){return y.h?1:y.g?y.g.size:0}function vs(y,x){return y.h?y.h==x:y.g?y.g.has(x):!1}function wf(y,x){y.g?y.g.add(x):y.h=x}function xf(y,x){y.h&&y.h==x?y.h=null:y.g&&y.g.has(x)&&y.g.delete(x)}Tf.prototype.cancel=function(){if(this.i=Ef(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Ef(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let x=y.i;for(const A of y.g.values())x=x.concat(A.G);return x}return v(y.i)}var Vm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pu(y,x){if(y){y=y.split("&");for(let A=0;A<y.length;A++){const I=y[A].indexOf("=");let K,et=null;I>=0?(K=y[A].substring(0,I),et=y[A].substring(I+1)):K=y[A],x(K,et?decodeURIComponent(et.replace(/\+/g," ")):"")}}}function Br(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;y instanceof Br?(this.l=y.l,kn(this,y.j),this.o=y.o,this.g=y.g,na(this,y.u),this.h=y.h,Cf(this,Um(y.i)),this.m=y.m):y&&(x=String(y).match(Vm))?(this.l=!1,kn(this,x[1]||"",!0),this.o=bs(x[2]||""),this.g=bs(x[3]||"",!0),na(this,x[4]),this.h=bs(x[5]||"",!0),Cf(this,x[6]||"",!0),this.m=bs(x[7]||"")):(this.l=!1,this.i=new ia(null,this.l))}Br.prototype.toString=function(){const y=[];var x=this.j;x&&y.push($l(x,mu,!0),":");var A=this.g;return(A||x=="file")&&(y.push("//"),(x=this.o)&&y.push($l(x,mu,!0),"@"),y.push(to(A).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.u,A!=null&&y.push(":",String(A))),(A=this.h)&&(this.g&&A.charAt(0)!="/"&&y.push("/"),y.push($l(A,A.charAt(0)=="/"?Af:jm,!0))),(A=this.i.toString())&&y.push("?",A),(A=this.m)&&y.push("#",$l(A,Bm)),y.join("")},Br.prototype.resolve=function(y){const x=un(this);let A=!!y.j;A?kn(x,y.j):A=!!y.o,A?x.o=y.o:A=!!y.g,A?x.g=y.g:A=y.u!=null;var I=y.h;if(A)na(x,y.u);else if(A=!!y.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var K=x.h.lastIndexOf("/");K!=-1&&(I=x.h.slice(0,K+1)+I)}if(K=I,K==".."||K==".")I="";else if(K.indexOf("./")!=-1||K.indexOf("/.")!=-1){I=K.lastIndexOf("/",0)==0,K=K.split("/");const et=[];for(let pt=0;pt<K.length;){const zt=K[pt++];zt=="."?I&&pt==K.length&&et.push(""):zt==".."?((et.length>1||et.length==1&&et[0]!="")&&et.pop(),I&&pt==K.length&&et.push("")):(et.push(zt),I=!0)}I=et.join("/")}else I=K}return A?x.h=I:A=y.i.toString()!=="",A?Cf(x,Um(y.i)):A=!!y.m,A&&(x.m=y.m),x};function un(y){return new Br(y)}function kn(y,x,A){y.j=A?bs(x,!0):x,y.j&&(y.j=y.j.replace(/:$/,""))}function na(y,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);y.u=x}else y.u=null}function Cf(y,x,A){x instanceof ia?(y.i=x,yu(y.i,y.l)):(A||(x=$l(x,ra)),y.i=new ia(x,y.l))}function he(y,x,A){y.i.set(x,A)}function Hl(y){return he(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function bs(y,x){return y?x?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function $l(y,x,A){return typeof y=="string"?(y=encodeURI(y).replace(x,wr),A&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function wr(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var mu=/[#\/\?@]/g,jm=/[#\?:]/g,Af=/[#\?]/g,ra=/[#\?@]/g,Bm=/#/g;function ia(y,x){this.h=this.g=null,this.i=y||null,this.j=!!x}function xr(y){y.g||(y.g=new Map,y.h=0,y.i&&pu(y.i,function(x,A){y.add(decodeURIComponent(x.replace(/\+/g," ")),A)}))}n=ia.prototype,n.add=function(y,x){xr(this),this.i=null,y=sa(this,y);let A=this.g.get(y);return A||this.g.set(y,A=[]),A.push(x),this.h+=1,this};function Fm(y,x){xr(y),x=sa(y,x),y.g.has(x)&&(y.i=null,y.h-=y.g.get(x).length,y.g.delete(x))}function kf(y,x){return xr(y),x=sa(y,x),y.g.has(x)}n.forEach=function(y,x){xr(this),this.g.forEach(function(A,I){A.forEach(function(K){y.call(x,K,I,this)},this)},this)};function Rf(y,x){xr(y);let A=[];if(typeof x=="string")kf(y,x)&&(A=A.concat(y.g.get(sa(y,x))));else for(y=Array.from(y.g.values()),x=0;x<y.length;x++)A=A.concat(y[x]);return A}n.set=function(y,x){return xr(this),this.i=null,y=sa(this,y),kf(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[x]),this.h+=1,this},n.get=function(y,x){return y?(y=Rf(this,y),y.length>0?String(y[0]):x):x};function gu(y,x,A){Fm(y,x),A.length>0&&(y.i=null,y.g.set(sa(y,x),v(A)),y.h+=A.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],x=Array.from(this.g.keys());for(let I=0;I<x.length;I++){var A=x[I];const K=to(A);A=Rf(this,A);for(let et=0;et<A.length;et++){let pt=K;A[et]!==""&&(pt+="="+to(A[et])),y.push(pt)}}return this.i=y.join("&")};function Um(y){const x=new ia;return x.i=y.i,y.g&&(x.g=new Map(y.g),x.h=y.h),x}function sa(y,x){return x=String(x),y.j&&(x=x.toLowerCase()),x}function yu(y,x){x&&!y.j&&(xr(y),y.i=null,y.g.forEach(function(A,I){const K=I.toLowerCase();I!=K&&(Fm(this,I),gu(this,K,A))},y)),y.j=x}function Ni(y,x){const A=new Oi;if(o.Image){const I=new Image;I.onload=d(oi,A,"TestLoadImage: loaded",!0,x,I),I.onerror=d(oi,A,"TestLoadImage: error",!1,x,I),I.onabort=d(oi,A,"TestLoadImage: abort",!1,x,I),I.ontimeout=d(oi,A,"TestLoadImage: timeout",!1,x,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=y}else x(!1)}function Mf(y,x){const A=new Oi,I=new AbortController,K=setTimeout(()=>{I.abort(),oi(A,"TestPingServer: timeout",!1,x)},1e4);fetch(y,{signal:I.signal}).then(et=>{clearTimeout(K),et.ok?oi(A,"TestPingServer: ok",!0,x):oi(A,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(K),oi(A,"TestPingServer: error",!1,x)})}function oi(y,x,A,I,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),I(A)}catch{}}function oa(){this.g=new km}function _s(y){this.i=y.Sb||null,this.h=y.ab||!1}m(_s,Rm),_s.prototype.g=function(){return new ql(this.i,this.h)};function ql(y,x){on.call(this),this.H=y,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(ql,on),n=ql.prototype,n.open=function(y,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=x,this.readyState=1,Li(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(x.body=y),(this.H||o).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,aa(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Li(this)),this.g&&(this.readyState=3,Li(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;vu(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function vu(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var x=y.value?y.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!y.done}))&&(this.response=this.responseText+=x)}y.done?aa(this):Li(this),this.readyState==3&&vu(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,aa(this))},n.Na=function(y){this.g&&(this.response=y,aa(this))},n.ga=function(){this.g&&aa(this)};function aa(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Li(y)}n.setRequestHeader=function(y,x){this.A.append(y,x)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],x=this.h.entries();for(var A=x.next();!A.done;)A=A.value,y.push(A[0]+": "+A[1]),A=x.next();return y.join(`\r
`)};function Li(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(ql.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function ai(y){let x="";return Ct(y,function(A,I){x+=I,x+=":",x+=A,x+=`\r
`}),x}function Gl(y,x,A){t:{for(I in A){var I=!1;break t}I=!0}I||(A=ai(A),typeof y=="string"?A!=null&&to(A):he(y,x,A))}function ye(y){on.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(ye,on);var Ts=/^https?$/i,Df=["POST","PUT"];n=ye.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,x,A,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);x=x?x.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():_f.g(),this.g.onreadystatechange=g(h(this.Ca,this));try{this.B=!0,this.g.open(x,String(y),!0),this.B=!1}catch(et){Wl(this,et);return}if(y=A||"",A=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var K in I)A.set(K,I[K]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const et of I.keys())A.set(et,I.get(et));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(A.keys()).find(et=>et.toLowerCase()=="content-type"),K=o.FormData&&y instanceof o.FormData,!(Array.prototype.indexOf.call(Df,x,void 0)>=0)||I||K||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[et,pt]of A)this.g.setRequestHeader(et,pt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(et){Wl(this,et)}};function Wl(y,x){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=x,y.o=5,Of(y),eo(y)}function Of(y){y.A||(y.A=!0,Tn(y,"complete"),Tn(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Tn(this,"complete"),Tn(this,"abort"),eo(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),eo(this,!0)),ye.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Yl(this):this.Xa())},n.Xa=function(){Yl(this)};function Yl(y){if(y.h&&typeof s<"u"){if(y.v&&Vi(y)==4)setTimeout(y.Ca.bind(y),0);else if(Tn(y,"readystatechange"),Vi(y)==4){y.h=!1;try{const et=y.ca();t:switch(et){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break t;default:x=!1}var A;if(!(A=x)){var I;if(I=et===0){let pt=String(y.D).match(Vm)[1]||null;!pt&&o.self&&o.self.location&&(pt=o.self.location.protocol.slice(0,-1)),I=!Ts.test(pt?pt.toLowerCase():"")}A=I}if(A)Tn(y,"complete"),Tn(y,"success");else{y.o=6;try{var K=Vi(y)>2?y.g.statusText:""}catch{K=""}y.l=K+" ["+y.ca()+"]",Of(y)}}finally{eo(y)}}}}function eo(y,x){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const A=y.g;y.g=null,x||Tn(y,"ready");try{A.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Vi(y){return y.g?y.g.readyState:0}n.ca=function(){try{return Vi(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var x=this.g.responseText;return y&&x.indexOf(y)==0&&(x=x.substring(y.length)),h_(x)}};function Vn(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function no(y){const x={};y=(y.g&&Vi(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<y.length;I++){if(V(y[I]))continue;var A=Pm(y[I]);const K=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const et=x[K]||[];x[K]=et,et.push(A)}Vt(x,function(I){return I.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ss(y,x,A){return A&&A.internalChannelParams&&A.internalChannelParams[y]||x}function la(y){this.za=0,this.i=[],this.j=new Oi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ss("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ss("baseRetryDelayMs",5e3,y),this.Za=Ss("retryDelaySeedMs",1e4,y),this.Ta=Ss("forwardChannelMaxRetries",2,y),this.va=Ss("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Tf(y&&y.concurrentRequestLimit),this.Ba=new oa,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=la.prototype,n.ka=8,n.I=1,n.connect=function(y,x,A,I){an(0),this.W=y,this.H=x||{},A&&I!==void 0&&(this.H.OSID=A,this.H.OAID=I),this.F=this.X,this.J=Ym(this,null,this.W),ws(this)};function If(y){if(bu(y),y.I==3){var x=y.V++,A=un(y.J);if(he(A,"SID",y.M),he(A,"RID",x),he(A,"TYPE","terminate"),Kl(y,A),x=new Ii(y,y.j,x),x.M=2,x.A=Hl(un(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(x.A.toString(),"")}catch{}!A&&o.Image&&(new Image().src=x.A,A=!0),A||(x.g=Km(x.j,null),x.g.ea(x.A)),x.F=Date.now(),ps(x)}Wm(y)}function ca(y){y.g&&(Nf(y),y.g.cancel(),y.g=null)}function bu(y){ca(y),y.v&&(o.clearTimeout(y.v),y.v=null),Tu(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&o.clearTimeout(y.m),y.m=null)}function ws(y){if(!Sf(y.h)&&!y.m){y.m=!0;var x=y.Ea;N||k(),W||(N(),W=!0),M.add(x,y),y.D=0}}function _u(y,x){return ys(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=x.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=hs(h(y.Ea,y,x),Gm(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const K=new Ii(this,this.j,y);let et=this.o;if(this.U&&(et?(et=$(et),dt(et,this.U)):et=this.U),this.u!==null||this.R||(K.J=et,et=null),this.S)t:{for(var x=0,A=0;A<this.i.length;A++){e:{var I=this.i[A];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break e}I=void 0}if(I===void 0)break;if(x+=I,x>4096){x=A;break t}if(x===4096||A===this.i.length-1){x=A+1;break t}}x=1e3}else x=1e3;x=zm(this,K,x),A=un(this.J),he(A,"RID",y),he(A,"CVER",22),this.G&&he(A,"X-HTTP-Session-Id",this.G),Kl(this,A),et&&(this.R?x="headers="+to(ai(et))+"&"+x:this.u&&Gl(A,this.u,et)),wf(this.h,K),this.Ra&&he(A,"TYPE","init"),this.S?(he(A,"$req",x),he(A,"SID","null"),K.U=!0,ds(K,A,null)):ds(K,A,x),this.I=2}}else this.I==3&&(y?Pf(this,y):this.i.length==0||Sf(this.h)||Pf(this))};function Pf(y,x){var A;x?A=x.l:A=y.V++;const I=un(y.J);he(I,"SID",y.M),he(I,"RID",A),he(I,"AID",y.K),Kl(y,I),y.u&&y.o&&Gl(I,y.u,y.o),A=new Ii(y,y.j,A,y.D+1),y.u===null&&(A.J=y.o),x&&(y.i=x.G.concat(y.i)),x=zm(y,A,1e3),A.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),wf(y.h,A),ds(A,I,x)}function Kl(y,x){y.H&&Ct(y.H,function(A,I){he(x,I,A)}),y.l&&Ct({},function(A,I){he(x,I,A)})}function zm(y,x,A){A=Math.min(y.i.length,A);const I=y.l?h(y.l.Ka,y.l,y):null;t:{var K=y.i;let zt=-1;for(;;){const Ze=["count="+A];zt==-1?A>0?(zt=K[0].g,Ze.push("ofs="+zt)):zt=0:Ze.push("ofs="+zt);let ae=!0;for(let Ie=0;Ie<A;Ie++){var et=K[Ie].g;const li=K[Ie].map;if(et-=zt,et<0)zt=Math.max(0,K[Ie].g-100),ae=!1;else try{et="req"+et+"_"||"";try{var pt=li instanceof Map?li:Object.entries(li);for(const[Es,ji]of pt){let Bi=ji;l(ji)&&(Bi=ea(ji)),Ze.push(et+Es+"="+encodeURIComponent(Bi))}}catch(Es){throw Ze.push(et+"type="+encodeURIComponent("_badmap")),Es}}catch{I&&I(li)}}if(ae){pt=Ze.join("&");break t}}pt=void 0}return y=y.i.splice(0,A),x.G=y,pt}function Hm(y){if(!y.g&&!y.v){y.Y=1;var x=y.Da;N||k(),W||(N(),W=!0),M.add(x,y),y.A=0}}function Xl(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=hs(h(y.Da,y),Gm(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,$m(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=hs(h(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,an(10),ca(this),$m(this))};function Nf(y){y.B!=null&&(o.clearTimeout(y.B),y.B=null)}function $m(y){y.g=new Ii(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var x=un(y.na);he(x,"RID","rpc"),he(x,"SID",y.M),he(x,"AID",y.K),he(x,"CI",y.F?"0":"1"),!y.F&&y.ia&&he(x,"TO",y.ia),he(x,"TYPE","xmlhttp"),Kl(y,x),y.u&&y.o&&Gl(x,y.u,y.o),y.O&&(y.g.H=y.O);var A=y.g;y=y.ba,A.M=1,A.A=Hl(un(x)),A.u=null,A.R=!0,fu(A,y)}n.Va=function(){this.C!=null&&(this.C=null,ca(this),Xl(this),an(19))};function Tu(y){y.C!=null&&(o.clearTimeout(y.C),y.C=null)}function qm(y,x){var A=null;if(y.g==x){Tu(y),Nf(y),y.g=null;var I=2}else if(vs(y.h,x))A=x.G,xf(y.h,x),I=1;else return;if(y.I!=0){if(x.o)if(I==1){A=x.u?x.u.length:0,x=Date.now()-x.F;var K=y.D;I=hu(),Tn(I,new us(I,A)),ws(y)}else Hm(y);else if(K=x.m,K==3||K==0&&x.X>0||!(I==1&&_u(y,x)||I==2&&Xl(y)))switch(A&&A.length>0&&(x=y.h,x.i=x.i.concat(A)),K){case 1:xs(y,5);break;case 4:xs(y,10);break;case 3:xs(y,6);break;default:xs(y,2)}}}function Gm(y,x){let A=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(A*=2),A*x}function xs(y,x){if(y.j.info("Error code "+x),x==2){var A=h(y.bb,y),I=y.Ua;const K=!I;I=new Br(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||kn(I,"https"),Hl(I),K?Ni(I.toString(),A):Mf(I.toString(),A)}else an(2);y.I=0,y.l&&y.l.pa(x),Wm(y),bu(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),an(2)):(this.j.info("Failed to ping google.com"),an(1))};function Wm(y){if(y.I=0,y.ja=[],y.l){const x=Ef(y.h);(x.length!=0||y.i.length!=0)&&(T(y.ja,x),T(y.ja,y.i),y.h.i.length=0,v(y.i),y.i.length=0),y.l.oa()}}function Ym(y,x,A){var I=A instanceof Br?un(A):new Br(A);if(I.g!="")x&&(I.g=x+"."+I.g),na(I,I.u);else{var K=o.location;I=K.protocol,x=x?x+"."+K.hostname:K.hostname,K=+K.port;const et=new Br(null);I&&kn(et,I),x&&(et.g=x),K&&na(et,K),A&&(et.h=A),I=et}return A=y.G,x=y.wa,A&&x&&he(I,A,x),he(I,"VER",y.ka),Kl(y,I),I}function Km(y,x,A){if(x&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=y.Aa&&!y.ma?new ye(new _s({ab:A})):new ye(y.ma),x.Fa(y.L),x}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xm(){}n=Xm.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ua(){}ua.prototype.g=function(y,x){return new ar(y,x)};function ar(y,x){on.call(this),this.g=new la(x),this.l=y,this.h=x&&x.messageUrlParams||null,y=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(y?y["X-WebChannel-Content-Type"]=x.messageContentType:y={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(y?y["X-WebChannel-Client-Profile"]=x.sa:y={"X-WebChannel-Client-Profile":x.sa}),this.g.U=y,(y=x&&x.Qb)&&!V(y)&&(this.g.u=y),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!V(x)&&(this.g.G=x,y=this.h,y!==null&&x in y&&(y=this.h,x in y&&delete y[x])),this.j=new ro(this)}m(ar,on),ar.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ar.prototype.close=function(){If(this.g)},ar.prototype.o=function(y){var x=this.g;if(typeof y=="string"){var A={};A.__data__=y,y=A}else this.v&&(A={},A.__data__=ea(y),y=A);x.i.push(new cn(x.Ya++,y)),x.I==3&&ws(x)},ar.prototype.N=function(){this.g.l=null,delete this.j,If(this.g),delete this.g,ar.Z.N.call(this)};function Qm(y){Ln.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var x=y.__sm__;if(x){t:{for(const A in x){y=A;break t}y=void 0}(this.i=y)&&(y=this.i,x=x!==null&&y in x?x[y]:void 0),this.data=x}else this.data=y}m(Qm,Ln);function Jm(){ii.call(this),this.status=1}m(Jm,ii);function ro(y){this.g=y}m(ro,Xm),ro.prototype.ra=function(){Tn(this.g,"a")},ro.prototype.qa=function(y){Tn(this.g,new Qm(y))},ro.prototype.pa=function(y){Tn(this.g,new Jm)},ro.prototype.oa=function(){Tn(this.g,"b")},ua.prototype.createWebChannel=ua.prototype.g,ar.prototype.send=ar.prototype.o,ar.prototype.open=ar.prototype.m,ar.prototype.close=ar.prototype.close,PL=function(){return new ua},IL=function(){return hu()},OL=Je,Yw={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ul.NO_ERROR=0,Ul.TIMEOUT=8,Ul.HTTP_ERROR=6,s0=Ul,bf.COMPLETE="complete",DL=bf,Mm.EventType=Di,Di.OPEN="a",Di.CLOSE="b",Di.ERROR="c",Di.MESSAGE="d",on.prototype.listen=on.prototype.J,Nd=Mm,ye.prototype.listenOnce=ye.prototype.K,ye.prototype.getLastError=ye.prototype.Ha,ye.prototype.getLastErrorCode=ye.prototype.ya,ye.prototype.getStatus=ye.prototype.ca,ye.prototype.getResponseJson=ye.prototype.La,ye.prototype.getResponseText=ye.prototype.la,ye.prototype.send=ye.prototype.ea,ye.prototype.setWithCredentials=ye.prototype.Fa,ML=ye}).apply(typeof iy<"u"?iy:typeof self<"u"?self:typeof window<"u"?window:{});class tr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}tr.UNAUTHENTICATED=new tr(null),tr.GOOGLE_CREDENTIALS=new tr("google-credentials-uid"),tr.FIRST_PARTY=new tr("first-party-uid"),tr.MOCK_USER=new tr("mock-user");let Xh="12.9.0";function Hq(n){Xh=n}const Wc=new PE("@firebase/firestore");function eh(){return Wc.logLevel}function bt(n,...t){if(Wc.logLevel<=Jt.DEBUG){const e=t.map(WE);Wc.debug(`Firestore (${Xh}): ${n}`,...e)}}function $o(n,...t){if(Wc.logLevel<=Jt.ERROR){const e=t.map(WE);Wc.error(`Firestore (${Xh}): ${n}`,...e)}}function Yc(n,...t){if(Wc.logLevel<=Jt.WARN){const e=t.map(WE);Wc.warn(`Firestore (${Xh}): ${n}`,...e)}}function WE(n){if(typeof n=="string")return n;try{return(function(e){return JSON.stringify(e)})(n)}catch{return n}}function Ot(n,t,e){let r="Unexpected state";typeof t=="string"?r=t:e=t,NL(n,r,e)}function NL(n,t,e){let r=`FIRESTORE (${Xh}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{r+=" CONTEXT: "+JSON.stringify(e)}catch{r+=" CONTEXT: "+e}throw $o(r),new Error(r)}function ie(n,t,e,r){let i="Unexpected state";typeof e=="string"?i=e:r=e,n||NL(t,i,r)}function Bt(n,t){return n}const it={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class gt extends Zs{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class zs{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class LL{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class $q{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(tr.UNAUTHENTICATED)))}shutdown(){}}class qq{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Gq{constructor(t){this.t=t,this.currentUser=tr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){ie(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,e(u)):Promise.resolve();let s=new zs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new zs,t.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=s;t.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},l=u=>{bt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(bt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new zs)}}),0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((r=>this.i!==t?(bt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ie(typeof r.accessToken=="string",31837,{l:r}),new LL(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ie(t===null||typeof t=="string",2055,{h:t}),new tr(t)}}class Wq{constructor(t,e,r){this.P=t,this.T=e,this.I=r,this.type="FirstParty",this.user=tr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const t=this.A();return t&&this.R.set("Authorization",t),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class Yq{constructor(t,e,r){this.P=t,this.T=e,this.I=r}getToken(){return Promise.resolve(new Wq(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(tr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class OD{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Kq{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ir(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){ie(this.o===void 0,3512);const r=s=>{s.error!=null&&bt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,bt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable((()=>r(s)))};const i=s=>{bt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):bt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new OD(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(ie(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new OD(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Xq(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class YE{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=Xq(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<e&&(r+=t.charAt(i[s]%62))}return r}}function Zt(n,t){return n<t?-1:n>t?1:0}function Kw(n,t){const e=Math.min(n.length,t.length);for(let r=0;r<e;r++){const i=n.charAt(r),s=t.charAt(r);if(i!==s)return xS(i)===xS(s)?Zt(i,s):xS(i)?1:-1}return Zt(n.length,t.length)}const Qq=55296,Jq=57343;function xS(n){const t=n.charCodeAt(0);return t>=Qq&&t<=Jq}function Dh(n,t,e){return n.length===t.length&&n.every(((r,i)=>e(r,t[i])))}const ID="__name__";class Ps{constructor(t,e,r){e===void 0?e=0:e>t.length&&Ot(637,{offset:e,range:t.length}),r===void 0?r=t.length-e:r>t.length-e&&Ot(1746,{length:r,range:t.length-e}),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return Ps.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Ps?t.forEach((r=>{e.push(r)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let i=0;i<r;i++){const s=Ps.compareSegments(t.get(i),e.get(i));if(s!==0)return s}return Zt(t.length,e.length)}static compareSegments(t,e){const r=Ps.isNumericId(t),i=Ps.isNumericId(e);return r&&!i?-1:!r&&i?1:r&&i?Ps.extractNumericId(t).compare(Ps.extractNumericId(e)):Kw(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return rl.fromString(t.substring(4,t.length-2))}}class Se extends Ps{construct(t,e,r){return new Se(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new gt(it.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter((i=>i.length>0)))}return new Se(e)}static emptyPath(){return new Se([])}}const Zq=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Wn extends Ps{construct(t,e,r){return new Wn(t,e,r)}static isValidIdentifier(t){return Zq.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Wn.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ID}static keyField(){return new Wn([ID])}static fromServerFormat(t){const e=[];let r="",i=0;const s=()=>{if(r.length===0)throw new gt(it.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;i<t.length;){const l=t[i];if(l==="\\"){if(i+1===t.length)throw new gt(it.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new gt(it.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new gt(it.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Wn(e)}static emptyPath(){return new Wn([])}}class At{constructor(t){this.path=t}static fromPath(t){return new At(Se.fromString(t))}static fromName(t){return new At(Se.fromString(t).popFirst(5))}static empty(){return new At(Se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Se.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return Se.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new At(new Se(t.slice()))}}function VL(n,t,e){if(!e)throw new gt(it.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function tG(n,t,e,r){if(t===!0&&r===!0)throw new gt(it.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function PD(n){if(!At.isDocumentKey(n))throw new gt(it.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ND(n){if(At.isDocumentKey(n))throw new gt(it.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function jL(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function pb(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(r){return r.constructor?r.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":Ot(12329,{type:typeof n})}function Ws(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new gt(it.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=pb(n);throw new gt(it.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function vn(n,t){const e={typeString:n};return t&&(e.value=t),e}function cm(n,t){if(!jL(n))throw new gt(it.INVALID_ARGUMENT,"JSON must be an object");let e;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in n)){e=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){e=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){e=`Expected '${r}' field to equal '${s.value}'`;break}}if(e)throw new gt(it.INVALID_ARGUMENT,e);return!0}const LD=-62135596800,VD=1e6;class we{static now(){return we.fromMillis(Date.now())}static fromDate(t){return we.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor((t-1e3*e)*VD);return new we(e,r)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new gt(it.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new gt(it.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<LD)throw new gt(it.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new gt(it.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/VD}_compareTo(t){return this.seconds===t.seconds?Zt(this.nanoseconds,t.nanoseconds):Zt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:we._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(cm(t,we._jsonSchema))return new we(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-LD;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}we._jsonSchemaVersion="firestore/timestamp/1.0",we._jsonSchema={type:vn("string",we._jsonSchemaVersion),seconds:vn("number"),nanoseconds:vn("number")};class Nt{static fromTimestamp(t){return new Nt(t)}static min(){return new Nt(new we(0,0))}static max(){return new Nt(new we(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const wp=-1;function eG(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Nt.fromTimestamp(r===1e9?new we(e+1,0):new we(e,r));return new hl(i,At.empty(),t)}function nG(n){return new hl(n.readTime,n.key,wp)}class hl{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new hl(Nt.min(),At.empty(),wp)}static max(){return new hl(Nt.max(),At.empty(),wp)}}function rG(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=At.comparator(n.documentKey,t.documentKey),e!==0?e:Zt(n.largestBatchId,t.largestBatchId))}const iG="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sG{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Qh(n){if(n.code!==it.FAILED_PRECONDITION||n.message!==iG)throw n;bt("LocalStore","Unexpectedly lost primary lease")}class ct{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new ct(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(e,s).next(r,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof ct?e:ct.resolve(e)}catch(e){return ct.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):ct.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):ct.reject(e)}static resolve(t){return new ct(((e,r)=>{e(t)}))}static reject(t){return new ct(((e,r)=>{r(t)}))}static waitFor(t){return new ct(((e,r)=>{let i=0,s=0,o=!1;t.forEach((l=>{++i,l.next((()=>{++s,o&&s===i&&e()}),(u=>r(u)))})),o=!0,s===i&&e()}))}static or(t){let e=ct.resolve(!1);for(const r of t)e=e.next((i=>i?ct.resolve(i):r()));return e}static forEach(t,e){const r=[];return t.forEach(((i,s)=>{r.push(e.call(this,i,s))})),this.waitFor(r)}static mapArray(t,e){return new ct(((r,i)=>{const s=t.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;e(t[h]).next((d=>{o[h]=d,++l,l===s&&r(o)}),(d=>i(d)))}}))}static doWhile(t,e){return new ct(((r,i)=>{const s=()=>{t()===!0?e().next((()=>{s()}),i):r()};s()}))}}function oG(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Jh(n){return n.name==="IndexedDbTransactionError"}class mb{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>e.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}mb.ce=-1;const KE=-1;function um(n){return n==null}function V0(n){return n===0&&1/n==-1/0}function aG(n){return typeof n=="number"&&Number.isInteger(n)&&!V0(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const BL="";function lG(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=jD(t)),t=cG(n.get(e),t);return jD(t)}function cG(n,t){let e=t;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":e+="";break;case BL:e+="";break;default:e+=s}}return e}function jD(n){return n+BL+""}function BD(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Rl(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function FL(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}class Ue{constructor(t,e){this.comparator=t,this.root=e||$n.EMPTY}insert(t,e){return new Ue(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,$n.BLACK,null,null))}remove(t){return new Ue(this.comparator,this.root.remove(t,this.comparator).copy(null,null,$n.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(r===0)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return e+r.left.size;i<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,r)=>(t(e,r),!1)))}toString(){const t=[];return this.inorderTraversal(((e,r)=>(t.push(`${e}:${r}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new sy(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new sy(this.root,t,this.comparator,!1)}getReverseIterator(){return new sy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new sy(this.root,t,this.comparator,!0)}}class sy{constructor(t,e,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?r(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class $n{constructor(t,e,r,i,s){this.key=t,this.value=e,this.color=r??$n.RED,this.left=i??$n.EMPTY,this.right=s??$n.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,i,s){return new $n(t??this.key,e??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let i=this;const s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,r),null):s===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return $n.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return $n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,$n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,$n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ot(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Ot(27949);return t+(this.isRed()?0:1)}}$n.EMPTY=null,$n.RED=!0,$n.BLACK=!1;$n.EMPTY=new class{constructor(){this.size=0}get key(){throw Ot(57766)}get value(){throw Ot(16141)}get color(){throw Ot(16727)}get left(){throw Ot(29726)}get right(){throw Ot(36894)}copy(t,e,r,i,s){return this}insert(t,e,r){return new $n(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class xn{constructor(t){this.comparator=t,this.data=new Ue(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,r)=>(t(e),!1)))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let r;for(r=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new FD(this.data.getIterator())}getIteratorFrom(t){return new FD(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((r=>{e=e.add(r)})),e}isEqual(t){if(!(t instanceof xn)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new xn(this.comparator);return e.data=t,e}}class FD{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Xr{constructor(t){this.fields=t,t.sort(Wn.comparator)}static empty(){return new Xr([])}unionWith(t){let e=new xn(Wn.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new Xr(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Dh(this.fields,t.fields,((e,r)=>e.isEqual(r)))}}class UL extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Xn{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new UL("Invalid base64 string: "+s):s}})(t);return new Xn(e)}static fromUint8Array(t){const e=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(t);return new Xn(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Zt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Xn.EMPTY_BYTE_STRING=new Xn("");const uG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fl(n){if(ie(!!n,39018),typeof n=="string"){let t=0;const e=uG.exec(n);if(ie(!!e,46558,{timestamp:n}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:nn(n.seconds),nanos:nn(n.nanos)}}function nn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function dl(n){return typeof n=="string"?Xn.fromBase64String(n):Xn.fromUint8Array(n)}const zL="server_timestamp",HL="__type__",$L="__previous_value__",qL="__local_write_time__";function XE(n){return(n?.mapValue?.fields||{})[HL]?.stringValue===zL}function gb(n){const t=n.mapValue.fields[$L];return XE(t)?gb(t):t}function xp(n){const t=fl(n.mapValue.fields[qL].timestampValue);return new we(t.seconds,t.nanos)}class hG{constructor(t,e,r,i,s,o,l,u,h,d,m){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=d,this.apiKey=m}}const j0="(default)";class Ep{constructor(t,e){this.projectId=t,this.database=e||j0}static empty(){return new Ep("","")}get isDefaultDatabase(){return this.database===j0}isEqual(t){return t instanceof Ep&&t.projectId===this.projectId&&t.database===this.database}}function fG(n,t){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new gt(it.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ep(n.options.projectId,t)}const GL="__type__",dG="__max__",oy={mapValue:{}},WL="__vector__",B0="value";function pl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?XE(n)?4:mG(n)?9007199254740991:pG(n)?10:11:Ot(28295,{value:n})}function Ys(n,t){if(n===t)return!0;const e=pl(n);if(e!==pl(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return xp(n).isEqual(xp(t));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=fl(i.timestampValue),l=fl(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(i,s){return dl(i.bytesValue).isEqual(dl(s.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(i,s){return nn(i.geoPointValue.latitude)===nn(s.geoPointValue.latitude)&&nn(i.geoPointValue.longitude)===nn(s.geoPointValue.longitude)})(n,t);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return nn(i.integerValue)===nn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=nn(i.doubleValue),l=nn(s.doubleValue);return o===l?V0(o)===V0(l):isNaN(o)&&isNaN(l)}return!1})(n,t);case 9:return Dh(n.arrayValue.values||[],t.arrayValue.values||[],Ys);case 10:case 11:return(function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(BD(o)!==BD(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Ys(o[u],l[u])))return!1;return!0})(n,t);default:return Ot(52216,{left:n})}}function Cp(n,t){return(n.values||[]).find((e=>Ys(e,t)))!==void 0}function Oh(n,t){if(n===t)return 0;const e=pl(n),r=pl(t);if(e!==r)return Zt(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return Zt(n.booleanValue,t.booleanValue);case 2:return(function(s,o){const l=nn(s.integerValue||s.doubleValue),u=nn(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,t);case 3:return UD(n.timestampValue,t.timestampValue);case 4:return UD(xp(n),xp(t));case 5:return Kw(n.stringValue,t.stringValue);case 6:return(function(s,o){const l=dl(s),u=dl(o);return l.compareTo(u)})(n.bytesValue,t.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const d=Zt(l[h],u[h]);if(d!==0)return d}return Zt(l.length,u.length)})(n.referenceValue,t.referenceValue);case 8:return(function(s,o){const l=Zt(nn(s.latitude),nn(o.latitude));return l!==0?l:Zt(nn(s.longitude),nn(o.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return zD(n.arrayValue,t.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[B0]?.arrayValue,d=u[B0]?.arrayValue,m=Zt(h?.values?.length||0,d?.values?.length||0);return m!==0?m:zD(h,d)})(n.mapValue,t.mapValue);case 11:return(function(s,o){if(s===oy.mapValue&&o===oy.mapValue)return 0;if(s===oy.mapValue)return 1;if(o===oy.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},d=Object.keys(h);u.sort(),d.sort();for(let m=0;m<u.length&&m<d.length;++m){const g=Kw(u[m],d[m]);if(g!==0)return g;const v=Oh(l[u[m]],h[d[m]]);if(v!==0)return v}return Zt(u.length,d.length)})(n.mapValue,t.mapValue);default:throw Ot(23264,{he:e})}}function UD(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return Zt(n,t);const e=fl(n),r=fl(t),i=Zt(e.seconds,r.seconds);return i!==0?i:Zt(e.nanos,r.nanos)}function zD(n,t){const e=n.values||[],r=t.values||[];for(let i=0;i<e.length&&i<r.length;++i){const s=Oh(e[i],r[i]);if(s)return s}return Zt(e.length,r.length)}function Ih(n){return Xw(n)}function Xw(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(e){const r=fl(e);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(e){return dl(e).toBase64()})(n.bytesValue):"referenceValue"in n?(function(e){return At.fromName(e).toString()})(n.referenceValue):"geoPointValue"in n?(function(e){return`geo(${e.latitude},${e.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(e){let r="[",i=!0;for(const s of e.values||[])i?i=!1:r+=",",r+=Xw(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(e){const r=Object.keys(e.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Xw(e.fields[o])}`;return i+"}"})(n.mapValue):Ot(61005,{value:n})}function o0(n){switch(pl(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=gb(n);return t?16+o0(t):16;case 5:return 2*n.stringValue.length;case 6:return dl(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+o0(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Rl(r.fields,((s,o)=>{i+=s.length+o0(o)})),i})(n.mapValue);default:throw Ot(13486,{value:n})}}function HD(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function Qw(n){return!!n&&"integerValue"in n}function QE(n){return!!n&&"arrayValue"in n}function $D(n){return!!n&&"nullValue"in n}function qD(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function a0(n){return!!n&&"mapValue"in n}function pG(n){return(n?.mapValue?.fields||{})[GL]?.stringValue===WL}function Yd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return Rl(n.mapValue.fields,((e,r)=>t.mapValue.fields[e]=Yd(r))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Yd(n.arrayValue.values[e]);return t}return{...n}}function mG(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===dG}class pr{constructor(t){this.value=t}static empty(){return new pr({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!a0(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Yd(e)}setAll(t){let e=Wn.emptyPath(),r={},i=[];t.forEach(((o,l)=>{if(!e.isImmediateParentOf(l)){const u=this.getFieldsMap(e);this.applyChanges(u,r,i),r={},i=[],e=l.popLast()}o?r[l.lastSegment()]=Yd(o):i.push(l.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,r,i)}delete(t){const e=this.field(t.popLast());a0(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Ys(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=e.mapValue.fields[t.get(r)];a0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,r){Rl(e,((i,s)=>t[i]=s));for(const i of r)delete t[i]}clone(){return new pr(Yd(this.value))}}function YL(n){const t=[];return Rl(n.fields,((e,r)=>{const i=new Wn([e]);if(a0(r)){const s=YL(r.mapValue).fields;if(s.length===0)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)})),new Xr(t)}class Dn{constructor(t,e,r,i,s,o,l){this.key=t,this.documentType=e,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(t){return new Dn(t,0,Nt.min(),Nt.min(),Nt.min(),pr.empty(),0)}static newFoundDocument(t,e,r,i){return new Dn(t,1,e,Nt.min(),r,i,0)}static newNoDocument(t,e){return new Dn(t,2,e,Nt.min(),Nt.min(),pr.empty(),0)}static newUnknownDocument(t,e){return new Dn(t,3,e,Nt.min(),Nt.min(),pr.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Nt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=pr.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Nt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Dn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Dn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class F0{constructor(t,e){this.position=t,this.inclusive=e}}function GD(n,t,e){let r=0;for(let i=0;i<n.position.length;i++){const s=t[i],o=n.position[i];if(s.field.isKeyField()?r=At.comparator(At.fromName(o.referenceValue),e.key):r=Oh(o,e.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function WD(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Ys(n.position[e],t.position[e]))return!1;return!0}class Ap{constructor(t,e="asc"){this.field=t,this.dir=e}}function gG(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class KL{}class yn extends KL{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,r):new vG(t,e,r):e==="array-contains"?new TG(t,r):e==="in"?new SG(t,r):e==="not-in"?new wG(t,r):e==="array-contains-any"?new xG(t,r):new yn(t,e,r)}static createKeyFieldInFilter(t,e,r){return e==="in"?new bG(t,r):new _G(t,r)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Oh(e,this.value)):e!==null&&pl(this.value)===pl(e)&&this.matchesComparison(Oh(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ls extends KL{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new ls(t,e)}matches(t){return XL(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function XL(n){return n.op==="and"}function QL(n){return yG(n)&&XL(n)}function yG(n){for(const t of n.filters)if(t instanceof ls)return!1;return!0}function Jw(n){if(n instanceof yn)return n.field.canonicalString()+n.op.toString()+Ih(n.value);if(QL(n))return n.filters.map((t=>Jw(t))).join(",");{const t=n.filters.map((e=>Jw(e))).join(",");return`${n.op}(${t})`}}function JL(n,t){return n instanceof yn?(function(r,i){return i instanceof yn&&r.op===i.op&&r.field.isEqual(i.field)&&Ys(r.value,i.value)})(n,t):n instanceof ls?(function(r,i){return i instanceof ls&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,o,l)=>s&&JL(o,i.filters[l])),!0):!1})(n,t):void Ot(19439)}function ZL(n){return n instanceof yn?(function(e){return`${e.field.canonicalString()} ${e.op} ${Ih(e.value)}`})(n):n instanceof ls?(function(e){return e.op.toString()+" {"+e.getFilters().map(ZL).join(" ,")+"}"})(n):"Filter"}class vG extends yn{constructor(t,e,r){super(t,e,r),this.key=At.fromName(r.referenceValue)}matches(t){const e=At.comparator(t.key,this.key);return this.matchesComparison(e)}}class bG extends yn{constructor(t,e){super(t,"in",e),this.keys=tV("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class _G extends yn{constructor(t,e){super(t,"not-in",e),this.keys=tV("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function tV(n,t){return(t.arrayValue?.values||[]).map((e=>At.fromName(e.referenceValue)))}class TG extends yn{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return QE(e)&&Cp(e.arrayValue,this.value)}}class SG extends yn{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Cp(this.value.arrayValue,e)}}class wG extends yn{constructor(t,e){super(t,"not-in",e)}matches(t){if(Cp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Cp(this.value.arrayValue,e)}}class xG extends yn{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!QE(e)||!e.arrayValue.values)&&e.arrayValue.values.some((r=>Cp(this.value.arrayValue,r)))}}class EG{constructor(t,e=null,r=[],i=[],s=null,o=null,l=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function YD(n,t=null,e=[],r=[],i=null,s=null,o=null){return new EG(n,t,e,r,i,s,o)}function JE(n){const t=Bt(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((r=>Jw(r))).join(","),e+="|ob:",e+=t.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),um(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((r=>Ih(r))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((r=>Ih(r))).join(",")),t.Te=e}return t.Te}function ZE(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!gG(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!JL(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!WD(n.startAt,t.startAt)&&WD(n.endAt,t.endAt)}function Zw(n){return At.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Zh{constructor(t,e=null,r=[],i=[],s=null,o="F",l=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function CG(n,t,e,r,i,s,o,l){return new Zh(n,t,e,r,i,s,o,l)}function t1(n){return new Zh(n)}function KD(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function AG(n){return At.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function eV(n){return n.collectionGroup!==null}function Kd(n){const t=Bt(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const s of t.explicitOrderBy)t.Ie.push(s),e.add(s.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new xn(Wn.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(t).forEach((s=>{e.has(s.canonicalString())||s.isKeyField()||t.Ie.push(new Ap(s,r))})),e.has(Wn.keyField().canonicalString())||t.Ie.push(new Ap(Wn.keyField(),r))}return t.Ie}function Hs(n){const t=Bt(n);return t.Ee||(t.Ee=kG(t,Kd(n))),t.Ee}function kG(n,t){if(n.limitType==="F")return YD(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new Ap(i.field,s)}));const e=n.endAt?new F0(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new F0(n.startAt.position,n.startAt.inclusive):null;return YD(n.path,n.collectionGroup,t,n.filters,n.limit,e,r)}}function tx(n,t){const e=n.filters.concat([t]);return new Zh(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function RG(n,t){const e=n.explicitOrderBy.concat([t]);return new Zh(n.path,n.collectionGroup,e,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function U0(n,t,e){return new Zh(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function yb(n,t){return ZE(Hs(n),Hs(t))&&n.limitType===t.limitType}function nV(n){return`${JE(Hs(n))}|lt:${n.limitType}`}function nh(n){return`Query(target=${(function(e){let r=e.path.canonicalString();return e.collectionGroup!==null&&(r+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(r+=`, filters: [${e.filters.map((i=>ZL(i))).join(", ")}]`),um(e.limit)||(r+=", limit: "+e.limit),e.orderBy.length>0&&(r+=`, orderBy: [${e.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),e.startAt&&(r+=", startAt: ",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((i=>Ih(i))).join(",")),e.endAt&&(r+=", endAt: ",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((i=>Ih(i))).join(",")),`Target(${r})`})(Hs(n))}; limitType=${n.limitType})`}function vb(n,t){return t.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):At.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,t)&&(function(r,i){for(const s of Kd(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,t)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,t)&&(function(r,i){return!(r.startAt&&!(function(o,l,u){const h=GD(o,l,u);return o.inclusive?h<=0:h<0})(r.startAt,Kd(r),i)||r.endAt&&!(function(o,l,u){const h=GD(o,l,u);return o.inclusive?h>=0:h>0})(r.endAt,Kd(r),i))})(n,t)}function MG(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function rV(n){return(t,e)=>{let r=!1;for(const i of Kd(n)){const s=DG(i,t,e);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function DG(n,t,e){const r=n.field.isKeyField()?At.comparator(t.key,e.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?Oh(u,h):Ot(42886)})(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ot(19790,{direction:n.dir})}}class ou{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,e){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,e]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[e]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Rl(this.inner,((e,r)=>{for(const[i,s]of r)t(i,s)}))}isEmpty(){return FL(this.inner)}size(){return this.innerSize}}const OG=new Ue(At.comparator);function qo(){return OG}const iV=new Ue(At.comparator);function Ld(...n){let t=iV;for(const e of n)t=t.insert(e.key,e);return t}function sV(n){let t=iV;return n.forEach(((e,r)=>t=t.insert(e,r.overlayedDocument))),t}function xc(){return Xd()}function oV(){return Xd()}function Xd(){return new ou((n=>n.toString()),((n,t)=>n.isEqual(t)))}const IG=new Ue(At.comparator),PG=new xn(At.comparator);function te(...n){let t=PG;for(const e of n)t=t.add(e);return t}const NG=new xn(Zt);function LG(){return NG}function e1(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:V0(t)?"-0":t}}function aV(n){return{integerValue:""+n}}function VG(n,t){return aG(t)?aV(t):e1(n,t)}class bb{constructor(){this._=void 0}}function jG(n,t,e){return n instanceof kp?(function(i,s){const o={fields:{[HL]:{stringValue:zL},[qL]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&XE(s)&&(s=gb(s)),s&&(o.fields[$L]=s),{mapValue:o}})(e,t):n instanceof Rp?cV(n,t):n instanceof Mp?uV(n,t):(function(i,s){const o=lV(i,s),l=XD(o)+XD(i.Ae);return Qw(o)&&Qw(i.Ae)?aV(l):e1(i.serializer,l)})(n,t)}function BG(n,t,e){return n instanceof Rp?cV(n,t):n instanceof Mp?uV(n,t):e}function lV(n,t){return n instanceof z0?(function(r){return Qw(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(t)?t:{integerValue:0}:null}class kp extends bb{}class Rp extends bb{constructor(t){super(),this.elements=t}}function cV(n,t){const e=hV(t);for(const r of n.elements)e.some((i=>Ys(i,r)))||e.push(r);return{arrayValue:{values:e}}}class Mp extends bb{constructor(t){super(),this.elements=t}}function uV(n,t){let e=hV(t);for(const r of n.elements)e=e.filter((i=>!Ys(i,r)));return{arrayValue:{values:e}}}class z0 extends bb{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function XD(n){return nn(n.integerValue||n.doubleValue)}function hV(n){return QE(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class FG{constructor(t,e){this.field=t,this.transform=e}}function UG(n,t){return n.field.isEqual(t.field)&&(function(r,i){return r instanceof Rp&&i instanceof Rp||r instanceof Mp&&i instanceof Mp?Dh(r.elements,i.elements,Ys):r instanceof z0&&i instanceof z0?Ys(r.Ae,i.Ae):r instanceof kp&&i instanceof kp})(n.transform,t.transform)}class zG{constructor(t,e){this.version=t,this.transformResults=e}}class mr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new mr}static exists(t){return new mr(void 0,t)}static updateTime(t){return new mr(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function l0(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class _b{}function fV(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new n1(n.key,mr.none()):new hm(n.key,n.data,mr.none());{const e=n.data,r=pr.empty();let i=new xn(Wn.comparator);for(let s of t.fields)if(!i.has(s)){let o=e.field(s);o===null&&s.length>1&&(s=s.popLast(),o=e.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ml(n.key,r,new Xr(i.toArray()),mr.none())}}function HG(n,t,e){n instanceof hm?(function(i,s,o){const l=i.value.clone(),u=JD(i.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,t,e):n instanceof Ml?(function(i,s,o){if(!l0(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=JD(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(dV(i)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,t,e):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,t,e)}function Qd(n,t,e,r){return n instanceof hm?(function(s,o,l,u){if(!l0(s.precondition,o))return l;const h=s.value.clone(),d=ZD(s.fieldTransforms,u,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,t,e,r):n instanceof Ml?(function(s,o,l,u){if(!l0(s.precondition,o))return l;const h=ZD(s.fieldTransforms,u,o),d=o.data;return d.setAll(dV(s)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((m=>m.field)))})(n,t,e,r):(function(s,o,l){return l0(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,t,e)}function $G(n,t){let e=null;for(const r of n.fieldTransforms){const i=t.data.field(r.field),s=lV(r.transform,i||null);s!=null&&(e===null&&(e=pr.empty()),e.set(r.field,s))}return e||null}function QD(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Dh(r,i,((s,o)=>UG(s,o)))})(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class hm extends _b{constructor(t,e,r,i=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ml extends _b{constructor(t,e,r,i,s=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function dV(n){const t=new Map;return n.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}})),t}function JD(n,t,e){const r=new Map;ie(n.length===e.length,32656,{Ve:e.length,de:n.length});for(let i=0;i<e.length;i++){const s=n[i],o=s.transform,l=t.data.field(s.field);r.set(s.field,BG(o,l,e[i]))}return r}function ZD(n,t,e){const r=new Map;for(const i of n){const s=i.transform,o=e.data.field(i.field);r.set(i.field,jG(s,o,t))}return r}class n1 extends _b{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class pV extends _b{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qG{constructor(t,e,r,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&HG(s,t,r[i])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=Qd(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=Qd(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=oV();return this.mutations.forEach((i=>{const s=t.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=e.has(i.key)?null:l;const u=fV(o,l);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Nt.min())})),r}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),te())}isEqual(t){return this.batchId===t.batchId&&Dh(this.mutations,t.mutations,((e,r)=>QD(e,r)))&&Dh(this.baseMutations,t.baseMutations,((e,r)=>QD(e,r)))}}class r1{constructor(t,e,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=i}static from(t,e,r){ie(t.mutations.length===r.length,58842,{me:t.mutations.length,fe:r.length});let i=(function(){return IG})();const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new r1(t,e,r,i)}}class GG{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class WG{constructor(t,e){this.count=t,this.unchangedNames=e}}var mn,re;function mV(n){switch(n){case it.OK:return Ot(64938);case it.CANCELLED:case it.UNKNOWN:case it.DEADLINE_EXCEEDED:case it.RESOURCE_EXHAUSTED:case it.INTERNAL:case it.UNAVAILABLE:case it.UNAUTHENTICATED:return!1;case it.INVALID_ARGUMENT:case it.NOT_FOUND:case it.ALREADY_EXISTS:case it.PERMISSION_DENIED:case it.FAILED_PRECONDITION:case it.ABORTED:case it.OUT_OF_RANGE:case it.UNIMPLEMENTED:case it.DATA_LOSS:return!0;default:return Ot(15467,{code:n})}}function gV(n){if(n===void 0)return $o("GRPC error has no .code"),it.UNKNOWN;switch(n){case mn.OK:return it.OK;case mn.CANCELLED:return it.CANCELLED;case mn.UNKNOWN:return it.UNKNOWN;case mn.DEADLINE_EXCEEDED:return it.DEADLINE_EXCEEDED;case mn.RESOURCE_EXHAUSTED:return it.RESOURCE_EXHAUSTED;case mn.INTERNAL:return it.INTERNAL;case mn.UNAVAILABLE:return it.UNAVAILABLE;case mn.UNAUTHENTICATED:return it.UNAUTHENTICATED;case mn.INVALID_ARGUMENT:return it.INVALID_ARGUMENT;case mn.NOT_FOUND:return it.NOT_FOUND;case mn.ALREADY_EXISTS:return it.ALREADY_EXISTS;case mn.PERMISSION_DENIED:return it.PERMISSION_DENIED;case mn.FAILED_PRECONDITION:return it.FAILED_PRECONDITION;case mn.ABORTED:return it.ABORTED;case mn.OUT_OF_RANGE:return it.OUT_OF_RANGE;case mn.UNIMPLEMENTED:return it.UNIMPLEMENTED;case mn.DATA_LOSS:return it.DATA_LOSS;default:return Ot(39323,{code:n})}}(re=mn||(mn={}))[re.OK=0]="OK",re[re.CANCELLED=1]="CANCELLED",re[re.UNKNOWN=2]="UNKNOWN",re[re.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",re[re.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",re[re.NOT_FOUND=5]="NOT_FOUND",re[re.ALREADY_EXISTS=6]="ALREADY_EXISTS",re[re.PERMISSION_DENIED=7]="PERMISSION_DENIED",re[re.UNAUTHENTICATED=16]="UNAUTHENTICATED",re[re.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",re[re.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",re[re.ABORTED=10]="ABORTED",re[re.OUT_OF_RANGE=11]="OUT_OF_RANGE",re[re.UNIMPLEMENTED=12]="UNIMPLEMENTED",re[re.INTERNAL=13]="INTERNAL",re[re.UNAVAILABLE=14]="UNAVAILABLE",re[re.DATA_LOSS=15]="DATA_LOSS";function YG(){return new TextEncoder}const KG=new rl([4294967295,4294967295],0);function tO(n){const t=YG().encode(n),e=new RL;return e.update(t),new Uint8Array(e.digest())}function eO(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new rl([e,r],0),new rl([i,s],0)]}class i1{constructor(t,e,r){if(this.bitmap=t,this.padding=e,this.hashCount=r,e<0||e>=8)throw new Vd(`Invalid padding: ${e}`);if(r<0)throw new Vd(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Vd(`Invalid hash count: ${r}`);if(t.length===0&&e!==0)throw new Vd(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=rl.fromNumber(this.ge)}ye(t,e,r){let i=t.add(e.multiply(rl.fromNumber(r)));return i.compare(KG)===1&&(i=new rl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=tO(t),[r,i]=eO(e);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(t,e,r){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new i1(s,i,e);return r.forEach((l=>o.insert(l))),o}insert(t){if(this.ge===0)return;const e=tO(t),[r,i]=eO(e);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.be(o)}}be(t){const e=Math.floor(t/8),r=t%8;this.bitmap[e]|=1<<r}}class Vd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Tb{constructor(t,e,r,i,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const i=new Map;return i.set(t,fm.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new Tb(Nt.min(),i,new Ue(Zt),qo(),te())}}class fm{constructor(t,e,r,i,s){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new fm(r,e,te(),te(),te())}}class c0{constructor(t,e,r,i){this.Se=t,this.removedTargetIds=e,this.key=r,this.De=i}}class yV{constructor(t,e){this.targetId=t,this.Ce=e}}class vV{constructor(t,e,r=Xn.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=i}}class nO{constructor(){this.ve=0,this.Fe=rO(),this.Me=Xn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=te(),e=te(),r=te();return this.Fe.forEach(((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:r=r.add(i);break;default:Ot(38017,{changeType:s})}})),new fm(this.Me,this.xe,t,e,r)}Ke(){this.Oe=!1,this.Fe=rO()}qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}Ue(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}$e(){this.ve+=1}We(){this.ve-=1,ie(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class XG{constructor(t){this.Ge=t,this.ze=new Map,this.je=qo(),this.He=ay(),this.Je=ay(),this.Ze=new Ue(Zt)}Xe(t){for(const e of t.Se)t.De&&t.De.isFoundDocument()?this.Ye(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const r=this.nt(e);switch(t.state){case 0:this.rt(e)&&r.Le(t.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(t.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(r.Qe(),r.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),r.Le(t.resumeToken));break;default:Ot(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((r,i)=>{this.rt(i)&&e(i)}))}st(t){const e=t.targetId,r=t.Ce.count,i=this.ot(e);if(i){const s=i.target;if(Zw(s))if(r===0){const o=new At(s.path);this.et(e,o,Dn.newNoDocument(o,Nt.min()))}else ie(r===1,20013,{expectedCount:r});else{const o=this._t(e);if(o!==r){const l=this.ut(t),u=l?this.ct(l,t,o):1;if(u!==0){this.it(e);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(e,h)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=e;let o,l;try{o=dl(r).toUint8Array()}catch(u){if(u instanceof UL)return Yc("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new i1(o,i,s)}catch(u){return Yc(u instanceof Vd?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(t,e,r){return e.Ce.count===r-this.Pt(t,e.targetId)?0:2}Pt(t,e){const r=this.Ge.getRemoteKeysForTarget(e);let i=0;return r.forEach((s=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(l)||(this.et(e,s,null),i++)})),i}Tt(t){const e=new Map;this.ze.forEach(((s,o)=>{const l=this.ot(o);if(l){if(s.current&&Zw(l.target)){const u=new At(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Dn.newNoDocument(u,t))}s.Be&&(e.set(o,s.ke()),s.Ke())}}));let r=te();this.Je.forEach(((s,o)=>{let l=!0;o.forEachWhile((u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(r=r.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(t)));const i=new Tb(t,e,this.Ze,this.je,r);return this.je=qo(),this.He=ay(),this.Je=ay(),this.Ze=new Ue(Zt),i}Ye(t,e){if(!this.rt(t))return;const r=this.Et(t,e.key)?2:0;this.nt(t).qe(e.key,r),this.je=this.je.insert(e.key,e),this.He=this.He.insert(e.key,this.It(e.key).add(t)),this.Je=this.Je.insert(e.key,this.Rt(e.key).add(t))}et(t,e,r){if(!this.rt(t))return;const i=this.nt(t);this.Et(t,e)?i.qe(e,1):i.Ue(e),this.Je=this.Je.insert(e,this.Rt(e).delete(t)),this.Je=this.Je.insert(e,this.Rt(e).add(t)),r&&(this.je=this.je.insert(e,r))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}$e(t){this.nt(t).$e()}nt(t){let e=this.ze.get(t);return e||(e=new nO,this.ze.set(t,e)),e}Rt(t){let e=this.Je.get(t);return e||(e=new xn(Zt),this.Je=this.Je.insert(t,e)),e}It(t){let e=this.He.get(t);return e||(e=new xn(Zt),this.He=this.He.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||bt("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new nO),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function ay(){return new Ue(At.comparator)}function rO(){return new Ue(At.comparator)}const QG={asc:"ASCENDING",desc:"DESCENDING"},JG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ZG={and:"AND",or:"OR"};class t7{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function ex(n,t){return n.useProto3Json||um(t)?t:{value:t}}function H0(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function bV(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function e7(n,t){return H0(n,t.toTimestamp())}function Jr(n){return ie(!!n,49232),Nt.fromTimestamp((function(e){const r=fl(e);return new we(r.seconds,r.nanos)})(n))}function s1(n,t){return nx(n,t).canonicalString()}function nx(n,t){const e=(function(i){return new Se(["projects",i.projectId,"databases",i.database])})(n).child("documents");return t===void 0?e:e.child(t)}function _V(n){const t=Se.fromString(n);return ie(CV(t),10190,{key:t.toString()}),t}function $0(n,t){return s1(n.databaseId,t.path)}function Jd(n,t){const e=_V(t);if(e.get(1)!==n.databaseId.projectId)throw new gt(it.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new gt(it.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new At(SV(e))}function TV(n,t){return s1(n.databaseId,t)}function n7(n){const t=_V(n);return t.length===4?Se.emptyPath():SV(t)}function rx(n){return new Se(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function SV(n){return ie(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function iO(n,t,e){return{name:$0(n,t),fields:e.value.mapValue.fields}}function r7(n,t){return"found"in t?(function(r,i){ie(!!i.found,43571),i.found.name,i.found.updateTime;const s=Jd(r,i.found.name),o=Jr(i.found.updateTime),l=i.found.createTime?Jr(i.found.createTime):Nt.min(),u=new pr({mapValue:{fields:i.found.fields}});return Dn.newFoundDocument(s,o,l,u)})(n,t):"missing"in t?(function(r,i){ie(!!i.missing,3894),ie(!!i.readTime,22933);const s=Jd(r,i.missing),o=Jr(i.readTime);return Dn.newNoDocument(s,o)})(n,t):Ot(7234,{result:t})}function i7(n,t){let e;if("targetChange"in t){t.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Ot(39313,{state:h})})(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=(function(h,d){return h.useProto3Json?(ie(d===void 0||typeof d=="string",58123),Xn.fromBase64String(d||"")):(ie(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Xn.fromUint8Array(d||new Uint8Array))})(n,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&(function(h){const d=h.code===void 0?it.UNKNOWN:gV(h.code);return new gt(d,h.message||"")})(o);e=new vV(r,i,s,l||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Jd(n,r.document.name),s=Jr(r.document.updateTime),o=r.document.createTime?Jr(r.document.createTime):Nt.min(),l=new pr({mapValue:{fields:r.document.fields}}),u=Dn.newFoundDocument(i,s,o,l),h=r.targetIds||[],d=r.removedTargetIds||[];e=new c0(h,d,u.key,u)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Jd(n,r.document),s=r.readTime?Jr(r.readTime):Nt.min(),o=Dn.newNoDocument(i,s),l=r.removedTargetIds||[];e=new c0([],l,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Jd(n,r.document),s=r.removedTargetIds||[];e=new c0([],s,i,null)}else{if(!("filter"in t))return Ot(11601,{Vt:t});{t.filter;const r=t.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new WG(i,s),l=r.targetId;e=new yV(l,o)}}return e}function wV(n,t){let e;if(t instanceof hm)e={update:iO(n,t.key,t.value)};else if(t instanceof n1)e={delete:$0(n,t.key)};else if(t instanceof Ml)e={update:iO(n,t.key,t.data),updateMask:d7(t.fieldMask)};else{if(!(t instanceof pV))return Ot(16599,{dt:t.type});e={verify:$0(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((r=>(function(s,o){const l=o.transform;if(l instanceof kp)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Rp)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Mp)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof z0)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Ot(20930,{transform:o.transform})})(0,r)))),t.precondition.isNone||(e.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:e7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ot(27497)})(n,t.precondition)),e}function s7(n,t){return n&&n.length>0?(ie(t!==void 0,14353),n.map((e=>(function(i,s){let o=i.updateTime?Jr(i.updateTime):Jr(s);return o.isEqual(Nt.min())&&(o=Jr(s)),new zG(o,i.transformResults||[])})(e,t)))):[]}function o7(n,t){return{documents:[TV(n,t.path)]}}function a7(n,t){const e={structuredQuery:{}},r=t.path;let i;t.collectionGroup!==null?(i=r,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),e.structuredQuery.from=[{collectionId:r.lastSegment()}]),e.parent=TV(n,i);const s=(function(h){if(h.length!==0)return EV(ls.create(h,"and"))})(t.filters);s&&(e.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((d=>(function(g){return{field:rh(g.field),direction:u7(g.dir)}})(d)))})(t.orderBy);o&&(e.structuredQuery.orderBy=o);const l=ex(n,t.limit);return l!==null&&(e.structuredQuery.limit=l),t.startAt&&(e.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(t.endAt)),{ft:e,parent:i}}function l7(n){let t=n7(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let i=null;if(r>0){ie(r===1,65062);const d=e.from[0];d.allDescendants?i=d.collectionId:t=t.child(d.collectionId)}let s=[];e.where&&(s=(function(m){const g=xV(m);return g instanceof ls&&QL(g)?g.getFilters():[g]})(e.where));let o=[];e.orderBy&&(o=(function(m){return m.map((g=>(function(T){return new Ap(ih(T.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(g)))})(e.orderBy));let l=null;e.limit&&(l=(function(m){let g;return g=typeof m=="object"?m.value:m,um(g)?null:g})(e.limit));let u=null;e.startAt&&(u=(function(m){const g=!!m.before,v=m.values||[];return new F0(v,g)})(e.startAt));let h=null;return e.endAt&&(h=(function(m){const g=!m.before,v=m.values||[];return new F0(v,g)})(e.endAt)),CG(t,i,o,s,l,"F",u,h)}function c7(n,t){const e=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ot(28987,{purpose:i})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function xV(n){return n.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const r=ih(e.unaryFilter.field);return yn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ih(e.unaryFilter.field);return yn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ih(e.unaryFilter.field);return yn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ih(e.unaryFilter.field);return yn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ot(61313);default:return Ot(60726)}})(n):n.fieldFilter!==void 0?(function(e){return yn.create(ih(e.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ot(58110);default:return Ot(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(e){return ls.create(e.compositeFilter.filters.map((r=>xV(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ot(1026)}})(e.compositeFilter.op))})(n):Ot(30097,{filter:n})}function u7(n){return QG[n]}function h7(n){return JG[n]}function f7(n){return ZG[n]}function rh(n){return{fieldPath:n.canonicalString()}}function ih(n){return Wn.fromServerFormat(n.fieldPath)}function EV(n){return n instanceof yn?(function(e){if(e.op==="=="){if(qD(e.value))return{unaryFilter:{field:rh(e.field),op:"IS_NAN"}};if($D(e.value))return{unaryFilter:{field:rh(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(qD(e.value))return{unaryFilter:{field:rh(e.field),op:"IS_NOT_NAN"}};if($D(e.value))return{unaryFilter:{field:rh(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rh(e.field),op:h7(e.op),value:e.value}}})(n):n instanceof ls?(function(e){const r=e.getFilters().map((i=>EV(i)));return r.length===1?r[0]:{compositeFilter:{op:f7(e.op),filters:r}}})(n):Ot(54877,{filter:n})}function d7(n){const t=[];return n.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function CV(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function AV(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class Xa{constructor(t,e,r,i,s=Nt.min(),o=Nt.min(),l=Xn.EMPTY_BYTE_STRING,u=null){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(t){return new Xa(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class p7{constructor(t){this.yt=t}}function m7(n){const t=l7({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?U0(t,t.limit,"L"):t}class g7{constructor(){this.Sn=new y7}addToCollectionParentIndex(t,e){return this.Sn.add(e),ct.resolve()}getCollectionParents(t,e){return ct.resolve(this.Sn.getEntries(e))}addFieldIndex(t,e){return ct.resolve()}deleteFieldIndex(t,e){return ct.resolve()}deleteAllFieldIndexes(t){return ct.resolve()}createTargetIndexes(t,e){return ct.resolve()}getDocumentsMatchingTarget(t,e){return ct.resolve(null)}getIndexType(t,e){return ct.resolve(0)}getFieldIndexes(t,e){return ct.resolve([])}getNextCollectionGroupToUpdate(t){return ct.resolve(null)}getMinOffset(t,e){return ct.resolve(hl.min())}getMinOffsetFromCollectionGroup(t,e){return ct.resolve(hl.min())}updateCollectionGroup(t,e,r){return ct.resolve()}updateIndexEntries(t,e){return ct.resolve()}}class y7{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),i=this.index[e]||new xn(Se.comparator),s=!i.has(r);return this.index[e]=i.add(r),s}has(t){const e=t.lastSegment(),r=t.popLast(),i=this.index[e];return i&&i.has(r)}getEntries(t){return(this.index[t]||new xn(Se.comparator)).toArray()}}const sO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kV=41943040;class Mr{static withCacheSize(t){return new Mr(t,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}}Mr.DEFAULT_COLLECTION_PERCENTILE=10,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mr.DEFAULT=new Mr(kV,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mr.DISABLED=new Mr(-1,0,0);class Ph{constructor(t){this.sr=t}next(){return this.sr+=2,this.sr}static _r(){return new Ph(0)}static ar(){return new Ph(-1)}}const oO="LruGarbageCollector",v7=1048576;function aO([n,t],[e,r]){const i=Zt(n,e);return i===0?Zt(t,r):i}class b7{constructor(t){this.Pr=t,this.buffer=new xn(aO),this.Tr=0}Ir(){return++this.Tr}Er(t){const e=[t,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(e);else{const r=this.buffer.last();aO(e,r)<0&&(this.buffer=this.buffer.delete(r).add(e))}}get maxValue(){return this.buffer.last()[0]}}class _7{constructor(t,e,r){this.garbageCollector=t,this.asyncQueue=e,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(t){bt(oO,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Jh(e)?bt(oO,"Ignoring IndexedDB error during garbage collection: ",e):await Qh(e)}await this.Ar(3e5)}))}}class T7{constructor(t,e){this.Vr=t,this.params=e}calculateTargetCount(t,e){return this.Vr.dr(t).next((r=>Math.floor(e/100*r)))}nthSequenceNumber(t,e){if(e===0)return ct.resolve(mb.ce);const r=new b7(e);return this.Vr.forEachTarget(t,(i=>r.Er(i.sequenceNumber))).next((()=>this.Vr.mr(t,(i=>r.Er(i))))).next((()=>r.maxValue))}removeTargets(t,e,r){return this.Vr.removeTargets(t,e,r)}removeOrphanedDocuments(t,e){return this.Vr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(bt("LruGarbageCollector","Garbage collection skipped; disabled"),ct.resolve(sO)):this.getCacheSize(t).next((r=>r<this.params.cacheSizeCollectionThreshold?(bt("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sO):this.gr(t,e)))}getCacheSize(t){return this.Vr.getCacheSize(t)}gr(t,e){let r,i,s,o,l,u,h;const d=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(bt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(t,i)))).next((m=>(r=m,l=Date.now(),this.removeTargets(t,r,e)))).next((m=>(s=m,u=Date.now(),this.removeOrphanedDocuments(t,r)))).next((m=>(h=Date.now(),eh()<=Jt.DEBUG&&bt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${m} documents in `+(h-u)+`ms
Total Duration: ${h-d}ms`),ct.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m}))))}}function S7(n,t){return new T7(n,t)}class w7{constructor(){this.changes=new ou((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Dn.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return r!==void 0?ct.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class x7{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class E7{constructor(t,e,r,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(r=i,this.remoteDocumentCache.getEntry(t,e)))).next((i=>(r!==null&&Qd(r.mutation,i,Xr.empty(),we.now()),i)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((r=>this.getLocalViewOfDocuments(t,r,te()).next((()=>r))))}getLocalViewOfDocuments(t,e,r=te()){const i=xc();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,r).next((s=>{let o=Ld();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(t,e){const r=xc();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,te())))}populateOverlays(t,e,r){const i=[];return r.forEach((s=>{e.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(t,i).next((s=>{s.forEach(((o,l)=>{e.set(o,l)}))}))}computeViews(t,e,r,i){let s=qo();const o=Xd(),l=(function(){return Xd()})();return e.forEach(((u,h)=>{const d=r.get(h.key);i.has(h.key)&&(d===void 0||d.mutation instanceof Ml)?s=s.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),Qd(d.mutation,h,d.mutation.getFieldMask(),we.now())):o.set(h.key,Xr.empty())})),this.recalculateAndSaveOverlays(t,s).next((u=>(u.forEach(((h,d)=>o.set(h,d))),e.forEach(((h,d)=>l.set(h,new x7(d,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(t,e){const r=Xd();let i=new Ue(((o,l)=>o-l)),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=e.get(u);if(h===null)return;let d=r.get(u)||Xr.empty();d=l.applyToLocalView(h,d),r.set(u,d);const m=(i.get(l.batchId)||te()).add(u);i=i.insert(l.batchId,m)}))})).next((()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,d=u.value,m=oV();d.forEach((g=>{if(!s.has(g)){const v=fV(e.get(g),r.get(g));v!==null&&m.set(g,v),s=s.add(g)}})),o.push(this.documentOverlayCache.saveOverlays(t,h,m))}return ct.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((r=>this.recalculateAndSaveOverlays(t,r)))}getDocumentsMatchingQuery(t,e,r,i){return AG(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):eV(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r,i):this.getDocumentsMatchingCollectionQuery(t,e,r,i)}getNextDocuments(t,e,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,i).next((s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,i-s.size):ct.resolve(xc());let l=wp,u=s;return o.next((h=>ct.forEach(h,((d,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),s.get(d)?ct.resolve():this.remoteDocumentCache.getEntry(t,d).next((g=>{u=u.insert(d,g)}))))).next((()=>this.populateOverlays(t,h,s))).next((()=>this.computeViews(t,u,h,te()))).next((d=>({batchId:l,changes:sV(d)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new At(e)).next((r=>{let i=Ld();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(t,e,r,i){const s=e.collectionGroup;let o=Ld();return this.indexManager.getCollectionParents(t,s).next((l=>ct.forEach(l,(u=>{const h=(function(m,g){return new Zh(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(e,u.child(s));return this.getDocumentsMatchingCollectionQuery(t,h,r,i).next((d=>{d.forEach(((m,g)=>{o=o.insert(m,g)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(t,e,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,r,s,i)))).next((o=>{s.forEach(((u,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Dn.newInvalidDocument(d)))}));let l=Ld();return o.forEach(((u,h)=>{const d=s.get(u);d!==void 0&&Qd(d.mutation,h,Xr.empty(),we.now()),vb(e,h)&&(l=l.insert(u,h))})),l}))}}class C7{constructor(t){this.serializer=t,this.Nr=new Map,this.Br=new Map}getBundleMetadata(t,e){return ct.resolve(this.Nr.get(e))}saveBundleMetadata(t,e){return this.Nr.set(e.id,(function(i){return{id:i.id,version:i.version,createTime:Jr(i.createTime)}})(e)),ct.resolve()}getNamedQuery(t,e){return ct.resolve(this.Br.get(e))}saveNamedQuery(t,e){return this.Br.set(e.name,(function(i){return{name:i.name,query:m7(i.bundledQuery),readTime:Jr(i.readTime)}})(e)),ct.resolve()}}class A7{constructor(){this.overlays=new Ue(At.comparator),this.Lr=new Map}getOverlay(t,e){return ct.resolve(this.overlays.get(e))}getOverlays(t,e){const r=xc();return ct.forEach(e,(i=>this.getOverlay(t,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(t,e,r){return r.forEach(((i,s)=>{this.bt(t,e,s)})),ct.resolve()}removeOverlaysForBatchId(t,e,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.Lr.delete(r)),ct.resolve()}getOverlaysForCollection(t,e,r){const i=xc(),s=e.length+1,o=new At(e.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!e.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return ct.resolve(i)}getOverlaysForCollectionGroup(t,e,r,i){let s=new Ue(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===e&&h.largestBatchId>r){let d=s.get(h.largestBatchId);d===null&&(d=xc(),s=s.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const l=xc(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,d)=>l.set(h,d))),!(l.size()>=i)););return ct.resolve(l)}bt(t,e,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new GG(e,r));let s=this.Lr.get(e);s===void 0&&(s=te(),this.Lr.set(e,s)),this.Lr.set(e,s.add(r.key))}}class k7{constructor(){this.sessionToken=Xn.EMPTY_BYTE_STRING}getSessionToken(t){return ct.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,ct.resolve()}}class o1{constructor(){this.kr=new xn(Mn.Kr),this.qr=new xn(Mn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(t,e){const r=new Mn(t,e);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(t,e){t.forEach((r=>this.addReference(r,e)))}removeReference(t,e){this.Wr(new Mn(t,e))}Qr(t,e){t.forEach((r=>this.removeReference(r,e)))}Gr(t){const e=new At(new Se([])),r=new Mn(e,t),i=new Mn(e,t+1),s=[];return this.qr.forEachInRange([r,i],(o=>{this.Wr(o),s.push(o.key)})),s}zr(){this.kr.forEach((t=>this.Wr(t)))}Wr(t){this.kr=this.kr.delete(t),this.qr=this.qr.delete(t)}jr(t){const e=new At(new Se([])),r=new Mn(e,t),i=new Mn(e,t+1);let s=te();return this.qr.forEachInRange([r,i],(o=>{s=s.add(o.key)})),s}containsKey(t){const e=new Mn(t,0),r=this.kr.firstAfterOrEqual(e);return r!==null&&t.isEqual(r.key)}}class Mn{constructor(t,e){this.key=t,this.Hr=e}static Kr(t,e){return At.comparator(t.key,e.key)||Zt(t.Hr,e.Hr)}static Ur(t,e){return Zt(t.Hr,e.Hr)||At.comparator(t.key,e.key)}}class R7{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.Yn=1,this.Jr=new xn(Mn.Kr)}checkEmpty(t){return ct.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,r,i){const s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new qG(s,e,r,i);this.mutationQueue.push(o);for(const l of i)this.Jr=this.Jr.add(new Mn(l.key,s)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast());return ct.resolve(o)}lookupMutationBatch(t,e){return ct.resolve(this.Zr(e))}getNextMutationBatchAfterBatchId(t,e){const r=e+1,i=this.Xr(r),s=i<0?0:i;return ct.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ct.resolve(this.mutationQueue.length===0?KE:this.Yn-1)}getAllMutationBatches(t){return ct.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new Mn(e,0),i=new Mn(e,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([r,i],(o=>{const l=this.Zr(o.Hr);s.push(l)})),ct.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new xn(Zt);return e.forEach((i=>{const s=new Mn(i,0),o=new Mn(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],(l=>{r=r.add(l.Hr)}))})),ct.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,i=r.length+1;let s=r;At.isDocumentKey(s)||(s=s.child(""));const o=new Mn(new At(s),0);let l=new xn(Zt);return this.Jr.forEachWhile((u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(l=l.add(u.Hr)),!0)}),o),ct.resolve(this.Yr(l))}Yr(t){const e=[];return t.forEach((r=>{const i=this.Zr(r);i!==null&&e.push(i)})),e}removeMutationBatch(t,e){ie(this.ei(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return ct.forEach(e.mutations,(i=>{const s=new Mn(i.key,e.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Jr=r}))}nr(t){}containsKey(t,e){const r=new Mn(e,0),i=this.Jr.firstAfterOrEqual(r);return ct.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,ct.resolve()}ei(t,e){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const e=this.Xr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class M7{constructor(t){this.ti=t,this.docs=(function(){return new Ue(At.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,i=this.docs.get(r),s=i?i.size:0,o=this.ti(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return ct.resolve(r?r.document.mutableCopy():Dn.newInvalidDocument(e))}getEntries(t,e){let r=qo();return e.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Dn.newInvalidDocument(i))})),ct.resolve(r)}getDocumentsMatchingQuery(t,e,r,i){let s=qo();const o=e.path,l=new At(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:d}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||rG(nG(d),r)<=0||(i.has(d.key)||vb(e,d))&&(s=s.insert(d.key,d.mutableCopy()))}return ct.resolve(s)}getAllFromCollectionGroup(t,e,r,i){Ot(9500)}ni(t,e){return ct.forEach(this.docs,(r=>e(r)))}newChangeBuffer(t){return new D7(this)}getSize(t){return ct.resolve(this.size)}}class D7 extends w7{constructor(t){super(),this.Mr=t}applyChanges(t){const e=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?e.push(this.Mr.addEntry(t,i)):this.Mr.removeEntry(r)})),ct.waitFor(e)}getFromCache(t,e){return this.Mr.getEntry(t,e)}getAllFromCache(t,e){return this.Mr.getEntries(t,e)}}class O7{constructor(t){this.persistence=t,this.ri=new ou((e=>JE(e)),ZE),this.lastRemoteSnapshotVersion=Nt.min(),this.highestTargetId=0,this.ii=0,this.si=new o1,this.targetCount=0,this.oi=Ph._r()}forEachTarget(t,e){return this.ri.forEach(((r,i)=>e(i))),ct.resolve()}getLastRemoteSnapshotVersion(t){return ct.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ct.resolve(this.ii)}allocateTargetId(t){return this.highestTargetId=this.oi.next(),ct.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.ii&&(this.ii=e),ct.resolve()}lr(t){this.ri.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.oi=new Ph(e),this.highestTargetId=e),t.sequenceNumber>this.ii&&(this.ii=t.sequenceNumber)}addTargetData(t,e){return this.lr(e),this.targetCount+=1,ct.resolve()}updateTargetData(t,e){return this.lr(e),ct.resolve()}removeTargetData(t,e){return this.ri.delete(e.target),this.si.Gr(e.targetId),this.targetCount-=1,ct.resolve()}removeTargets(t,e,r){let i=0;const s=[];return this.ri.forEach(((o,l)=>{l.sequenceNumber<=e&&r.get(l.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(t,l.targetId)),i++)})),ct.waitFor(s).next((()=>i))}getTargetCount(t){return ct.resolve(this.targetCount)}getTargetData(t,e){const r=this.ri.get(e)||null;return ct.resolve(r)}addMatchingKeys(t,e,r){return this.si.$r(e,r),ct.resolve()}removeMatchingKeys(t,e,r){this.si.Qr(e,r);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach((o=>{s.push(i.markPotentiallyOrphaned(t,o))})),ct.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.si.Gr(e),ct.resolve()}getMatchingKeysForTargetId(t,e){const r=this.si.jr(e);return ct.resolve(r)}containsKey(t,e){return ct.resolve(this.si.containsKey(e))}}class RV{constructor(t,e){this._i={},this.overlays={},this.ai=new mb(0),this.ui=!1,this.ui=!0,this.ci=new k7,this.referenceDelegate=t(this),this.li=new O7(this),this.indexManager=new g7,this.remoteDocumentCache=(function(i){return new M7(i)})((r=>this.referenceDelegate.hi(r))),this.serializer=new p7(e),this.Pi=new C7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new A7,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this._i[t.toKey()];return r||(r=new R7(e,this.referenceDelegate),this._i[t.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(t,e,r){bt("MemoryPersistence","Starting transaction:",t);const i=new I7(this.ai.next());return this.referenceDelegate.Ti(),r(i).next((s=>this.referenceDelegate.Ii(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ei(t,e){return ct.or(Object.values(this._i).map((r=>()=>r.containsKey(t,e))))}}class I7 extends sG{constructor(t){super(),this.currentSequenceNumber=t}}class a1{constructor(t){this.persistence=t,this.Ri=new o1,this.Ai=null}static Vi(t){return new a1(t)}get di(){if(this.Ai)return this.Ai;throw Ot(60996)}addReference(t,e,r){return this.Ri.addReference(r,e),this.di.delete(r.toString()),ct.resolve()}removeReference(t,e,r){return this.Ri.removeReference(r,e),this.di.add(r.toString()),ct.resolve()}markPotentiallyOrphaned(t,e){return this.di.add(e.toString()),ct.resolve()}removeTarget(t,e){this.Ri.Gr(e.targetId).forEach((i=>this.di.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((i=>{i.forEach((s=>this.di.add(s.toString())))})).next((()=>r.removeTargetData(t,e)))}Ti(){this.Ai=new Set}Ii(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ct.forEach(this.di,(r=>{const i=At.fromPath(r);return this.mi(t,i).next((s=>{s||e.removeEntry(i,Nt.min())}))})).next((()=>(this.Ai=null,e.apply(t))))}updateLimboDocument(t,e){return this.mi(t,e).next((r=>{r?this.di.delete(e.toString()):this.di.add(e.toString())}))}hi(t){return 0}mi(t,e){return ct.or([()=>ct.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ei(t,e)])}}class q0{constructor(t,e){this.persistence=t,this.fi=new ou((r=>lG(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=S7(this,e)}static Vi(t,e){return new q0(t,e)}Ti(){}Ii(t){return ct.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}dr(t){const e=this.pr(t);return this.persistence.getTargetCache().getTargetCount(t).next((r=>e.next((i=>r+i))))}pr(t){let e=0;return this.mr(t,(r=>{e++})).next((()=>e))}mr(t,e){return ct.forEach(this.fi,((r,i)=>this.wr(t,r,i).next((s=>s?ct.resolve():e(i)))))}removeTargets(t,e,r){return this.persistence.getTargetCache().removeTargets(t,e,r)}removeOrphanedDocuments(t,e){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ni(t,(o=>this.wr(t,o,e).next((l=>{l||(r++,s.removeEntry(o,Nt.min()))})))).next((()=>s.apply(t))).next((()=>r))}markPotentiallyOrphaned(t,e){return this.fi.set(e,t.currentSequenceNumber),ct.resolve()}removeTarget(t,e){const r=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,e,r){return this.fi.set(r,t.currentSequenceNumber),ct.resolve()}removeReference(t,e,r){return this.fi.set(r,t.currentSequenceNumber),ct.resolve()}updateLimboDocument(t,e){return this.fi.set(e,t.currentSequenceNumber),ct.resolve()}hi(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=o0(t.data.value)),e}wr(t,e,r){return ct.or([()=>this.persistence.Ei(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.fi.get(e);return ct.resolve(i!==void 0&&i>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class l1{constructor(t,e,r,i){this.targetId=t,this.fromCache=e,this.Ts=r,this.Is=i}static Es(t,e){let r=te(),i=te();for(const s of e.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new l1(t,e.fromCache,r,i)}}class P7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class N7{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return c9()?8:oG(rr())>0?6:4})()}initialize(t,e){this.fs=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,r,i){const s={result:null};return this.gs(t,e).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ps(t,e,i,r).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new P7;return this.ys(t,e,o).next((l=>{if(s.result=l,this.As)return this.ws(t,e,o,l.size)}))})).next((()=>s.result))}ws(t,e,r,i){return r.documentReadCount<this.Vs?(eh()<=Jt.DEBUG&&bt("QueryEngine","SDK will not create cache indexes for query:",nh(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ct.resolve()):(eh()<=Jt.DEBUG&&bt("QueryEngine","Query:",nh(e),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(eh()<=Jt.DEBUG&&bt("QueryEngine","The SDK decides to create cache indexes for query:",nh(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Hs(e))):ct.resolve())}gs(t,e){if(KD(e))return ct.resolve(null);let r=Hs(e);return this.indexManager.getIndexType(t,r).next((i=>i===0?null:(e.limit!==null&&i===1&&(e=U0(e,null,"F"),r=Hs(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next((s=>{const o=te(...s);return this.fs.getDocuments(t,o).next((l=>this.indexManager.getMinOffset(t,r).next((u=>{const h=this.bs(e,l);return this.Ss(e,h,o,u.readTime)?this.gs(t,U0(e,null,"F")):this.Ds(t,h,e,u)}))))})))))}ps(t,e,r,i){return KD(e)||i.isEqual(Nt.min())?ct.resolve(null):this.fs.getDocuments(t,r).next((s=>{const o=this.bs(e,s);return this.Ss(e,o,r,i)?ct.resolve(null):(eh()<=Jt.DEBUG&&bt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),nh(e)),this.Ds(t,o,e,eG(i,wp)).next((l=>l)))}))}bs(t,e){let r=new xn(rV(t));return e.forEach(((i,s)=>{vb(t,s)&&(r=r.add(s))})),r}Ss(t,e,r,i){if(t.limit===null)return!1;if(r.size!==e.size)return!0;const s=t.limitType==="F"?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ys(t,e,r){return eh()<=Jt.DEBUG&&bt("QueryEngine","Using full collection scan to execute query:",nh(e)),this.fs.getDocumentsMatchingQuery(t,e,hl.min(),r)}Ds(t,e,r,i){return this.fs.getDocumentsMatchingQuery(t,r,i).next((s=>(e.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const c1="LocalStore",L7=3e8;class V7{constructor(t,e,r,i){this.persistence=t,this.Cs=e,this.serializer=i,this.vs=new Ue(Zt),this.Fs=new ou((s=>JE(s)),ZE),this.Ms=new Map,this.xs=t.getRemoteDocumentCache(),this.li=t.getTargetCache(),this.Pi=t.getBundleCache(),this.Os(r)}Os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new E7(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.vs)))}}function j7(n,t,e,r){return new V7(n,t,e,r)}async function MV(n,t){const e=Bt(n);return await e.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return e.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,e.Os(t),e.mutationQueue.getAllMutationBatches(r)))).next((s=>{const o=[],l=[];let u=te();for(const h of i){o.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}for(const h of s){l.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}return e.localDocuments.getDocuments(r,u).next((h=>({Ns:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function B7(n,t){const e=Bt(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=t.batch.keys(),s=e.xs.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,d){const m=h.batch,g=m.keys();let v=ct.resolve();return g.forEach((T=>{v=v.next((()=>d.getEntry(u,T))).next((S=>{const w=h.docVersions.get(T);ie(w!==null,48541),S.version.compareTo(w)<0&&(m.applyToRemoteDocument(S,h),S.isValidDocument()&&(S.setReadTime(h.commitVersion),d.addEntry(S)))}))})),v.next((()=>l.mutationQueue.removeMutationBatch(u,m)))})(e,r,t,s).next((()=>s.apply(r))).next((()=>e.mutationQueue.performConsistencyCheck(r))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(l){let u=te();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(t)))).next((()=>e.localDocuments.getDocuments(r,i)))}))}function DV(n){const t=Bt(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.li.getLastRemoteSnapshotVersion(e)))}function F7(n,t){const e=Bt(n),r=t.snapshotVersion;let i=e.vs;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=e.xs.newChangeBuffer({trackRemovals:!0});i=e.vs;const l=[];t.targetChanges.forEach(((d,m)=>{const g=i.get(m);if(!g)return;l.push(e.li.removeMatchingKeys(s,d.removedDocuments,m).next((()=>e.li.addMatchingKeys(s,d.addedDocuments,m))));let v=g.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(m)!==null?v=v.withResumeToken(Xn.EMPTY_BYTE_STRING,Nt.min()).withLastLimboFreeSnapshotVersion(Nt.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,r)),i=i.insert(m,v),(function(S,w,E){return S.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=L7?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0})(g,v,d)&&l.push(e.li.updateTargetData(s,v))}));let u=qo(),h=te();if(t.documentUpdates.forEach((d=>{t.resolvedLimboDocuments.has(d)&&l.push(e.persistence.referenceDelegate.updateLimboDocument(s,d))})),l.push(U7(s,o,t.documentUpdates).next((d=>{u=d.Bs,h=d.Ls}))),!r.isEqual(Nt.min())){const d=e.li.getLastRemoteSnapshotVersion(s).next((m=>e.li.setTargetsMetadata(s,s.currentSequenceNumber,r)));l.push(d)}return ct.waitFor(l).next((()=>o.apply(s))).next((()=>e.localDocuments.getLocalViewOfDocuments(s,u,h))).next((()=>u))})).then((s=>(e.vs=i,s)))}function U7(n,t,e){let r=te(),i=te();return e.forEach((s=>r=r.add(s))),t.getEntries(n,r).next((s=>{let o=qo();return e.forEach(((l,u)=>{const h=s.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(Nt.min())?(t.removeEntry(l,u.readTime),o=o.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(l,u)):bt(c1,"Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)})),{Bs:o,Ls:i}}))}function z7(n,t){const e=Bt(n);return e.persistence.runTransaction("Get next mutation batch","readonly",(r=>(t===void 0&&(t=KE),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t))))}function H7(n,t){const e=Bt(n);return e.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return e.li.getTargetData(r,t).next((s=>s?(i=s,ct.resolve(i)):e.li.allocateTargetId(r).next((o=>(i=new Xa(t,o,"TargetPurposeListen",r.currentSequenceNumber),e.li.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=e.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.vs=e.vs.insert(r.targetId,r),e.Fs.set(t,r.targetId)),r}))}async function ix(n,t,e){const r=Bt(n),i=r.vs.get(t),s=e?"readwrite":"readwrite-primary";try{e||await r.persistence.runTransaction("Release target",s,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Jh(o))throw o;bt(c1,`Failed to update sequence numbers for target ${t}: ${o}`)}r.vs=r.vs.remove(t),r.Fs.delete(i.target)}function lO(n,t,e){const r=Bt(n);let i=Nt.min(),s=te();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,h,d){const m=Bt(u),g=m.Fs.get(d);return g!==void 0?ct.resolve(m.vs.get(g)):m.li.getTargetData(h,d)})(r,o,Hs(t)).next((l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,l.targetId).next((u=>{s=u}))})).next((()=>r.Cs.getDocumentsMatchingQuery(o,t,e?i:Nt.min(),e?s:te()))).next((l=>($7(r,MG(t),l),{documents:l,ks:s})))))}function $7(n,t,e){let r=n.Ms.get(t)||Nt.min();e.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Ms.set(t,r)}class cO{constructor(){this.activeTargetIds=LG()}Qs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class q7{constructor(){this.vo=new cO,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t,e=!0){return e&&this.vo.Qs(t),this.Fo[t]||"not-current"}updateQueryState(t,e,r){this.Fo[t]=e}removeLocalQueryTarget(t){this.vo.Gs(t)}isLocalQueryTarget(t){return this.vo.activeTargetIds.has(t)}clearQueryState(t){delete this.Fo[t]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(t){return this.vo.activeTargetIds.has(t)}start(){return this.vo=new cO,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class G7{Mo(t){}shutdown(){}}const uO="ConnectivityMonitor";class hO{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(t){this.Lo.push(t)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){bt(uO,"Network connectivity changed: AVAILABLE");for(const t of this.Lo)t(0)}Bo(){bt(uO,"Network connectivity changed: UNAVAILABLE");for(const t of this.Lo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ly=null;function sx(){return ly===null?ly=(function(){return 268435456+Math.round(2147483648*Math.random())})():ly++,"0x"+ly.toString(16)}const ES="RestConnection",W7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class Y7{get Ko(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=e+"://"+t.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===j0?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(t,e,r,i,s){const o=sx(),l=this.Qo(t,e.toUriEncodedString());bt(ES,`Sending RPC '${t}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(u,i,s);const{host:h}=new URL(l),d=El(h);return this.zo(t,l,u,r,d).then((m=>(bt(ES,`Received RPC '${t}' ${o}: `,m),m)),(m=>{throw Yc(ES,`RPC '${t}' ${o} failed with error: `,m,"url: ",l,"request:",r),m}))}jo(t,e,r,i,s,o){return this.Wo(t,e,r,i,s)}Go(t,e,r){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Xh})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((i,s)=>t[s]=i)),r&&r.headers.forEach(((i,s)=>t[s]=i))}Qo(t,e){const r=W7[t];let i=`${this.qo}/v1/${e}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}class K7{constructor(t){this.Ho=t.Ho,this.Jo=t.Jo}Zo(t){this.Xo=t}Yo(t){this.e_=t}t_(t){this.n_=t}onMessage(t){this.r_=t}close(){this.Jo()}send(t){this.Ho(t)}i_(){this.Xo()}s_(){this.e_()}o_(t){this.n_(t)}__(t){this.r_(t)}}const Jn="WebChannelConnection",Td=(n,t,e)=>{n.listen(t,(r=>{try{e(r)}catch(i){setTimeout((()=>{throw i}),0)}}))};class wh extends Y7{constructor(t){super(t),this.a_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}static u_(){if(!wh.c_){const t=IL();Td(t,OL.STAT_EVENT,(e=>{e.stat===Yw.PROXY?bt(Jn,"STAT_EVENT: detected buffering proxy"):e.stat===Yw.NOPROXY&&bt(Jn,"STAT_EVENT: detected no buffering proxy")})),wh.c_=!0}}zo(t,e,r,i,s){const o=sx();return new Promise(((l,u)=>{const h=new ML;h.setWithCredentials(!0),h.listenOnce(DL.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case s0.NO_ERROR:const m=h.getResponseJson();bt(Jn,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(m)),l(m);break;case s0.TIMEOUT:bt(Jn,`RPC '${t}' ${o} timed out`),u(new gt(it.DEADLINE_EXCEEDED,"Request time out"));break;case s0.HTTP_ERROR:const g=h.getStatus();if(bt(Jn,`RPC '${t}' ${o} failed with status:`,g,"response text:",h.getResponseText()),g>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const T=v?.error;if(T&&T.status&&T.message){const S=(function(E){const R=E.toLowerCase().replace(/_/g,"-");return Object.values(it).indexOf(R)>=0?R:it.UNKNOWN})(T.status);u(new gt(S,T.message))}else u(new gt(it.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new gt(it.UNAVAILABLE,"Connection failed."));break;default:Ot(9055,{l_:t,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{bt(Jn,`RPC '${t}' ${o} completed.`)}}));const d=JSON.stringify(i);bt(Jn,`RPC '${t}' ${o} sending request:`,i),h.send(e,"POST",d,r,15)}))}T_(t,e,r){const i=sx(),s=[this.qo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=this.createWebChannelTransport(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Go(l.initMessageHeaders,e,r),l.encodeInitMessageHeaders=!0;const h=s.join("");bt(Jn,`Creating RPC '${t}' stream ${i}: ${h}`,l);const d=o.createWebChannel(h,l);this.I_(d);let m=!1,g=!1;const v=new K7({Ho:T=>{g?bt(Jn,`Not sending because RPC '${t}' stream ${i} is closed:`,T):(m||(bt(Jn,`Opening RPC '${t}' stream ${i} transport.`),d.open(),m=!0),bt(Jn,`RPC '${t}' stream ${i} sending:`,T),d.send(T))},Jo:()=>d.close()});return Td(d,Nd.EventType.OPEN,(()=>{g||(bt(Jn,`RPC '${t}' stream ${i} transport opened.`),v.i_())})),Td(d,Nd.EventType.CLOSE,(()=>{g||(g=!0,bt(Jn,`RPC '${t}' stream ${i} transport closed`),v.o_(),this.E_(d))})),Td(d,Nd.EventType.ERROR,(T=>{g||(g=!0,Yc(Jn,`RPC '${t}' stream ${i} transport errored. Name:`,T.name,"Message:",T.message),v.o_(new gt(it.UNAVAILABLE,"The operation could not be completed")))})),Td(d,Nd.EventType.MESSAGE,(T=>{if(!g){const S=T.data[0];ie(!!S,16349);const w=S,E=w?.error||w[0]?.error;if(E){bt(Jn,`RPC '${t}' stream ${i} received error:`,E);const R=E.status;let P=(function(W){const M=mn[W];if(M!==void 0)return gV(M)})(R),j=E.message;R==="NOT_FOUND"&&j.includes("database")&&j.includes("does not exist")&&j.includes(this.databaseId.database)&&Yc(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),P===void 0&&(P=it.INTERNAL,j="Unknown error status: "+R+" with message "+E.message),g=!0,v.o_(new gt(P,j)),d.close()}else bt(Jn,`RPC '${t}' stream ${i} received:`,S),v.__(S)}})),wh.u_(),setTimeout((()=>{v.s_()}),0),v}terminate(){this.a_.forEach((t=>t.close())),this.a_=[]}I_(t){this.a_.push(t)}E_(t){this.a_=this.a_.filter((e=>e===t))}Go(t,e,r){super.Go(t,e,r),this.databaseInfo.apiKey&&(t["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return PL()}}function X7(n){return new wh(n)}function CS(){return typeof document<"u"?document:null}function Sb(n){return new t7(n,!0)}wh.c_=!1;class u1{constructor(t,e,r=1e3,i=1.5,s=6e4){this.Ci=t,this.timerId=e,this.R_=r,this.A_=i,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(t){this.cancel();const e=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-r);i>0&&bt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),t()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const fO="PersistentStream";class OV{constructor(t,e,r,i,s,o,l,u){this.Ci=t,this.b_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new u1(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(t){this.q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===it.RESOURCE_EXHAUSTED?($o(e.toString()),$o("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===it.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.t_(e)}W_(){}auth(){this.state=1;const t=this.Q_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===e&&this.G_(r,i)}),(r=>{t((()=>{const i=new gt(it.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(t,e){const r=this.Q_(this.D_);this.stream=this.j_(t,e),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.H_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return bt(fO,`close with error: ${t}`),this.stream=null,this.close(4,t)}Q_(t){return e=>{this.Ci.enqueueAndForget((()=>this.D_===t?e():(bt(fO,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Q7 extends OV{constructor(t,e,r,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,i,o),this.serializer=s}j_(t,e){return this.connection.T_("Listen",t,e)}H_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=i7(this.serializer,t),r=(function(s){if(!("targetChange"in s))return Nt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Nt.min():o.readTime?Jr(o.readTime):Nt.min()})(t);return this.listener.J_(e,r)}Z_(t){const e={};e.database=rx(this.serializer),e.addTarget=(function(s,o){let l;const u=o.target;if(l=Zw(u)?{documents:o7(s,u)}:{query:a7(s,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=bV(s,o.resumeToken);const h=ex(s,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo(Nt.min())>0){l.readTime=H0(s,o.snapshotVersion.toTimestamp());const h=ex(s,o.expectedCount);h!==null&&(l.expectedCount=h)}return l})(this.serializer,t);const r=c7(this.serializer,t);r&&(e.labels=r),this.K_(e)}X_(t){const e={};e.database=rx(this.serializer),e.removeTarget=t,this.K_(e)}}class J7 extends OV{constructor(t,e,r,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,i,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}H_(t){return ie(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ie(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){ie(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=s7(t.writeResults,t.commitTime),r=Jr(t.commitTime);return this.listener.na(r,e)}ra(){const t={};t.database=rx(this.serializer),this.K_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((r=>wV(this.serializer,r)))};this.K_(e)}}class Z7{}class tW extends Z7{constructor(t,e,r,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new gt(it.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,e,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Wo(t,nx(e,r),i,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===it.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new gt(it.UNKNOWN,s.toString())}))}jo(t,e,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.jo(t,nx(e,r),i,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===it.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new gt(it.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function eW(n,t,e,r){return new tW(n,t,e,r)}class nW{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?($o(e),this.aa=!1):bt("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Kc="RemoteStore";class rW{constructor(t,e,r,i,s){this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo((o=>{r.enqueueAndForget((async()=>{au(this)&&(bt(Kc,"Restarting streams for network reachability change."),await(async function(u){const h=Bt(u);h.Ea.add(4),await dm(h),h.Va.set("Unknown"),h.Ea.delete(4),await wb(h)})(this))}))})),this.Va=new nW(r,i)}}async function wb(n){if(au(n))for(const t of n.Ra)await t(!0)}async function dm(n){for(const t of n.Ra)await t(!1)}function IV(n,t){const e=Bt(n);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),p1(e)?d1(e):tf(e).O_()&&f1(e,t))}function h1(n,t){const e=Bt(n),r=tf(e);e.Ia.delete(t),r.O_()&&PV(e,t),e.Ia.size===0&&(r.O_()?r.L_():au(e)&&e.Va.set("Unknown"))}function f1(n,t){if(n.da.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Nt.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}tf(n).Z_(t)}function PV(n,t){n.da.$e(t),tf(n).X_(t)}function d1(n){n.da=new XG({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),tf(n).start(),n.Va.ua()}function p1(n){return au(n)&&!tf(n).x_()&&n.Ia.size>0}function au(n){return Bt(n).Ea.size===0}function NV(n){n.da=void 0}async function iW(n){n.Va.set("Online")}async function sW(n){n.Ia.forEach(((t,e)=>{f1(n,t)}))}async function oW(n,t){NV(n),p1(n)?(n.Va.ha(t),d1(n)):n.Va.set("Unknown")}async function aW(n,t,e){if(n.Va.set("Online"),t instanceof vV&&t.state===2&&t.cause)try{await(async function(i,s){const o=s.cause;for(const l of s.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.Ia.delete(l),i.da.removeTarget(l))})(n,t)}catch(r){bt(Kc,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await G0(n,r)}else if(t instanceof c0?n.da.Xe(t):t instanceof yV?n.da.st(t):n.da.tt(t),!e.isEqual(Nt.min()))try{const r=await DV(n.localStore);e.compareTo(r)>=0&&await(function(s,o){const l=s.da.Tt(o);return l.targetChanges.forEach(((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.Ia.get(h);d&&s.Ia.set(h,d.withResumeToken(u.resumeToken,o))}})),l.targetMismatches.forEach(((u,h)=>{const d=s.Ia.get(u);if(!d)return;s.Ia.set(u,d.withResumeToken(Xn.EMPTY_BYTE_STRING,d.snapshotVersion)),PV(s,u);const m=new Xa(d.target,u,h,d.sequenceNumber);f1(s,m)})),s.remoteSyncer.applyRemoteEvent(l)})(n,e)}catch(r){bt(Kc,"Failed to raise snapshot:",r),await G0(n,r)}}async function G0(n,t,e){if(!Jh(t))throw t;n.Ea.add(1),await dm(n),n.Va.set("Offline"),e||(e=()=>DV(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{bt(Kc,"Retrying IndexedDB access"),await e(),n.Ea.delete(1),await wb(n)}))}function LV(n,t){return t().catch((e=>G0(n,e,t)))}async function xb(n){const t=Bt(n),e=ml(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:KE;for(;lW(t);)try{const i=await z7(t.localStore,r);if(i===null){t.Ta.length===0&&e.L_();break}r=i.batchId,cW(t,i)}catch(i){await G0(t,i)}VV(t)&&jV(t)}function lW(n){return au(n)&&n.Ta.length<10}function cW(n,t){n.Ta.push(t);const e=ml(n);e.O_()&&e.Y_&&e.ea(t.mutations)}function VV(n){return au(n)&&!ml(n).x_()&&n.Ta.length>0}function jV(n){ml(n).start()}async function uW(n){ml(n).ra()}async function hW(n){const t=ml(n);for(const e of n.Ta)t.ea(e.mutations)}async function fW(n,t,e){const r=n.Ta.shift(),i=r1.from(r,t,e);await LV(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await xb(n)}async function dW(n,t){t&&ml(n).Y_&&await(async function(r,i){if((function(o){return mV(o)&&o!==it.ABORTED})(i.code)){const s=r.Ta.shift();ml(r).B_(),await LV(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await xb(r)}})(n,t),VV(n)&&jV(n)}async function dO(n,t){const e=Bt(n);e.asyncQueue.verifyOperationInProgress(),bt(Kc,"RemoteStore received new credentials");const r=au(e);e.Ea.add(3),await dm(e),r&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await wb(e)}async function pW(n,t){const e=Bt(n);t?(e.Ea.delete(2),await wb(e)):t||(e.Ea.add(2),await dm(e),e.Va.set("Unknown"))}function tf(n){return n.ma||(n.ma=(function(e,r,i){const s=Bt(e);return s.sa(),new Q7(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:iW.bind(null,n),Yo:sW.bind(null,n),t_:oW.bind(null,n),J_:aW.bind(null,n)}),n.Ra.push((async t=>{t?(n.ma.B_(),p1(n)?d1(n):n.Va.set("Unknown")):(await n.ma.stop(),NV(n))}))),n.ma}function ml(n){return n.fa||(n.fa=(function(e,r,i){const s=Bt(e);return s.sa(),new J7(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:uW.bind(null,n),t_:dW.bind(null,n),ta:hW.bind(null,n),na:fW.bind(null,n)}),n.Ra.push((async t=>{t?(n.fa.B_(),await xb(n)):(await n.fa.stop(),n.Ta.length>0&&(bt(Kc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class m1{constructor(t,e,r,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new zs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,r,i,s){const o=Date.now()+r,l=new m1(t,e,o,i,s);return l.start(r),l}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new gt(it.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function g1(n,t){if($o("AsyncQueue",`${t}: ${n}`),Jh(n))return new gt(it.UNAVAILABLE,`${t}: ${n}`);throw n}class xh{static emptySet(t){return new xh(t.comparator)}constructor(t){this.comparator=t?(e,r)=>t(e,r)||At.comparator(e.key,r.key):(e,r)=>At.comparator(e.key,r.key),this.keyedMap=Ld(),this.sortedSet=new Ue(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,r)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof xh)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const r=new xh;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class pO{constructor(){this.ga=new Ue(At.comparator)}track(t){const e=t.doc.key,r=this.ga.get(e);r?t.type!==0&&r.type===3?this.ga=this.ga.insert(e,t):t.type===3&&r.type!==1?this.ga=this.ga.insert(e,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.ga=this.ga.remove(e):t.type===1&&r.type===2?this.ga=this.ga.insert(e,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):Ot(63341,{Vt:t,pa:r}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,r)=>{t.push(r)})),t}}class Nh{constructor(t,e,r,i,s,o,l,u,h){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,e,r,i,s){const o=[];return e.forEach((l=>{o.push({type:0,doc:l})})),new Nh(t,e,xh.emptySet(e),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&yb(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==r[i].type||!e[i].doc.isEqual(r[i].doc))return!1;return!0}}class mW{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((t=>t.Da()))}}class gW{constructor(){this.queries=mO(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,r){const i=Bt(e),s=i.queries;i.queries=mO(),s.forEach(((o,l)=>{for(const u of l.ba)u.onError(r)}))})(this,new gt(it.ABORTED,"Firestore shutting down"))}}function mO(){return new ou((n=>nV(n)),yb)}async function BV(n,t){const e=Bt(n);let r=3;const i=t.query;let s=e.queries.get(i);s?!s.Sa()&&t.Da()&&(r=2):(s=new mW,r=t.Da()?0:1);try{switch(r){case 0:s.wa=await e.onListen(i,!0);break;case 1:s.wa=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(o){const l=g1(o,`Initialization of query '${nh(t.query)}' failed`);return void t.onError(l)}e.queries.set(i,s),s.ba.push(t),t.va(e.onlineState),s.wa&&t.Fa(s.wa)&&y1(e)}async function FV(n,t){const e=Bt(n),r=t.query;let i=3;const s=e.queries.get(r);if(s){const o=s.ba.indexOf(t);o>=0&&(s.ba.splice(o,1),s.ba.length===0?i=t.Da()?0:1:!s.Sa()&&t.Da()&&(i=2))}switch(i){case 0:return e.queries.delete(r),e.onUnlisten(r,!0);case 1:return e.queries.delete(r),e.onUnlisten(r,!1);case 2:return e.onLastRemoteStoreUnlisten(r);default:return}}function yW(n,t){const e=Bt(n);let r=!1;for(const i of t){const s=i.query,o=e.queries.get(s);if(o){for(const l of o.ba)l.Fa(i)&&(r=!0);o.wa=i}}r&&y1(e)}function vW(n,t,e){const r=Bt(n),i=r.queries.get(t);if(i)for(const s of i.ba)s.onError(e);r.queries.delete(t)}function y1(n){n.Ca.forEach((t=>{t.next()}))}var ox,gO;(gO=ox||(ox={})).Ma="default",gO.Cache="cache";class UV{constructor(t,e,r){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)i.type!==3&&r.push(i);t=new Nh(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const r=e!=="Offline";return(!this.options.Ka||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Nh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==ox.Cache}}class zV{constructor(t){this.key=t}}class HV{constructor(t){this.key=t}}class bW{constructor(t,e){this.query=t,this.Za=e,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=te(),this.mutatedKeys=te(),this.eu=rV(t),this.tu=new xh(this.eu)}get nu(){return this.Za}ru(t,e){const r=e?e.iu:new pO,i=e?e.tu:this.tu;let s=e?e.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((d,m)=>{const g=i.get(d),v=vb(this.query,m)?m:null,T=!!g&&this.mutatedKeys.has(g.key),S=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let w=!1;g&&v?g.data.isEqual(v.data)?T!==S&&(r.track({type:3,doc:v}),w=!0):this.su(g,v)||(r.track({type:2,doc:v}),w=!0,(u&&this.eu(v,u)>0||h&&this.eu(v,h)<0)&&(l=!0)):!g&&v?(r.track({type:0,doc:v}),w=!0):g&&!v&&(r.track({type:1,doc:g}),w=!0,(u||h)&&(l=!0)),w&&(v?(o=o.add(v),s=S?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Ss:l,mutatedKeys:s}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r,i){const s=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const o=t.iu.ya();o.sort(((d,m)=>(function(v,T){const S=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ot(20277,{Vt:w})}};return S(v)-S(T)})(d.type,m.type)||this.eu(d.doc,m.doc))),this.ou(r),i=i??!1;const l=e&&!i?this._u():[],u=this.Ya.size===0&&this.current&&!i?1:0,h=u!==this.Xa;return this.Xa=u,o.length!==0||h?{snapshot:new Nh(this.query,t.tu,s,o,t.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new pO,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(t){return!this.Za.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Za=this.Za.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Za=this.Za.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Ya;this.Ya=te(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const e=[];return t.forEach((r=>{this.Ya.has(r)||e.push(new HV(r))})),this.Ya.forEach((r=>{t.has(r)||e.push(new zV(r))})),e}cu(t){this.Za=t.ks,this.Ya=te();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Nh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const v1="SyncEngine";class _W{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class TW{constructor(t){this.key=t,this.hu=!1}}class SW{constructor(t,e,r,i,s,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ou((l=>nV(l)),yb),this.Iu=new Map,this.Eu=new Set,this.Ru=new Ue(At.comparator),this.Au=new Map,this.Vu=new o1,this.du={},this.mu=new Map,this.fu=Ph.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function wW(n,t,e=!0){const r=KV(n);let i;const s=r.Tu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await $V(r,t,e,!0),i}async function xW(n,t){const e=KV(n);await $V(e,t,!0,!1)}async function $V(n,t,e,r){const i=await H7(n.localStore,Hs(t)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,e);let l;return r&&(l=await EW(n,t,s,o==="current",i.resumeToken)),n.isPrimaryClient&&e&&IV(n.remoteStore,i),l}async function EW(n,t,e,r,i){n.pu=(m,g,v)=>(async function(S,w,E,R){let P=w.view.ru(E);P.Ss&&(P=await lO(S.localStore,w.query,!1).then((({documents:M})=>w.view.ru(M,P))));const j=R&&R.targetChanges.get(w.targetId),N=R&&R.targetMismatches.get(w.targetId)!=null,W=w.view.applyChanges(P,S.isPrimaryClient,j,N);return vO(S,w.targetId,W.au),W.snapshot})(n,m,g,v);const s=await lO(n.localStore,t,!0),o=new bW(t,s.ks),l=o.ru(s.documents),u=fm.createSynthesizedTargetChangeForCurrentChange(e,r&&n.onlineState!=="Offline",i),h=o.applyChanges(l,n.isPrimaryClient,u);vO(n,e,h.au);const d=new _W(t,e,o);return n.Tu.set(t,d),n.Iu.has(e)?n.Iu.get(e).push(t):n.Iu.set(e,[t]),h.snapshot}async function CW(n,t,e){const r=Bt(n),i=r.Tu.get(t),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((o=>!yb(o,t)))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ix(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),e&&h1(r.remoteStore,i.targetId),ax(r,i.targetId)})).catch(Qh)):(ax(r,i.targetId),await ix(r.localStore,i.targetId,!0))}async function AW(n,t){const e=Bt(n),r=e.Tu.get(t),i=e.Iu.get(r.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(r.targetId),h1(e.remoteStore,r.targetId))}async function kW(n,t,e){const r=NW(n);try{const i=await(function(o,l){const u=Bt(o),h=we.now(),d=l.reduce(((v,T)=>v.add(T.key)),te());let m,g;return u.persistence.runTransaction("Locally write mutations","readwrite",(v=>{let T=qo(),S=te();return u.xs.getEntries(v,d).next((w=>{T=w,T.forEach(((E,R)=>{R.isValidDocument()||(S=S.add(E))}))})).next((()=>u.localDocuments.getOverlayedDocuments(v,T))).next((w=>{m=w;const E=[];for(const R of l){const P=$G(R,m.get(R.key).overlayedDocument);P!=null&&E.push(new Ml(R.key,P,YL(P.value.mapValue),mr.exists(!0)))}return u.mutationQueue.addMutationBatch(v,h,E,l)})).next((w=>{g=w;const E=w.applyToLocalDocumentSet(m,S);return u.documentOverlayCache.saveOverlays(v,w.batchId,E)}))})).then((()=>({batchId:g.batchId,changes:sV(m)})))})(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),(function(o,l,u){let h=o.du[o.currentUser.toKey()];h||(h=new Ue(Zt)),h=h.insert(l,u),o.du[o.currentUser.toKey()]=h})(r,i.batchId,e),await pm(r,i.changes),await xb(r.remoteStore)}catch(i){const s=g1(i,"Failed to persist write");e.reject(s)}}async function qV(n,t){const e=Bt(n);try{const r=await F7(e.localStore,t);t.targetChanges.forEach(((i,s)=>{const o=e.Au.get(s);o&&(ie(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?ie(o.hu,14607):i.removedDocuments.size>0&&(ie(o.hu,42227),o.hu=!1))})),await pm(e,r,t)}catch(r){await Qh(r)}}function yO(n,t,e){const r=Bt(n);if(r.isPrimaryClient&&e===0||!r.isPrimaryClient&&e===1){const i=[];r.Tu.forEach(((s,o)=>{const l=o.view.va(t);l.snapshot&&i.push(l.snapshot)})),(function(o,l){const u=Bt(o);u.onlineState=l;let h=!1;u.queries.forEach(((d,m)=>{for(const g of m.ba)g.va(l)&&(h=!0)})),h&&y1(u)})(r.eventManager,t),i.length&&r.Pu.J_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function RW(n,t,e){const r=Bt(n);r.sharedClientState.updateQueryState(t,"rejected",e);const i=r.Au.get(t),s=i&&i.key;if(s){let o=new Ue(At.comparator);o=o.insert(s,Dn.newNoDocument(s,Nt.min()));const l=te().add(s),u=new Tb(Nt.min(),new Map,new Ue(Zt),o,l);await qV(r,u),r.Ru=r.Ru.remove(s),r.Au.delete(t),b1(r)}else await ix(r.localStore,t,!1).then((()=>ax(r,t,e))).catch(Qh)}async function MW(n,t){const e=Bt(n),r=t.batch.batchId;try{const i=await B7(e.localStore,t);WV(e,r,null),GV(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),await pm(e,i)}catch(i){await Qh(i)}}async function DW(n,t,e){const r=Bt(n);try{const i=await(function(o,l){const u=Bt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return u.mutationQueue.lookupMutationBatch(h,l).next((m=>(ie(m!==null,37113),d=m.keys(),u.mutationQueue.removeMutationBatch(h,m)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,d,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>u.localDocuments.getDocuments(h,d)))}))})(r.localStore,t);WV(r,t,e),GV(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),await pm(r,i)}catch(i){await Qh(i)}}function GV(n,t){(n.mu.get(t)||[]).forEach((e=>{e.resolve()})),n.mu.delete(t)}function WV(n,t,e){const r=Bt(n);let i=r.du[r.currentUser.toKey()];if(i){const s=i.get(t);s&&(e?s.reject(e):s.resolve(),i=i.remove(t)),r.du[r.currentUser.toKey()]=i}}function ax(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.Iu.get(t))n.Tu.delete(r),e&&n.Pu.yu(r,e);n.Iu.delete(t),n.isPrimaryClient&&n.Vu.Gr(t).forEach((r=>{n.Vu.containsKey(r)||YV(n,r)}))}function YV(n,t){n.Eu.delete(t.path.canonicalString());const e=n.Ru.get(t);e!==null&&(h1(n.remoteStore,e),n.Ru=n.Ru.remove(t),n.Au.delete(e),b1(n))}function vO(n,t,e){for(const r of e)r instanceof zV?(n.Vu.addReference(r.key,t),OW(n,r)):r instanceof HV?(bt(v1,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,t),n.Vu.containsKey(r.key)||YV(n,r.key)):Ot(19791,{wu:r})}function OW(n,t){const e=t.key,r=e.path.canonicalString();n.Ru.get(e)||n.Eu.has(r)||(bt(v1,"New document in limbo: "+e),n.Eu.add(r),b1(n))}function b1(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const e=new At(Se.fromString(t)),r=n.fu.next();n.Au.set(r,new TW(e)),n.Ru=n.Ru.insert(e,r),IV(n.remoteStore,new Xa(Hs(t1(e.path)),r,"TargetPurposeLimboResolution",mb.ce))}}async function pm(n,t,e){const r=Bt(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((l,u)=>{o.push(r.pu(u,t,e).then((h=>{if((h||e)&&r.isPrimaryClient){const d=h?!h.fromCache:e?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(h){i.push(h);const d=l1.Es(u.targetId,h);s.push(d)}})))})),await Promise.all(o),r.Pu.J_(i),await(async function(u,h){const d=Bt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>ct.forEach(h,(g=>ct.forEach(g.Ts,(v=>d.persistence.referenceDelegate.addReference(m,g.targetId,v))).next((()=>ct.forEach(g.Is,(v=>d.persistence.referenceDelegate.removeReference(m,g.targetId,v)))))))))}catch(m){if(!Jh(m))throw m;bt(c1,"Failed to update sequence numbers: "+m)}for(const m of h){const g=m.targetId;if(!m.fromCache){const v=d.vs.get(g),T=v.snapshotVersion,S=v.withLastLimboFreeSnapshotVersion(T);d.vs=d.vs.insert(g,S)}}})(r.localStore,s))}async function IW(n,t){const e=Bt(n);if(!e.currentUser.isEqual(t)){bt(v1,"User change. New user:",t.toKey());const r=await MV(e.localStore,t);e.currentUser=t,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new gt(it.CANCELLED,o))}))})),s.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await pm(e,r.Ns)}}function PW(n,t){const e=Bt(n),r=e.Au.get(t);if(r&&r.hu)return te().add(r.key);{let i=te();const s=e.Iu.get(t);if(!s)return i;for(const o of s){const l=e.Tu.get(o);i=i.unionWith(l.view.nu)}return i}}function KV(n){const t=Bt(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=qV.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=PW.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=RW.bind(null,t),t.Pu.J_=yW.bind(null,t.eventManager),t.Pu.yu=vW.bind(null,t.eventManager),t}function NW(n){const t=Bt(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=MW.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=DW.bind(null,t),t}class W0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Sb(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return j7(this.persistence,new N7,t.initialUser,this.serializer)}Cu(t){return new RV(a1.Vi,this.serializer)}Du(t){return new q7}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}W0.provider={build:()=>new W0};class LW extends W0{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){ie(this.persistence.referenceDelegate instanceof q0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new _7(r,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Mr.withCacheSize(this.cacheSizeBytes):Mr.DEFAULT;return new RV((r=>q0.Vi(r,e)),this.serializer)}}class lx{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>yO(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=IW.bind(null,this.syncEngine),await pW(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new gW})()}createDatastore(t){const e=Sb(t.databaseInfo.databaseId),r=X7(t.databaseInfo);return eW(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return(function(r,i,s,o,l){return new rW(r,i,s,o,l)})(this.localStore,this.datastore,t.asyncQueue,(e=>yO(this.syncEngine,e,0)),(function(){return hO.v()?new hO:new G7})())}createSyncEngine(t,e){return(function(i,s,o,l,u,h,d){const m=new SW(i,s,o,l,u,h);return d&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const r=Bt(e);bt(Kc,"RemoteStore shutting down."),r.Ea.add(5),await dm(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}lx.provider={build:()=>new lx};class XV{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):$o("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}let VW=class{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(t){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new gt(it.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const e=await(async function(i,s){const o=Bt(i),l={documents:s.map((m=>$0(o.serializer,m)))},u=await o.jo("BatchGetDocuments",o.serializer.databaseId,Se.emptyPath(),l,s.length),h=new Map;u.forEach((m=>{const g=r7(o.serializer,m);h.set(g.key.toString(),g)}));const d=[];return s.forEach((m=>{const g=h.get(m.toString());ie(!!g,55234,{key:m}),d.push(g)})),d})(this.datastore,t);return e.forEach((r=>this.recordVersion(r))),e}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(t.toString())}delete(t){this.write(new n1(t,this.precondition(t))),this.writtenDocs.add(t.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const t=this.readVersions;this.mutations.forEach((e=>{t.delete(e.key.toString())})),t.forEach(((e,r)=>{const i=At.fromPath(r);this.mutations.push(new pV(i,this.precondition(i)))})),await(async function(r,i){const s=Bt(r),o={writes:i.map((l=>wV(s.serializer,l)))};await s.Wo("Commit",s.serializer.databaseId,Se.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Ot(50498,{Gu:t.constructor.name});e=Nt.min()}const r=this.readVersions.get(t.key.toString());if(r){if(!e.isEqual(r))throw new gt(it.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){const e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(Nt.min())?mr.exists(!1):mr.updateTime(e):mr.none()}preconditionForUpdate(t){const e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Nt.min()))throw new gt(it.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return mr.updateTime(e)}return mr.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}};class jW{constructor(t,e,r,i,s){this.asyncQueue=t,this.datastore=e,this.options=r,this.updateFunction=i,this.deferred=s,this.zu=r.maxAttempts,this.M_=new u1(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const t=new VW(this.datastore),e=this.Ju(t);e&&e.then((r=>{this.asyncQueue.enqueueAndForget((()=>t.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Zu(i)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(t){try{const e=this.updateFunction(t);return!um(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Zu(t){this.zu>0&&this.Xu(t)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(t)}Xu(t){if(t?.name==="FirebaseError"){const e=t.code;return e==="aborted"||e==="failed-precondition"||e==="already-exists"||!mV(e)}return!1}}const gl="FirestoreClient";class BW{constructor(t,e,r,i,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this._databaseInfo=i,this.user=tr.UNAUTHENTICATED,this.clientId=YE.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async o=>{bt(gl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(bt(gl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new zs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const r=g1(e,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}async function AS(n,t){n.asyncQueue.verifyOperationInProgress(),bt(gl,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await MV(t.localStore,i),r=i)})),t.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=t}async function bO(n,t){n.asyncQueue.verifyOperationInProgress();const e=await FW(n);bt(gl,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener((r=>dO(t.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>dO(t.remoteStore,i))),n._onlineComponents=t}async function FW(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){bt(gl,"Using user provided OfflineComponentProvider");try{await AS(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(i){return i.name==="FirebaseError"?i.code===it.FAILED_PRECONDITION||i.code===it.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(e))throw e;Yc("Error using user provided cache. Falling back to memory cache: "+e),await AS(n,new W0)}}else bt(gl,"Using default OfflineComponentProvider"),await AS(n,new LW(void 0));return n._offlineComponents}async function _1(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(bt(gl,"Using user provided OnlineComponentProvider"),await bO(n,n._uninitializedComponentsProvider._online)):(bt(gl,"Using default OnlineComponentProvider"),await bO(n,new lx))),n._onlineComponents}function UW(n){return _1(n).then((t=>t.syncEngine))}function zW(n){return _1(n).then((t=>t.datastore))}async function QV(n){const t=await _1(n),e=t.eventManager;return e.onListen=wW.bind(null,t.syncEngine),e.onUnlisten=CW.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=xW.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=AW.bind(null,t.syncEngine),e}function HW(n,t,e={}){const r=new zs;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,l,u,h){const d=new XV({next:g=>{d.Nu(),o.enqueueAndForget((()=>FV(s,m)));const v=g.docs.has(l);!v&&g.fromCache?h.reject(new gt(it.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&u&&u.source==="server"?h.reject(new gt(it.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(g)},error:g=>h.reject(g)}),m=new UV(t1(l.path),d,{includeMetadataChanges:!0,Ka:!0});return BV(s,m)})(await QV(n),n.asyncQueue,t,e,r))),r.promise}function $W(n,t,e={}){const r=new zs;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,l,u,h){const d=new XV({next:g=>{d.Nu(),o.enqueueAndForget((()=>FV(s,m))),g.fromCache&&u.source==="server"?h.reject(new gt(it.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(g)},error:g=>h.reject(g)}),m=new UV(l,d,{includeMetadataChanges:!0,Ka:!0});return BV(s,m)})(await QV(n),n.asyncQueue,t,e,r))),r.promise}function qW(n,t){const e=new zs;return n.asyncQueue.enqueueAndForget((async()=>kW(await UW(n),t,e))),e.promise}function GW(n,t,e){const r=new zs;return n.asyncQueue.enqueueAndForget((async()=>{const i=await zW(n);new jW(n.asyncQueue,i,e,t,r).ju()})),r.promise}function JV(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}const WW="ComponentProvider",_O=new Map;function YW(n,t,e,r,i){return new hG(n,t,e,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,JV(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}const ZV="firestore.googleapis.com",TO=!0;class SO{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new gt(it.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ZV,this.ssl=TO}else this.host=t.host,this.ssl=t.ssl??TO;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=kV;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<v7)throw new gt(it.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}tG("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=JV(t.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new gt(it.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new gt(it.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new gt(it.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Eb{constructor(t,e,r,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new SO({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new gt(it.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new gt(it.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new SO(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new $q;switch(r.type){case"firstParty":return new Yq(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new gt(it.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const r=_O.get(e);r&&(bt(WW,"Removing Datastore"),_O.delete(e),r.terminate())})(this),Promise.resolve()}}function KW(n,t,e,r={}){n=Ws(n,Eb);const i=El(t),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${t}:${e}`;i&&(OE(`https://${l}`),IE("Firestore",!0)),s.host!==ZV&&s.host!==l&&Yc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:i,emulatorOptions:r};if(!Hc(u,o)&&(n._setSettings(u),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=tr.MOCK_USER;else{h=$N(r.mockUserToken,n._app?.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new gt(it.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new tr(m)}n._authCredentials=new qq(new LL(h,d))}}class Dl{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Dl(this.firestore,t,this._query)}}class Ye{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new il(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ye(this.firestore,t,this._key)}toJSON(){return{type:Ye._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,r){if(cm(e,Ye._jsonSchema))return new Ye(t,r||null,new At(Se.fromString(e.referencePath)))}}Ye._jsonSchemaVersion="firestore/documentReference/1.0",Ye._jsonSchema={type:vn("string",Ye._jsonSchemaVersion),referencePath:vn("string")};class il extends Dl{constructor(t,e,r){super(t,e,t1(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ye(this.firestore,null,new At(t))}withConverter(t){return new il(this.firestore,t,this._path)}}function t3(n,t,...e){if(n=Le(n),VL("collection","path",t),n instanceof Eb){const r=Se.fromString(t,...e);return ND(r),new il(n,null,r)}{if(!(n instanceof Ye||n instanceof il))throw new gt(it.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Se.fromString(t,...e));return ND(r),new il(n.firestore,null,r)}}function Vo(n,t,...e){if(n=Le(n),arguments.length===1&&(t=YE.newId()),VL("doc","path",t),n instanceof Eb){const r=Se.fromString(t,...e);return PD(r),new Ye(n,null,new At(r))}{if(!(n instanceof Ye||n instanceof il))throw new gt(it.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Se.fromString(t,...e));return PD(r),new Ye(n.firestore,n instanceof il?n.converter:null,new At(r))}}const wO="AsyncQueue";class xO{constructor(t=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new u1(this,"async_queue_retry"),this._c=()=>{const r=CS();r&&bt(wO,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=t;const e=CS();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=CS();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new zs;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Yu.push(t),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(t){if(!Jh(t))throw t;bt(wO,"Operation failed with retryable error: "+t)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((r=>{throw this.nc=r,this.rc=!1,$o("INTERNAL UNHANDLED ERROR: ",EO(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=e,e}enqueueAfterDelay(t,e,r){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const i=m1.createAndSchedule(this,t,e,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Ot(47125,{Pc:EO(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,r)=>e.targetTimeMs-r.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}Rc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function EO(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}class ef extends Eb{constructor(t,e,r,i){super(t,e,r,i),this.type="firestore",this._queue=new xO,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new xO(t),this._firestoreClient=void 0,await t}}}function XW(n,t){const e=typeof n=="object"?n:LE(),r=typeof n=="string"?n:j0,i=ub(e,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=UN("firestore");s&&KW(i,...s)}return i}function Cb(n){if(n._terminated)throw new gt(it.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||QW(n),n._firestoreClient}function QW(n){const t=n._freezeSettings(),e=YW(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,t);n._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new BW(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}class Yr{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Yr(Xn.fromBase64String(t))}catch(e){throw new gt(it.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Yr(Xn.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Yr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(cm(t,Yr._jsonSchema))return Yr.fromBase64String(t.bytes)}}Yr._jsonSchemaVersion="firestore/bytes/1.0",Yr._jsonSchema={type:vn("string",Yr._jsonSchemaVersion),bytes:vn("string")};class Ab{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new gt(it.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Wn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class kb{constructor(t){this._methodName=t}}class $s{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new gt(it.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new gt(it.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Zt(this._lat,t._lat)||Zt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$s._jsonSchemaVersion}}static fromJSON(t){if(cm(t,$s._jsonSchema))return new $s(t.latitude,t.longitude)}}$s._jsonSchemaVersion="firestore/geoPoint/1.0",$s._jsonSchema={type:vn("string",$s._jsonSchemaVersion),latitude:vn("number"),longitude:vn("number")};class es{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,t._values)}toJSON(){return{type:es._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(cm(t,es._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new es(t.vectorValues);throw new gt(it.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}es._jsonSchemaVersion="firestore/vectorValue/1.0",es._jsonSchema={type:vn("string",es._jsonSchemaVersion),vectorValues:vn("object")};const JW=/^__.*__$/;class ZW{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return this.fieldMask!==null?new Ml(t,this.data,this.fieldMask,e,this.fieldTransforms):new hm(t,this.data,e,this.fieldTransforms)}}class e3{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new Ml(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function n3(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ot(40011,{dataSource:n})}}class T1{constructor(t,e,r,i,s,o){this.settings=t,this.databaseId=e,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(t){return new T1({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(t){const e=this.path?.child(t),r=this.contextWith({path:e,arrayElement:!1});return r.validatePathSegment(t),r}childContextForFieldPath(t){const e=this.path?.child(t),r=this.contextWith({path:e,arrayElement:!1});return r.validatePath(),r}childContextForArray(t){return this.contextWith({path:void 0,arrayElement:!0})}createError(t){return Y0(t,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}validatePath(){if(this.path)for(let t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))}validatePathSegment(t){if(t.length===0)throw this.createError("Document fields must not be empty");if(n3(this.dataSource)&&JW.test(t))throw this.createError('Document fields cannot begin and end with "__"')}}class tY{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=r||Sb(t)}createContext(t,e,r,i=!1){return new T1({dataSource:t,methodName:e,targetDoc:r,path:Wn.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rb(n){const t=n._freezeSettings(),e=Sb(n._databaseId);return new tY(n._databaseId,!!t.ignoreUndefinedProperties,e)}function r3(n,t,e,r,i,s={}){const o=n.createContext(s.merge||s.mergeFields?2:0,t,e,i);w1("Data must be an object, but it was:",o,r);const l=o3(r,o);let u,h;if(s.merge)u=new Xr(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const m of s.mergeFields){const g=Xc(t,m,e);if(!o.contains(g))throw new gt(it.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);c3(d,g)||d.push(g)}u=new Xr(d),h=o.fieldTransforms.filter((m=>u.covers(m.field)))}else u=null,h=o.fieldTransforms;return new ZW(new pr(l),u,h)}class Mb extends kb{_toFieldTransform(t){if(t.dataSource!==2)throw t.dataSource===1?t.createError(`${this._methodName}() can only appear at the top level of your update data`):t.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Mb}}class S1 extends kb{_toFieldTransform(t){return new FG(t.path,new kp)}isEqual(t){return t instanceof S1}}function i3(n,t,e,r){const i=n.createContext(1,t,e);w1("Data must be an object, but it was:",i,r);const s=[],o=pr.empty();Rl(r,((u,h)=>{const d=l3(t,u,e);h=Le(h);const m=i.childContextForFieldPath(d);if(h instanceof Mb)s.push(d);else{const g=mm(h,m);g!=null&&(s.push(d),o.set(d,g))}}));const l=new Xr(s);return new e3(o,l,i.fieldTransforms)}function s3(n,t,e,r,i,s){const o=n.createContext(1,t,e),l=[Xc(t,r,e)],u=[i];if(s.length%2!=0)throw new gt(it.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push(Xc(t,s[g])),u.push(s[g+1]);const h=[],d=pr.empty();for(let g=l.length-1;g>=0;--g)if(!c3(h,l[g])){const v=l[g];let T=u[g];T=Le(T);const S=o.childContextForFieldPath(v);if(T instanceof Mb)h.push(v);else{const w=mm(T,S);w!=null&&(h.push(v),d.set(v,w))}}const m=new Xr(h);return new e3(d,m,o.fieldTransforms)}function eY(n,t,e,r=!1){return mm(e,n.createContext(r?4:3,t))}function mm(n,t){if(a3(n=Le(n)))return w1("Unsupported field value:",t,n),o3(n,t);if(n instanceof kb)return(function(r,i){if(!n3(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.arrayElement&&t.dataSource!==4)throw t.createError("Nested arrays are not supported");return(function(r,i){const s=[];let o=0;for(const l of r){let u=mm(l,i.childContextForArray(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,t)}return(function(r,i){if((r=Le(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return VG(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=we.fromDate(r);return{timestampValue:H0(i.serializer,s)}}if(r instanceof we){const s=new we(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:H0(i.serializer,s)}}if(r instanceof $s)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Yr)return{bytesValue:bV(i.serializer,r._byteString)};if(r instanceof Ye){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:s1(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof es)return(function(o,l){const u=o instanceof es?o.toArray():o;return{mapValue:{fields:{[GL]:{stringValue:WL},[B0]:{arrayValue:{values:u.map((d=>{if(typeof d!="number")throw l.createError("VectorValues must only contain numeric values.");return e1(l.serializer,d)}))}}}}}})(r,i);if(AV(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${pb(r)}`)})(n,t)}function o3(n,t){const e={};return FL(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Rl(n,((r,i)=>{const s=mm(i,t.childContextForField(r));s!=null&&(e[r]=s)})),{mapValue:{fields:e}}}function a3(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof we||n instanceof $s||n instanceof Yr||n instanceof Ye||n instanceof kb||n instanceof es||AV(n))}function w1(n,t,e){if(!a3(e)||!jL(e)){const r=pb(e);throw r==="an object"?t.createError(n+" a custom object"):t.createError(n+" "+r)}}function Xc(n,t,e){if((t=Le(t))instanceof Ab)return t._internalPath;if(typeof t=="string")return l3(n,t);throw Y0("Field path arguments must be of type string or ",n,!1,void 0,e)}const nY=new RegExp("[~\\*/\\[\\]]");function l3(n,t,e){if(t.search(nY)>=0)throw Y0(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Ab(...t.split("."))._internalPath}catch{throw Y0(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function Y0(n,t,e,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${t}() called with invalid data`;e&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new gt(it.INVALID_ARGUMENT,l+n+u)}function c3(n,t){return n.some((e=>e.isEqual(t)))}class u3{convertValue(t,e="none"){switch(pl(t)){case 0:return null;case 1:return t.booleanValue;case 2:return nn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(dl(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw Ot(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const r={};return Rl(t,((i,s)=>{r[i]=this.convertValue(s,e)})),r}convertVectorValue(t){const e=t.fields?.[B0].arrayValue?.values?.map((r=>nn(r.doubleValue)));return new es(e)}convertGeoPoint(t){return new $s(nn(t.latitude),nn(t.longitude))}convertArray(t,e){return(t.values||[]).map((r=>this.convertValue(r,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const r=gb(t);return r==null?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(xp(t));default:return null}}convertTimestamp(t){const e=fl(t);return new we(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=Se.fromString(t);ie(CV(r),9688,{name:t});const i=new Ep(r.get(1),r.get(3)),s=new At(r.popFirst(5));return i.isEqual(e)||$o(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}class x1 extends u3{constructor(t){super(),this.firestore=t}convertBytes(t){return new Yr(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ye(this.firestore,null,e)}}function h3(){return new S1("serverTimestamp")}const CO="@firebase/firestore",AO="4.11.0";class K0{constructor(t,e,r,i,s){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ye(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new rY(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(t){if(this._document){const e=this._document.data.field(Xc("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class rY extends K0{data(){return super.data()}}function iY(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new gt(it.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class E1{}class C1 extends E1{}function sY(n,t,...e){let r=[];t instanceof E1&&r.push(t),r=r.concat(e),(function(s){const o=s.filter((u=>u instanceof A1)).length,l=s.filter((u=>u instanceof Db)).length;if(o>1||o>0&&l>0)throw new gt(it.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Db extends C1{constructor(t,e,r){super(),this._field=t,this._op=e,this._value=r,this.type="where"}static _create(t,e,r){return new Db(t,e,r)}_apply(t){const e=this._parse(t);return f3(t._query,e),new Dl(t.firestore,t.converter,tx(t._query,e))}_parse(t){const e=Rb(t.firestore);return(function(s,o,l,u,h,d,m){let g;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new gt(it.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){RO(m,d);const T=[];for(const S of m)T.push(kO(u,s,S));g={arrayValue:{values:T}}}else g=kO(u,s,m)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||RO(m,d),g=eY(l,o,m,d==="in"||d==="not-in");return yn.create(h,d,g)})(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}function oY(n,t,e){const r=t,i=Xc("where",n);return Db._create(i,r,e)}class A1 extends E1{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new A1(t,e)}_parse(t){const e=this._queryConstraints.map((r=>r._parse(t))).filter((r=>r.getFilters().length>0));return e.length===1?e[0]:ls.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:((function(i,s){let o=i;const l=s.getFlattenedFilters();for(const u of l)f3(o,u),o=tx(o,u)})(t._query,e),new Dl(t.firestore,t.converter,tx(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class k1 extends C1{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new k1(t,e)}_apply(t){const e=(function(i,s,o){if(i.startAt!==null)throw new gt(it.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new gt(it.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ap(s,o)})(t._query,this._field,this._direction);return new Dl(t.firestore,t.converter,RG(t._query,e))}}function aY(n,t="asc"){const e=t,r=Xc("orderBy",n);return k1._create(r,e)}class R1 extends C1{constructor(t,e,r){super(),this.type=t,this._limit=e,this._limitType=r}static _create(t,e,r){return new R1(t,e,r)}_apply(t){return new Dl(t.firestore,t.converter,U0(t._query,this._limit,this._limitType))}}function lY(n){return R1._create("limit",n,"F")}function kO(n,t,e){if(typeof(e=Le(e))=="string"){if(e==="")throw new gt(it.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!eV(t)&&e.indexOf("/")!==-1)throw new gt(it.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const r=t.path.child(Se.fromString(e));if(!At.isDocumentKey(r))throw new gt(it.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return HD(n,new At(r))}if(e instanceof Ye)return HD(n,e._key);throw new gt(it.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${pb(e)}.`)}function RO(n,t){if(!Array.isArray(n)||n.length===0)throw new gt(it.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function f3(n,t){const e=(function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(e!==null)throw e===t.op?new gt(it.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new gt(it.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}function d3(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}class cY extends u3{constructor(t){super(),this.firestore=t}convertBytes(t){return new Yr(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ye(this.firestore,null,e)}}class uh{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class sl extends K0{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new u0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(Xc("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new gt(it.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=sl._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}sl._jsonSchemaVersion="firestore/documentSnapshot/1.0",sl._jsonSchema={type:vn("string",sl._jsonSchemaVersion),bundleSource:vn("string","DocumentSnapshot"),bundleName:vn("string"),bundle:vn("string")};class u0 extends sl{data(t={}){return super.data(t)}}class Eh{constructor(t,e,r,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new uh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((r=>{t.call(e,new u0(this._firestore,this._userDataWriter,r.key,r,new uh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new gt(it.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((l=>{const u=new u0(i._firestore,i._userDataWriter,l.doc.key,l.doc,new uh(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new u0(i._firestore,i._userDataWriter,l.doc.key,l.doc,new uh(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,d=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:uY(l.type),doc:u,oldIndex:h,newIndex:d}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new gt(it.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Eh._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=YE.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(e.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function uY(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ot(61501,{type:n})}}Eh._jsonSchemaVersion="firestore/querySnapshot/1.0",Eh._jsonSchema={type:vn("string",Eh._jsonSchemaVersion),bundleSource:vn("string","QuerySnapshot"),bundleName:vn("string"),bundle:vn("string")};const hY={maxAttempts:5};function jd(n,t){if((n=Le(n)).firestore!==t)throw new gt(it.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class fY{constructor(t,e){this._firestore=t,this._transaction=e,this._dataReader=Rb(t)}get(t){const e=jd(t,this._firestore),r=new cY(this._firestore);return this._transaction.lookup([e._key]).then((i=>{if(!i||i.length!==1)return Ot(24041);const s=i[0];if(s.isFoundDocument())return new K0(this._firestore,r,s.key,s,e.converter);if(s.isNoDocument())return new K0(this._firestore,r,e._key,null,e.converter);throw Ot(18433,{doc:s})}))}set(t,e,r){const i=jd(t,this._firestore),s=d3(i.converter,e,r),o=r3(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(t,e,r,...i){const s=jd(t,this._firestore);let o;return o=typeof(e=Le(e))=="string"||e instanceof Ab?s3(this._dataReader,"Transaction.update",s._key,e,r,i):i3(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this}delete(t){const e=jd(t,this._firestore);return this._transaction.delete(e._key),this}}let dY=class extends fY{constructor(t,e){super(t,e),this._firestore=t}get(t){const e=jd(t,this._firestore),r=new x1(this._firestore);return super.get(t).then((i=>new sl(this._firestore,r,e._key,i._document,new uh(!1,!1),e.converter)))}};function pY(n,t,e){n=Ws(n,ef);const r={...hY,...e};(function(o){if(o.maxAttempts<1)throw new gt(it.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const i=Cb(n);return GW(i,(s=>t(new dY(n,s))),r)}function Ob(n){n=Ws(n,Ye);const t=Ws(n.firestore,ef),e=Cb(t);return HW(e,n._key).then((r=>yY(t,n,r)))}function mY(n){n=Ws(n,Dl);const t=Ws(n.firestore,ef),e=Cb(t),r=new x1(t);return iY(n._query),$W(e,n._query).then((i=>new Eh(t,r,n,i)))}function p3(n,t,e){n=Ws(n,Ye);const r=Ws(n.firestore,ef),i=d3(n.converter,t,e),s=Rb(r);return m3(r,[r3(s,"setDoc",n._key,i,n.converter!==null,e).toMutation(n._key,mr.none())])}function gY(n,t,e,...r){n=Ws(n,Ye);const i=Ws(n.firestore,ef),s=Rb(i);let o;return o=typeof(t=Le(t))=="string"||t instanceof Ab?s3(s,"updateDoc",n._key,t,e,r):i3(s,"updateDoc",n._key,t),m3(i,[o.toMutation(n._key,mr.exists(!0))])}function m3(n,t){const e=Cb(n);return qW(e,t)}function yY(n,t,e){const r=e.docs.get(t._key),i=new x1(n);return new sl(n,i,t._key,r,new uh(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){Hq(su),$c(new ul("firestore",((r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new ef(new Gq(r.getProvider("auth-internal")),new Kq(o,r.getProvider("app-check-internal")),fG(o,i),o);return s={useFetchStreams:e,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),Fs(CO,AO,t),Fs(CO,AO,"esm2020")})();var vY="firebase",bY="12.9.0";Fs(vY,bY,"app");const g3="firebasestorage.googleapis.com",y3="storageBucket",_Y=120*1e3,TY=600*1e3;class Qe extends Zs{constructor(t,e,r=0){super(kS(t),`Firebase Storage: ${e} (${kS(t)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Qe.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return kS(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ke;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ke||(Ke={}));function kS(n){return"storage/"+n}function M1(){const n="An unknown error occurred, please check the error payload for server response.";return new Qe(Ke.UNKNOWN,n)}function SY(n){return new Qe(Ke.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function wY(n){return new Qe(Ke.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function xY(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Qe(Ke.UNAUTHENTICATED,n)}function EY(){return new Qe(Ke.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function CY(n){return new Qe(Ke.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function AY(){return new Qe(Ke.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function kY(){return new Qe(Ke.CANCELED,"User canceled the upload/download.")}function RY(n){return new Qe(Ke.INVALID_URL,"Invalid URL '"+n+"'.")}function MY(n){return new Qe(Ke.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function DY(){return new Qe(Ke.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+y3+"' property when initializing the app?")}function OY(){return new Qe(Ke.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function IY(){return new Qe(Ke.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function PY(n){return new Qe(Ke.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function cx(n){return new Qe(Ke.INVALID_ARGUMENT,n)}function v3(){return new Qe(Ke.APP_DELETED,"The Firebase app was deleted.")}function NY(n){return new Qe(Ke.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Zd(n,t){return new Qe(Ke.INVALID_FORMAT,"String does not match format '"+n+"': "+t)}function Sd(n){throw new Qe(Ke.INTERNAL_ERROR,"Internal error: "+n)}class Qr{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let r;try{r=Qr.makeFromUrl(t,e)}catch{return new Qr(t,"")}if(r.path==="")return r;throw MY(t)}static makeFromUrl(t,e){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+i+o,"i"),u={bucket:1,path:3};function h(j){j.path_=decodeURIComponent(j.path)}const d="v[A-Za-z0-9_]+",m=e.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",v=new RegExp(`^https?://${m}/${d}/b/${i}/o${g}`,"i"),T={bucket:1,path:3},S=e===g3?"(?:storage.googleapis.com|storage.cloud.google.com)":e,w="([^?#]*)",E=new RegExp(`^https?://${S}/${i}/${w}`,"i"),P=[{regex:l,indices:u,postModify:s},{regex:v,indices:T,postModify:h},{regex:E,indices:{bucket:1,path:2},postModify:h}];for(let j=0;j<P.length;j++){const N=P[j],W=N.regex.exec(t);if(W){const M=W[N.indices.bucket];let k=W[N.indices.path];k||(k=""),r=new Qr(M,k),N.postModify(r);break}}if(r==null)throw RY(t);return r}}class LY{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function VY(n,t,e){let r=1,i=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function d(...w){h||(h=!0,t.apply(null,w))}function m(w){i=setTimeout(()=>{i=null,n(v,u())},w)}function g(){s&&clearTimeout(s)}function v(w,...E){if(h){g();return}if(w){g(),d.call(null,w,...E);return}if(u()||o){g(),d.call(null,w,...E);return}r<64&&(r*=2);let P;l===1?(l=2,P=0):P=(r+Math.random())*1e3,m(P)}let T=!1;function S(w){T||(T=!0,g(),!h&&(i!==null?(w||(l=2),clearTimeout(i),m(0)):w||(l=1)))}return m(0),s=setTimeout(()=>{o=!0,S(!0)},e),S}function jY(n){n(!1)}function BY(n){return n!==void 0}function FY(n){return typeof n=="object"&&!Array.isArray(n)}function D1(n){return typeof n=="string"||n instanceof String}function MO(n){return O1()&&n instanceof Blob}function O1(){return typeof Blob<"u"}function DO(n,t,e,r){if(r<t)throw cx(`Invalid value for '${n}'. Expected ${t} or greater.`);if(r>e)throw cx(`Invalid value for '${n}'. Expected ${e} or less.`)}function I1(n,t,e){let r=t;return e==null&&(r=`https://${t}`),`${e}://${r}/v0${n}`}function b3(n){const t=encodeURIComponent;let e="?";for(const r in n)if(n.hasOwnProperty(r)){const i=t(r)+"="+t(n[r]);e=e+i+"&"}return e=e.slice(0,-1),e}var Pc;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Pc||(Pc={}));function UY(n,t){const e=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=t.indexOf(n)!==-1;return e||i||s}class zY{constructor(t,e,r,i,s,o,l,u,h,d,m,g=!0,v=!1){this.url_=t,this.method_=e,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=d,this.connectionFactory_=m,this.retry=g,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,S)=>{this.resolve_=T,this.reject_=S,this.start_()})}start_(){const t=(r,i)=>{if(i){r(!1,new cy(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===Pc.NO_ERROR,u=s.getStatus();if(!l||UY(u,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===Pc.ABORT;r(!1,new cy(!1,null,d));return}const h=this.successCodes_.indexOf(u)!==-1;r(!0,new cy(h,s))})},e=(r,i)=>{const s=this.resolve_,o=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());BY(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=M1();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(i.canceled){const u=this.appDelete_?v3():kY();o(u)}else{const u=AY();o(u)}};this.canceled_?e(!1,new cy(!1,null,!0)):this.backoffId_=VY(t,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&jY(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class cy{constructor(t,e,r){this.wasSuccessCode=t,this.connection=e,this.canceled=!!r}}function HY(n,t){t!==null&&t.length>0&&(n.Authorization="Firebase "+t)}function $Y(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function qY(n,t){t&&(n["X-Firebase-GMPID"]=t)}function GY(n,t){t!==null&&(n["X-Firebase-AppCheck"]=t)}function WY(n,t,e,r,i,s,o=!0,l=!1){const u=b3(n.urlParams),h=n.url+u,d=Object.assign({},n.headers);return qY(d,t),HY(d,e),$Y(d,s),GY(d,r),new zY(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o,l)}function YY(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function KY(...n){const t=YY();if(t!==void 0){const e=new t;for(let r=0;r<n.length;r++)e.append(n[r]);return e.getBlob()}else{if(O1())return new Blob(n);throw new Qe(Ke.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function XY(n,t,e){return n.webkitSlice?n.webkitSlice(t,e):n.mozSlice?n.mozSlice(t,e):n.slice?n.slice(t,e):null}function QY(n){if(typeof atob>"u")throw PY("base-64");return atob(n)}const Vs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class RS{constructor(t,e){this.data=t,this.contentType=e||null}}function JY(n,t){switch(n){case Vs.RAW:return new RS(_3(t));case Vs.BASE64:case Vs.BASE64URL:return new RS(T3(n,t));case Vs.DATA_URL:return new RS(tK(t),eK(t))}throw M1()}function _3(n){const t=[];for(let e=0;e<n.length;e++){let r=n.charCodeAt(e);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(e<n.length-1&&(n.charCodeAt(e+1)&64512)===56320))t.push(239,191,189);else{const s=r,o=n.charCodeAt(++e);r=65536|(s&1023)<<10|o&1023,t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(t)}function ZY(n){let t;try{t=decodeURIComponent(n)}catch{throw Zd(Vs.DATA_URL,"Malformed data URL.")}return _3(t)}function T3(n,t){switch(n){case Vs.BASE64:{const i=t.indexOf("-")!==-1,s=t.indexOf("_")!==-1;if(i||s)throw Zd(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Vs.BASE64URL:{const i=t.indexOf("+")!==-1,s=t.indexOf("/")!==-1;if(i||s)throw Zd(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let e;try{e=QY(t)}catch(i){throw i.message.includes("polyfill")?i:Zd(n,"Invalid character found")}const r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r}class S3{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(e===null)throw Zd(Vs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=e[1]||null;r!=null&&(this.base64=nK(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}}function tK(n){const t=new S3(n);return t.base64?T3(Vs.BASE64,t.rest):ZY(t.rest)}function eK(n){return new S3(n).contentType}function nK(n,t){return n.length>=t.length?n.substring(n.length-t.length)===t:!1}class Ga{constructor(t,e){let r=0,i="";MO(t)?(this.data_=t,r=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,e){if(MO(this.data_)){const r=this.data_,i=XY(r,t,e);return i===null?null:new Ga(i)}else{const r=new Uint8Array(this.data_.buffer,t,e-t);return new Ga(r,!0)}}static getBlob(...t){if(O1()){const e=t.map(r=>r instanceof Ga?r.data_:r);return new Ga(KY.apply(null,e))}else{const e=t.map(o=>D1(o)?JY(Vs.RAW,o).data:o.data_);let r=0;e.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return e.forEach(o=>{for(let l=0;l<o.length;l++)i[s++]=o[l]}),new Ga(i,!0)}}uploadData(){return this.data_}}function w3(n){let t;try{t=JSON.parse(n)}catch{return null}return FY(t)?t:null}function rK(n){if(n.length===0)return null;const t=n.lastIndexOf("/");return t===-1?"":n.slice(0,t)}function iK(n,t){const e=t.split("/").filter(r=>r.length>0).join("/");return n.length===0?e:n+"/"+e}function x3(n){const t=n.lastIndexOf("/",n.length-2);return t===-1?n:n.slice(t+1)}function sK(n,t){return t}let cr=class{constructor(t,e,r,i){this.server=t,this.local=e||t,this.writable=!!r,this.xform=i||sK}},uy=null;function oK(n){return!D1(n)||n.length<2?n:x3(n)}function E3(){if(uy)return uy;const n=[];n.push(new cr("bucket")),n.push(new cr("generation")),n.push(new cr("metageneration")),n.push(new cr("name","fullPath",!0));function t(s,o){return oK(o)}const e=new cr("name");e.xform=t,n.push(e);function r(s,o){return o!==void 0?Number(o):o}const i=new cr("size");return i.xform=r,n.push(i),n.push(new cr("timeCreated")),n.push(new cr("updated")),n.push(new cr("md5Hash",null,!0)),n.push(new cr("cacheControl",null,!0)),n.push(new cr("contentDisposition",null,!0)),n.push(new cr("contentEncoding",null,!0)),n.push(new cr("contentLanguage",null,!0)),n.push(new cr("contentType",null,!0)),n.push(new cr("metadata","customMetadata",!0)),uy=n,uy}function aK(n,t){function e(){const r=n.bucket,i=n.fullPath,s=new Qr(r,i);return t._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:e})}function lK(n,t,e){const r={};r.type="file";const i=e.length;for(let s=0;s<i;s++){const o=e[s];r[o.local]=o.xform(r,t[o.server])}return aK(r,n),r}function C3(n,t,e){const r=w3(t);return r===null?null:lK(n,r,e)}function cK(n,t,e,r){const i=w3(t);if(i===null||!D1(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(h=>{const d=n.bucket,m=n.fullPath,g="/b/"+o(d)+"/o/"+o(m),v=I1(g,e,r),T=b3({alt:"media",token:h});return v+T})[0]}function uK(n,t){const e={},r=t.length;for(let i=0;i<r;i++){const s=t[i];s.writable&&(e[s.server]=n[s.local])}return JSON.stringify(e)}class A3{constructor(t,e,r,i){this.url=t,this.method=e,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function k3(n){if(!n)throw M1()}function hK(n,t){function e(r,i){const s=C3(n,i,t);return k3(s!==null),s}return e}function fK(n,t){function e(r,i){const s=C3(n,i,t);return k3(s!==null),cK(s,i,n.host,n._protocol)}return e}function R3(n){function t(e,r){let i;return e.getStatus()===401?e.getErrorText().includes("Firebase App Check token is invalid")?i=EY():i=xY():e.getStatus()===402?i=wY(n.bucket):e.getStatus()===403?i=CY(n.path):i=r,i.status=e.getStatus(),i.serverResponse=r.serverResponse,i}return t}function dK(n){const t=R3(n);function e(r,i){let s=t(r,i);return r.getStatus()===404&&(s=SY(n.path)),s.serverResponse=i.serverResponse,s}return e}function pK(n,t,e){const r=t.fullServerUrl(),i=I1(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,l=new A3(i,s,fK(n,e),o);return l.errorHandler=dK(t),l}function mK(n,t){return n&&n.contentType||t&&t.type()||"application/octet-stream"}function gK(n,t,e){const r=Object.assign({},e);return r.fullPath=n.path,r.size=t.size(),r.contentType||(r.contentType=mK(null,t)),r}function yK(n,t,e,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let P="";for(let j=0;j<2;j++)P=P+Math.random().toString().slice(2);return P}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const h=gK(t,r,i),d=uK(h,e),m="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+u+`\r
Content-Type: `+h.contentType+`\r
\r
`,g=`\r
--`+u+"--",v=Ga.getBlob(m,r,g);if(v===null)throw OY();const T={name:h.fullPath},S=I1(s,n.host,n._protocol),w="POST",E=n.maxUploadRetryTime,R=new A3(S,w,hK(n,e),E);return R.urlParams=T,R.headers=o,R.body=v.uploadData(),R.errorHandler=R3(t),R}class vK{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Pc.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Pc.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Pc.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,e,r,i,s){if(this.sent_)throw Sd("cannot .send() more than once");if(El(t)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(e,t,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Sd("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Sd("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Sd("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Sd("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class bK extends vK{initXhr(){this.xhr_.responseType="text"}}function M3(){return new bK}class Qc{constructor(t,e){this._service=t,e instanceof Qr?this._location=e:this._location=Qr.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Qc(t,e)}get root(){const t=new Qr(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return x3(this._location.path)}get storage(){return this._service}get parent(){const t=rK(this._location.path);if(t===null)return null;const e=new Qr(this._location.bucket,t);return new Qc(this._service,e)}_throwIfRoot(t){if(this._location.path==="")throw NY(t)}}function _K(n,t,e){n._throwIfRoot("uploadBytes");const r=yK(n.storage,n._location,E3(),new Ga(t,!0),e);return n.storage.makeRequestWithTokens(r,M3).then(i=>({metadata:i,ref:n}))}function TK(n){n._throwIfRoot("getDownloadURL");const t=pK(n.storage,n._location,E3());return n.storage.makeRequestWithTokens(t,M3).then(e=>{if(e===null)throw IY();return e})}function SK(n,t){const e=iK(n._location.path,t),r=new Qr(n._location.bucket,e);return new Qc(n.storage,r)}function wK(n){return/^[A-Za-z]+:\/\//.test(n)}function xK(n,t){return new Qc(n,t)}function D3(n,t){if(n instanceof P1){const e=n;if(e._bucket==null)throw DY();const r=new Qc(e,e._bucket);return t!=null?D3(r,t):r}else return t!==void 0?SK(n,t):n}function EK(n,t){if(t&&wK(t)){if(n instanceof P1)return xK(n,t);throw cx("To use ref(service, url), the first argument must be a Storage instance.")}else return D3(n,t)}function OO(n,t){const e=t?.[y3];return e==null?null:Qr.makeFromBucketSpec(e,n)}function CK(n,t,e,r={}){n.host=`${t}:${e}`;const i=El(t);i&&(OE(`https://${n.host}/b`),IE("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:$N(s,n.app.options.projectId))}class P1{constructor(t,e,r,i,s,o=!1){this.app=t,this._authProvider=e,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=g3,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=_Y,this._maxUploadRetryTime=TY,this._requests=new Set,i!=null?this._bucket=Qr.makeFromBucketSpec(i,this._host):this._bucket=OO(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Qr.makeFromBucketSpec(this._url,t):this._bucket=OO(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){DO("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){DO("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(e!==null)return e.accessToken}return null}async _getAppCheckToken(){if(Ir(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Qc(this,t)}_makeRequest(t,e,r,i,s=!0){if(this._deleted)return new LY(v3());{const o=WY(t,this._appId,r,i,e,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,e){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,r,i).getPromise()}}const IO="@firebase/storage",PO="0.14.0";const O3="storage";function I3(n,t,e){return n=Le(n),_K(n,t,e)}function P3(n){return n=Le(n),TK(n)}function N3(n,t){return n=Le(n),EK(n,t)}function AK(n=LE(),t){n=Le(n);const r=ub(n,O3).getImmediate({identifier:t}),i=UN("storage");return i&&kK(r,...i),r}function kK(n,t,e,r={}){CK(n,t,e,r)}function RK(n,{instanceIdentifier:t}){const e=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new P1(e,r,i,t,su)}function MK(){$c(new ul(O3,RK,"PUBLIC").setMultipleInstances(!0)),Fs(IO,PO,""),Fs(IO,PO,"esm2020")}MK();const DK={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0},N1=WN(DK),wd=Uq(N1),Qi=XW(N1),L3=AK(N1),V3=L.createContext(null),OK=new Ro;async function NO(n){const t=Vo(Qi,"users",n.uid);(await Ob(t)).exists()||await p3(t,{name:n.displayName||"",email:n.email||"",streak:0,longestStreak:0,theme:"pastel-pink",darkMode:!1,pinHash:null,lastEntryDate:null,createdAt:h3()})}function IK({children:n}){const[t,e]=L.useState(null),[r,i]=L.useState(!0);L.useEffect(()=>R8(wd,async v=>{v?(await NO(v),e(v)):e(null),i(!1)}),[]);const m={user:t,loading:r,signInWithGoogle:async()=>{const g=await X8(wd,OK);await NO(g.user)},signInWithEmail:async(g,v)=>{await C8(wd,g,v)},signUp:async(g,v,T)=>{const S=await E8(wd,g,v),w=Vo(Qi,"users",S.user.uid);await p3(w,{name:T||"",email:S.user.email||"",streak:0,longestStreak:0,theme:"pastel-pink",darkMode:!1,pinHash:null,lastEntryDate:null,createdAt:h3()})},signOut:async()=>{await M8(wd)},verifyPin:async g=>{if(!t)return!1;const v=Vo(Qi,"users",t.uid),T=await Ob(v);if(!T.exists())return!1;const S=T.data();return S.pinHash?S.pinHash===btoa(g):!1},setPin:async g=>{if(!t)return;const v=Vo(Qi,"users",t.uid);await gY(v,{pinHash:btoa(g)})}};return z.jsx(V3.Provider,{value:m,children:n})}function Ib(){const n=L.useContext(V3);if(n===null)throw new Error("useAuth must be used within an AuthProvider");return n}const PK=[{to:"/dashboard",label:"Dashboard",icon:""},{to:"/editor",label:"New Entry",icon:""},{to:"/calendar",label:"Calendar",icon:""}];function NK(){return z.jsxs("div",{className:"min-h-screen flex bg-[var(--color-background)]",children:[z.jsxs("aside",{className:"w-56 bg-[var(--color-surface)] border-r border-pink-100 flex flex-col shadow-sm",children:[z.jsx("div",{className:"p-5 border-b border-pink-100",children:z.jsx("h1",{className:"font-['Pacifico'] text-2xl text-pink-300",children:"DearMe "})}),z.jsx("nav",{className:"flex-1 p-3 flex flex-col gap-1",children:PK.map(({to:n,label:t,icon:e})=>z.jsxs(NN,{to:n,className:({isActive:r})=>`flex items-center gap-3 px-4 py-3 rounded-xl font-['Poppins'] text-sm transition-colors ${r?"bg-pink-100 text-pink-600 font-medium":"text-[var(--color-text)] hover:bg-pink-50"}`,children:[z.jsx("span",{className:"text-lg",children:e}),t]},n))}),z.jsx("div",{className:"p-3 border-t border-pink-100",children:z.jsxs("button",{className:"flex items-center gap-3 w-full px-4 py-3 rounded-xl font-['Poppins'] text-sm text-[var(--color-text)] hover:bg-red-50 hover:text-red-400 transition-colors cursor-pointer",children:[z.jsx("span",{className:"text-lg",children:""}),"Sign Out"]})})]}),z.jsx("main",{className:"flex-1 overflow-y-auto",children:z.jsx(DN,{})})]})}function LK(){const{user:n,loading:t}=Ib();return t?z.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[var(--color-background)]",children:z.jsxs("div",{className:"animate-pulse flex flex-col items-center gap-3",children:[z.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-200"}),z.jsx("p",{className:"font-['Poppins'] text-sm text-pink-300",children:"Loading..."})]})}):n?z.jsx(DN,{}):z.jsx(MN,{to:"/login",replace:!0})}const L1=L.createContext({});function V1(n){const t=L.useRef(null);return t.current===null&&(t.current=n()),t.current}const j3=typeof window<"u",B3=j3?L.useLayoutEffect:L.useEffect,Pb=L.createContext(null);function j1(n,t){n.indexOf(t)===-1&&n.push(t)}function X0(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}const Ks=(n,t,e)=>e>t?t:e<n?n:e;let B1=()=>{};const Go={},F3=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function U3(n){return typeof n=="object"&&n!==null}const z3=n=>/^0[^.\s]+$/u.test(n);function H3(n){let t;return()=>(t===void 0&&(t=n()),t)}const xi=n=>n,VK=(n,t)=>e=>t(n(e)),gm=(...n)=>n.reduce(VK),Dp=(n,t,e)=>{const r=t-n;return r===0?1:(e-n)/r};class F1{constructor(){this.subscriptions=[]}add(t){return j1(this.subscriptions,t),()=>X0(this.subscriptions,t)}notify(t,e,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](t,e,r);else for(let s=0;s<i;s++){const o=this.subscriptions[s];o&&o(t,e,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ns=n=>n*1e3,wi=n=>n/1e3;function $3(n,t){return t?n*(1e3/t):0}const q3=(n,t,e)=>(((1-3*e+3*t)*n+(3*e-6*t))*n+3*t)*n,jK=1e-7,BK=12;function FK(n,t,e,r,i){let s,o,l=0;do o=t+(e-t)/2,s=q3(o,r,i)-n,s>0?e=o:t=o;while(Math.abs(s)>jK&&++l<BK);return o}function ym(n,t,e,r){if(n===t&&e===r)return xi;const i=s=>FK(s,0,1,n,e);return s=>s===0||s===1?s:q3(i(s),t,r)}const G3=n=>t=>t<=.5?n(2*t)/2:(2-n(2*(1-t)))/2,W3=n=>t=>1-n(1-t),Y3=ym(.33,1.53,.69,.99),U1=W3(Y3),K3=G3(U1),X3=n=>(n*=2)<1?.5*U1(n):.5*(2-Math.pow(2,-10*(n-1))),z1=n=>1-Math.sin(Math.acos(n)),Q3=W3(z1),J3=G3(z1),UK=ym(.42,0,1,1),zK=ym(0,0,.58,1),Z3=ym(.42,0,.58,1),HK=n=>Array.isArray(n)&&typeof n[0]!="number",tj=n=>Array.isArray(n)&&typeof n[0]=="number",$K={linear:xi,easeIn:UK,easeInOut:Z3,easeOut:zK,circIn:z1,circInOut:J3,circOut:Q3,backIn:U1,backInOut:K3,backOut:Y3,anticipate:X3},qK=n=>typeof n=="string",LO=n=>{if(tj(n)){B1(n.length===4);const[t,e,r,i]=n;return ym(t,e,r,i)}else if(qK(n))return $K[n];return n},hy=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function GK(n,t){let e=new Set,r=new Set,i=!1,s=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function u(d){o.has(d)&&(h.schedule(d),n()),d(l)}const h={schedule:(d,m=!1,g=!1)=>{const T=g&&i?e:r;return m&&o.add(d),T.has(d)||T.add(d),d},cancel:d=>{r.delete(d),o.delete(d)},process:d=>{if(l=d,i){s=!0;return}i=!0,[e,r]=[r,e],e.forEach(u),e.clear(),i=!1,s&&(s=!1,h.process(d))}};return h}const WK=40;function ej(n,t){let e=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>e=!0,o=hy.reduce((P,j)=>(P[j]=GK(s),P),{}),{setup:l,read:u,resolveKeyframes:h,preUpdate:d,update:m,preRender:g,render:v,postRender:T}=o,S=()=>{const P=Go.useManualTiming?i.timestamp:performance.now();e=!1,Go.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(P-i.timestamp,WK),1)),i.timestamp=P,i.isProcessing=!0,l.process(i),u.process(i),h.process(i),d.process(i),m.process(i),g.process(i),v.process(i),T.process(i),i.isProcessing=!1,e&&t&&(r=!1,n(S))},w=()=>{e=!0,r=!0,i.isProcessing||n(S)};return{schedule:hy.reduce((P,j)=>{const N=o[j];return P[j]=(W,M=!1,k=!1)=>(e||w(),N.schedule(W,M,k)),P},{}),cancel:P=>{for(let j=0;j<hy.length;j++)o[hy[j]].cancel(P)},state:i,steps:o}}const{schedule:ke,cancel:yl,state:Hn,steps:MS}=ej(typeof requestAnimationFrame<"u"?requestAnimationFrame:xi,!0);let h0;function YK(){h0=void 0}const gr={now:()=>(h0===void 0&&gr.set(Hn.isProcessing||Go.useManualTiming?Hn.timestamp:performance.now()),h0),set:n=>{h0=n,queueMicrotask(YK)}},nj=n=>t=>typeof t=="string"&&t.startsWith(n),rj=nj("--"),KK=nj("var(--"),H1=n=>KK(n)?XK.test(n.split("/*")[0].trim()):!1,XK=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function VO(n){return typeof n!="string"?!1:n.split("/*")[0].includes("var(--")}const nf={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Op={...nf,transform:n=>Ks(0,1,n)},fy={...nf,default:1},tp=n=>Math.round(n*1e5)/1e5,$1=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function QK(n){return n==null}const JK=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,q1=(n,t)=>e=>!!(typeof e=="string"&&JK.test(e)&&e.startsWith(n)||t&&!QK(e)&&Object.prototype.hasOwnProperty.call(e,t)),ij=(n,t,e)=>r=>{if(typeof r!="string")return r;const[i,s,o,l]=r.match($1);return{[n]:parseFloat(i),[t]:parseFloat(s),[e]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},ZK=n=>Ks(0,255,n),DS={...nf,transform:n=>Math.round(ZK(n))},Ec={test:q1("rgb","red"),parse:ij("red","green","blue"),transform:({red:n,green:t,blue:e,alpha:r=1})=>"rgba("+DS.transform(n)+", "+DS.transform(t)+", "+DS.transform(e)+", "+tp(Op.transform(r))+")"};function tX(n){let t="",e="",r="",i="";return n.length>5?(t=n.substring(1,3),e=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(t=n.substring(1,2),e=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),t+=t,e+=e,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(e,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const ux={test:q1("#"),parse:tX,transform:Ec.transform},vm=n=>({test:t=>typeof t=="string"&&t.endsWith(n)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${n}`}),ja=vm("deg"),qs=vm("%"),St=vm("px"),eX=vm("vh"),nX=vm("vw"),jO={...qs,parse:n=>qs.parse(n)/100,transform:n=>qs.transform(n*100)},hh={test:q1("hsl","hue"),parse:ij("hue","saturation","lightness"),transform:({hue:n,saturation:t,lightness:e,alpha:r=1})=>"hsla("+Math.round(n)+", "+qs.transform(tp(t))+", "+qs.transform(tp(e))+", "+tp(Op.transform(r))+")"},gn={test:n=>Ec.test(n)||ux.test(n)||hh.test(n),parse:n=>Ec.test(n)?Ec.parse(n):hh.test(n)?hh.parse(n):ux.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Ec.transform(n):hh.transform(n),getAnimatableNone:n=>{const t=gn.parse(n);return t.alpha=0,gn.transform(t)}},rX=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function iX(n){return isNaN(n)&&typeof n=="string"&&(n.match($1)?.length||0)+(n.match(rX)?.length||0)>0}const sj="number",oj="color",sX="var",oX="var(",BO="${}",aX=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ip(n){const t=n.toString(),e=[],r={color:[],number:[],var:[]},i=[];let s=0;const l=t.replace(aX,u=>(gn.test(u)?(r.color.push(s),i.push(oj),e.push(gn.parse(u))):u.startsWith(oX)?(r.var.push(s),i.push(sX),e.push(u)):(r.number.push(s),i.push(sj),e.push(parseFloat(u))),++s,BO)).split(BO);return{values:e,split:l,indexes:r,types:i}}function aj(n){return Ip(n).values}function lj(n){const{split:t,types:e}=Ip(n),r=t.length;return i=>{let s="";for(let o=0;o<r;o++)if(s+=t[o],i[o]!==void 0){const l=e[o];l===sj?s+=tp(i[o]):l===oj?s+=gn.transform(i[o]):s+=i[o]}return s}}const lX=n=>typeof n=="number"?0:gn.test(n)?gn.getAnimatableNone(n):n;function cX(n){const t=aj(n);return lj(n)(t.map(lX))}const rs={test:iX,parse:aj,createTransformer:lj,getAnimatableNone:cX};function OS(n,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+(t-n)*6*e:e<1/2?t:e<2/3?n+(t-n)*(2/3-e)*6:n}function uX({hue:n,saturation:t,lightness:e,alpha:r}){n/=360,t/=100,e/=100;let i=0,s=0,o=0;if(!t)i=s=o=e;else{const l=e<.5?e*(1+t):e+t-e*t,u=2*e-l;i=OS(u,l,n+1/3),s=OS(u,l,n),o=OS(u,l,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:r}}function Q0(n,t){return e=>e>0?t:n}const Fe=(n,t,e)=>n+(t-n)*e,IS=(n,t,e)=>{const r=n*n,i=e*(t*t-r)+r;return i<0?0:Math.sqrt(i)},hX=[ux,Ec,hh],fX=n=>hX.find(t=>t.test(n));function FO(n){const t=fX(n);if(!t)return!1;let e=t.parse(n);return t===hh&&(e=uX(e)),e}const UO=(n,t)=>{const e=FO(n),r=FO(t);if(!e||!r)return Q0(n,t);const i={...e};return s=>(i.red=IS(e.red,r.red,s),i.green=IS(e.green,r.green,s),i.blue=IS(e.blue,r.blue,s),i.alpha=Fe(e.alpha,r.alpha,s),Ec.transform(i))},hx=new Set(["none","hidden"]);function dX(n,t){return hx.has(n)?e=>e<=0?n:t:e=>e>=1?t:n}function pX(n,t){return e=>Fe(n,t,e)}function G1(n){return typeof n=="number"?pX:typeof n=="string"?H1(n)?Q0:gn.test(n)?UO:yX:Array.isArray(n)?cj:typeof n=="object"?gn.test(n)?UO:mX:Q0}function cj(n,t){const e=[...n],r=e.length,i=n.map((s,o)=>G1(s)(s,t[o]));return s=>{for(let o=0;o<r;o++)e[o]=i[o](s);return e}}function mX(n,t){const e={...n,...t},r={};for(const i in e)n[i]!==void 0&&t[i]!==void 0&&(r[i]=G1(n[i])(n[i],t[i]));return i=>{for(const s in r)e[s]=r[s](i);return e}}function gX(n,t){const e=[],r={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const s=t.types[i],o=n.indexes[s][r[s]],l=n.values[o]??0;e[i]=l,r[s]++}return e}const yX=(n,t)=>{const e=rs.createTransformer(t),r=Ip(n),i=Ip(t);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?hx.has(n)&&!i.values.length||hx.has(t)&&!r.values.length?dX(n,t):gm(cj(gX(r,i),i.values),e):Q0(n,t)};function uj(n,t,e){return typeof n=="number"&&typeof t=="number"&&typeof e=="number"?Fe(n,t,e):G1(n)(n,t)}const vX=n=>{const t=({timestamp:e})=>n(e);return{start:(e=!0)=>ke.update(t,e),stop:()=>yl(t),now:()=>Hn.isProcessing?Hn.timestamp:gr.now()}},hj=(n,t,e=10)=>{let r="";const i=Math.max(Math.round(t/e),2);for(let s=0;s<i;s++)r+=Math.round(n(s/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},J0=2e4;function W1(n){let t=0;const e=50;let r=n.next(t);for(;!r.done&&t<J0;)t+=e,r=n.next(t);return t>=J0?1/0:t}function bX(n,t=100,e){const r=e({...n,keyframes:[0,t]}),i=Math.min(W1(r),J0);return{type:"keyframes",ease:s=>r.next(i*s).value/t,duration:wi(i)}}const _X=5;function fj(n,t,e){const r=Math.max(t-_X,0);return $3(e-n(r),t-r)}const Ge={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},PS=.001;function TX({duration:n=Ge.duration,bounce:t=Ge.bounce,velocity:e=Ge.velocity,mass:r=Ge.mass}){let i,s,o=1-t;o=Ks(Ge.minDamping,Ge.maxDamping,o),n=Ks(Ge.minDuration,Ge.maxDuration,wi(n)),o<1?(i=h=>{const d=h*o,m=d*n,g=d-e,v=fx(h,o),T=Math.exp(-m);return PS-g/v*T},s=h=>{const m=h*o*n,g=m*e+e,v=Math.pow(o,2)*Math.pow(h,2)*n,T=Math.exp(-m),S=fx(Math.pow(h,2),o);return(-i(h)+PS>0?-1:1)*((g-v)*T)/S}):(i=h=>{const d=Math.exp(-h*n),m=(h-e)*n+1;return-PS+d*m},s=h=>{const d=Math.exp(-h*n),m=(e-h)*(n*n);return d*m});const l=5/n,u=wX(i,s,l);if(n=ns(n),isNaN(u))return{stiffness:Ge.stiffness,damping:Ge.damping,duration:n};{const h=Math.pow(u,2)*r;return{stiffness:h,damping:o*2*Math.sqrt(r*h),duration:n}}}const SX=12;function wX(n,t,e){let r=e;for(let i=1;i<SX;i++)r=r-n(r)/t(r);return r}function fx(n,t){return n*Math.sqrt(1-t*t)}const xX=["duration","bounce"],EX=["stiffness","damping","mass"];function zO(n,t){return t.some(e=>n[e]!==void 0)}function CX(n){let t={velocity:Ge.velocity,stiffness:Ge.stiffness,damping:Ge.damping,mass:Ge.mass,isResolvedFromDuration:!1,...n};if(!zO(n,EX)&&zO(n,xX))if(t.velocity=0,n.visualDuration){const e=n.visualDuration,r=2*Math.PI/(e*1.2),i=r*r,s=2*Ks(.05,1,1-(n.bounce||0))*Math.sqrt(i);t={...t,mass:Ge.mass,stiffness:i,damping:s}}else{const e=TX({...n,velocity:0});t={...t,...e,mass:Ge.mass},t.isResolvedFromDuration=!0}return t}function Z0(n=Ge.visualDuration,t=Ge.bounce){const e=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:t}:n;let{restSpeed:r,restDelta:i}=e;const s=e.keyframes[0],o=e.keyframes[e.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:d,duration:m,velocity:g,isResolvedFromDuration:v}=CX({...e,velocity:-wi(e.velocity||0)}),T=g||0,S=h/(2*Math.sqrt(u*d)),w=o-s,E=wi(Math.sqrt(u/d)),R=Math.abs(w)<5;r||(r=R?Ge.restSpeed.granular:Ge.restSpeed.default),i||(i=R?Ge.restDelta.granular:Ge.restDelta.default);let P;if(S<1){const N=fx(E,S);P=W=>{const M=Math.exp(-S*E*W);return o-M*((T+S*E*w)/N*Math.sin(N*W)+w*Math.cos(N*W))}}else if(S===1)P=N=>o-Math.exp(-E*N)*(w+(T+E*w)*N);else{const N=E*Math.sqrt(S*S-1);P=W=>{const M=Math.exp(-S*E*W),k=Math.min(N*W,300);return o-M*((T+S*E*w)*Math.sinh(k)+N*w*Math.cosh(k))/N}}const j={calculatedDuration:v&&m||null,next:N=>{const W=P(N);if(v)l.done=N>=m;else{let M=N===0?T:0;S<1&&(M=N===0?ns(T):fj(P,N,W));const k=Math.abs(M)<=r,O=Math.abs(o-W)<=i;l.done=k&&O}return l.value=l.done?o:W,l},toString:()=>{const N=Math.min(W1(j),J0),W=hj(M=>j.next(N*M).value,N,30);return N+"ms "+W},toTransition:()=>{}};return j}Z0.applyToOptions=n=>{const t=bX(n,100,Z0);return n.ease=t.ease,n.duration=ns(t.duration),n.type="keyframes",n};function dx({keyframes:n,velocity:t=0,power:e=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:d}){const m=n[0],g={done:!1,value:m},v=k=>l!==void 0&&k<l||u!==void 0&&k>u,T=k=>l===void 0?u:u===void 0||Math.abs(l-k)<Math.abs(u-k)?l:u;let S=e*t;const w=m+S,E=o===void 0?w:o(w);E!==w&&(S=E-m);const R=k=>-S*Math.exp(-k/r),P=k=>E+R(k),j=k=>{const O=R(k),B=P(k);g.done=Math.abs(O)<=h,g.value=g.done?E:B};let N,W;const M=k=>{v(g.value)&&(N=k,W=Z0({keyframes:[g.value,T(g.value)],velocity:fj(P,k,g.value),damping:i,stiffness:s,restDelta:h,restSpeed:d}))};return M(0),{calculatedDuration:null,next:k=>{let O=!1;return!W&&N===void 0&&(O=!0,j(k),M(k)),N!==void 0&&k>=N?W.next(k-N):(!O&&j(k),g)}}}function AX(n,t,e){const r=[],i=e||Go.mix||uj,s=n.length-1;for(let o=0;o<s;o++){let l=i(n[o],n[o+1]);if(t){const u=Array.isArray(t)?t[o]||xi:t;l=gm(u,l)}r.push(l)}return r}function kX(n,t,{clamp:e=!0,ease:r,mixer:i}={}){const s=n.length;if(B1(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),t=[...t].reverse());const l=AX(t,r,i),u=l.length,h=d=>{if(o&&d<n[0])return t[0];let m=0;if(u>1)for(;m<n.length-2&&!(d<n[m+1]);m++);const g=Dp(n[m],n[m+1],d);return l[m](g)};return e?d=>h(Ks(n[0],n[s-1],d)):h}function RX(n,t){const e=n[n.length-1];for(let r=1;r<=t;r++){const i=Dp(0,t,r);n.push(Fe(e,1,i))}}function MX(n){const t=[0];return RX(t,n.length-1),t}function DX(n,t){return n.map(e=>e*t)}function OX(n,t){return n.map(()=>t||Z3).splice(0,n.length-1)}function ep({duration:n=300,keyframes:t,times:e,ease:r="easeInOut"}){const i=HK(r)?r.map(LO):LO(r),s={done:!1,value:t[0]},o=DX(e&&e.length===t.length?e:MX(t),n),l=kX(o,t,{ease:Array.isArray(i)?i:OX(t,i)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const IX=n=>n!==null;function Y1(n,{repeat:t,repeatType:e="loop"},r,i=1){const s=n.filter(IX),l=i<0||t&&e!=="loop"&&t%2===1?0:s.length-1;return!l||r===void 0?s[l]:r}const PX={decay:dx,inertia:dx,tween:ep,keyframes:ep,spring:Z0};function dj(n){typeof n.type=="string"&&(n.type=PX[n.type])}class K1{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,e){return this.finished.then(t,e)}}const NX=n=>n/100;class X1 extends K1{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:e}=this.options;e&&e.updatedAt!==gr.now()&&this.tick(gr.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;dj(t);const{type:e=ep,repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:o=0}=t;let{keyframes:l}=t;const u=e||ep;u!==ep&&typeof l[0]!="number"&&(this.mixKeyframes=gm(NX,uj(l[0],l[1])),l=[0,100]);const h=u({...t,keyframes:l});s==="mirror"&&(this.mirroredGenerator=u({...t,keyframes:[...l].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=W1(h));const{calculatedDuration:d}=h;this.calculatedDuration=d,this.resolvedDuration=d+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=h}updateTime(t){const e=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=e}tick(t,e=!1){const{generator:r,totalDuration:i,mixKeyframes:s,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:h=0,keyframes:d,repeat:m,repeatType:g,repeatDelay:v,type:T,onUpdate:S,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-i/this.speed,this.startTime)),e?this.currentTime=t:this.updateTime(t);const E=this.currentTime-h*(this.playbackSpeed>=0?1:-1),R=this.playbackSpeed>=0?E<0:E>i;this.currentTime=Math.max(E,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let P=this.currentTime,j=r;if(m){const k=Math.min(this.currentTime,i)/l;let O=Math.floor(k),B=k%1;!B&&k>=1&&(B=1),B===1&&O--,O=Math.min(O,m+1),O%2&&(g==="reverse"?(B=1-B,v&&(B-=v/l)):g==="mirror"&&(j=o)),P=Ks(0,1,B)*l}const N=R?{done:!1,value:d[0]}:j.next(P);s&&(N.value=s(N.value));let{done:W}=N;!R&&u!==null&&(W=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const M=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&W);return M&&T!==dx&&(N.value=Y1(d,this.options,w,this.speed)),S&&S(N.value),M&&this.finish(),N}then(t,e){return this.finished.then(t,e)}get duration(){return wi(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+wi(t)}get time(){return wi(this.currentTime)}set time(t){t=ns(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(gr.now());const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=wi(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=vX,startTime:e}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=e??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(gr.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function LX(n){for(let t=1;t<n.length;t++)n[t]??(n[t]=n[t-1])}const Cc=n=>n*180/Math.PI,px=n=>{const t=Cc(Math.atan2(n[1],n[0]));return mx(t)},VX={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:px,rotateZ:px,skewX:n=>Cc(Math.atan(n[1])),skewY:n=>Cc(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},mx=n=>(n=n%360,n<0&&(n+=360),n),HO=px,$O=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),qO=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),jX={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:$O,scaleY:qO,scale:n=>($O(n)+qO(n))/2,rotateX:n=>mx(Cc(Math.atan2(n[6],n[5]))),rotateY:n=>mx(Cc(Math.atan2(-n[2],n[0]))),rotateZ:HO,rotate:HO,skewX:n=>Cc(Math.atan(n[4])),skewY:n=>Cc(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function gx(n){return n.includes("scale")?1:0}function yx(n,t){if(!n||n==="none")return gx(t);const e=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(e)r=jX,i=e;else{const l=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=VX,i=l}if(!i)return gx(t);const s=r[t],o=i[1].split(",").map(FX);return typeof s=="function"?s(o):o[s]}const BX=(n,t)=>{const{transform:e="none"}=getComputedStyle(n);return yx(e,t)};function FX(n){return parseFloat(n.trim())}const rf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],sf=new Set(rf),GO=n=>n===nf||n===St,UX=new Set(["x","y","z"]),zX=rf.filter(n=>!UX.has(n));function HX(n){const t=[];return zX.forEach(e=>{const r=n.getValue(e);r!==void 0&&(t.push([e,r.get()]),r.set(e.startsWith("scale")?1:0))}),t}const Qa={width:({x:n},{paddingLeft:t="0",paddingRight:e="0"})=>n.max-n.min-parseFloat(t)-parseFloat(e),height:({y:n},{paddingTop:t="0",paddingBottom:e="0"})=>n.max-n.min-parseFloat(t)-parseFloat(e),top:(n,{top:t})=>parseFloat(t),left:(n,{left:t})=>parseFloat(t),bottom:({y:n},{top:t})=>parseFloat(t)+(n.max-n.min),right:({x:n},{left:t})=>parseFloat(t)+(n.max-n.min),x:(n,{transform:t})=>yx(t,"x"),y:(n,{transform:t})=>yx(t,"y")};Qa.translateX=Qa.x;Qa.translateY=Qa.y;const Nc=new Set;let vx=!1,bx=!1,_x=!1;function pj(){if(bx){const n=Array.from(Nc).filter(r=>r.needsMeasurement),t=new Set(n.map(r=>r.element)),e=new Map;t.forEach(r=>{const i=HX(r);i.length&&(e.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const i=e.get(r);i&&i.forEach(([s,o])=>{r.getValue(s)?.set(o)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}bx=!1,vx=!1,Nc.forEach(n=>n.complete(_x)),Nc.clear()}function mj(){Nc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(bx=!0)})}function $X(){_x=!0,mj(),pj(),_x=!1}class Q1{constructor(t,e,r,i,s,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=r,this.motionValue=i,this.element=s,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Nc.add(this),vx||(vx=!0,ke.read(mj),ke.resolveKeyframes(pj))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:r,motionValue:i}=this;if(t[0]===null){const s=i?.get(),o=t[t.length-1];if(s!==void 0)t[0]=s;else if(r&&e){const l=r.readValue(e,o);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=o),i&&s===void 0&&i.set(t[0])}LX(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Nc.delete(this)}cancel(){this.state==="scheduled"&&(Nc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const qX=n=>n.startsWith("--");function GX(n,t,e){qX(t)?n.style.setProperty(t,e):n.style[t]=e}const WX={};function gj(n,t){const e=H3(n);return()=>WX[t]??e()}const YX=gj(()=>window.ScrollTimeline!==void 0,"scrollTimeline"),yj=gj(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Bd=([n,t,e,r])=>`cubic-bezier(${n}, ${t}, ${e}, ${r})`,WO={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Bd([0,.65,.55,1]),circOut:Bd([.55,0,1,.45]),backIn:Bd([.31,.01,.66,-.59]),backOut:Bd([.33,1.53,.69,.99])};function vj(n,t){if(n)return typeof n=="function"?yj()?hj(n,t):"ease-out":tj(n)?Bd(n):Array.isArray(n)?n.map(e=>vj(e,t)||WO.easeOut):WO[n]}function KX(n,t,e,{delay:r=0,duration:i=300,repeat:s=0,repeatType:o="loop",ease:l="easeOut",times:u}={},h=void 0){const d={[t]:e};u&&(d.offset=u);const m=vj(l,i);Array.isArray(m)&&(d.easing=m);const g={delay:r,duration:i,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"};return h&&(g.pseudoElement=h),n.animate(d,g)}function bj(n){return typeof n=="function"&&"applyToOptions"in n}function XX({type:n,...t}){return bj(n)&&yj()?n.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class _j extends K1{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:e,name:r,keyframes:i,pseudoElement:s,allowFlatten:o=!1,finalKeyframe:l,onComplete:u}=t;this.isPseudoElement=!!s,this.allowFlatten=o,this.options=t,B1(typeof t.type!="string");const h=XX(t);this.animation=KX(e,r,i,h,s),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const d=Y1(i,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(d):GX(e,r,d),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){const t=this.options?.element;!this.isPseudoElement&&t?.isConnected&&this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return wi(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+wi(t)}get time(){return wi(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=ns(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:e}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&YX()?(this.animation.timeline=t,xi):e(this)}}const Tj={anticipate:X3,backInOut:K3,circInOut:J3};function QX(n){return n in Tj}function JX(n){typeof n.ease=="string"&&QX(n.ease)&&(n.ease=Tj[n.ease])}const NS=10;class ZX extends _j{constructor(t){JX(t),dj(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:e,onUpdate:r,onComplete:i,element:s,...o}=this.options;if(!e)return;if(t!==void 0){e.set(t);return}const l=new X1({...o,autoplay:!1}),u=Math.max(NS,gr.now()-this.startTime),h=Ks(0,NS,u-NS);e.setWithVelocity(l.sample(Math.max(0,u-h)).value,l.sample(u).value,h),l.stop()}}const YO=(n,t)=>t==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(rs.test(n)||n==="0")&&!n.startsWith("url("));function tQ(n){const t=n[0];if(n.length===1)return!0;for(let e=0;e<n.length;e++)if(n[e]!==t)return!0}function eQ(n,t,e,r){const i=n[0];if(i===null)return!1;if(t==="display"||t==="visibility")return!0;const s=n[n.length-1],o=YO(i,t),l=YO(s,t);return!o||!l?!1:tQ(n)||(e==="spring"||bj(e))&&r}function Tx(n){n.duration=0,n.type="keyframes"}const nQ=new Set(["opacity","clipPath","filter","transform"]),rQ=H3(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function iQ(n){const{motionValue:t,name:e,repeatDelay:r,repeatType:i,damping:s,type:o}=n;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return rQ()&&e&&nQ.has(e)&&(e!=="transform"||!h)&&!u&&!r&&i!=="mirror"&&s!==0&&o!=="inertia"}const sQ=40;class oQ extends K1{constructor({autoplay:t=!0,delay:e=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o="loop",keyframes:l,name:u,motionValue:h,element:d,...m}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=gr.now();const g={autoplay:t,delay:e,type:r,repeat:i,repeatDelay:s,repeatType:o,name:u,motionValue:h,element:d,...m},v=d?.KeyframeResolver||Q1;this.keyframeResolver=new v(l,(T,S,w)=>this.onKeyframesResolved(T,S,g,!w),u,h,d),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,e,r,i){this.keyframeResolver=void 0;const{name:s,type:o,velocity:l,delay:u,isHandoff:h,onUpdate:d}=r;this.resolvedAt=gr.now(),eQ(t,s,o,l)||((Go.instantAnimations||!u)&&d?.(Y1(t,r,e)),t[0]=t[t.length-1],Tx(r),r.repeat=0);const g={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>sQ?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:e,...r,keyframes:t},v=!h&&iQ(g),T=g.motionValue?.owner?.current,S=v?new ZX({...g,element:T}):new X1(g);S.finished.then(()=>{this.notifyFinished()}).catch(xi),this.pendingTimeline&&(this.stopTimeline=S.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=S}get finished(){return this._animation?this.animation.finished:this._finished}then(t,e){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),$X()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}function Sj(n,t,e,r=0,i=1){const s=Array.from(n).sort((h,d)=>h.sortNodePosition(d)).indexOf(t),o=n.size,l=(o-1)*r;return typeof e=="function"?e(s,o):i===1?s*r:l-s*r}const aQ=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function lQ(n){const t=aQ.exec(n);if(!t)return[,];const[,e,r,i]=t;return[`--${e??r}`,i]}function wj(n,t,e=1){const[r,i]=lQ(n);if(!r)return;const s=window.getComputedStyle(t).getPropertyValue(r);if(s){const o=s.trim();return F3(o)?parseFloat(o):o}return H1(i)?wj(i,t,e+1):i}const cQ={type:"spring",stiffness:500,damping:25,restSpeed:10},uQ=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),hQ={type:"keyframes",duration:.8},fQ={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},dQ=(n,{keyframes:t})=>t.length>2?hQ:sf.has(n)?n.startsWith("scale")?uQ(t[1]):cQ:fQ,pQ=n=>n!==null;function mQ(n,{repeat:t,repeatType:e="loop"},r){const i=n.filter(pQ),s=t&&e!=="loop"&&t%2===1?0:i.length-1;return i[s]}function xj(n,t){if(n?.inherit&&t){const{inherit:e,...r}=n;return{...t,...r}}return n}function J1(n,t){const e=n?.[t]??n?.default??n;return e!==n?xj(e,n):e}function gQ({when:n,delay:t,delayChildren:e,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...d}){return!!Object.keys(d).length}const Z1=(n,t,e,r={},i,s)=>o=>{const l=J1(r,n)||{},u=l.delay||r.delay||0;let{elapsed:h=0}=r;h=h-ns(u);const d={keyframes:Array.isArray(e)?e:[null,e],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-h,onUpdate:g=>{t.set(g),l.onUpdate&&l.onUpdate(g)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:t,element:s?void 0:i};gQ(l)||Object.assign(d,dQ(n,d)),d.duration&&(d.duration=ns(d.duration)),d.repeatDelay&&(d.repeatDelay=ns(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let m=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(Tx(d),d.delay===0&&(m=!0)),(Go.instantAnimations||Go.skipAnimations||i?.shouldSkipAnimations)&&(m=!0,Tx(d),d.delay=0),d.allowFlatten=!l.type&&!l.ease,m&&!s&&t.get()!==void 0){const g=mQ(d.keyframes,l);if(g!==void 0){ke.update(()=>{d.onUpdate(g),d.onComplete()});return}}return l.isSync?new X1(d):new oQ(d)};function KO(n){const t=[{},{}];return n?.values.forEach((e,r)=>{t[0][r]=e.get(),t[1][r]=e.getVelocity()}),t}function tC(n,t,e,r){if(typeof t=="function"){const[i,s]=KO(r);t=t(e!==void 0?e:n.custom,i,s)}if(typeof t=="string"&&(t=n.variants&&n.variants[t]),typeof t=="function"){const[i,s]=KO(r);t=t(e!==void 0?e:n.custom,i,s)}return t}function Ch(n,t,e){const r=n.getProps();return tC(r,t,e!==void 0?e:r.custom,n)}const Ej=new Set(["width","height","top","left","right","bottom",...rf]),XO=30,yQ=n=>!isNaN(parseFloat(n));class vQ{constructor(t,e={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=gr.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const s of this.dependents)s.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){this.current=t,this.updatedAt=gr.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=yQ(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new F1);const r=this.events[t].add(e);return t==="change"?()=>{r(),ke.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,e,r){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=gr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>XO)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,XO);return $3(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Lh(n,t){return new vQ(n,t)}const Sx=n=>Array.isArray(n);function bQ(n,t,e){n.hasValue(t)?n.getValue(t).set(e):n.addValue(t,Lh(e))}function _Q(n){return Sx(n)?n[n.length-1]||0:n}function TQ(n,t){const e=Ch(n,t);let{transitionEnd:r={},transition:i={},...s}=e||{};s={...s,...r};for(const o in s){const l=_Q(s[o]);bQ(n,o,l)}}const er=n=>!!(n&&n.getVelocity);function SQ(n){return!!(er(n)&&n.add)}function wx(n,t){const e=n.getValue("willChange");if(SQ(e))return e.add(t);if(!e&&Go.WillChange){const r=new Go.WillChange("auto");n.addValue("willChange",r),r.add(t)}}function eC(n){return n.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const wQ="framerAppearId",Cj="data-"+eC(wQ);function Aj(n){return n.props[Cj]}function xQ({protectedKeys:n,needsAnimating:t},e){const r=n.hasOwnProperty(e)&&t[e]!==!0;return t[e]=!1,r}function kj(n,t,{delay:e=0,transitionOverride:r,type:i}={}){let{transition:s,transitionEnd:o,...l}=t;const u=n.getDefaultTransition();s=s?xj(s,u):u;const h=s?.reduceMotion;r&&(s=r);const d=[],m=i&&n.animationState&&n.animationState.getState()[i];for(const g in l){const v=n.getValue(g,n.latestValues[g]??null),T=l[g];if(T===void 0||m&&xQ(m,g))continue;const S={delay:e,...J1(s||{},g)},w=v.get();if(w!==void 0&&!v.isAnimating&&!Array.isArray(T)&&T===w&&!S.velocity)continue;let E=!1;if(window.MotionHandoffAnimation){const j=Aj(n);if(j){const N=window.MotionHandoffAnimation(j,g,ke);N!==null&&(S.startTime=N,E=!0)}}wx(n,g);const R=h??n.shouldReduceMotion;v.start(Z1(g,v,T,R&&Ej.has(g)?{type:!1}:S,n,E));const P=v.animation;P&&d.push(P)}if(o){const g=()=>ke.update(()=>{o&&TQ(n,o)});d.length?Promise.all(d).then(g):g()}return d}function xx(n,t,e={}){const r=Ch(n,t,e.type==="exit"?n.presenceContext?.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};e.transitionOverride&&(i=e.transitionOverride);const s=r?()=>Promise.all(kj(n,r,e)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:d,staggerDirection:m}=i;return EQ(n,t,u,h,d,m,e)}:()=>Promise.resolve(),{when:l}=i;if(l){const[u,h]=l==="beforeChildren"?[s,o]:[o,s];return u().then(()=>h())}else return Promise.all([s(),o(e.delay)])}function EQ(n,t,e=0,r=0,i=0,s=1,o){const l=[];for(const u of n.variantChildren)u.notify("AnimationStart",t),l.push(xx(u,t,{...o,delay:e+(typeof r=="function"?0:r)+Sj(n.variantChildren,u,r,i,s)}).then(()=>u.notify("AnimationComplete",t)));return Promise.all(l)}function CQ(n,t,e={}){n.notify("AnimationStart",t);let r;if(Array.isArray(t)){const i=t.map(s=>xx(n,s,e));r=Promise.all(i)}else if(typeof t=="string")r=xx(n,t,e);else{const i=typeof t=="function"?Ch(n,t,e.custom):t;r=Promise.all(kj(n,i,e))}return r.then(()=>{n.notify("AnimationComplete",t)})}const AQ={test:n=>n==="auto",parse:n=>n},Rj=n=>t=>t.test(n),Mj=[nf,St,qs,ja,nX,eX,AQ],QO=n=>Mj.find(Rj(n));function kQ(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||z3(n):!0}const RQ=new Set(["brightness","contrast","saturate","opacity"]);function MQ(n){const[t,e]=n.slice(0,-1).split("(");if(t==="drop-shadow")return n;const[r]=e.match($1)||[];if(!r)return n;const i=e.replace(r,"");let s=RQ.has(t)?1:0;return r!==e&&(s*=100),t+"("+s+i+")"}const DQ=/\b([a-z-]*)\(.*?\)/gu,Ex={...rs,getAnimatableNone:n=>{const t=n.match(DQ);return t?t.map(MQ).join(" "):n}},Cx={...rs,getAnimatableNone:n=>{const t=rs.parse(n);return rs.createTransformer(n)(t.map(r=>typeof r=="number"?0:typeof r=="object"?{...r,alpha:1}:r))}},JO={...nf,transform:Math.round},OQ={rotate:ja,rotateX:ja,rotateY:ja,rotateZ:ja,scale:fy,scaleX:fy,scaleY:fy,scaleZ:fy,skew:ja,skewX:ja,skewY:ja,distance:St,translateX:St,translateY:St,translateZ:St,x:St,y:St,z:St,perspective:St,transformPerspective:St,opacity:Op,originX:jO,originY:jO,originZ:St},nC={borderWidth:St,borderTopWidth:St,borderRightWidth:St,borderBottomWidth:St,borderLeftWidth:St,borderRadius:St,borderTopLeftRadius:St,borderTopRightRadius:St,borderBottomRightRadius:St,borderBottomLeftRadius:St,width:St,maxWidth:St,height:St,maxHeight:St,top:St,right:St,bottom:St,left:St,inset:St,insetBlock:St,insetBlockStart:St,insetBlockEnd:St,insetInline:St,insetInlineStart:St,insetInlineEnd:St,padding:St,paddingTop:St,paddingRight:St,paddingBottom:St,paddingLeft:St,paddingBlock:St,paddingBlockStart:St,paddingBlockEnd:St,paddingInline:St,paddingInlineStart:St,paddingInlineEnd:St,margin:St,marginTop:St,marginRight:St,marginBottom:St,marginLeft:St,marginBlock:St,marginBlockStart:St,marginBlockEnd:St,marginInline:St,marginInlineStart:St,marginInlineEnd:St,fontSize:St,backgroundPositionX:St,backgroundPositionY:St,...OQ,zIndex:JO,fillOpacity:Op,strokeOpacity:Op,numOctaves:JO},IQ={...nC,color:gn,backgroundColor:gn,outlineColor:gn,fill:gn,stroke:gn,borderColor:gn,borderTopColor:gn,borderRightColor:gn,borderBottomColor:gn,borderLeftColor:gn,filter:Ex,WebkitFilter:Ex,mask:Cx,WebkitMask:Cx},Dj=n=>IQ[n],PQ=new Set([Ex,Cx]);function Oj(n,t){let e=Dj(n);return PQ.has(e)||(e=rs),e.getAnimatableNone?e.getAnimatableNone(t):void 0}const NQ=new Set(["auto","none","0"]);function LQ(n,t,e){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!NQ.has(s)&&Ip(s).values.length&&(i=n[r]),r++}if(i&&e)for(const s of t)n[s]=Oj(e,i)}class VQ extends Q1{constructor(t,e,r,i,s){super(t,e,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:r}=this;if(!e||!e.current)return;super.readKeyframes();for(let d=0;d<t.length;d++){let m=t[d];if(typeof m=="string"&&(m=m.trim(),H1(m))){const g=wj(m,e.current);g!==void 0&&(t[d]=g),d===t.length-1&&(this.finalKeyframe=m)}}if(this.resolveNoneKeyframes(),!Ej.has(r)||t.length!==2)return;const[i,s]=t,o=QO(i),l=QO(s),u=VO(i),h=VO(s);if(u!==h&&Qa[r]){this.needsMeasurement=!0;return}if(o!==l)if(GO(o)&&GO(l))for(let d=0;d<t.length;d++){const m=t[d];typeof m=="string"&&(t[d]=parseFloat(m))}else Qa[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,r=[];for(let i=0;i<t.length;i++)(t[i]===null||kQ(t[i]))&&r.push(i);r.length&&LQ(t,r,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Qa[r](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const i=e[e.length-1];i!==void 0&&t.getValue(r,i).jump(i,!1)}measureEndState(){const{element:t,name:e,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const i=t.getValue(e);i&&i.jump(this.measuredOrigin,!1);const s=r.length-1,o=r[s];r[s]=Qa[e](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,u])=>{t.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const jQ=new Set(["opacity","clipPath","filter","transform"]);function Ij(n,t,e){if(n==null)return[];if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=e?.[n]??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n).filter(r=>r!=null)}const Pj=(n,t)=>t&&typeof n=="number"?t.transform(n):n;function Ax(n){return U3(n)&&"offsetHeight"in n}const{schedule:rC}=ej(queueMicrotask,!1),qi={x:!1,y:!1};function Nj(){return qi.x||qi.y}function BQ(n){return n==="x"||n==="y"?qi[n]?null:(qi[n]=!0,()=>{qi[n]=!1}):qi.x||qi.y?null:(qi.x=qi.y=!0,()=>{qi.x=qi.y=!1})}function Lj(n,t){const e=Ij(n),r=new AbortController,i={passive:!0,...t,signal:r.signal};return[e,i,()=>r.abort()]}function FQ(n){return!(n.pointerType==="touch"||Nj())}function UQ(n,t,e={}){const[r,i,s]=Lj(n,e);return r.forEach(o=>{let l=!1,u=!1,h;const d=()=>{o.removeEventListener("pointerleave",T)},m=w=>{h&&(h(w),h=void 0),d()},g=w=>{l=!1,window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",g),u&&(u=!1,m(w))},v=()=>{l=!0,window.addEventListener("pointerup",g,i),window.addEventListener("pointercancel",g,i)},T=w=>{if(w.pointerType!=="touch"){if(l){u=!0;return}m(w)}},S=w=>{if(!FQ(w))return;u=!1;const E=t(o,w);typeof E=="function"&&(h=E,o.addEventListener("pointerleave",T,i))};o.addEventListener("pointerenter",S,i),o.addEventListener("pointerdown",v,i)}),s}const Vj=(n,t)=>t?n===t?!0:Vj(n,t.parentElement):!1,iC=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,zQ=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function HQ(n){return zQ.has(n.tagName)||n.isContentEditable===!0}const $Q=new Set(["INPUT","SELECT","TEXTAREA"]);function qQ(n){return $Q.has(n.tagName)||n.isContentEditable===!0}const f0=new WeakSet;function ZO(n){return t=>{t.key==="Enter"&&n(t)}}function LS(n,t){n.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const GQ=(n,t)=>{const e=n.currentTarget;if(!e)return;const r=ZO(()=>{if(f0.has(e))return;LS(e,"down");const i=ZO(()=>{LS(e,"up")}),s=()=>LS(e,"cancel");e.addEventListener("keyup",i,t),e.addEventListener("blur",s,t)});e.addEventListener("keydown",r,t),e.addEventListener("blur",()=>e.removeEventListener("keydown",r),t)};function tI(n){return iC(n)&&!Nj()}const eI=new WeakSet;function WQ(n,t,e={}){const[r,i,s]=Lj(n,e),o=l=>{const u=l.currentTarget;if(!tI(l)||eI.has(l))return;f0.add(u),e.stopPropagation&&eI.add(l);const h=t(u,l),d=(v,T)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",g),f0.has(u)&&f0.delete(u),tI(v)&&typeof h=="function"&&h(v,{success:T})},m=v=>{d(v,u===window||u===document||e.useGlobalTarget||Vj(u,v.target))},g=v=>{d(v,!1)};window.addEventListener("pointerup",m,i),window.addEventListener("pointercancel",g,i)};return r.forEach(l=>{(e.useGlobalTarget?window:l).addEventListener("pointerdown",o,i),Ax(l)&&(l.addEventListener("focus",h=>GQ(h,i)),!HQ(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),s}function sC(n){return U3(n)&&"ownerSVGElement"in n}const d0=new WeakMap;let p0;const jj=(n,t,e)=>(r,i)=>i&&i[0]?i[0][n+"Size"]:sC(r)&&"getBBox"in r?r.getBBox()[t]:r[e],YQ=jj("inline","width","offsetWidth"),KQ=jj("block","height","offsetHeight");function XQ({target:n,borderBoxSize:t}){d0.get(n)?.forEach(e=>{e(n,{get width(){return YQ(n,t)},get height(){return KQ(n,t)}})})}function QQ(n){n.forEach(XQ)}function JQ(){typeof ResizeObserver>"u"||(p0=new ResizeObserver(QQ))}function ZQ(n,t){p0||JQ();const e=Ij(n);return e.forEach(r=>{let i=d0.get(r);i||(i=new Set,d0.set(r,i)),i.add(t),p0?.observe(r)}),()=>{e.forEach(r=>{const i=d0.get(r);i?.delete(t),i?.size||p0?.unobserve(r)})}}const m0=new Set;let fh;function tJ(){fh=()=>{const n={get width(){return window.innerWidth},get height(){return window.innerHeight}};m0.forEach(t=>t(n))},window.addEventListener("resize",fh)}function eJ(n){return m0.add(n),fh||tJ(),()=>{m0.delete(n),!m0.size&&typeof fh=="function"&&(window.removeEventListener("resize",fh),fh=void 0)}}function nI(n,t){return typeof n=="function"?eJ(n):ZQ(n,t)}function nJ(n){return sC(n)&&n.tagName==="svg"}const rJ=[...Mj,gn,rs],iJ=n=>rJ.find(Rj(n)),rI=()=>({translate:0,scale:1,origin:0,originPoint:0}),dh=()=>({x:rI(),y:rI()}),iI=()=>({min:0,max:0}),wn=()=>({x:iI(),y:iI()}),sJ=new WeakMap;function Nb(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function Pp(n){return typeof n=="string"||Array.isArray(n)}const oC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],aC=["initial",...oC];function Lb(n){return Nb(n.animate)||aC.some(t=>Pp(n[t]))}function Bj(n){return!!(Lb(n)||n.variants)}function oJ(n,t,e){for(const r in t){const i=t[r],s=e[r];if(er(i))n.addValue(r,i);else if(er(s))n.addValue(r,Lh(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const o=n.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(r);n.addValue(r,Lh(o!==void 0?o:i,{owner:n}))}}for(const r in e)t[r]===void 0&&n.removeValue(r);return t}const kx={current:null},Fj={current:!1},aJ=typeof window<"u";function lJ(){if(Fj.current=!0,!!aJ)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),t=()=>kx.current=n.matches;n.addEventListener("change",t),t()}else kx.current=!1}const sI=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let tv={};function Uj(n){tv=n}function cJ(){return tv}class uJ{scrapeMotionValuesFromProps(t,e,r){return{}}constructor({parent:t,props:e,presenceContext:r,reducedMotionConfig:i,skipAnimations:s,blockInitialAnimation:o,visualState:l},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.shouldSkipAnimations=!1,this.values=new Map,this.KeyframeResolver=Q1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.hasBeenMounted=!1,this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=gr.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,ke.render(this.render,!1,!0))};const{latestValues:h,renderState:d}=l;this.latestValues=h,this.baseTarget={...h},this.initialValues=e.initial?{...h}:{},this.renderState=d,this.parent=t,this.props=e,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.skipAnimationsConfig=s,this.options=u,this.blockInitialAnimation=!!o,this.isControllingVariants=Lb(e),this.isVariantNode=Bj(e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:m,...g}=this.scrapeMotionValuesFromProps(e,{},this);for(const v in g){const T=g[v];h[v]!==void 0&&er(T)&&T.set(h[v])}}mount(t){if(this.hasBeenMounted)for(const e in this.initialValues)this.values.get(e)?.jump(this.initialValues[e]),this.latestValues[e]=this.initialValues[e];this.current=t,sJ.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,r)=>this.bindToMotionValue(r,e)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(Fj.current||lJ(),this.shouldReduceMotion=kx.current),this.shouldSkipAnimations=this.skipAnimationsConfig??!1,this.parent?.addChild(this),this.update(this.props,this.presenceContext),this.hasBeenMounted=!0}unmount(){this.projection&&this.projection.unmount(),yl(this.notifyUpdate),yl(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,e){if(this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)(),e.accelerate&&jQ.has(t)&&this.current instanceof HTMLElement){const{factory:o,keyframes:l,times:u,ease:h,duration:d}=e.accelerate,m=new _j({element:this.current,name:t,keyframes:l,times:u,ease:h,duration:ns(d)}),g=o(m);this.valueSubscriptions.set(t,()=>{g(),m.cancel()});return}const r=sf.has(t);r&&this.onBindTransform&&this.onBindTransform();const i=e.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ke.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;typeof window<"u"&&window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,t,e)),this.valueSubscriptions.set(t,()=>{i(),s&&s(),e.owner&&e.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in tv){const e=tv[t];if(!e)continue;const{isEnabled:r,Feature:i}=e;if(!this.features[t]&&i&&r(this.props)&&(this.features[t]=new i(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):wn()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let r=0;r<sI.length;r++){const i=sI[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,o=t[s];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=oJ(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){const r=this.values.get(t);e!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,e),this.values.set(t,e),this.latestValues[t]=e.get())}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&e!==void 0&&(r=Lh(e===null?void 0:e,{owner:this}),this.addValue(t,r)),r}readValue(t,e){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(F3(r)||z3(r))?r=parseFloat(r):!iJ(r)&&rs.test(e)&&(r=Oj(t,e)),this.setBaseTarget(t,er(r)?r.get():r)),er(r)?r.get():r}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){const{initial:e}=this.props;let r;if(typeof e=="string"||typeof e=="object"){const s=tC(this.props,e,this.presenceContext?.custom);s&&(r=s[t])}if(e&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!er(i)?i:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,e){return this.events[t]||(this.events[t]=new F1),this.events[t].add(e)}notify(t,...e){this.events[t]&&this.events[t].notify(...e)}scheduleRenderMicrotask(){rC.render(this.render)}}class zj extends uJ{constructor(){super(...arguments),this.KeyframeResolver=VQ}sortInstanceNodePosition(t,e){return t.compareDocumentPosition(e)&2?1:-1}getBaseTargetFromProps(t,e){const r=t.style;return r?r[e]:void 0}removeValueFromRenderState(t,{vars:e,style:r}){delete e[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;er(t)&&(this.childSubscription=t.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}class Ol{constructor(t){this.isMounted=!1,this.node=t}update(){}}function Hj({top:n,left:t,right:e,bottom:r}){return{x:{min:t,max:e},y:{min:n,max:r}}}function hJ({x:n,y:t}){return{top:t.min,right:n.max,bottom:t.max,left:n.min}}function fJ(n,t){if(!t)return n;const e=t({x:n.left,y:n.top}),r=t({x:n.right,y:n.bottom});return{top:e.y,left:e.x,bottom:r.y,right:r.x}}function VS(n){return n===void 0||n===1}function Rx({scale:n,scaleX:t,scaleY:e}){return!VS(n)||!VS(t)||!VS(e)}function yc(n){return Rx(n)||$j(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function $j(n){return oI(n.x)||oI(n.y)}function oI(n){return n&&n!=="0%"}function ev(n,t,e){const r=n-e,i=t*r;return e+i}function aI(n,t,e,r,i){return i!==void 0&&(n=ev(n,i,r)),ev(n,e,r)+t}function Mx(n,t=0,e=1,r,i){n.min=aI(n.min,t,e,r,i),n.max=aI(n.max,t,e,r,i)}function qj(n,{x:t,y:e}){Mx(n.x,t.translate,t.scale,t.originPoint),Mx(n.y,e.translate,e.scale,e.originPoint)}const lI=.999999999999,cI=1.0000000000001;function dJ(n,t,e,r=!1){const i=e.length;if(!i)return;t.x=t.y=1;let s,o;for(let l=0;l<i;l++){s=e[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&mh(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,qj(n,o)),r&&yc(s.latestValues)&&mh(n,s.latestValues))}t.x<cI&&t.x>lI&&(t.x=1),t.y<cI&&t.y>lI&&(t.y=1)}function ph(n,t){n.min=n.min+t,n.max=n.max+t}function uI(n,t,e,r,i=.5){const s=Fe(n.min,n.max,i);Mx(n,t,e,s,r)}function mh(n,t){uI(n.x,t.x,t.scaleX,t.scale,t.originX),uI(n.y,t.y,t.scaleY,t.scale,t.originY)}function Gj(n,t){return Hj(fJ(n.getBoundingClientRect(),t))}function pJ(n,t,e){const r=Gj(n,e),{scroll:i}=t;return i&&(ph(r.x,i.offset.x),ph(r.y,i.offset.y)),r}const mJ={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},gJ=rf.length;function yJ(n,t,e){let r="",i=!0;for(let s=0;s<gJ;s++){const o=rf[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number")u=l===(o.startsWith("scale")?1:0);else{const h=parseFloat(l);u=o.startsWith("scale")?h===1:h===0}if(!u||e){const h=Pj(l,nC[o]);if(!u){i=!1;const d=mJ[o]||o;r+=`${d}(${h}) `}e&&(t[o]=h)}}return r=r.trim(),e?r=e(t,i?"":r):i&&(r="none"),r}function lC(n,t,e){const{style:r,vars:i,transformOrigin:s}=n;let o=!1,l=!1;for(const u in t){const h=t[u];if(sf.has(u)){o=!0;continue}else if(rj(u)){i[u]=h;continue}else{const d=Pj(h,nC[u]);u.startsWith("origin")?(l=!0,s[u]=d):r[u]=d}}if(t.transform||(o||e?r.transform=yJ(t,n.transform,e):r.transform&&(r.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:d=0}=s;r.transformOrigin=`${u} ${h} ${d}`}}function Wj(n,{style:t,vars:e},r,i){const s=n.style;let o;for(o in t)s[o]=t[o];i?.applyProjectionStyles(s,r);for(o in e)s.setProperty(o,e[o])}function hI(n,t){return t.max===t.min?0:n/(t.max-t.min)*100}const xd={correct:(n,t)=>{if(!t.target)return n;if(typeof n=="string")if(St.test(n))n=parseFloat(n);else return n;const e=hI(n,t.target.x),r=hI(n,t.target.y);return`${e}% ${r}%`}},vJ={correct:(n,{treeScale:t,projectionDelta:e})=>{const r=n,i=rs.parse(n);if(i.length>5)return r;const s=rs.createTransformer(n),o=typeof i[0]!="number"?1:0,l=e.x.scale*t.x,u=e.y.scale*t.y;i[0+o]/=l,i[1+o]/=u;const h=Fe(l,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=h),typeof i[3+o]=="number"&&(i[3+o]/=h),s(i)}},Dx={borderRadius:{...xd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:xd,borderTopRightRadius:xd,borderBottomLeftRadius:xd,borderBottomRightRadius:xd,boxShadow:vJ};function Yj(n,{layout:t,layoutId:e}){return sf.has(n)||n.startsWith("origin")||(t||e!==void 0)&&(!!Dx[n]||n==="opacity")}function cC(n,t,e){const r=n.style,i=t?.style,s={};if(!r)return s;for(const o in r)(er(r[o])||i&&er(i[o])||Yj(o,n)||e?.getValue(o)?.liveStyle!==void 0)&&(s[o]=r[o]);return s}function bJ(n){return window.getComputedStyle(n)}class _J extends zj{constructor(){super(...arguments),this.type="html",this.renderInstance=Wj}readValueFromInstance(t,e){if(sf.has(e))return this.projection?.isProjecting?gx(e):BX(t,e);{const r=bJ(t),i=(rj(e)?r.getPropertyValue(e):r[e])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:e}){return Gj(t,e)}build(t,e,r){lC(t,e,r.transformTemplate)}scrapeMotionValuesFromProps(t,e,r){return cC(t,e,r)}}const TJ={offset:"stroke-dashoffset",array:"stroke-dasharray"},SJ={offset:"strokeDashoffset",array:"strokeDasharray"};function wJ(n,t,e=1,r=0,i=!0){n.pathLength=1;const s=i?TJ:SJ;n[s.offset]=`${-r}`,n[s.array]=`${t} ${e}`}const xJ=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function Kj(n,{attrX:t,attrY:e,attrScale:r,pathLength:i,pathSpacing:s=1,pathOffset:o=0,...l},u,h,d){if(lC(n,l,h),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:m,style:g}=n;m.transform&&(g.transform=m.transform,delete m.transform),(g.transform||m.transformOrigin)&&(g.transformOrigin=m.transformOrigin??"50% 50%",delete m.transformOrigin),g.transform&&(g.transformBox=d?.transformBox??"fill-box",delete m.transformBox);for(const v of xJ)m[v]!==void 0&&(g[v]=m[v],delete m[v]);t!==void 0&&(m.x=t),e!==void 0&&(m.y=e),r!==void 0&&(m.scale=r),i!==void 0&&wJ(m,i,s,o,!1)}const Xj=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),Qj=n=>typeof n=="string"&&n.toLowerCase()==="svg";function EJ(n,t,e,r){Wj(n,t,void 0,r);for(const i in t.attrs)n.setAttribute(Xj.has(i)?i:eC(i),t.attrs[i])}function Jj(n,t,e){const r=cC(n,t,e);for(const i in n)if(er(n[i])||er(t[i])){const s=rf.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}class CJ extends zj{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=wn}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(sf.has(e)){const r=Dj(e);return r&&r.default||0}return e=Xj.has(e)?e:eC(e),t.getAttribute(e)}scrapeMotionValuesFromProps(t,e,r){return Jj(t,e,r)}build(t,e,r){Kj(t,e,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,e,r,i){EJ(t,e,r,i)}mount(t){this.isSVGTag=Qj(t.tagName),super.mount(t)}}const AJ=aC.length;function Zj(n){if(!n)return;if(!n.isControllingVariants){const e=n.parent?Zj(n.parent)||{}:{};return n.props.initial!==void 0&&(e.initial=n.props.initial),e}const t={};for(let e=0;e<AJ;e++){const r=aC[e],i=n.props[r];(Pp(i)||i===!1)&&(t[r]=i)}return t}function tB(n,t){if(!Array.isArray(t))return!1;const e=t.length;if(e!==n.length)return!1;for(let r=0;r<e;r++)if(t[r]!==n[r])return!1;return!0}const kJ=[...oC].reverse(),RJ=oC.length;function MJ(n){return t=>Promise.all(t.map(({animation:e,options:r})=>CQ(n,e,r)))}function DJ(n){let t=MJ(n),e=fI(),r=!0;const i=u=>(h,d)=>{const m=Ch(n,d,u==="exit"?n.presenceContext?.custom:void 0);if(m){const{transition:g,transitionEnd:v,...T}=m;h={...h,...T,...v}}return h};function s(u){t=u(n)}function o(u){const{props:h}=n,d=Zj(n.parent)||{},m=[],g=new Set;let v={},T=1/0;for(let w=0;w<RJ;w++){const E=kJ[w],R=e[E],P=h[E]!==void 0?h[E]:d[E],j=Pp(P),N=E===u?R.isActive:null;N===!1&&(T=w);let W=P===d[E]&&P!==h[E]&&j;if(W&&r&&n.manuallyAnimateOnMount&&(W=!1),R.protectedKeys={...v},!R.isActive&&N===null||!P&&!R.prevProp||Nb(P)||typeof P=="boolean")continue;if(E==="exit"&&R.isActive&&N!==!0){R.prevResolvedValues&&(v={...v,...R.prevResolvedValues});continue}const M=OJ(R.prevProp,P);let k=M||E===u&&R.isActive&&!W&&j||w>T&&j,O=!1;const B=Array.isArray(P)?P:[P];let F=B.reduce(i(E),{});N===!1&&(F={});const{prevResolvedValues:H={}}=R,V={...H,...F},yt=st=>{k=!0,g.has(st)&&(O=!0,g.delete(st)),R.needsAnimating[st]=!0;const ht=n.getValue(st);ht&&(ht.liveStyle=!1)};for(const st in V){const ht=F[st],Ct=H[st];if(v.hasOwnProperty(st))continue;let Vt=!1;Sx(ht)&&Sx(Ct)?Vt=!tB(ht,Ct):Vt=ht!==Ct,Vt?ht!=null?yt(st):g.add(st):ht!==void 0&&g.has(st)?yt(st):R.protectedKeys[st]=!0}R.prevProp=P,R.prevResolvedValues=F,R.isActive&&(v={...v,...F}),r&&n.blockInitialAnimation&&(k=!1);const xt=W&&M;k&&(!xt||O)&&m.push(...B.map(st=>{const ht={type:E};if(typeof st=="string"&&r&&!xt&&n.manuallyAnimateOnMount&&n.parent){const{parent:Ct}=n,Vt=Ch(Ct,st);if(Ct.enteringChildren&&Vt){const{delayChildren:$}=Vt.transition||{};ht.delay=Sj(Ct.enteringChildren,n,$)}}return{animation:st,options:ht}}))}if(g.size){const w={};if(typeof h.initial!="boolean"){const E=Ch(n,Array.isArray(h.initial)?h.initial[0]:h.initial);E&&E.transition&&(w.transition=E.transition)}g.forEach(E=>{const R=n.getBaseTarget(E),P=n.getValue(E);P&&(P.liveStyle=!0),w[E]=R??null}),m.push({animation:w})}let S=!!m.length;return r&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(S=!1),r=!1,S?t(m):Promise.resolve()}function l(u,h){if(e[u].isActive===h)return Promise.resolve();n.variantChildren?.forEach(m=>m.animationState?.setActive(u,h)),e[u].isActive=h;const d=o(u);for(const m in e)e[m].protectedKeys={};return d}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>e,reset:()=>{e=fI()}}}function OJ(n,t){return typeof t=="string"?t!==n:Array.isArray(t)?!tB(t,n):!1}function dc(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function fI(){return{animate:dc(!0),whileInView:dc(),whileHover:dc(),whileTap:dc(),whileDrag:dc(),whileFocus:dc(),exit:dc()}}function dI(n,t){n.min=t.min,n.max=t.max}function Hi(n,t){dI(n.x,t.x),dI(n.y,t.y)}function pI(n,t){n.translate=t.translate,n.scale=t.scale,n.originPoint=t.originPoint,n.origin=t.origin}const eB=1e-4,IJ=1-eB,PJ=1+eB,nB=.01,NJ=0-nB,LJ=0+nB;function yr(n){return n.max-n.min}function VJ(n,t,e){return Math.abs(n-t)<=e}function mI(n,t,e,r=.5){n.origin=r,n.originPoint=Fe(t.min,t.max,n.origin),n.scale=yr(e)/yr(t),n.translate=Fe(e.min,e.max,n.origin)-n.originPoint,(n.scale>=IJ&&n.scale<=PJ||isNaN(n.scale))&&(n.scale=1),(n.translate>=NJ&&n.translate<=LJ||isNaN(n.translate))&&(n.translate=0)}function np(n,t,e,r){mI(n.x,t.x,e.x,r?r.originX:void 0),mI(n.y,t.y,e.y,r?r.originY:void 0)}function gI(n,t,e){n.min=e.min+t.min,n.max=n.min+yr(t)}function jJ(n,t,e){gI(n.x,t.x,e.x),gI(n.y,t.y,e.y)}function yI(n,t,e){n.min=t.min-e.min,n.max=n.min+yr(t)}function nv(n,t,e){yI(n.x,t.x,e.x),yI(n.y,t.y,e.y)}function vI(n,t,e,r,i){return n-=t,n=ev(n,1/e,r),i!==void 0&&(n=ev(n,1/i,r)),n}function BJ(n,t=0,e=1,r=.5,i,s=n,o=n){if(qs.test(t)&&(t=parseFloat(t),t=Fe(o.min,o.max,t/100)-o.min),typeof t!="number")return;let l=Fe(s.min,s.max,r);n===s&&(l-=t),n.min=vI(n.min,t,e,l,i),n.max=vI(n.max,t,e,l,i)}function bI(n,t,[e,r,i],s,o){BJ(n,t[e],t[r],t[i],t.scale,s,o)}const FJ=["x","scaleX","originX"],UJ=["y","scaleY","originY"];function _I(n,t,e,r){bI(n.x,t,FJ,e?e.x:void 0,r?r.x:void 0),bI(n.y,t,UJ,e?e.y:void 0,r?r.y:void 0)}function TI(n){return n.translate===0&&n.scale===1}function rB(n){return TI(n.x)&&TI(n.y)}function SI(n,t){return n.min===t.min&&n.max===t.max}function zJ(n,t){return SI(n.x,t.x)&&SI(n.y,t.y)}function wI(n,t){return Math.round(n.min)===Math.round(t.min)&&Math.round(n.max)===Math.round(t.max)}function iB(n,t){return wI(n.x,t.x)&&wI(n.y,t.y)}function xI(n){return yr(n.x)/yr(n.y)}function EI(n,t){return n.translate===t.translate&&n.scale===t.scale&&n.originPoint===t.originPoint}function Ms(n){return[n("x"),n("y")]}function HJ(n,t,e){let r="";const i=n.x.translate/t.x,s=n.y.translate/t.y,o=e?.z||0;if((i||s||o)&&(r=`translate3d(${i}px, ${s}px, ${o}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),e){const{transformPerspective:h,rotate:d,rotateX:m,rotateY:g,skewX:v,skewY:T}=e;h&&(r=`perspective(${h}px) ${r}`),d&&(r+=`rotate(${d}deg) `),m&&(r+=`rotateX(${m}deg) `),g&&(r+=`rotateY(${g}deg) `),v&&(r+=`skewX(${v}deg) `),T&&(r+=`skewY(${T}deg) `)}const l=n.x.scale*t.x,u=n.y.scale*t.y;return(l!==1||u!==1)&&(r+=`scale(${l}, ${u})`),r||"none"}const sB=["TopLeft","TopRight","BottomLeft","BottomRight"],$J=sB.length,CI=n=>typeof n=="string"?parseFloat(n):n,AI=n=>typeof n=="number"||St.test(n);function qJ(n,t,e,r,i,s){i?(n.opacity=Fe(0,e.opacity??1,GJ(r)),n.opacityExit=Fe(t.opacity??1,0,WJ(r))):s&&(n.opacity=Fe(t.opacity??1,e.opacity??1,r));for(let o=0;o<$J;o++){const l=`border${sB[o]}Radius`;let u=kI(t,l),h=kI(e,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||AI(u)===AI(h)?(n[l]=Math.max(Fe(CI(u),CI(h),r),0),(qs.test(h)||qs.test(u))&&(n[l]+="%")):n[l]=h}(t.rotate||e.rotate)&&(n.rotate=Fe(t.rotate||0,e.rotate||0,r))}function kI(n,t){return n[t]!==void 0?n[t]:n.borderRadius}const GJ=oB(0,.5,Q3),WJ=oB(.5,.95,xi);function oB(n,t,e){return r=>r<n?0:r>t?1:e(Dp(n,t,r))}function YJ(n,t,e){const r=er(n)?n:Lh(n);return r.start(Z1("",r,t,e)),r.animation}function Np(n,t,e,r={passive:!0}){return n.addEventListener(t,e,r),()=>n.removeEventListener(t,e)}const KJ=(n,t)=>n.depth-t.depth;class XJ{constructor(){this.children=[],this.isDirty=!1}add(t){j1(this.children,t),this.isDirty=!0}remove(t){X0(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(KJ),this.isDirty=!1,this.children.forEach(t)}}function QJ(n,t){const e=gr.now(),r=({timestamp:i})=>{const s=i-e;s>=t&&(yl(r),n(s-t))};return ke.setup(r,!0),()=>yl(r)}function g0(n){return er(n)?n.get():n}class JJ{constructor(){this.members=[]}add(t){j1(this.members,t);for(let e=this.members.length-1;e>=0;e--){const r=this.members[e];if(r===t||r===this.lead||r===this.prevLead)continue;const i=r.instance;i&&i.isConnected===!1&&r.isPresent!==!1&&!r.snapshot&&X0(this.members,r)}t.scheduleRender()}remove(t){if(X0(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(t){const e=this.members.findIndex(i=>t===i);if(e===0)return!1;let r;for(let i=e;i>=0;i--){const s=this.members[i],o=s.instance;if(s.isPresent!==!1&&(!o||o.isConnected!==!1)){r=s;break}}return r?(this.promote(r),!0):!1}promote(t,e){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender();const i=r.options.layoutDependency,s=t.options.layoutDependency;if(!(i!==void 0&&s!==void 0&&i===s)){const u=r.instance;u&&u.isConnected===!1&&!r.snapshot||(t.resumeFrom=r,e&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0))}const{crossfade:l}=t.options;l===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:e,resumingFrom:r}=t;e.onExitComplete&&e.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const y0={hasAnimatedSinceResize:!0,hasEverUpdated:!1},jS=["","X","Y","Z"],ZJ=1e3;let tZ=0;function BS(n,t,e,r){const{latestValues:i}=t;i[n]&&(e[n]=i[n],t.setStaticValue(n,0),r&&(r[n]=0))}function aB(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:t}=n.options;if(!t)return;const e=Aj(t);if(window.MotionHasOptimisedAnimation(e,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(e,"transform",ke,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&aB(r)}function lB({attachResizeListener:n,defaultParent:t,measureScroll:e,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},l=t?.()){this.id=tZ++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(rZ),this.nodes.forEach(aZ),this.nodes.forEach(lZ),this.nodes.forEach(iZ)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new XJ)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new F1),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=sC(o)&&!nJ(o),this.instance=o;const{layoutId:l,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||l)&&(this.isLayoutDirty=!0),n){let d,m=0;const g=()=>this.root.updateBlockedByResize=!1;ke.read(()=>{m=window.innerWidth}),n(o,()=>{const v=window.innerWidth;v!==m&&(m=v,this.root.updateBlockedByResize=!0,d&&d(),d=QJ(g,250),y0.hasAnimatedSinceResize&&(y0.hasAnimatedSinceResize=!1,this.nodes.forEach(DI)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||u)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:m,hasRelativeLayoutChanged:g,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const T=this.options.transition||h.getDefaultTransition()||dZ,{onLayoutAnimationStart:S,onLayoutAnimationComplete:w}=h.getProps(),E=!this.targetLayout||!iB(this.targetLayout,v),R=!m&&g;if(this.options.layoutRoot||this.resumeFrom||R||m&&(E||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const P={...J1(T,"layout"),onPlay:S,onComplete:w};(h.shouldReduceMotion||this.options.layoutRoot)&&(P.delay=0,P.type=!1),this.startAnimation(P),this.setAnimationOrigin(d,R)}else m||DI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),yl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(cZ),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&aB(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const m=this.path[d];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(RI);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(MI);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(oZ),this.nodes.forEach(eZ),this.nodes.forEach(nZ)):this.nodes.forEach(MI),this.clearAllSnapshots();const l=gr.now();Hn.delta=Ks(0,1e3/60,l-Hn.timestamp),Hn.timestamp=l,Hn.isProcessing=!0,MS.update.process(Hn),MS.preRender.process(Hn),MS.render.process(Hn),Hn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,rC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(sZ),this.sharedNodes.forEach(uZ)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ke.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ke.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!yr(this.snapshot.measuredBox.x)&&!yr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=wn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:e(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!rB(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,d=h!==this.prevTransformTemplateValue;o&&this.instance&&(l||yc(this.latestValues)||d)&&(i(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),pZ(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return wn();const l=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(mZ))){const{scroll:h}=this.root;h&&(ph(l.x,h.offset.x),ph(l.y,h.offset.y))}return l}removeElementScroll(o){const l=wn();if(Hi(l,o),this.scroll?.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:d,options:m}=h;h!==this.root&&d&&m.layoutScroll&&(d.wasRoot&&Hi(l,o),ph(l.x,d.offset.x),ph(l.y,d.offset.y))}return l}applyTransform(o,l=!1){const u=wn();Hi(u,o);for(let h=0;h<this.path.length;h++){const d=this.path[h];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&mh(u,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),yc(d.latestValues)&&mh(u,d.latestValues)}return yc(this.latestValues)&&mh(u,this.latestValues),u}removeTransform(o){const l=wn();Hi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!yc(h.latestValues))continue;Rx(h.latestValues)&&h.updateSnapshot();const d=wn(),m=h.measurePageBox();Hi(d,m),_I(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return yc(this.latestValues)&&_I(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Hn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:m}=this.options;if(!this.layout||!(d||m))return;this.resolvedRelativeTargetAt=Hn.timestamp;const g=this.getClosestProjectingParent();g&&this.linkedParentVersion!==g.layoutVersion&&!g.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(g&&g.layout?this.createRelativeTarget(g,this.layout.layoutBox,g.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=wn(),this.targetWithTransforms=wn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),jJ(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Hi(this.target,this.layout.layoutBox),qj(this.target,this.targetDelta)):Hi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?this.createRelativeTarget(g,this.target,g.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Rx(this.parent.latestValues)||$j(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,l,u){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=wn(),this.relativeTargetOrigin=wn(),nv(this.relativeTargetOrigin,l,u),Hi(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Hn.timestamp&&(u=!1),u)return;const{layout:h,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||d))return;Hi(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,g=this.treeScale.y;dJ(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=wn());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(pI(this.prevProjectionDelta.x,this.projectionDelta.x),pI(this.prevProjectionDelta.y,this.projectionDelta.y)),np(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==g||!EI(this.projectionDelta.x,this.prevProjectionDelta.x)||!EI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=dh(),this.projectionDelta=dh(),this.projectionDeltaWithTransform=dh()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},d={...this.latestValues},m=dh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const g=wn(),v=u?u.source:void 0,T=this.layout?this.layout.source:void 0,S=v!==T,w=this.getStack(),E=!w||w.members.length<=1,R=!!(S&&!E&&this.options.crossfade===!0&&!this.path.some(fZ));this.animationProgress=0;let P;this.mixTargetDelta=j=>{const N=j/1e3;OI(m.x,o.x,N),OI(m.y,o.y,N),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(nv(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),hZ(this.relativeTarget,this.relativeTargetOrigin,g,N),P&&zJ(this.relativeTarget,P)&&(this.isProjectionDirty=!1),P||(P=wn()),Hi(P,this.relativeTarget)),S&&(this.animationValues=d,qJ(d,h,this.latestValues,N,R,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(yl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ke.update(()=>{y0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Lh(0)),this.motionValue.jump(0,!1),this.currentAnimation=YJ(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(ZJ),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:d}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&cB(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||wn();const m=yr(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+m;const g=yr(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+g}Hi(l,u),mh(l,d),np(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new JJ),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&BS("z",o,h,this.animationValues);for(let d=0;d<jS.length;d++)BS(`rotate${jS[d]}`,o,h,this.animationValues),BS(`skew${jS[d]}`,o,h,this.animationValues);o.render();for(const d in h)o.setStaticValue(d,h[d]),this.animationValues&&(this.animationValues[d]=h[d]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=g0(l?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=g0(l?.pointerEvents)||""),this.hasProjected&&!yc(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const d=h.animationValues||h.latestValues;this.applyTransformsToTarget();let m=HJ(this.projectionDeltaWithTransform,this.treeScale,d);u&&(m=u(d,m)),o.transform=m;const{x:g,y:v}=this.projectionDelta;o.transformOrigin=`${g.origin*100}% ${v.origin*100}% 0`,h.animationValues?o.opacity=h===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:o.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const T in Dx){if(d[T]===void 0)continue;const{correct:S,applyTo:w,isCSSVariable:E}=Dx[T],R=m==="none"?d[T]:S(d[T],h);if(w){const P=w.length;for(let j=0;j<P;j++)o[w[j]]=R}else E?this.options.visualElement.renderState.vars[T]=R:o[T]=R}this.options.layoutId&&(o.pointerEvents=h===this?g0(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(RI),this.root.sharedNodes.clear()}}}function eZ(n){n.updateLayout()}function nZ(n){const t=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:e,measuredBox:r}=n.layout,{animationType:i}=n.options,s=t.source!==n.layout.source;i==="size"?Ms(d=>{const m=s?t.measuredBox[d]:t.layoutBox[d],g=yr(m);m.min=e[d].min,m.max=m.min+g}):cB(i,t.layoutBox,e)&&Ms(d=>{const m=s?t.measuredBox[d]:t.layoutBox[d],g=yr(e[d]);m.max=m.min+g,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[d].max=n.relativeTarget[d].min+g)});const o=dh();np(o,e,t.layoutBox);const l=dh();s?np(l,n.applyTransform(r,!0),t.measuredBox):np(l,e,t.layoutBox);const u=!rB(o);let h=!1;if(!n.resumeFrom){const d=n.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:m,layout:g}=d;if(m&&g){const v=wn();nv(v,t.layoutBox,m.layoutBox);const T=wn();nv(T,e,g.layoutBox),iB(v,T)||(h=!0),d.options.layoutRoot&&(n.relativeTarget=T,n.relativeTargetOrigin=v,n.relativeParent=d)}}}n.notifyListeners("didUpdate",{layout:e,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:h})}else if(n.isLead()){const{onExitComplete:e}=n.options;e&&e()}n.options.transition=void 0}function rZ(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function iZ(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function sZ(n){n.clearSnapshot()}function RI(n){n.clearMeasurements()}function MI(n){n.isLayoutDirty=!1}function oZ(n){const{visualElement:t}=n.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),n.resetTransform()}function DI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function aZ(n){n.resolveTargetDelta()}function lZ(n){n.calcProjection()}function cZ(n){n.resetSkewAndRotation()}function uZ(n){n.removeLeadSnapshot()}function OI(n,t,e){n.translate=Fe(t.translate,0,e),n.scale=Fe(t.scale,1,e),n.origin=t.origin,n.originPoint=t.originPoint}function II(n,t,e,r){n.min=Fe(t.min,e.min,r),n.max=Fe(t.max,e.max,r)}function hZ(n,t,e,r){II(n.x,t.x,e.x,r),II(n.y,t.y,e.y,r)}function fZ(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const dZ={duration:.45,ease:[.4,0,.1,1]},PI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),NI=PI("applewebkit/")&&!PI("chrome/")?Math.round:xi;function LI(n){n.min=NI(n.min),n.max=NI(n.max)}function pZ(n){LI(n.x),LI(n.y)}function cB(n,t,e){return n==="position"||n==="preserve-aspect"&&!VJ(xI(t),xI(e),.2)}function mZ(n){return n!==n.root&&n.scroll?.wasRoot}const gZ=lB({attachResizeListener:(n,t)=>Np(n,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),FS={current:void 0},uB=lB({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!FS.current){const n=new gZ({});n.mount(window),n.setOptions({layoutScroll:!0}),FS.current=n}return FS.current},resetTransform:(n,t)=>{n.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),uC=L.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function VI(n,t){if(typeof n=="function")return n(t);n!=null&&(n.current=t)}function yZ(...n){return t=>{let e=!1;const r=n.map(i=>{const s=VI(i,t);return!e&&typeof s=="function"&&(e=!0),s});if(e)return()=>{for(let i=0;i<r.length;i++){const s=r[i];typeof s=="function"?s():VI(n[i],null)}}}}function vZ(...n){return L.useCallback(yZ(...n),n)}class bZ extends L.Component{getSnapshotBeforeUpdate(t){const e=this.props.childRef.current;if(e&&t.isPresent&&!this.props.isPresent&&this.props.pop!==!1){const r=e.offsetParent,i=Ax(r)&&r.offsetWidth||0,s=Ax(r)&&r.offsetHeight||0,o=this.props.sizeRef.current;o.height=e.offsetHeight||0,o.width=e.offsetWidth||0,o.top=e.offsetTop,o.left=e.offsetLeft,o.right=i-o.width-o.left,o.bottom=s-o.height-o.top}return null}componentDidUpdate(){}render(){return this.props.children}}function _Z({children:n,isPresent:t,anchorX:e,anchorY:r,root:i,pop:s}){const o=L.useId(),l=L.useRef(null),u=L.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:h}=L.useContext(uC),d=n.props?.ref??n?.ref,m=vZ(l,d);return L.useInsertionEffect(()=>{const{width:g,height:v,top:T,left:S,right:w,bottom:E}=u.current;if(t||s===!1||!l.current||!g||!v)return;const R=e==="left"?`left: ${S}`:`right: ${w}`,P=r==="bottom"?`bottom: ${E}`:`top: ${T}`;l.current.dataset.motionPopId=o;const j=document.createElement("style");h&&(j.nonce=h);const N=i??document.head;return N.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${v}px !important;
            ${R}px !important;
            ${P}px !important;
          }
        `),()=>{N.contains(j)&&N.removeChild(j)}},[t]),z.jsx(bZ,{isPresent:t,childRef:l,sizeRef:u,pop:s,children:s===!1?n:L.cloneElement(n,{ref:m})})}const TZ=({children:n,initial:t,isPresent:e,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:o,anchorX:l,anchorY:u,root:h})=>{const d=V1(SZ),m=L.useId();let g=!0,v=L.useMemo(()=>(g=!1,{id:m,initial:t,isPresent:e,custom:i,onExitComplete:T=>{d.set(T,!0);for(const S of d.values())if(!S)return;r&&r()},register:T=>(d.set(T,!1),()=>d.delete(T))}),[e,d,r]);return s&&g&&(v={...v}),L.useMemo(()=>{d.forEach((T,S)=>d.set(S,!1))},[e]),L.useEffect(()=>{!e&&!d.size&&r&&r()},[e]),n=z.jsx(_Z,{pop:o==="popLayout",isPresent:e,anchorX:l,anchorY:u,root:h,children:n}),z.jsx(Pb.Provider,{value:v,children:n})};function SZ(){return new Map}function hB(n=!0){const t=L.useContext(Pb);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:r,register:i}=t,s=L.useId();L.useEffect(()=>{if(n)return i(s)},[n]);const o=L.useCallback(()=>n&&r&&r(s),[s,r,n]);return!e&&r?[!1,o]:[!0]}const dy=n=>n.key||"";function jI(n){const t=[];return L.Children.forEach(n,e=>{L.isValidElement(e)&&t.push(e)}),t}const US=({children:n,custom:t,initial:e=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:o=!1,anchorX:l="left",anchorY:u="top",root:h})=>{const[d,m]=hB(o),g=L.useMemo(()=>jI(n),[n]),v=o&&!d?[]:g.map(dy),T=L.useRef(!0),S=L.useRef(g),w=V1(()=>new Map),E=L.useRef(new Set),[R,P]=L.useState(g),[j,N]=L.useState(g);B3(()=>{T.current=!1,S.current=g;for(let k=0;k<j.length;k++){const O=dy(j[k]);v.includes(O)?(w.delete(O),E.current.delete(O)):w.get(O)!==!0&&w.set(O,!1)}},[j,v.length,v.join("-")]);const W=[];if(g!==R){let k=[...g];for(let O=0;O<j.length;O++){const B=j[O],F=dy(B);v.includes(F)||(k.splice(O,0,B),W.push(B))}return s==="wait"&&W.length&&(k=W),N(jI(k)),P(g),null}const{forceRender:M}=L.useContext(L1);return z.jsx(z.Fragment,{children:j.map(k=>{const O=dy(k),B=o&&!d?!1:g===j||v.includes(O),F=()=>{if(E.current.has(O))return;if(E.current.add(O),w.has(O))w.set(O,!0);else return;let H=!0;w.forEach(V=>{V||(H=!1)}),H&&(M?.(),N(S.current),o&&m?.(),r&&r())};return z.jsx(TZ,{isPresent:B,initial:!T.current||e?void 0:!1,custom:t,presenceAffectsLayout:i,mode:s,root:h,onExitComplete:B?void 0:F,anchorX:l,anchorY:u,children:k},O)})})},fB=L.createContext({strict:!1}),BI={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let FI=!1;function wZ(){if(FI)return;const n={};for(const t in BI)n[t]={isEnabled:e=>BI[t].some(r=>!!e[r])};Uj(n),FI=!0}function dB(){return wZ(),cJ()}function xZ(n){const t=dB();for(const e in n)t[e]={...t[e],...n[e]};Uj(t)}const EZ=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","propagate","ignoreStrict","viewport"]);function rv(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||EZ.has(n)}let pB=n=>!rv(n);function CZ(n){typeof n=="function"&&(pB=t=>t.startsWith("on")?!rv(t):n(t))}try{CZ(require("@emotion/is-prop-valid").default)}catch{}function AZ(n,t,e){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(pB(i)||e===!0&&rv(i)||!t&&!rv(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const Vb=L.createContext({});function kZ(n,t){if(Lb(n)){const{initial:e,animate:r}=n;return{initial:e===!1||Pp(e)?e:void 0,animate:Pp(r)?r:void 0}}return n.inherit!==!1?t:{}}function RZ(n){const{initial:t,animate:e}=kZ(n,L.useContext(Vb));return L.useMemo(()=>({initial:t,animate:e}),[UI(t),UI(e)])}function UI(n){return Array.isArray(n)?n.join(" "):n}const hC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function mB(n,t,e){for(const r in t)!er(t[r])&&!Yj(r,e)&&(n[r]=t[r])}function MZ({transformTemplate:n},t){return L.useMemo(()=>{const e=hC();return lC(e,t,n),Object.assign({},e.vars,e.style)},[t])}function DZ(n,t){const e=n.style||{},r={};return mB(r,e,n),Object.assign(r,MZ(n,t)),r}function OZ(n,t){const e={},r=DZ(n,t);return n.drag&&n.dragListener!==!1&&(e.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(e.tabIndex=0),e.style=r,e}const gB=()=>({...hC(),attrs:{}});function IZ(n,t,e,r){const i=L.useMemo(()=>{const s=gB();return Kj(s,t,Qj(r),n.transformTemplate,n.style),{...s.attrs,style:{...s.style}}},[t]);if(n.style){const s={};mB(s,n.style,n),i.style={...s,...i.style}}return i}const PZ=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function fC(n){return typeof n!="string"||n.includes("-")?!1:!!(PZ.indexOf(n)>-1||/[A-Z]/u.test(n))}function NZ(n,t,e,{latestValues:r},i,s=!1,o){const u=(o??fC(n)?IZ:OZ)(t,r,i,n),h=AZ(t,typeof n=="string",s),d=n!==L.Fragment?{...h,...u,ref:e}:{},{children:m}=t,g=L.useMemo(()=>er(m)?m.get():m,[m]);return L.createElement(n,{...d,children:g})}function LZ({scrapeMotionValuesFromProps:n,createRenderState:t},e,r,i){return{latestValues:VZ(e,r,i,n),renderState:t()}}function VZ(n,t,e,r){const i={},s=r(n,{});for(const g in s)i[g]=g0(s[g]);let{initial:o,animate:l}=n;const u=Lb(n),h=Bj(n);t&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=t.initial),l===void 0&&(l=t.animate));let d=e?e.initial===!1:!1;d=d||o===!1;const m=d?l:o;if(m&&typeof m!="boolean"&&!Nb(m)){const g=Array.isArray(m)?m:[m];for(let v=0;v<g.length;v++){const T=tC(n,g[v]);if(T){const{transitionEnd:S,transition:w,...E}=T;for(const R in E){let P=E[R];if(Array.isArray(P)){const j=d?P.length-1:0;P=P[j]}P!==null&&(i[R]=P)}for(const R in S)i[R]=S[R]}}}return i}const yB=n=>(t,e)=>{const r=L.useContext(Vb),i=L.useContext(Pb),s=()=>LZ(n,t,r,i);return e?s():V1(s)},jZ=yB({scrapeMotionValuesFromProps:cC,createRenderState:hC}),BZ=yB({scrapeMotionValuesFromProps:Jj,createRenderState:gB}),FZ=Symbol.for("motionComponentSymbol");function UZ(n,t,e){const r=L.useRef(e);L.useInsertionEffect(()=>{r.current=e});const i=L.useRef(null);return L.useCallback(s=>{s&&n.onMount?.(s),t&&(s?t.mount(s):t.unmount());const o=r.current;if(typeof o=="function")if(s){const l=o(s);typeof l=="function"&&(i.current=l)}else i.current?(i.current(),i.current=null):o(s);else o&&(o.current=s)},[t])}const vB=L.createContext({});function sh(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function zZ(n,t,e,r,i,s){const{visualElement:o}=L.useContext(Vb),l=L.useContext(fB),u=L.useContext(Pb),h=L.useContext(uC),d=h.reducedMotion,m=h.skipAnimations,g=L.useRef(null),v=L.useRef(!1);r=r||l.renderer,!g.current&&r&&(g.current=r(n,{visualState:t,parent:o,props:e,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:d,skipAnimations:m,isSVG:s}),v.current&&g.current&&(g.current.manuallyAnimateOnMount=!0));const T=g.current,S=L.useContext(vB);T&&!T.projection&&i&&(T.type==="html"||T.type==="svg")&&HZ(g.current,e,i,S);const w=L.useRef(!1);L.useInsertionEffect(()=>{T&&w.current&&T.update(e,u)});const E=e[Cj],R=L.useRef(!!E&&!window.MotionHandoffIsComplete?.(E)&&window.MotionHasOptimisedAnimation?.(E));return B3(()=>{v.current=!0,T&&(w.current=!0,window.MotionIsMounted=!0,T.updateFeatures(),T.scheduleRenderMicrotask(),R.current&&T.animationState&&T.animationState.animateChanges())}),L.useEffect(()=>{T&&(!R.current&&T.animationState&&T.animationState.animateChanges(),R.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(E)}),R.current=!1),T.enteringChildren=void 0)}),T}function HZ(n,t,e,r){const{layoutId:i,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h,layoutCrossfade:d}=t;n.projection=new e(n.latestValues,t["data-framer-portal-id"]?void 0:bB(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!o||l&&sh(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,crossfade:d,layoutScroll:u,layoutRoot:h})}function bB(n){if(n)return n.options.allowProjection!==!1?n.projection:bB(n.parent)}function zS(n,{forwardMotionProps:t=!1,type:e}={},r,i){r&&xZ(r);const s=e?e==="svg":fC(n),o=s?BZ:jZ;function l(h,d){let m;const g={...L.useContext(uC),...h,layoutId:$Z(h)},{isStatic:v}=g,T=RZ(h),S=o(h,v);if(!v&&j3){qZ();const w=GZ(g);m=w.MeasureLayout,T.visualElement=zZ(n,S,g,i,w.ProjectionNode,s)}return z.jsxs(Vb.Provider,{value:T,children:[m&&T.visualElement?z.jsx(m,{visualElement:T.visualElement,...g}):null,NZ(n,h,UZ(S,T.visualElement,d),S,v,t,s)]})}l.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const u=L.forwardRef(l);return u[FZ]=n,u}function $Z({layoutId:n}){const t=L.useContext(L1).id;return t&&n!==void 0?t+"-"+n:n}function qZ(n,t){L.useContext(fB).strict}function GZ(n){const t=dB(),{drag:e,layout:r}=t;if(!e&&!r)return{};const i={...e,...r};return{MeasureLayout:e?.isEnabled(n)||r?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function WZ(n,t){if(typeof Proxy>"u")return zS;const e=new Map,r=(s,o)=>zS(s,o,n,t),i=(s,o)=>r(s,o);return new Proxy(i,{get:(s,o)=>o==="create"?r:(e.has(o)||e.set(o,zS(o,void 0,n,t)),e.get(o))})}const YZ=(n,t)=>t.isSVG??fC(n)?new CJ(t):new _J(t,{allowProjection:n!==L.Fragment});class KZ extends Ol{constructor(t){super(t),t.animationState||(t.animationState=DJ(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Nb(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:e}=this.node.prevProps||{};t!==e&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let XZ=0;class QZ extends Ol{constructor(){super(...arguments),this.id=XZ++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:e}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const i=this.node.animationState.setActive("exit",!t);e&&!t&&i.then(()=>{e(this.id)})}mount(){const{register:t,onExitComplete:e}=this.node.presenceContext||{};e&&e(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const JZ={animation:{Feature:KZ},exit:{Feature:QZ}};function bm(n){return{point:{x:n.pageX,y:n.pageY}}}const ZZ=n=>t=>iC(t)&&n(t,bm(t));function rp(n,t,e,r){return Np(n,t,ZZ(e),r)}const _B=({current:n})=>n?n.ownerDocument.defaultView:null,zI=(n,t)=>Math.abs(n-t);function ttt(n,t){const e=zI(n.x,t.x),r=zI(n.y,t.y);return Math.sqrt(e**2+r**2)}const HI=new Set(["auto","scroll"]);class TB{constructor(t,e,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:s=!1,distanceThreshold:o=3,element:l}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=v=>{this.handleScroll(v.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=$S(this.lastMoveEventInfo,this.history),T=this.startEvent!==null,S=ttt(v.offset,{x:0,y:0})>=this.distanceThreshold;if(!T&&!S)return;const{point:w}=v,{timestamp:E}=Hn;this.history.push({...w,timestamp:E});const{onStart:R,onMove:P}=this.handlers;T||(R&&R(this.lastMoveEvent,v),this.startEvent=this.lastMoveEvent),P&&P(this.lastMoveEvent,v)},this.handlePointerMove=(v,T)=>{this.lastMoveEvent=v,this.lastMoveEventInfo=HS(T,this.transformPagePoint),ke.update(this.updatePoint,!0)},this.handlePointerUp=(v,T)=>{this.end();const{onEnd:S,onSessionEnd:w,resumeAnimation:E}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const R=$S(v.type==="pointercancel"?this.lastMoveEventInfo:HS(T,this.transformPagePoint),this.history);this.startEvent&&S&&S(v,R),w&&w(v,R)},!iC(t))return;this.dragSnapToOrigin=s,this.handlers=e,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const u=bm(t),h=HS(u,this.transformPagePoint),{point:d}=h,{timestamp:m}=Hn;this.history=[{...d,timestamp:m}];const{onSessionStart:g}=e;g&&g(t,$S(h,this.history)),this.removeListeners=gm(rp(this.contextWindow,"pointermove",this.handlePointerMove),rp(this.contextWindow,"pointerup",this.handlePointerUp),rp(this.contextWindow,"pointercancel",this.handlePointerUp)),l&&this.startScrollTracking(l)}startScrollTracking(t){let e=t.parentElement;for(;e;){const r=getComputedStyle(e);(HI.has(r.overflowX)||HI.has(r.overflowY))&&this.scrollPositions.set(e,{x:e.scrollLeft,y:e.scrollTop}),e=e.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0}),window.addEventListener("scroll",this.onWindowScroll),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const e=this.scrollPositions.get(t);if(!e)return;const r=t===window,i=r?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},s={x:i.x-e.x,y:i.y-e.y};s.x===0&&s.y===0||(r?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=s.x,this.lastMoveEventInfo.point.y+=s.y):this.history.length>0&&(this.history[0].x-=s.x,this.history[0].y-=s.y),this.scrollPositions.set(t,i),ke.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),yl(this.updatePoint)}}function HS(n,t){return t?{point:t(n.point)}:n}function $I(n,t){return{x:n.x-t.x,y:n.y-t.y}}function $S({point:n},t){return{point:n,delta:$I(n,SB(t)),offset:$I(n,ett(t)),velocity:ntt(t,.1)}}function ett(n){return n[0]}function SB(n){return n[n.length-1]}function ntt(n,t){if(n.length<2)return{x:0,y:0};let e=n.length-1,r=null;const i=SB(n);for(;e>=0&&(r=n[e],!(i.timestamp-r.timestamp>ns(t)));)e--;if(!r)return{x:0,y:0};r===n[0]&&n.length>2&&i.timestamp-r.timestamp>ns(t)*2&&(r=n[1]);const s=wi(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const o={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function rtt(n,{min:t,max:e},r){return t!==void 0&&n<t?n=r?Fe(t,n,r.min):Math.max(n,t):e!==void 0&&n>e&&(n=r?Fe(e,n,r.max):Math.min(n,e)),n}function qI(n,t,e){return{min:t!==void 0?n.min+t:void 0,max:e!==void 0?n.max+e-(n.max-n.min):void 0}}function itt(n,{top:t,left:e,bottom:r,right:i}){return{x:qI(n.x,e,i),y:qI(n.y,t,r)}}function GI(n,t){let e=t.min-n.min,r=t.max-n.max;return t.max-t.min<n.max-n.min&&([e,r]=[r,e]),{min:e,max:r}}function stt(n,t){return{x:GI(n.x,t.x),y:GI(n.y,t.y)}}function ott(n,t){let e=.5;const r=yr(n),i=yr(t);return i>r?e=Dp(t.min,t.max-r,n.min):r>i&&(e=Dp(n.min,n.max-i,t.min)),Ks(0,1,e)}function att(n,t){const e={};return t.min!==void 0&&(e.min=t.min-n.min),t.max!==void 0&&(e.max=t.max-n.min),e}const Ox=.35;function ltt(n=Ox){return n===!1?n=0:n===!0&&(n=Ox),{x:WI(n,"left","right"),y:WI(n,"top","bottom")}}function WI(n,t,e){return{min:YI(n,t),max:YI(n,e)}}function YI(n,t){return typeof n=="number"?n:n[t]||0}const ctt=new WeakMap;class utt{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=wn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:e=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const s=m=>{e&&this.snapToCursor(bm(m).point),this.stopAnimation()},o=(m,g)=>{const{drag:v,dragPropagation:T,onDragStart:S}=this.getProps();if(v&&!T&&(this.openDragLock&&this.openDragLock(),this.openDragLock=BQ(v),!this.openDragLock))return;this.latestPointerEvent=m,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ms(E=>{let R=this.getAxisMotionValue(E).get()||0;if(qs.test(R)){const{projection:P}=this.visualElement;if(P&&P.layout){const j=P.layout.layoutBox[E];j&&(R=yr(j)*(parseFloat(R)/100))}}this.originPoint[E]=R}),S&&ke.update(()=>S(m,g),!1,!0),wx(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},l=(m,g)=>{this.latestPointerEvent=m,this.latestPanInfo=g;const{dragPropagation:v,dragDirectionLock:T,onDirectionLock:S,onDrag:w}=this.getProps();if(!v&&!this.openDragLock)return;const{offset:E}=g;if(T&&this.currentDirection===null){this.currentDirection=ftt(E),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",g.point,E),this.updateAxis("y",g.point,E),this.visualElement.render(),w&&ke.update(()=>w(m,g),!1,!0)},u=(m,g)=>{this.latestPointerEvent=m,this.latestPanInfo=g,this.stop(m,g),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>{const{dragSnapToOrigin:m}=this.getProps();(m||this.constraints)&&this.startAnimation({x:0,y:0})},{dragSnapToOrigin:d}=this.getProps();this.panSession=new TB(t,{onSessionStart:s,onStart:o,onMove:l,onSessionEnd:u,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:r,contextWindow:_B(this.visualElement),element:this.visualElement.current})}stop(t,e){const r=t||this.latestPointerEvent,i=e||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&ke.postRender(()=>l(r,i))}cancel(){this.isDragging=!1;const{projection:t,animationState:e}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),e&&e.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(t,e,r){const{drag:i}=this.getProps();if(!r||!py(t,i,this.currentDirection))return;const s=this.getAxisMotionValue(t);let o=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(o=rtt(o,this.constraints[t],this.elastic[t])),s.set(o)}resolveConstraints(){const{dragConstraints:t,dragElastic:e}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;t&&sh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=itt(r.layoutBox,t):this.constraints=!1,this.elastic=ltt(e),i!==this.constraints&&!sh(t)&&r&&this.constraints&&!this.hasMutatedConstraints&&Ms(s=>{this.constraints!==!1&&this.getAxisMotionValue(s)&&(this.constraints[s]=att(r.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:e}=this.getProps();if(!t||!sh(t))return!1;const r=t.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=pJ(r,i.root,this.visualElement.getTransformPagePoint());let o=stt(i.layout.layoutBox,s);if(e){const l=e(hJ(o));this.hasMutatedConstraints=!!l,l&&(o=Hj(l))}return o}startAnimation(t){const{drag:e,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=Ms(d=>{if(!py(d,e,this.currentDirection))return;let m=u&&u[d]||{};o&&(m={min:0,max:0});const g=i?200:1e6,v=i?40:1e7,T={type:"inertia",velocity:r?t[d]:0,bounceStiffness:g,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...m};return this.startAxisValueAnimation(d,T)});return Promise.all(h).then(l)}startAxisValueAnimation(t,e){const r=this.getAxisMotionValue(t);return wx(this.visualElement,t),r.start(Z1(t,r,0,e,this.visualElement,!1))}stopAnimation(){Ms(t=>this.getAxisMotionValue(t).stop())}getAxisMotionValue(t){const e=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),i=r[e];return i||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Ms(e=>{const{drag:r}=this.getProps();if(!py(e,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(e);if(i&&i.layout){const{min:o,max:l}=i.layout.layoutBox[e],u=s.get()||0;s.set(t[e]-Fe(o,l,.5)+u)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:e}=this.getProps(),{projection:r}=this.visualElement;if(!sh(e)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ms(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();i[o]=ott({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.constraints=!1,this.resolveConstraints(),Ms(o=>{if(!py(o,t,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(Fe(u,h,i[o]))}),this.visualElement.render()}addListeners(){if(!this.visualElement.current)return;ctt.set(this.visualElement,this);const t=this.visualElement.current,e=rp(t,"pointerdown",h=>{const{drag:d,dragListener:m=!0}=this.getProps(),g=h.target,v=g!==t&&qQ(g);d&&m&&!v&&this.start(h)});let r;const i=()=>{const{dragConstraints:h}=this.getProps();sh(h)&&h.current&&(this.constraints=this.resolveRefConstraints(),r||(r=htt(t,h.current,()=>this.scalePositionWithinConstraints())))},{projection:s}=this.visualElement,o=s.addEventListener("measure",i);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ke.read(i);const l=Np(window,"resize",()=>this.scalePositionWithinConstraints()),u=s.addEventListener("didUpdate",(({delta:h,hasLayoutChanged:d})=>{this.isDragging&&d&&(Ms(m=>{const g=this.getAxisMotionValue(m);g&&(this.originPoint[m]+=h[m].translate,g.set(g.get()+h[m].translate))}),this.visualElement.render())}));return()=>{l(),e(),o(),u&&u(),r&&r()}}getProps(){const t=this.visualElement.getProps(),{drag:e=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:o=Ox,dragMomentum:l=!0}=t;return{...t,drag:e,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function KI(n){let t=!0;return()=>{if(t){t=!1;return}n()}}function htt(n,t,e){const r=nI(n,KI(e)),i=nI(t,KI(e));return()=>{r(),i()}}function py(n,t,e){return(t===!0||t===n)&&(e===null||e===n)}function ftt(n,t=10){let e=null;return Math.abs(n.y)>t?e="y":Math.abs(n.x)>t&&(e="x"),e}class dtt extends Ol{constructor(t){super(t),this.removeGroupControls=xi,this.removeListeners=xi,this.controls=new utt(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||xi}update(){const{dragControls:t}=this.node.getProps(),{dragControls:e}=this.node.prevProps||{};t!==e&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const qS=n=>(t,e)=>{n&&ke.update(()=>n(t,e),!1,!0)};class ptt extends Ol{constructor(){super(...arguments),this.removePointerDownListener=xi}onPointerDown(t){this.session=new TB(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:_B(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:e,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:qS(t),onStart:qS(e),onMove:qS(r),onEnd:(s,o)=>{delete this.session,i&&ke.postRender(()=>i(s,o))}}}mount(){this.removePointerDownListener=rp(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let GS=!1;class mtt extends L.Component{componentDidMount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=t;s&&(e.group&&e.group.add(s),r&&r.register&&i&&r.register(s),GS&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),y0.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:e,visualElement:r,drag:i,isPresent:s}=this.props,{projection:o}=r;return o&&(o.isPresent=s,t.layoutDependency!==e&&o.setOptions({...o.options,layoutDependency:e}),GS=!0,i||t.layoutDependency!==e||e===void 0||t.isPresent!==s?o.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?o.promote():o.relegate()||ke.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),rC.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:r}=this.props,{projection:i}=t;GS=!0,i&&(i.scheduleCheckAfterUnmount(),e&&e.group&&e.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function wB(n){const[t,e]=hB(),r=L.useContext(L1);return z.jsx(mtt,{...n,layoutGroup:r,switchLayoutGroup:L.useContext(vB),isPresent:t,safeToRemove:e})}const gtt={pan:{Feature:ptt},drag:{Feature:dtt,ProjectionNode:uB,MeasureLayout:wB}};function XI(n,t,e){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",e==="Start");const i="onHover"+e,s=r[i];s&&ke.postRender(()=>s(t,bm(t)))}class ytt extends Ol{mount(){const{current:t}=this.node;t&&(this.unmount=UQ(t,(e,r)=>(XI(this.node,r,"Start"),i=>XI(this.node,i,"End"))))}unmount(){}}class vtt extends Ol{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=gm(Np(this.node.current,"focus",()=>this.onFocus()),Np(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function QI(n,t,e){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",e==="Start");const i="onTap"+(e==="End"?"":e),s=r[i];s&&ke.postRender(()=>s(t,bm(t)))}class btt extends Ol{mount(){const{current:t}=this.node;if(!t)return;const{globalTapTarget:e,propagate:r}=this.node.props;this.unmount=WQ(t,(i,s)=>(QI(this.node,s,"Start"),(o,{success:l})=>QI(this.node,o,l?"End":"Cancel")),{useGlobalTarget:e,stopPropagation:r?.tap===!1})}unmount(){}}const Ix=new WeakMap,WS=new WeakMap,_tt=n=>{const t=Ix.get(n.target);t&&t(n)},Ttt=n=>{n.forEach(_tt)};function Stt({root:n,...t}){const e=n||document;WS.has(e)||WS.set(e,{});const r=WS.get(e),i=JSON.stringify(t);return r[i]||(r[i]=new IntersectionObserver(Ttt,{root:n,...t})),r[i]}function wtt(n,t,e){const r=Stt(t);return Ix.set(n,e),r.observe(n),()=>{Ix.delete(n),r.unobserve(n)}}const xtt={some:0,all:1};class Ett extends Ol{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:e,margin:r,amount:i="some",once:s}=t,o={root:e?e.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:xtt[i]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:d,onViewportLeave:m}=this.node.getProps(),g=h?d:m;g&&g(u)};return wtt(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:e}=this.node;["amount","margin","root"].some(Ctt(t,e))&&this.startObserver()}unmount(){}}function Ctt({viewport:n={}},{viewport:t={}}={}){return e=>n[e]!==t[e]}const Att={inView:{Feature:Ett},tap:{Feature:btt},focus:{Feature:vtt},hover:{Feature:ytt}},ktt={layout:{ProjectionNode:uB,MeasureLayout:wB}},Rtt={...JZ,...Att,...gtt,...ktt},hr=WZ(Rtt,YZ);function Mtt(){const{user:n,loading:t,signInWithGoogle:e,signInWithEmail:r,signUp:i}=Ib(),s=em(),[o,l]=L.useState(!1),[u,h]=L.useState(""),[d,m]=L.useState(""),[g,v]=L.useState(""),[T,S]=L.useState(""),[w,E]=L.useState(!1);L.useEffect(()=>{!t&&n&&s("/dashboard",{replace:!0})},[n,t,s]);const R=async()=>{S(""),E(!0);try{await e(),s("/dashboard",{replace:!0})}catch(j){S(j.message||"Google sign-in failed. Please try again.")}finally{E(!1)}},P=async j=>{j.preventDefault(),S(""),E(!0);try{o?await i(d,g,u):await r(d,g),s("/dashboard",{replace:!0})}catch(N){S(N.message||"Authentication failed. Please try again.")}finally{E(!1)}};return t?z.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-100 via-pink-50 to-rose-100",children:z.jsx("div",{className:"animate-pulse font-['Pacifico'] text-3xl text-pink-400",children:"DearMe "})}):z.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-100 via-pink-50 to-rose-100 px-4",children:z.jsxs(hr.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"w-full max-w-md bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl shadow-pink-200/40 p-8",children:[z.jsx("h1",{className:"font-['Pacifico'] text-4xl text-pink-400 text-center mb-2",children:"DearMe "}),z.jsx("p",{className:"font-['Poppins'] text-sm text-pink-300 text-center mb-8",children:"Your safe, beautiful diary"}),T&&z.jsx(hr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 p-3 rounded-xl bg-red-50 border border-red-200 text-red-600 text-sm font-['Poppins'] text-center",children:T}),z.jsxs("button",{type:"button",onClick:R,disabled:w,className:"w-full flex items-center justify-center gap-3 py-3 px-4 rounded-xl border border-pink-200 bg-white hover:bg-pink-50 transition-colors font-['Poppins'] text-sm text-gray-700 mb-6 disabled:opacity-50 disabled:cursor-not-allowed",children:[z.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[z.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z",fill:"#4285F4"}),z.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),z.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),z.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Sign in with Google"]}),z.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[z.jsx("div",{className:"flex-1 h-px bg-pink-200"}),z.jsx("span",{className:"font-['Poppins'] text-xs text-pink-300",children:"or"}),z.jsx("div",{className:"flex-1 h-px bg-pink-200"})]}),z.jsxs("form",{onSubmit:P,className:"space-y-4",children:[o&&z.jsx(hr.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:z.jsx("input",{type:"text",placeholder:"Your name",value:u,onChange:j=>h(j.target.value),className:"w-full px-4 py-3 rounded-xl border border-pink-200 bg-white/70 font-['Poppins'] text-sm text-gray-700 placeholder-pink-300 focus:outline-none focus:ring-2 focus:ring-pink-300 focus:border-transparent transition-all"})}),z.jsx("input",{type:"email",placeholder:"Email",value:d,onChange:j=>m(j.target.value),required:!0,className:"w-full px-4 py-3 rounded-xl border border-pink-200 bg-white/70 font-['Poppins'] text-sm text-gray-700 placeholder-pink-300 focus:outline-none focus:ring-2 focus:ring-pink-300 focus:border-transparent transition-all"}),z.jsx("input",{type:"password",placeholder:"Password",value:g,onChange:j=>v(j.target.value),required:!0,className:"w-full px-4 py-3 rounded-xl border border-pink-200 bg-white/70 font-['Poppins'] text-sm text-gray-700 placeholder-pink-300 focus:outline-none focus:ring-2 focus:ring-pink-300 focus:border-transparent transition-all"}),z.jsx("button",{type:"submit",disabled:w,className:"w-full py-3 rounded-xl bg-pink-400 hover:bg-pink-500 text-white font-['Poppins'] text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:w?"Please wait...":o?"Create Account":"Sign In"})]}),z.jsxs("p",{className:"mt-6 text-center font-['Poppins'] text-sm text-gray-500",children:[o?"Already have an account?":"Don't have an account?"," ",z.jsx("button",{type:"button",onClick:()=>{l(!o),S("")},className:"text-pink-400 hover:text-pink-500 font-medium transition-colors",children:o?"Sign In":"Sign Up"})]})]})})}const JI=["#FFE4E1","#E8F5E9","#FFF3E0","#E3F2FD","#F3E5F5","#FFF9C4","#E0F7FA","#FCE4EC"];function Dtt(n,t){if(!n||n.length===0)return null;let e=n;n.length>1&&t&&(e=n.filter(s=>s.id!==t));const r=Math.floor(Math.random()*e.length),i=Math.floor(Math.random()*JI.length);return{...e[r],backgroundColor:JI[i]}}const Ott=[{id:"q1",text:"You survived today. That's enough ",author:"Unknown",category:"self-care"},{id:"q2",text:"Healing is not linear ",author:"Unknown",category:"self-care"},{id:"q3",text:"Little steps count.",author:"Unknown",category:"motivation"},{id:"q4",text:"Be gentle with yourself. You're doing the best you can ",author:"Unknown",category:"self-care"},{id:"q5",text:"You are allowed to take up space in this world ",author:"Unknown",category:"motivation"},{id:"q6",text:"Rest is productive too ",author:"Unknown",category:"productivity"},{id:"q7",text:"Your feelings are valid, always ",author:"Unknown",category:"self-care"},{id:"q8",text:"You don't have to be perfect to be worthy of love ",author:"Unknown",category:"love"},{id:"q9",text:"Progress, not perfection ",author:"Unknown",category:"motivation"},{id:"q10",text:"The sun will rise and we will try again ",author:"Unknown",category:"general"},{id:"q11",text:"You are enough, just as you are ",author:"Unknown",category:"self-care"},{id:"q12",text:"One day at a time, one breath at a time ",author:"Unknown",category:"general"},{id:"q13",text:"Your story isn't over yet ",author:"Unknown",category:"motivation"},{id:"q14",text:"It's okay to not have all the answers right now ",author:"Unknown",category:"general"},{id:"q15",text:"You are someone's reason to smile ",author:"Unknown",category:"love"},{id:"q16",text:"Small progress is still progress ",author:"Unknown",category:"productivity"},{id:"q17",text:"Let yourself bloom at your own pace ",author:"Unknown",category:"self-care"},{id:"q18",text:"You carry so much love in your heart. Give some to yourself ",author:"Unknown",category:"love"},{id:"q19",text:"Done is better than perfect ",author:"Unknown",category:"productivity"},{id:"q20",text:"Breathe. You're going to be okay ",author:"Unknown",category:"general"},{id:"q21",text:"Every day is a fresh start ",author:"Unknown",category:"motivation"},{id:"q22",text:"You deserve the love you keep giving to others ",author:"Unknown",category:"love"},{id:"q23",text:"Celebrate the tiny victories today ",author:"Unknown",category:"productivity"},{id:"q24",text:"Soft days are still good days ",author:"Unknown",category:"general"}],Px=["happy","sad","productive","romantic","anxious","calm","neutral"],xB={happy:"",sad:"",productive:"",romantic:"",anxious:"",calm:"",neutral:""},vc=10,ZI=200,EB=5*1024*1024,CB=["image/jpeg","image/png","image/gif","image/webp"],Itt={happy:{bg:"bg-yellow-100",border:"border-yellow-400",hover:"hover:bg-yellow-50"},sad:{bg:"bg-blue-100",border:"border-blue-400",hover:"hover:bg-blue-50"},productive:{bg:"bg-green-100",border:"border-green-400",hover:"hover:bg-green-50"},romantic:{bg:"bg-pink-100",border:"border-pink-400",hover:"hover:bg-pink-50"},anxious:{bg:"bg-orange-100",border:"border-orange-400",hover:"hover:bg-orange-50"},calm:{bg:"bg-teal-100",border:"border-teal-400",hover:"hover:bg-teal-50"},neutral:{bg:"bg-gray-100",border:"border-gray-400",hover:"hover:bg-gray-50"}};function AB({value:n,onChange:t}){return z.jsx("div",{className:"flex flex-wrap gap-3",role:"group","aria-label":"Select your mood",children:Px.map(e=>{const r=n===e,i=Itt[e];return z.jsxs("button",{type:"button",onClick:()=>t(e),"aria-label":`${e} mood`,"aria-pressed":r,className:`flex flex-col items-center gap-1 px-4 py-3 rounded-2xl border-2 transition-all cursor-pointer font-['Poppins'] text-sm capitalize ${r?`${i.bg} ${i.border} shadow-md scale-105`:`bg-white border-transparent ${i.hover} hover:shadow-sm`}`,children:[z.jsx("span",{className:"text-2xl",role:"img","aria-hidden":"true",children:xB[e]}),z.jsx("span",{className:r?"font-medium":"text-gray-500",children:e})]},e)})})}function Ptt(){const n=new Date().getHours();return n<12?{text:"Good Morning",emoji:""}:n<18?{text:"Good Afternoon",emoji:""}:{text:"Good Evening",emoji:""}}function Ntt(n){return n?(n.toDate?n.toDate():new Date(n)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function Ltt(n){if(!n)return"";if(typeof n=="string")return n.slice(0,100);try{const t=[],e=i=>{i.text&&t.push(i.text),i.content&&i.content.forEach(e)};e(n);const r=t.join(" ");return r.length>100?r.slice(0,100)+"":r}catch{return""}}function Ed({className:n=""}){return z.jsx("div",{className:`animate-pulse rounded-2xl bg-pink-100/50 ${n}`,children:z.jsxs("div",{className:"p-5 space-y-3",children:[z.jsx("div",{className:"h-4 bg-pink-200/60 rounded w-3/4"}),z.jsx("div",{className:"h-3 bg-pink-200/40 rounded w-full"}),z.jsx("div",{className:"h-3 bg-pink-200/40 rounded w-1/2"})]})})}const Vtt={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Cd={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.45,ease:"easeOut"}}};function jtt(){const{user:n}=Ib(),t=em(),[e,r]=L.useState(null),[i,s]=L.useState([]),[o,l]=L.useState(!0),[u,h]=L.useState(null),d=L.useMemo(()=>Ptt(),[]),m=L.useMemo(()=>Dtt(Ott),[]);L.useEffect(()=>{if(!n)return;let v=!1;async function T(){try{const S=await Ob(Vo(Qi,"users",n.uid));!v&&S.exists()&&r(S.data());const w=sY(t3(Qi,"entries"),oY("userId","==",n.uid),aY("date","desc"),lY(5)),E=await mY(w);v||s(E.docs.map(R=>({id:R.id,...R.data()})))}catch(S){console.error("Dashboard fetch error:",S)}finally{v||l(!1)}}return T(),()=>{v=!0}},[n]);const g=e?.name||n?.displayName||"Friend";return o?z.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-8 space-y-6",children:[z.jsx("div",{className:"animate-pulse h-10 bg-pink-200/40 rounded w-2/3"}),z.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[z.jsx(Ed,{className:"h-28"}),z.jsx(Ed,{className:"h-28"})]}),z.jsx(Ed,{className:"h-32"}),z.jsx(Ed,{className:"h-24"}),z.jsx(Ed,{className:"h-24"})]}):z.jsxs(hr.div,{className:"max-w-3xl mx-auto px-4 py-8 space-y-8",variants:Vtt,initial:"hidden",animate:"visible",children:[z.jsxs(hr.h1,{variants:Cd,className:"font-['Pacifico'] text-3xl sm:text-4xl text-[var(--color-text,#4A2040)]",children:[d.text,", ",g," ",d.emoji]}),z.jsxs(hr.div,{variants:Cd,className:"flex flex-wrap items-center gap-4",children:[z.jsxs("div",{className:"flex items-center gap-2 bg-white/80 backdrop-blur rounded-2xl px-5 py-3 shadow-sm border border-pink-100",children:[z.jsx("span",{className:"text-2xl",children:""}),z.jsxs("span",{className:"font-['Poppins'] text-lg font-semibold text-[var(--color-text,#4A2040)]",children:[e?.streak??0," day streak"]})]}),z.jsx("button",{onClick:()=>t("/editor"),className:"ml-auto bg-gradient-to-r from-pink-400 to-rose-400 hover:from-pink-500 hover:to-rose-500 text-white font-['Poppins'] font-medium px-6 py-3 rounded-2xl shadow-md hover:shadow-lg transition-all cursor-pointer",children:" Write Today's Entry"})]}),m&&z.jsxs(hr.div,{variants:Cd,className:"rounded-2xl p-6 shadow-sm",style:{backgroundColor:m.backgroundColor},children:[z.jsxs("p",{className:"font-['Caveat'] text-xl sm:text-2xl text-gray-800 leading-relaxed",children:['"',m.text,'"']}),z.jsxs("p",{className:"font-['Poppins'] text-sm text-gray-600 mt-2",children:[" ",m.author]})]}),z.jsxs(hr.div,{variants:Cd,className:"bg-white/80 backdrop-blur rounded-2xl p-5 shadow-sm border border-pink-100",children:[z.jsx("h2",{className:"font-['Caveat'] text-xl text-[var(--color-text,#4A2040)] mb-3",children:"How are you feeling right now?"}),z.jsx(AB,{value:u,onChange:h})]}),z.jsxs(hr.section,{variants:Cd,children:[z.jsx("h2",{className:"font-['Caveat'] text-2xl text-[var(--color-text,#4A2040)] mb-4",children:"Recent Entries "}),i.length===0?z.jsx("p",{className:"font-['Poppins'] text-gray-400 text-sm",children:"No entries yet. Start writing your first diary entry!"}):z.jsx("div",{className:"space-y-3",children:i.map(v=>z.jsx(DE,{to:`/editor/${v.id}`,className:"block bg-white/80 backdrop-blur rounded-2xl p-4 shadow-sm border border-pink-100 hover:shadow-md hover:scale-[1.01] transition-all",children:z.jsxs("div",{className:"flex items-start justify-between gap-3",children:[z.jsxs("div",{className:"min-w-0 flex-1",children:[z.jsx("h3",{className:"font-['Poppins'] font-medium text-[var(--color-text,#4A2040)] truncate",children:v.title||"Untitled"}),z.jsx("p",{className:"font-['Poppins'] text-sm text-gray-500 mt-1 line-clamp-2",children:Ltt(v.content)}),z.jsx("span",{className:"font-['Poppins'] text-xs text-gray-400 mt-2 inline-block",children:Ntt(v.date)})]}),v.mood&&z.jsx("span",{className:"text-2xl flex-shrink-0",title:v.mood,children:xB[v.mood]||""})]})},v.id))})]})]})}var YS={exports:{}},KS={};var t2;function Btt(){if(t2)return KS;t2=1;var n=Zp();function t(m,g){return m===g&&(m!==0||1/m===1/g)||m!==m&&g!==g}var e=typeof Object.is=="function"?Object.is:t,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(m,g){var v=g(),T=r({inst:{value:v,getSnapshot:g}}),S=T[0].inst,w=T[1];return s(function(){S.value=v,S.getSnapshot=g,u(S)&&w({inst:S})},[m,v,g]),i(function(){return u(S)&&w({inst:S}),m(function(){u(S)&&w({inst:S})})},[m]),o(v),v}function u(m){var g=m.getSnapshot;m=m.value;try{var v=g();return!e(m,v)}catch{return!0}}function h(m,g){return g()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return KS.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:d,KS}var e2;function kB(){return e2||(e2=1,YS.exports=Btt()),YS.exports}var RB=kB();function zn(n){this.content=n}zn.prototype={constructor:zn,find:function(n){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===n)return t;return-1},get:function(n){var t=this.find(n);return t==-1?void 0:this.content[t+1]},update:function(n,t,e){var r=e&&e!=n?this.remove(e):this,i=r.find(n),s=r.content.slice();return i==-1?s.push(e||n,t):(s[i+1]=t,e&&(s[i]=e)),new zn(s)},remove:function(n){var t=this.find(n);if(t==-1)return this;var e=this.content.slice();return e.splice(t,2),new zn(e)},addToStart:function(n,t){return new zn([n,t].concat(this.remove(n).content))},addToEnd:function(n,t){var e=this.remove(n).content.slice();return e.push(n,t),new zn(e)},addBefore:function(n,t,e){var r=this.remove(t),i=r.content.slice(),s=r.find(n);return i.splice(s==-1?i.length:s,0,t,e),new zn(i)},forEach:function(n){for(var t=0;t<this.content.length;t+=2)n(this.content[t],this.content[t+1])},prepend:function(n){return n=zn.from(n),n.size?new zn(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=zn.from(n),n.size?new zn(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var t=this;n=zn.from(n);for(var e=0;e<n.content.length;e+=2)t=t.remove(n.content[e]);return t},toObject:function(){var n={};return this.forEach(function(t,e){n[t]=e}),n},get size(){return this.content.length>>1}};zn.from=function(n){if(n instanceof zn)return n;var t=[];if(n)for(var e in n)t.push(e,n[e]);return new zn(t)};function MB(n,t,e){for(let r=0;;r++){if(r==n.childCount||r==t.childCount)return n.childCount==t.childCount?null:e;let i=n.child(r),s=t.child(r);if(i==s){e+=i.nodeSize;continue}if(!i.sameMarkup(s))return e;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)e++;return e}if(i.content.size||s.content.size){let o=MB(i.content,s.content,e+1);if(o!=null)return o}e+=i.nodeSize}}function DB(n,t,e,r){for(let i=n.childCount,s=t.childCount;;){if(i==0||s==0)return i==s?null:{a:e,b:r};let o=n.child(--i),l=t.child(--s),u=o.nodeSize;if(o==l){e-=u,r-=u;continue}if(!o.sameMarkup(l))return{a:e,b:r};if(o.isText&&o.text!=l.text){let h=0,d=Math.min(o.text.length,l.text.length);for(;h<d&&o.text[o.text.length-h-1]==l.text[l.text.length-h-1];)h++,e--,r--;return{a:e,b:r}}if(o.content.size||l.content.size){let h=DB(o.content,l.content,e-1,r-1);if(h)return h}e-=u,r-=u}}class ut{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,i=0,s){for(let o=0,l=0;l<e;o++){let u=this.content[o],h=l+u.nodeSize;if(h>t&&r(u,i+l,s||null,o)!==!1&&u.content.size){let d=l+1;u.nodesBetween(Math.max(0,t-d),Math.min(u.content.size,e-d),r,i+d)}l=h}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,i){let s="",o=!0;return this.nodesBetween(t,e,(l,u)=>{let h=l.isText?l.text.slice(Math.max(t,u)-u,e-u):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&h||l.isTextblock)&&r&&(o?o=!1:s+=r),s+=h},0),s}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,i=this.content.slice(),s=0;for(e.isText&&e.sameMarkup(r)&&(i[i.length-1]=e.withText(e.text+r.text),s=1);s<t.content.length;s++)i.push(t.content[s]);return new ut(i,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let r=[],i=0;if(e>t)for(let s=0,o=0;o<e;s++){let l=this.content[s],u=o+l.nodeSize;u>t&&((o<t||u>e)&&(l.isText?l=l.cut(Math.max(0,t-o),Math.min(l.text.length,e-o)):l=l.cut(Math.max(0,t-o-1),Math.min(l.content.size,e-o-1))),r.push(l),i+=l.nodeSize),o=u}return new ut(r,i)}cutByIndex(t,e){return t==e?ut.empty:t==0&&e==this.content.length?this:new ut(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let i=this.content.slice(),s=this.size+e.nodeSize-r.nodeSize;return i[t]=e,new ut(i,s)}addToStart(t){return new ut([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new ut(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let i=this.content[e];t(i,r,e),r+=i.nodeSize}}findDiffStart(t,e=0){return MB(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return DB(this,t,e,r)}findIndex(t){if(t==0)return my(0,t);if(t==this.size)return my(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let e=0,r=0;;e++){let i=this.child(e),s=r+i.nodeSize;if(s>=t)return s==t?my(e+1,s):my(e,r);r=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return ut.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new ut(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return ut.empty;let e,r=0;for(let i=0;i<t.length;i++){let s=t[i];r+=s.nodeSize,i&&s.isText&&t[i-1].sameMarkup(s)?(e||(e=t.slice(0,i)),e[e.length-1]=s.withText(e[e.length-1].text+s.text)):e&&e.push(s)}return new ut(e||t,r)}static from(t){if(!t)return ut.empty;if(t instanceof ut)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new ut([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ut.empty=new ut([],0);const XS={index:0,offset:0};function my(n,t){return XS.index=n,XS.offset=t,XS}function iv(n,t){if(n===t)return!0;if(!(n&&typeof n=="object")||!(t&&typeof t=="object"))return!1;let e=Array.isArray(n);if(Array.isArray(t)!=e)return!1;if(e){if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if(!iv(n[r],t[r]))return!1}else{for(let r in n)if(!(r in t)||!iv(n[r],t[r]))return!1;for(let r in t)if(!(r in n))return!1}return!0}let Ee=class Nx{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,r=!1;for(let i=0;i<t.length;i++){let s=t[i];if(this.eq(s))return t;if(this.type.excludes(s.type))e||(e=t.slice(0,i));else{if(s.type.excludes(this.type))return t;!r&&s.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),r=!0),e&&e.push(s)}}return e||(e=t.slice()),r||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&iv(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let r=t.marks[e.type];if(!r)throw new RangeError(`There is no mark type ${e.type} in this schema`);let i=r.create(e.attrs);return r.checkAttrs(i.attrs),i}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].eq(e[r]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return Nx.none;if(t instanceof Nx)return[t];let e=t.slice();return e.sort((r,i)=>r.type.rank-i.type.rank),e}};Ee.none=[];class sv extends Error{}class vt{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=IB(this.content,t+this.openStart,e);return r&&new vt(r,this.openStart,this.openEnd)}removeBetween(t,e){return new vt(OB(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return vt.empty;let r=e.openStart||0,i=e.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new vt(ut.fromJSON(t,e.content),r,i)}static maxOpen(t,e=!0){let r=0,i=0;for(let s=t.firstChild;s&&!s.isLeaf&&(e||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=t.lastChild;s&&!s.isLeaf&&(e||!s.type.spec.isolating);s=s.lastChild)i++;return new vt(t,r,i)}}vt.empty=new vt(ut.empty,0,0);function OB(n,t,e){let{index:r,offset:i}=n.findIndex(t),s=n.maybeChild(r),{index:o,offset:l}=n.findIndex(e);if(i==t||s.isText){if(l!=e&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,t).append(n.cut(e))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(OB(s.content,t-i-1,e-i-1)))}function IB(n,t,e,r){let{index:i,offset:s}=n.findIndex(t),o=n.maybeChild(i);if(s==t||o.isText)return r&&!r.canReplace(i,i,e)?null:n.cut(0,t).append(e).append(n.cut(t));let l=IB(o.content,t-s-1,e,o);return l&&n.replaceChild(i,o.copy(l))}function Ftt(n,t,e){if(e.openStart>n.depth)throw new sv("Inserted content deeper than insertion position");if(n.depth-e.openStart!=t.depth-e.openEnd)throw new sv("Inconsistent open depths");return PB(n,t,e,0)}function PB(n,t,e,r){let i=n.index(r),s=n.node(r);if(i==t.index(r)&&r<n.depth-e.openStart){let o=PB(n,t,e,r+1);return s.copy(s.content.replaceChild(i,o))}else if(e.content.size)if(!e.openStart&&!e.openEnd&&n.depth==r&&t.depth==r){let o=n.parent,l=o.content;return Vc(o,l.cut(0,n.parentOffset).append(e.content).append(l.cut(t.parentOffset)))}else{let{start:o,end:l}=Utt(e,n);return Vc(s,LB(n,o,l,t,r))}else return Vc(s,ov(n,t,r))}function NB(n,t){if(!t.type.compatibleContent(n.type))throw new sv("Cannot join "+t.type.name+" onto "+n.type.name)}function Lx(n,t,e){let r=n.node(e);return NB(r,t.node(e)),r}function Lc(n,t){let e=t.length-1;e>=0&&n.isText&&n.sameMarkup(t[e])?t[e]=n.withText(t[e].text+n.text):t.push(n)}function ip(n,t,e,r){let i=(t||n).node(e),s=0,o=t?t.index(e):i.childCount;n&&(s=n.index(e),n.depth>e?s++:n.textOffset&&(Lc(n.nodeAfter,r),s++));for(let l=s;l<o;l++)Lc(i.child(l),r);t&&t.depth==e&&t.textOffset&&Lc(t.nodeBefore,r)}function Vc(n,t){return n.type.checkContent(t),n.copy(t)}function LB(n,t,e,r,i){let s=n.depth>i&&Lx(n,t,i+1),o=r.depth>i&&Lx(e,r,i+1),l=[];return ip(null,n,i,l),s&&o&&t.index(i)==e.index(i)?(NB(s,o),Lc(Vc(s,LB(n,t,e,r,i+1)),l)):(s&&Lc(Vc(s,ov(n,t,i+1)),l),ip(t,e,i,l),o&&Lc(Vc(o,ov(e,r,i+1)),l)),ip(r,null,i,l),new ut(l)}function ov(n,t,e){let r=[];if(ip(null,n,e,r),n.depth>e){let i=Lx(n,t,e+1);Lc(Vc(i,ov(n,t,e+1)),r)}return ip(t,null,e,r),new ut(r)}function Utt(n,t){let e=t.depth-n.openStart,i=t.node(e).copy(n.content);for(let s=e-1;s>=0;s--)i=t.node(s).copy(ut.from(i));return{start:i.resolveNoCache(n.openStart+e),end:i.resolveNoCache(i.content.size-n.openEnd-e)}}class Lp{constructor(t,e,r){this.pos=t,this.path=e,this.parentOffset=r,this.depth=e.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=t.child(e);return r?t.child(e).cut(r):i}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):t==0?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let r=this.path[e*3],i=e==0?0:this.path[e*3-1]+1;for(let s=0;s<t;s++)i+=r.child(s).nodeSize;return i}marks(){let t=this.parent,e=this.index();if(t.content.size==0)return Ee.none;if(this.textOffset)return t.child(e).marks;let r=t.maybeChild(e-1),i=t.maybeChild(e);if(!r){let l=r;r=i,i=l}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let r=e.marks,i=t.parent.maybeChild(t.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!e||e(this.node(r))))return new av(this,t,r);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let r=[],i=0,s=e;for(let o=t;;){let{index:l,offset:u}=o.content.findIndex(s),h=s-u;if(r.push(o,l,i+u),!h||(o=o.child(l),o.isText))break;s=h-1,i+=u+1}return new Lp(e,r,s)}static resolveCached(t,e){let r=n2.get(t);if(r)for(let s=0;s<r.elts.length;s++){let o=r.elts[s];if(o.pos==e)return o}else n2.set(t,r=new ztt);let i=r.elts[r.i]=Lp.resolve(t,e);return r.i=(r.i+1)%Htt,i}}class ztt{constructor(){this.elts=[],this.i=0}}const Htt=12,n2=new WeakMap;class av{constructor(t,e,r){this.$from=t,this.$to=e,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const $tt=Object.create(null);class is{constructor(t,e,r,i=Ee.none){this.type=t,this.attrs=e,this.marks=i,this.content=r||ut.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,r,i=0){this.content.nodesBetween(t,e,r,i,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,r,i){return this.content.textBetween(t,e,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,r){return this.type==t&&iv(this.attrs,e||t.defaultAttrs||$tt)&&Ee.sameSet(this.marks,r||Ee.none)}copy(t=null){return t==this.content?this:new is(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new is(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return t==0&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,r=!1){if(t==e)return vt.empty;let i=this.resolve(t),s=this.resolve(e),o=r?0:i.sharedDepth(e),l=i.start(o),h=i.node(o).content.cut(i.pos-l,s.pos-l);return new vt(h,i.depth-o,s.depth-o)}replace(t,e,r){return Ftt(this.resolve(t),this.resolve(e),r)}nodeAt(t){for(let e=this;;){let{index:r,offset:i}=e.content.findIndex(t);if(e=e.maybeChild(r),!e)return null;if(i==t||e.isText)return e;t-=i+1}}childAfter(t){let{index:e,offset:r}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:r}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:e,offset:r}=this.content.findIndex(t);if(r<t)return{node:this.content.child(e),index:e,offset:r};let i=this.content.child(e-1);return{node:i,index:e-1,offset:r-i.nodeSize}}resolve(t){return Lp.resolveCached(this,t)}resolveNoCache(t){return Lp.resolve(this,t)}rangeHasMark(t,e,r){let i=!1;return e>t&&this.nodesBetween(t,e,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),VB(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,r=ut.empty,i=0,s=r.childCount){let o=this.contentMatchAt(t).matchFragment(r,i,s),l=o&&o.matchFragment(this.content,e);if(!l||!l.validEnd)return!1;for(let u=i;u<s;u++)if(!this.type.allowsMarks(r.child(u).marks))return!1;return!0}canReplaceWith(t,e,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(t).matchType(r),o=s&&s.matchFragment(this.content,e);return o?o.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=Ee.none;for(let e=0;e<this.marks.length;e++){let r=this.marks[e];r.type.checkAttrs(r.attrs),t=r.addToSet(t)}if(!Ee.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(e=>e.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let r;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=e.marks.map(t.markFromJSON)}if(e.type=="text"){if(typeof e.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(e.text,r)}let i=ut.fromJSON(t,e.content),s=t.nodeType(e.type).create(e.attrs,i,r);return s.type.checkAttrs(s.attrs),s}}is.prototype.text=void 0;class lv extends is{constructor(t,e,r,i){if(super(t,e,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):VB(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new lv(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new lv(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return t==0&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function VB(n,t){for(let e=n.length-1;e>=0;e--)t=n[e].type.name+"("+t+")";return t}class Jc{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let r=new qtt(t,e);if(r.next==null)return Jc.empty;let i=jB(r);r.next&&r.err("Unexpected trailing text");let s=Jtt(Qtt(i));return Ztt(s,r),s}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,r=t.childCount){let i=this;for(let s=e;i&&s<r;s++)i=i.matchType(t.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!(e.isText||e.hasRequiredAttrs()))return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let r=0;r<t.next.length;r++)if(this.next[e].type==t.next[r].type)return!0;return!1}fillBefore(t,e=!1,r=0){let i=[this];function s(o,l){let u=o.matchFragment(t,r);if(u&&(!e||u.validEnd))return ut.from(l.map(h=>h.createAndFill()));for(let h=0;h<o.next.length;h++){let{type:d,next:m}=o.next[h];if(!(d.isText||d.hasRequiredAttrs())&&i.indexOf(m)==-1){i.push(m);let g=s(m,l.concat(d));if(g)return g}}return null}return s(this,[])}findWrapping(t){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==t)return this.wrapCache[r+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(t)){let o=[];for(let l=i;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:u}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in e)&&(!i.type||u.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),e[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function e(r){t.push(r);for(let i=0;i<r.next.length;i++)t.indexOf(r.next[i].next)==-1&&e(r.next[i].next)}return e(this),t.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+t.indexOf(r.next[o].next);return s}).join(`
`)}}Jc.empty=new Jc(!0);class qtt{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function jB(n){let t=[];do t.push(Gtt(n));while(n.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function Gtt(n){let t=[];do t.push(Wtt(n));while(n.next&&n.next!=")"&&n.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function Wtt(n){let t=Xtt(n);for(;;)if(n.eat("+"))t={type:"plus",expr:t};else if(n.eat("*"))t={type:"star",expr:t};else if(n.eat("?"))t={type:"opt",expr:t};else if(n.eat("{"))t=Ytt(n,t);else break;return t}function r2(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let t=Number(n.next);return n.pos++,t}function Ytt(n,t){let e=r2(n),r=e;return n.eat(",")&&(n.next!="}"?r=r2(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:e,max:r,expr:t}}function Ktt(n,t){let e=n.nodeTypes,r=e[t];if(r)return[r];let i=[];for(let s in e){let o=e[s];o.isInGroup(t)&&i.push(o)}return i.length==0&&n.err("No node type or group '"+t+"' found"),i}function Xtt(n){if(n.eat("(")){let t=jB(n);return n.eat(")")||n.err("Missing closing paren"),t}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let t=Ktt(n,n.next).map(e=>(n.inline==null?n.inline=e.isInline:n.inline!=e.isInline&&n.err("Mixing inline and block content"),{type:"name",value:e}));return n.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function Qtt(n){let t=[[]];return i(s(n,0),e()),t;function e(){return t.push([])-1}function r(o,l,u){let h={term:u,to:l};return t[o].push(h),h}function i(o,l){o.forEach(u=>u.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((u,h)=>u.concat(s(h,l)),[]);if(o.type=="seq")for(let u=0;;u++){let h=s(o.exprs[u],l);if(u==o.exprs.length-1)return h;i(h,l=e())}else if(o.type=="star"){let u=e();return r(l,u),i(s(o.expr,u),u),[r(u)]}else if(o.type=="plus"){let u=e();return i(s(o.expr,l),u),i(s(o.expr,u),u),[r(u)]}else{if(o.type=="opt")return[r(l)].concat(s(o.expr,l));if(o.type=="range"){let u=l;for(let h=0;h<o.min;h++){let d=e();i(s(o.expr,u),d),u=d}if(o.max==-1)i(s(o.expr,u),u);else for(let h=o.min;h<o.max;h++){let d=e();r(u,d),i(s(o.expr,u),d),u=d}return[r(u)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function BB(n,t){return t-n}function i2(n,t){let e=[];return r(t),e.sort(BB);function r(i){let s=n[i];if(s.length==1&&!s[0].term)return r(s[0].to);e.push(i);for(let o=0;o<s.length;o++){let{term:l,to:u}=s[o];!l&&e.indexOf(u)==-1&&r(u)}}}function Jtt(n){let t=Object.create(null);return e(i2(n,0));function e(r){let i=[];r.forEach(o=>{n[o].forEach(({term:l,to:u})=>{if(!l)return;let h;for(let d=0;d<i.length;d++)i[d][0]==l&&(h=i[d][1]);i2(n,u).forEach(d=>{h||i.push([l,h=[]]),h.indexOf(d)==-1&&h.push(d)})})});let s=t[r.join(",")]=new Jc(r.indexOf(n.length-1)>-1);for(let o=0;o<i.length;o++){let l=i[o][1].sort(BB);s.next.push({type:i[o][0],next:t[l.join(",")]||e(l)})}return s}}function Ztt(n,t){for(let e=0,r=[n];e<r.length;e++){let i=r[e],s=!i.validEnd,o=[];for(let l=0;l<i.next.length;l++){let{type:u,next:h}=i.next[l];o.push(u.name),s&&!(u.isText||u.hasRequiredAttrs())&&(s=!1),r.indexOf(h)==-1&&r.push(h)}s&&t.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function FB(n){let t=Object.create(null);for(let e in n){let r=n[e];if(!r.hasDefault)return null;t[e]=r.default}return t}function UB(n,t){let e=Object.create(null);for(let r in n){let i=t&&t[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}e[r]=i}return e}function zB(n,t,e,r){for(let i in t)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${e} of type ${i}`);for(let i in n){let s=n[i];s.validate&&s.validate(t[i])}}function HB(n,t){let e=Object.create(null);if(t)for(let r in t)e[r]=new eet(n,r,t[r]);return e}let s2=class $B{constructor(t,e,r){this.name=t,this.schema=e,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=HB(t,r.attrs),this.defaultAttrs=FB(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Jc.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:UB(this.attrs,t)}create(t=null,e,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new is(this,this.computeAttrs(t),ut.from(e),Ee.setFrom(r))}createChecked(t=null,e,r){return e=ut.from(e),this.checkContent(e),new is(this,this.computeAttrs(t),e,Ee.setFrom(r))}createAndFill(t=null,e,r){if(t=this.computeAttrs(t),e=ut.from(e),e.size){let o=this.contentMatch.fillBefore(e);if(!o)return null;e=o.append(e)}let i=this.contentMatch.matchFragment(e),s=i&&i.fillBefore(ut.empty,!0);return s?new is(this,t,e.append(s),Ee.setFrom(r)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){zB(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let e;for(let r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?e&&e.push(t[r]):e||(e=t.slice(0,r));return e?e.length?e:Ee.none:t}static compile(t,e){let r=Object.create(null);t.forEach((s,o)=>r[s]=new $B(s,e,o));let i=e.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function tet(n,t,e){let r=e.split("|");return i=>{let s=i===null?"null":typeof i;if(r.indexOf(s)<0)throw new RangeError(`Expected value of type ${r} for attribute ${t} on type ${n}, got ${s}`)}}class eet{constructor(t,e,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?tet(t,e,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class jb{constructor(t,e,r,i){this.name=t,this.rank=e,this.schema=r,this.spec=i,this.attrs=HB(t,i.attrs),this.excluded=null;let s=FB(this.attrs);this.instance=s?new Ee(this,s):null}create(t=null){return!t&&this.instance?this.instance:new Ee(this,UB(this.attrs,t))}static compile(t,e){let r=Object.create(null),i=0;return t.forEach((s,o)=>r[s]=new jb(s,i++,e,o)),r}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}checkAttrs(t){zB(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class qB{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let e=this.spec={};for(let i in t)e[i]=t[i];e.nodes=zn.from(t.nodes),e.marks=zn.from(t.marks||{}),this.nodes=s2.compile(this.spec.nodes,this),this.marks=jb.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",l=s.spec.marks;if(s.contentMatch=r[o]||(r[o]=Jc.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=l=="_"?null:l?o2(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:o2(this,o.split(" "))}this.nodeFromJSON=i=>is.fromJSON(this,i),this.markFromJSON=i=>Ee.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,r,i){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof s2){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(e,r,i)}text(t,e){let r=this.nodes.text;return new lv(r,r.defaultAttrs,t,Ee.setFrom(e))}mark(t,e){return typeof t=="string"&&(t=this.marks[t]),t.create(e)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function o2(n,t){let e=[];for(let r=0;r<t.length;r++){let i=t[r],s=n.marks[i],o=s;if(s)e.push(s);else for(let l in n.marks){let u=n.marks[l];(i=="_"||u.spec.group&&u.spec.group.split(" ").indexOf(i)>-1)&&e.push(o=u)}if(!o)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return e}function net(n){return n.tag!=null}function ret(n){return n.style!=null}class ol{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[];let r=this.matchedStyles=[];e.forEach(i=>{if(net(i))this.tags.push(i);else if(ret(i)){let s=/[^=]*/.exec(i.style)[0];r.indexOf(s)<0&&r.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=t.nodes[i.node];return s.contentMatch.matchType(s)})}parse(t,e={}){let r=new l2(this,e,!1);return r.addAll(t,Ee.none,e.from,e.to),r.finish()}parseSlice(t,e={}){let r=new l2(this,e,!0);return r.addAll(t,Ee.none,e.from,e.to),vt.maxOpen(r.finish())}matchTag(t,e,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(oet(t,s.tag)&&(s.namespace===void 0||t.namespaceURI==s.namespace)&&(!s.context||e.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(t);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(t,e,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(t)!=0||o.context&&!r.matchesContext(o.context)||l.length>t.length&&(l.charCodeAt(t.length)!=61||l.slice(t.length+1)!=e))){if(o.getAttrs){let u=o.getAttrs(e);if(u===!1)continue;o.attrs=u||void 0}return o}}}static schemaRules(t){let e=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<e.length;o++){let l=e[o];if((l.priority==null?50:l.priority)<s)break}e.splice(o,0,i)}for(let i in t.marks){let s=t.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=c2(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in t.nodes){let s=t.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=c2(o)),o.node||o.ignore||o.mark||(o.node=i)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new ol(t,ol.schemaRules(t)))}}const GB={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},iet={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},WB={ol:!0,ul:!0},Vp=1,Vx=2,sp=4;function a2(n,t,e){return t!=null?(t?Vp:0)|(t==="full"?Vx:0):n&&n.whitespace=="pre"?Vp|Vx:e&~sp}class gy{constructor(t,e,r,i,s,o){this.type=t,this.attrs=e,this.marks=r,this.solid=i,this.options=o,this.content=[],this.activeMarks=Ee.none,this.match=s||(o&sp?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(ut.from(t));if(e)this.match=this.type.contentMatch.matchFragment(e);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(t.type))?(this.match=r,i):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&Vp)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let e=ut.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(ut.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!GB.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class l2{constructor(t,e,r){this.parser=t,this.options=e,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=e.topNode,s,o=a2(null,e.preserveWhitespace,0)|(r?sp:0);i?s=new gy(i.type,i.attrs,Ee.none,!0,e.topMatch||i.type.contentMatch,o):r?s=new gy(null,null,Ee.none,!0,null,o):s=new gy(t.schema.topNodeType,null,Ee.none,!0,null,o),this.nodes=[s],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,e){t.nodeType==3?this.addTextNode(t,e):t.nodeType==1&&this.addElement(t,e)}addTextNode(t,e){let r=t.nodeValue,i=this.top,s=i.options&Vx?"full":this.localPreserveWS||(i.options&Vp)>0,{schema:o}=this.parser;if(s==="full"||i.inlineContext(t)||/[^ \t\r\n\u000c]/.test(r)){if(s)if(s==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let l=r.split(/\r?\n|\r/);for(let u=0;u<l.length;u++)u&&this.insertNode(o.linebreakReplacement.create(),e,!0),l[u]&&this.insertNode(o.text(l[u]),e,!/\S/.test(l[u]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let l=i.content[i.content.length-1],u=t.previousSibling;(!l||u&&u.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),e,!/\S/.test(r)),this.findInText(t)}else this.findInside(t)}addElement(t,e,r){let i=this.localPreserveWS,s=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let o=t.nodeName.toLowerCase(),l;WB.hasOwnProperty(o)&&this.parser.normalizeLists&&set(t);let u=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(l=this.parser.matchTag(t,this,r));t:if(u?u.ignore:iet.hasOwnProperty(o))this.findInside(t),this.ignoreFallback(t,e);else if(!u||u.skip||u.closeParent){u&&u.closeParent?this.open=Math.max(0,this.open-1):u&&u.skip.nodeType&&(t=u.skip);let h,d=this.needsBlock;if(GB.hasOwnProperty(o))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),h=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,e);break t}let m=u&&u.skip?e:this.readStyles(t,e);m&&this.addAll(t,m),h&&this.sync(s),this.needsBlock=d}else{let h=this.readStyles(t,e);h&&this.addElementByRule(t,u,h,u.consuming===!1?l:void 0)}this.localPreserveWS=i}leafFallback(t,e){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),e)}ignoreFallback(t,e){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),e,!0)}readStyles(t,e){let r=t.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],o=r.getPropertyValue(s);if(o)for(let l=void 0;;){let u=this.parser.matchStyle(s,o,this,l);if(!u)break;if(u.ignore)return null;if(u.clearMark?e=e.filter(h=>!u.clearMark(h)):e=e.concat(this.parser.schema.marks[u.mark].create(u.attrs)),u.consuming===!1)l=u;else break}}return e}addElementByRule(t,e,r,i){let s,o;if(e.node)if(o=this.parser.schema.nodes[e.node],o.isLeaf)this.insertNode(o.create(e.attrs),r,t.nodeName=="BR")||this.leafFallback(t,r);else{let u=this.enter(o,e.attrs||null,r,e.preserveWhitespace);u&&(s=!0,r=u)}else{let u=this.parser.schema.marks[e.mark];r=r.concat(u.create(e.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(t);else if(i)this.addElement(t,r,i);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(u=>this.insertNode(u,r,!1));else{let u=t;typeof e.contentElement=="string"?u=t.querySelector(e.contentElement):typeof e.contentElement=="function"?u=e.contentElement(t):e.contentElement&&(u=e.contentElement),this.findAround(t,u,!0),this.addAll(u,r),this.findAround(t,u,!1)}s&&this.sync(l)&&this.open--}addAll(t,e,r,i){let s=r||0;for(let o=r?t.childNodes[r]:t.firstChild,l=i==null?null:t.childNodes[i];o!=l;o=o.nextSibling,++s)this.findAtPoint(t,s),this.addDOM(o,e);this.findAtPoint(t,s)}findPlace(t,e,r){let i,s;for(let o=this.open,l=0;o>=0;o--){let u=this.nodes[o],h=u.findWrapping(t);if(h&&(!i||i.length>h.length+l)&&(i=h,s=u,!h.length))break;if(u.solid){if(r)break;l+=2}}if(!i)return null;this.sync(s);for(let o=0;o<i.length;o++)e=this.enterInner(i[o],null,e,!1);return e}insertNode(t,e,r){if(t.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(e=this.enterInner(s,null,e))}let i=this.findPlace(t,e,r);if(i){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(t.type));let o=Ee.none;for(let l of i.concat(t.marks))(s.type?s.type.allowsMarkType(l.type):u2(l.type,t.type))&&(o=l.addToSet(o));return s.content.push(t.mark(o)),!0}return!1}enter(t,e,r,i){let s=this.findPlace(t.create(e),r,!1);return s&&(s=this.enterInner(t,e,r,!0,i)),s}enterInner(t,e,r,i=!1,s){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(t);let l=a2(t,s,o.options);o.options&sp&&o.content.length==0&&(l|=sp);let u=Ee.none;return r=r.filter(h=>(o.type?o.type.allowsMarkType(h.type):u2(h.type,t))?(u=h.addToSet(u),!1):!0),this.nodes.push(new gy(t,e,u,i,null,l)),this.open++,r}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let e=this.open;e>=0;e--){if(this.nodes[e]==t)return this.open=e,!0;this.localPreserveWS&&(this.nodes[e].options|=Vp)}return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let r=this.nodes[e].content;for(let i=r.length-1;i>=0;i--)t+=r[i].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==e&&(this.find[r].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].pos==null&&t.nodeType==1&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,r){if(t!=e&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&e.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(l,u)=>{for(;l>=0;l--){let h=e[l];if(h==""){if(l==e.length-1||l==0)continue;for(;u>=s;u--)if(o(l-1,u))return!0;return!1}else{let d=u>0||u==0&&i?this.nodes[u].type:r&&u>=s?r.node(u-s).type:null;if(!d||d.name!=h&&!d.isInGroup(h))return!1;u--}}return!0};return o(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let r=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let e in this.parser.schema.nodes){let r=this.parser.schema.nodes[e];if(r.isTextblock&&r.defaultAttrs)return r}}}function set(n){for(let t=n.firstChild,e=null;t;t=t.nextSibling){let r=t.nodeType==1?t.nodeName.toLowerCase():null;r&&WB.hasOwnProperty(r)&&e?(e.appendChild(t),t=e):r=="li"?e=t:r&&(e=null)}}function oet(n,t){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,t)}function c2(n){let t={};for(let e in n)t[e]=n[e];return t}function u2(n,t){let e=t.schema.nodes;for(let r in e){let i=e[r];if(!i.allowsMarkType(n))continue;let s=[],o=l=>{s.push(l);for(let u=0;u<l.edgeCount;u++){let{type:h,next:d}=l.edge(u);if(h==t||s.indexOf(d)<0&&o(d))return!0}};if(o(i.contentMatch))return!0}}class lu{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},r){r||(r=QS(e).createDocumentFragment());let i=r,s=[];return t.forEach(o=>{if(s.length||o.marks.length){let l=0,u=0;for(;l<s.length&&u<o.marks.length;){let h=o.marks[u];if(!this.marks[h.type.name]){u++;continue}if(!h.eq(s[l][0])||h.type.spec.spanning===!1)break;l++,u++}for(;l<s.length;)i=s.pop()[1];for(;u<o.marks.length;){let h=o.marks[u++],d=this.serializeMark(h,o.isInline,e);d&&(s.push([h,i]),i.appendChild(d.dom),i=d.contentDOM||d.dom)}}i.appendChild(this.serializeNodeInner(o,e))}),r}serializeNodeInner(t,e){let{dom:r,contentDOM:i}=v0(QS(e),this.nodes[t.type.name](t),null,t.attrs);if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,i)}return r}serializeNode(t,e={}){let r=this.serializeNodeInner(t,e);for(let i=t.marks.length-1;i>=0;i--){let s=this.serializeMark(t.marks[i],t.isInline,e);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(t,e,r={}){let i=this.marks[t.type.name];return i&&v0(QS(r),i(t,e),null,t.attrs)}static renderSpec(t,e,r=null,i){return v0(t,e,r,i)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new lu(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=h2(t.nodes);return e.text||(e.text=r=>r.text),e}static marksFromSchema(t){return h2(t.marks)}}function h2(n){let t={};for(let e in n){let r=n[e].spec.toDOM;r&&(t[e]=r)}return t}function QS(n){return n.document||window.document}const f2=new WeakMap;function aet(n){let t=f2.get(n);return t===void 0&&f2.set(n,t=cet(n)),t}function cet(n){let t=null;function e(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")t||(t=[]),t.push(r);else for(let i=0;i<r.length;i++)e(r[i]);else for(let i in r)e(r[i])}return e(n),t}function v0(n,t,e,r){if(typeof t=="string")return{dom:n.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(s=aet(r))&&s.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(e=i.slice(0,o),i=i.slice(o+1));let l,u=e?n.createElementNS(e,i):n.createElement(i),h=t[1],d=1;if(h&&typeof h=="object"&&h.nodeType==null&&!Array.isArray(h)){d=2;for(let m in h)if(h[m]!=null){let g=m.indexOf(" ");g>0?u.setAttributeNS(m.slice(0,g),m.slice(g+1),h[m]):m=="style"&&u.style?u.style.cssText=h[m]:u.setAttribute(m,h[m])}}for(let m=d;m<t.length;m++){let g=t[m];if(g===0){if(m<t.length-1||m>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:u,contentDOM:u}}else{let{dom:v,contentDOM:T}=v0(n,g,e,r);if(u.appendChild(v),T){if(l)throw new RangeError("Multiple content holes");l=T}}}return{dom:u,contentDOM:l}}const YB=65535,KB=Math.pow(2,16);function uet(n,t){return n+t*KB}function d2(n){return n&YB}function het(n){return(n-(n&YB))/KB}const XB=1,QB=2,b0=4,JB=8;class jx{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(this.delInfo&JB)>0}get deletedBefore(){return(this.delInfo&(XB|b0))>0}get deletedAfter(){return(this.delInfo&(QB|b0))>0}get deletedAcross(){return(this.delInfo&b0)>0}}class Kr{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&Kr.empty)return Kr.empty}recover(t){let e=0,r=d2(t);if(!this.inverted)for(let i=0;i<r;i++)e+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+e+het(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let u=this.ranges[l]-(this.inverted?i:0);if(u>t)break;let h=this.ranges[l+s],d=this.ranges[l+o],m=u+h;if(t<=m){let g=h?t==u?-1:t==m?1:e:e,v=u+i+(g<0?0:d);if(r)return v;let T=t==(e<0?u:m)?null:uet(l/3,t-u),S=t==u?QB:t==m?XB:b0;return(e<0?t!=u:t!=m)&&(S|=JB),new jx(v,S,T)}i+=d-h}return r?t+i:new jx(t+i,0,null)}touches(t,e){let r=0,i=d2(e),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let u=this.ranges[l]-(this.inverted?r:0);if(u>t)break;let h=this.ranges[l+s],d=u+h;if(t<=d&&l==i*3)return!0;r+=this.ranges[l+o]-h}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],l=o-(this.inverted?s:0),u=o+(this.inverted?0:s),h=this.ranges[i+e],d=this.ranges[i+r];t(l,l+h,u,u+d),s+=d-h}}invert(){return new Kr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?Kr.empty:new Kr(t<0?[0,-t,0]:[0,0,t])}}Kr.empty=new Kr([]);class jp{constructor(t,e,r=0,i=t?t.length:0){this.mirror=e,this.from=r,this.to=i,this._maps=t||[],this.ownData=!(t||e)}get maps(){return this._maps}slice(t=0,e=this.maps.length){return new jp(this._maps,this.mirror,t,e)}appendMap(t,e){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),e!=null&&this.setMirror(this._maps.length-1,e)}appendMapping(t){for(let e=0,r=this._maps.length;e<t._maps.length;e++){let i=t.getMirror(e);this.appendMap(t._maps[e],i!=null&&i<e?r+i:void 0)}}getMirror(t){if(this.mirror){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,r=this._maps.length+t._maps.length;e>=0;e--){let i=t.getMirror(e);this.appendMap(t._maps[e].invert(),i!=null&&i>e?r-i-1:void 0)}}invert(){let t=new jp;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let r=this.from;r<this.to;r++)t=this._maps[r].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this._maps[s],l=o.mapResult(t,e);if(l.recover!=null){let u=this.getMirror(s);if(u!=null&&u>s&&u<this.to){s=u,t=this._maps[u].recover(l.recover);continue}}i|=l.delInfo,t=l.pos}return r?t:new jx(t,i,null)}}const JS=Object.create(null);class sr{getMap(){return Kr.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=JS[e.stepType];if(!r)throw new RangeError(`No step type ${e.stepType} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in JS)throw new RangeError("Duplicate use of step JSON ID "+t);return JS[t]=e,e.prototype.jsonID=t,e}}class bn{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new bn(t,null)}static fail(t){return new bn(null,t)}static fromReplace(t,e,r,i){try{return bn.ok(t.replace(e,r,i))}catch(s){if(s instanceof sv)return bn.fail(s.message);throw s}}}function dC(n,t,e){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(dC(s.content,t,s))),s.isInline&&(s=t(s,e,i)),r.push(s)}return ut.fromArray(r)}class Ja extends sr{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new vt(dC(e.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),e.openStart,e.openEnd);return bn.fromReplace(t,this.from,this.to,s)}invert(){return new Ji(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new Ja(e.pos,r.pos,this.mark)}merge(t){return t instanceof Ja&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Ja(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ja(e.from,e.to,t.markFromJSON(e.mark))}}sr.jsonID("addMark",Ja);class Ji extends sr{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new vt(dC(e.content,i=>i.mark(this.mark.removeFromSet(i.marks)),t),e.openStart,e.openEnd);return bn.fromReplace(t,this.from,this.to,r)}invert(){return new Ja(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new Ji(e.pos,r.pos,this.mark)}merge(t){return t instanceof Ji&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Ji(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ji(e.from,e.to,t.markFromJSON(e.mark))}}sr.jsonID("removeMark",Ji);class Za extends sr{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return bn.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return bn.fromReplace(t,this.pos,this.pos+1,new vt(ut.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let r=this.mark.addToSet(e.marks);if(r.length==e.marks.length){for(let i=0;i<e.marks.length;i++)if(!e.marks[i].isInSet(r))return new Za(this.pos,e.marks[i]);return new Za(this.pos,this.mark)}}return new Zc(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Za(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Za(e.pos,t.markFromJSON(e.mark))}}sr.jsonID("addNodeMark",Za);class Zc extends sr{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return bn.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return bn.fromReplace(t,this.pos,this.pos+1,new vt(ut.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return!e||!this.mark.isInSet(e.marks)?this:new Za(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Zc(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Zc(e.pos,t.markFromJSON(e.mark))}}sr.jsonID("removeNodeMark",Zc);class On extends sr{constructor(t,e,r,i=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=i}apply(t){return this.structure&&Bx(t,this.from,this.to)?bn.fail("Structure replace would overwrite content"):bn.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Kr([this.from,this.to-this.from,this.slice.size])}invert(t){return new On(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new On(e.pos,Math.max(e.pos,r.pos),this.slice,this.structure)}merge(t){if(!(t instanceof On)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let e=this.slice.size+t.slice.size==0?vt.empty:new vt(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new On(this.from,this.to+(t.to-t.from),e,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let e=this.slice.size+t.slice.size==0?vt.empty:new vt(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new On(t.from,this.to,e,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new On(e.from,e.to,vt.fromJSON(t,e.slice),!!e.structure)}}sr.jsonID("replace",On);class In extends sr{constructor(t,e,r,i,s,o,l=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=l}apply(t){if(this.structure&&(Bx(t,this.from,this.gapFrom)||Bx(t,this.gapTo,this.to)))return bn.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return bn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?bn.fromReplace(t,this.from,this.to,r):bn.fail("Content does not fit in gap")}getMap(){return new Kr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new In(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),i=this.from==this.gapFrom?e.pos:t.map(this.gapFrom,-1),s=this.to==this.gapTo?r.pos:t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||i<e.pos||s>r.pos?null:new In(e.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new In(e.from,e.to,e.gapFrom,e.gapTo,vt.fromJSON(t,e.slice),e.insert,!!e.structure)}}sr.jsonID("replaceAround",In);function Bx(n,t,e){let r=n.resolve(t),i=e-t,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function fet(n,t,e,r){let i=[],s=[],o,l;n.doc.nodesBetween(t,e,(u,h,d)=>{if(!u.isInline)return;let m=u.marks;if(!r.isInSet(m)&&d.type.allowsMarkType(r.type)){let g=Math.max(h,t),v=Math.min(h+u.nodeSize,e),T=r.addToSet(m);for(let S=0;S<m.length;S++)m[S].isInSet(T)||(o&&o.to==g&&o.mark.eq(m[S])?o.to=v:i.push(o=new Ji(g,v,m[S])));l&&l.to==g?l.to=v:s.push(l=new Ja(g,v,r))}}),i.forEach(u=>n.step(u)),s.forEach(u=>n.step(u))}function det(n,t,e,r){let i=[],s=0;n.doc.nodesBetween(t,e,(o,l)=>{if(!o.isInline)return;s++;let u=null;if(r instanceof jb){let h=o.marks,d;for(;d=r.isInSet(h);)(u||(u=[])).push(d),h=d.removeFromSet(h)}else r?r.isInSet(o.marks)&&(u=[r]):u=o.marks;if(u&&u.length){let h=Math.min(l+o.nodeSize,e);for(let d=0;d<u.length;d++){let m=u[d],g;for(let v=0;v<i.length;v++){let T=i[v];T.step==s-1&&m.eq(i[v].style)&&(g=T)}g?(g.to=h,g.step=s):i.push({style:m,from:Math.max(l,t),to:h,step:s})}}}),i.forEach(o=>n.step(new Ji(o.from,o.to,o.style)))}function pC(n,t,e,r=e.contentMatch,i=!0){let s=n.doc.nodeAt(t),o=[],l=t+1;for(let u=0;u<s.childCount;u++){let h=s.child(u),d=l+h.nodeSize,m=r.matchType(h.type);if(!m)o.push(new On(l,d,vt.empty));else{r=m;for(let g=0;g<h.marks.length;g++)e.allowsMarkType(h.marks[g].type)||n.step(new Ji(l,d,h.marks[g]));if(i&&h.isText&&e.whitespace!="pre"){let g,v=/\r?\n|\r/g,T;for(;g=v.exec(h.text);)T||(T=new vt(ut.from(e.schema.text(" ",e.allowedMarks(h.marks))),0,0)),o.push(new On(l+g.index,l+g.index+g[0].length,T))}}l=d}if(!r.validEnd){let u=r.fillBefore(ut.empty,!0);n.replace(l,l,new vt(u,0,0))}for(let u=o.length-1;u>=0;u--)n.step(o[u])}function pet(n,t,e){return(t==0||n.canReplace(t,n.childCount))&&(e==n.childCount||n.canReplace(0,e))}function of(n){let e=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth,i=0,s=0;;--r){let o=n.$from.node(r),l=n.$from.index(r)+i,u=n.$to.indexAfter(r)-s;if(r<n.depth&&o.canReplace(l,u,e))return r;if(r==0||o.type.spec.isolating||!pet(o,l,u))break;l&&(i=1),u<o.childCount&&(s=1)}return null}function met(n,t,e){let{$from:r,$to:i,depth:s}=t,o=r.before(s+1),l=i.after(s+1),u=o,h=l,d=ut.empty,m=0;for(let T=s,S=!1;T>e;T--)S||r.index(T)>0?(S=!0,d=ut.from(r.node(T).copy(d)),m++):u--;let g=ut.empty,v=0;for(let T=s,S=!1;T>e;T--)S||i.after(T+1)<i.end(T)?(S=!0,g=ut.from(i.node(T).copy(g)),v++):h++;n.step(new In(u,h,o,l,new vt(d.append(g),m,v),d.size-m,!0))}function mC(n,t,e=null,r=n){let i=get(n,t),s=i&&yet(r,t);return s?i.map(p2).concat({type:t,attrs:e}).concat(s.map(p2)):null}function p2(n){return{type:n,attrs:null}}function get(n,t){let{parent:e,startIndex:r,endIndex:i}=n,s=e.contentMatchAt(r).findWrapping(t);if(!s)return null;let o=s.length?s[0]:t;return e.canReplaceWith(r,i,o)?s:null}function yet(n,t){let{parent:e,startIndex:r,endIndex:i}=n,s=e.child(r),o=t.contentMatch.findWrapping(s.type);if(!o)return null;let u=(o.length?o[o.length-1]:t).contentMatch;for(let h=r;u&&h<i;h++)u=u.matchType(e.child(h).type);return!u||!u.validEnd?null:o}function vet(n,t,e){let r=ut.empty;for(let o=e.length-1;o>=0;o--){if(r.size){let l=e[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=ut.from(e[o].type.create(e[o].attrs,r))}let i=t.start,s=t.end;n.step(new In(i,s,i,s,new vt(r,0,0),e.length,!0))}function bet(n,t,e,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(t,e,(o,l)=>{let u=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(r,u)&&_et(n.doc,n.mapping.slice(s).map(l),r)){let h=null;if(r.schema.linebreakReplacement){let v=r.whitespace=="pre",T=!!r.contentMatch.matchType(r.schema.linebreakReplacement);v&&!T?h=!1:!v&&T&&(h=!0)}h===!1&&t4(n,o,l,s),pC(n,n.mapping.slice(s).map(l,1),r,void 0,h===null);let d=n.mapping.slice(s),m=d.map(l,1),g=d.map(l+o.nodeSize,1);return n.step(new In(m,g,m+1,g-1,new vt(ut.from(r.create(u,null,o.marks)),0,0),1,!0)),h===!0&&ZB(n,o,l,s),!1}})}function ZB(n,t,e,r){t.forEach((i,s)=>{if(i.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(i.text);){let u=n.mapping.slice(r).map(e+1+s+o.index);n.replaceWith(u,u+1,t.type.schema.linebreakReplacement.create())}}})}function t4(n,t,e,r){t.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(e+1+s);n.replaceWith(o,o+1,t.type.schema.text(`
`))}})}function _et(n,t,e){let r=n.resolve(t),i=r.index();return r.parent.canReplaceWith(i,i+1,e)}function Tet(n,t,e,r,i){let s=n.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");e||(e=s.type);let o=e.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(t,t+s.nodeSize,o);if(!e.validContent(s.content))throw new RangeError("Invalid content for node type "+e.name);n.step(new In(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new vt(ut.from(o),0,0),1,!0))}function jo(n,t,e=1,r){let i=n.resolve(t),s=i.depth-e,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let h=i.depth-1,d=e-2;h>s;h--,d--){let m=i.node(h),g=i.index(h);if(m.type.spec.isolating)return!1;let v=m.content.cutByIndex(g,m.childCount),T=r&&r[d+1];T&&(v=v.replaceChild(0,T.type.create(T.attrs)));let S=r&&r[d]||m;if(!m.canReplace(g+1,m.childCount)||!S.type.validContent(v))return!1}let l=i.indexAfter(s),u=r&&r[0];return i.node(s).canReplaceWith(l,l,u?u.type:i.node(s+1).type)}function wet(n,t,e=1,r){let i=n.doc.resolve(t),s=ut.empty,o=ut.empty;for(let l=i.depth,u=i.depth-e,h=e-1;l>u;l--,h--){s=ut.from(i.node(l).copy(s));let d=r&&r[h];o=ut.from(d?d.type.create(d.attrs,o):i.node(l).copy(o))}n.step(new On(t,t,new vt(s.append(o),e,e),!0))}function Il(n,t){let e=n.resolve(t),r=e.index();return e4(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(r,r+1)}function xet(n,t){t.content.size||n.type.compatibleContent(t.type);let e=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<t.childCount;i++){let s=t.child(i),o=s.type==r?n.type.schema.nodes.text:s.type;if(e=e.matchType(o),!e||!n.type.allowsMarks(s.marks))return!1}return e.validEnd}function e4(n,t){return!!(n&&t&&!n.isLeaf&&xet(n,t))}function Bb(n,t,e=-1){let r=n.resolve(t);for(let i=r.depth;;i--){let s,o,l=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):e>0?(s=r.node(i+1),l++,o=r.node(i).maybeChild(l)):(s=r.node(i).maybeChild(l-1),o=r.node(i+1)),s&&!s.isTextblock&&e4(s,o)&&r.node(i).canReplace(l,l+1))return t;if(i==0)break;t=e<0?r.before(i):r.after(i)}}function Eet(n,t,e){let r=null,{linebreakReplacement:i}=n.doc.type.schema,s=n.doc.resolve(t-e),o=s.node().type;if(i&&o.inlineContent){let d=o.whitespace=="pre",m=!!o.contentMatch.matchType(i);d&&!m?r=!1:!d&&m&&(r=!0)}let l=n.steps.length;if(r===!1){let d=n.doc.resolve(t+e);t4(n,d.node(),d.before(),l)}o.inlineContent&&pC(n,t+e-1,o,s.node().contentMatchAt(s.index()),r==null);let u=n.mapping.slice(l),h=u.map(t-e);if(n.step(new On(h,u.map(t+e,-1),vt.empty,!0)),r===!0){let d=n.doc.resolve(h);ZB(n,d.node(),d.before(),n.steps.length)}return n}function Cet(n,t,e){let r=n.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),e))return t;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,e))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,e))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function n4(n,t,e){let r=n.resolve(t);if(!e.content.size)return t;let i=e.content;for(let s=0;s<e.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(e.openStart==0&&e.size?2:1);s++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,u=r.index(o)+(l>0?1:0),h=r.node(o),d=!1;if(s==1)d=h.canReplace(u,u,i);else{let m=h.contentMatchAt(u).findWrapping(i.firstChild.type);d=m&&h.canReplaceWith(u,u,m[0])}if(d)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function Fb(n,t,e=t,r=vt.empty){if(t==e&&!r.size)return null;let i=n.resolve(t),s=n.resolve(e);return r4(i,s,r)?new On(t,e,r):new Aet(i,s,r).fit()}function r4(n,t,e){return!e.openStart&&!e.openEnd&&n.start()==t.start()&&n.parent.canReplace(n.index(),t.index(),e.content)}class Aet{constructor(t,e,r){this.$from=t,this.$to=e,this.unplaced=r,this.frontier=[],this.placed=ut.empty;for(let i=0;i<=t.depth;i++){let s=t.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(t.indexAfter(i))})}for(let i=t.depth;i>0;i--)this.placed=ut.from(t.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let h=this.findFittable();h?this.placeNodes(h):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(t<0?this.$to:r.doc.resolve(t));if(!i)return null;let s=this.placed,o=r.depth,l=i.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let u=new vt(s,o,l);return t>-1?new In(r.pos,t,this.$to.pos,this.$to.end(),u,e):u.size||r.pos!=this.$to.pos?new On(r.pos,i.pos,u):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<t;r++){let s=e.firstChild;if(e.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){t=r;break}e=s.content}for(let e=1;e<=2;e++)for(let r=e==1?t:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=ZS(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:u,match:h}=this.frontier[l],d,m=null;if(e==1&&(o?h.matchType(o.type)||(m=h.fillBefore(ut.from(o),!1)):s&&u.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:l,parent:s,inject:m};if(e==2&&o&&(d=h.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:s,wrap:d};if(s&&h.matchType(s.type))break}}}openMore(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=ZS(t,e);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new vt(t,e+1,Math.max(r,i.size+e>=t.size-r?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=ZS(t,e);if(i.childCount<=1&&e>0){let s=t.size-e<=e+i.size;this.unplaced=new vt(Fd(t,e-1,1),e-1,s?e-1:r)}else this.unplaced=new vt(Fd(t,e,1),e,r)}placeNodes({sliceDepth:t,frontierDepth:e,parent:r,inject:i,wrap:s}){for(;this.depth>e;)this.closeFrontierNode();if(s)for(let S=0;S<s.length;S++)this.openFrontierNode(s[S]);let o=this.unplaced,l=r?r.content:o.content,u=o.openStart-t,h=0,d=[],{match:m,type:g}=this.frontier[e];if(i){for(let S=0;S<i.childCount;S++)d.push(i.child(S));m=m.matchFragment(i)}let v=l.size+t-(o.content.size-o.openEnd);for(;h<l.childCount;){let S=l.child(h),w=m.matchType(S.type);if(!w)break;h++,(h>1||u==0||S.content.size)&&(m=w,d.push(i4(S.mark(g.allowedMarks(S.marks)),h==1?u:0,h==l.childCount?v:-1)))}let T=h==l.childCount;T||(v=-1),this.placed=Ud(this.placed,e,ut.from(d)),this.frontier[e].match=m,T&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let S=0,w=l;S<v;S++){let E=w.lastChild;this.frontier.push({type:E.type,match:E.contentMatchAt(E.childCount)}),w=E.content}this.unplaced=T?t==0?vt.empty:new vt(Fd(o.content,t-1,1),t-1,v<0?o.openEnd:t-1):new vt(Fd(o.content,t,h),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],e;if(!t.type.isTextblock||!tw(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:r,type:i}=this.frontier[e],s=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),o=tw(t,e,i,r,s);if(o){for(let l=e-1;l>=0;l--){let{match:u,type:h}=this.frontier[l],d=tw(t,l,h,u,!0);if(!d||d.childCount)continue t}return{depth:e,fit:o,move:s?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=Ud(this.placed,e.depth,e.fit)),t=e.move;for(let r=e.depth+1;r<=t.depth;r++){let i=t.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,t.index(r));this.openFrontierNode(i.type,i.attrs,s)}return t}openFrontierNode(t,e=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=Ud(this.placed,this.depth,ut.from(t.create(e,r))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(ut.empty,!0);e.childCount&&(this.placed=Ud(this.placed,this.frontier.length,e))}}function Fd(n,t,e){return t==0?n.cutByIndex(e,n.childCount):n.replaceChild(0,n.firstChild.copy(Fd(n.firstChild.content,t-1,e)))}function Ud(n,t,e){return t==0?n.append(e):n.replaceChild(n.childCount-1,n.lastChild.copy(Ud(n.lastChild.content,t-1,e)))}function ZS(n,t){for(let e=0;e<t;e++)n=n.firstChild.content;return n}function i4(n,t,e){if(t<=0)return n;let r=n.content;return t>1&&(r=r.replaceChild(0,i4(r.firstChild,t-1,r.childCount==1?e-1:0))),t>0&&(r=n.type.contentMatch.fillBefore(r).append(r),e<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(ut.empty,!0)))),n.copy(r)}function tw(n,t,e,r,i){let s=n.node(t),o=i?n.indexAfter(t):n.index(t);if(o==s.childCount&&!e.compatibleContent(s.type))return null;let l=r.fillBefore(s.content,!0,o);return l&&!ket(e,s.content,o)?l:null}function ket(n,t,e){for(let r=e;r<t.childCount;r++)if(!n.allowsMarks(t.child(r).marks))return!0;return!1}function Ret(n){return n.spec.defining||n.spec.definingForContent}function Met(n,t,e,r){if(!r.size)return n.deleteRange(t,e);let i=n.doc.resolve(t),s=n.doc.resolve(e);if(r4(i,s,r))return n.step(new On(t,e,r));let o=o4(i,s);o[o.length-1]==0&&o.pop();let l=-(i.depth+1);o.unshift(l);for(let g=i.depth,v=i.pos-1;g>0;g--,v--){let T=i.node(g).type.spec;if(T.defining||T.definingAsContext||T.isolating)break;o.indexOf(g)>-1?l=g:i.before(g)==v&&o.splice(1,0,-g)}let u=o.indexOf(l),h=[],d=r.openStart;for(let g=r.content,v=0;;v++){let T=g.firstChild;if(h.push(T),v==r.openStart)break;g=T.content}for(let g=d-1;g>=0;g--){let v=h[g],T=Ret(v.type);if(T&&!v.sameMarkup(i.node(Math.abs(l)-1)))d=g;else if(T||!v.type.isTextblock)break}for(let g=r.openStart;g>=0;g--){let v=(g+d+1)%(r.openStart+1),T=h[v];if(T)for(let S=0;S<o.length;S++){let w=o[(S+u)%o.length],E=!0;w<0&&(E=!1,w=-w);let R=i.node(w-1),P=i.index(w-1);if(R.canReplaceWith(P,P,T.type,T.marks))return n.replace(i.before(w),E?s.after(w):e,new vt(s4(r.content,0,r.openStart,v),v,r.openEnd))}}let m=n.steps.length;for(let g=o.length-1;g>=0&&(n.replace(t,e,r),!(n.steps.length>m));g--){let v=o[g];v<0||(t=i.before(v),e=s.after(v))}}function s4(n,t,e,r,i){if(t<e){let s=n.firstChild;n=n.replaceChild(0,s.copy(s4(s.content,t+1,e,r,s)))}if(t>r){let s=i.contentMatchAt(0),o=s.fillBefore(n).append(n);n=o.append(s.matchFragment(o).fillBefore(ut.empty,!0))}return n}function Det(n,t,e,r){if(!r.isInline&&t==e&&n.doc.resolve(t).parent.content.size){let i=Cet(n.doc,t,r.type);i!=null&&(t=e=i)}n.replaceRange(t,e,new vt(ut.from(r),0,0))}function Oet(n,t,e){let r=n.doc.resolve(t),i=n.doc.resolve(e),s=o4(r,i);for(let o=0;o<s.length;o++){let l=s[o],u=o==s.length-1;if(u&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),i.end(l));if(l>0&&(u||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return n.delete(r.before(l),i.after(l))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(t-r.start(o)==r.depth-o&&e>r.end(o)&&i.end(o)-e!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return n.delete(r.before(o),e);n.delete(t,e)}function o4(n,t){let e=[],r=Math.min(n.depth,t.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||t.end(i)>t.pos+(t.depth-i)||n.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(s==t.start(i)||i==n.depth&&i==t.depth&&n.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==s-1)&&e.push(i)}return e}class Ah extends sr{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return bn.fail("No node at attribute step's position");let r=Object.create(null);for(let s in e.attrs)r[s]=e.attrs[s];r[this.attr]=this.value;let i=e.type.create(r,null,e.marks);return bn.fromReplace(t,this.pos,this.pos+1,new vt(ut.from(i),0,e.isLeaf?0:1))}getMap(){return Kr.empty}invert(t){return new Ah(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Ah(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.pos!="number"||typeof e.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ah(e.pos,e.attr,e.value)}}sr.jsonID("attr",Ah);class Bp extends sr{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let i in t.attrs)e[i]=t.attrs[i];e[this.attr]=this.value;let r=t.type.create(e,t.content,t.marks);return bn.ok(r)}getMap(){return Kr.empty}invert(t){return new Bp(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Bp(e.attr,e.value)}}sr.jsonID("docAttr",Bp);let Vh=class extends Error{};Vh=function n(t){let e=Error.call(this,t);return e.__proto__=n.prototype,e};Vh.prototype=Object.create(Error.prototype);Vh.prototype.constructor=Vh;Vh.prototype.name="TransformError";class a4{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new jp}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new Vh(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}changedRange(){let t=1e9,e=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let i=this.mapping.maps[r];r&&(t=i.map(t,1),e=i.map(e,-1)),i.forEach((s,o,l,u)=>{t=Math.min(t,l),e=Math.max(e,u)})}return t==1e9?null:{from:t,to:e}}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,r=vt.empty){let i=Fb(this.doc,t,e,r);return i&&this.step(i),this}replaceWith(t,e,r){return this.replace(t,e,new vt(ut.from(r),0,0))}delete(t,e){return this.replace(t,e,vt.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,r){return Met(this,t,e,r),this}replaceRangeWith(t,e,r){return Det(this,t,e,r),this}deleteRange(t,e){return Oet(this,t,e),this}lift(t,e){return met(this,t,e),this}join(t,e=1){return Eet(this,t,e),this}wrap(t,e){return vet(this,t,e),this}setBlockType(t,e=t,r,i=null){return bet(this,t,e,r,i),this}setNodeMarkup(t,e,r=null,i){return Tet(this,t,e,r,i),this}setNodeAttribute(t,e,r){return this.step(new Ah(t,e,r)),this}setDocAttribute(t,e){return this.step(new Bp(t,e)),this}addNodeMark(t,e){return this.step(new Za(t,e)),this}removeNodeMark(t,e){let r=this.doc.nodeAt(t);if(!r)throw new RangeError("No node at position "+t);if(e instanceof Ee)e.isInSet(r.marks)&&this.step(new Zc(t,e));else{let i=r.marks,s,o=[];for(;s=e.isInSet(i);)o.push(new Zc(t,s)),i=s.removeFromSet(i);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(t,e=1,r){return wet(this,t,e,r),this}addMark(t,e,r){return fet(this,t,e,r),this}removeMark(t,e,r){return det(this,t,e,r),this}clearIncompatible(t,e,r){return pC(this,t,e,r),this}}const ew=Object.create(null);class Gt{constructor(t,e,r){this.$anchor=t,this.$head=e,this.ranges=r||[new Iet(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=vt.empty){let r=e.content.lastChild,i=null;for(let l=0;l<e.openEnd;l++)i=r,r=r.lastChild;let s=t.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:u,$to:h}=o[l],d=t.mapping.slice(s);t.replaceRange(d.map(u.pos),d.map(h.pos),l?vt.empty:e),l==0&&y2(t,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(t,e){let r=t.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:l}=i[s],u=t.mapping.slice(r),h=u.map(o.pos),d=u.map(l.pos);s?t.deleteRange(h,d):(t.replaceRangeWith(h,d,e),y2(t,r,e.isInline?-1:1))}}static findFrom(t,e,r=!1){let i=t.parent.inlineContent?new jt(t):oh(t.node(0),t.parent,t.pos,t.index(),e,r);if(i)return i;for(let s=t.depth-1;s>=0;s--){let o=e<0?oh(t.node(0),t.node(s),t.before(s+1),t.index(s),e,r):oh(t.node(0),t.node(s),t.after(s+1),t.index(s)+1,e,r);if(o)return o}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new Zr(t.node(0))}static atStart(t){return oh(t,t,0,0,1)||new Zr(t)}static atEnd(t){return oh(t,t,t.content.size,t.childCount,-1)||new Zr(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=ew[e.type];if(!r)throw new RangeError(`No selection type ${e.type} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in ew)throw new RangeError("Duplicate use of selection JSON ID "+t);return ew[t]=e,e.prototype.jsonID=t,e}getBookmark(){return jt.between(this.$anchor,this.$head).getBookmark()}}Gt.prototype.visible=!0;class Iet{constructor(t,e){this.$from=t,this.$to=e}}let m2=!1;function g2(n){!m2&&!n.parent.inlineContent&&(m2=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class jt extends Gt{constructor(t,e=t){g2(t),g2(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let r=t.resolve(e.map(this.head));if(!r.parent.inlineContent)return Gt.near(r);let i=t.resolve(e.map(this.anchor));return new jt(i.parent.inlineContent?i:r,r)}replace(t,e=vt.empty){if(super.replace(t,e),e==vt.empty){let r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}}eq(t){return t instanceof jt&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new Ub(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if(typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new jt(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,r=e){let i=t.resolve(e);return new this(i,r==e?i:t.resolve(r))}static between(t,e,r){let i=t.pos-e.pos;if((!r||i)&&(r=i>=0?1:-1),!e.parent.inlineContent){let s=Gt.findFrom(e,r,!0)||Gt.findFrom(e,-r,!0);if(s)e=s.$head;else return Gt.near(e,r)}return t.parent.inlineContent||(i==0?t=e:(t=(Gt.findFrom(t,-r,!0)||Gt.findFrom(t,r,!0)).$anchor,t.pos<e.pos!=i<0&&(t=e))),new jt(t,e)}}Gt.jsonID("text",jt);class Ub{constructor(t,e){this.anchor=t,this.head=e}map(t){return new Ub(t.map(this.anchor),t.map(this.head))}resolve(t){return jt.between(t.resolve(this.anchor),t.resolve(this.head))}}class Mt extends Gt{constructor(t){let e=t.nodeAfter,r=t.node(0).resolve(t.pos+e.nodeSize);super(t,r),this.node=e}map(t,e){let{deleted:r,pos:i}=e.mapResult(this.anchor),s=t.resolve(i);return r?Gt.near(s):new Mt(s)}content(){return new vt(ut.from(this.node),0,0)}eq(t){return t instanceof Mt&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new gC(this.anchor)}static fromJSON(t,e){if(typeof e.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Mt(t.resolve(e.anchor))}static create(t,e){return new Mt(t.resolve(e))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}Mt.prototype.visible=!1;Gt.jsonID("node",Mt);class gC{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:r}=t.mapResult(this.anchor);return e?new Ub(r,r):new gC(r)}resolve(t){let e=t.resolve(this.anchor),r=e.nodeAfter;return r&&Mt.isSelectable(r)?new Mt(e):Gt.near(e)}}class Zr extends Gt{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=vt.empty){if(e==vt.empty){t.delete(0,t.doc.content.size);let r=Gt.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new Zr(t)}map(t){return new Zr(t)}eq(t){return t instanceof Zr}getBookmark(){return Pet}}Gt.jsonID("all",Zr);const Pet={map(){return this},resolve(n){return new Zr(n)}};function oh(n,t,e,r,i,s=!1){if(t.inlineContent)return jt.create(n,e);for(let o=r-(i>0?0:1);i>0?o<t.childCount:o>=0;o+=i){let l=t.child(o);if(l.isAtom){if(!s&&Mt.isSelectable(l))return Mt.create(n,e-(i<0?l.nodeSize:0))}else{let u=oh(n,l,e+i,i<0?l.childCount:0,i,s);if(u)return u}e+=l.nodeSize*i}return null}function y2(n,t,e){let r=n.steps.length-1;if(r<t)return;let i=n.steps[r];if(!(i instanceof On||i instanceof In))return;let s=n.mapping.maps[r],o;s.forEach((l,u,h,d)=>{o==null&&(o=d)}),n.setSelection(Gt.near(n.doc.resolve(o),e))}const v2=1,yy=2,b2=4;class Net extends a4{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|v2)&~yy,this.storedMarks=null,this}get selectionSet(){return(this.updated&v2)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=yy,this}ensureMarks(t){return Ee.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&yy)>0}addStep(t,e){super.addStep(t,e),this.updated=this.updated&~yy,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let r=this.selection;return e&&(t=t.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Ee.none))),r.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,r){let i=this.doc.type.schema;if(e==null)return t?this.replaceSelectionWith(i.text(t),!0):this.deleteSelection();{if(r==null&&(r=e),!t)return this.deleteRange(e,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(e);s=r==e?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(e,r,i.text(t,s)),!this.selection.empty&&this.selection.to==e+t.length&&this.setSelection(Gt.near(this.selection.$to)),this}}setMeta(t,e){return this.meta[typeof t=="string"?t:t.key]=e,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=b2,this}get scrolledIntoView(){return(this.updated&b2)>0}}function _2(n,t){return!t||!n?n:n.bind(t)}class zd{constructor(t,e,r){this.name=t,this.init=_2(e.init,r),this.apply=_2(e.apply,r)}}const Let=[new zd("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new zd("selection",{init(n,t){return n.selection||Gt.atStart(t.doc)},apply(n){return n.selection}}),new zd("storedMarks",{init(n){return n.storedMarks||null},apply(n,t,e,r){return r.selection.$cursor?n.storedMarks:null}}),new zd("scrollToSelection",{init(){return 0},apply(n,t){return n.scrolledIntoView?t+1:t}})];class nw{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Let.slice(),e&&e.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new zd(r.key,r.spec.state,r))})}}class gh{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=e){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],r=this.applyInner(t),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let u=i?i[o].n:0,h=i?i[o].state:this,d=u<e.length&&l.spec.appendTransaction.call(l,u?e.slice(u):e,h,r);if(d&&r.filterTransaction(d,o)){if(d.setMeta("appendedTransaction",t),!i){i=[];for(let m=0;m<this.config.plugins.length;m++)i.push(m<o?{state:r,n:e.length}:{state:this,n:0})}e.push(d),r=r.applyInner(d),s=!0}i&&(i[o]={state:r,n:e.length})}}if(!s)return{state:r,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new gh(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];e[s.name]=s.apply(t,this[s.name],this,e)}return e}get tr(){return new Net(this)}static create(t){let e=new nw(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new gh(e);for(let i=0;i<e.fields.length;i++)r[e.fields[i].name]=e.fields[i].init(t,r);return r}reconfigure(t){let e=new nw(this.schema,t.plugins),r=e.fields,i=new gh(e);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(t,i)}return i}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(r=>r.toJSON())),t&&typeof t=="object")for(let r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=t[r],s=i.spec.state;s&&s.toJSON&&(e[r]=s.toJSON.call(i,this[i.key]))}return e}static fromJSON(t,e,r){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let i=new nw(t.schema,t.plugins),s=new gh(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=is.fromJSON(t.schema,e.doc);else if(o.name=="selection")s.selection=Gt.fromJSON(s.doc,e.selection);else if(o.name=="storedMarks")e.storedMarks&&(s.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(r)for(let l in r){let u=r[l],h=u.spec.state;if(u.key==o.name&&h&&h.fromJSON&&Object.prototype.hasOwnProperty.call(e,l)){s[o.name]=h.fromJSON.call(u,t,e[l],s);return}}s[o.name]=o.init(t,s)}}),s}}function l4(n,t,e){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(t):r=="handleDOMEvents"&&(i=l4(i,t,{})),e[r]=i}return e}class ze{constructor(t){this.spec=t,this.props={},t.props&&l4(t.props,this,this.props),this.key=t.key?t.key.key:c4("plugin")}getState(t){return t[this.key]}}const rw=Object.create(null);function c4(n){return n in rw?n+"$"+ ++rw[n]:(rw[n]=0,n+"$")}class Cn{constructor(t="key"){this.key=c4(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const yC=(n,t)=>n.selection.empty?!1:(t&&t(n.tr.deleteSelection().scrollIntoView()),!0);function u4(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("backward",n):e.parentOffset>0)?null:e}const h4=(n,t,e)=>{let r=u4(n,e);if(!r)return!1;let i=vC(r);if(!i){let o=r.blockRange(),l=o&&of(o);return l==null?!1:(t&&t(n.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(_4(n,i,t,-1))return!0;if(r.parent.content.size==0&&(jh(s,"end")||Mt.isSelectable(s)))for(let o=r.depth;;o--){let l=Fb(n.doc,r.before(o),r.after(o),vt.empty);if(l&&l.slice.size<l.to-l.from){if(t){let u=n.tr.step(l);u.setSelection(jh(s,"end")?Gt.findFrom(u.doc.resolve(u.mapping.map(i.pos,-1)),-1):Mt.create(u.doc,i.pos-s.nodeSize)),t(u.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return s.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},Vet=(n,t,e)=>{let r=u4(n,e);if(!r)return!1;let i=vC(r);return i?f4(n,i,t):!1},jet=(n,t,e)=>{let r=p4(n,e);if(!r)return!1;let i=bC(r);return i?f4(n,i,t):!1};function f4(n,t,e){let r=t.nodeBefore,i=r,s=t.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let d=i.lastChild;if(!d)return!1;i=d}let o=t.nodeAfter,l=o,u=t.pos+1;for(;!l.isTextblock;u++){if(l.type.spec.isolating)return!1;let d=l.firstChild;if(!d)return!1;l=d}let h=Fb(n.doc,s,u,vt.empty);if(!h||h.from!=s||h instanceof On&&h.slice.size>=u-s)return!1;if(e){let d=n.tr.step(h);d.setSelection(jt.create(d.doc,s)),e(d.scrollIntoView())}return!0}function jh(n,t,e=!1){for(let r=n;r;r=t=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(e&&r.childCount!=1)return!1}return!1}const d4=(n,t,e)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):r.parentOffset>0)return!1;s=vC(r)}let o=s&&s.nodeBefore;return!o||!Mt.isSelectable(o)?!1:(t&&t(n.tr.setSelection(Mt.create(n.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function vC(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}function p4(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("forward",n):e.parentOffset<e.parent.content.size)?null:e}const m4=(n,t,e)=>{let r=p4(n,e);if(!r)return!1;let i=bC(r);if(!i)return!1;let s=i.nodeAfter;if(_4(n,i,t,1))return!0;if(r.parent.content.size==0&&(jh(s,"start")||Mt.isSelectable(s))){let o=Fb(n.doc,r.before(),r.after(),vt.empty);if(o&&o.slice.size<o.to-o.from){if(t){let l=n.tr.step(o);l.setSelection(jh(s,"start")?Gt.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):Mt.create(l.doc,l.mapping.map(i.pos))),t(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},g4=(n,t,e)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;s=bC(r)}let o=s&&s.nodeAfter;return!o||!Mt.isSelectable(o)?!1:(t&&t(n.tr.setSelection(Mt.create(n.doc,s.pos)).scrollIntoView()),!0)};function bC(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const Bet=(n,t)=>{let e=n.selection,r=e instanceof Mt,i;if(r){if(e.node.isTextblock||!Il(n.doc,e.from))return!1;i=e.from}else if(i=Bb(n.doc,e.from,-1),i==null)return!1;if(t){let s=n.tr.join(i);r&&s.setSelection(Mt.create(s.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),t(s.scrollIntoView())}return!0},Fet=(n,t)=>{let e=n.selection,r;if(e instanceof Mt){if(e.node.isTextblock||!Il(n.doc,e.to))return!1;r=e.to}else if(r=Bb(n.doc,e.to,1),r==null)return!1;return t&&t(n.tr.join(r).scrollIntoView()),!0},Uet=(n,t)=>{let{$from:e,$to:r}=n.selection,i=e.blockRange(r),s=i&&of(i);return s==null?!1:(t&&t(n.tr.lift(i,s).scrollIntoView()),!0)},y4=(n,t)=>{let{$head:e,$anchor:r}=n.selection;return!e.parent.type.spec.code||!e.sameParent(r)?!1:(t&&t(n.tr.insertText(`
`).scrollIntoView()),!0)};function _C(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const zet=(n,t)=>{let{$head:e,$anchor:r}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(r))return!1;let i=e.node(-1),s=e.indexAfter(-1),o=_C(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(t){let l=e.after(),u=n.tr.replaceWith(l,l,o.createAndFill());u.setSelection(Gt.near(u.doc.resolve(l),1)),t(u.scrollIntoView())}return!0},v4=(n,t)=>{let e=n.selection,{$from:r,$to:i}=e;if(e instanceof Zr||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=_C(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=n.tr.insert(o,s.createAndFill());l.setSelection(jt.create(l.doc,o+1)),t(l.scrollIntoView())}return!0},b4=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let s=e.before();if(jo(n.doc,s))return t&&t(n.tr.split(s).scrollIntoView()),!0}let r=e.blockRange(),i=r&&of(r);return i==null?!1:(t&&t(n.tr.lift(r,i).scrollIntoView()),!0)};function Het(n){return(t,e)=>{let{$from:r,$to:i}=t.selection;if(t.selection instanceof Mt&&t.selection.node.isBlock)return!r.parentOffset||!jo(t.doc,r.pos)?!1:(e&&e(t.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let s=[],o,l,u=!1,h=!1;for(let v=r.depth;;v--)if(r.node(v).isBlock){u=r.end(v)==r.pos+(r.depth-v),h=r.start(v)==r.pos-(r.depth-v),l=_C(r.node(v-1).contentMatchAt(r.indexAfter(v-1))),s.unshift(u&&l?{type:l}:null),o=v;break}else{if(v==1)return!1;s.unshift(null)}let d=t.tr;(t.selection instanceof jt||t.selection instanceof Zr)&&d.deleteSelection();let m=d.mapping.map(r.pos),g=jo(d.doc,m,s.length,s);if(g||(s[0]=l?{type:l}:null,g=jo(d.doc,m,s.length,s)),!g)return!1;if(d.split(m,s.length,s),!u&&h&&r.node(o).type!=l){let v=d.mapping.map(r.before(o)),T=d.doc.resolve(v);l&&r.node(o-1).canReplaceWith(T.index(),T.index()+1,l)&&d.setNodeMarkup(d.mapping.map(r.before(o)),l)}return e&&e(d.scrollIntoView()),!0}}const $et=Het(),qet=(n,t)=>{let{$from:e,to:r}=n.selection,i,s=e.sharedDepth(r);return s==0?!1:(i=e.before(s),t&&t(n.tr.setSelection(Mt.create(n.doc,i))),!0)};function Get(n,t,e){let r=t.nodeBefore,i=t.nodeAfter,s=t.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&t.parent.canReplace(s-1,s)?(e&&e(n.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(s,s+1)||!(i.isTextblock||Il(n.doc,t.pos))?!1:(e&&e(n.tr.join(t.pos).scrollIntoView()),!0)}function _4(n,t,e,r){let i=t.nodeBefore,s=t.nodeAfter,o,l,u=i.type.spec.isolating||s.type.spec.isolating;if(!u&&Get(n,t,e))return!0;let h=!u&&t.parent.canReplace(t.index(),t.index()+1);if(h&&(o=(l=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&l.matchType(o[0]||s.type).validEnd){if(e){let v=t.pos+s.nodeSize,T=ut.empty;for(let E=o.length-1;E>=0;E--)T=ut.from(o[E].create(null,T));T=ut.from(i.copy(T));let S=n.tr.step(new In(t.pos-1,v,t.pos,v,new vt(T,1,0),o.length,!0)),w=S.doc.resolve(v+2*o.length);w.nodeAfter&&w.nodeAfter.type==i.type&&Il(S.doc,w.pos)&&S.join(w.pos),e(S.scrollIntoView())}return!0}let d=s.type.spec.isolating||r>0&&u?null:Gt.findFrom(t,1),m=d&&d.$from.blockRange(d.$to),g=m&&of(m);if(g!=null&&g>=t.depth)return e&&e(n.tr.lift(m,g).scrollIntoView()),!0;if(h&&jh(s,"start",!0)&&jh(i,"end")){let v=i,T=[];for(;T.push(v),!v.isTextblock;)v=v.lastChild;let S=s,w=1;for(;!S.isTextblock;S=S.firstChild)w++;if(v.canReplace(v.childCount,v.childCount,S.content)){if(e){let E=ut.empty;for(let P=T.length-1;P>=0;P--)E=ut.from(T[P].copy(E));let R=n.tr.step(new In(t.pos-T.length,t.pos+s.nodeSize,t.pos+w,t.pos+s.nodeSize-w,new vt(E,T.length,0),0,!0));e(R.scrollIntoView())}return!0}}return!1}function T4(n){return function(t,e){let r=t.selection,i=n<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(e&&e(t.tr.setSelection(jt.create(t.doc,n<0?i.start(s):i.end(s)))),!0):!1}}const Wet=T4(-1),Yet=T4(1);function Ket(n,t=null){return function(e,r){let{$from:i,$to:s}=e.selection,o=i.blockRange(s),l=o&&mC(o,n,t);return l?(r&&r(e.tr.wrap(o,l).scrollIntoView()),!0):!1}}function T2(n,t=null){return function(e,r){let i=!1;for(let s=0;s<e.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:l}}=e.selection.ranges[s];e.doc.nodesBetween(o,l,(u,h)=>{if(i)return!1;if(!(!u.isTextblock||u.hasMarkup(n,t)))if(u.type==n)i=!0;else{let d=e.doc.resolve(h),m=d.index();i=d.parent.canReplaceWith(m,m+1,n)}})}if(!i)return!1;if(r){let s=e.tr;for(let o=0;o<e.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:u}}=e.selection.ranges[o];s.setBlockType(l,u,n,t)}r(s.scrollIntoView())}return!0}}function TC(...n){return function(t,e,r){for(let i=0;i<n.length;i++)if(n[i](t,e,r))return!0;return!1}}TC(yC,h4,d4);TC(yC,m4,g4);TC(y4,v4,b4,$et);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Xet(n,t=null){return function(e,r){let{$from:i,$to:s}=e.selection,o=i.blockRange(s);if(!o)return!1;let l=r?e.tr:null;return Qet(l,o,n,t)?(r&&r(l.scrollIntoView()),!0):!1}}function Qet(n,t,e,r=null){let i=!1,s=t,o=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(e)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let u=o.resolve(t.start-2);s=new av(u,u,t.depth),t.endIndex<t.parent.childCount&&(t=new av(t.$from,o.resolve(t.$to.end(t.depth)),t.depth)),i=!0}let l=mC(s,e,r,t);return l?(n&&Jet(n,t,l,i,e),!0):!1}function Jet(n,t,e,r,i){let s=ut.empty;for(let d=e.length-1;d>=0;d--)s=ut.from(e[d].type.create(e[d].attrs,s));n.step(new In(t.start-(r?2:0),t.end,t.start,t.end,new vt(s,0,0),e.length,!0));let o=0;for(let d=0;d<e.length;d++)e[d].type==i&&(o=d+1);let l=e.length-o,u=t.start+e.length-(r?2:0),h=t.parent;for(let d=t.startIndex,m=t.endIndex,g=!0;d<m;d++,g=!1)!g&&jo(n.doc,u,l)&&(n.split(u,l),u+=2*l),u+=h.child(d).nodeSize;return n}function Zet(n){return function(t,e){let{$from:r,$to:i}=t.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==n);return s?e?r.node(s.depth-1).type==n?tnt(t,e,n,s):ent(t,e,s):!0:!1}}function tnt(n,t,e,r){let i=n.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new In(s-1,o,s,o,new vt(ut.from(e.create(null,r.parent.copy())),1,0),1,!0)),r=new av(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const l=of(r);if(l==null)return!1;i.lift(r,l);let u=i.doc.resolve(i.mapping.map(s,-1)-1);return Il(i.doc,u.pos)&&u.nodeBefore.type==u.nodeAfter.type&&i.join(u.pos),t(i.scrollIntoView()),!0}function ent(n,t,e){let r=n.tr,i=e.parent;for(let v=e.end,T=e.endIndex-1,S=e.startIndex;T>S;T--)v-=i.child(T).nodeSize,r.delete(v-1,v+1);let s=r.doc.resolve(e.start),o=s.nodeAfter;if(r.mapping.map(e.end)!=e.start+s.nodeAfter.nodeSize)return!1;let l=e.startIndex==0,u=e.endIndex==i.childCount,h=s.node(-1),d=s.index(-1);if(!h.canReplace(d+(l?0:1),d+1,o.content.append(u?ut.empty:ut.from(i))))return!1;let m=s.pos,g=m+o.nodeSize;return r.step(new In(m-(l?1:0),g+(u?1:0),m+1,g-1,new vt((l?ut.empty:ut.from(i.copy(ut.empty))).append(u?ut.empty:ut.from(i.copy(ut.empty))),l?0:1,u?0:1),l?0:1)),t(r.scrollIntoView()),!0}function nnt(n){return function(t,e){let{$from:r,$to:i}=t.selection,s=r.blockRange(i,h=>h.childCount>0&&h.firstChild.type==n);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,u=l.child(o-1);if(u.type!=n)return!1;if(e){let h=u.lastChild&&u.lastChild.type==l.type,d=ut.from(h?n.create():null),m=new vt(ut.from(n.create(null,ut.from(l.type.create(null,d)))),h?3:1,0),g=s.start,v=s.end;e(t.tr.step(new In(g-(h?3:1),v,g,v,m,1,!0)).scrollIntoView())}return!0}}const qn=function(n){for(var t=0;;t++)if(n=n.previousSibling,!n)return t},Bh=function(n){let t=n.assignedSlot||n.parentNode;return t&&t.nodeType==11?t.host:t};let Fx=null;const Eo=function(n,t,e){let r=Fx||(Fx=document.createRange());return r.setEnd(n,e??n.nodeValue.length),r.setStart(n,t||0),r},rnt=function(){Fx=null},tu=function(n,t,e,r){return e&&(S2(n,t,e,r,-1)||S2(n,t,e,r,1))},int=/^(img|br|input|textarea|hr)$/i;function S2(n,t,e,r,i){for(var s;;){if(n==e&&t==r)return!0;if(t==(i<0?0:Ti(n))){let o=n.parentNode;if(!o||o.nodeType!=1||_m(n)||int.test(n.nodeName)||n.contentEditable=="false")return!1;t=qn(n)+(i<0?0:1),n=o}else if(n.nodeType==1){let o=n.childNodes[t+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((s=o.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)t+=i;else return!1;else n=o,t=i<0?Ti(n):0}else return!1}}function Ti(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function snt(n,t){for(;;){if(n.nodeType==3&&t)return n;if(n.nodeType==1&&t>0){if(n.contentEditable=="false")return null;n=n.childNodes[t-1],t=Ti(n)}else if(n.parentNode&&!_m(n))t=qn(n),n=n.parentNode;else return null}}function ont(n,t){for(;;){if(n.nodeType==3&&t<n.nodeValue.length)return n;if(n.nodeType==1&&t<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[t],t=0}else if(n.parentNode&&!_m(n))t=qn(n)+1,n=n.parentNode;else return null}}function ant(n,t,e){for(let r=t==0,i=t==Ti(n);r||i;){if(n==e)return!0;let s=qn(n);if(n=n.parentNode,!n)return!1;r=r&&s==0,i=i&&s==Ti(n)}}function _m(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const zb=function(n){return n.focusNode&&tu(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function bc(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function lnt(n){let t=n.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function cnt(n,t,e){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(t,e);if(r)return{node:r.offsetNode,offset:Math.min(Ti(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(t,e);if(r)return{node:r.startContainer,offset:Math.min(Ti(r.startContainer),r.startOffset)}}}const Xs=typeof navigator<"u"?navigator:null,w2=typeof document<"u"?document:null,Pl=Xs&&Xs.userAgent||"",Ux=/Edge\/(\d+)/.exec(Pl),S4=/MSIE \d/.exec(Pl),zx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Pl),Pr=!!(S4||zx||Ux),al=S4?document.documentMode:zx?+zx[1]:Ux?+Ux[1]:0,Ei=!Pr&&/gecko\/(\d+)/i.test(Pl);Ei&&+(/Firefox\/(\d+)/.exec(Pl)||[0,0])[1];const Hx=!Pr&&/Chrome\/(\d+)/.exec(Pl),Yn=!!Hx,w4=Hx?+Hx[1]:0,ir=!Pr&&!!Xs&&/Apple Computer/.test(Xs.vendor),Fh=ir&&(/Mobile\/\w+/.test(Pl)||!!Xs&&Xs.maxTouchPoints>2),_i=Fh||(Xs?/Mac/.test(Xs.platform):!1),x4=Xs?/Win/.test(Xs.platform):!1,Oo=/Android \d/.test(Pl),Tm=!!w2&&"webkitFontSmoothing"in w2.documentElement.style,unt=Tm?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function hnt(n){let t=n.defaultView&&n.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function _o(n,t){return typeof n=="number"?n:n[t]}function fnt(n){let t=n.getBoundingClientRect(),e=t.width/n.offsetWidth||1,r=t.height/n.offsetHeight||1;return{left:t.left,right:t.left+n.clientWidth*e,top:t.top,bottom:t.top+n.clientHeight*r}}function x2(n,t,e){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,s=n.dom.ownerDocument;for(let o=e||n.dom;o;){if(o.nodeType!=1){o=Bh(o);continue}let l=o,u=l==s.body,h=u?hnt(s):fnt(l),d=0,m=0;if(t.top<h.top+_o(r,"top")?m=-(h.top-t.top+_o(i,"top")):t.bottom>h.bottom-_o(r,"bottom")&&(m=t.bottom-t.top>h.bottom-h.top?t.top+_o(i,"top")-h.top:t.bottom-h.bottom+_o(i,"bottom")),t.left<h.left+_o(r,"left")?d=-(h.left-t.left+_o(i,"left")):t.right>h.right-_o(r,"right")&&(d=t.right-h.right+_o(i,"right")),d||m)if(u)s.defaultView.scrollBy(d,m);else{let v=l.scrollLeft,T=l.scrollTop;m&&(l.scrollTop+=m),d&&(l.scrollLeft+=d);let S=l.scrollLeft-v,w=l.scrollTop-T;t={left:t.left-S,top:t.top-w,right:t.right-S,bottom:t.bottom-w}}let g=u?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(g))break;o=g=="absolute"?o.offsetParent:Bh(o)}}function dnt(n){let t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top),r,i;for(let s=(t.left+t.right)/2,o=e+1;o<Math.min(innerHeight,t.bottom);o+=5){let l=n.root.elementFromPoint(s,o);if(!l||l==n.dom||!n.dom.contains(l))continue;let u=l.getBoundingClientRect();if(u.top>=e-20){r=l,i=u.top;break}}return{refDOM:r,refTop:i,stack:E4(n.dom)}}function E4(n){let t=[],e=n.ownerDocument;for(let r=n;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=e);r=Bh(r));return t}function pnt({refDOM:n,refTop:t,stack:e}){let r=n?n.getBoundingClientRect().top:0;C4(e,r==0?0:r-t)}function C4(n,t){for(let e=0;e<n.length;e++){let{dom:r,top:i,left:s}=n[e];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=s&&(r.scrollLeft=s)}}let Ju=null;function mnt(n){if(n.setActive)return n.setActive();if(Ju)return n.focus(Ju);let t=E4(n);n.focus(Ju==null?{get preventScroll(){return Ju={preventScroll:!0},!0}}:void 0),Ju||(Ju=!1,C4(t,0))}function A4(n,t){let e,r=2e8,i,s=0,o=t.top,l=t.top,u,h;for(let d=n.firstChild,m=0;d;d=d.nextSibling,m++){let g;if(d.nodeType==1)g=d.getClientRects();else if(d.nodeType==3)g=Eo(d).getClientRects();else continue;for(let v=0;v<g.length;v++){let T=g[v];if(T.top<=o&&T.bottom>=l){o=Math.max(T.bottom,o),l=Math.min(T.top,l);let S=T.left>t.left?T.left-t.left:T.right<t.left?t.left-T.right:0;if(S<r){e=d,r=S,i=S&&e.nodeType==3?{left:T.right<t.left?T.right:T.left,top:t.top}:t,d.nodeType==1&&S&&(s=m+(t.left>=(T.left+T.right)/2?1:0));continue}}else T.top>t.top&&!u&&T.left<=t.left&&T.right>=t.left&&(u=d,h={left:Math.max(T.left,Math.min(T.right,t.left)),top:T.top});!e&&(t.left>=T.right&&t.top>=T.top||t.left>=T.left&&t.top>=T.bottom)&&(s=m+1)}}return!e&&u&&(e=u,i=h,r=0),e&&e.nodeType==3?gnt(e,i):!e||r&&e.nodeType==1?{node:n,offset:s}:A4(e,i)}function gnt(n,t){let e=n.nodeValue.length,r=document.createRange(),i;for(let s=0;s<e;s++){r.setEnd(n,s+1),r.setStart(n,s);let o=Ba(r,1);if(o.top!=o.bottom&&SC(t,o)){i={node:n,offset:s+(t.left>=(o.left+o.right)/2?1:0)};break}}return r.detach(),i||{node:n,offset:0}}function SC(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function ynt(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}function vnt(n,t,e){let{node:r,offset:i}=A4(t,e),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&e.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,i,s)}function bnt(n,t,e,r){let i=-1;for(let s=t,o=!1;s!=n.dom;){let l=n.docView.nearestDesc(s,!0),u;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((u=l.dom.getBoundingClientRect()).width||u.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!o&&u.left>r.left||u.top>r.top?i=l.posBefore:(!o&&u.right<r.left||u.bottom<r.top)&&(i=l.posAfter),o=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?r.top<(u.top+u.bottom)/2:r.left<(u.left+u.right)/2)?l.posBefore:l.posAfter;s=l.dom.parentNode}return i>-1?i:n.docView.posFromDOM(t,e,-1)}function k4(n,t,e){let r=n.childNodes.length;if(r&&e.top<e.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-e.top)/(e.bottom-e.top))-2)),s=i;;){let o=n.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let u=0;u<l.length;u++){let h=l[u];if(SC(t,h))return k4(o,t,h)}}if((s=(s+1)%r)==i)break}return n}function _nt(n,t){let e=n.dom.ownerDocument,r,i=0,s=cnt(e,t.left,t.top);s&&({node:r,offset:i}=s);let o=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top),l;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let h=n.dom.getBoundingClientRect();if(!SC(t,h)||(o=k4(n.dom,t,h),!o))return null}if(ir)for(let h=o;r&&h;h=Bh(h))h.draggable&&(r=void 0);if(o=ynt(o,t),r){if(Ei&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let d=r.childNodes[i],m;d.nodeName=="IMG"&&(m=d.getBoundingClientRect()).right<=t.left&&m.bottom>t.top&&i++}let h;Tm&&i&&r.nodeType==1&&(h=r.childNodes[i-1]).nodeType==1&&h.contentEditable=="false"&&h.getBoundingClientRect().top>=t.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&t.top>r.lastChild.getBoundingClientRect().bottom?l=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=bnt(n,r,i,t))}l==null&&(l=vnt(n,o,t));let u=n.docView.nearestDesc(o,!0);return{pos:l,inside:u?u.posAtStart-u.border:-1}}function E2(n){return n.top<n.bottom||n.left<n.right}function Ba(n,t){let e=n.getClientRects();if(e.length){let r=e[t<0?0:e.length-1];if(E2(r))return r}return Array.prototype.find.call(e,E2)||n.getBoundingClientRect()}const Tnt=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function R4(n,t,e){let{node:r,offset:i,atom:s}=n.docView.domFromPos(t,e<0?-1:1),o=Tm||Ei;if(r.nodeType==3)if(o&&(Tnt.test(r.nodeValue)||(e<0?!i:i==r.nodeValue.length))){let u=Ba(Eo(r,i,i),e);if(Ei&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let h=Ba(Eo(r,i-1,i-1),-1);if(h.top==u.top){let d=Ba(Eo(r,i,i+1),-1);if(d.top!=u.top)return Ad(d,d.left<h.left)}}return u}else{let u=i,h=i,d=e<0?1:-1;return e<0&&!i?(h++,d=-1):e>=0&&i==r.nodeValue.length?(u--,d=1):e<0?u--:h++,Ad(Ba(Eo(r,u,h),d),d<0)}if(!n.state.doc.resolve(t-(s||0)).parent.inlineContent){if(s==null&&i&&(e<0||i==Ti(r))){let u=r.childNodes[i-1];if(u.nodeType==1)return iw(u.getBoundingClientRect(),!1)}if(s==null&&i<Ti(r)){let u=r.childNodes[i];if(u.nodeType==1)return iw(u.getBoundingClientRect(),!0)}return iw(r.getBoundingClientRect(),e>=0)}if(s==null&&i&&(e<0||i==Ti(r))){let u=r.childNodes[i-1],h=u.nodeType==3?Eo(u,Ti(u)-(o?0:1)):u.nodeType==1&&(u.nodeName!="BR"||!u.nextSibling)?u:null;if(h)return Ad(Ba(h,1),!1)}if(s==null&&i<Ti(r)){let u=r.childNodes[i];for(;u.pmViewDesc&&u.pmViewDesc.ignoreForCoords;)u=u.nextSibling;let h=u?u.nodeType==3?Eo(u,0,o?0:1):u.nodeType==1?u:null:null;if(h)return Ad(Ba(h,-1),!0)}return Ad(Ba(r.nodeType==3?Eo(r):r,-e),e>=0)}function Ad(n,t){if(n.width==0)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function iw(n,t){if(n.height==0)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function M4(n,t,e){let r=n.state,i=n.root.activeElement;r!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{r!=t&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function Snt(n,t,e){let r=t.selection,i=e=="up"?r.$from:r.$to;return M4(n,t,()=>{let{node:s}=n.docView.domFromPos(i.pos,e=="up"?-1:1);for(;;){let l=n.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=R4(n,i.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let u;if(l.nodeType==1)u=l.getClientRects();else if(l.nodeType==3)u=Eo(l,0,l.nodeValue.length).getClientRects();else continue;for(let h=0;h<u.length;h++){let d=u[h];if(d.bottom>d.top+1&&(e=="up"?o.top-d.top>(d.bottom-o.top)*2:d.bottom-o.bottom>(o.bottom-d.top)*2))return!1}}return!0})}const wnt=/[\u0590-\u08ac]/;function xnt(n,t,e){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,l=n.domSelection();return l?!wnt.test(r.parent.textContent)||!l.modify?e=="left"||e=="backward"?s:o:M4(n,t,()=>{let{focusNode:u,focusOffset:h,anchorNode:d,anchorOffset:m}=n.domSelectionRange(),g=l.caretBidiLevel;l.modify("move",e,"character");let v=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:T,focusOffset:S}=n.domSelectionRange(),w=T&&!v.contains(T.nodeType==1?T:T.parentNode)||u==T&&h==S;try{l.collapse(d,m),u&&(u!=d||h!=m)&&l.extend&&l.extend(u,h)}catch{}return g!=null&&(l.caretBidiLevel=g),w}):r.pos==r.start()||r.pos==r.end()}let C2=null,A2=null,k2=!1;function Ent(n,t,e){return C2==t&&A2==e?k2:(C2=t,A2=e,k2=e=="up"||e=="down"?Snt(n,t,e):xnt(n,t,e))}const Ci=0,R2=1,Ac=2,Qs=3;class Sm{constructor(t,e,r,i){this.parent=t,this.children=e,this.dom=r,this.contentDOM=i,this.dirty=Ci,r.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,r){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,r=this.posAtStart;;e++){let i=this.children[e];if(i==t)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,r){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(r<0){let s,o;if(t==this.contentDOM)s=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(t==this.contentDOM)s=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(t==this.dom&&this.contentDOM)i=e>qn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(e==0)for(let s=t;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&e==t.childNodes.length)for(let s=t;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let r=!0,i=t;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!e||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(t.nodeType==1?t:t.parentNode):o==t))r=!1;else return s}}getDesc(t){let e=t.pmViewDesc;for(let r=e;r;r=r.parent)if(r==this)return e}posFromDOM(t,e,r){for(let i=t;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(t,e,r)}return-1}descAt(t){for(let e=0,r=0;e<this.children.length;e++){let i=this.children[e],s=r+i.size;if(r==t&&s!=r){for(;!i.border&&i.children.length;)for(let o=0;o<i.children.length;o++){let l=i.children[o];if(l.size){i=l;break}}return i}if(t<s)return i.descAt(t-r-i.border);r=s}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.size;if(l>t||o instanceof O4){i=t-s;break}s=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,e);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof D4&&s.side>=0;r--);if(e<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&e&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,e):{node:this.contentDOM,offset:s?qn(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,e):{node:this.contentDOM,offset:s?qn(s.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,r=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,l=0;;l++){let u=this.children[l],h=o+u.size;if(i==-1&&t<=h){let d=o+u.border;if(t>=d&&e<=h-u.border&&u.node&&u.contentDOM&&this.contentDOM.contains(u.contentDOM))return u.parseRange(t,e,d);t=o;for(let m=l;m>0;m--){let g=this.children[m-1];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(1)){i=qn(g.dom)+1;break}t-=g.size}i==-1&&(i=0)}if(i>-1&&(h>e||l==this.children.length-1)){e=h;for(let d=l+1;d<this.children.length;d++){let m=this.children[d];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(-1)){s=qn(m.dom);break}e+=m.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=h}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:s}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return e.size==0||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:r}=this.domFromPos(t,0);if(e.nodeType!=1||r==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[r]}setSelection(t,e,r,i=!1){let s=Math.min(t,e),o=Math.max(t,e);for(let v=0,T=0;v<this.children.length;v++){let S=this.children[v],w=T+S.size;if(s>T&&o<w)return S.setSelection(t-T-S.border,e-T-S.border,r,i);T=w}let l=this.domFromPos(t,t?-1:1),u=e==t?l:this.domFromPos(e,e?-1:1),h=r.root.getSelection(),d=r.domSelectionRange(),m=!1;if((Ei||ir)&&t==e){let{node:v,offset:T}=l;if(v.nodeType==3){if(m=!!(T&&v.nodeValue[T-1]==`
`),m&&T==v.nodeValue.length)for(let S=v,w;S;S=S.parentNode){if(w=S.nextSibling){w.nodeName=="BR"&&(l=u={node:w.parentNode,offset:qn(w)+1});break}let E=S.pmViewDesc;if(E&&E.node&&E.node.isBlock)break}}else{let S=v.childNodes[T-1];m=S&&(S.nodeName=="BR"||S.contentEditable=="false")}}if(Ei&&d.focusNode&&d.focusNode!=u.node&&d.focusNode.nodeType==1){let v=d.focusNode.childNodes[d.focusOffset];v&&v.contentEditable=="false"&&(i=!0)}if(!(i||m&&ir)&&tu(l.node,l.offset,d.anchorNode,d.anchorOffset)&&tu(u.node,u.offset,d.focusNode,d.focusOffset))return;let g=!1;if((h.extend||t==e)&&!(m&&Ei)){h.collapse(l.node,l.offset);try{t!=e&&h.extend(u.node,u.offset),g=!0}catch{}}if(!g){if(t>e){let T=l;l=u,u=T}let v=document.createRange();v.setEnd(u.node,u.offset),v.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(v)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?t<=o&&e>=r:t<o&&e>r){let l=r+s.border,u=o-s.border;if(t>=l&&e<=u){this.dirty=t==r||e==o?Ac:R2,t==l&&e==u&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Qs:s.markDirty(t-l,e-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Ac:Qs}r=o}this.dirty=Ac}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let r=t==1?Ac:R2;e.dirty<r&&(e.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}}class D4 extends Sm{constructor(t,e,r,i){let s,o=e.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!e.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(t,[],o,null),this.widget=e,this.widget=e,s=this}matchesWidget(t){return this.dirty==Ci&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return e?e(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class Cnt extends Sm{constructor(t,e,r,i){super(t,[],e,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class eu extends Sm{constructor(t,e,r,i,s){super(t,[],r,i),this.mark=e,this.spec=s}static create(t,e,r,i){let s=i.nodeViews[e.type.name],o=s&&s(e,i,r);return(!o||!o.dom)&&(o=lu.renderSpec(document,e.type.spec.toDOM(e,r),null,e.attrs)),new eu(t,e,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Qs||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=Qs&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),this.dirty!=Ci){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Ci}}slice(t,e,r){let i=eu.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;e<o&&(s=qx(s,e,o,r)),t>0&&(s=qx(s,0,t,r));for(let l=0;l<s.length;l++)s[l].parent=i;return i.children=s,i}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class ll extends Sm{constructor(t,e,r,i,s,o,l,u,h){super(t,[],s,o),this.node=e,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(t,e,r,i,s,o){let l=s.nodeViews[e.type.name],u,h=l&&l(e,s,()=>{if(!u)return o;if(u.parent)return u.parent.posBeforeChild(u)},r,i),d=h&&h.dom,m=h&&h.contentDOM;if(e.isText){if(!d)d=document.createTextNode(e.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:m}=lu.renderSpec(document,e.type.spec.toDOM(e),null,e.attrs));!m&&!e.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),e.type.spec.draggable&&(d.draggable=!0));let g=d;return d=N4(d,r,e),h?u=new Ant(t,e,r,i,d,m||null,g,h,s,o+1):e.isText?new Hb(t,e,r,i,d,g,s):new ll(t,e,r,i,d,m||null,g,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let e=this.children.length-1;e>=0;e--){let r=this.children[e];if(this.dom.contains(r.dom.parentNode)){t.contentElement=r.dom.parentNode;break}}t.contentElement||(t.getContent=()=>ut.empty)}return t}matchesNode(t,e,r){return this.dirty==Ci&&t.eq(this.node)&&cv(e,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let r=this.node.inlineContent,i=e,s=t.composing?this.localCompositionInfo(t,e):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,u=new Rnt(this,o&&o.node,t);Ont(this.node,this.innerDeco,(h,d,m)=>{h.spec.marks?u.syncToMarks(h.spec.marks,r,t,d):h.type.side>=0&&!m&&u.syncToMarks(d==this.node.childCount?Ee.none:this.node.child(d).marks,r,t,d),u.placeWidget(h,t,i)},(h,d,m,g)=>{u.syncToMarks(h.marks,r,t,g);let v;u.findNodeMatch(h,d,m,g)||l&&t.state.selection.from>i&&t.state.selection.to<i+h.nodeSize&&(v=u.findIndexWithChild(s.node))>-1&&u.updateNodeAt(h,d,m,v,t)||u.updateNextNode(h,d,m,t,g,i)||u.addNode(h,d,m,t,i),i+=h.nodeSize}),u.syncToMarks([],r,t,0),this.node.isTextblock&&u.addTextblockHacks(),u.destroyRest(),(u.changed||this.dirty==Ac)&&(o&&this.protectLocalComposition(t,o),I4(this.contentDOM,this.children,t),Fh&&Int(this.dom))}localCompositionInfo(t,e){let{from:r,to:i}=t.state.selection;if(!(t.state.selection instanceof jt)||r<e||i>e+this.node.content.size)return null;let s=t.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,l=Pnt(this.node.content,o,r-e,i-e);return l<0?null:{node:s,pos:l,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:r,text:i}){if(this.getDesc(e))return;let s=e;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new Cnt(this,s,e,i);t.input.compositionNodes.push(o),this.children=qx(this.children,r,r+i.length,t,o)}update(t,e,r,i){return this.dirty==Qs||!t.sameMarkup(this.node)?!1:(this.updateInner(t,e,r,i),!0)}updateInner(t,e,r,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Ci}updateOuterDeco(t){if(cv(t,this.outerDeco))return;let e=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=P4(this.dom,this.nodeDOM,$x(this.outerDeco,this.node,e),$x(t,this.node,e)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function M2(n,t,e,r,i){N4(r,t,n);let s=new ll(void 0,n,t,e,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class Hb extends ll{constructor(t,e,r,i,s,o,l){super(t,e,r,i,s,null,o,l,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,r,i){return this.dirty==Qs||this.dirty!=Ci&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(e),(this.dirty!=Ci||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=Ci,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,r){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,r)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,e,r){let i=this.node.cut(t,e),s=document.createTextNode(i.text);return new Hb(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(t==0||e==this.nodeDOM.nodeValue.length)&&(this.dirty=Qs)}get domAtom(){return!1}isText(t){return this.node.text==t}}class O4 extends Sm{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==Ci&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Ant extends ll{constructor(t,e,r,i,s,o,l,u,h,d){super(t,e,r,i,s,o,l,h,d),this.spec=u}update(t,e,r,i){if(this.dirty==Qs)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let s=this.spec.update(t,e,r);return s&&this.updateInner(t,e,r,i),s}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,e,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,r,i){this.spec.setSelection?this.spec.setSelection(t,e,r.root):super.setSelection(t,e,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function I4(n,t,e){let r=n.firstChild,i=!1;for(let s=0;s<t.length;s++){let o=t[s],l=o.dom;if(l.parentNode==n){for(;l!=r;)r=D2(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(l,r);if(o instanceof eu){let u=r?r.previousSibling:n.lastChild;I4(o.contentDOM,o.children,e),r=u?u.nextSibling:n.firstChild}}for(;r;)r=D2(r),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const op=function(n){n&&(this.nodeName=n)};op.prototype=Object.create(null);const kc=[new op];function $x(n,t,e){if(n.length==0)return kc;let r=e?kc[0]:new op,i=[r];for(let s=0;s<n.length;s++){let o=n[s].type.attrs;if(o){o.nodeName&&i.push(r=new op(o.nodeName));for(let l in o){let u=o[l];u!=null&&(e&&i.length==1&&i.push(r=new op(t.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+u:l=="style"?r.style=(r.style?r.style+";":"")+u:l!="nodeName"&&(r[l]=u))}}}return i}function P4(n,t,e,r){if(e==kc&&r==kc)return t;let i=t;for(let s=0;s<r.length;s++){let o=r[s],l=e[s];if(s){let u;l&&l.nodeName==o.nodeName&&i!=n&&(u=i.parentNode)&&u.nodeName.toLowerCase()==o.nodeName||(u=document.createElement(o.nodeName),u.pmIsDeco=!0,u.appendChild(i),l=kc[0]),i=u}knt(i,l||kc[0],o)}return i}function knt(n,t,e){for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&!(r in e)&&n.removeAttribute(r);for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&e[r]!=t[r]&&n.setAttribute(r,e[r]);if(t.class!=e.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&n.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&n.classList.add(i[s]);n.classList.length==0&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(t.style);)n.style.removeProperty(i[1])}e.style&&(n.style.cssText+=e.style)}}function N4(n,t,e){return P4(n,n,kc,$x(t,e,n.nodeType!=1))}function cv(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function D2(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class Rnt{constructor(t,e,r){this.lock=e,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=Mnt(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let r=t;r<e;r++)this.top.children[r].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,r,i){let s=0,o=this.stack.length>>1,l=Math.min(o,t.length);for(;s<l&&(s==o-1?this.top:this.stack[s+1<<1]).matchesMark(t[s])&&t[s].type.spec.spanning!==!1;)s++;for(;s<o;)this.destroyRest(),this.top.dirty=Ci,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);let u=-1,h=this.top.children.length;i<this.preMatch.index&&(h=Math.min(this.index+3,h));for(let d=this.index;d<h;d++){let m=this.top.children[d];if(m.matchesMark(t[o])&&!this.isLocked(m.dom)){u=d;break}}if(u>-1)u>this.index&&(this.changed=!0,this.destroyBetween(this.index,u)),this.top=this.top.children[this.index];else{let d=eu.create(this.top,t[o],e,r);this.top.children.splice(this.index,0,d),this.top=d,this.changed=!0}this.index=0,o++}}findNodeMatch(t,e,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(t,e,r))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,u=Math.min(this.top.children.length,l+5);l<u;l++){let h=this.top.children[l];if(h.matchesNode(t,e,r)&&!this.preMatch.matched.has(h)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(t,e,r,i,s){let o=this.top.children[i];return o.dirty==Qs&&o.dom==o.contentDOM&&(o.dirty=Ac),o.update(t,e,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let r=t.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}t=e}}updateNextNode(t,e,r,i,s,o){for(let l=this.index;l<this.top.children.length;l++){let u=this.top.children[l];if(u instanceof ll){let h=this.preMatch.matched.get(u);if(h!=null&&h!=s)return!1;let d=u.dom,m,g=this.isLocked(d)&&!(t.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==t.text&&u.dirty!=Qs&&cv(e,u.outerDeco));if(!g&&u.update(t,e,r,i))return this.destroyBetween(this.index,l),u.dom!=d&&(this.changed=!0),this.index++,!0;if(!g&&(m=this.recreateWrapper(u,t,e,r,i,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=m,m.contentDOM&&(m.dirty=Ac,m.updateChildren(i,o+1),m.dirty=Ci),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,e,r,i,s,o){if(t.dirty||e.isAtom||!t.children.length||!t.node.content.eq(e.content)||!cv(r,t.outerDeco)||!i.eq(t.innerDeco))return null;let l=ll.create(this.top,e,r,i,s,o);if(l.contentDOM){l.children=t.children,t.children=[];for(let u of l.children)u.parent=l}return t.destroy(),l}addNode(t,e,r,i,s){let o=ll.create(this.top,t,e,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(t,e,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(t)&&(t==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new D4(this.top,t,e,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof eu;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof Hb)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((ir||Yn)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let r=document.createElement(t);t=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),t=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new O4(this.top,[],r,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function Mnt(n,t){let e=t,r=e.children.length,i=n.childCount,s=new Map,o=[];t:for(;i>0;){let l;for(;;)if(r){let h=e.children[r-1];if(h instanceof eu)e=h,r=h.children.length;else{l=h,r--;break}}else{if(e==t)break t;r=e.parent.children.indexOf(e),e=e.parent}let u=l.node;if(u){if(u!=n.child(i-1))break;--i,s.set(l,i),o.push(l)}}return{index:i,matched:s,matches:o.reverse()}}function Dnt(n,t){return n.type.side-t.type.side}function Ont(n,t,e,r){let i=t.locals(n),s=0;if(i.length==0){for(let h=0;h<n.childCount;h++){let d=n.child(h);r(d,i,t.forChild(s,d),h),s+=d.nodeSize}return}let o=0,l=[],u=null;for(let h=0;;){let d,m;for(;o<i.length&&i[o].to==s;){let w=i[o++];w.widget&&(d?(m||(m=[d])).push(w):d=w)}if(d)if(m){m.sort(Dnt);for(let w=0;w<m.length;w++)e(m[w],h,!!u)}else e(d,h,!!u);let g,v;if(u)v=-1,g=u,u=null;else if(h<n.childCount)v=h,g=n.child(h++);else break;for(let w=0;w<l.length;w++)l[w].to<=s&&l.splice(w--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)l.push(i[o++]);let T=s+g.nodeSize;if(g.isText){let w=T;o<i.length&&i[o].from<w&&(w=i[o].from);for(let E=0;E<l.length;E++)l[E].to<w&&(w=l[E].to);w<T&&(u=g.cut(w-s),g=g.cut(0,w-s),T=w,v=-1)}else for(;o<i.length&&i[o].to<T;)o++;let S=g.isInline&&!g.isLeaf?l.filter(w=>!w.inline):l.slice();r(g,S,t.forChild(s,g),v),s=T}}function Int(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=t}}function Pnt(n,t,e,r){for(let i=0,s=0;i<n.childCount&&s<=r;){let o=n.child(i++),l=s;if(s+=o.nodeSize,!o.isText)continue;let u=o.text;for(;i<n.childCount;){let h=n.child(i++);if(s+=h.nodeSize,!h.isText)break;u+=h.text}if(s>=e){if(s>=r&&u.slice(r-t.length-l,r-l)==t)return r-t.length;let h=l<r?u.lastIndexOf(t,r-l-1):-1;if(h>=0&&h+t.length+l>=e)return l+h;if(e==r&&u.length>=r+t.length-l&&u.slice(r-l,r-l+t.length)==t)return r}}return-1}function qx(n,t,e,r,i){let s=[];for(let o=0,l=0;o<n.length;o++){let u=n[o],h=l,d=l+=u.size;h>=e||d<=t?s.push(u):(h<t&&s.push(u.slice(0,t-h,r)),i&&(s.push(i),i=void 0),d>e&&s.push(u.slice(e-h,u.size,r)))}return s}function wC(n,t=null){let e=n.domSelectionRange(),r=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),s=i&&i.size==0,o=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(o<0)return null;let l=r.resolve(o),u,h;if(zb(e)){for(u=o;i&&!i.node;)i=i.parent;let m=i.node;if(i&&m.isAtom&&Mt.isSelectable(m)&&i.parent&&!(m.isInline&&ant(e.focusNode,e.focusOffset,i.dom))){let g=i.posBefore;h=new Mt(o==g?l:r.resolve(g))}}else{if(e instanceof n.dom.ownerDocument.defaultView.Selection&&e.rangeCount>1){let m=o,g=o;for(let v=0;v<e.rangeCount;v++){let T=e.getRangeAt(v);m=Math.min(m,n.docView.posFromDOM(T.startContainer,T.startOffset,1)),g=Math.max(g,n.docView.posFromDOM(T.endContainer,T.endOffset,-1))}if(m<0)return null;[u,o]=g==n.state.selection.anchor?[g,m]:[m,g],l=r.resolve(o)}else u=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(u<0)return null}let d=r.resolve(u);if(!h){let m=t=="pointer"||n.state.selection.head<l.pos&&!s?1:-1;h=xC(n,d,l,m)}return h}function L4(n){return n.editable?n.hasFocus():j4(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Bo(n,t=!1){let e=n.state.selection;if(V4(n,e),!!L4(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Yn){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&tu(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)Lnt(n);else{let{anchor:r,head:i}=e,s,o;O2&&!(e instanceof jt)&&(e.$from.parent.inlineContent||(s=I2(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(o=I2(n,e.to))),n.docView.setSelection(r,i,n,t),O2&&(s&&P2(s),o&&P2(o)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&Nnt(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const O2=ir||Yn&&w4<63;function I2(n,t){let{node:e,offset:r}=n.docView.domFromPos(t,0),i=r<e.childNodes.length?e.childNodes[r]:null,s=r?e.childNodes[r-1]:null;if(ir&&i&&i.contentEditable=="false")return sw(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return sw(i);if(s)return sw(s)}}function sw(n){return n.contentEditable="true",ir&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function P2(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function Nnt(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelectionRange(),r=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=r||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!L4(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function Lnt(n){let t=n.domSelection();if(!t)return;let e=n.cursorWrapper.dom,r=e.nodeName=="IMG";r?t.collapse(e.parentNode,qn(e)+1):t.collapse(e,0),!r&&!n.state.selection.visible&&Pr&&al<=11&&(e.disabled=!0,e.disabled=!1)}function V4(n,t){if(t instanceof Mt){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(N2(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else N2(n)}function N2(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function xC(n,t,e,r){return n.someProp("createSelectionBetween",i=>i(n,t,e))||jt.between(t,e,r)}function L2(n){return n.editable&&!n.hasFocus()?!1:j4(n)}function j4(n){let t=n.domSelectionRange();if(!t.anchorNode)return!1;try{return n.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function Vnt(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelectionRange();return tu(t.node,t.offset,e.anchorNode,e.anchorOffset)}function Gx(n,t){let{$anchor:e,$head:r}=n.selection,i=t>0?e.max(r):e.min(r),s=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return s&&Gt.findFrom(s,t)}function Fa(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function V2(n,t,e){let r=n.state.selection;if(r instanceof jt)if(e.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=n.state.doc.resolve(i.pos+s.nodeSize*(t<0?-1:1));return Fa(n,new jt(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(t>0?"forward":"backward")){let i=Gx(n.state,t);return i&&i instanceof Mt?Fa(n,i):!1}else if(!(_i&&e.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let l=t<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=n.docView.descAt(l))&&!o.contentDOM?Mt.isSelectable(s)?Fa(n,new Mt(t<0?n.state.doc.resolve(i.pos-s.nodeSize):i)):Tm?Fa(n,new jt(n.state.doc.resolve(t<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof Mt&&r.node.isInline)return Fa(n,new jt(t>0?r.$to:r.$from));{let i=Gx(n.state,t);return i?Fa(n,i):!1}}}function uv(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ap(n,t){let e=n.pmViewDesc;return e&&e.size==0&&(t<0||n.nextSibling||n.nodeName!="BR")}function Zu(n,t){return t<0?jnt(n):Bnt(n)}function jnt(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i,s,o=!1;for(Ei&&e.nodeType==1&&r<uv(e)&&ap(e.childNodes[r],-1)&&(o=!0);;)if(r>0){if(e.nodeType!=1)break;{let l=e.childNodes[r-1];if(ap(l,-1))i=e,s=--r;else if(l.nodeType==3)e=l,r=e.nodeValue.length;else break}}else{if(B4(e))break;{let l=e.previousSibling;for(;l&&ap(l,-1);)i=e.parentNode,s=qn(l),l=l.previousSibling;if(l)e=l,r=uv(e);else{if(e=e.parentNode,e==n.dom)break;r=0}}}o?Wx(n,e,r):i&&Wx(n,i,s)}function Bnt(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i=uv(e),s,o;for(;;)if(r<i){if(e.nodeType!=1)break;let l=e.childNodes[r];if(ap(l,1))s=e,o=++r;else break}else{if(B4(e))break;{let l=e.nextSibling;for(;l&&ap(l,1);)s=l.parentNode,o=qn(l)+1,l=l.nextSibling;if(l)e=l,r=0,i=uv(e);else{if(e=e.parentNode,e==n.dom)break;r=i=0}}}s&&Wx(n,s,o)}function B4(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function Fnt(n,t){for(;n&&t==n.childNodes.length&&!_m(n);)t=qn(n)+1,n=n.parentNode;for(;n&&t<n.childNodes.length;){let e=n.childNodes[t];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;n=e,t=0}}function Unt(n,t){for(;n&&!t&&!_m(n);)t=qn(n),n=n.parentNode;for(;n&&t;){let e=n.childNodes[t-1];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;n=e,t=n.childNodes.length}}function Wx(n,t,e){if(t.nodeType!=3){let s,o;(o=Fnt(t,e))?(t=o,e=0):(s=Unt(t,e))&&(t=s,e=s.nodeValue.length)}let r=n.domSelection();if(!r)return;if(zb(r)){let s=document.createRange();s.setEnd(t,e),s.setStart(t,e),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(t,e);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Bo(n)},50)}function j2(n,t){let e=n.state.doc.resolve(t);if(!(Yn||x4)&&e.parent.inlineContent){let i=n.coordsAtPos(t);if(t>e.start()){let s=n.coordsAtPos(t-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(t<e.end()){let s=n.coordsAtPos(t+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function B2(n,t,e){let r=n.state.selection;if(r instanceof jt&&!r.empty||e.indexOf("s")>-1||_i&&e.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let o=Gx(n.state,t);if(o&&o instanceof Mt)return Fa(n,o)}if(!i.parent.inlineContent){let o=t<0?i:s,l=r instanceof Zr?Gt.near(o,t):Gt.findFrom(o,t);return l?Fa(n,l):!1}return!1}function F2(n,t){if(!(n.state.selection instanceof jt))return!0;let{$head:e,$anchor:r,empty:i}=n.state.selection;if(!e.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(s&&!s.isText){let o=n.state.tr;return t<0?o.delete(e.pos-s.nodeSize,e.pos):o.delete(e.pos,e.pos+s.nodeSize),n.dispatch(o),!0}return!1}function U2(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function znt(n){if(!ir||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelectionRange();if(t&&t.nodeType==1&&e==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let r=t.firstChild;U2(n,r,"true"),setTimeout(()=>U2(n,r,"false"),20)}return!1}function Hnt(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}function $nt(n,t){let e=t.keyCode,r=Hnt(t);if(e==8||_i&&e==72&&r=="c")return F2(n,-1)||Zu(n,-1);if(e==46&&!t.shiftKey||_i&&e==68&&r=="c")return F2(n,1)||Zu(n,1);if(e==13||e==27)return!0;if(e==37||_i&&e==66&&r=="c"){let i=e==37?j2(n,n.state.selection.from)=="ltr"?-1:1:-1;return V2(n,i,r)||Zu(n,i)}else if(e==39||_i&&e==70&&r=="c"){let i=e==39?j2(n,n.state.selection.from)=="ltr"?1:-1:1;return V2(n,i,r)||Zu(n,i)}else{if(e==38||_i&&e==80&&r=="c")return B2(n,-1,r)||Zu(n,-1);if(e==40||_i&&e==78&&r=="c")return znt(n)||B2(n,1,r)||Zu(n,1);if(r==(_i?"m":"c")&&(e==66||e==73||e==89||e==90))return!0}return!1}function EC(n,t){n.someProp("transformCopied",v=>{t=v(t,n)});let e=[],{content:r,openStart:i,openEnd:s}=t;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let v=r.firstChild;e.push(v.type.name,v.attrs!=v.type.defaultAttrs?v.attrs:null),r=v.content}let o=n.someProp("clipboardSerializer")||lu.fromSchema(n.state.schema),l=q4(),u=l.createElement("div");u.appendChild(o.serializeFragment(r,{document:l}));let h=u.firstChild,d,m=0;for(;h&&h.nodeType==1&&(d=$4[h.nodeName.toLowerCase()]);){for(let v=d.length-1;v>=0;v--){let T=l.createElement(d[v]);for(;u.firstChild;)T.appendChild(u.firstChild);u.appendChild(T),m++}h=u.firstChild}h&&h.nodeType==1&&h.setAttribute("data-pm-slice",`${i} ${s}${m?` -${m}`:""} ${JSON.stringify(e)}`);let g=n.someProp("clipboardTextSerializer",v=>v(t,n))||t.content.textBetween(0,t.content.size,`

`);return{dom:u,text:g,slice:t}}function F4(n,t,e,r,i){let s=i.parent.type.spec.code,o,l;if(!e&&!t)return null;let u=!!t&&(r||s||!e);if(u){if(n.someProp("transformPastedText",g=>{t=g(t,s||r,n)}),s)return l=new vt(ut.from(n.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),n.someProp("transformPasted",g=>{l=g(l,n,!0)}),l;let m=n.someProp("clipboardTextParser",g=>g(t,i,r,n));if(m)l=m;else{let g=i.marks(),{schema:v}=n.state,T=lu.fromSchema(v);o=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(S=>{let w=o.appendChild(document.createElement("p"));S&&w.appendChild(T.serializeNode(v.text(S,g)))})}}else n.someProp("transformPastedHTML",m=>{e=m(e,n)}),o=Ynt(e),Tm&&Knt(o);let h=o&&o.querySelector("[data-pm-slice]"),d=h&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(h.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let m=+d[3];m>0;m--){let g=o.firstChild;for(;g&&g.nodeType!=1;)g=g.nextSibling;if(!g)break;o=g}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||ol.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(u||d),context:i,ruleFromNode(g){return g.nodeName=="BR"&&!g.nextSibling&&g.parentNode&&!qnt.test(g.parentNode.nodeName)?{ignore:!0}:null}})),d)l=Xnt(z2(l,+d[1],+d[2]),d[4]);else if(l=vt.maxOpen(Gnt(l.content,i),!0),l.openStart||l.openEnd){let m=0,g=0;for(let v=l.content.firstChild;m<l.openStart&&!v.type.spec.isolating;m++,v=v.firstChild);for(let v=l.content.lastChild;g<l.openEnd&&!v.type.spec.isolating;g++,v=v.lastChild);l=z2(l,m,g)}return n.someProp("transformPasted",m=>{l=m(l,n,u)}),l}const qnt=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Gnt(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let i=t.node(e).contentMatchAt(t.index(e)),s,o=[];if(n.forEach(l=>{if(!o)return;let u=i.findWrapping(l.type),h;if(!u)return o=null;if(h=o.length&&s.length&&z4(u,s,l,o[o.length-1],0))o[o.length-1]=h;else{o.length&&(o[o.length-1]=H4(o[o.length-1],s.length));let d=U4(l,u);o.push(d),i=i.matchType(d.type),s=u}}),o)return ut.from(o)}return n}function U4(n,t,e=0){for(let r=t.length-1;r>=e;r--)n=t[r].create(null,ut.from(n));return n}function z4(n,t,e,r,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let s=z4(n,t,e,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?e.type:n[i+1]))return r.copy(r.content.append(ut.from(U4(e,n,i+1))))}}function H4(n,t){if(t==0)return n;let e=n.content.replaceChild(n.childCount-1,H4(n.lastChild,t-1)),r=n.contentMatchAt(n.childCount).fillBefore(ut.empty,!0);return n.copy(e.append(r))}function Yx(n,t,e,r,i,s){let o=t<0?n.firstChild:n.lastChild,l=o.content;return n.childCount>1&&(s=0),i<r-1&&(l=Yx(l,t,e,r,i+1,s)),i>=e&&(l=t<0?o.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(ut.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,o.copy(l))}function z2(n,t,e){return t<n.openStart&&(n=new vt(Yx(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new vt(Yx(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const $4={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let H2=null;function q4(){return H2||(H2=document.implementation.createHTMLDocument("title"))}let ow=null;function Wnt(n){let t=window.trustedTypes;return t?(ow||(ow=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e})),ow.createHTML(n)):n}function Ynt(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let e=q4().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&$4[r[1].toLowerCase()])&&(n=i.map(s=>"<"+s+">").join("")+n+i.map(s=>"</"+s+">").reverse().join("")),e.innerHTML=Wnt(n),i)for(let s=0;s<i.length;s++)e=e.querySelector(i[s])||e;return e}function Knt(n){let t=n.querySelectorAll(Yn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let r=t[e];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function Xnt(n,t){if(!n.size)return n;let e=n.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch{return n}let{content:i,openStart:s,openEnd:o}=n;for(let l=r.length-2;l>=0;l-=2){let u=e.nodes[r[l]];if(!u||u.hasRequiredAttrs())break;i=ut.from(u.create(r[l+1],i)),s++,o++}return new vt(i,s,o)}const br={},_r={},Qnt={touchstart:!0,touchmove:!0};class Jnt{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Znt(n){for(let t in br){let e=br[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>{ert(n,r)&&!CC(n,r)&&(n.editable||!(r.type in _r))&&e(n,r)},Qnt[t]?{passive:!0}:void 0)}ir&&n.dom.addEventListener("input",()=>null),Kx(n)}function tl(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function trt(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Kx(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>CC(n,r))})}function CC(n,t){return n.someProp("handleDOMEvents",e=>{let r=e[t.type];return r?r(n,t)||t.defaultPrevented:!1})}function ert(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||e.nodeType==11||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function nrt(n,t){!CC(n,t)&&br[t.type]&&(n.editable||!(t.type in _r))&&br[t.type](n,t)}_r.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=e.keyCode==16||e.shiftKey,!W4(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Oo&&Yn&&e.keyCode==13)))if(e.keyCode!=229&&n.domObserver.forceFlush(),Fh&&e.keyCode==13&&!e.ctrlKey&&!e.altKey&&!e.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,bc(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,e))||$nt(n,e)?e.preventDefault():tl(n,"key")};_r.keyup=(n,t)=>{t.keyCode==16&&(n.input.shiftKey=!1)};_r.keypress=(n,t)=>{let e=t;if(W4(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||_i&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e))){e.preventDefault();return}let r=n.state.selection;if(!(r instanceof jt)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(e.charCode),s=()=>n.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i,s))&&n.dispatch(s()),e.preventDefault()}};function $b(n){return{left:n.clientX,top:n.clientY}}function rrt(n,t){let e=t.x-n.clientX,r=t.y-n.clientY;return e*e+r*r<100}function AC(n,t,e,r,i){if(r==-1)return!1;let s=n.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(n.someProp(t,l=>o>s.depth?l(n,e,s.nodeAfter,s.before(o),i,!0):l(n,e,s.node(o),s.before(o),i,!1)))return!0;return!1}function kh(n,t,e){if(n.focused||n.focus(),n.state.selection.eq(t))return;let r=n.state.tr.setSelection(t);r.setMeta("pointer",!0),n.dispatch(r)}function irt(n,t){if(t==-1)return!1;let e=n.state.doc.resolve(t),r=e.nodeAfter;return r&&r.isAtom&&Mt.isSelectable(r)?(kh(n,new Mt(e)),!0):!1}function srt(n,t){if(t==-1)return!1;let e=n.state.selection,r,i;e instanceof Mt&&(r=e.node);let s=n.state.doc.resolve(t);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(Mt.isSelectable(l)){r&&e.$from.depth>0&&o>=e.$from.depth&&s.before(e.$from.depth+1)==e.$from.pos?i=s.before(e.$from.depth):i=s.before(o);break}}return i!=null?(kh(n,Mt.create(n.state.doc,i)),!0):!1}function ort(n,t,e,r,i){return AC(n,"handleClickOn",t,e,r)||n.someProp("handleClick",s=>s(n,t,r))||(i?srt(n,e):irt(n,e))}function art(n,t,e,r){return AC(n,"handleDoubleClickOn",t,e,r)||n.someProp("handleDoubleClick",i=>i(n,t,r))}function lrt(n,t,e,r){return AC(n,"handleTripleClickOn",t,e,r)||n.someProp("handleTripleClick",i=>i(n,t,r))||crt(n,e,r)}function crt(n,t,e){if(e.button!=0)return!1;let r=n.state.doc;if(t==-1)return r.inlineContent?(kh(n,jt.create(r,0,r.content.size)),!0):!1;let i=r.resolve(t);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(o.inlineContent)kh(n,jt.create(r,l+1,l+1+o.content.size));else if(Mt.isSelectable(o))kh(n,Mt.create(r,l));else continue;return!0}}function kC(n){return hv(n)}const G4=_i?"metaKey":"ctrlKey";br.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let r=kC(n),i=Date.now(),s="singleClick";i-n.input.lastClick.time<500&&rrt(e,n.input.lastClick)&&!e[G4]&&n.input.lastClick.button==e.button&&(n.input.lastClick.type=="singleClick"?s="doubleClick":n.input.lastClick.type=="doubleClick"&&(s="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:s,button:e.button};let o=n.posAtCoords($b(e));o&&(s=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new urt(n,o,e,!!r)):(s=="doubleClick"?art:lrt)(n,o.pos,o.inside,e)?e.preventDefault():tl(n,"pointer"))};class urt{constructor(t,e,r,i){this.view=t,this.pos=e,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!r[G4],this.allowDefault=r.shiftKey;let s,o;if(e.inside>-1)s=t.state.doc.nodeAt(e.inside),o=e.inside;else{let d=t.state.doc.resolve(e.pos);s=d.parent,o=d.depth?d.before():0}const l=i?null:r.target,u=l?t.docView.nearestDesc(l,!0):null;this.target=u&&u.nodeDOM.nodeType==1?u.nodeDOM:null;let{selection:h}=t.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||h instanceof Mt&&h.from<=o&&h.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ei&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),tl(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Bo(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords($b(t))),this.updateAllowDefault(t),this.allowDefault||!e?tl(this.view,"pointer"):ort(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||ir&&this.mightDrag&&!this.mightDrag.node.isAtom||Yn&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(kh(this.view,Gt.near(this.view.state.doc.resolve(e.pos))),t.preventDefault()):tl(this.view,"pointer")}move(t){this.updateAllowDefault(t),tl(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}br.touchstart=n=>{n.input.lastTouch=Date.now(),kC(n),tl(n,"pointer")};br.touchmove=n=>{n.input.lastTouch=Date.now(),tl(n,"pointer")};br.contextmenu=n=>kC(n);function W4(n,t){return n.composing?!0:ir&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const hrt=Oo?5e3:-1;_r.compositionstart=_r.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$to;if(t.selection instanceof jt&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||Yn&&x4&&frt(n)))n.markCursor=n.state.storedMarks||e.marks(),hv(n,!0),n.markCursor=null;else if(hv(n,!t.selection.empty),Ei&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){let l=n.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else i=o,s=-1}}n.input.composing=!0}Y4(n,hrt)};function frt(n){let{focusNode:t,focusOffset:e}=n.domSelectionRange();if(!t||t.nodeType!=1||e>=t.childNodes.length)return!1;let r=t.childNodes[e];return r.nodeType==1&&r.contentEditable=="false"}_r.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.badSafariComposition?n.domObserver.forceFlush():n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,Y4(n,20))};function Y4(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>hv(n),t))}function K4(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=prt());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function drt(n){let t=n.domSelectionRange();if(!t.focusNode)return null;let e=snt(t.focusNode,t.focusOffset),r=ont(t.focusNode,t.focusOffset);if(e&&r&&e!=r){let i=r.pmViewDesc,s=n.domObserver.lastChangedTextNode;if(e==s||r==s)return s;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=e.pmViewDesc;if(!(!o||!o.isText(e.nodeValue)))return r}}return e||r}function prt(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function hv(n,t=!1){if(!(Oo&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),K4(n),t||n.docView&&n.docView.dirty){let e=wC(n),r=n.state.selection;return e&&!e.eq(r)?n.dispatch(n.state.tr.setSelection(e)):(n.markCursor||t)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function mrt(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}const Fp=Pr&&al<15||Fh&&unt<604;br.copy=_r.cut=(n,t)=>{let e=t,r=n.state.selection,i=e.type=="cut";if(r.empty)return;let s=Fp?null:e.clipboardData,o=r.content(),{dom:l,text:u}=EC(n,o);s?(e.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",u)):mrt(n,l),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function grt(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function yrt(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),e?Up(n,r.value,null,i,t):Up(n,r.textContent,r.innerHTML,i,t)},50)}function Up(n,t,e,r,i){let s=F4(n,t,e,r,n.state.selection.$from);if(n.someProp("handlePaste",u=>u(n,i,s||vt.empty)))return!0;if(!s)return!1;let o=grt(s),l=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(s);return n.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function X4(n){let t=n.getData("text/plain")||n.getData("Text");if(t)return t;let e=n.getData("text/uri-list");return e?e.replace(/\r?\n/g," "):""}_r.paste=(n,t)=>{let e=t;if(n.composing&&!Oo)return;let r=Fp?null:e.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Up(n,X4(r),r.getData("text/html"),i,e)?e.preventDefault():yrt(n,e)};class Q4{constructor(t,e,r){this.slice=t,this.move=e,this.node=r}}const vrt=_i?"altKey":"ctrlKey";function J4(n,t){let e=n.someProp("dragCopies",r=>!r(t));return e??!t[vrt]}br.dragstart=(n,t)=>{let e=t,r=n.input.mouseDown;if(r&&r.done(),!e.dataTransfer)return;let i=n.state.selection,s=i.empty?null:n.posAtCoords($b(e)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof Mt?i.to-1:i.to))){if(r&&r.mightDrag)o=Mt.create(n.state.doc,r.mightDrag.pos);else if(e.target&&e.target.nodeType==1){let m=n.docView.nearestDesc(e.target,!0);m&&m.node.type.spec.draggable&&m!=n.docView&&(o=Mt.create(n.state.doc,m.posBefore))}}let l=(o||n.state.selection).content(),{dom:u,text:h,slice:d}=EC(n,l);(!e.dataTransfer.files.length||!Yn||w4>120)&&e.dataTransfer.clearData(),e.dataTransfer.setData(Fp?"Text":"text/html",u.innerHTML),e.dataTransfer.effectAllowed="copyMove",Fp||e.dataTransfer.setData("text/plain",h),n.dragging=new Q4(d,J4(n,e),o)};br.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)};_r.dragover=_r.dragenter=(n,t)=>t.preventDefault();_r.drop=(n,t)=>{try{brt(n,t,n.dragging)}finally{n.dragging=null}};function brt(n,t,e){if(!t.dataTransfer)return;let r=n.posAtCoords($b(t));if(!r)return;let i=n.state.doc.resolve(r.pos),s=e&&e.slice;s?n.someProp("transformPasted",v=>{s=v(s,n,!1)}):s=F4(n,X4(t.dataTransfer),Fp?null:t.dataTransfer.getData("text/html"),!1,i);let o=!!(e&&J4(n,t));if(n.someProp("handleDrop",v=>v(n,t,s||vt.empty,o))){t.preventDefault();return}if(!s)return;t.preventDefault();let l=s?n4(n.state.doc,i.pos,s):i.pos;l==null&&(l=i.pos);let u=n.state.tr;if(o){let{node:v}=e;v?v.replace(u):u.deleteSelection()}let h=u.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,m=u.doc;if(d?u.replaceRangeWith(h,h,s.content.firstChild):u.replaceRange(h,h,s),u.doc.eq(m))return;let g=u.doc.resolve(h);if(d&&Mt.isSelectable(s.content.firstChild)&&g.nodeAfter&&g.nodeAfter.sameMarkup(s.content.firstChild))u.setSelection(new Mt(g));else{let v=u.mapping.map(l);u.mapping.maps[u.mapping.maps.length-1].forEach((T,S,w,E)=>v=E),u.setSelection(xC(n,g,u.doc.resolve(v)))}n.focus(),n.dispatch(u.setMeta("uiEvent","drop"))}br.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Bo(n)},20))};br.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};br.beforeinput=(n,t)=>{if(Yn&&Oo&&t.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",s=>s(n,bc(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in _r)br[n]=_r[n];function zp(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class fv{constructor(t,e){this.toDOM=t,this.spec=e||jc,this.side=this.spec.side||0}map(t,e,r,i){let{pos:s,deleted:o}=t.mapResult(e.from+i,this.side<0?-1:1);return o?null:new vr(s-r,s-r,this)}valid(){return!0}eq(t){return this==t||t instanceof fv&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&zp(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class cl{constructor(t,e){this.attrs=t,this.spec=e||jc}map(t,e,r,i){let s=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-r,o=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new vr(s,o,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof cl&&zp(this.attrs,t.attrs)&&zp(this.spec,t.spec)}static is(t){return t.type instanceof cl}destroy(){}}class RC{constructor(t,e){this.attrs=t,this.spec=e||jc}map(t,e,r,i){let s=t.mapResult(e.from+i,1);if(s.deleted)return null;let o=t.mapResult(e.to+i,-1);return o.deleted||o.pos<=s.pos?null:new vr(s.pos-r,o.pos-r,this)}valid(t,e){let{index:r,offset:i}=t.content.findIndex(e.from),s;return i==e.from&&!(s=t.child(r)).isText&&i+s.nodeSize==e.to}eq(t){return this==t||t instanceof RC&&zp(this.attrs,t.attrs)&&zp(this.spec,t.spec)}destroy(){}}class vr{constructor(t,e,r){this.from=t,this.to=e,this.type=r}copy(t,e){return new vr(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,r){return this.type.map(t,this,e,r)}static widget(t,e,r){return new vr(t,t,new fv(e,r))}static inline(t,e,r,i){return new vr(t,e,new cl(r,i))}static node(t,e,r,i){return new vr(t,e,new RC(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof cl}get widget(){return this.type instanceof fv}}const ah=[],jc={};class Be{constructor(t,e){this.local=t.length?t:ah,this.children=e.length?e:ah}static create(t,e){return e.length?dv(e,t,0,jc):Zn}find(t,e,r){let i=[];return this.findInner(t??0,e??1e9,i,0,r),i}findInner(t,e,r,i,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=e&&l.to>=t&&(!s||s(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<e&&this.children[o+1]>t){let l=this.children[o]+1;this.children[o+2].findInner(t-l,e-l,r,i+l,s)}}map(t,e,r){return this==Zn||t.maps.length==0?this:this.mapInner(t,e,0,0,r||jc)}mapInner(t,e,r,i,s){let o;for(let l=0;l<this.local.length;l++){let u=this.local[l].map(t,r,i);u&&u.type.valid(e,u)?(o||(o=[])).push(u):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?_rt(this.children,o||[],t,e,r,i,s):o?new Be(o.sort(Bc),ah):Zn}add(t,e){return e.length?this==Zn?Be.create(t,e):this.addInner(t,e,0):this}addInner(t,e,r){let i,s=0;t.forEach((l,u)=>{let h=u+r,d;if(d=tF(e,l,h)){for(i||(i=this.children.slice());s<i.length&&i[s]<u;)s+=3;i[s]==u?i[s+2]=i[s+2].addInner(l,d,h+1):i.splice(s,0,u,u+l.nodeSize,dv(d,l,h+1,jc)),s+=3}});let o=Z4(s?eF(e):e,-r);for(let l=0;l<o.length;l++)o[l].type.valid(t,o[l])||o.splice(l--,1);return new Be(o.length?this.local.concat(o).sort(Bc):this.local,i||this.children)}remove(t){return t.length==0||this==Zn?this:this.removeInner(t,0)}removeInner(t,e){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,l=r[s]+e,u=r[s+1]+e;for(let d=0,m;d<t.length;d++)(m=t[d])&&m.from>l&&m.to<u&&(t[d]=null,(o||(o=[])).push(m));if(!o)continue;r==this.children&&(r=this.children.slice());let h=r[s+2].removeInner(o,l+1);h!=Zn?r[s+2]=h:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<t.length;s++)if(o=t[s])for(let l=0;l<i.length;l++)i[l].eq(o,e)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Be(i,r):Zn}forChild(t,e){if(this==Zn)return this;if(e.isLeaf)return Be.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=t){this.children[l]==t&&(r=this.children[l+2]);break}let s=t+1,o=s+e.content.size;for(let l=0;l<this.local.length;l++){let u=this.local[l];if(u.from<o&&u.to>s&&u.type instanceof cl){let h=Math.max(s,u.from)-s,d=Math.min(o,u.to)-s;h<d&&(i||(i=[])).push(u.copy(h,d))}}if(i){let l=new Be(i.sort(Bc),ah);return r?new Wa([l,r]):l}return r||Zn}eq(t){if(this==t)return!0;if(!(t instanceof Be)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return MC(this.localsInner(t))}localsInner(t){if(this==Zn)return ah;if(t.inlineContent||!this.local.some(cl.is))return this.local;let e=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof cl||e.push(this.local[r]);return e}forEachSet(t){t(this)}}Be.empty=new Be([],[]);Be.removeOverlap=MC;const Zn=Be.empty;class Wa{constructor(t){this.members=t}map(t,e){const r=this.members.map(i=>i.map(t,e,jc));return Wa.from(r)}forChild(t,e){if(e.isLeaf)return Be.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(t,e);s!=Zn&&(s instanceof Wa?r=r.concat(s.members):r.push(s))}return Wa.from(r)}eq(t){if(!(t instanceof Wa)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(t);if(s.length)if(!e)e=s;else{r&&(e=e.slice(),r=!1);for(let o=0;o<s.length;o++)e.push(s[o])}}return e?MC(r?e:e.sort(Bc)):ah}static from(t){switch(t.length){case 0:return Zn;case 1:return t[0];default:return new Wa(t.every(e=>e instanceof Be)?t:t.reduce((e,r)=>e.concat(r instanceof Be?r:r.members),[]))}}forEachSet(t){for(let e=0;e<this.members.length;e++)this.members[e].forEachSet(t)}}function _rt(n,t,e,r,i,s,o){let l=n.slice();for(let h=0,d=s;h<e.maps.length;h++){let m=0;e.maps[h].forEach((g,v,T,S)=>{let w=S-T-(v-g);for(let E=0;E<l.length;E+=3){let R=l[E+1];if(R<0||g>R+d-m)continue;let P=l[E]+d-m;v>=P?l[E+1]=g<=P?-2:-1:g>=d&&w&&(l[E]+=w,l[E+1]+=w)}m+=w}),d=e.maps[h].map(d,-1)}let u=!1;for(let h=0;h<l.length;h+=3)if(l[h+1]<0){if(l[h+1]==-2){u=!0,l[h+1]=-1;continue}let d=e.map(n[h]+s),m=d-i;if(m<0||m>=r.content.size){u=!0;continue}let g=e.map(n[h+1]+s,-1),v=g-i,{index:T,offset:S}=r.content.findIndex(m),w=r.maybeChild(T);if(w&&S==m&&S+w.nodeSize==v){let E=l[h+2].mapInner(e,w,d+1,n[h]+s+1,o);E!=Zn?(l[h]=m,l[h+1]=v,l[h+2]=E):(l[h+1]=-2,u=!0)}else u=!0}if(u){let h=Trt(l,n,t,e,i,s,o),d=dv(h,r,0,o);t=d.local;for(let m=0;m<l.length;m+=3)l[m+1]<0&&(l.splice(m,3),m-=3);for(let m=0,g=0;m<d.children.length;m+=3){let v=d.children[m];for(;g<l.length&&l[g]<v;)g+=3;l.splice(g,0,d.children[m],d.children[m+1],d.children[m+2])}}return new Be(t.sort(Bc),l)}function Z4(n,t){if(!t||!n.length)return n;let e=[];for(let r=0;r<n.length;r++){let i=n[r];e.push(new vr(i.from+t,i.to+t,i.type))}return e}function Trt(n,t,e,r,i,s,o){function l(u,h){for(let d=0;d<u.local.length;d++){let m=u.local[d].map(r,i,h);m?e.push(m):o.onRemove&&o.onRemove(u.local[d].spec)}for(let d=0;d<u.children.length;d+=3)l(u.children[d+2],u.children[d]+h+1)}for(let u=0;u<n.length;u+=3)n[u+1]==-1&&l(n[u+2],t[u]+s+1);return e}function tF(n,t,e){if(t.isLeaf)return null;let r=e+t.nodeSize,i=null;for(let s=0,o;s<n.length;s++)(o=n[s])&&o.from>e&&o.to<r&&((i||(i=[])).push(o),n[s]=null);return i}function eF(n){let t=[];for(let e=0;e<n.length;e++)n[e]!=null&&t.push(n[e]);return t}function dv(n,t,e,r){let i=[],s=!1;t.forEach((l,u)=>{let h=tF(n,l,u+e);if(h){s=!0;let d=dv(h,l,e+u+1,r);d!=Zn&&i.push(u,u+l.nodeSize,d)}});let o=Z4(s?eF(n):n,-e).sort(Bc);for(let l=0;l<o.length;l++)o[l].type.valid(t,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||i.length?new Be(o,i):Zn}function Bc(n,t){return n.from-t.from||n.to-t.to}function MC(n){let t=n;for(let e=0;e<t.length-1;e++){let r=t[e];if(r.from!=r.to)for(let i=e+1;i<t.length;i++){let s=t[i];if(s.from==r.from){s.to!=r.to&&(t==n&&(t=n.slice()),t[i]=s.copy(s.from,r.to),$2(t,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(t==n&&(t=n.slice()),t[e]=r.copy(r.from,s.from),$2(t,i,r.copy(s.from,r.to)));break}}}return t}function $2(n,t,e){for(;t<n.length&&Bc(e,n[t])>0;)t++;n.splice(t,0,e)}function aw(n){let t=[];return n.someProp("decorations",e=>{let r=e(n.state);r&&r!=Zn&&t.push(r)}),n.cursorWrapper&&t.push(Be.create(n.state.doc,[n.cursorWrapper.deco])),Wa.from(t)}const Srt={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},wrt=Pr&&al<=11;class xrt{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class Ert{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new xrt,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Pr&&al<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():ir&&t.composing&&r.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(t.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),wrt&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Srt)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(L2(this.view)){if(this.suppressingSelectionUpdates)return Bo(this.view);if(Pr&&al<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&tu(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e=new Set,r;for(let s=t.focusNode;s;s=Bh(s))e.add(s);for(let s=t.anchorNode;s;s=Bh(s))if(e.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.pendingRecords();e.length&&(this.queue=[]);let r=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&L2(t)&&!this.ignoreSelectionChange(r),s=-1,o=-1,l=!1,u=[];if(t.editable)for(let d=0;d<e.length;d++){let m=this.registerMutation(e[d],u);m&&(s=s<0?m.from:Math.min(m.from,s),o=o<0?m.to:Math.max(m.to,o),m.typeOver&&(l=!0))}if(u.some(d=>d.nodeName=="BR")&&(t.input.lastKeyCode==8||t.input.lastKeyCode==46)){for(let d of u)if(d.nodeName=="BR"&&d.parentNode){let m=d.nextSibling;m&&m.nodeType==1&&m.contentEditable=="false"&&d.parentNode.removeChild(d)}}else if(Ei&&u.length){let d=u.filter(m=>m.nodeName=="BR");if(d.length==2){let[m,g]=d;m.parentNode&&m.parentNode.parentNode==g.parentNode?g.remove():m.remove()}else{let{focusNode:m}=this.currentSelection;for(let g of d){let v=g.parentNode;v&&v.nodeName=="LI"&&(!m||krt(t,m)!=v)&&g.remove()}}}let h=null;s<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&zb(r)&&(h=wC(t))&&h.eq(Gt.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,Bo(t),this.currentSelection.set(r),t.scrollToSelection()):(s>-1||i)&&(s>-1&&(t.docView.markDirty(s,o),Crt(t)),t.input.badSafariComposition&&(t.input.badSafariComposition=!1,Rrt(t,u)),this.handleDOMChange(s,o,l,u),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||Bo(t),this.currentSelection.set(r))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let r=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(r==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if(t.type=="childList"){for(let d=0;d<t.addedNodes.length;d++){let m=t.addedNodes[d];e.push(m),m.nodeType==3&&(this.lastChangedTextNode=m)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};let i=t.previousSibling,s=t.nextSibling;if(Pr&&al<=11&&t.addedNodes.length)for(let d=0;d<t.addedNodes.length;d++){let{previousSibling:m,nextSibling:g}=t.addedNodes[d];(!m||Array.prototype.indexOf.call(t.addedNodes,m)<0)&&(i=m),(!g||Array.prototype.indexOf.call(t.addedNodes,g)<0)&&(s=g)}let o=i&&i.parentNode==t.target?qn(i)+1:0,l=r.localPosFromDOM(t.target,o,-1),u=s&&s.parentNode==t.target?qn(s):t.target.childNodes.length,h=r.localPosFromDOM(t.target,u,1);return{from:l,to:h}}else return t.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=t.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let q2=new WeakMap,G2=!1;function Crt(n){if(!q2.has(n)&&(q2.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Ei,G2)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),G2=!0}}function W2(n,t){let e=t.startContainer,r=t.startOffset,i=t.endContainer,s=t.endOffset,o=n.domAtPos(n.state.selection.anchor);return tu(o.node,o.offset,i,s)&&([e,r,i,s]=[i,s,e,r]),{anchorNode:e,anchorOffset:r,focusNode:i,focusOffset:s}}function Art(n,t){if(t.getComposedRanges){let i=t.getComposedRanges(n.root)[0];if(i)return W2(n,i)}let e;function r(i){i.preventDefault(),i.stopImmediatePropagation(),e=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),e?W2(n,e):null}function krt(n,t){for(let e=t.parentNode;e&&e!=n.dom;e=e.parentNode){let r=n.docView.nearestDesc(e,!0);if(r&&r.node.isBlock)return e}return null}function Rrt(n,t){var e;let{focusNode:r,focusOffset:i}=n.domSelectionRange();for(let s of t)if(((e=s.parentNode)===null||e===void 0?void 0:e.nodeName)=="TR"){let o=s.nextSibling;for(;o&&o.nodeName!="TD"&&o.nodeName!="TH";)o=o.nextSibling;if(o){let l=o;for(;;){let u=l.firstChild;if(!u||u.nodeType!=1||u.contentEditable=="false"||/^(BR|IMG)$/.test(u.nodeName))break;l=u}l.insertBefore(s,l.firstChild),r==s&&n.domSelection().collapse(s,i)}else s.parentNode.removeChild(s)}}function Mrt(n,t,e){let{node:r,fromOffset:i,toOffset:s,from:o,to:l}=n.docView.parseRange(t,e),u=n.domSelectionRange(),h,d=u.anchorNode;if(d&&n.dom.contains(d.nodeType==1?d:d.parentNode)&&(h=[{node:d,offset:u.anchorOffset}],zb(u)||h.push({node:u.focusNode,offset:u.focusOffset})),Yn&&n.input.lastKeyCode===8)for(let w=s;w>i;w--){let E=r.childNodes[w-1],R=E.pmViewDesc;if(E.nodeName=="BR"&&!R){s=w;break}if(!R||R.size)break}let m=n.state.doc,g=n.someProp("domParser")||ol.fromSchema(n.state.schema),v=m.resolve(o),T=null,S=g.parse(r,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:i,to:s,preserveWhitespace:v.parent.type.whitespace=="pre"?"full":!0,findPositions:h,ruleFromNode:Drt,context:v});if(h&&h[0].pos!=null){let w=h[0].pos,E=h[1]&&h[1].pos;E==null&&(E=w),T={anchor:w+o,head:E+o}}return{doc:S,sel:T,from:o,to:l}}function Drt(n){let t=n.pmViewDesc;if(t)return t.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(ir&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(n.parentNode.lastChild==n||ir&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Ort=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Irt(n,t,e,r,i){let s=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,t<0){let M=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,k=wC(n,M);if(k&&!n.state.selection.eq(k)){if(Yn&&Oo&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",B=>B(n,bc(13,"Enter"))))return;let O=n.state.tr.setSelection(k);M=="pointer"?O.setMeta("pointer",!0):M=="key"&&O.scrollIntoView(),s&&O.setMeta("composition",s),n.dispatch(O)}return}let o=n.state.doc.resolve(t),l=o.sharedDepth(e);t=o.before(l+1),e=n.state.doc.resolve(e).after(l+1);let u=n.state.selection,h=Mrt(n,t,e),d=n.state.doc,m=d.slice(h.from,h.to),g,v;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(g=n.state.selection.to,v="end"):(g=n.state.selection.from,v="start"),n.input.lastKeyCode=null;let T=Lrt(m.content,h.doc.content,h.from,g,v);if(T&&n.input.domChangeCount++,(Fh&&n.input.lastIOSEnter>Date.now()-225||Oo)&&i.some(M=>M.nodeType==1&&!Ort.test(M.nodeName))&&(!T||T.endA>=T.endB)&&n.someProp("handleKeyDown",M=>M(n,bc(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!T)if(r&&u instanceof jt&&!u.empty&&u.$head.sameParent(u.$anchor)&&!n.composing&&!(h.sel&&h.sel.anchor!=h.sel.head))T={start:u.from,endA:u.to,endB:u.to};else{if(h.sel){let M=Y2(n,n.state.doc,h.sel);if(M&&!M.eq(n.state.selection)){let k=n.state.tr.setSelection(M);s&&k.setMeta("composition",s),n.dispatch(k)}}return}n.state.selection.from<n.state.selection.to&&T.start==T.endB&&n.state.selection instanceof jt&&(T.start>n.state.selection.from&&T.start<=n.state.selection.from+2&&n.state.selection.from>=h.from?T.start=n.state.selection.from:T.endA<n.state.selection.to&&T.endA>=n.state.selection.to-2&&n.state.selection.to<=h.to&&(T.endB+=n.state.selection.to-T.endA,T.endA=n.state.selection.to)),Pr&&al<=11&&T.endB==T.start+1&&T.endA==T.start&&T.start>h.from&&h.doc.textBetween(T.start-h.from-1,T.start-h.from+1)==" "&&(T.start--,T.endA--,T.endB--);let S=h.doc.resolveNoCache(T.start-h.from),w=h.doc.resolveNoCache(T.endB-h.from),E=d.resolve(T.start),R=S.sameParent(w)&&S.parent.inlineContent&&E.end()>=T.endA;if((Fh&&n.input.lastIOSEnter>Date.now()-225&&(!R||i.some(M=>M.nodeName=="DIV"||M.nodeName=="P"))||!R&&S.pos<h.doc.content.size&&(!S.sameParent(w)||!S.parent.inlineContent)&&S.pos<w.pos&&!/\S/.test(h.doc.textBetween(S.pos,w.pos,"","")))&&n.someProp("handleKeyDown",M=>M(n,bc(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>T.start&&Nrt(d,T.start,T.endA,S,w)&&n.someProp("handleKeyDown",M=>M(n,bc(8,"Backspace")))){Oo&&Yn&&n.domObserver.suppressSelectionUpdates();return}Yn&&T.endB==T.start&&(n.input.lastChromeDelete=Date.now()),Oo&&!R&&S.start()!=w.start()&&w.parentOffset==0&&S.depth==w.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==T.endA&&(T.endB-=2,w=h.doc.resolveNoCache(T.endB-h.from),setTimeout(()=>{n.someProp("handleKeyDown",function(M){return M(n,bc(13,"Enter"))})},20));let P=T.start,j=T.endA,N=M=>{let k=M||n.state.tr.replace(P,j,h.doc.slice(T.start-h.from,T.endB-h.from));if(h.sel){let O=Y2(n,k.doc,h.sel);O&&!(Yn&&n.composing&&O.empty&&(T.start!=T.endB||n.input.lastChromeDelete<Date.now()-100)&&(O.head==P||O.head==k.mapping.map(j)-1)||Pr&&O.empty&&O.head==P)&&k.setSelection(O)}return s&&k.setMeta("composition",s),k.scrollIntoView()},W;if(R)if(S.pos==w.pos){Pr&&al<=11&&S.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Bo(n),20));let M=N(n.state.tr.delete(P,j)),k=d.resolve(T.start).marksAcross(d.resolve(T.endA));k&&M.ensureMarks(k),n.dispatch(M)}else if(T.endA==T.endB&&(W=Prt(S.parent.content.cut(S.parentOffset,w.parentOffset),E.parent.content.cut(E.parentOffset,T.endA-E.start())))){let M=N(n.state.tr);W.type=="add"?M.addMark(P,j,W.mark):M.removeMark(P,j,W.mark),n.dispatch(M)}else if(S.parent.child(S.index()).isText&&S.index()==w.index()-(w.textOffset?0:1)){let M=S.parent.textBetween(S.parentOffset,w.parentOffset),k=()=>N(n.state.tr.insertText(M,P,j));n.someProp("handleTextInput",O=>O(n,P,j,M,k))||n.dispatch(k())}else n.dispatch(N());else n.dispatch(N())}function Y2(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:xC(n,t.resolve(e.anchor),t.resolve(e.head))}function Prt(n,t){let e=n.firstChild.marks,r=t.firstChild.marks,i=e,s=r,o,l,u;for(let d=0;d<r.length;d++)i=r[d].removeFromSet(i);for(let d=0;d<e.length;d++)s=e[d].removeFromSet(s);if(i.length==1&&s.length==0)l=i[0],o="add",u=d=>d.mark(l.addToSet(d.marks));else if(i.length==0&&s.length==1)l=s[0],o="remove",u=d=>d.mark(l.removeFromSet(d.marks));else return null;let h=[];for(let d=0;d<t.childCount;d++)h.push(u(t.child(d)));if(ut.from(h).eq(n))return{mark:l,type:o}}function Nrt(n,t,e,r,i){if(e-t<=i.pos-r.pos||lw(r,!0,!1)<i.pos)return!1;let s=n.resolve(t);if(!r.parent.isTextblock){let l=s.nodeAfter;return l!=null&&e==t+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=n.resolve(lw(s,!0,!0));return!o.parent.isTextblock||o.pos>e||lw(o,!0,!1)<e?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function lw(n,t,e){let r=n.depth,i=t?n.end():n.pos;for(;r>0&&(t||n.indexAfter(r)==n.node(r).childCount);)r--,i++,t=!1;if(e){let s=n.node(r).maybeChild(n.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function Lrt(n,t,e,r,i){let s=n.findDiffStart(t,e);if(s==null)return null;let{a:o,b:l}=n.findDiffEnd(t,e+n.size,e+t.size);if(i=="end"){let u=Math.max(0,s-Math.min(o,l));r-=o+u-s}if(o<s&&n.size<t.size){let u=r<=s&&r>=o?s-r:0;s-=u,s&&s<t.size&&K2(t.textBetween(s-1,s+1))&&(s+=u?1:-1),l=s+(l-o),o=s}else if(l<s){let u=r<=s&&r>=l?s-r:0;s-=u,s&&s<n.size&&K2(n.textBetween(s-1,s+1))&&(s+=u?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function K2(n){if(n.length!=2)return!1;let t=n.charCodeAt(0),e=n.charCodeAt(1);return t>=56320&&t<=57343&&e>=55296&&e<=56319}class nF{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Jnt,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(tP),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=J2(this),Q2(this),this.nodeViews=Z2(this),this.docView=M2(this.state.doc,X2(this),aw(this),this.dom,this),this.domObserver=new Ert(this,(r,i,s,o)=>Irt(this,r,i,s,o)),this.domObserver.start(),Znt(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Kx(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(tP),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let r in this._props)e[r]=this._props[r];e.state=this.state;for(let r in t)e[r]=t[r];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){var r;let i=this.state,s=!1,o=!1;t.storedMarks&&this.composing&&(K4(this),o=!0),this.state=t;let l=i.plugins!=t.plugins||this._props.plugins!=e.plugins;if(l||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let v=Z2(this);jrt(v,this.nodeViews)&&(this.nodeViews=v,s=!0)}(l||e.handleDOMEvents!=this._props.handleDOMEvents)&&Kx(this),this.editable=J2(this),Q2(this);let u=aw(this),h=X2(this),d=i.plugins!=t.plugins&&!i.doc.eq(t.doc)?"reset":t.scrollToSelection>i.scrollToSelection?"to selection":"preserve",m=s||!this.docView.matchesNode(t.doc,h,u);(m||!t.selection.eq(i.selection))&&(o=!0);let g=d=="preserve"&&o&&this.dom.style.overflowAnchor==null&&dnt(this);if(o){this.domObserver.stop();let v=m&&(Pr||Yn)&&!this.composing&&!i.selection.empty&&!t.selection.empty&&Vrt(i.selection,t.selection);if(m){let T=Yn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=drt(this)),(s||!this.docView.update(t.doc,h,u,this))&&(this.docView.updateOuterDeco(h),this.docView.destroy(),this.docView=M2(t.doc,h,u,this.dom,this)),T&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Vnt(this))?Bo(this,v):(V4(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,i),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():g&&pnt(g)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",e=>e(this)))if(this.state.selection instanceof Mt){let e=this.docView.domAfterPos(this.state.selection.from);e.nodeType==1&&x2(this,e.getBoundingClientRect(),t)}else x2(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let r=this.directPlugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let r=this.state.plugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let e=0;e<this.pluginViews.length;e++){let r=this.pluginViews[e];r.update&&r.update(this,t)}}updateDraggedNode(t,e){let r=t.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let s=r.from+(this.state.doc.content.size-e.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(i=s)}this.dragging=new Q4(t.slice,t.move,i<0?void 0:Mt.create(this.state.doc,i))}someProp(t,e){let r=this._props&&this._props[t],i;if(r!=null&&(i=e?e(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[t];if(l!=null&&(i=e?e(l):l))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[t];if(l!=null&&(i=e?e(l):l))return i}}hasFocus(){if(Pr){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&mnt(this.dom),Bo(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let e=this.dom.parentNode;e;e=e.parentNode)if(e.nodeType==9||e.nodeType==11&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return t||document}updateRoot(){this._root=null}posAtCoords(t){return _nt(this,t)}coordsAtPos(t,e=1){return R4(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,r=-1){let i=this.docView.posFromDOM(t,e,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return Ent(this,e||this.state,t)}pasteHTML(t,e){return Up(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return Up(this,t,null,!0,e||new ClipboardEvent("paste"))}serializeForClipboard(t){return EC(this,t)}destroy(){this.docView&&(trt(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],aw(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,rnt())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return nrt(this,t)}domSelectionRange(){let t=this.domSelection();return t?ir&&this.root.nodeType===11&&lnt(this.dom.ownerDocument)==this.dom&&Art(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}nF.prototype.dispatch=function(n){let t=this._props.dispatchTransaction;t?t.call(this,n):this.updateState(this.state.apply(n))};function X2(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),n.someProp("attributes",e=>{if(typeof e=="function"&&(e=e(n.state)),e)for(let r in e)r=="class"?t.class+=" "+e[r]:r=="style"?t.style=(t.style?t.style+";":"")+e[r]:!t[r]&&r!="contenteditable"&&r!="nodeName"&&(t[r]=String(e[r]))}),t.translate||(t.translate="no"),[vr.node(0,n.state.doc.content.size,t)]}function Q2(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:vr.widget(n.state.selection.from,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function J2(n){return!n.someProp("editable",t=>t(n.state)===!1)}function Vrt(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}function Z2(n){let t=Object.create(null);function e(r){for(let i in r)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=r[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function jrt(n,t){let e=0,r=0;for(let i in n){if(n[i]!=t[i])return!0;e++}for(let i in t)r++;return e!=r}function tP(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var vl={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},pv={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Brt=typeof navigator<"u"&&/Mac/.test(navigator.platform),Frt=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Gn=0;Gn<10;Gn++)vl[48+Gn]=vl[96+Gn]=String(Gn);for(var Gn=1;Gn<=24;Gn++)vl[Gn+111]="F"+Gn;for(var Gn=65;Gn<=90;Gn++)vl[Gn]=String.fromCharCode(Gn+32),pv[Gn]=String.fromCharCode(Gn);for(var cw in vl)pv.hasOwnProperty(cw)||(pv[cw]=vl[cw]);function Urt(n){var t=Brt&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Frt&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",e=!t&&n.key||(n.shiftKey?pv:vl)[n.keyCode]||n.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}const zrt=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Hrt=typeof navigator<"u"&&/Win/.test(navigator.platform);function $rt(n){let t=n.split(/-(?!$)/),e=t[t.length-1];e=="Space"&&(e=" ");let r,i,s,o;for(let l=0;l<t.length-1;l++){let u=t[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))s=!0;else if(/^mod$/i.test(u))zrt?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+u)}return r&&(e="Alt-"+e),i&&(e="Ctrl-"+e),o&&(e="Meta-"+e),s&&(e="Shift-"+e),e}function qrt(n){let t=Object.create(null);for(let e in n)t[$rt(e)]=n[e];return t}function uw(n,t,e=!0){return t.altKey&&(n="Alt-"+n),t.ctrlKey&&(n="Ctrl-"+n),t.metaKey&&(n="Meta-"+n),e&&t.shiftKey&&(n="Shift-"+n),n}function Grt(n){return new ze({props:{handleKeyDown:rF(n)}})}function rF(n){let t=qrt(n);return function(e,r){let i=Urt(r),s,o=t[uw(i,r)];if(o&&o(e.state,e.dispatch,e))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=t[uw(i,r,!1)];if(l&&l(e.state,e.dispatch,e))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(Hrt&&r.ctrlKey&&r.altKey)&&(s=vl[r.keyCode])&&s!=i){let l=t[uw(s,r)];if(l&&l(e.state,e.dispatch,e))return!0}}return!1}}var Wrt=Object.defineProperty,DC=(n,t)=>{for(var e in t)Wrt(n,e,{get:t[e],enumerable:!0})};function qb(n){const{state:t,transaction:e}=n;let{selection:r}=e,{doc:i}=e,{storedMarks:s}=e;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=e.selection,i=e.doc,s=e.storedMarks,e}}}var Gb=class{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:t,state:e}=this,{view:r}=t,{tr:i}=e,s=this.buildProps(i);return Object.fromEntries(Object.entries(n).map(([o,l])=>[o,(...h)=>{const d=l(...h)(s);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,t=!0){const{rawCommands:e,editor:r,state:i}=this,{view:s}=r,o=[],l=!!n,u=n||i.tr,h=()=>(!l&&t&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(u),o.every(m=>m===!0)),d={...Object.fromEntries(Object.entries(e).map(([m,g])=>[m,(...T)=>{const S=this.buildProps(u,t),w=g(...T)(S);return o.push(w),d}])),run:h};return d}createCan(n){const{rawCommands:t,state:e}=this,r=!1,i=n||e.tr,s=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(t).map(([l,u])=>[l,(...h)=>u(...h)({...s,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(n,t=!0){const{rawCommands:e,editor:r,state:i}=this,{view:s}=r,o={tr:n,editor:r,view:s,state:qb({state:i,transaction:n}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(n,t),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(e).map(([l,u])=>[l,(...h)=>u(...h)(o)]))}};return o}},iF={};DC(iF,{blur:()=>Yrt,clearContent:()=>Krt,clearNodes:()=>Xrt,command:()=>Qrt,createParagraphNear:()=>Jrt,cut:()=>Zrt,deleteCurrentNode:()=>tit,deleteNode:()=>eit,deleteRange:()=>nit,deleteSelection:()=>rit,enter:()=>iit,exitCode:()=>sit,extendMarkRange:()=>oit,first:()=>ait,focus:()=>cit,forEach:()=>uit,insertContent:()=>hit,insertContentAt:()=>pit,joinBackward:()=>yit,joinDown:()=>git,joinForward:()=>vit,joinItemBackward:()=>bit,joinItemForward:()=>_it,joinTextblockBackward:()=>Tit,joinTextblockForward:()=>Sit,joinUp:()=>mit,keyboardShortcut:()=>xit,lift:()=>Eit,liftEmptyBlock:()=>Cit,liftListItem:()=>Ait,newlineInCode:()=>kit,resetAttributes:()=>Rit,scrollIntoView:()=>Mit,selectAll:()=>Dit,selectNodeBackward:()=>Oit,selectNodeForward:()=>Iit,selectParentNode:()=>Pit,selectTextblockEnd:()=>Nit,selectTextblockStart:()=>Lit,setContent:()=>Vit,setMark:()=>rst,setMeta:()=>ist,setNode:()=>sst,setNodeSelection:()=>ost,setTextDirection:()=>ast,setTextSelection:()=>lst,sinkListItem:()=>cst,splitBlock:()=>ust,splitListItem:()=>hst,toggleList:()=>fst,toggleMark:()=>dst,toggleNode:()=>pst,toggleWrap:()=>mst,undoInputRule:()=>gst,unsetAllMarks:()=>yst,unsetMark:()=>vst,unsetTextDirection:()=>bst,updateAttributes:()=>_st,wrapIn:()=>Tst,wrapInList:()=>Sst});var Yrt=()=>({editor:n,view:t})=>(requestAnimationFrame(()=>{var e;n.isDestroyed||(t.dom.blur(),(e=window?.getSelection())==null||e.removeAllRanges())}),!0),Krt=(n=!0)=>({commands:t})=>t.setContent("",{emitUpdate:n}),Xrt=()=>({state:n,tr:t,dispatch:e})=>{const{selection:r}=t,{ranges:i}=r;return e&&i.forEach(({$from:s,$to:o})=>{n.doc.nodesBetween(s.pos,o.pos,(l,u)=>{if(l.type.isText)return;const{doc:h,mapping:d}=t,m=h.resolve(d.map(u)),g=h.resolve(d.map(u+l.nodeSize)),v=m.blockRange(g);if(!v)return;const T=of(v);if(l.type.isTextblock){const{defaultType:S}=m.parent.contentMatchAt(m.index());t.setNodeMarkup(v.start,S)}(T||T===0)&&t.lift(v,T)})}),!0},Qrt=n=>t=>n(t),Jrt=()=>({state:n,dispatch:t})=>v4(n,t),Zrt=(n,t)=>({editor:e,tr:r})=>{const{state:i}=e,s=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(t);return r.insert(o,s.content),r.setSelection(new jt(r.doc.resolve(Math.max(o-1,0)))),!0},tit=()=>({tr:n,dispatch:t})=>{const{selection:e}=n,r=e.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===r.type){if(t){const l=i.before(s),u=i.after(s);n.delete(l,u).scrollIntoView()}return!0}return!1};function _n(n,t){if(typeof n=="string"){if(!t.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return t.nodes[n]}return n}var eit=n=>({tr:t,state:e,dispatch:r})=>{const i=_n(n,e.schema),s=t.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const u=s.before(o),h=s.after(o);t.delete(u,h).scrollIntoView()}return!0}return!1},nit=n=>({tr:t,dispatch:e})=>{const{from:r,to:i}=n;return e&&t.delete(r,i),!0},rit=()=>({state:n,dispatch:t})=>yC(n,t),iit=()=>({commands:n})=>n.keyboardShortcut("Enter"),sit=()=>({state:n,dispatch:t})=>zet(n,t);function OC(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function mv(n,t,e={strict:!0}){const r=Object.keys(t);return r.length?r.every(i=>e.strict?t[i]===n[i]:OC(t[i])?t[i].test(n[i]):t[i]===n[i]):!0}function sF(n,t,e={}){return n.find(r=>r.type===t&&mv(Object.fromEntries(Object.keys(e).map(i=>[i,r.attrs[i]])),e))}function eP(n,t,e={}){return!!sF(n,t,e)}function IC(n,t,e){var r;if(!n||!t)return;let i=n.parent.childAfter(n.parentOffset);if((!i.node||!i.node.marks.some(d=>d.type===t))&&(i=n.parent.childBefore(n.parentOffset)),!i.node||!i.node.marks.some(d=>d.type===t)||(e=e||((r=i.node.marks[0])==null?void 0:r.attrs),!sF([...i.node.marks],t,e)))return;let o=i.index,l=n.start()+i.offset,u=o+1,h=l+i.node.nodeSize;for(;o>0&&eP([...n.parent.child(o-1).marks],t,e);)o-=1,l-=n.parent.child(o).nodeSize;for(;u<n.parent.childCount&&eP([...n.parent.child(u).marks],t,e);)h+=n.parent.child(u).nodeSize,u+=1;return{from:l,to:h}}function Xo(n,t){if(typeof n=="string"){if(!t.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return t.marks[n]}return n}var oit=(n,t={})=>({tr:e,state:r,dispatch:i})=>{const s=Xo(n,r.schema),{doc:o,selection:l}=e,{$from:u,from:h,to:d}=l;if(i){const m=IC(u,s,t);if(m&&m.from<=h&&m.to>=d){const g=jt.create(o,m.from,m.to);e.setSelection(g)}}return!0},ait=n=>t=>{const e=typeof n=="function"?n(t):n;for(let r=0;r<e.length;r+=1)if(e[r](t))return!0;return!1};function oF(n){return n instanceof jt}function Rc(n=0,t=0,e=0){return Math.min(Math.max(n,t),e)}function aF(n,t=null){if(!t)return null;const e=Gt.atStart(n),r=Gt.atEnd(n);if(t==="start"||t===!0)return e;if(t==="end")return r;const i=e.from,s=r.to;return t==="all"?jt.create(n,Rc(0,i,s),Rc(n.content.size,i,s)):jt.create(n,Rc(t,i,s),Rc(t,i,s))}function nP(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function gv(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function lit(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var cit=(n=null,t={})=>({editor:e,view:r,tr:i,dispatch:s})=>{t={scrollIntoView:!0,...t};const o=()=>{(gv()||nP())&&r.dom.focus(),lit()&&!gv()&&!nP()&&r.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{e.isDestroyed||(r.focus(),t?.scrollIntoView&&e.commands.scrollIntoView())})};try{if(r.hasFocus()&&n===null||n===!1)return!0}catch{return!1}if(s&&n===null&&!oF(e.state.selection))return o(),!0;const l=aF(i.doc,n)||e.state.selection,u=e.state.selection.eq(l);return s&&(u||i.setSelection(l),u&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},uit=(n,t)=>e=>n.every((r,i)=>t(r,{...e,index:i})),hit=(n,t)=>({tr:e,commands:r})=>r.insertContentAt({from:e.selection.from,to:e.selection.to},n,t),lF=n=>{const t=n.childNodes;for(let e=t.length-1;e>=0;e-=1){const r=t[e];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&lF(r)}return n};function vy(n){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t=`<body>${n}</body>`,e=new window.DOMParser().parseFromString(t,"text/html").body;return lF(e)}function Hp(n,t,e){if(n instanceof is||n instanceof ut)return n;e={slice:!0,parseOptions:{},...e};const r=typeof n=="object"&&n!==null,i=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return ut.fromArray(n.map(l=>t.nodeFromJSON(l)));const o=t.nodeFromJSON(n);return e.errorOnInvalidContent&&o.check(),o}catch(s){if(e.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",s),Hp("",t,e)}if(i){if(e.errorOnInvalidContent){let o=!1,l="";const u=new qB({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:h=>(o=!0,l=typeof h=="string"?h:h.outerHTML,null)}]}})});if(e.slice?ol.fromSchema(u).parseSlice(vy(n),e.parseOptions):ol.fromSchema(u).parse(vy(n),e.parseOptions),e.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const s=ol.fromSchema(t);return e.slice?s.parseSlice(vy(n),e.parseOptions).content:s.parse(vy(n),e.parseOptions)}return Hp("",t,e)}function fit(n,t,e){const r=n.steps.length-1;if(r<t)return;const i=n.steps[r];if(!(i instanceof On||i instanceof In))return;const s=n.mapping.maps[r];let o=0;s.forEach((l,u,h,d)=>{o===0&&(o=d)}),n.setSelection(Gt.near(n.doc.resolve(o),e))}var dit=n=>!("type"in n),pit=(n,t,e)=>({tr:r,dispatch:i,editor:s})=>{var o;if(i){e={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...e};let l;const u=w=>{s.emit("contentError",{editor:s,error:w,disableCollaboration:()=>{"collaboration"in s.storage&&typeof s.storage.collaboration=="object"&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},h={preserveWhitespace:"full",...e.parseOptions};if(!e.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Hp(t,s.schema,{parseOptions:h,errorOnInvalidContent:!0})}catch(w){u(w)}try{l=Hp(t,s.schema,{parseOptions:h,errorOnInvalidContent:(o=e.errorOnInvalidContent)!=null?o:s.options.enableContentCheck})}catch(w){return u(w),!1}let{from:d,to:m}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},g=!0,v=!0;if((dit(l)?l:[l]).forEach(w=>{w.check(),g=g?w.isText&&w.marks.length===0:!1,v=v?w.isBlock:!1}),d===m&&v){const{parent:w}=r.doc.resolve(d);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(d-=1,m+=1)}let S;if(g){if(Array.isArray(t))S=t.map(w=>w.text||"").join("");else if(t instanceof ut){let w="";t.forEach(E=>{E.text&&(w+=E.text)}),S=w}else typeof t=="object"&&t&&t.text?S=t.text:S=t;r.insertText(S,d,m)}else{S=l;const w=r.doc.resolve(d),E=w.node(),R=w.parentOffset===0,P=E.isText||E.isTextblock,j=E.content.size>0;R&&P&&j&&(d=Math.max(0,d-1)),r.replaceWith(d,m,S)}e.updateSelection&&fit(r,r.steps.length-1,-1),e.applyInputRules&&r.setMeta("applyInputRules",{from:d,text:S}),e.applyPasteRules&&r.setMeta("applyPasteRules",{from:d,text:S})}return!0},mit=()=>({state:n,dispatch:t})=>Bet(n,t),git=()=>({state:n,dispatch:t})=>Fet(n,t),yit=()=>({state:n,dispatch:t})=>h4(n,t),vit=()=>({state:n,dispatch:t})=>m4(n,t),bit=()=>({state:n,dispatch:t,tr:e})=>{try{const r=Bb(n.doc,n.selection.$from.pos,-1);return r==null?!1:(e.join(r,2),t&&t(e),!0)}catch{return!1}},_it=()=>({state:n,dispatch:t,tr:e})=>{try{const r=Bb(n.doc,n.selection.$from.pos,1);return r==null?!1:(e.join(r,2),t&&t(e),!0)}catch{return!1}},Tit=()=>({state:n,dispatch:t})=>Vet(n,t),Sit=()=>({state:n,dispatch:t})=>jet(n,t);function cF(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function wit(n){const t=n.split(/-(?!$)/);let e=t[t.length-1];e==="Space"&&(e=" ");let r,i,s,o;for(let l=0;l<t.length-1;l+=1){const u=t[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))s=!0;else if(/^mod$/i.test(u))gv()||cF()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${u}`)}return r&&(e=`Alt-${e}`),i&&(e=`Ctrl-${e}`),o&&(e=`Meta-${e}`),s&&(e=`Shift-${e}`),e}var xit=n=>({editor:t,view:e,tr:r,dispatch:i})=>{const s=wit(n).split(/-(?!$)/),o=s.find(h=>!["Alt","Ctrl","Meta","Shift"].includes(h)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),u=t.captureTransaction(()=>{e.someProp("handleKeyDown",h=>h(e,l))});return u?.steps.forEach(h=>{const d=h.map(r.mapping);d&&i&&r.maybeStep(d)}),!0};function bl(n,t,e={}){const{from:r,to:i,empty:s}=n.selection,o=t?_n(t,n.schema):null,l=[];n.doc.nodesBetween(r,i,(m,g)=>{if(m.isText)return;const v=Math.max(r,g),T=Math.min(i,g+m.nodeSize);l.push({node:m,from:v,to:T})});const u=i-r,h=l.filter(m=>o?o.name===m.node.type.name:!0).filter(m=>mv(m.node.attrs,e,{strict:!1}));return s?!!h.length:h.reduce((m,g)=>m+g.to-g.from,0)>=u}var Eit=(n,t={})=>({state:e,dispatch:r})=>{const i=_n(n,e.schema);return bl(e,i,t)?Uet(e,r):!1},Cit=()=>({state:n,dispatch:t})=>b4(n,t),Ait=n=>({state:t,dispatch:e})=>{const r=_n(n,t.schema);return Zet(r)(t,e)},kit=()=>({state:n,dispatch:t})=>y4(n,t);function Wb(n,t){return t.nodes[n]?"node":t.marks[n]?"mark":null}function rP(n,t){const e=typeof t=="string"?[t]:t;return Object.keys(n).reduce((r,i)=>(e.includes(i)||(r[i]=n[i]),r),{})}var Rit=(n,t)=>({tr:e,state:r,dispatch:i})=>{let s=null,o=null;const l=Wb(typeof n=="string"?n:n.name,r.schema);if(!l)return!1;l==="node"&&(s=_n(n,r.schema)),l==="mark"&&(o=Xo(n,r.schema));let u=!1;return e.selection.ranges.forEach(h=>{r.doc.nodesBetween(h.$from.pos,h.$to.pos,(d,m)=>{s&&s===d.type&&(u=!0,i&&e.setNodeMarkup(m,void 0,rP(d.attrs,t))),o&&d.marks.length&&d.marks.forEach(g=>{o===g.type&&(u=!0,i&&e.addMark(m,m+d.nodeSize,o.create(rP(g.attrs,t))))})})}),u},Mit=()=>({tr:n,dispatch:t})=>(t&&n.scrollIntoView(),!0),Dit=()=>({tr:n,dispatch:t})=>{if(t){const e=new Zr(n.doc);n.setSelection(e)}return!0},Oit=()=>({state:n,dispatch:t})=>d4(n,t),Iit=()=>({state:n,dispatch:t})=>g4(n,t),Pit=()=>({state:n,dispatch:t})=>qet(n,t),Nit=()=>({state:n,dispatch:t})=>Yet(n,t),Lit=()=>({state:n,dispatch:t})=>Wet(n,t);function Xx(n,t,e={},r={}){return Hp(n,t,{slice:!1,parseOptions:e,errorOnInvalidContent:r.errorOnInvalidContent})}var Vit=(n,{errorOnInvalidContent:t,emitUpdate:e=!0,parseOptions:r={}}={})=>({editor:i,tr:s,dispatch:o,commands:l})=>{const{doc:u}=s;if(r.preserveWhitespace!=="full"){const h=Xx(n,i.schema,r,{errorOnInvalidContent:t??i.options.enableContentCheck});return o&&s.replaceWith(0,u.content.size,h).setMeta("preventUpdate",!e),!0}return o&&s.setMeta("preventUpdate",!e),l.insertContentAt({from:0,to:u.content.size},n,{parseOptions:r,errorOnInvalidContent:t??i.options.enableContentCheck})};function uF(n,t){const e=Xo(t,n.schema),{from:r,to:i,empty:s}=n.selection,o=[];s?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,u=>{o.push(...u.marks)});const l=o.find(u=>u.type.name===e.name);return l?{...l.attrs}:{}}function hF(n,t){const e=new a4(n);return t.forEach(r=>{r.steps.forEach(i=>{e.step(i)})}),e}function jit(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}function Bit(n,t,e){const r=[];return n.nodesBetween(t.from,t.to,(i,s)=>{e(i)&&r.push({node:i,pos:s})}),r}function Fit(n,t){for(let e=n.depth;e>0;e-=1){const r=n.node(e);if(t(r))return{pos:e>0?n.before(e):0,start:n.start(e),depth:e,node:r}}}function Yb(n){return t=>Fit(t.$from,n)}function Et(n,t,e){return n.config[t]===void 0&&n.parent?Et(n.parent,t,e):typeof n.config[t]=="function"?n.config[t].bind({...e,parent:n.parent?Et(n.parent,t,e):null}):n.config[t]}function PC(n){return n.map(t=>{const e={name:t.name,options:t.options,storage:t.storage},r=Et(t,"addExtensions",e);return r?[t,...PC(r())]:t}).flat(10)}function NC(n,t){const e=lu.fromSchema(t).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(e),i.innerHTML}function fF(n){return typeof n=="function"}function pe(n,t=void 0,...e){return fF(n)?t?n.bind(t)(...e):n(...e):n}function Uit(n={}){return Object.keys(n).length===0&&n.constructor===Object}function Uh(n){const t=n.filter(i=>i.type==="extension"),e=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:t,nodeExtensions:e,markExtensions:r}}function dF(n){const t=[],{nodeExtensions:e,markExtensions:r}=Uh(n),i=[...e,...r],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1},o=e.filter(h=>h.name!=="text").map(h=>h.name),l=r.map(h=>h.name),u=[...o,...l];return n.forEach(h=>{const d={name:h.name,options:h.options,storage:h.storage,extensions:i},m=Et(h,"addGlobalAttributes",d);if(!m)return;m().forEach(v=>{let T;Array.isArray(v.types)?T=v.types:v.types==="*"?T=u:v.types==="nodes"?T=o:v.types==="marks"?T=l:T=[],T.forEach(S=>{Object.entries(v.attributes).forEach(([w,E])=>{t.push({type:S,name:w,attribute:{...s,...E}})})})})}),i.forEach(h=>{const d={name:h.name,options:h.options,storage:h.storage},m=Et(h,"addAttributes",d);if(!m)return;const g=m();Object.entries(g).forEach(([v,T])=>{const S={...s,...T};typeof S?.default=="function"&&(S.default=S.default()),S?.isRequired&&S?.default===void 0&&delete S.default,t.push({type:h.name,name:v,attribute:S})})}),t}function Xe(...n){return n.filter(t=>!!t).reduce((t,e)=>{const r={...t};return Object.entries(e).forEach(([i,s])=>{if(!r[i]){r[i]=s;return}if(i==="class"){const l=s?String(s).split(" "):[],u=r[i]?r[i].split(" "):[],h=l.filter(d=>!u.includes(d));r[i]=[...u,...h].join(" ")}else if(i==="style"){const l=s?s.split(";").map(d=>d.trim()).filter(Boolean):[],u=r[i]?r[i].split(";").map(d=>d.trim()).filter(Boolean):[],h=new Map;u.forEach(d=>{const[m,g]=d.split(":").map(v=>v.trim());h.set(m,g)}),l.forEach(d=>{const[m,g]=d.split(":").map(v=>v.trim());h.set(m,g)}),r[i]=Array.from(h.entries()).map(([d,m])=>`${d}: ${m}`).join("; ")}else r[i]=s}),r},{})}function $p(n,t){return t.filter(e=>e.type===n.type.name).filter(e=>e.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(n.attrs)||{}:{[e.name]:n.attrs[e.name]}).reduce((e,r)=>Xe(e,r),{})}function zit(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function iP(n,t){return"style"in n?n:{...n,getAttrs:e=>{const r=n.getAttrs?n.getAttrs(e):n.attrs;if(r===!1)return!1;const i=t.reduce((s,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(e):zit(e.getAttribute(o.name));return l==null?s:{...s,[o.name]:l}},{});return{...r,...i}}}}function sP(n){return Object.fromEntries(Object.entries(n).filter(([t,e])=>t==="attrs"&&Uit(e)?!1:e!=null))}function oP(n){var t,e;const r={};return!((t=n?.attribute)!=null&&t.isRequired)&&"default"in(n?.attribute||{})&&(r.default=n.attribute.default),((e=n?.attribute)==null?void 0:e.validate)!==void 0&&(r.validate=n.attribute.validate),[n.name,r]}function Hit(n,t){var e;const r=dF(n),{nodeExtensions:i,markExtensions:s}=Uh(n),o=(e=i.find(h=>Et(h,"topNode")))==null?void 0:e.name,l=Object.fromEntries(i.map(h=>{const d=r.filter(E=>E.type===h.name),m={name:h.name,options:h.options,storage:h.storage,editor:t},g=n.reduce((E,R)=>{const P=Et(R,"extendNodeSchema",m);return{...E,...P?P(h):{}}},{}),v=sP({...g,content:pe(Et(h,"content",m)),marks:pe(Et(h,"marks",m)),group:pe(Et(h,"group",m)),inline:pe(Et(h,"inline",m)),atom:pe(Et(h,"atom",m)),selectable:pe(Et(h,"selectable",m)),draggable:pe(Et(h,"draggable",m)),code:pe(Et(h,"code",m)),whitespace:pe(Et(h,"whitespace",m)),linebreakReplacement:pe(Et(h,"linebreakReplacement",m)),defining:pe(Et(h,"defining",m)),isolating:pe(Et(h,"isolating",m)),attrs:Object.fromEntries(d.map(oP))}),T=pe(Et(h,"parseHTML",m));T&&(v.parseDOM=T.map(E=>iP(E,d)));const S=Et(h,"renderHTML",m);S&&(v.toDOM=E=>S({node:E,HTMLAttributes:$p(E,d)}));const w=Et(h,"renderText",m);return w&&(v.toText=w),[h.name,v]})),u=Object.fromEntries(s.map(h=>{const d=r.filter(w=>w.type===h.name),m={name:h.name,options:h.options,storage:h.storage,editor:t},g=n.reduce((w,E)=>{const R=Et(E,"extendMarkSchema",m);return{...w,...R?R(h):{}}},{}),v=sP({...g,inclusive:pe(Et(h,"inclusive",m)),excludes:pe(Et(h,"excludes",m)),group:pe(Et(h,"group",m)),spanning:pe(Et(h,"spanning",m)),code:pe(Et(h,"code",m)),attrs:Object.fromEntries(d.map(oP))}),T=pe(Et(h,"parseHTML",m));T&&(v.parseDOM=T.map(w=>iP(w,d)));const S=Et(h,"renderHTML",m);return S&&(v.toDOM=w=>S({mark:w,HTMLAttributes:$p(w,d)})),[h.name,v]}));return new qB({topNode:o,nodes:l,marks:u})}function $it(n){const t=n.filter((e,r)=>n.indexOf(e)!==r);return Array.from(new Set(t))}function lp(n){return n.sort((e,r)=>{const i=Et(e,"priority")||100,s=Et(r,"priority")||100;return i>s?-1:i<s?1:0})}function pF(n){const t=lp(PC(n)),e=$it(t.map(r=>r.name));return e.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${e.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),t}function mF(n,t,e){const{from:r,to:i}=t,{blockSeparator:s=`

`,textSerializers:o={}}=e||{};let l="";return n.nodesBetween(r,i,(u,h,d,m)=>{var g;u.isBlock&&h>r&&(l+=s);const v=o?.[u.type.name];if(v)return d&&(l+=v({node:u,pos:h,parent:d,index:m,range:t})),!1;u.isText&&(l+=(g=u?.text)==null?void 0:g.slice(Math.max(r,h)-h,i-h))}),l}function qit(n,t){const e={from:0,to:n.content.size};return mF(n,e,t)}function gF(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}function Git(n,t){const e=_n(t,n.schema),{from:r,to:i}=n.selection,s=[];n.doc.nodesBetween(r,i,l=>{s.push(l)});const o=s.reverse().find(l=>l.type.name===e.name);return o?{...o.attrs}:{}}function yF(n,t){const e=Wb(typeof t=="string"?t:t.name,n.schema);return e==="node"?Git(n,t):e==="mark"?uF(n,t):{}}function Wit(n,t=JSON.stringify){const e={};return n.filter(r=>{const i=t(r);return Object.prototype.hasOwnProperty.call(e,i)?!1:e[i]=!0})}function Yit(n){const t=Wit(n);return t.length===1?t:t.filter((e,r)=>!t.filter((s,o)=>o!==r).some(s=>e.oldRange.from>=s.oldRange.from&&e.oldRange.to<=s.oldRange.to&&e.newRange.from>=s.newRange.from&&e.newRange.to<=s.newRange.to))}function vF(n){const{mapping:t,steps:e}=n,r=[];return t.maps.forEach((i,s)=>{const o=[];if(i.ranges.length)i.forEach((l,u)=>{o.push({from:l,to:u})});else{const{from:l,to:u}=e[s];if(l===void 0||u===void 0)return;o.push({from:l,to:u})}o.forEach(({from:l,to:u})=>{const h=t.slice(s).map(l,-1),d=t.slice(s).map(u),m=t.invert().map(h,-1),g=t.invert().map(d);r.push({oldRange:{from:m,to:g},newRange:{from:h,to:d}})})}),Yit(r)}function LC(n,t,e){const r=[];return n===t?e.resolve(n).marks().forEach(i=>{const s=e.resolve(n),o=IC(s,i.type);o&&r.push({mark:i,...o})}):e.nodesBetween(n,t,(i,s)=>{!i||i?.nodeSize===void 0||r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}var Kit=(n,t,e,r=20)=>{const i=n.doc.resolve(e);let s=r,o=null;for(;s>0&&o===null;){const l=i.node(s);l?.type.name===t?o=l:s-=1}return[o,s]};function kd(n,t){return t.nodes[n]||t.marks[n]||null}function _0(n,t,e){return Object.fromEntries(Object.entries(e).filter(([r])=>{const i=n.find(s=>s.type===t&&s.name===r);return i?i.attribute.keepOnSplit:!1}))}var Xit=(n,t=500)=>{let e="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-t),r,(i,s,o,l)=>{var u,h;const d=((h=(u=i.type.spec).toText)==null?void 0:h.call(u,{node:i,pos:s,parent:o,index:l}))||i.textContent||"%leaf%";e+=i.isAtom&&!i.isText?d:d.slice(0,Math.max(0,r-s))}),e};function Qx(n,t,e={}){const{empty:r,ranges:i}=n.selection,s=t?Xo(t,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(m=>s?s.name===m.type.name:!0).find(m=>mv(m.attrs,e,{strict:!1}));let o=0;const l=[];if(i.forEach(({$from:m,$to:g})=>{const v=m.pos,T=g.pos;n.doc.nodesBetween(v,T,(S,w)=>{if(s&&S.inlineContent&&!S.type.allowsMarkType(s))return!1;if(!S.isText&&!S.marks.length)return;const E=Math.max(v,w),R=Math.min(T,w+S.nodeSize),P=R-E;o+=P,l.push(...S.marks.map(j=>({mark:j,from:E,to:R})))})}),o===0)return!1;const u=l.filter(m=>s?s.name===m.mark.type.name:!0).filter(m=>mv(m.mark.attrs,e,{strict:!1})).reduce((m,g)=>m+g.to-g.from,0),h=l.filter(m=>s?m.mark.type!==s&&m.mark.type.excludes(s):!0).reduce((m,g)=>m+g.to-g.from,0);return(u>0?u+h:u)>=o}function Qit(n,t,e={}){if(!t)return bl(n,null,e)||Qx(n,null,e);const r=Wb(t,n.schema);return r==="node"?bl(n,t,e):r==="mark"?Qx(n,t,e):!1}var Jit=(n,t)=>{const{$from:e,$to:r,$anchor:i}=n.selection;if(t){const s=Yb(l=>l.type.name===t)(n.selection);if(!s)return!1;const o=n.doc.resolve(s.pos+1);return i.pos+1===o.end()}return!(r.parentOffset<r.parent.nodeSize-2||e.pos!==r.pos)},Zit=n=>{const{$from:t,$to:e}=n.selection;return!(t.parentOffset>0||t.pos!==e.pos)};function aP(n,t){return Array.isArray(t)?t.some(e=>(typeof e=="string"?e:e.name)===n.name):t}function lP(n,t){const{nodeExtensions:e}=Uh(t),r=e.find(o=>o.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},s=pe(Et(r,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function Kb(n,{checkChildren:t=!0,ignoreWhitespace:e=!1}={}){var r;if(e){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!=null?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(t){let i=!0;return n.content.forEach(s=>{i!==!1&&(Kb(s,{ignoreWhitespace:e,checkChildren:t})||(i=!1))}),i}return!1}function bF(n){return n instanceof Mt}var _F=class TF{constructor(t){this.position=t}static fromJSON(t){return new TF(t.position)}toJSON(){return{position:this.position}}};function tst(n,t){const e=t.mapping.mapResult(n.position);return{position:new _F(e.pos),mapResult:e}}function est(n){return new _F(n)}function nst(n,t,e){var r;const{selection:i}=t;let s=null;if(oF(i)&&(s=i.$cursor),s){const l=(r=n.storedMarks)!=null?r:s.marks();return s.parent.type.allowsMarkType(e)&&(!!e.isInSet(l)||!l.some(h=>h.type.excludes(e)))}const{ranges:o}=i;return o.some(({$from:l,$to:u})=>{let h=l.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(e):!1;return n.doc.nodesBetween(l.pos,u.pos,(d,m,g)=>{if(h)return!1;if(d.isInline){const v=!g||g.type.allowsMarkType(e),T=!!e.isInSet(d.marks)||!d.marks.some(S=>S.type.excludes(e));h=v&&T}return!h}),h})}var rst=(n,t={})=>({tr:e,state:r,dispatch:i})=>{const{selection:s}=e,{empty:o,ranges:l}=s,u=Xo(n,r.schema);if(i)if(o){const h=uF(r,u);e.addStoredMark(u.create({...h,...t}))}else l.forEach(h=>{const d=h.$from.pos,m=h.$to.pos;r.doc.nodesBetween(d,m,(g,v)=>{const T=Math.max(v,d),S=Math.min(v+g.nodeSize,m);g.marks.find(E=>E.type===u)?g.marks.forEach(E=>{u===E.type&&e.addMark(T,S,u.create({...E.attrs,...t}))}):e.addMark(T,S,u.create(t))})});return nst(r,e,u)},ist=(n,t)=>({tr:e})=>(e.setMeta(n,t),!0),sst=(n,t={})=>({state:e,dispatch:r,chain:i})=>{const s=_n(n,e.schema);let o;return e.selection.$anchor.sameParent(e.selection.$head)&&(o=e.selection.$anchor.parent.attrs),s.isTextblock?i().command(({commands:l})=>T2(s,{...o,...t})(e)?!0:l.clearNodes()).command(({state:l})=>T2(s,{...o,...t})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},ost=n=>({tr:t,dispatch:e})=>{if(e){const{doc:r}=t,i=Rc(n,0,r.content.size),s=Mt.create(r,i);t.setSelection(s)}return!0},ast=(n,t)=>({tr:e,state:r,dispatch:i})=>{const{selection:s}=r;let o,l;return typeof t=="number"?(o=t,l=t):t&&"from"in t&&"to"in t?(o=t.from,l=t.to):(o=s.from,l=s.to),i&&e.doc.nodesBetween(o,l,(u,h)=>{u.isText||e.setNodeMarkup(h,void 0,{...u.attrs,dir:n})}),!0},lst=n=>({tr:t,dispatch:e})=>{if(e){const{doc:r}=t,{from:i,to:s}=typeof n=="number"?{from:n,to:n}:n,o=jt.atStart(r).from,l=jt.atEnd(r).to,u=Rc(i,o,l),h=Rc(s,o,l),d=jt.create(r,u,h);t.setSelection(d)}return!0},cst=n=>({state:t,dispatch:e})=>{const r=_n(n,t.schema);return nnt(r)(t,e)};function cP(n,t){const e=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(e){const r=e.filter(i=>t?.includes(i.type.name));n.tr.ensureMarks(r)}}var ust=({keepMarks:n=!0}={})=>({tr:t,state:e,dispatch:r,editor:i})=>{const{selection:s,doc:o}=t,{$from:l,$to:u}=s,h=i.extensionManager.attributes,d=_0(h,l.node().type.name,l.node().attrs);if(s instanceof Mt&&s.node.isBlock)return!l.parentOffset||!jo(o,l.pos)?!1:(r&&(n&&cP(e,i.extensionManager.splittableMarks),t.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const m=u.parentOffset===u.parent.content.size,g=l.depth===0?void 0:jit(l.node(-1).contentMatchAt(l.indexAfter(-1)));let v=m&&g?[{type:g,attrs:d}]:void 0,T=jo(t.doc,t.mapping.map(l.pos),1,v);if(!v&&!T&&jo(t.doc,t.mapping.map(l.pos),1,g?[{type:g}]:void 0)&&(T=!0,v=g?[{type:g,attrs:d}]:void 0),r){if(T&&(s instanceof jt&&t.deleteSelection(),t.split(t.mapping.map(l.pos),1,v),g&&!m&&!l.parentOffset&&l.parent.type!==g)){const S=t.mapping.map(l.before()),w=t.doc.resolve(S);l.node(-1).canReplaceWith(w.index(),w.index()+1,g)&&t.setNodeMarkup(t.mapping.map(l.before()),g)}n&&cP(e,i.extensionManager.splittableMarks),t.scrollIntoView()}return T},hst=(n,t={})=>({tr:e,state:r,dispatch:i,editor:s})=>{var o;const l=_n(n,r.schema),{$from:u,$to:h}=r.selection,d=r.selection.node;if(d&&d.isBlock||u.depth<2||!u.sameParent(h))return!1;const m=u.node(-1);if(m.type!==l)return!1;const g=s.extensionManager.attributes;if(u.parent.content.size===0&&u.node(-1).childCount===u.indexAfter(-1)){if(u.depth===2||u.node(-3).type!==l||u.index(-2)!==u.node(-2).childCount-1)return!1;if(i){let E=ut.empty;const R=u.index(-1)?1:u.index(-2)?2:3;for(let k=u.depth-R;k>=u.depth-3;k-=1)E=ut.from(u.node(k).copy(E));const P=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,j={..._0(g,u.node().type.name,u.node().attrs),...t},N=((o=l.contentMatch.defaultType)==null?void 0:o.createAndFill(j))||void 0;E=E.append(ut.from(l.createAndFill(null,N)||void 0));const W=u.before(u.depth-(R-1));e.replace(W,u.after(-P),new vt(E,4-R,0));let M=-1;e.doc.nodesBetween(W,e.doc.content.size,(k,O)=>{if(M>-1)return!1;k.isTextblock&&k.content.size===0&&(M=O+1)}),M>-1&&e.setSelection(jt.near(e.doc.resolve(M))),e.scrollIntoView()}return!0}const v=h.pos===u.end()?m.contentMatchAt(0).defaultType:null,T={..._0(g,m.type.name,m.attrs),...t},S={..._0(g,u.node().type.name,u.node().attrs),...t};e.delete(u.pos,h.pos);const w=v?[{type:l,attrs:T},{type:v,attrs:S}]:[{type:l,attrs:T}];if(!jo(e.doc,u.pos,2))return!1;if(i){const{selection:E,storedMarks:R}=r,{splittableMarks:P}=s.extensionManager,j=R||E.$to.parentOffset&&E.$from.marks();if(e.split(u.pos,2,w).scrollIntoView(),!j||!i)return!0;const N=j.filter(W=>P.includes(W.type.name));e.ensureMarks(N)}return!0},hw=(n,t)=>{const e=Yb(o=>o.type===t)(n.selection);if(!e)return!0;const r=n.doc.resolve(Math.max(0,e.pos-1)).before(e.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return e.node.type===i?.type&&Il(n.doc,e.pos)&&n.join(e.pos),!0},fw=(n,t)=>{const e=Yb(o=>o.type===t)(n.selection);if(!e)return!0;const r=n.doc.resolve(e.start).after(e.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return e.node.type===i?.type&&Il(n.doc,r)&&n.join(r),!0},fst=(n,t,e,r={})=>({editor:i,tr:s,state:o,dispatch:l,chain:u,commands:h,can:d})=>{const{extensions:m,splittableMarks:g}=i.extensionManager,v=_n(n,o.schema),T=_n(t,o.schema),{selection:S,storedMarks:w}=o,{$from:E,$to:R}=S,P=E.blockRange(R),j=w||S.$to.parentOffset&&S.$from.marks();if(!P)return!1;const N=Yb(W=>lP(W.type.name,m))(S);if(P.depth>=1&&N&&P.depth-N.depth<=1){if(N.node.type===v)return h.liftListItem(T);if(lP(N.node.type.name,m)&&v.validContent(N.node.content)&&l)return u().command(()=>(s.setNodeMarkup(N.pos,v),!0)).command(()=>hw(s,v)).command(()=>fw(s,v)).run()}return!e||!j||!l?u().command(()=>d().wrapInList(v,r)?!0:h.clearNodes()).wrapInList(v,r).command(()=>hw(s,v)).command(()=>fw(s,v)).run():u().command(()=>{const W=d().wrapInList(v,r),M=j.filter(k=>g.includes(k.type.name));return s.ensureMarks(M),W?!0:h.clearNodes()}).wrapInList(v,r).command(()=>hw(s,v)).command(()=>fw(s,v)).run()},dst=(n,t={},e={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=e,o=Xo(n,r.schema);return Qx(r,o,t)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,t)},pst=(n,t,e={})=>({state:r,commands:i})=>{const s=_n(n,r.schema),o=_n(t,r.schema),l=bl(r,s,e);let u;return r.selection.$anchor.sameParent(r.selection.$head)&&(u=r.selection.$anchor.parent.attrs),l?i.setNode(o,u):i.setNode(s,{...u,...e})},mst=(n,t={})=>({state:e,commands:r})=>{const i=_n(n,e.schema);return bl(e,i,t)?r.lift(i):r.wrapIn(i,t)},gst=()=>({state:n,dispatch:t})=>{const e=n.plugins;for(let r=0;r<e.length;r+=1){const i=e[r];let s;if(i.spec.isInputRules&&(s=i.getState(n))){if(t){const o=n.tr,l=s.transform;for(let u=l.steps.length-1;u>=0;u-=1)o.step(l.steps[u].invert(l.docs[u]));if(s.text){const u=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,n.schema.text(s.text,u))}else o.delete(s.from,s.to)}return!0}}return!1},yst=()=>({tr:n,dispatch:t})=>{const{selection:e}=n,{empty:r,ranges:i}=e;return r||t&&i.forEach(s=>{n.removeMark(s.$from.pos,s.$to.pos)}),!0},vst=(n,t={})=>({tr:e,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=t,{selection:l}=e,u=Xo(n,r.schema),{$from:h,empty:d,ranges:m}=l;if(!i)return!0;if(d&&o){let{from:g,to:v}=l;const T=(s=h.marks().find(w=>w.type===u))==null?void 0:s.attrs,S=IC(h,u,T);S&&(g=S.from,v=S.to),e.removeMark(g,v,u)}else m.forEach(g=>{e.removeMark(g.$from.pos,g.$to.pos,u)});return e.removeStoredMark(u),!0},bst=n=>({tr:t,state:e,dispatch:r})=>{const{selection:i}=e;let s,o;return typeof n=="number"?(s=n,o=n):n&&"from"in n&&"to"in n?(s=n.from,o=n.to):(s=i.from,o=i.to),r&&t.doc.nodesBetween(s,o,(l,u)=>{if(l.isText)return;const h={...l.attrs};delete h.dir,t.setNodeMarkup(u,void 0,h)}),!0},_st=(n,t={})=>({tr:e,state:r,dispatch:i})=>{let s=null,o=null;const l=Wb(typeof n=="string"?n:n.name,r.schema);if(!l)return!1;l==="node"&&(s=_n(n,r.schema)),l==="mark"&&(o=Xo(n,r.schema));let u=!1;return e.selection.ranges.forEach(h=>{const d=h.$from.pos,m=h.$to.pos;let g,v,T,S;e.selection.empty?r.doc.nodesBetween(d,m,(w,E)=>{s&&s===w.type&&(u=!0,T=Math.max(E,d),S=Math.min(E+w.nodeSize,m),g=E,v=w)}):r.doc.nodesBetween(d,m,(w,E)=>{E<d&&s&&s===w.type&&(u=!0,T=Math.max(E,d),S=Math.min(E+w.nodeSize,m),g=E,v=w),E>=d&&E<=m&&(s&&s===w.type&&(u=!0,i&&e.setNodeMarkup(E,void 0,{...w.attrs,...t})),o&&w.marks.length&&w.marks.forEach(R=>{if(o===R.type&&(u=!0,i)){const P=Math.max(E,d),j=Math.min(E+w.nodeSize,m);e.addMark(P,j,o.create({...R.attrs,...t}))}}))}),v&&(g!==void 0&&i&&e.setNodeMarkup(g,void 0,{...v.attrs,...t}),o&&v.marks.length&&v.marks.forEach(w=>{o===w.type&&i&&e.addMark(T,S,o.create({...w.attrs,...t}))}))}),u},Tst=(n,t={})=>({state:e,dispatch:r})=>{const i=_n(n,e.schema);return Ket(i,t)(e,r)},Sst=(n,t={})=>({state:e,dispatch:r})=>{const i=_n(n,e.schema);return Xet(i,t)(e,r)},wst=class{constructor(){this.callbacks={}}on(n,t){return this.callbacks[n]||(this.callbacks[n]=[]),this.callbacks[n].push(t),this}emit(n,...t){const e=this.callbacks[n];return e&&e.forEach(r=>r.apply(this,t)),this}off(n,t){const e=this.callbacks[n];return e&&(t?this.callbacks[n]=e.filter(r=>r!==t):delete this.callbacks[n]),this}once(n,t){const e=(...r)=>{this.off(n,e),t.apply(this,r)};return this.on(n,e)}removeAllListeners(){this.callbacks={}}},Xb=class{constructor(n){var t;this.find=n.find,this.handler=n.handler,this.undoable=(t=n.undoable)!=null?t:!0}},xst=(n,t)=>{if(OC(t))return t.exec(n);const e=t(n);if(!e)return null;const r=[e.text];return r.index=e.index,r.input=n,r.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(e.replaceWith)),r};function by(n){var t;const{editor:e,from:r,to:i,text:s,rules:o,plugin:l}=n,{view:u}=e;if(u.composing)return!1;const h=u.state.doc.resolve(r);if(h.parent.type.spec.code||(t=h.nodeBefore||h.nodeAfter)!=null&&t.marks.find(g=>g.type.spec.code))return!1;let d=!1;const m=Xit(h)+s;return o.forEach(g=>{if(d)return;const v=xst(m,g.find);if(!v)return;const T=u.state.tr,S=qb({state:u.state,transaction:T}),w={from:r-(v[0].length-s.length),to:i},{commands:E,chain:R,can:P}=new Gb({editor:e,state:S});g.handler({state:S,range:w,match:v,commands:E,chain:R,can:P})===null||!T.steps.length||(g.undoable&&T.setMeta(l,{transform:T,from:r,to:i,text:s}),u.dispatch(T),d=!0)}),d}function Est(n){const{editor:t,rules:e}=n,r=new ze({state:{init(){return null},apply(i,s,o){const l=i.getMeta(r);if(l)return l;const u=i.getMeta("applyInputRules");return u&&setTimeout(()=>{let{text:d}=u;typeof d=="string"?d=d:d=NC(ut.from(d),o.schema);const{from:m}=u,g=m+d.length;by({editor:t,from:m,to:g,text:d,rules:e,plugin:r})}),i.selectionSet||i.docChanged?null:s}},props:{handleTextInput(i,s,o,l){return by({editor:t,from:s,to:o,text:l,rules:e,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&by({editor:t,from:s.pos,to:s.pos,text:"",rules:e,plugin:r})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?by({editor:t,from:o.pos,to:o.pos,text:`
`,rules:e,plugin:r}):!1}},isInputRules:!0});return r}function Cst(n){return Object.prototype.toString.call(n).slice(8,-1)}function _y(n){return Cst(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function SF(n,t){const e={...n};return _y(n)&&_y(t)&&Object.keys(t).forEach(r=>{_y(t[r])&&_y(n[r])?e[r]=SF(n[r],t[r]):e[r]=t[r]}),e}var VC=class{constructor(n={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...n},this.name=this.config.name}get options(){return{...pe(Et(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...pe(Et(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(n={}){const t=this.extend({...this.config,addOptions:()=>SF(this.options,n)});return t.name=this.name,t.parent=this.parent,t}extend(n={}){const t=new this.constructor({...this.config,...n});return t.parent=this,this.child=t,t.name="name"in n?n.name:t.parent.name,t}},Qo=class wF extends VC{constructor(){super(...arguments),this.type="mark"}static create(t={}){const e=typeof t=="function"?t():t;return new wF(e)}static handleExit({editor:t,mark:e}){const{tr:r}=t.state,i=t.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(h=>h?.type.name===e.name))return!1;const u=o.find(h=>h?.type.name===e.name);return u&&r.removeStoredMark(u),r.insertText(" ",i.pos),t.view.dispatch(r),!0}return!1}configure(t){return super.configure(t)}extend(t){const e=typeof t=="function"?t():t;return super.extend(e)}};function Ast(n){return typeof n=="number"}var kst=class{constructor(n){this.find=n.find,this.handler=n.handler}},Rst=(n,t,e)=>{if(OC(t))return[...n.matchAll(t)];const r=t(n,e);return r?r.map(i=>{const s=[i.text];return s.index=i.index,s.input=n,s.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(i.replaceWith)),s}):[]};function Mst(n){const{editor:t,state:e,from:r,to:i,rule:s,pasteEvent:o,dropEvent:l}=n,{commands:u,chain:h,can:d}=new Gb({editor:t,state:e}),m=[];return e.doc.nodesBetween(r,i,(v,T)=>{var S,w,E,R,P;if((w=(S=v.type)==null?void 0:S.spec)!=null&&w.code||!(v.isText||v.isTextblock||v.isInline))return;const j=(P=(R=(E=v.content)==null?void 0:E.size)!=null?R:v.nodeSize)!=null?P:0,N=Math.max(r,T),W=Math.min(i,T+j);if(N>=W)return;const M=v.isText?v.text||"":v.textBetween(N-T,W-T,void 0,"");Rst(M,s.find,o).forEach(O=>{if(O.index===void 0)return;const B=N+O.index+1,F=B+O[0].length,H={from:e.tr.mapping.map(B),to:e.tr.mapping.map(F)},V=s.handler({state:e,range:H,match:O,commands:u,chain:h,can:d,pasteEvent:o,dropEvent:l});m.push(V)})}),m.every(v=>v!==null)}var Ty=null,Dst=n=>{var t;const e=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=e.clipboardData)==null||t.setData("text/html",n),e};function Ost(n){const{editor:t,rules:e}=n;let r=null,i=!1,s=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const u=({state:d,from:m,to:g,rule:v,pasteEvt:T})=>{const S=d.tr,w=qb({state:d,transaction:S});if(!(!Mst({editor:t,state:w,from:Math.max(m-1,0),to:g.b-1,rule:v,pasteEvent:T,dropEvent:l})||!S.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,S}};return e.map(d=>new ze({view(m){const g=T=>{var S;r=(S=m.dom.parentElement)!=null&&S.contains(T.target)?m.dom.parentElement:null,r&&(Ty=t)},v=()=>{Ty&&(Ty=null)};return window.addEventListener("dragstart",g),window.addEventListener("dragend",v),{destroy(){window.removeEventListener("dragstart",g),window.removeEventListener("dragend",v)}}},props:{handleDOMEvents:{drop:(m,g)=>{if(s=r===m.dom.parentElement,l=g,!s){const v=Ty;v?.isEditable&&setTimeout(()=>{const T=v.state.selection;T&&v.commands.deleteRange({from:T.from,to:T.to})},10)}return!1},paste:(m,g)=>{var v;const T=(v=g.clipboardData)==null?void 0:v.getData("text/html");return o=g,i=!!T?.includes("data-pm-slice"),!1}}},appendTransaction:(m,g,v)=>{const T=m[0],S=T.getMeta("uiEvent")==="paste"&&!i,w=T.getMeta("uiEvent")==="drop"&&!s,E=T.getMeta("applyPasteRules"),R=!!E;if(!S&&!w&&!R)return;if(R){let{text:N}=E;typeof N=="string"?N=N:N=NC(ut.from(N),v.schema);const{from:W}=E,M=W+N.length,k=Dst(N);return u({rule:d,state:v,from:W,to:{b:M},pasteEvt:k})}const P=g.doc.content.findDiffStart(v.doc.content),j=g.doc.content.findDiffEnd(v.doc.content);if(!(!Ast(P)||!j||P===j.b))return u({rule:d,state:v,from:P,to:j,pasteEvt:o})}}))}var Qb=class{constructor(n,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=n,this.extensions=pF(n),this.schema=Hit(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((n,t)=>{const e={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:kd(t.name,this.schema)},r=Et(t,"addCommands",e);return r?{...n,...r()}:n},{})}get plugins(){const{editor:n}=this;return lp([...this.extensions].reverse()).flatMap(r=>{const i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:n,type:kd(r.name,this.schema)},s=[],o=Et(r,"addKeyboardShortcuts",i);let l={};if(r.type==="mark"&&Et(r,"exitable",i)&&(l.ArrowRight=()=>Qo.handleExit({editor:n,mark:r})),o){const g=Object.fromEntries(Object.entries(o()).map(([v,T])=>[v,()=>T({editor:n})]));l={...l,...g}}const u=Grt(l);s.push(u);const h=Et(r,"addInputRules",i);if(aP(r,n.options.enableInputRules)&&h){const g=h();if(g&&g.length){const v=Est({editor:n,rules:g}),T=Array.isArray(v)?v:[v];s.push(...T)}}const d=Et(r,"addPasteRules",i);if(aP(r,n.options.enablePasteRules)&&d){const g=d();if(g&&g.length){const v=Ost({editor:n,rules:g});s.push(...v)}}const m=Et(r,"addProseMirrorPlugins",i);if(m){const g=m();s.push(...g)}return s})}get attributes(){return dF(this.extensions)}get nodeViews(){const{editor:n}=this,{nodeExtensions:t}=Uh(this.extensions);return Object.fromEntries(t.filter(e=>!!Et(e,"addNodeView")).map(e=>{const r=this.attributes.filter(u=>u.type===e.name),i={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:n,type:_n(e.name,this.schema)},s=Et(e,"addNodeView",i);if(!s)return[];const o=s();if(!o)return[];const l=(u,h,d,m,g)=>{const v=$p(u,r);return o({node:u,view:h,getPos:d,decorations:m,innerDecorations:g,editor:n,extension:e,HTMLAttributes:v})};return[e.name,l]}))}dispatchTransaction(n){const{editor:t}=this;return lp([...this.extensions].reverse()).reduceRight((r,i)=>{const s={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:t,type:kd(i.name,this.schema)},o=Et(i,"dispatchTransaction",s);return o?l=>{o.call(s,{transaction:l,next:r})}:r},n)}transformPastedHTML(n){const{editor:t}=this;return lp([...this.extensions]).reduce((r,i)=>{const s={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:t,type:kd(i.name,this.schema)},o=Et(i,"transformPastedHTML",s);return o?(l,u)=>{const h=r(l,u);return o.call(s,h)}:r},n||(r=>r))}get markViews(){const{editor:n}=this,{markExtensions:t}=Uh(this.extensions);return Object.fromEntries(t.filter(e=>!!Et(e,"addMarkView")).map(e=>{const r=this.attributes.filter(l=>l.type===e.name),i={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:n,type:Xo(e.name,this.schema)},s=Et(e,"addMarkView",i);if(!s)return[];const o=(l,u,h)=>{const d=$p(l,r);return s()({mark:l,view:u,inline:h,editor:n,extension:e,HTMLAttributes:d,updateAttributes:m=>{Gst(l,n,m)}})};return[e.name,o]}))}setupExtensions(){const n=this.extensions;this.editor.extensionStorage=Object.fromEntries(n.map(t=>[t.name,t.storage])),n.forEach(t=>{var e;const r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:kd(t.name,this.schema)};t.type==="mark"&&((e=pe(Et(t,"keepOnSplit",r)))==null||e)&&this.splittableMarks.push(t.name);const i=Et(t,"onBeforeCreate",r),s=Et(t,"onCreate",r),o=Et(t,"onUpdate",r),l=Et(t,"onSelectionUpdate",r),u=Et(t,"onTransaction",r),h=Et(t,"onFocus",r),d=Et(t,"onBlur",r),m=Et(t,"onDestroy",r);i&&this.editor.on("beforeCreate",i),s&&this.editor.on("create",s),o&&this.editor.on("update",o),l&&this.editor.on("selectionUpdate",l),u&&this.editor.on("transaction",u),h&&this.editor.on("focus",h),d&&this.editor.on("blur",d),m&&this.editor.on("destroy",m)})}};Qb.resolve=pF;Qb.sort=lp;Qb.flatten=PC;var Ist={};DC(Ist,{ClipboardTextSerializer:()=>EF,Commands:()=>CF,Delete:()=>AF,Drop:()=>kF,Editable:()=>RF,FocusEvents:()=>DF,Keymap:()=>OF,Paste:()=>IF,Tabindex:()=>PF,TextDirection:()=>NF,focusEventsPluginKey:()=>MF});var Ce=class xF extends VC{constructor(){super(...arguments),this.type="extension"}static create(t={}){const e=typeof t=="function"?t():t;return new xF(e)}configure(t){return super.configure(t)}extend(t){const e=typeof t=="function"?t():t;return super.extend(e)}},EF=Ce.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new ze({key:new Cn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:t,schema:e}=n,{doc:r,selection:i}=t,{ranges:s}=i,o=Math.min(...s.map(d=>d.$from.pos)),l=Math.max(...s.map(d=>d.$to.pos)),u=gF(e);return mF(r,{from:o,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:u})}}})]}}),CF=Ce.create({name:"commands",addCommands(){return{...iF}}}),AF=Ce.create({name:"delete",onUpdate({transaction:n,appendedTransactions:t}){var e,r,i;const s=()=>{var o,l,u,h;if((h=(u=(l=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:l.filterTransaction)==null?void 0:u.call(l,n))!=null?h:n.getMeta("y-sync$"))return;const d=hF(n.before,[n,...t]);vF(d).forEach(v=>{d.mapping.mapResult(v.oldRange.from).deletedAfter&&d.mapping.mapResult(v.oldRange.to).deletedBefore&&d.before.nodesBetween(v.oldRange.from,v.oldRange.to,(T,S)=>{const w=S+T.nodeSize-2,E=v.oldRange.from<=S&&w<=v.oldRange.to;this.editor.emit("delete",{type:"node",node:T,from:S,to:w,newFrom:d.mapping.map(S),newTo:d.mapping.map(w),deletedRange:v.oldRange,newRange:v.newRange,partial:!E,editor:this.editor,transaction:n,combinedTransform:d})})});const g=d.mapping;d.steps.forEach((v,T)=>{var S,w;if(v instanceof Ji){const E=g.slice(T).map(v.from,-1),R=g.slice(T).map(v.to),P=g.invert().map(E,-1),j=g.invert().map(R),N=(S=d.doc.nodeAt(E-1))==null?void 0:S.marks.some(M=>M.eq(v.mark)),W=(w=d.doc.nodeAt(R))==null?void 0:w.marks.some(M=>M.eq(v.mark));this.editor.emit("delete",{type:"mark",mark:v.mark,from:v.from,to:v.to,deletedRange:{from:P,to:j},newRange:{from:E,to:R},partial:!!(W||N),editor:this.editor,transaction:n,combinedTransform:d})}})};(i=(r=(e=this.editor.options.coreExtensionOptions)==null?void 0:e.delete)==null?void 0:r.async)==null||i?setTimeout(s,0):s()}}),kF=Ce.create({name:"drop",addProseMirrorPlugins(){return[new ze({key:new Cn("tiptapDrop"),props:{handleDrop:(n,t,e,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:e,moved:r})}}})]}}),RF=Ce.create({name:"editable",addProseMirrorPlugins(){return[new ze({key:new Cn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),MF=new Cn("focusEvents"),DF=Ce.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new ze({key:MF,props:{handleDOMEvents:{focus:(t,e)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:e}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,e)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:e}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),OF=Ce.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:u,doc:h}=l,{empty:d,$anchor:m}=u,{pos:g,parent:v}=m,T=m.parent.isTextblock&&g>0?l.doc.resolve(g-1):m,S=T.parent.type.spec.isolating,w=m.pos-m.parentOffset,E=S&&T.parent.childCount===1?w===m.pos:Gt.atStart(h).from===g;return!d||!v.type.isTextblock||v.textContent.length||!E||E&&m.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},s={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return gv()||cF()?s:i},addProseMirrorPlugins(){return[new ze({key:new Cn("clearDocument"),appendTransaction:(n,t,e)=>{if(n.some(S=>S.getMeta("composition")))return;const r=n.some(S=>S.docChanged)&&!t.doc.eq(e.doc),i=n.some(S=>S.getMeta("preventClearDocument"));if(!r||i)return;const{empty:s,from:o,to:l}=t.selection,u=Gt.atStart(t.doc).from,h=Gt.atEnd(t.doc).to;if(s||!(o===u&&l===h)||!Kb(e.doc))return;const g=e.tr,v=qb({state:e,transaction:g}),{commands:T}=new Gb({editor:this.editor,state:v});if(T.clearNodes(),!!g.steps.length)return g}})]}}),IF=Ce.create({name:"paste",addProseMirrorPlugins(){return[new ze({key:new Cn("tiptapPaste"),props:{handlePaste:(n,t,e)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:e})}}})]}}),PF=Ce.create({name:"tabindex",addProseMirrorPlugins(){return[new ze({key:new Cn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),NF=Ce.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:n}=Uh(this.extensions);return[{types:n.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{const e=t.getAttribute("dir");return e&&(e==="ltr"||e==="rtl"||e==="auto")?e:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new ze({key:new Cn("textDirection"),props:{attributes:()=>{const n=this.options.direction;return n?{dir:n}:{}}}})]}}),Pst=class Hd{constructor(t,e,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=t,this.editor=e,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let e=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}e=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:e,to:r},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),e=this.resolvedPos.doc.resolve(t);return new Hd(e,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new Hd(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new Hd(t,this.editor)}get children(){const t=[];return this.node.content.forEach((e,r)=>{const i=e.isBlock&&!e.isTextblock,s=e.isAtom&&!e.isText,o=e.isInline,l=this.pos+r+(s?0:1);if(l<0||l>this.resolvedPos.doc.nodeSize-2)return;const u=this.resolvedPos.doc.resolve(l);if(!i&&!o&&u.depth<=this.depth)return;const h=new Hd(u,this.editor,i,i||o?e:null);i&&(h.actualDepth=this.depth+1),t.push(h)}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,e={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===t)if(Object.keys(e).length>0){const s=i.node.attrs,o=Object.keys(e);for(let l=0;l<o.length;l+=1){const u=o[l];if(s[u]!==e[u])break}}else r=i;i=i.parent}return r}querySelector(t,e={}){return this.querySelectorAll(t,e,!0)[0]||null}querySelectorAll(t,e={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const s=Object.keys(e);return this.children.forEach(o=>{r&&i.length>0||(o.node.type.name===t&&s.every(u=>e[u]===o.node.attrs[u])&&i.push(o),!(r&&i.length>0)&&(i=i.concat(o.querySelectorAll(t,e,r))))}),i}setAttribute(t){const{tr:e}=this.editor.state;e.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(e)}},Nst=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function Lst(n,t,e){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return t&&i.setAttribute("nonce",t),i.setAttribute("data-tiptap-style",""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}var Vst=class extends wst{constructor(n={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:tst,createMappablePosition:est},this.setOptions(n),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:i,moved:s})=>this.options.onDrop(r,i,s)),this.on("paste",({event:r,slice:i})=>this.options.onPaste(r,i)),this.on("delete",this.options.onDelete);const t=this.createDoc(),e=aF(t,this.options.autofocus);this.editorState=gh.create({doc:t,schema:this.schema,selection:e||void 0}),this.options.element&&this.mount(this.options.element)}mount(n){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(n),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const n=this.editorView.dom;n?.editor&&delete n.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(n){console.warn("Failed to remove CSS element:",n)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=Lst(Nst,this.options.injectNonce))}setOptions(n={}){this.options={...this.options,...n},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(n,t=!0){this.setOptions({editable:n}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:n=>{this.editorState=n},dispatch:n=>{this.dispatchTransaction(n)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(n,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in n)return Reflect.get(n,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(n,t){const e=fF(t)?t(n,[...this.state.plugins]):[...this.state.plugins,n],r=this.state.reconfigure({plugins:e});return this.view.updateState(r),r}unregisterPlugin(n){if(this.isDestroyed)return;const t=this.state.plugins;let e=t;if([].concat(n).forEach(i=>{const s=typeof i=="string"?`${i}$`:i.key;e=e.filter(o=>!o.key.startsWith(s))}),t.length===e.length)return;const r=this.state.reconfigure({plugins:e});return this.view.updateState(r),r}createExtensionManager(){var n,t;const r=[...this.options.enableCoreExtensions?[RF,EF.configure({blockSeparator:(t=(n=this.options.coreExtensionOptions)==null?void 0:n.clipboardTextSerializer)==null?void 0:t.blockSeparator}),CF,DF,OF,PF,kF,IF,AF,NF.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new Qb(r,this)}createCommandManager(){this.commandManager=new Gb({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let n;try{n=Xx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>e.name!=="collaboration"),this.createExtensionManager()}}),n=Xx(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return n}createView(n){const{editorProps:t,enableExtensionDispatchTransaction:e}=this.options,r=t.dispatchTransaction||this.dispatchTransaction.bind(this),i=e?this.extensionManager.dispatchTransaction(r):r,s=t.transformPastedHTML,o=this.extensionManager.transformPastedHTML(s);this.editorView=new nF(n,{...t,attributes:{role:"textbox",...t?.attributes},dispatchTransaction:i,transformPastedHTML:o,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const l=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(l),this.prependClass(),this.injectCSS();const u=this.view.dom;u.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(n){this.isCapturingTransaction=!0,n(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(n){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=n;return}n.steps.forEach(h=>{var d;return(d=this.capturedTransaction)==null?void 0:d.step(h)});return}const{state:t,transactions:e}=this.state.applyTransaction(n),r=!this.state.selection.eq(t.selection),i=e.includes(n),s=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:n,nextState:t}),!i)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:n,appendedTransactions:e.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:n});const o=e.findLast(h=>h.getMeta("focus")||h.getMeta("blur")),l=o?.getMeta("focus"),u=o?.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:o}),u&&this.emit("blur",{editor:this,event:u.event,transaction:o}),!(n.getMeta("preventUpdate")||!e.some(h=>h.docChanged)||s.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:n,appendedTransactions:e.slice(1)})}getAttributes(n){return yF(this.state,n)}isActive(n,t){const e=typeof n=="string"?n:null,r=typeof n=="string"?t:n;return Qit(this.state,e,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return NC(this.state.doc.content,this.schema)}getText(n){const{blockSeparator:t=`

`,textSerializers:e={}}=n||{};return qit(this.state.doc,{blockSeparator:t,textSerializers:{...gF(this.schema),...e}})}get isEmpty(){return Kb(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var n,t;return(t=(n=this.editorView)==null?void 0:n.isDestroyed)!=null?t:!0}$node(n,t){var e;return((e=this.$doc)==null?void 0:e.querySelector(n,t))||null}$nodes(n,t){var e;return((e=this.$doc)==null?void 0:e.querySelectorAll(n,t))||null}$pos(n){const t=this.state.doc.resolve(n);return new Pst(t,this)}get $doc(){return this.$pos(0)}};function nu(n){return new Xb({find:n.find,handler:({state:t,range:e,match:r})=>{const i=pe(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=t,o=r[r.length-1],l=r[0];if(o){const u=l.search(/\S/),h=e.from+l.indexOf(o),d=h+o.length;if(LC(e.from,e.to,t.doc).filter(v=>v.mark.type.excluded.find(S=>S===n.type&&S!==v.mark.type)).filter(v=>v.to>h).length)return null;d<e.to&&s.delete(d,e.to),h>e.from&&s.delete(e.from+u,h);const g=e.from+u+o.length;s.addMark(e.from+u,g,n.type.create(i||{})),s.removeStoredMark(n.type)}},undoable:n.undoable})}function jst(n){return new Xb({find:n.find,handler:({state:t,range:e,match:r})=>{const i=pe(n.getAttributes,void 0,r)||{},{tr:s}=t,o=e.from;let l=e.to;const u=n.type.create(i);if(r[1]){const h=r[0].lastIndexOf(r[1]);let d=o+h;d>l?d=l:l=d+r[1].length;const m=r[0][r[0].length-1];s.insertText(m,o+r[0].length-1),s.replaceWith(d,l,u)}else if(r[0]){const h=n.type.isInline?o:o-1;s.insert(h,n.type.create(i)).delete(s.mapping.map(o),s.mapping.map(l))}s.scrollIntoView()},undoable:n.undoable})}function Jx(n){return new Xb({find:n.find,handler:({state:t,range:e,match:r})=>{const i=t.doc.resolve(e.from),s=pe(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;t.tr.delete(e.from,e.to).setBlockType(e.from,e.from,n.type,s)},undoable:n.undoable})}function zh(n){return new Xb({find:n.find,handler:({state:t,range:e,match:r,chain:i})=>{const s=pe(n.getAttributes,void 0,r)||{},o=t.tr.delete(e.from,e.to),u=o.doc.resolve(e.from).blockRange(),h=u&&mC(u,n.type,s);if(!h)return null;if(o.wrap(u,h),n.keepMarks&&n.editor){const{selection:m,storedMarks:g}=t,{splittableMarks:v}=n.editor.extensionManager,T=g||m.$to.parentOffset&&m.$from.marks();if(T){const S=T.filter(w=>v.includes(w.type.name));o.ensureMarks(S)}}if(n.keepAttributes){const m=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(m,s).run()}const d=o.doc.resolve(e.from-1).nodeBefore;d&&d.type===n.type&&Il(o.doc,e.from-1)&&(!n.joinPredicate||n.joinPredicate(r,d))&&o.join(e.from-1)},undoable:n.undoable})}function Bst(n,t){const{selection:e}=n,{$from:r}=e;if(e instanceof Mt){const s=r.index();return r.parent.canReplaceWith(s,s+1,t)}let i=r.depth;for(;i>=0;){const s=r.index(i);if(r.node(i).contentMatchAt(s).matchType(t))return!0;i-=1}return!1}var Fst={};DC(Fst,{createAtomBlockMarkdownSpec:()=>Ust,createBlockMarkdownSpec:()=>zst,createInlineMarkdownSpec:()=>qst,parseAttributes:()=>jC,parseIndentedBlocks:()=>Zx,renderNestedMarkdownContent:()=>FC,serializeAttributes:()=>BC});function jC(n){if(!n?.trim())return{};const t={},e=[],r=n.replace(/["']([^"']*)["']/g,h=>(e.push(h),`__QUOTED_${e.length-1}__`)),i=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const h=i.map(d=>d.trim().slice(1));t.class=h.join(" ")}const s=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);s&&(t.id=s[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(o)).forEach(([,h,d])=>{var m;const g=parseInt(((m=d.match(/__QUOTED_(\d+)__/))==null?void 0:m[1])||"0",10),v=e[g];v&&(t[h]=v.slice(1,-1))});const u=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return u&&u.split(/\s+/).filter(Boolean).forEach(d=>{d.match(/^[a-zA-Z][\w-]*$/)&&(t[d]=!0)}),t}function BC(n){if(!n||Object.keys(n).length===0)return"";const t=[];return n.class&&String(n.class).split(/\s+/).filter(Boolean).forEach(r=>t.push(`.${r}`)),n.id&&t.push(`#${n.id}`),Object.entries(n).forEach(([e,r])=>{e==="class"||e==="id"||(r===!0?t.push(e):r!==!1&&r!=null&&t.push(`${e}="${String(r)}"`))}),t.join(" ")}function Ust(n){const{nodeName:t,name:e,parseAttributes:r=jC,serializeAttributes:i=BC,defaultAttributes:s={},requiredAttributes:o=[],allowedAttributes:l}=n,u=e||t,h=d=>{if(!l)return d;const m={};return l.forEach(g=>{g in d&&(m[g]=d[g])}),m};return{parseMarkdown:(d,m)=>{const g={...s,...d.attributes};return m.createNode(t,g,[])},markdownTokenizer:{name:t,level:"block",start(d){var m;const g=new RegExp(`^:::${u}(?:\\s|$)`,"m"),v=(m=d.match(g))==null?void 0:m.index;return v!==void 0?v:-1},tokenize(d,m,g){const v=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),T=d.match(v);if(!T)return;const S=T[1]||"",w=r(S);if(!o.find(R=>!(R in w)))return{type:t,raw:T[0],attributes:w}}},renderMarkdown:d=>{const m=h(d.attrs||{}),g=i(m),v=g?` {${g}}`:"";return`:::${u}${v} :::`}}}function zst(n){const{nodeName:t,name:e,getContent:r,parseAttributes:i=jC,serializeAttributes:s=BC,defaultAttributes:o={},content:l="block",allowedAttributes:u}=n,h=e||t,d=m=>{if(!u)return m;const g={};return u.forEach(v=>{v in m&&(g[v]=m[v])}),g};return{parseMarkdown:(m,g)=>{let v;if(r){const S=r(m);v=typeof S=="string"?[{type:"text",text:S}]:S}else l==="block"?v=g.parseChildren(m.tokens||[]):v=g.parseInline(m.tokens||[]);const T={...o,...m.attributes};return g.createNode(t,T,v)},markdownTokenizer:{name:t,level:"block",start(m){var g;const v=new RegExp(`^:::${h}`,"m"),T=(g=m.match(v))==null?void 0:g.index;return T!==void 0?T:-1},tokenize(m,g,v){var T;const S=new RegExp(`^:::${h}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),w=m.match(S);if(!w)return;const[E,R=""]=w,P=i(R);let j=1;const N=E.length;let W="";const M=/^:::([\w-]*)(\s.*)?/gm,k=m.slice(N);for(M.lastIndex=0;;){const O=M.exec(k);if(O===null)break;const B=O.index,F=O[1];if(!((T=O[2])!=null&&T.endsWith(":::"))){if(F)j+=1;else if(j-=1,j===0){const H=k.slice(0,B);W=H.trim();const V=m.slice(0,N+B+O[0].length);let yt=[];if(W)if(l==="block")for(yt=v.blockTokens(H),yt.forEach(xt=>{xt.text&&(!xt.tokens||xt.tokens.length===0)&&(xt.tokens=v.inlineTokens(xt.text))});yt.length>0;){const xt=yt[yt.length-1];if(xt.type==="paragraph"&&(!xt.text||xt.text.trim()===""))yt.pop();else break}else yt=v.inlineTokens(W);return{type:t,raw:V,attributes:P,content:W,tokens:yt}}}}}},renderMarkdown:(m,g)=>{const v=d(m.attrs||{}),T=s(v),S=T?` {${T}}`:"",w=g.renderChildren(m.content||[],`

`);return`:::${h}${S}

${w}

:::`}}}function Hst(n){if(!n.trim())return{};const t={},e=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=e.exec(n);for(;r!==null;){const[,i,s,o]=r;t[i]=s||o,r=e.exec(n)}return t}function $st(n){return Object.entries(n).filter(([,t])=>t!=null).map(([t,e])=>`${t}="${e}"`).join(" ")}function qst(n){const{nodeName:t,name:e,getContent:r,parseAttributes:i=Hst,serializeAttributes:s=$st,defaultAttributes:o={},selfClosing:l=!1,allowedAttributes:u}=n,h=e||t,d=g=>{if(!u)return g;const v={};return u.forEach(T=>{const S=typeof T=="string"?T:T.name,w=typeof T=="string"?void 0:T.skipIfDefault;if(S in g){const E=g[S];if(w!==void 0&&E===w)return;v[S]=E}}),v},m=h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(g,v)=>{const T={...o,...g.attributes};if(l)return v.createNode(t,T);const S=r?r(g):g.content||"";return S?v.createNode(t,T,[v.createTextNode(S)]):v.createNode(t,T,[])},markdownTokenizer:{name:t,level:"inline",start(g){const v=l?new RegExp(`\\[${m}\\s*[^\\]]*\\]`):new RegExp(`\\[${m}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${m}\\]`),T=g.match(v),S=T?.index;return S!==void 0?S:-1},tokenize(g,v,T){const S=l?new RegExp(`^\\[${m}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${m}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${m}\\]`),w=g.match(S);if(!w)return;let E="",R="";if(l){const[,j]=w;R=j}else{const[,j,N]=w;R=j,E=N||""}const P=i(R.trim());return{type:t,raw:w[0],content:E.trim(),attributes:P}}},renderMarkdown:g=>{let v="";r?v=r(g):g.content&&g.content.length>0&&(v=g.content.filter(E=>E.type==="text").map(E=>E.text).join(""));const T=d(g.attrs||{}),S=s(T),w=S?` ${S}`:"";return l?`[${h}${w}]`:`[${h}${w}]${v}[/${h}]`}}}function Zx(n,t,e){var r,i,s,o;const l=n.split(`
`),u=[];let h="",d=0;const m=t.baseIndentSize||2;for(;d<l.length;){const g=l[d],v=g.match(t.itemPattern);if(!v){if(u.length>0)break;if(g.trim()===""){d+=1,h=`${h}${g}
`;continue}else return}const T=t.extractItemData(v),{indentLevel:S,mainContent:w}=T;h=`${h}${g}
`;const E=[w];for(d+=1;d<l.length;){const N=l[d];if(N.trim()===""){const M=l.slice(d+1).findIndex(B=>B.trim()!=="");if(M===-1)break;if((((i=(r=l[d+1+M].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:i.length)||0)>S){E.push(N),h=`${h}${N}
`,d+=1;continue}else break}if((((o=(s=N.match(/^(\s*)/))==null?void 0:s[1])==null?void 0:o.length)||0)>S)E.push(N),h=`${h}${N}
`,d+=1;else break}let R;const P=E.slice(1);if(P.length>0){const N=P.map(W=>W.slice(S+m)).join(`
`);N.trim()&&(t.customNestedParser?R=t.customNestedParser(N):R=e.blockTokens(N))}const j=t.createToken(T,R);u.push(j)}if(u.length!==0)return{items:u,raw:h}}function FC(n,t,e,r){if(!n||!Array.isArray(n.content))return"";const i=typeof e=="function"?e(r):e,[s,...o]=n.content,l=t.renderChildren([s]),u=[`${i}${l}`];return o&&o.length>0&&o.forEach(h=>{const d=t.renderChildren([h]);if(d){const m=d.split(`
`).map(g=>g?t.indent(g):"").join(`
`);u.push(m)}}),u.join(`
`)}function Gst(n,t,e={}){const{state:r}=t,{doc:i,tr:s}=r,o=n;i.descendants((l,u)=>{const h=s.mapping.map(u),d=s.mapping.map(u)+l.nodeSize;let m=null;if(l.marks.forEach(v=>{if(v!==o)return!1;m=v}),!m)return;let g=!1;if(Object.keys(e).forEach(v=>{e[v]!==m.attrs[v]&&(g=!0)}),g){const v=n.type.create({...n.attrs,...e});s.removeMark(h,d,n.type),s.addMark(h,d,v)}}),s.docChanged&&t.view.dispatch(s)}var ni=class LF extends VC{constructor(){super(...arguments),this.type="node"}static create(t={}){const e=typeof t=="function"?t():t;return new LF(e)}configure(t){return super.configure(t)}extend(t){const e=typeof t=="function"?t():t;return super.extend(e)}};function _l(n){return new kst({find:n.find,handler:({state:t,range:e,match:r,pasteEvent:i})=>{const s=pe(n.getAttributes,void 0,r,i);if(s===!1||s===null)return null;const{tr:o}=t,l=r[r.length-1],u=r[0];let h=e.to;if(l){const d=u.search(/\S/),m=e.from+u.indexOf(l),g=m+l.length;if(LC(e.from,e.to,t.doc).filter(T=>T.mark.type.excluded.find(w=>w===n.type&&w!==T.mark.type)).filter(T=>T.to>m).length)return null;g<e.to&&o.delete(g,e.to),m>e.from&&o.delete(e.from+d,m),h=e.from+d+l.length,o.addMark(e.from+d,h,n.type.create(s||{})),o.removeStoredMark(n.type)}}})}const{getOwnPropertyNames:Wst,getOwnPropertySymbols:Yst}=Object,{hasOwnProperty:Kst}=Object.prototype;function dw(n,t){return function(r,i,s){return n(r,i,s)&&t(r,i,s)}}function Sy(n){return function(e,r,i){if(!e||!r||typeof e!="object"||typeof r!="object")return n(e,r,i);const{cache:s}=i,o=s.get(e),l=s.get(r);if(o&&l)return o===r&&l===e;s.set(e,r),s.set(r,e);const u=n(e,r,i);return s.delete(e),s.delete(r),u}}function Xst(n){return n?.[Symbol.toStringTag]}function uP(n){return Wst(n).concat(Yst(n))}const Qst=Object.hasOwn||((n,t)=>Kst.call(n,t));function cu(n,t){return n===t||!n&&!t&&n!==n&&t!==t}const Jst="__v",Zst="__o",tot="_owner",{getOwnPropertyDescriptor:hP,keys:fP}=Object;function eot(n,t){return n.byteLength===t.byteLength&&yv(new Uint8Array(n),new Uint8Array(t))}function not(n,t,e){let r=n.length;if(t.length!==r)return!1;for(;r-- >0;)if(!e.equals(n[r],t[r],r,r,n,t,e))return!1;return!0}function rot(n,t){return n.byteLength===t.byteLength&&yv(new Uint8Array(n.buffer,n.byteOffset,n.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function iot(n,t){return cu(n.getTime(),t.getTime())}function sot(n,t){return n.name===t.name&&n.message===t.message&&n.cause===t.cause&&n.stack===t.stack}function oot(n,t){return n===t}function dP(n,t,e){const r=n.size;if(r!==t.size)return!1;if(!r)return!0;const i=new Array(r),s=n.entries();let o,l,u=0;for(;(o=s.next())&&!o.done;){const h=t.entries();let d=!1,m=0;for(;(l=h.next())&&!l.done;){if(i[m]){m++;continue}const g=o.value,v=l.value;if(e.equals(g[0],v[0],u,m,n,t,e)&&e.equals(g[1],v[1],g[0],v[0],n,t,e)){d=i[m]=!0;break}m++}if(!d)return!1;u++}return!0}const aot=cu;function lot(n,t,e){const r=fP(n);let i=r.length;if(fP(t).length!==i)return!1;for(;i-- >0;)if(!VF(n,t,e,r[i]))return!1;return!0}function Rd(n,t,e){const r=uP(n);let i=r.length;if(uP(t).length!==i)return!1;let s,o,l;for(;i-- >0;)if(s=r[i],!VF(n,t,e,s)||(o=hP(n,s),l=hP(t,s),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function cot(n,t){return cu(n.valueOf(),t.valueOf())}function uot(n,t){return n.source===t.source&&n.flags===t.flags}function pP(n,t,e){const r=n.size;if(r!==t.size)return!1;if(!r)return!0;const i=new Array(r),s=n.values();let o,l;for(;(o=s.next())&&!o.done;){const u=t.values();let h=!1,d=0;for(;(l=u.next())&&!l.done;){if(!i[d]&&e.equals(o.value,l.value,o.value,l.value,n,t,e)){h=i[d]=!0;break}d++}if(!h)return!1}return!0}function yv(n,t){let e=n.byteLength;if(t.byteLength!==e||n.byteOffset!==t.byteOffset)return!1;for(;e-- >0;)if(n[e]!==t[e])return!1;return!0}function hot(n,t){return n.hostname===t.hostname&&n.pathname===t.pathname&&n.protocol===t.protocol&&n.port===t.port&&n.hash===t.hash&&n.username===t.username&&n.password===t.password}function VF(n,t,e,r){return(r===tot||r===Zst||r===Jst)&&(n.$$typeof||t.$$typeof)?!0:Qst(t,r)&&e.equals(n[r],t[r],r,r,n,t,e)}const fot="[object ArrayBuffer]",dot="[object Arguments]",pot="[object Boolean]",mot="[object DataView]",got="[object Date]",yot="[object Error]",vot="[object Map]",bot="[object Number]",_ot="[object Object]",Tot="[object RegExp]",Sot="[object Set]",wot="[object String]",xot={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},Eot="[object URL]",Cot=Object.prototype.toString;function Aot({areArrayBuffersEqual:n,areArraysEqual:t,areDataViewsEqual:e,areDatesEqual:r,areErrorsEqual:i,areFunctionsEqual:s,areMapsEqual:o,areNumbersEqual:l,areObjectsEqual:u,arePrimitiveWrappersEqual:h,areRegExpsEqual:d,areSetsEqual:m,areTypedArraysEqual:g,areUrlsEqual:v,unknownTagComparators:T}){return function(w,E,R){if(w===E)return!0;if(w==null||E==null)return!1;const P=typeof w;if(P!==typeof E)return!1;if(P!=="object")return P==="number"?l(w,E,R):P==="function"?s(w,E,R):!1;const j=w.constructor;if(j!==E.constructor)return!1;if(j===Object)return u(w,E,R);if(Array.isArray(w))return t(w,E,R);if(j===Date)return r(w,E,R);if(j===RegExp)return d(w,E,R);if(j===Map)return o(w,E,R);if(j===Set)return m(w,E,R);const N=Cot.call(w);if(N===got)return r(w,E,R);if(N===Tot)return d(w,E,R);if(N===vot)return o(w,E,R);if(N===Sot)return m(w,E,R);if(N===_ot)return typeof w.then!="function"&&typeof E.then!="function"&&u(w,E,R);if(N===Eot)return v(w,E,R);if(N===yot)return i(w,E,R);if(N===dot)return u(w,E,R);if(xot[N])return g(w,E,R);if(N===fot)return n(w,E,R);if(N===mot)return e(w,E,R);if(N===pot||N===bot||N===wot)return h(w,E,R);if(T){let W=T[N];if(!W){const M=Xst(w);M&&(W=T[M])}if(W)return W(w,E,R)}return!1}}function kot({circular:n,createCustomConfig:t,strict:e}){let r={areArrayBuffersEqual:eot,areArraysEqual:e?Rd:not,areDataViewsEqual:rot,areDatesEqual:iot,areErrorsEqual:sot,areFunctionsEqual:oot,areMapsEqual:e?dw(dP,Rd):dP,areNumbersEqual:aot,areObjectsEqual:e?Rd:lot,arePrimitiveWrappersEqual:cot,areRegExpsEqual:uot,areSetsEqual:e?dw(pP,Rd):pP,areTypedArraysEqual:e?dw(yv,Rd):yv,areUrlsEqual:hot,unknownTagComparators:void 0};if(t&&(r=Object.assign({},r,t(r))),n){const i=Sy(r.areArraysEqual),s=Sy(r.areMapsEqual),o=Sy(r.areObjectsEqual),l=Sy(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:l})}return r}function Rot(n){return function(t,e,r,i,s,o,l){return n(t,e,l)}}function Mot({circular:n,comparator:t,createState:e,equals:r,strict:i}){if(e)return function(l,u){const{cache:h=n?new WeakMap:void 0,meta:d}=e();return t(l,u,{cache:h,equals:r,meta:d,strict:i})};if(n)return function(l,u){return t(l,u,{cache:new WeakMap,equals:r,meta:void 0,strict:i})};const s={cache:void 0,equals:r,meta:void 0,strict:i};return function(l,u){return t(l,u,s)}}const Dot=Nl();Nl({strict:!0});Nl({circular:!0});Nl({circular:!0,strict:!0});Nl({createInternalComparator:()=>cu});Nl({strict:!0,createInternalComparator:()=>cu});Nl({circular:!0,createInternalComparator:()=>cu});Nl({circular:!0,createInternalComparator:()=>cu,strict:!0});function Nl(n={}){const{circular:t=!1,createInternalComparator:e,createState:r,strict:i=!1}=n,s=kot(n),o=Aot(s),l=e?e(o):Rot(o);return Mot({circular:t,comparator:o,createState:r,equals:l,strict:i})}var pw={exports:{}},mw={};var mP;function Oot(){if(mP)return mw;mP=1;var n=Zp(),t=kB();function e(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var r=typeof Object.is=="function"?Object.is:e,i=t.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return mw.useSyncExternalStoreWithSelector=function(h,d,m,g,v){var T=s(null);if(T.current===null){var S={hasValue:!1,value:null};T.current=S}else S=T.current;T=l(function(){function E(W){if(!R){if(R=!0,P=W,W=g(W),v!==void 0&&S.hasValue){var M=S.value;if(v(M,W))return j=M}return j=W}if(M=j,r(P,W))return M;var k=g(W);return v!==void 0&&v(M,k)?(P=W,M):(P=W,j=k)}var R=!1,P,j,N=m===void 0?null:m;return[function(){return E(d())},N===null?void 0:function(){return E(N())}]},[d,m,g,v]);var w=i(h,T[0],T[1]);return o(function(){S.hasValue=!0,S.value=w},[w]),u(w),w},mw}var gP;function Iot(){return gP||(gP=1,pw.exports=Oot()),pw.exports}var Pot=Iot(),Not=(...n)=>t=>{n.forEach(e=>{typeof e=="function"?e(t):e&&(e.current=t)})},Lot=({contentComponent:n})=>{const t=RB.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot);return z.jsx(z.Fragment,{children:Object.values(t)})};function Vot(){const n=new Set;let t={};return{subscribe(e){return n.add(e),()=>{n.delete(e)}},getSnapshot(){return t},getServerSnapshot(){return t},setRenderer(e,r){t={...t,[e]:qH.createPortal(r.reactElement,r.element,e)},n.forEach(i=>i())},removeRenderer(e){const r={...t};delete r[e],t=r,n.forEach(i=>i())}}}var jot=class extends zc.Component{constructor(n){var t;super(n),this.editorContentRef=zc.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((t=n.editor)!=null&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var n;const t=this.props.editor;if(t&&!t.isDestroyed&&((n=t.view.dom)!=null&&n.parentNode)){if(t.contentComponent)return;const e=this.editorContentRef.current;e.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:e}),t.contentComponent=Vot(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var n;const t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!((n=t.view.dom)!=null&&n.parentNode))return;const e=document.createElement("div");e.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:e})}catch{}}}render(){const{editor:n,innerRef:t,...e}=this.props;return z.jsxs(z.Fragment,{children:[z.jsx("div",{ref:Not(t,this.editorContentRef),...e}),n?.contentComponent&&z.jsx(Lot,{contentComponent:n.contentComponent})]})}},Bot=L.forwardRef((n,t)=>{const e=zc.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return zc.createElement(jot,{key:e,innerRef:t,...n})}),jF=zc.memo(Bot),Fot=typeof window<"u"?L.useLayoutEffect:L.useEffect,Uot=class{constructor(n){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=n,this.lastSnapshot={editor:n,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(n){return this.subscribers.add(n),()=>{this.subscribers.delete(n)}}watch(n){if(this.editor=n,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},e=this.editor;return e.on("transaction",t),()=>{e.off("transaction",t)}}}};function zot(n){var t;const[e]=L.useState(()=>new Uot(n.editor)),r=Pot.useSyncExternalStoreWithSelector(e.subscribe,e.getSnapshot,e.getServerSnapshot,n.selector,(t=n.equalityFn)!=null?t:Dot);return Fot(()=>e.watch(n.editor),[n.editor,e]),L.useDebugValue(r),r}var Hot=!1,tE=typeof window>"u",$ot=tE||!!(typeof window<"u"&&window.next),qot=class BF{constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?tE||$ot?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const t={...this.options.current,onBeforeCreate:(...r)=>{var i,s;return(s=(i=this.options.current).onBeforeCreate)==null?void 0:s.call(i,...r)},onBlur:(...r)=>{var i,s;return(s=(i=this.options.current).onBlur)==null?void 0:s.call(i,...r)},onCreate:(...r)=>{var i,s;return(s=(i=this.options.current).onCreate)==null?void 0:s.call(i,...r)},onDestroy:(...r)=>{var i,s;return(s=(i=this.options.current).onDestroy)==null?void 0:s.call(i,...r)},onFocus:(...r)=>{var i,s;return(s=(i=this.options.current).onFocus)==null?void 0:s.call(i,...r)},onSelectionUpdate:(...r)=>{var i,s;return(s=(i=this.options.current).onSelectionUpdate)==null?void 0:s.call(i,...r)},onTransaction:(...r)=>{var i,s;return(s=(i=this.options.current).onTransaction)==null?void 0:s.call(i,...r)},onUpdate:(...r)=>{var i,s;return(s=(i=this.options.current).onUpdate)==null?void 0:s.call(i,...r)},onContentError:(...r)=>{var i,s;return(s=(i=this.options.current).onContentError)==null?void 0:s.call(i,...r)},onDrop:(...r)=>{var i,s;return(s=(i=this.options.current).onDrop)==null?void 0:s.call(i,...r)},onPaste:(...r)=>{var i,s;return(s=(i=this.options.current).onPaste)==null?void 0:s.call(i,...r)},onDelete:(...r)=>{var i,s;return(s=(i=this.options.current).onDelete)==null?void 0:s.call(i,...r)}};return new Vst(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}static compareOptions(t,e){return Object.keys(t).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&t.extensions&&e.extensions?t.extensions.length!==e.extensions.length?!1:t.extensions.every((i,s)=>{var o;return i===((o=e.extensions)==null?void 0:o[s])}):t[r]===e[r])}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&t.length===0?BF.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=t;return}if(this.previousDeps.length===t.length&&this.previousDeps.every((r,i)=>r===t[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,e=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===t){e&&e.setOptions(this.options.current);return}e&&!e.isDestroyed&&(e.destroy(),this.instanceId===t&&this.setEditor(null))},1)}};function Got(n={},t=[]){const e=L.useRef(n);e.current=n;const[r]=L.useState(()=>new qot(e)),i=RB.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return L.useDebugValue(i),L.useEffect(r.onRender(t)),zot({editor:i,selector:({transactionNumber:s})=>n.shouldRerenderOnTransaction===!1||n.shouldRerenderOnTransaction===void 0?null:n.immediatelyRender&&s===0?0:s+1}),i}var FF=L.createContext({editor:null});FF.Consumer;var Wot=L.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),Yot=()=>L.useContext(Wot);zc.forwardRef((n,t)=>{const{onDragStart:e}=Yot(),r=n.as||"div";return z.jsx(r,{...n,ref:t,"data-node-view-wrapper":"",onDragStart:e,style:{whiteSpace:"normal",...n.style}})});zc.createContext({markViewContentRef:()=>{}});var UC=L.createContext({get editor(){throw new Error("useTiptap must be used within a <Tiptap> provider")}});UC.displayName="TiptapContext";var Kot=()=>L.useContext(UC);function UF({editor:n,instance:t,children:e}){const r=n??t;if(!r)throw new Error("Tiptap: An editor instance is required. Pass a non-null `editor` prop.");const i=L.useMemo(()=>({editor:r}),[r]),s=L.useMemo(()=>({editor:r}),[r]);return z.jsx(FF.Provider,{value:s,children:z.jsx(UC.Provider,{value:i,children:e})})}UF.displayName="Tiptap";function zF({...n}){const{editor:t}=Kot();return z.jsx(jF,{editor:t,...n})}zF.displayName="Tiptap.Content";Object.assign(UF,{Content:zF});var vv=(n,t)=>{if(n==="slot")return 0;if(n instanceof Function)return n(t);const{children:e,...r}=t??{};if(n==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[n,r,e]},Xot=/^\s*>\s$/,Qot=ni.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return vv("blockquote",{...Xe(this.options.HTMLAttributes,n),children:vv("slot",{})})},parseMarkdown:(n,t)=>t.createNode("blockquote",void 0,t.parseChildren(n.tokens||[])),renderMarkdown:(n,t)=>{if(!n.content)return"";const e=">",r=[];return n.content.forEach(i=>{const l=t.renderChildren([i]).split(`
`).map(u=>u.trim()===""?e:`${e} ${u}`);r.push(l.join(`
`))}),r.join(`
${e}
`)},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[zh({find:Xot,type:this.type})]}}),Jot=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Zot=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,tat=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,eat=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,nat=Qo.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return vv("strong",{...Xe(this.options.HTMLAttributes,n),children:vv("slot",{})})},markdownTokenName:"strong",parseMarkdown:(n,t)=>t.applyMark("bold",t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>`**${t.renderChildren(n)}**`,addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[nu({find:Jot,type:this.type}),nu({find:tat,type:this.type})]},addPasteRules(){return[_l({find:Zot,type:this.type}),_l({find:eat,type:this.type})]}}),rat=/(^|[^`])`([^`]+)`(?!`)$/,iat=/(^|[^`])`([^`]+)`(?!`)/g,sat=Qo.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",Xe(this.options.HTMLAttributes,n),0]},markdownTokenName:"codespan",parseMarkdown:(n,t)=>t.applyMark("code",[{type:"text",text:n.text||""}]),renderMarkdown:(n,t)=>n.content?`\`${t.renderChildren(n.content)}\``:"",addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[nu({find:rat,type:this.type})]},addPasteRules(){return[_l({find:iat,type:this.type})]}}),gw=4,oat=/^```([a-z]+)?[\s\n]$/,aat=/^~~~([a-z]+)?[\s\n]$/,lat=ni.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:gw,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var t;const{languageClassPrefix:e}=this.options;if(!e)return null;const s=[...((t=n.firstElementChild)==null?void 0:t.classList)||[]].filter(o=>o.startsWith(e)).map(o=>o.replace(e,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:t}){return["pre",Xe(this.options.HTMLAttributes,t),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(n,t)=>{var e;return((e=n.raw)==null?void 0:e.startsWith("```"))===!1&&n.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:n.lang||null},n.text?[t.createTextNode(n.text)]:[])},renderMarkdown:(n,t)=>{var e;let r="";const i=((e=n.attrs)==null?void 0:e.language)||"";return n.content?r=[`\`\`\`${i}`,t.renderChildren(n.content),"```"].join(`
`):r=`\`\`\`${i}

\`\`\``,r},addCommands(){return{setCodeBlock:n=>({commands:t})=>t.setNode(this.name,n),toggleCodeBlock:n=>({commands:t})=>t.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:t}=this.editor.state.selection,e=t.pos===1;return!n||t.parent.type.name!==this.name?!1:e||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:n})=>{var t;if(!this.options.enableTabIndentation)return!1;const e=(t=this.options.tabSize)!=null?t:gw,{state:r}=n,{selection:i}=r,{$from:s,empty:o}=i;if(s.parent.type!==this.type)return!1;const l=" ".repeat(e);return o?n.commands.insertContent(l):n.commands.command(({tr:u})=>{const{from:h,to:d}=i,v=r.doc.textBetween(h,d,`
`,`
`).split(`
`).map(T=>l+T).join(`
`);return u.replaceWith(h,d,r.schema.text(v)),!0})},"Shift-Tab":({editor:n})=>{var t;if(!this.options.enableTabIndentation)return!1;const e=(t=this.options.tabSize)!=null?t:gw,{state:r}=n,{selection:i}=r,{$from:s,empty:o}=i;return s.parent.type!==this.type?!1:o?n.commands.command(({tr:l})=>{var u;const{pos:h}=s,d=s.start(),m=s.end(),v=r.doc.textBetween(d,m,`
`,`
`).split(`
`);let T=0,S=0;const w=h-d;for(let W=0;W<v.length;W+=1){if(S+v[W].length>=w){T=W;break}S+=v[W].length+1}const R=((u=v[T].match(/^ */))==null?void 0:u[0])||"",P=Math.min(R.length,e);if(P===0)return!0;let j=d;for(let W=0;W<T;W+=1)j+=v[W].length+1;return l.delete(j,j+P),h-j<=P&&l.setSelection(jt.create(l.doc,j)),!0}):n.commands.command(({tr:l})=>{const{from:u,to:h}=i,g=r.doc.textBetween(u,h,`
`,`
`).split(`
`).map(v=>{var T;const S=((T=v.match(/^ */))==null?void 0:T[0])||"",w=Math.min(S.length,e);return v.slice(w)}).join(`
`);return l.replaceWith(u,h,r.schema.text(g)),!0})},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=n,{selection:e}=t,{$from:r,empty:i}=e;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!s||!o?!1:n.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=n,{selection:e,doc:r}=t,{$from:i,empty:s}=e;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const l=i.after();return l===void 0?!1:r.nodeAt(l)?n.commands.command(({tr:h})=>(h.setSelection(Gt.near(r.resolve(l))),!0)):n.commands.exitCode()}}},addInputRules(){return[Jx({find:oat,type:this.type,getAttributes:n=>({language:n[1]})}),Jx({find:aat,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new ze({key:new Cn("codeBlockVSCodeHandler"),props:{handlePaste:(n,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const e=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=i?.mode;if(!e||!s)return!1;const{tr:o,schema:l}=n.state,u=l.text(e.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:s},u)),o.selection.$from.parent.type!==this.type&&o.setSelection(jt.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),cat=ni.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`

`):""}),uat=ni.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",Xe(this.options.HTMLAttributes,n)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:n,chain:t,state:e,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:s}=e;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=r.extensionManager,u=s||i.$to.parentOffset&&i.$from.marks();return t().insertContent({type:this.name}).command(({tr:h,dispatch:d})=>{if(d&&u&&o){const m=u.filter(g=>l.includes(g.type.name));h.ensureMarks(m)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),hat=ni.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:t}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,Xe(this.options.HTMLAttributes,t),0]},parseMarkdown:(n,t)=>t.createNode("heading",{level:n.depth||1},t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>{var e;const r=(e=n.attrs)!=null&&e.level?parseInt(n.attrs.level,10):1,i="#".repeat(r);return n.content?`${i} ${t.renderChildren(n.content)}`:""},addCommands(){return{setHeading:n=>({commands:t})=>this.options.levels.includes(n.level)?t.setNode(this.name,n):!1,toggleHeading:n=>({commands:t})=>this.options.levels.includes(n.level)?t.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,t)=>({...n,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(n=>Jx({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}}),fat=ni.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",Xe(this.options.HTMLAttributes,n)]},markdownTokenName:"hr",parseMarkdown:(n,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:n,state:t})=>{if(!Bst(t,t.schema.nodes[this.name]))return!1;const{selection:e}=t,{$to:r}=e,i=n();return bF(e)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:s,tr:o,dispatch:l})=>{if(l){const{$to:u}=o.selection,h=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?o.setSelection(jt.create(o.doc,u.pos+1)):u.nodeAfter.isBlock?o.setSelection(Mt.create(o.doc,u.pos)):o.setSelection(jt.create(o.doc,u.pos));else{const d=s.schema.nodes[this.options.nextNodeType]||u.parent.type.contentMatch.defaultType,m=d?.create();m&&(o.insert(h,m),o.setSelection(jt.create(o.doc,h+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[jst({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),dat=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,pat=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,mat=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,gat=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,yat=Qo.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",Xe(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(n,t)=>t.applyMark("italic",t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>`*${t.renderChildren(n)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[nu({find:dat,type:this.type}),nu({find:mat,type:this.type})]},addPasteRules(){return[_l({find:pat,type:this.type}),_l({find:gat,type:this.type})]}});const vat="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",bat="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",eE="numeric",nE="ascii",rE="alpha",cp="asciinumeric",$d="alphanumeric",iE="domain",HF="emoji",_at="scheme",Tat="slashscheme",yw="whitespace";function Sat(n,t){return n in t||(t[n]=[]),t[n]}function Mc(n,t,e){t[eE]&&(t[cp]=!0,t[$d]=!0),t[nE]&&(t[cp]=!0,t[rE]=!0),t[cp]&&(t[$d]=!0),t[rE]&&(t[$d]=!0),t[$d]&&(t[iE]=!0),t[HF]&&(t[iE]=!0);for(const r in t){const i=Sat(r,e);i.indexOf(n)<0&&i.push(n)}}function wat(n,t){const e={};for(const r in t)t[r].indexOf(n)>=0&&(e[r]=!0);return e}function Or(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}Or.groups={};Or.prototype={accepts(){return!!this.t},go(n){const t=this,e=t.j[n];if(e)return e;for(let r=0;r<t.jr.length;r++){const i=t.jr[r][0],s=t.jr[r][1];if(s&&i.test(n))return s}return t.jd},has(n,t=!1){return t?n in this.j:!!this.go(n)},ta(n,t,e,r){for(let i=0;i<n.length;i++)this.tt(n[i],t,e,r)},tr(n,t,e,r){r=r||Or.groups;let i;return t&&t.j?i=t:(i=new Or(t),e&&r&&Mc(t,e,r)),this.jr.push([n,i]),i},ts(n,t,e,r){let i=this;const s=n.length;if(!s)return i;for(let o=0;o<s-1;o++)i=i.tt(n[o]);return i.tt(n[s-1],t,e,r)},tt(n,t,e,r){r=r||Or.groups;const i=this;if(t&&t.j)return i.j[n]=t,t;const s=t;let o,l=i.go(n);if(l?(o=new Or,Object.assign(o.j,l.j),o.jr.push.apply(o.jr,l.jr),o.jd=l.jd,o.t=l.t):o=new Or,s){if(r)if(o.t&&typeof o.t=="string"){const u=Object.assign(wat(o.t,r),e);Mc(s,u,r)}else e&&Mc(s,e,r);o.t=s}return i.j[n]=o,o}};const qt=(n,t,e,r,i)=>n.ta(t,e,r,i),qe=(n,t,e,r,i)=>n.tr(t,e,r,i),yP=(n,t,e,r,i)=>n.ts(t,e,r,i),ft=(n,t,e,r,i)=>n.tt(t,e,r,i),wo="WORD",sE="UWORD",$F="ASCIINUMERICAL",qF="ALPHANUMERICAL",qp="LOCALHOST",oE="TLD",aE="UTLD",T0="SCHEME",lh="SLASH_SCHEME",zC="NUM",lE="WS",HC="NL",up="OPENBRACE",hp="CLOSEBRACE",bv="OPENBRACKET",_v="CLOSEBRACKET",Tv="OPENPAREN",Sv="CLOSEPAREN",wv="OPENANGLEBRACKET",xv="CLOSEANGLEBRACKET",Ev="FULLWIDTHLEFTPAREN",Cv="FULLWIDTHRIGHTPAREN",Av="LEFTCORNERBRACKET",kv="RIGHTCORNERBRACKET",Rv="LEFTWHITECORNERBRACKET",Mv="RIGHTWHITECORNERBRACKET",Dv="FULLWIDTHLESSTHAN",Ov="FULLWIDTHGREATERTHAN",Iv="AMPERSAND",Pv="APOSTROPHE",Nv="ASTERISK",Ua="AT",Lv="BACKSLASH",Vv="BACKTICK",jv="CARET",Ya="COLON",$C="COMMA",Bv="DOLLAR",Ds="DOT",Fv="EQUALS",qC="EXCLAMATION",bi="HYPHEN",fp="PERCENT",Uv="PIPE",zv="PLUS",Hv="POUND",dp="QUERY",GC="QUOTE",GF="FULLWIDTHMIDDLEDOT",WC="SEMI",Os="SLASH",pp="TILDE",$v="UNDERSCORE",WF="EMOJI",qv="SYM";var YF=Object.freeze({__proto__:null,ALPHANUMERICAL:qF,AMPERSAND:Iv,APOSTROPHE:Pv,ASCIINUMERICAL:$F,ASTERISK:Nv,AT:Ua,BACKSLASH:Lv,BACKTICK:Vv,CARET:jv,CLOSEANGLEBRACKET:xv,CLOSEBRACE:hp,CLOSEBRACKET:_v,CLOSEPAREN:Sv,COLON:Ya,COMMA:$C,DOLLAR:Bv,DOT:Ds,EMOJI:WF,EQUALS:Fv,EXCLAMATION:qC,FULLWIDTHGREATERTHAN:Ov,FULLWIDTHLEFTPAREN:Ev,FULLWIDTHLESSTHAN:Dv,FULLWIDTHMIDDLEDOT:GF,FULLWIDTHRIGHTPAREN:Cv,HYPHEN:bi,LEFTCORNERBRACKET:Av,LEFTWHITECORNERBRACKET:Rv,LOCALHOST:qp,NL:HC,NUM:zC,OPENANGLEBRACKET:wv,OPENBRACE:up,OPENBRACKET:bv,OPENPAREN:Tv,PERCENT:fp,PIPE:Uv,PLUS:zv,POUND:Hv,QUERY:dp,QUOTE:GC,RIGHTCORNERBRACKET:kv,RIGHTWHITECORNERBRACKET:Mv,SCHEME:T0,SEMI:WC,SLASH:Os,SLASH_SCHEME:lh,SYM:qv,TILDE:pp,TLD:oE,UNDERSCORE:$v,UTLD:aE,UWORD:sE,WORD:wo,WS:lE});const To=/[a-z]/,Md=new RegExp("\\p{L}","u"),vw=new RegExp("\\p{Emoji}","u"),So=/\d/,bw=/\s/,vP="\r",_w=`
`,xat="",Eat="",Tw="";let wy=null,xy=null;function Cat(n=[]){const t={};Or.groups=t;const e=new Or;wy==null&&(wy=bP(vat)),xy==null&&(xy=bP(bat)),ft(e,"'",Pv),ft(e,"{",up),ft(e,"}",hp),ft(e,"[",bv),ft(e,"]",_v),ft(e,"(",Tv),ft(e,")",Sv),ft(e,"<",wv),ft(e,">",xv),ft(e,"",Ev),ft(e,"",Cv),ft(e,"",Av),ft(e,"",kv),ft(e,"",Rv),ft(e,"",Mv),ft(e,"",Dv),ft(e,"",Ov),ft(e,"&",Iv),ft(e,"*",Nv),ft(e,"@",Ua),ft(e,"`",Vv),ft(e,"^",jv),ft(e,":",Ya),ft(e,",",$C),ft(e,"$",Bv),ft(e,".",Ds),ft(e,"=",Fv),ft(e,"!",qC),ft(e,"-",bi),ft(e,"%",fp),ft(e,"|",Uv),ft(e,"+",zv),ft(e,"#",Hv),ft(e,"?",dp),ft(e,'"',GC),ft(e,"/",Os),ft(e,";",WC),ft(e,"~",pp),ft(e,"_",$v),ft(e,"\\",Lv),ft(e,"",GF);const r=qe(e,So,zC,{[eE]:!0});qe(r,So,r);const i=qe(r,To,$F,{[cp]:!0}),s=qe(r,Md,qF,{[$d]:!0}),o=qe(e,To,wo,{[nE]:!0});qe(o,So,i),qe(o,To,o),qe(i,So,i),qe(i,To,i);const l=qe(e,Md,sE,{[rE]:!0});qe(l,To),qe(l,So,s),qe(l,Md,l),qe(s,So,s),qe(s,To),qe(s,Md,s);const u=ft(e,_w,HC,{[yw]:!0}),h=ft(e,vP,lE,{[yw]:!0}),d=qe(e,bw,lE,{[yw]:!0});ft(e,Tw,d),ft(h,_w,u),ft(h,Tw,d),qe(h,bw,d),ft(d,vP),ft(d,_w),qe(d,bw,d),ft(d,Tw,d);const m=qe(e,vw,WF,{[HF]:!0});ft(m,"#"),qe(m,vw,m),ft(m,xat,m);const g=ft(m,Eat);ft(g,"#"),qe(g,vw,m);const v=[[To,o],[So,i]],T=[[To,null],[Md,l],[So,s]];for(let S=0;S<wy.length;S++)Pa(e,wy[S],oE,wo,v);for(let S=0;S<xy.length;S++)Pa(e,xy[S],aE,sE,T);Mc(oE,{tld:!0,ascii:!0},t),Mc(aE,{utld:!0,alpha:!0},t),Pa(e,"file",T0,wo,v),Pa(e,"mailto",T0,wo,v),Pa(e,"http",lh,wo,v),Pa(e,"https",lh,wo,v),Pa(e,"ftp",lh,wo,v),Pa(e,"ftps",lh,wo,v),Mc(T0,{scheme:!0,ascii:!0},t),Mc(lh,{slashscheme:!0,ascii:!0},t),n=n.sort((S,w)=>S[0]>w[0]?1:-1);for(let S=0;S<n.length;S++){const w=n[S][0],R=n[S][1]?{[_at]:!0}:{[Tat]:!0};w.indexOf("-")>=0?R[iE]=!0:To.test(w)?So.test(w)?R[cp]=!0:R[nE]=!0:R[eE]=!0,yP(e,w,w,R)}return yP(e,"localhost",qp,{ascii:!0}),e.jd=new Or(qv),{start:e,tokens:Object.assign({groups:t},YF)}}function KF(n,t){const e=Aat(t.replace(/[A-Z]/g,l=>l.toLowerCase())),r=e.length,i=[];let s=0,o=0;for(;o<r;){let l=n,u=null,h=0,d=null,m=-1,g=-1;for(;o<r&&(u=l.go(e[o]));)l=u,l.accepts()?(m=0,g=0,d=l):m>=0&&(m+=e[o].length,g++),h+=e[o].length,s+=e[o].length,o++;s-=m,o-=g,h-=m,i.push({t:d.t,v:t.slice(s-h,s),s:s-h,e:s})}return i}function Aat(n){const t=[],e=n.length;let r=0;for(;r<e;){let i=n.charCodeAt(r),s,o=i<55296||i>56319||r+1===e||(s=n.charCodeAt(r+1))<56320||s>57343?n[r]:n.slice(r,r+2);t.push(o),r+=o.length}return t}function Pa(n,t,e,r,i){let s;const o=t.length;for(let l=0;l<o-1;l++){const u=t[l];n.j[u]?s=n.j[u]:(s=new Or(r),s.jr=i.slice(),n.j[u]=s),n=s}return s=new Or(e),s.jr=i.slice(),n.j[t[o-1]]=s,s}function bP(n){const t=[],e=[];let r=0,i="0123456789";for(;r<n.length;){let s=0;for(;i.indexOf(n[r+s])>=0;)s++;if(s>0){t.push(e.join(""));for(let o=parseInt(n.substring(r,r+s),10);o>0;o--)e.pop();r+=s}else e.push(n[r]),r++}return t}const Gp={defaultProtocol:"http",events:null,format:_P,formatHref:_P,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function YC(n,t=null){let e=Object.assign({},Gp);n&&(e=Object.assign(e,n instanceof YC?n.o:n));const r=e.ignoreTags,i=[];for(let s=0;s<r.length;s++)i.push(r[s].toUpperCase());this.o=e,t&&(this.defaultRender=t),this.ignoreTags=i}YC.prototype={o:Gp,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,t,e){const r=t!=null;let i=this.o[n];return i&&(typeof i=="object"?(i=e.t in i?i[e.t]:Gp[n],typeof i=="function"&&r&&(i=i(t,e))):typeof i=="function"&&r&&(i=i(t,e.t,e)),i)},getObj(n,t,e){let r=this.o[n];return typeof r=="function"&&t!=null&&(r=r(t,e.t,e)),r},render(n){const t=n.render(this);return(this.get("render",null,n)||this.defaultRender)(t,n.t,n)}};function _P(n){return n}function XF(n,t){this.t="token",this.v=n,this.tk=t}XF.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const t=this.toString(),e=n.get("truncate",t,this),r=n.get("format",t,this);return e&&r.length>e?r.substring(0,e)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=Gp.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const t=this,e=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",e,this),i=n.get("tagName",e,t),s=this.toFormattedString(n),o={},l=n.get("className",e,t),u=n.get("target",e,t),h=n.get("rel",e,t),d=n.getObj("attributes",e,t),m=n.getObj("events",e,t);return o.href=r,l&&(o.class=l),u&&(o.target=u),h&&(o.rel=h),d&&Object.assign(o,d),{tagName:i,attributes:o,content:s,eventListeners:m}}};function Jb(n,t){class e extends XF{constructor(i,s){super(i,s),this.t=n}}for(const r in t)e.prototype[r]=t[r];return e.t=n,e}const TP=Jb("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),SP=Jb("text"),kat=Jb("nl"),Ey=Jb("url",{isLink:!0,toHref(n=Gp.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==qp&&n[1].t===Ya}}),yi=n=>new Or(n);function Rat({groups:n}){const t=n.domain.concat([Iv,Nv,Ua,Lv,Vv,jv,Bv,Fv,bi,zC,fp,Uv,zv,Hv,Os,qv,pp,$v]),e=[Pv,Ya,$C,Ds,qC,fp,dp,GC,WC,wv,xv,up,hp,_v,bv,Tv,Sv,Ev,Cv,Av,kv,Rv,Mv,Dv,Ov],r=[Iv,Pv,Nv,Lv,Vv,jv,Bv,Fv,bi,up,hp,fp,Uv,zv,Hv,dp,Os,qv,pp,$v],i=yi(),s=ft(i,pp);qt(s,r,s),qt(s,n.domain,s);const o=yi(),l=yi(),u=yi();qt(i,n.domain,o),qt(i,n.scheme,l),qt(i,n.slashscheme,u),qt(o,r,s),qt(o,n.domain,o);const h=ft(o,Ua);ft(s,Ua,h),ft(l,Ua,h),ft(u,Ua,h);const d=ft(s,Ds);qt(d,r,s),qt(d,n.domain,s);const m=yi();qt(h,n.domain,m),qt(m,n.domain,m);const g=ft(m,Ds);qt(g,n.domain,m);const v=yi(TP);qt(g,n.tld,v),qt(g,n.utld,v),ft(h,qp,v);const T=ft(m,bi);ft(T,bi,T),qt(T,n.domain,m),qt(v,n.domain,m),ft(v,Ds,g),ft(v,bi,T);const S=ft(v,Ya);qt(S,n.numeric,TP);const w=ft(o,bi),E=ft(o,Ds);ft(w,bi,w),qt(w,n.domain,o),qt(E,r,s),qt(E,n.domain,o);const R=yi(Ey);qt(E,n.tld,R),qt(E,n.utld,R),qt(R,n.domain,o),qt(R,r,s),ft(R,Ds,E),ft(R,bi,w),ft(R,Ua,h);const P=ft(R,Ya),j=yi(Ey);qt(P,n.numeric,j);const N=yi(Ey),W=yi();qt(N,t,N),qt(N,e,W),qt(W,t,N),qt(W,e,W),ft(R,Os,N),ft(j,Os,N);const M=ft(l,Ya),k=ft(u,Ya),O=ft(k,Os),B=ft(O,Os);qt(l,n.domain,o),ft(l,Ds,E),ft(l,bi,w),qt(u,n.domain,o),ft(u,Ds,E),ft(u,bi,w),qt(M,n.domain,N),ft(M,Os,N),ft(M,dp,N),qt(B,n.domain,N),qt(B,t,N),ft(B,Os,N);const F=[[up,hp],[bv,_v],[Tv,Sv],[wv,xv],[Ev,Cv],[Av,kv],[Rv,Mv],[Dv,Ov]];for(let H=0;H<F.length;H++){const[V,yt]=F[H],xt=ft(N,V);ft(W,V,xt),ft(xt,yt,N);const J=yi(Ey);qt(xt,t,J);const st=yi();qt(xt,e),qt(J,t,J),qt(J,e,st),qt(st,t,J),qt(st,e,st),ft(J,yt,N),ft(st,yt,N)}return ft(i,qp,R),ft(i,HC,kat),{start:i,tokens:YF}}function Mat(n,t,e){let r=e.length,i=0,s=[],o=[];for(;i<r;){let l=n,u=null,h=null,d=0,m=null,g=-1;for(;i<r&&!(u=l.go(e[i].t));)o.push(e[i++]);for(;i<r&&(h=u||l.go(e[i].t));)u=null,l=h,l.accepts()?(g=0,m=l):g>=0&&g++,i++,d++;if(g<0)i-=d,i<r&&(o.push(e[i]),i++);else{o.length>0&&(s.push(Sw(SP,t,o)),o=[]),i-=g,d-=g;const v=m.t,T=e.slice(i-d,i);s.push(Sw(v,t,T))}}return o.length>0&&s.push(Sw(SP,t,o)),s}function Sw(n,t,e){const r=e[0].s,i=e[e.length-1].e,s=t.slice(r,i);return new n(s,e)}const Dat=typeof console<"u"&&console&&console.warn||(()=>{}),Oat="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Oe={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Iat(){return Or.groups={},Oe.scanner=null,Oe.parser=null,Oe.tokenQueue=[],Oe.pluginQueue=[],Oe.customSchemes=[],Oe.initialized=!1,Oe}function wP(n,t=!1){if(Oe.initialized&&Dat(`linkifyjs: already initialized - will not register custom scheme "${n}" ${Oat}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Oe.customSchemes.push([n,t])}function Pat(){Oe.scanner=Cat(Oe.customSchemes);for(let n=0;n<Oe.tokenQueue.length;n++)Oe.tokenQueue[n][1]({scanner:Oe.scanner});Oe.parser=Rat(Oe.scanner.tokens);for(let n=0;n<Oe.pluginQueue.length;n++)Oe.pluginQueue[n][1]({scanner:Oe.scanner,parser:Oe.parser});return Oe.initialized=!0,Oe}function KC(n){return Oe.initialized||Pat(),Mat(Oe.parser.start,n,KF(Oe.scanner.start,n))}KC.scan=KF;function QF(n,t=null,e=null){if(t&&typeof t=="object"){if(e)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);e=t,t=null}const r=new YC(e),i=KC(n),s=[];for(let o=0;o<i.length;o++){const l=i[o];l.isLink&&(!t||l.t===t)&&r.check(l)&&s.push(l.toFormattedObject(r))}return s}var XC="[\0- -\u2029]",Nat=new RegExp(XC),Lat=new RegExp(`${XC}$`),Vat=new RegExp(XC,"g");function jat(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function Bat(n){return new ze({key:new Cn("autolink"),appendTransaction:(t,e,r)=>{const i=t.some(h=>h.docChanged)&&!e.doc.eq(r.doc),s=t.some(h=>h.getMeta("preventAutolink"));if(!i||s)return;const{tr:o}=r,l=hF(e.doc,[...t]);if(vF(l).forEach(({newRange:h})=>{const d=Bit(r.doc,h,v=>v.isTextblock);let m,g;if(d.length>1)m=d[0],g=r.doc.textBetween(m.pos,m.pos+m.node.nodeSize,void 0," ");else if(d.length){const v=r.doc.textBetween(h.from,h.to," "," ");if(!Lat.test(v))return;m=d[0],g=r.doc.textBetween(m.pos,h.to,void 0," ")}if(m&&g){const v=g.split(Nat).filter(Boolean);if(v.length<=0)return!1;const T=v[v.length-1],S=m.pos+g.lastIndexOf(T);if(!T)return!1;const w=KC(T).map(E=>E.toObject(n.defaultProtocol));if(!jat(w))return!1;w.filter(E=>E.isLink).map(E=>({...E,from:S+E.start+1,to:S+E.end+1})).filter(E=>r.schema.marks.code?!r.doc.rangeHasMark(E.from,E.to,r.schema.marks.code):!0).filter(E=>n.validate(E.value)).filter(E=>n.shouldAutoLink(E.value)).forEach(E=>{LC(E.from,E.to,r.doc).some(R=>R.mark.type===n.type)||o.addMark(E.from,E.to,n.type.create({href:E.href}))})}}),!!o.steps.length)return o}})}function Fat(n){return new ze({key:new Cn("handleClickLink"),props:{handleClick:(t,e,r)=>{var i,s;if(r.button!==0||!t.editable)return!1;let o=null;if(r.target instanceof HTMLAnchorElement)o=r.target;else{const u=r.target;if(!u)return!1;const h=n.editor.view.dom;o=u.closest("a"),o&&!h.contains(o)&&(o=null)}if(!o)return!1;let l=!1;if(n.enableClickSelection&&(l=n.editor.commands.extendMarkRange(n.type.name)),n.openOnClick){const u=yF(t.state,n.type.name),h=(i=o.href)!=null?i:u.href,d=(s=o.target)!=null?s:u.target;h&&(window.open(h,d),l=!0)}return l}}})}function Uat(n){return new ze({key:new Cn("handlePasteLink"),props:{handlePaste:(t,e,r)=>{const{shouldAutoLink:i}=n,{state:s}=t,{selection:o}=s,{empty:l}=o;if(l)return!1;let u="";r.content.forEach(d=>{u+=d.textContent});const h=QF(u,{defaultProtocol:n.defaultProtocol}).find(d=>d.isLink&&d.value===u);return!u||!h||i!==void 0&&!i(h.value)?!1:n.editor.commands.setMark(n.type,{href:h.href})}}})}function pc(n,t){const e=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(r=>{const i=typeof r=="string"?r:r.scheme;i&&e.push(i)}),!n||n.replace(Vat,"").match(new RegExp(`^(?:(?:${e.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var zat=Qo.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(n=>{if(typeof n=="string"){wP(n);return}wP(n.scheme,n.optionalSlashes)})},onDestroy(){Iat()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(n,t)=>!!pc(n,t.protocols),validate:n=>!!n,shouldAutoLink:n=>{const t=/^[a-z][a-z0-9+.-]*:\/\//i.test(n),e=/^[a-z][a-z0-9+.-]*:/i.test(n);if(t||e&&!n.includes("@"))return!0;const i=(n.includes("@")?n.split("@").pop():n).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(n){return n.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:n=>{const t=n.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:e=>!!pc(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:n}){return this.options.isAllowedUri(n.href,{defaultValidate:t=>!!pc(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Xe(this.options.HTMLAttributes,n),0]:["a",Xe(this.options.HTMLAttributes,{...n,href:""}),0]},markdownTokenName:"link",parseMarkdown:(n,t)=>t.applyMark("link",t.parseInline(n.tokens||[]),{href:n.href,title:n.title||null}),renderMarkdown:(n,t)=>{var e,r,i,s;const o=(r=(e=n.attrs)==null?void 0:e.href)!=null?r:"",l=(s=(i=n.attrs)==null?void 0:i.title)!=null?s:"",u=t.renderChildren(n);return l?`[${u}](${o} "${l}")`:`[${u}](${o})`},addCommands(){return{setLink:n=>({chain:t})=>{const{href:e}=n;return this.options.isAllowedUri(e,{defaultValidate:r=>!!pc(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,n).setMeta("preventAutolink",!0).run():!1},toggleLink:n=>({chain:t})=>{const{href:e}=n||{};return e&&!this.options.isAllowedUri(e,{defaultValidate:r=>!!pc(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[_l({find:n=>{const t=[];if(n){const{protocols:e,defaultProtocol:r}=this.options,i=QF(n).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:o=>!!pc(o,e),protocols:e,defaultProtocol:r}));i.length&&i.forEach(s=>{this.options.shouldAutoLink(s.value)&&t.push({text:s.value,data:{href:s.href},index:s.start})})}return t},type:this.type,getAttributes:n=>{var t;return{href:(t=n.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){const n=[],{protocols:t,defaultProtocol:e}=this.options;return this.options.autolink&&n.push(Bat({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:i=>!!pc(i,t),protocols:t,defaultProtocol:e}),shouldAutoLink:this.options.shouldAutoLink})),n.push(Fat({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&n.push(Uat({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),n}}),Hat=Object.defineProperty,$at=(n,t)=>{for(var e in t)Hat(n,e,{get:t[e],enumerable:!0})},qat="listItem",xP="textStyle",EP=/^\s*([-+*])\s$/,JF=ni.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",Xe(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,t)=>n.type!=="list"||n.ordered?[]:{type:"bulletList",content:n.items?t.parseChildren(n.items):[]},renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:n,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(qat,this.editor.getAttributes(xP)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=zh({find:EP,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=zh({find:EP,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(xP),editor:this.editor})),[n]}}),ZF=ni.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",Xe(this.options.HTMLAttributes,n),0]},markdownTokenName:"list_item",parseMarkdown:(n,t)=>{if(n.type!=="list_item")return[];let e=[];if(n.tokens&&n.tokens.length>0)if(n.tokens.some(i=>i.type==="paragraph"))e=t.parseChildren(n.tokens);else{const i=n.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(e=[{type:"paragraph",content:t.parseInline(i.tokens)}],n.tokens.length>1){const o=n.tokens.slice(1),l=t.parseChildren(o);e.push(...l)}}else e=t.parseChildren(n.tokens)}return e.length===0&&(e=[{type:"paragraph",content:[]}]),{type:"listItem",content:e}},renderMarkdown:(n,t,e)=>FC(n,t,r=>{var i,s;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((s=(i=r.meta)==null?void 0:i.parentAttrs)==null?void 0:s.start)||1)+r.index}. `:"- "},e),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Gat={};$at(Gat,{findListItemPos:()=>wm,getNextListDepth:()=>QC,handleBackspace:()=>cE,handleDelete:()=>uE,hasListBefore:()=>t5,hasListItemAfter:()=>Wat,hasListItemBefore:()=>e5,listItemHasSubList:()=>n5,nextListIsDeeper:()=>r5,nextListIsHigher:()=>i5});var wm=(n,t)=>{const{$from:e}=t.selection,r=_n(n,t.schema);let i=null,s=e.depth,o=e.pos,l=null;for(;s>0&&l===null;)i=e.node(s),i.type===r?l=s:(s-=1,o-=1);return l===null?null:{$pos:t.doc.resolve(o),depth:l}},QC=(n,t)=>{const e=wm(n,t);if(!e)return!1;const[,r]=Kit(t,n,e.$pos.pos+4);return r},t5=(n,t,e)=>{const{$anchor:r}=n.selection,i=Math.max(0,r.pos-2),s=n.doc.resolve(i).node();return!(!s||!e.includes(s.type.name))},e5=(n,t)=>{var e;const{$anchor:r}=t.selection,i=t.doc.resolve(r.pos-2);return!(i.index()===0||((e=i.nodeBefore)==null?void 0:e.type.name)!==n)},n5=(n,t,e)=>{if(!e)return!1;const r=_n(n,t.schema);let i=!1;return e.descendants(s=>{s.type===r&&(i=!0)}),i},cE=(n,t,e)=>{if(n.commands.undoInputRule())return!0;if(n.state.selection.from!==n.state.selection.to)return!1;if(!bl(n.state,t)&&t5(n.state,t,e)){const{$anchor:l}=n.state.selection,u=n.state.doc.resolve(l.before()-1),h=[];u.node().descendants((g,v)=>{g.type.name===t&&h.push({node:g,pos:v})});const d=h.at(-1);if(!d)return!1;const m=n.state.doc.resolve(u.start()+d.pos+1);return n.chain().cut({from:l.start()-1,to:l.end()+1},m.end()).joinForward().run()}if(!bl(n.state,t)||!Zit(n.state))return!1;const r=wm(t,n.state);if(!r)return!1;const s=n.state.doc.resolve(r.$pos.pos-2).node(r.depth),o=n5(t,n.state,s);return e5(t,n.state)&&!o?n.commands.joinItemBackward():n.chain().liftListItem(t).run()},r5=(n,t)=>{const e=QC(n,t),r=wm(n,t);return!r||!e?!1:e>r.depth},i5=(n,t)=>{const e=QC(n,t),r=wm(n,t);return!r||!e?!1:e<r.depth},uE=(n,t)=>{if(!bl(n.state,t)||!Jit(n.state,t))return!1;const{selection:e}=n.state,{$from:r,$to:i}=e;return!e.empty&&r.sameParent(i)?!1:r5(t,n.state)?n.chain().focus(n.state.selection.from+4).lift(t).joinBackward().run():i5(t,n.state)?n.chain().joinForward().joinBackward().run():n.commands.joinItemForward()},Wat=(n,t)=>{var e;const{$anchor:r}=t.selection,i=t.doc.resolve(r.pos-r.parentOffset-2);return!(i.index()===i.parent.childCount-1||((e=i.nodeAfter)==null?void 0:e.type.name)!==n)},s5=Ce.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e})=>{n.state.schema.nodes[e]!==void 0&&uE(n,e)&&(t=!0)}),t},"Mod-Delete":({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e})=>{n.state.schema.nodes[e]!==void 0&&uE(n,e)&&(t=!0)}),t},Backspace:({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e,wrapperNames:r})=>{n.state.schema.nodes[e]!==void 0&&cE(n,e,r)&&(t=!0)}),t},"Mod-Backspace":({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e,wrapperNames:r})=>{n.state.schema.nodes[e]!==void 0&&cE(n,e,r)&&(t=!0)}),t}}}}),CP=/^(\s*)(\d+)\.\s+(.*)$/,Yat=/^\s/;function Kat(n){const t=[];let e=0,r=0;for(;e<n.length;){const i=n[e],s=i.match(CP);if(!s)break;const[,o,l,u]=s,h=o.length;let d=u,m=e+1;const g=[i];for(;m<n.length;){const v=n[m];if(v.match(CP))break;if(v.trim()==="")g.push(v),d+=`
`,m+=1;else if(v.match(Yat))g.push(v),d+=`
${v.slice(h+2)}`,m+=1;else break}t.push({indent:h,number:parseInt(l,10),content:d.trim(),raw:g.join(`
`)}),r=m,e=m}return[t,r]}function o5(n,t,e){var r;const i=[];let s=0;for(;s<n.length;){const o=n[s];if(o.indent===t){const l=o.content.split(`
`),u=((r=l[0])==null?void 0:r.trim())||"",h=[];u&&h.push({type:"paragraph",raw:u,tokens:e.inlineTokens(u)});const d=l.slice(1).join(`
`).trim();if(d){const v=e.blockTokens(d);h.push(...v)}let m=s+1;const g=[];for(;m<n.length&&n[m].indent>t;)g.push(n[m]),m+=1;if(g.length>0){const v=Math.min(...g.map(S=>S.indent)),T=o5(g,v,e);h.push({type:"list",ordered:!0,start:g[0].number,items:T,raw:g.map(S=>S.raw).join(`
`)})}i.push({type:"list_item",raw:o.raw,tokens:h}),s=m}else s+=1}return i}function Xat(n,t){return n.map(e=>{if(e.type!=="list_item")return t.parseChildren([e])[0];const r=[];return e.tokens&&e.tokens.length>0&&e.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")r.push(...t.parseChildren([i]));else if(i.type==="text"&&i.tokens){const s=t.parseChildren([i]);r.push({type:"paragraph",content:s})}else{const s=t.parseChildren([i]);s.length>0&&r.push(...s)}}),{type:"listItem",content:r}})}var Qat="listItem",AP="textStyle",kP=/^(\d+)\.\s$/,a5=ni.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:t,...e}=n;return t===1?["ol",Xe(this.options.HTMLAttributes,e),0]:["ol",Xe(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,t)=>{if(n.type!=="list"||!n.ordered)return[];const e=n.start||1,r=n.items?Xat(n.items,t):[];return e!==1?{type:"orderedList",attrs:{start:e},content:r}:{type:"orderedList",content:r}},renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:n=>{const t=n.match(/^(\s*)(\d+)\.\s+/),e=t?.index;return e!==void 0?e:-1},tokenize:(n,t,e)=>{var r;const i=n.split(`
`),[s,o]=Kat(i);if(s.length===0)return;const l=o5(s,0,e);return l.length===0?void 0:{type:"list",ordered:!0,start:((r=s[0])==null?void 0:r.number)||1,items:l,raw:i.slice(0,o).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Qat,this.editor.getAttributes(AP)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=zh({find:kP,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=zh({find:kP,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(AP)}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1],editor:this.editor})),[n]}}),Jat=/^\s*(\[([( |x])?\])\s$/,Zat=ni.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:n=>{const t=n.getAttribute("data-checked");return t===""||t==="true"},renderHTML:n=>({"data-checked":n.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:n,HTMLAttributes:t}){return["li",Xe(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:n.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(n,t)=>{const e=[];if(n.tokens&&n.tokens.length>0?e.push(t.createNode("paragraph",{},t.parseInline(n.tokens))):n.text?e.push(t.createNode("paragraph",{},[t.createNode("text",{text:n.text})])):e.push(t.createNode("paragraph",{},[])),n.nestedTokens&&n.nestedTokens.length>0){const r=t.parseChildren(n.nestedTokens);e.push(...r)}return t.createNode("taskItem",{checked:n.checked||!1},e)},renderMarkdown:(n,t)=>{var e;const i=`- [${(e=n.attrs)!=null&&e.checked?"x":" "}] `;return FC(n,t,i)},addKeyboardShortcuts(){const n={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...n,Tab:()=>this.editor.commands.sinkListItem(this.name)}:n},addNodeView(){return({node:n,HTMLAttributes:t,getPos:e,editor:r})=>{const i=document.createElement("li"),s=document.createElement("label"),o=document.createElement("span"),l=document.createElement("input"),u=document.createElement("div"),h=m=>{var g,v;l.ariaLabel=((v=(g=this.options.a11y)==null?void 0:g.checkboxLabel)==null?void 0:v.call(g,m,l.checked))||`Task item checkbox for ${m.textContent||"empty task item"}`};h(n),s.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",m=>m.preventDefault()),l.addEventListener("change",m=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:g}=m.target;r.isEditable&&typeof e=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:v})=>{const T=e();if(typeof T!="number")return!1;const S=v.doc.nodeAt(T);return v.setNodeMarkup(T,void 0,{...S?.attrs,checked:g}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(n,g)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([m,g])=>{i.setAttribute(m,g)}),i.dataset.checked=n.attrs.checked,l.checked=n.attrs.checked,s.append(l,o),i.append(s,u),Object.entries(t).forEach(([m,g])=>{i.setAttribute(m,g)});let d=new Set(Object.keys(t));return{dom:i,contentDOM:u,update:m=>{if(m.type!==this.type)return!1;i.dataset.checked=m.attrs.checked,l.checked=m.attrs.checked,h(m);const g=r.extensionManager.attributes,v=$p(m,g),T=new Set(Object.keys(v)),S=this.options.HTMLAttributes;return d.forEach(w=>{T.has(w)||(w in S?i.setAttribute(w,S[w]):i.removeAttribute(w))}),Object.entries(v).forEach(([w,E])=>{E==null?w in S?i.setAttribute(w,S[w]):i.removeAttribute(w):i.setAttribute(w,E)}),d=T,!0}}}},addInputRules(){return[zh({find:Jat,type:this.type,getAttributes:n=>({checked:n[n.length-1]==="x"})})]}}),tlt=ni.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:n}){return["ul",Xe(this.options.HTMLAttributes,n,{"data-type":this.name}),0]},parseMarkdown:(n,t)=>t.createNode("taskList",{},t.parseChildren(n.items||[])),renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(n){var t;const e=(t=n.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return e!==void 0?e:-1},tokenize(n,t,e){const r=s=>{const o=Zx(s,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:l=>({indentLevel:l[1].length,mainContent:l[4],checked:l[3].toLowerCase()==="x"}),createToken:(l,u)=>({type:"taskItem",raw:"",mainContent:l.mainContent,indentLevel:l.indentLevel,checked:l.checked,text:l.mainContent,tokens:e.inlineTokens(l.mainContent),nestedTokens:u}),customNestedParser:r},e);return o?[{type:"taskList",raw:o.raw,items:o.items}]:e.blockTokens(s)},i=Zx(n,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:s=>({indentLevel:s[1].length,mainContent:s[4],checked:s[3].toLowerCase()==="x"}),createToken:(s,o)=>({type:"taskItem",raw:"",mainContent:s.mainContent,indentLevel:s.indentLevel,checked:s.checked,text:s.mainContent,tokens:e.inlineTokens(s.mainContent),nestedTokens:o}),customNestedParser:r},e);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Ce.create({name:"listKit",addExtensions(){const n=[];return this.options.bulletList!==!1&&n.push(JF.configure(this.options.bulletList)),this.options.listItem!==!1&&n.push(ZF.configure(this.options.listItem)),this.options.listKeymap!==!1&&n.push(s5.configure(this.options.listKeymap)),this.options.orderedList!==!1&&n.push(a5.configure(this.options.orderedList)),this.options.taskItem!==!1&&n.push(Zat.configure(this.options.taskItem)),this.options.taskList!==!1&&n.push(tlt.configure(this.options.taskList)),n}});var RP="&nbsp;",elt="",nlt=ni.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",Xe(this.options.HTMLAttributes,n),0]},parseMarkdown:(n,t)=>{const e=n.tokens||[];if(e.length===1&&e[0].type==="image")return t.parseChildren([e[0]]);const r=t.parseInline(e);return r.length===1&&r[0].type==="text"&&(r[0].text===RP||r[0].text===elt)?t.createNode("paragraph",void 0,[]):t.createNode("paragraph",void 0,r)},renderMarkdown:(n,t)=>{if(!n)return"";const e=Array.isArray(n.content)?n.content:[];return e.length===0?RP:t.renderChildren(e)},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),rlt=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,ilt=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,slt=Qo.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",Xe(this.options.HTMLAttributes,n),0]},markdownTokenName:"del",parseMarkdown:(n,t)=>t.applyMark("strike",t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>`~~${t.renderChildren(n)}~~`,addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[nu({find:rlt,type:this.type})]},addPasteRules(){return[_l({find:ilt,type:this.type})]}}),olt=ni.create({name:"text",group:"inline",parseMarkdown:n=>({type:"text",text:n.text||""}),renderMarkdown:n=>n.text||""}),alt=Qo.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",Xe(this.options.HTMLAttributes,n),0]},parseMarkdown(n,t){return t.applyMark(this.name||"underline",t.parseInline(n.tokens||[]))},renderMarkdown(n,t){return`++${t.renderChildren(n)}++`},markdownTokenizer:{name:"underline",level:"inline",start(n){return n.indexOf("++")},tokenize(n,t,e){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(n);if(!i)return;const s=i[2].trim();return{type:"underline",raw:i[0],text:s,tokens:e.inlineTokens(s)}}},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function llt(n={}){return new ze({view(t){return new clt(t,n)}})}class clt{constructor(t,e){var r;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=e.width)!==null&&r!==void 0?r:1,this.color=e.color===!1?void 0:e.color||"black",this.class=e.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=o=>{this[i](o)};return t.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:t,handler:e})=>this.editorView.dom.removeEventListener(t,e))}update(t,e){this.cursorPos!=null&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),e=!t.parent.inlineContent,r,i=this.editorView.dom,s=i.getBoundingClientRect(),o=s.width/i.offsetWidth,l=s.height/i.offsetHeight;if(e){let m=t.nodeBefore,g=t.nodeAfter;if(m||g){let v=this.editorView.nodeDOM(this.cursorPos-(m?m.nodeSize:0));if(v){let T=v.getBoundingClientRect(),S=m?T.bottom:T.top;m&&g&&(S=(S+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*l;r={left:T.left,right:T.right,top:S-w,bottom:S+w}}}}if(!r){let m=this.editorView.coordsAtPos(this.cursorPos),g=this.width/2*o;r={left:m.left-g,right:m.left+g,top:m.top,bottom:m.bottom}}let u=this.editorView.dom.offsetParent;this.element||(this.element=u.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",e),this.element.classList.toggle("prosemirror-dropcursor-inline",!e);let h,d;if(!u||u==document.body&&getComputedStyle(u).position=="static")h=-pageXOffset,d=-pageYOffset;else{let m=u.getBoundingClientRect(),g=m.width/u.offsetWidth,v=m.height/u.offsetHeight;h=m.left-u.scrollLeft*g,d=m.top-u.scrollTop*v}this.element.style.left=(r.left-h)/o+"px",this.element.style.top=(r.top-d)/l+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),r=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,e,t):i;if(e&&!s){let o=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=n4(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}class We extends Gt{constructor(t){super(t,t)}map(t,e){let r=t.resolve(e.map(this.head));return We.valid(r)?new We(r):Gt.near(r)}content(){return vt.empty}eq(t){return t instanceof We&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new We(t.resolve(e.pos))}getBookmark(){return new JC(this.anchor)}static valid(t){let e=t.parent;if(e.isTextblock||!ult(t)||!hlt(t))return!1;let r=e.type.spec.allowGapCursor;if(r!=null)return r;let i=e.contentMatchAt(t.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(t,e,r=!1){t:for(;;){if(!r&&We.valid(t))return t;let i=t.pos,s=null;for(let o=t.depth;;o--){let l=t.node(o);if(e>0?t.indexAfter(o)<l.childCount:t.index(o)>0){s=l.child(e>0?t.indexAfter(o):t.index(o)-1);break}else if(o==0)return null;i+=e;let u=t.doc.resolve(i);if(We.valid(u))return u}for(;;){let o=e>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!Mt.isSelectable(s)){t=t.doc.resolve(i+s.nodeSize*e),r=!1;continue t}break}s=o,i+=e;let l=t.doc.resolve(i);if(We.valid(l))return l}return null}}}We.prototype.visible=!1;We.findFrom=We.findGapCursorFrom;Gt.jsonID("gapcursor",We);class JC{constructor(t){this.pos=t}map(t){return new JC(t.map(this.pos))}resolve(t){let e=t.resolve(this.pos);return We.valid(e)?new We(e):Gt.near(e)}}function l5(n){return n.isAtom||n.spec.isolating||n.spec.createGapCursor}function ult(n){for(let t=n.depth;t>=0;t--){let e=n.index(t),r=n.node(t);if(e==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(e-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||l5(i.type))return!0;if(i.inlineContent)return!1}}return!0}function hlt(n){for(let t=n.depth;t>=0;t--){let e=n.indexAfter(t),r=n.node(t);if(e==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(e);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||l5(i.type))return!0;if(i.inlineContent)return!1}}return!0}function flt(){return new ze({props:{decorations:glt,createSelectionBetween(n,t,e){return t.pos==e.pos&&We.valid(e)?new We(e):null},handleClick:plt,handleKeyDown:dlt,handleDOMEvents:{beforeinput:mlt}}})}const dlt=rF({ArrowLeft:Cy("horiz",-1),ArrowRight:Cy("horiz",1),ArrowUp:Cy("vert",-1),ArrowDown:Cy("vert",1)});function Cy(n,t){const e=n=="vert"?t>0?"down":"up":t>0?"right":"left";return function(r,i,s){let o=r.selection,l=t>0?o.$to:o.$from,u=o.empty;if(o instanceof jt){if(!s.endOfTextblock(e)||l.depth==0)return!1;u=!1,l=r.doc.resolve(t>0?l.after():l.before())}let h=We.findGapCursorFrom(l,t,u);return h?(i&&i(r.tr.setSelection(new We(h))),!0):!1}}function plt(n,t,e){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(t);if(!We.valid(r))return!1;let i=n.posAtCoords({left:e.clientX,top:e.clientY});return i&&i.inside>-1&&Mt.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new We(r))),!0)}function mlt(n,t){if(t.inputType!="insertCompositionText"||!(n.state.selection instanceof We))return!1;let{$from:e}=n.state.selection,r=e.parent.contentMatchAt(e.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=ut.empty;for(let o=r.length-1;o>=0;o--)i=ut.from(r[o].createAndFill(null,i));let s=n.state.tr.replace(e.pos,e.pos,new vt(i,0,0));return s.setSelection(jt.near(s.doc.resolve(e.pos+1))),n.dispatch(s),!1}function glt(n){if(!(n.selection instanceof We))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",Be.create(n.doc,[vr.widget(n.selection.head,t,{key:"gapcursor"})])}var Gv=200,Pn=function(){};Pn.prototype.append=function(t){return t.length?(t=Pn.from(t),!this.length&&t||t.length<Gv&&this.leafAppend(t)||this.length<Gv&&t.leafPrepend(this)||this.appendInner(t)):this};Pn.prototype.prepend=function(t){return t.length?Pn.from(t).append(this):this};Pn.prototype.appendInner=function(t){return new ylt(this,t)};Pn.prototype.slice=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=this.length),t>=e?Pn.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))};Pn.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};Pn.prototype.forEach=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=this.length),e<=r?this.forEachInner(t,e,r,0):this.forEachInvertedInner(t,e,r,0)};Pn.prototype.map=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(t(s,o))},e,r),i};Pn.from=function(t){return t instanceof Pn?t:t&&t.length?new c5(t):Pn.empty};var c5=(function(n){function t(r){n.call(this),this.values=r}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new t(this.values.slice(i,s))},t.prototype.getInner=function(i){return this.values[i]},t.prototype.forEachInner=function(i,s,o,l){for(var u=s;u<o;u++)if(i(this.values[u],l+u)===!1)return!1},t.prototype.forEachInvertedInner=function(i,s,o,l){for(var u=s-1;u>=o;u--)if(i(this.values[u],l+u)===!1)return!1},t.prototype.leafAppend=function(i){if(this.length+i.length<=Gv)return new t(this.values.concat(i.flatten()))},t.prototype.leafPrepend=function(i){if(this.length+i.length<=Gv)return new t(i.flatten().concat(this.values))},e.length.get=function(){return this.values.length},e.depth.get=function(){return 0},Object.defineProperties(t.prototype,e),t})(Pn);Pn.empty=new c5([]);var ylt=(function(n){function t(e,r){n.call(this),this.left=e,this.right=r,this.length=e.length+r.length,this.depth=Math.max(e.depth,r.depth)+1}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},t.prototype.forEachInner=function(r,i,s,o){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},t.prototype.forEachInvertedInner=function(r,i,s,o){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(r,Math.min(i,l),s,o)===!1)return!1},t.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},t.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new t(this.left,i)},t.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new t(i,this.right)},t.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new t(this.left,new t(this.right,r)):new t(this,r)},t})(Pn);const vlt=500;class Yi{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;e&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=t.tr,l,u,h=[],d=[];return this.items.forEach((m,g)=>{if(!m.step){i||(i=this.remapping(r,g+1),s=i.maps.length),s--,d.push(m);return}if(i){d.push(new Is(m.map));let v=m.step.map(i.slice(s)),T;v&&o.maybeStep(v).doc&&(T=o.mapping.maps[o.mapping.maps.length-1],h.push(new Is(T,void 0,void 0,h.length+d.length))),s--,T&&i.appendMap(T,s)}else o.maybeStep(m.step);if(m.selection)return l=i?m.selection.map(i.slice(s)):m.selection,u=new Yi(this.items.slice(0,r).append(d.reverse().concat(h)),this.eventCount-1),!1},this.items.length,0),{remaining:u,transform:o,selection:l}}addTransform(t,e,r,i){let s=[],o=this.eventCount,l=this.items,u=!i&&l.length?l.get(l.length-1):null;for(let d=0;d<t.steps.length;d++){let m=t.steps[d].invert(t.docs[d]),g=new Is(t.mapping.maps[d],m,e),v;(v=u&&u.merge(g))&&(g=v,d?s.pop():l=l.slice(0,l.length-1)),s.push(g),e&&(o++,e=void 0),i||(u=g)}let h=o-r.depth;return h>_lt&&(l=blt(l,h),o-=h),new Yi(l.append(s),o)}remapping(t,e){let r=new jp;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=t?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},t,e),r}addMaps(t){return this.eventCount==0?this:new Yi(this.items.append(t.map(e=>new Is(e))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-e),s=t.mapping,o=t.steps.length,l=this.eventCount;this.items.forEach(g=>{g.selection&&l--},i);let u=e;this.items.forEach(g=>{let v=s.getMirror(--u);if(v==null)return;o=Math.min(o,v);let T=s.maps[v];if(g.step){let S=t.steps[v].invert(t.docs[v]),w=g.selection&&g.selection.map(s.slice(u+1,v));w&&l++,r.push(new Is(T,S,w))}else r.push(new Is(T))},i);let h=[];for(let g=e;g<o;g++)h.push(new Is(s.maps[g]));let d=this.items.slice(0,i).append(h).append(r),m=new Yi(d,l);return m.emptyItemCount()>vlt&&(m=m.compress(this.items.length-r.length)),m}emptyItemCount(){let t=0;return this.items.forEach(e=>{e.step||t++}),t}compress(t=this.items.length){let e=this.remapping(0,t),r=e.maps.length,i=[],s=0;return this.items.forEach((o,l)=>{if(l>=t)i.push(o),o.selection&&s++;else if(o.step){let u=o.step.map(e.slice(r)),h=u&&u.getMap();if(r--,h&&e.appendMap(h,r),u){let d=o.selection&&o.selection.map(e.slice(r));d&&s++;let m=new Is(h.invert(),u,d),g,v=i.length-1;(g=i.length&&i[v].merge(m))?i[v]=g:i.push(m)}}else o.map&&r--},this.items.length,0),new Yi(Pn.from(i.reverse()),s)}}Yi.empty=new Yi(Pn.empty,0);function blt(n,t){let e;return n.forEach((r,i)=>{if(r.selection&&t--==0)return e=i,!1}),n.slice(e)}class Is{constructor(t,e,r,i){this.map=t,this.step=e,this.selection=r,this.mirrorOffset=i}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new Is(e.getMap().invert(),e,this.selection)}}}class za{constructor(t,e,r,i,s){this.done=t,this.undone=e,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const _lt=20;function Tlt(n,t,e,r){let i=e.getMeta(Fc),s;if(i)return i.historyState;e.getMeta(xlt)&&(n=new za(n.done,n.undone,null,0,-1));let o=e.getMeta("appendedTransaction");if(e.steps.length==0)return n;if(o&&o.getMeta(Fc))return o.getMeta(Fc).redo?new za(n.done.addTransform(e,void 0,r,S0(t)),n.undone,MP(e.mapping.maps),n.prevTime,n.prevComposition):new za(n.done,n.undone.addTransform(e,void 0,r,S0(t)),null,n.prevTime,n.prevComposition);if(e.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=e.getMeta("composition"),u=n.prevTime==0||!o&&n.prevComposition!=l&&(n.prevTime<(e.time||0)-r.newGroupDelay||!Slt(e,n.prevRanges)),h=o?ww(n.prevRanges,e.mapping):MP(e.mapping.maps);return new za(n.done.addTransform(e,u?t.selection.getBookmark():void 0,r,S0(t)),Yi.empty,h,e.time,l??n.prevComposition)}else return(s=e.getMeta("rebased"))?new za(n.done.rebased(e,s),n.undone.rebased(e,s),ww(n.prevRanges,e.mapping),n.prevTime,n.prevComposition):new za(n.done.addMaps(e.mapping.maps),n.undone.addMaps(e.mapping.maps),ww(n.prevRanges,e.mapping),n.prevTime,n.prevComposition)}function Slt(n,t){if(!t)return!1;if(!n.docChanged)return!0;let e=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<t.length;s+=2)r<=t[s+1]&&i>=t[s]&&(e=!0)}),e}function MP(n){let t=[];for(let e=n.length-1;e>=0&&t.length==0;e--)n[e].forEach((r,i,s,o)=>t.push(s,o));return t}function ww(n,t){if(!n)return null;let e=[];for(let r=0;r<n.length;r+=2){let i=t.map(n[r],1),s=t.map(n[r+1],-1);i<=s&&e.push(i,s)}return e}function wlt(n,t,e){let r=S0(t),i=Fc.get(t).spec.config,s=(e?n.undone:n.done).popEvent(t,r);if(!s)return null;let o=s.selection.resolve(s.transform.doc),l=(e?n.done:n.undone).addTransform(s.transform,t.selection.getBookmark(),i,r),u=new za(e?l:s.remaining,e?s.remaining:l,null,0,-1);return s.transform.setSelection(o).setMeta(Fc,{redo:e,historyState:u})}let xw=!1,DP=null;function S0(n){let t=n.plugins;if(DP!=t){xw=!1,DP=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){xw=!0;break}}return xw}const Fc=new Cn("history"),xlt=new Cn("closeHistory");function Elt(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new ze({key:Fc,state:{init(){return new za(Yi.empty,Yi.empty,null,0,-1)},apply(t,e,r){return Tlt(e,r,t,n)}},config:n,props:{handleDOMEvents:{beforeinput(t,e){let r=e.inputType,i=r=="historyUndo"?h5:r=="historyRedo"?f5:null;return!i||!t.editable?!1:(e.preventDefault(),i(t.state,t.dispatch))}}}})}function u5(n,t){return(e,r)=>{let i=Fc.getState(e);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let s=wlt(i,e,n);s&&r(t?s.scrollIntoView():s)}return!0}}const h5=u5(!1,!0),f5=u5(!0,!0);Ce.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:n=>n.length,wordCounter:n=>n.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=n=>{const t=n?.node||this.editor.state.doc;if((n?.mode||this.options.mode)==="textSize"){const r=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(r)}return t.nodeSize},this.storage.words=n=>{const t=n?.node||this.editor.state.doc,e=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(e)}},addProseMirrorPlugins(){let n=!1;return[new ze({key:new Cn("characterCount"),appendTransaction:(t,e,r)=>{if(n)return;const i=this.options.limit;if(i==null||i===0){n=!0;return}const s=this.storage.characters({node:r.doc});if(s>i){const o=s-i,l=0,u=o;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const h=r.tr.deleteRange(l,u);return n=!0,h}n=!0},filterTransaction:(t,e)=>{const r=this.options.limit;if(!t.docChanged||r===0||r===null||r===void 0)return!0;const i=this.storage.characters({node:e.doc}),s=this.storage.characters({node:t.doc});if(s<=r||i>r&&s>r&&s<=i)return!0;if(i>r&&s>r&&s>i||!t.getMeta("paste"))return!1;const l=t.selection.$head.pos,u=s-r,h=l-u,d=l;return t.deleteRange(h,d),!(this.storage.characters({node:t.doc})>r)}})]}});var Clt=Ce.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[llt(this.options)]}});Ce.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new ze({key:new Cn("focus"),props:{decorations:({doc:n,selection:t})=>{const{isEditable:e,isFocused:r}=this.editor,{anchor:i}=t,s=[];if(!e||!r)return Be.create(n,[]);let o=0;this.options.mode==="deepest"&&n.descendants((u,h)=>{if(u.isText)return;if(!(i>=h&&i<=h+u.nodeSize-1))return!1;o+=1});let l=0;return n.descendants((u,h)=>{if(u.isText||!(i>=h&&i<=h+u.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&o-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";s.push(vr.node(h,h+u.nodeSize,{class:this.options.className}))}),Be.create(n,s)}}})]}});var Alt=Ce.create({name:"gapCursor",addProseMirrorPlugins(){return[flt()]},extendNodeSchema(n){var t;const e={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(t=pe(Et(n,"allowGapCursor",e)))!=null?t:null}}}),OP="placeholder";function klt(n){return n.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}Ce.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:OP,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const n=this.options.dataAttribute?`data-${klt(this.options.dataAttribute)}`:`data-${OP}`;return[new ze({key:new Cn("placeholder"),props:{decorations:({doc:t,selection:e})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=e,s=[];if(!r)return null;const o=this.editor.isEmpty;return t.descendants((l,u)=>{const h=i>=u&&i<=u+l.nodeSize,d=!l.isLeaf&&Kb(l);if((h||!this.options.showOnlyCurrent)&&d){const m=[this.options.emptyNodeClass];o&&m.push(this.options.emptyEditorClass);const g=vr.node(u,u+l.nodeSize,{class:m.join(" "),[n]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:l,pos:u,hasAnchor:h}):this.options.placeholder});s.push(g)}return this.options.includeChildren}),Be.create(t,s)}}})]}});Ce.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:n,options:t}=this;return[new ze({key:new Cn("selection"),props:{decorations(e){return e.selection.empty||n.isFocused||!n.isEditable||bF(e.selection)||n.view.dragging?null:Be.create(e.doc,[vr.inline(e.selection.from,e.selection.to,{class:t.className})])}}})]}});function IP({types:n,node:t}){return t&&Array.isArray(n)&&n.includes(t.type)||t?.type===n}var Rlt=Ce.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var n;const t=new Cn(this.name),e=this.options.node||((n=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:n.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(e).includes(i.name));return[new ze({key:t,appendTransaction:(i,s,o)=>{const{doc:l,tr:u,schema:h}=o,d=t.getState(o),m=l.content.size,g=h.nodes[e];if(d)return u.insert(m,g.create())},state:{init:(i,s)=>{const o=s.tr.doc.lastChild;return!IP({node:o,types:r})},apply:(i,s)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return s;const o=i.doc.lastChild;return!IP({node:o,types:r})}}})]}}),Mlt=Ce.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:t})=>h5(n,t),redo:()=>({state:n,dispatch:t})=>f5(n,t)}},addProseMirrorPlugins(){return[Elt(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Dlt=Ce.create({name:"starterKit",addExtensions(){var n,t,e,r;const i=[];return this.options.bold!==!1&&i.push(nat.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(Qot.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(JF.configure(this.options.bulletList)),this.options.code!==!1&&i.push(sat.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(lat.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(cat.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(Clt.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(Alt.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(uat.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(hat.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(Mlt.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(fat.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(yat.configure(this.options.italic)),this.options.listItem!==!1&&i.push(ZF.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(s5.configure((n=this.options)==null?void 0:n.listKeymap)),this.options.link!==!1&&i.push(zat.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&i.push(a5.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(nlt.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(slt.configure(this.options.strike)),this.options.text!==!1&&i.push(olt.configure(this.options.text)),this.options.underline!==!1&&i.push(alt.configure((e=this.options)==null?void 0:e.underline)),this.options.trailingNode!==!1&&i.push(Rlt.configure((r=this.options)==null?void 0:r.trailingNode)),i}}),Olt=Dlt,Ilt=20,d5=(n,t=0)=>{const e=[];return!n.children.length||t>Ilt||Array.from(n.children).forEach(r=>{r.tagName==="SPAN"?e.push(r):r.children.length&&e.push(...d5(r,t+1))}),e},Plt=n=>{if(!n.children.length)return;const t=d5(n);t&&t.forEach(e=>{var r,i;const s=e.getAttribute("style"),o=(i=(r=e.parentElement)==null?void 0:r.closest("span"))==null?void 0:i.getAttribute("style");e.setAttribute("style",`${o};${s}`)})},p5=Qo.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:n=>n.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&Plt(n),{}):!1}]},renderHTML({HTMLAttributes:n}){return["span",Xe(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleTextStyle:n=>({commands:t})=>t.toggleMark(this.name,n),removeEmptyTextStyle:()=>({tr:n})=>{const{selection:t}=n;return n.doc.nodesBetween(t.from,t.to,(e,r)=>{if(e.isTextblock)return!0;e.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(s=>!!s))||n.removeMark(r,r+e.nodeSize,this.type)}),!0}}}}),Nlt=Ce.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:n=>{var t;const e=n.getAttribute("style");if(e){const r=e.split(";").map(i=>i.trim()).filter(Boolean);for(let i=r.length-1;i>=0;i-=1){const s=r[i].split(":");if(s.length>=2){const o=s[0].trim().toLowerCase(),l=s.slice(1).join(":").trim();if(o==="background-color")return l.replace(/['"]+/g,"")}}}return(t=n.style.backgroundColor)==null?void 0:t.replace(/['"]+/g,"")},renderHTML:n=>n.backgroundColor?{style:`background-color: ${n.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:n=>({chain:t})=>t().setMark("textStyle",{backgroundColor:n}).run(),unsetBackgroundColor:()=>({chain:n})=>n().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),m5=Ce.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:n=>{var t;const e=n.getAttribute("style");if(e){const r=e.split(";").map(i=>i.trim()).filter(Boolean);for(let i=r.length-1;i>=0;i-=1){const s=r[i].split(":");if(s.length>=2){const o=s[0].trim().toLowerCase(),l=s.slice(1).join(":").trim();if(o==="color")return l.replace(/['"]+/g,"")}}}return(t=n.style.color)==null?void 0:t.replace(/['"]+/g,"")},renderHTML:n=>n.color?{style:`color: ${n.color}`}:{}}}}]},addCommands(){return{setColor:n=>({chain:t})=>t().setMark("textStyle",{color:n}).run(),unsetColor:()=>({chain:n})=>n().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),g5=Ce.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:n=>n.style.fontFamily,renderHTML:n=>n.fontFamily?{style:`font-family: ${n.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:n=>({chain:t})=>t().setMark("textStyle",{fontFamily:n}).run(),unsetFontFamily:()=>({chain:n})=>n().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),y5=Ce.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:n=>n.style.fontSize,renderHTML:n=>n.fontSize?{style:`font-size: ${n.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:n=>({chain:t})=>t().setMark("textStyle",{fontSize:n}).run(),unsetFontSize:()=>({chain:n})=>n().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),Llt=Ce.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:n=>n.style.lineHeight,renderHTML:n=>n.lineHeight?{style:`line-height: ${n.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:n=>({chain:t})=>t().setMark("textStyle",{lineHeight:n}).run(),unsetLineHeight:()=>({chain:n})=>n().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});Ce.create({name:"textStyleKit",addExtensions(){const n=[];return this.options.backgroundColor!==!1&&n.push(Nlt.configure(this.options.backgroundColor)),this.options.color!==!1&&n.push(m5.configure(this.options.color)),this.options.fontFamily!==!1&&n.push(g5.configure(this.options.fontFamily)),this.options.fontSize!==!1&&n.push(y5.configure(this.options.fontSize)),this.options.lineHeight!==!1&&n.push(Llt.configure(this.options.lineHeight)),this.options.textStyle!==!1&&n.push(p5.configure(this.options.textStyle)),n}});var Vlt=m5,jlt=g5,Blt=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,Flt=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,Ult=Qo.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",Xe(this.options.HTMLAttributes,n),0]},renderMarkdown:(n,t)=>`==${t.renderChildren(n)}==`,parseMarkdown:(n,t)=>t.applyMark("highlight",t.parseInline(n.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:n=>n.indexOf("=="),tokenize(n,t,e){const i=/^(==)([^=]+)(==)/.exec(n);if(i){const s=i[2].trim(),o=e.inlineTokens(s);return{type:"highlight",raw:i[0],text:s,tokens:o}}}},addCommands(){return{setHighlight:n=>({commands:t})=>t.setMark(this.name,n),toggleHighlight:n=>({commands:t})=>t.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[nu({find:Blt,type:this.type})]},addPasteRules(){return[_l({find:Flt,type:this.type})]}}),zlt=Ult;const Hlt=864e5,PP=Symbol.for("constructDateFrom");function v5(n,t){return typeof n=="function"?n(t):n&&typeof n=="object"&&PP in n?n[PP](t):n instanceof Date?new n.constructor(t):new Date(t)}function b5(n,t){return v5(n,n)}function NP(n){const t=b5(n),e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),+n-+e}function $lt(n,...t){const e=v5.bind(null,t.find(r=>typeof r=="object"));return t.map(e)}function Wv(n,t){const e=b5(n);return e.setHours(0,0,0,0),e}function qlt(n,t,e){const[r,i]=$lt(e?.in,n,t),s=Wv(r),o=Wv(i),l=+s-NP(s),u=+o-NP(o);return Math.round((l-u)/Hlt)}function Glt(n,t,e){if(n===null)return{newStreak:1};const r=Wv(n),i=Wv(t),s=qlt(i,r);return s===0?{newStreak:e}:s===1?{newStreak:e+1}:{newStreak:1}}function _5(n){return typeof n!="string"||n.trim().length===0?{valid:!1,error:"Title is required"}:n.trim().length>ZI?{valid:!1,error:`Title must be ${ZI} characters or less`}:{valid:!0}}function Wlt(n){return Px.includes(n)?{valid:!0}:{valid:!1,error:`Mood must be one of: ${Px.join(", ")}`}}function Ylt(n){if(!Array.isArray(n))return{valid:!1,error:"Images must be an array"};if(n.length>vc)return{valid:!1,error:`Maximum ${vc} images allowed`};for(let t=0;t<n.length;t++)if(typeof n[t]!="string"||n[t].trim().length===0)return{valid:!1,error:`Image at index ${t} must be a non-empty string`};return{valid:!0}}function T5(n){return!(n instanceof Date)||isNaN(n.getTime())?{valid:!1,error:"Date must be a valid Date object"}:n>new Date?{valid:!1,error:"Entry date cannot be in the future"}:{valid:!0}}function Klt(n){const t=[],e=_5(n?.title);e.valid||t.push(e.error);const r=Wlt(n?.mood);r.valid||t.push(r.error);const i=Ylt(n?.images??[]);i.valid||t.push(i.error);const s=T5(n?.date);return s.valid||t.push(s.error),t.length>0?{valid:!1,errors:t}:{valid:!0}}async function Xlt(n,t,e){const r=Klt(t);if(!r.valid)throw new Error(r.errors.join(", "));const i=we.now(),s={userId:n,date:we.fromDate(t.date),title:t.title.trim(),content:t.content,mood:t.mood,images:t.images??[],drawingURL:t.drawingURL??null,theme:t.theme,updatedAt:i};let o;return await pY(Qi,async l=>{if(e){const u=Vo(Qi,"entries",e),h=await l.get(u);if(!h.exists())throw new Error("Entry not found");if(h.data().userId!==n)throw new Error("Permission denied");l.update(u,s),o=e}else{const u=Vo(t3(Qi,"entries"));l.set(u,{...s,createdAt:i}),o=u.id;const h=Vo(Qi,"users",n),d=await l.get(h);if(!d.exists())throw new Error("User not found");const m=d.data(),g=m.lastEntryDate?.toDate()??null,v=m.streak??0,T=m.longestStreak??0,{newStreak:S}=Glt(g,t.date,v);l.update(h,{streak:S,longestStreak:Math.max(T,S),lastEntryDate:we.fromDate(t.date)})}}),o}async function Qlt(n,t){const e=Vo(Qi,"entries",n),r=await Ob(e);if(!r.exists())throw new Error("Entry not found");const i=r.data();if(i.userId!==t)throw new Error("Permission denied");return{entryId:r.id,...i}}async function Jlt(n,t,e){if(!e)throw new Error("No file provided");if(e.size>EB)throw new Error("Image must be under 5MB");if(!CB.includes(e.type))throw new Error("Please upload a JPEG, PNG, GIF, or WebP image");const r=`images/${n}/${t}/${e.name}`,i=N3(L3,r),s=await I3(i,e);return await P3(s.ref)}async function Zlt(n,t,e){const i=await(await fetch(e)).blob(),s=`drawings/${n}/${t}.png`,o=N3(L3,s),l=await I3(o,i);return await P3(l.ref)}const tct=[{label:"Poppins",value:"Poppins"},{label:"Caveat",value:"Caveat"},{label:"Pacifico",value:"Pacifico"}],ect=[{label:"S",value:"14px"},{label:"M",value:"18px"},{label:"L",value:"24px"}],nct=["#4A2040","#1E3A5F","#744210","#22543D","#2D3748","#FF69B4","#63B3ED","#ECC94B","#48BB78","#A0AEC0","#E53E3E","#805AD5","#DD6B20","#319795","#718096"],rct=["#FFE4E1","#E6E6FA","#FEFCBF","#F0FFF4","#EBF8FF","#FFF0F5","#FED7E2","#FEEBC8","#C6F6D5","#BEE3F8"];function ict({editor:n}){if(!n)return null;const t=L.useCallback(s=>{n.chain().focus().setFontFamily(s).run()},[n]),e=L.useCallback(s=>{n.chain().focus().setFontSize(s).run()},[n]),r=L.useCallback(s=>{n.chain().focus().setColor(s).run()},[n]),i=L.useCallback(s=>{n.chain().focus().toggleHighlight({color:s}).run()},[n]);return z.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-3 bg-pink-50/80 rounded-2xl border border-pink-100 mb-4",children:[z.jsxs("div",{className:"flex items-center gap-1",children:[z.jsx("label",{className:"sr-only",htmlFor:"font-family-select",children:"Font family"}),z.jsx("select",{id:"font-family-select",onChange:s=>t(s.target.value),className:"px-2 py-1.5 rounded-lg bg-white border border-pink-200 text-sm font-['Poppins'] text-gray-700 cursor-pointer focus:outline-none focus:ring-2 focus:ring-pink-300","aria-label":"Font family",children:tct.map(s=>z.jsx("option",{value:s.value,style:{fontFamily:s.value},children:s.label},s.value))})]}),z.jsx("div",{className:"w-px h-6 bg-pink-200","aria-hidden":"true"}),z.jsx("div",{className:"flex items-center gap-1",role:"group","aria-label":"Font size",children:ect.map(s=>z.jsx("button",{type:"button",onClick:()=>e(s.value),className:"px-2.5 py-1 rounded-lg text-sm font-['Poppins'] bg-white border border-pink-200 hover:bg-pink-100 transition-colors text-gray-700","aria-label":`Font size ${s.label}`,children:s.label},s.value))}),z.jsx("div",{className:"w-px h-6 bg-pink-200","aria-hidden":"true"}),z.jsxs("div",{className:"flex items-center gap-1",role:"group","aria-label":"Text formatting",children:[z.jsx("button",{type:"button",onClick:()=>n.chain().focus().toggleBold().run(),className:`px-2.5 py-1 rounded-lg text-sm font-bold border transition-colors ${n.isActive("bold")?"bg-pink-200 border-pink-300 text-pink-800":"bg-white border-pink-200 hover:bg-pink-100 text-gray-700"}`,"aria-label":"Bold","aria-pressed":n.isActive("bold"),children:"B"}),z.jsx("button",{type:"button",onClick:()=>n.chain().focus().toggleItalic().run(),className:`px-2.5 py-1 rounded-lg text-sm italic border transition-colors ${n.isActive("italic")?"bg-pink-200 border-pink-300 text-pink-800":"bg-white border-pink-200 hover:bg-pink-100 text-gray-700"}`,"aria-label":"Italic","aria-pressed":n.isActive("italic"),children:"I"}),z.jsx("button",{type:"button",onClick:()=>n.chain().focus().toggleStrike().run(),className:`px-2.5 py-1 rounded-lg text-sm line-through border transition-colors ${n.isActive("strike")?"bg-pink-200 border-pink-300 text-pink-800":"bg-white border-pink-200 hover:bg-pink-100 text-gray-700"}`,"aria-label":"Strikethrough","aria-pressed":n.isActive("strike"),children:"S"})]}),z.jsx("div",{className:"w-px h-6 bg-pink-200","aria-hidden":"true"}),z.jsxs("div",{className:"flex items-center gap-1",children:[z.jsx("span",{className:"text-xs font-['Poppins'] text-gray-500 mr-1",children:"Text"}),z.jsx("div",{className:"flex flex-wrap gap-1",role:"group","aria-label":"Text color",children:nct.map(s=>z.jsx("button",{type:"button",onClick:()=>r(s),className:"w-5 h-5 rounded-full border border-gray-200 hover:scale-125 transition-transform cursor-pointer",style:{backgroundColor:s},"aria-label":`Text color ${s}`},s))})]}),z.jsx("div",{className:"w-px h-6 bg-pink-200","aria-hidden":"true"}),z.jsxs("div",{className:"flex items-center gap-1",children:[z.jsx("span",{className:"text-xs font-['Poppins'] text-gray-500 mr-1",children:"Highlight"}),z.jsx("div",{className:"flex flex-wrap gap-1",role:"group","aria-label":"Highlight color",children:rct.map(s=>z.jsx("button",{type:"button",onClick:()=>i(s),className:"w-5 h-5 rounded-full border border-gray-200 hover:scale-125 transition-transform cursor-pointer",style:{backgroundColor:s},"aria-label":`Highlight color ${s}`},s))})]})]})}function q(n,t,e){return(t=(function(r){var i=(function(s,o){if(typeof s!="object"||!s)return s;var l=s[Symbol.toPrimitive];if(l!==void 0){var u=l.call(s,o);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(s)})(r,"string");return typeof i=="symbol"?i:i+""})(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}class LP{constructor(){q(this,"browserShadowBlurConstant",1),q(this,"DPI",96),q(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),q(this,"perfLimitSizeTotal",2097152),q(this,"maxCacheSideLimit",4096),q(this,"minCacheSideLimit",256),q(this,"disableStyleCopyPaste",!1),q(this,"enableGLFiltering",!0),q(this,"textureSize",4096),q(this,"forceGLPutImageData",!1),q(this,"cachesBoundsOfCurve",!1),q(this,"fontPaths",{}),q(this,"NUM_FRACTION_DIGITS",4)}}const me=new class extends LP{constructor(n){super(),this.configure(n)}configure(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,n)}addFonts(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths={...this.fontPaths,...n}}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>{delete this.fontPaths[n]})}clearFonts(){this.fontPaths={}}restoreDefaults(n){const t=new LP,e=n?.reduce((r,i)=>(r[i]=t[i],r),{})||t;this.configure(e)}},Tl=function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return console[n]("fabric",...e)};class js extends Error{constructor(t,e){super(`fabric: ${t}`,e)}}class sct extends js{constructor(t){super(`${t} 'options.signal' is in 'aborted' state`)}}class oct{}class act extends oct{testPrecision(t,e){const r=`precision ${e} float;
void main(){}`,i=t.createShader(t.FRAGMENT_SHADER);return!!i&&(t.shaderSource(i,r),t.compileShader(i),!!t.getShaderParameter(i,t.COMPILE_STATUS))}queryWebGL(t){const e=t.getContext("webgl");e&&(this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(r=>this.testPrecision(e,r)),e.getExtension("WEBGL_lose_context").loseContext(),Tl("log",`WebGL: max texture size ${this.maxTextureSize}`))}isSupported(t){return!!this.maxTextureSize&&this.maxTextureSize>=t}}const lct={};let VP;const Js=()=>VP||(VP={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new act,dispose(){},copyPasteData:lct}),af=()=>Js().document,Zb=()=>Js().window,S5=()=>{var n;return Math.max((n=me.devicePixelRatio)!==null&&n!==void 0?n:Zb().devicePixelRatio,1)},mp=new class{constructor(){q(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(n){let{fontFamily:t,fontStyle:e,fontWeight:r}=n;t=t.toLowerCase();const i=this.charWidthsCache;i.has(t)||i.set(t,new Map);const s=i.get(t),o=`${e.toLowerCase()}_${(r+"").toLowerCase()}`;return s.has(o)||s.set(o,new Map),s.get(o)}clearFontCache(n){n?this.charWidthsCache.delete((n||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(n){const{perfLimitSizeTotal:t}=me,e=Math.sqrt(t*n);return[Math.floor(e),Math.floor(t/e)]}},hE="7.2.0";function w0(){}const xm=Math.PI/2,cct=Math.PI/4,Hh=2*Math.PI,ZC=Math.PI/180,Tr=Object.freeze([1,0,0,1,0,0]),tA=16,Na=.4477152502,Wt="center",ue="left",Nr="top",fE="bottom",rn="right",Lr="none",eA=/\r?\n/,w5="moving",t_="scaling",x5="rotating",nA="rotate",E5="skewing",Wp="resizing",uct="modifyPoly",hct="modifyPath",Yv="changed",e_="scale",Vr="scaleX",ki="scaleY",lf="skewX",cf="skewY",Nn="fill",ti="stroke",Kv="modified",_c="ltr",Co="rtl",dE="normal",th="json",Ew="svg",_t=new class{constructor(){this[th]=new Map,this[Ew]=new Map}has(n){return this[th].has(n)}getClass(n){const t=this[th].get(n);if(!t)throw new js(`No class registered for ${n}`);return t}setClass(n,t){t?this[th].set(t,n):(this[th].set(n.type,n),this[th].set(n.type.toLowerCase(),n))}getSVGClass(n){return this[Ew].get(n)}setSVGClass(n,t){this[Ew].set(t??n.type.toLowerCase(),n)}},Xv=new class extends Array{remove(n){const t=this.indexOf(n);t>-1&&this.splice(t,1)}cancelAll(){const n=this.splice(0);return n.forEach(t=>t.abort()),n}cancelByCanvas(n){if(!n)return[];const t=this.filter(e=>{var r;return e.target===n||typeof e.target=="object"&&((r=e.target)===null||r===void 0?void 0:r.canvas)===n});return t.forEach(e=>e.abort()),t}cancelByTarget(n){if(!n)return[];const t=this.filter(e=>e.target===n);return t.forEach(e=>e.abort()),t}};class fct{constructor(){q(this,"__eventListeners",{})}on(t,e){if(this.__eventListeners||(this.__eventListeners={}),typeof t=="object")return Object.entries(t).forEach(r=>{let[i,s]=r;this.on(i,s)}),()=>this.off(t);if(e){const r=t;return this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(e),()=>this.off(r,e)}return()=>!1}once(t,e){if(typeof t=="object"){const r=[];return Object.entries(t).forEach(i=>{let[s,o]=i;r.push(this.once(s,o))}),()=>r.forEach(i=>i())}if(e){const r=this.on(t,function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];e.call(this,...s),r()});return r}return()=>!1}_removeEventListener(t,e){if(this.__eventListeners[t])if(e){const r=this.__eventListeners[t],i=r.indexOf(e);i>-1&&r.splice(i,1)}else this.__eventListeners[t]=[]}off(t,e){if(this.__eventListeners)if(t===void 0)for(const r in this.__eventListeners)this._removeEventListener(r);else typeof t=="object"?Object.entries(t).forEach(r=>{let[i,s]=r;this._removeEventListener(i,s)}):this._removeEventListener(t,e)}fire(t,e){var r;if(!this.__eventListeners)return;const i=(r=this.__eventListeners[t])===null||r===void 0?void 0:r.concat();if(i)for(let s=0;s<i.length;s++)i[s].call(this,e||{})}}const ch=(n,t)=>{const e=n.indexOf(t);return e!==-1&&n.splice(e,1),n},Wo=n=>{if(n===0)return 1;switch(Math.abs(n)/xm){case 1:case 3:return 0;case 2:return-1}return Math.cos(n)},Yo=n=>{if(n===0)return 0;const t=n/xm,e=Math.sign(n);switch(t){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(n)};class tt{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}add(t){return new tt(this.x+t.x,this.y+t.y)}addEquals(t){return this.x+=t.x,this.y+=t.y,this}scalarAdd(t){return new tt(this.x+t,this.y+t)}scalarAddEquals(t){return this.x+=t,this.y+=t,this}subtract(t){return new tt(this.x-t.x,this.y-t.y)}subtractEquals(t){return this.x-=t.x,this.y-=t.y,this}scalarSubtract(t){return new tt(this.x-t,this.y-t)}scalarSubtractEquals(t){return this.x-=t,this.y-=t,this}multiply(t){return new tt(this.x*t.x,this.y*t.y)}scalarMultiply(t){return new tt(this.x*t,this.y*t)}scalarMultiplyEquals(t){return this.x*=t,this.y*=t,this}divide(t){return new tt(this.x/t.x,this.y/t.y)}scalarDivide(t){return new tt(this.x/t,this.y/t)}scalarDivideEquals(t){return this.x/=t,this.y/=t,this}eq(t){return this.x===t.x&&this.y===t.y}lt(t){return this.x<t.x&&this.y<t.y}lte(t){return this.x<=t.x&&this.y<=t.y}gt(t){return this.x>t.x&&this.y>t.y}gte(t){return this.x>=t.x&&this.y>=t.y}lerp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return e=Math.max(Math.min(1,e),0),new tt(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)}distanceFrom(t){const e=this.x-t.x,r=this.y-t.y;return Math.sqrt(e*e+r*r)}midPointFrom(t){return this.lerp(t)}min(t){return new tt(Math.min(this.x,t.x),Math.min(this.y,t.y))}max(t){return new tt(Math.max(this.x,t.x),Math.max(this.y,t.y))}toString(){return`${this.x},${this.y}`}setXY(t,e){return this.x=t,this.y=e,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setFromPoint(t){return this.x=t.x,this.y=t.y,this}swap(t){const e=this.x,r=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=r}clone(){return new tt(this.x,this.y)}rotate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rA;const r=Yo(t),i=Wo(t),s=this.subtract(e);return new tt(s.x*i-s.y*r,s.x*r+s.y*i).add(e)}transform(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new tt(t[0]*this.x+t[2]*this.y+(e?0:t[4]),t[1]*this.x+t[3]*this.y+(e?0:t[5]))}}const rA=new tt(0,0),x0=n=>!!n&&Array.isArray(n._objects);function C5(n){class t extends n{constructor(){super(...arguments),q(this,"_objects",[])}_onObjectAdded(r){}_onObjectRemoved(r){}_onStackOrderChanged(r){}add(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];const o=this._objects.push(...i);return i.forEach(l=>this._onObjectAdded(l)),o}insertAt(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return this._objects.splice(r,0,...s),s.forEach(l=>this._onObjectAdded(l)),this._objects.length}remove(){const r=this._objects,i=[];for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return o.forEach(u=>{const h=r.indexOf(u);h!==-1&&(r.splice(h,1),i.push(u),this._onObjectRemoved(u))}),i}forEachObject(r){this.getObjects().forEach((i,s,o)=>r(i,s,o))}getObjects(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...i))}item(r){return this._objects[r]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(r,i){return!!this._objects.includes(r)||!!i&&this._objects.some(s=>s instanceof t&&s.contains(r,!0))}complexity(){return this._objects.reduce((r,i)=>r+=i.complexity?i.complexity():0,0)}sendObjectToBack(r){return!(!r||r===this._objects[0])&&(ch(this._objects,r),this._objects.unshift(r),this._onStackOrderChanged(r),!0)}bringObjectToFront(r){return!(!r||r===this._objects[this._objects.length-1])&&(ch(this._objects,r),this._objects.push(r),this._onStackOrderChanged(r),!0)}sendObjectBackwards(r,i){if(!r)return!1;const s=this._objects.indexOf(r);if(s!==0){const o=this.findNewLowerIndex(r,s,i);return ch(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0}return!1}bringObjectForward(r,i){if(!r)return!1;const s=this._objects.indexOf(r);if(s!==this._objects.length-1){const o=this.findNewUpperIndex(r,s,i);return ch(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0}return!1}moveObjectTo(r,i){return r!==this._objects[i]&&(ch(this._objects,r),this._objects.splice(i,0,r),this._onStackOrderChanged(r),!0)}findNewLowerIndex(r,i,s){let o;if(s){o=i;for(let l=i-1;l>=0;--l)if(r.isOverlapping(this._objects[l])){o=l;break}}else o=i-1;return o}findNewUpperIndex(r,i,s){let o;if(s){o=i;for(let l=i+1;l<this._objects.length;++l)if(r.isOverlapping(this._objects[l])){o=l;break}}else o=i+1;return o}collectObjects(r){let{left:i,top:s,width:o,height:l}=r,{includeIntersecting:u=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=[],d=new tt(i,s),m=d.add(new tt(o,l));for(let g=this._objects.length-1;g>=0;g--){const v=this._objects[g];v.selectable&&v.visible&&(u&&v.intersectsWithRect(d,m)||v.isContainedWithinRect(d,m)||u&&v.containsPoint(d)||u&&v.containsPoint(m))&&h.push(v)}return h}}return t}class A5 extends fct{_setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const e in t)this.set(e,t[e])}_setObject(t){for(const e in t)this._set(e,t[e])}set(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this}_set(t,e){this[t]=e}toggle(t){const e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this}get(t){return this[t]}}function E0(n){return Zb().requestAnimationFrame(n)}function dct(n){return Zb().cancelAnimationFrame(n)}let pct=0;const Sl=()=>pct++,Ko=()=>{const n=af().createElement("canvas");if(!n||n.getContext===void 0)throw new js("Failed to create `canvas` element");return n},mct=()=>af().createElement("img"),Ri=n=>{const t=Ko();return t.width=n.width,t.height=n.height,t},k5=(n,t,e)=>n.toDataURL(`image/${t}`,e),R5=(n,t,e)=>new Promise((r,i)=>{n.toBlob(r,`image/${t}`,e)}),sn=n=>n*ZC,wl=n=>n/ZC,gct=n=>n.every((t,e)=>t===Tr[e]),Dr=(n,t,e)=>new tt(n).transform(t,e),Zi=n=>{const t=1/(n[0]*n[3]-n[1]*n[2]),e=[t*n[3],-t*n[1],-t*n[2],t*n[0],0,0],{x:r,y:i}=new tt(n[4],n[5]).transform(e,!0);return e[4]=-r,e[5]=-i,e},Kn=(n,t,e)=>[n[0]*t[0]+n[2]*t[1],n[1]*t[0]+n[3]*t[1],n[0]*t[2]+n[2]*t[3],n[1]*t[2]+n[3]*t[3],e?0:n[0]*t[4]+n[2]*t[5]+n[4],e?0:n[1]*t[4]+n[3]*t[5]+n[5]],iA=(n,t)=>n.reduceRight((e,r)=>r&&e?Kn(r,e,t):r||e,void 0)||Tr.concat(),M5=n=>{let[t,e]=n;return Math.atan2(e,t)},Qv=n=>{const t=M5(n),e=Math.pow(n[0],2)+Math.pow(n[1],2),r=Math.sqrt(e),i=(n[0]*n[3]-n[2]*n[1])/r,s=Math.atan2(n[0]*n[2]+n[1]*n[3],e);return{angle:wl(t),scaleX:r,scaleY:i,skewX:wl(s),skewY:0,translateX:n[4]||0,translateY:n[5]||0}},Em=function(n){return[1,0,0,1,n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function uf(){let{angle:n=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:t=0,y:e=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=sn(n),i=Wo(r),s=Yo(r);return[i,s,-s,i,t?t-(i*t-s*e):0,e?e-(s*t+i*e):0]}const sA=function(n){return[n,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,0,0]},D5=n=>Math.tan(sn(n)),O5=n=>[1,0,D5(n),1,0,0],I5=n=>[1,D5(n),0,1,0,0],n_=n=>{let{scaleX:t=1,scaleY:e=1,flipX:r=!1,flipY:i=!1,skewX:s=0,skewY:o=0}=n,l=sA(r?-t:t,i?-e:e);return s&&(l=Kn(l,O5(s),!0)),o&&(l=Kn(l,I5(o),!0)),l},yct=n=>{const{translateX:t=0,translateY:e=0,angle:r=0}=n;let i=Em(t,e);r&&(i=Kn(i,uf({angle:r})));const s=n_(n);return gct(s)||(i=Kn(i,s)),i},C0=function(n){let{signal:t,crossOrigin:e=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,i){if(t&&t.aborted)return i(new sct("loadImage"));const s=mct();let o;t&&(o=function(u){s.src="",i(u)},t.addEventListener("abort",o,{once:!0}));const l=function(){s.onload=s.onerror=null,o&&t?.removeEventListener("abort",o),r(s)};n?(s.onload=l,s.onerror=function(){o&&t?.removeEventListener("abort",o),i(new js(`Error loading ${s.src}`))},e&&(s.crossOrigin=e),s.src=n):l()})},Yp=function(n){let{signal:t,reviver:e=w0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((r,i)=>{const s=[];t&&t.addEventListener("abort",i,{once:!0}),Promise.all(n.map(o=>_t.getClass(o.type).fromObject(o,{signal:t}).then(l=>(e(o,l),s.push(l),l)))).then(r).catch(o=>{s.forEach(l=>{l.dispose&&l.dispose()}),i(o)}).finally(()=>{t&&t.removeEventListener("abort",i)})})},r_=function(n){let{signal:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((e,r)=>{const i=[];t&&t.addEventListener("abort",r,{once:!0});const s=Object.values(n).map(l=>l&&l.type&&_t.has(l.type)?Yp([l],{signal:t}).then(u=>{let[h]=u;return i.push(h),h}):l),o=Object.keys(n);Promise.all(s).then(l=>l.reduce((u,h,d)=>(u[o[d]]=h,u),{})).then(e).catch(l=>{i.forEach(u=>{u.dispose&&u.dispose()}),r(l)}).finally(()=>{t&&t.removeEventListener("abort",r)})})},hf=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((t,e)=>(e in n&&(t[e]=n[e]),t),{})},oA=(n,t)=>Object.keys(n).reduce((e,r)=>(t(n[r],r,n)&&(e[r]=n[r]),e),{}),Ae=(n,t)=>parseFloat(Number(n).toFixed(t)),Kp=n=>"matrix("+n.map(t=>Ae(t,me.NUM_FRACTION_DIGITS)).join(" ")+")",Si=n=>!!n&&n.toLive!==void 0,jP=n=>!!n&&typeof n.toObject=="function",BP=n=>!!n&&n.offsetX!==void 0&&"source"in n,Tc=n=>!!n&&"multiSelectionStacking"in n;function P5(n){const t=n&&Ki(n);let e=0,r=0;if(!n||!t)return{left:e,top:r};let i=n;const s=t.documentElement,o=t.body||{scrollLeft:0,scrollTop:0};for(;i&&(i.parentNode||i.host)&&(i=i.parentNode||i.host,i===t?(e=o.scrollLeft||s.scrollLeft||0,r=o.scrollTop||s.scrollTop||0):(e+=i.scrollLeft||0,r+=i.scrollTop||0),i.nodeType!==1||i.style.position!=="fixed"););return{left:e,top:r}}const Ki=n=>n.ownerDocument||null,N5=n=>{var t;return((t=n.ownerDocument)===null||t===void 0?void 0:t.defaultView)||null},L5=function(n,t,e){let{width:r,height:i}=e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;n.width=r,n.height=i,s>1&&(n.setAttribute("width",(r*s).toString()),n.setAttribute("height",(i*s).toString()),t.scale(s,s))},pE=(n,t)=>{let{width:e,height:r}=t;e&&(n.style.width=typeof e=="number"?`${e}px`:e),r&&(n.style.height=typeof r=="number"?`${r}px`:r)};function FP(n){return n.onselectstart!==void 0&&(n.onselectstart=()=>!1),n.style.userSelect=Lr,n}class V5{constructor(t){q(this,"_originalCanvasStyle",void 0),q(this,"lower",void 0);const e=this.createLowerCanvas(t);this.lower={el:e,ctx:e.getContext("2d")}}createLowerCanvas(t){const e=(r=t)&&r.getContext!==void 0?t:t&&af().getElementById(t)||Ko();var r;if(e.hasAttribute("data-fabric"))throw new js("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=e.style.cssText,e.setAttribute("data-fabric","main"),e.classList.add("lower-canvas"),e}cleanupDOM(t){let{width:e,height:r}=t;const{el:i}=this.lower;i.classList.remove("lower-canvas"),i.removeAttribute("data-fabric"),i.setAttribute("width",`${e}`),i.setAttribute("height",`${r}`),i.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(t,e){const{el:r,ctx:i}=this.lower;L5(r,i,t,e)}setCSSDimensions(t){pE(this.lower.el,t)}calcOffset(){return(function(t){var e;const r=t&&Ki(t),i={left:0,top:0};if(!r)return i;const s=((e=N5(t))===null||e===void 0?void 0:e.getComputedStyle(t,null))||{};i.left+=parseInt(s.borderLeftWidth,10)||0,i.top+=parseInt(s.borderTopWidth,10)||0,i.left+=parseInt(s.paddingLeft,10)||0,i.top+=parseInt(s.paddingTop,10)||0;let o={left:0,top:0};const l=r.documentElement;t.getBoundingClientRect!==void 0&&(o=t.getBoundingClientRect());const u=P5(t);return{left:o.left+u.left-(l.clientLeft||0)+i.left,top:o.top+u.top-(l.clientTop||0)+i.top}})(this.lower.el)}dispose(){Js().dispose(this.lower.el),delete this.lower}}const vct={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Tr],patternQuality:"best"},ne=n=>n.toString().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let Dd;const aA=n=>{if(Dd||Dd||(Dd="Intl"in Zb()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),Dd){const t=Dd.segment(n);return Array.from(t).map(e=>{let{segment:r}=e;return r})}return bct(n)},bct=n=>{const t=[];for(let e,r=0;r<n.length;r++)(e=_ct(n,r))!==!1&&t.push(e);return t},_ct=(n,t)=>{const e=n.charCodeAt(t);if(isNaN(e))return"";if(e<55296||e>57343)return n.charAt(t);if(55296<=e&&e<=56319){if(n.length<=t+1)throw"High surrogate without following low surrogate";const i=n.charCodeAt(t+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return n.charAt(t)+n.charAt(t+1)}if(t===0)throw"Low surrogate without preceding high surrogate";const r=n.charCodeAt(t-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1};class Cm extends C5(A5){get lowerCanvasEl(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.el}get contextContainer(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.ctx}static getDefaults(){return Cm.ownDefaults}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(e),this.initElements(t),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(t){this.elements=new V5(t)}add(){const t=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}insertAt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];const s=super.insertAt(t,...r);return r.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){const t=super.remove(...arguments);return t.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}_onObjectAdded(t){t.canvas&&t.canvas!==this&&(Tl("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),t.canvas.remove(t)),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t){t._set("canvas",void 0),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?S5():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}_setDimensionsImpl(t){let{cssOnly:e=!1,backstoreOnly:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e){const i={width:this.width,height:this.height,...t};this.elements.setDimensions(i,this.getRetinaScaling()),this.hasLostContext=!0,this.width=i.width,this.height=i.height}r||this.elements.setCSSDimensions(t),this.calcOffset()}setDimensions(t,e){this._setDimensionsImpl(t,e),e&&e.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(t){this.viewportTransform=t,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(t,e){const r=t,i=[...this.viewportTransform],s=Dr(t,Zi(i));i[0]=e,i[3]=e;const o=Dr(s,i);i[4]+=r.x-o.x,i[5]+=r.y-o.y,this.setViewportTransform(i)}setZoom(t){this.zoomToPoint(new tt(0,0),t)}absolutePan(t){const e=[...this.viewportTransform];return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)}relativePan(t){return this.absolutePan(new tt(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(t){t.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=E0(()=>this.renderAndReset()))}calcViewportBoundaries(){const t=this.width,e=this.height,r=Zi(this.viewportTransform),i=Dr({x:0,y:0},r),s=Dr({x:t,y:e},r),o=i.min(s),l=i.max(s);return this.vptCoords={tl:o,tr:new tt(l.x,o.y),bl:new tt(o.x,l.y),br:l}}cancelRequestedRender(){this.nextRenderHandle&&(dct(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(t){}renderCanvas(t,e){if(this.destroyed)return;const r=this.viewportTransform,i=this.clipPath;this.calcViewportBoundaries(),this.clearContext(t),t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.patternQuality=this.patternQuality,this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(t,e),t.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(t),i&&(i._set("canvas",this),i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t,i)),this._renderOverlay(t),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(t),this.fire("after:render",{ctx:t}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(t,e){const r=this.viewportTransform;t.save(),t.transform(...r),t.globalCompositeOperation="destination-in",e.transform(t),t.scale(1/e.zoomX,1/e.zoomY),t.drawImage(e._cacheCanvas,-e.cacheTranslationX,-e.cacheTranslationY),t.restore()}_renderObjects(t,e){for(let r=0,i=e.length;r<i;++r)e[r]&&e[r].render(t)}_renderBackgroundOrOverlay(t,e){const r=this[`${e}Color`],i=this[`${e}Image`],s=this.viewportTransform,o=this[`${e}Vpt`];if(!r&&!i)return;const l=Si(r);if(r){if(t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=l?r.toLive(t):r,o&&t.transform(...s),l){t.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);const u=r.gradientTransform||r.patternTransform;u&&t.transform(...u)}t.fill(),t.restore()}if(i){t.save();const{skipOffscreen:u}=this;this.skipOffscreen=o,o&&t.transform(...s),i.render(t),this.skipOffscreen=u,t.restore()}}_renderBackground(t){this._renderBackgroundOrOverlay(t,"background")}_renderOverlay(t){this._renderBackgroundOrOverlay(t,"overlay")}getCenterPoint(){return new tt(this.width/2,this.height/2)}centerObjectH(t){return this._centerObject(t,new tt(this.getCenterPoint().x,t.getCenterPoint().y))}centerObjectV(t){return this._centerObject(t,new tt(t.getCenterPoint().x,this.getCenterPoint().y))}centerObject(t){return this._centerObject(t,this.getCenterPoint())}viewportCenterObject(t){return this._centerObject(t,this.getVpCenter())}viewportCenterObjectH(t){return this._centerObject(t,new tt(this.getVpCenter().x,t.getCenterPoint().y))}viewportCenterObjectV(t){return this._centerObject(t,new tt(t.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Dr(this.getCenterPoint(),Zi(this.viewportTransform))}_centerObject(t,e){t.setXY(e,Wt,Wt),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(t){return this.toDatalessObject(t)}toObject(t){return this._toObjectMethod("toObject",t)}toJSON(){return this.toObject()}toDatalessObject(t){return this._toObjectMethod("toDatalessObject",t)}_toObjectMethod(t,e){const r=this.clipPath,i=r&&!r.excludeFromExport?this._toObject(r,t,e):null;return{version:hE,...hf(this,e),objects:this._objects.filter(s=>!s.excludeFromExport).map(s=>this._toObject(s,t,e)),...this.__serializeBgOverlay(t,e),...i?{clipPath:i}:null}}_toObject(t,e,r){let i;this.includeDefaultValues||(i=t.includeDefaultValues,t.includeDefaultValues=!1);const s=t[e](r);return this.includeDefaultValues||(t.includeDefaultValues=!!i),s}__serializeBgOverlay(t,e){const r={},i=this.backgroundImage,s=this.overlayImage,o=this.backgroundColor,l=this.overlayColor;return Si(o)?o.excludeFromExport||(r.background=o.toObject(e)):o&&(r.background=o),Si(l)?l.excludeFromExport||(r.overlay=l.toObject(e)):l&&(r.overlay=l),i&&!i.excludeFromExport&&(r.backgroundImage=this._toObject(i,t,e)),s&&!s.excludeFromExport&&(r.overlayImage=this._toObject(s,t,e)),r}toSVG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;t.reviver=e;const r=[];var i;return this._setSVGPreamble(r,t),this._setSVGHeader(r,t),this.clipPath&&r.push(`<g clip-path="url(#${ne((i=this.clipPath.clipPathId)!==null&&i!==void 0?i:"")})" >
`),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",e),this._setSVGObjects(r,e),this.clipPath&&r.push(`</g>
`),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",e),r.push("</svg>"),r.join("")}_setSVGPreamble(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(t,e){const r=e.width||`${this.width}`,i=e.height||`${this.height}`,s=me.NUM_FRACTION_DIGITS,o=e.viewBox;let l;if(o)l=`viewBox="${o.x} ${o.y} ${o.width} ${o.height}" `;else if(this.svgViewportTransformation){const u=this.viewportTransform;l=`viewBox="${Ae(-u[4]/u[0],s)} ${Ae(-u[5]/u[3],s)} ${Ae(this.width/u[0],s)} ${Ae(this.height/u[3],s)}" `}else l=`viewBox="0 0 ${this.width} ${this.height}" `;t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',i,'" ',l,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",hE,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),`</defs>
`)}createSVGClipPathMarkup(t){const e=this.clipPath;return e?(e.clipPathId=`CLIPPATH_${Sl()}`,`<clipPath id="${e.clipPathId}" >
${e.toClipPathSVG(t.reviver)}</clipPath>
`):""}createSVGRefElementsMarkup(){return["background","overlay"].map(t=>{const e=this[`${t}Color`];if(Si(e)){const r=this[`${t}Vpt`],i=this.viewportTransform,s={isType:()=>!1,width:this.width/(r?i[0]:1),height:this.height/(r?i[3]:1)};return e.toSVG(s,{additionalTransform:r?Kp(i):""})}}).join("")}createSVGFontFacesMarkup(){const t=[],e={},r=me.fontPaths;this._objects.forEach(function s(o){t.push(o),x0(o)&&o._objects.forEach(s)}),t.forEach(s=>{if(!(o=s)||typeof o._renderText!="function")return;var o;const{styles:l,fontFamily:u}=s;!e[u]&&r[u]&&(e[u]=!0,l&&Object.values(l).forEach(h=>{Object.values(h).forEach(d=>{let{fontFamily:m=""}=d;!e[m]&&r[m]&&(e[m]=!0)})}))});const i=Object.keys(e).map(s=>`		@font-face {
			font-family: '${s}';
			src: url('${r[s]}');
		}
`).join("");return i?`	<style type="text/css"><![CDATA[
${i}]]></style>
`:""}_setSVGObjects(t,e){this.forEachObject(r=>{r.excludeFromExport||this._setSVGObject(t,r,e)})}_setSVGObject(t,e,r){t.push(e.toSVG(r))}_setSVGBgOverlayImage(t,e,r){const i=this[e];i&&!i.excludeFromExport&&i.toSVG&&t.push(i.toSVG(r))}_setSVGBgOverlayColor(t,e){const r=this[`${e}Color`];if(r)if(Si(r)){const i=r.repeat||"",s=this.width,o=this.height,l=this[`${e}Vpt`]?Kp(Zi(this.viewportTransform)):"";t.push(`<rect transform="${l} translate(${s/2},${o/2})" x="${r.offsetX-s/2}" y="${r.offsetY-o/2}" width="${i!=="repeat-y"&&i!=="no-repeat"||!BP(r)?s:r.source.width}" height="${i!=="repeat-x"&&i!=="no-repeat"||!BP(r)?o:r.source.height}" fill="url(#SVGID_${r.id})"></rect>
`)}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',`></rect>
`)}loadFromJSON(t,e){let{signal:r}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!t)return Promise.reject(new js("`json` is undefined"));const{objects:i=[],...s}=typeof t=="string"?JSON.parse(t):t,{backgroundImage:o,background:l,overlayImage:u,overlay:h,clipPath:d}=s,m=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Yp(i,{reviver:e,signal:r}),r_({backgroundImage:o,backgroundColor:l,overlayImage:u,overlayColor:h,clipPath:d},{signal:r})]).then(g=>{let[v,T]=g;return this.clear(),this.add(...v),this.set(s),this.set(T),this.renderOnAddRemove=m,this})}clone(t){const e=this.toObject(t);return this.cloneWithoutData().loadFromJSON(e)}cloneWithoutData(){const t=Ri(this);return new this.constructor(t)}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:r=1,multiplier:i=1,enableRetinaScaling:s=!1}=t,o=i*(s?this.getRetinaScaling():1);return k5(this.toCanvasElement(o,t),e,r)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:r=1,multiplier:i=1,enableRetinaScaling:s=!1}=t,o=i*(s?this.getRetinaScaling():1);return R5(this.toCanvasElement(o,t),e,r)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:e,height:r,left:i,top:s,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const l=(e||this.width)*t,u=(r||this.height)*t,h=this.getZoom(),d=this.width,m=this.height,g=this.skipControlsDrawing,v=h*t,T=this.viewportTransform,S=[v,0,0,v,(T[4]-(i||0))*t,(T[5]-(s||0))*t],w=this.enableRetinaScaling,E=Ri({width:l,height:u}),R=o?this._objects.filter(P=>o(P)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=S,this.width=l,this.height=u,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(E.getContext("2d"),R),this.viewportTransform=T,this.width=d,this.height=m,this.calcViewportBoundaries(),this.enableRetinaScaling=w,this.skipControlsDrawing=g,E}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Xv.cancelByCanvas(this),this.disposed=!0,new Promise((t,e)=>{const r=()=>{this.destroy(),t(!0)};r.kill=e,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?t(!1):this.nextRenderHandle?this.__cleanupTask=r:r()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(t=>t.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return`#<Canvas (${this.complexity()}): { objects: ${this._objects.length} }>`}}q(Cm,"ownDefaults",vct);const Tct=["touchstart","touchmove","touchend"],Sct=n=>{const t=P5(n.target),e=(function(r){const i=r.changedTouches;return i&&i[0]?i[0]:r})(n);return new tt(e.clientX+t.left,e.clientY+t.top)},mE=n=>Tct.includes(n.type)||n.pointerType==="touch",UP=n=>{n.preventDefault(),n.stopPropagation()},Fo=n=>{let t=0,e=0,r=0,i=0;for(let s=0,o=n.length;s<o;s++){const{x:l,y:u}=n[s];(l>r||!s)&&(r=l),(l<t||!s)&&(t=l),(u>i||!s)&&(i=u),(u<e||!s)&&(e=u)}return{left:t,top:e,width:r-t,height:i-e}},wct=(n,t)=>Jv(n,Kn(t,n.calcOwnMatrix())),Jv=(n,t)=>{const{translateX:e,translateY:r,scaleX:i,scaleY:s,...o}=Qv(t),l=new tt(e,r);n.flipX=!1,n.flipY=!1,Object.assign(n,o),n.set({scaleX:i,scaleY:s}),n.setPositionByOrigin(l,Wt,Wt)},xct=n=>{n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0)},j5=n=>({scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}),lA=(n,t,e)=>{const r=n/2,i=t/2,s=[new tt(-r,-i),new tt(r,-i),new tt(-r,i),new tt(r,i)].map(l=>l.transform(e)),o=Fo(s);return new tt(o.width,o.height)},i_=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tr;return Kn(Zi(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tr),n)},$h=function(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tr,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Tr;return n.transform(i_(t,e))},Ect=function(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tr,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Tr;return n.transform(i_(t,e),!0)},Cct=(n,t,e)=>{const r=i_(t,e);return Jv(n,Kn(r,n.calcOwnMatrix())),r},Act={left:-.5,top:-.5,center:0,bottom:.5,right:.5},fr=n=>typeof n=="string"?Act[n]:n-.5,kct=new tt(1,0),B5=new tt,F5=(n,t)=>n.rotate(t),Zv=(n,t)=>new tt(t).subtract(n),gE=n=>n.distanceFrom(B5),yE=(n,t)=>Math.atan2(gp(n,t),Rct(n,t)),U5=n=>yE(kct,n),cA=n=>n.eq(B5)?n:n.scalarDivide(gE(n)),z5=function(n){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return cA(new tt(-n.y,n.x).scalarMultiply(t?1:-1))},gp=(n,t)=>n.x*t.y-n.y*t.x,Rct=(n,t)=>n.x*t.x+n.y*t.y,zP=(n,t,e)=>{if(n.eq(t)||n.eq(e))return!0;const r=gp(t,e),i=gp(t,n),s=gp(e,n);return r>=0?i>=0&&s<=0:!(i<=0&&s>=0)},tb="not-allowed";function H5(n){return fr(n.originX)===fr(Wt)&&fr(n.originY)===fr(Wt)}function HP(n){return .5-fr(n)}const ss=(n,t)=>n[t],$5=(n,t,e,r)=>({e:n,transform:t,pointer:new tt(e,r)});function q5(n,t,e){const r=e,i=$h(n.getCenterPoint(),n.canvas.viewportTransform,void 0),s=U5(Zv(i,r))+Hh;return Math.round(s%Hh/cct)}function uA(n,t,e,r,i){var s;let{target:o,corner:l}=n;const u=o.controls[l],h=((s=o.canvas)===null||s===void 0?void 0:s.getZoom())||1,d=o.padding/h,m=(function(g,v,T,S){const w=g.getRelativeCenterPoint(),E=T!==void 0&&S!==void 0?g.translateToGivenOrigin(w,Wt,Wt,T,S):new tt(g.left,g.top);return(g.angle?v.rotate(-sn(g.angle),w):v).subtract(E)})(o,new tt(r,i),t,e);return m.x>=d&&(m.x-=d),m.x<=-d&&(m.x+=d),m.y>=d&&(m.y-=d),m.y<=d&&(m.y+=d),m.x-=u.offsetX,m.y-=u.offsetY,m}const eb=n=>n.replace(/\s+/g," "),$P={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Cw=(n,t,e)=>(e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+6*(t-n)*e:e<.5?t:e<2/3?n+(t-n)*(2/3-e)*6:n),qP=(n,t,e,r)=>{n/=255,t/=255,e/=255;const i=Math.max(n,t,e),s=Math.min(n,t,e);let o,l;const u=(i+s)/2;if(i===s)o=l=0;else{const h=i-s;switch(l=u>.5?h/(2-i-s):h/(i+s),i){case n:o=(t-e)/h+(t<e?6:0);break;case t:o=(e-n)/h+2;break;case e:o=(n-t)/h+4}o/=6}return[Math.round(360*o),Math.round(100*l),Math.round(100*u),r]},GP=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(n)/(n.endsWith("%")?100:1)},Ay=n=>Math.min(Math.round(n),255).toString(16).toUpperCase().padStart(2,"0"),WP=n=>{let[t,e,r,i=1]=n;const s=Math.round(.3*t+.59*e+.11*r);return[s,s,s,i]};class Te{constructor(t){if(q(this,"isUnrecognised",!1),t)if(t instanceof Te)this.setSource([...t._source]);else if(Array.isArray(t)){const[e,r,i,s=1]=t;this.setSource([e,r,i,s])}else this.setSource(this._tryParsingColor(t));else this.setSource([0,0,0,1])}_tryParsingColor(t){return(t=t.toLowerCase())in $P&&(t=$P[t]),t==="transparent"?[255,255,255,0]:Te.sourceFromHex(t)||Te.sourceFromRgb(t)||Te.sourceFromHsl(t)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(t){this._source=t}toRgb(){const[t,e,r]=this.getSource();return`rgb(${t},${e},${r})`}toRgba(){return`rgba(${this.getSource().join(",")})`}toHsl(){const[t,e,r]=qP(...this.getSource());return`hsl(${t},${e}%,${r}%)`}toHsla(){const[t,e,r,i]=qP(...this.getSource());return`hsla(${t},${e}%,${r}%,${i})`}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[t,e,r,i]=this.getSource();return`${Ay(t)}${Ay(e)}${Ay(r)}${Ay(Math.round(255*i))}`}getAlpha(){return this.getSource()[3]}setAlpha(t){return this._source[3]=t,this}toGrayscale(){return this.setSource(WP(this.getSource())),this}toBlackWhite(t){const[e,,,r]=WP(this.getSource()),i=e<(t||127)?0:255;return this.setSource([i,i,i,r]),this}overlayWith(t){t instanceof Te||(t=new Te(t));const e=this.getSource(),r=t.getSource(),[i,s,o]=e.map((l,u)=>Math.round(.5*l+.5*r[u]));return this.setSource([i,s,o,e[3]]),this}static fromRgb(t){return Te.fromRgba(t)}static fromRgba(t){return new Te(Te.sourceFromRgb(t))}static sourceFromRgb(t){const e=eb(t).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(e){const[r,i,s]=e.slice(1,4).map(o=>{const l=parseFloat(o);return o.endsWith("%")?Math.round(2.55*l):l});return[r,i,s,GP(e[4])]}}static fromHsl(t){return Te.fromHsla(t)}static fromHsla(t){return new Te(Te.sourceFromHsl(t))}static sourceFromHsl(t){const e=eb(t).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!e)return;const r=(Te.parseAngletoDegrees(e[1])%360+360)%360/360,i=parseFloat(e[2])/100,s=parseFloat(e[3])/100;let o,l,u;if(i===0)o=l=u=s;else{const h=s<=.5?s*(i+1):s+i-s*i,d=2*s-h;o=Cw(d,h,r+1/3),l=Cw(d,h,r),u=Cw(d,h,r-1/3)}return[Math.round(255*o),Math.round(255*l),Math.round(255*u),GP(e[4])]}static fromHex(t){return new Te(Te.sourceFromHex(t))}static sourceFromHex(t){if(t.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const e=t.slice(t.indexOf("#")+1);let r;r=e.length<=4?e.split("").map(u=>u+u):e.match(/.{2}/g);const[i,s,o,l=255]=r.map(u=>parseInt(u,16));return[i,s,o,l/255]}}static parseAngletoDegrees(t){const e=t.toLowerCase(),r=parseFloat(e);return e.includes("rad")?wl(r):e.includes("turn")?360*r:r}}const Rh=function(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tA;const e=/\D{0,2}$/.exec(n),r=parseFloat(n),i=me.DPI;switch(e?.[0]){case"mm":return r*i/25.4;case"cm":return r*i/2.54;case"in":return r*i;case"pt":return r*i/72;case"pc":return r*i/72*12;case"em":return r*t;default:return r}},Mct=n=>{const[t,e]=n.trim().split(" "),[r,i]=(s=t)&&s!==Lr?[s.slice(1,4),s.slice(5,8)]:s===Lr?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:e||"meet",alignX:r,alignY:i}},Xp=function(n,t){let e,r,i=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(t)if(t.toLive)e=`url(#SVGID_${ne(t.id)})`;else{const s=new Te(t),o=s.getAlpha();e=s.toRgb(),o!==1&&(r=o.toString())}else e="none";return i?`${n}: ${e}; ${r?`${n}-opacity: ${r}; `:""}`:`${n}="${e}" ${r?`${n}-opacity="${r}" `:""}`};class G5{getSvgStyles(t){const e=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):Lr,s=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=this.opacity!==void 0?this.opacity:"1",d=this.visible?"":" visibility: hidden;",m=t?"":this.getSvgFilter(),g=Xp(Nn,this.fill);return[Xp(ti,this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",u,"; ",g,"fill-rule: ",e,"; ","opacity: ",h,";",m,d].map(v=>ne(v)).join("")}getSvgFilter(){return this.shadow?`filter: url(#SVGID_${ne(this.shadow.id)});`:""}getSvgCommons(){return[this.id?`id="${ne(String(this.id))}" `:"",this.clipPath?`clip-path="url(#${this.clipPath.clipPathId})" `:""].join("")}getSvgTransform(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=t?this.calcTransformMatrix():this.calcOwnMatrix();return`${`transform="${Kp(r)}`}${e}" `}_toSVG(t){return[""]}toSVG(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})}toClipPathSVG(t){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})}_createBaseClipPathSVGMarkup(t){let{reviver:e,additionalTransform:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),s=t.indexOf("COMMON_PARTS");return t[s]=i,e?e(t.join("")):t.join("")}_createBaseSVGMarkup(t){let{noStyle:e,reviver:r,withShadow:i,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=e?"":`style="${this.getSvgStyles()}" `,l=i?`style="${this.getSvgFilter()}" `:"",u=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",d=u&&u.absolutePositioned,m=this.stroke,g=this.fill,v=this.shadow,T=[],S=t.indexOf("COMMON_PARTS");let w;u&&(u.clipPathId=`CLIPPATH_${Sl()}`,w=`<clipPath id="${u.clipPathId}" >
${u.toClipPathSVG(r)}</clipPath>
`),d&&T.push("<g ",l,this.getSvgCommons(),` >
`),T.push("<g ",this.getSvgTransform(!1),d?"":l+this.getSvgCommons(),` >
`);const E=[o,h,e?"":this.addPaintOrder()," ",s?`transform="${s}" `:""].join("");return t[S]=E,Si(g)&&T.push(g.toSVG(this)),Si(m)&&T.push(m.toSVG(this)),v&&T.push(v.toSVG(this)),u&&T.push(w),T.push(t.join("")),T.push(`</g>
`),d&&T.push(`</g>
`),r?r(T.join("")):T.join("")}addPaintOrder(){return this.paintFirst!==Nn?` paint-order="${ne(this.paintFirst)}" `:""}}function s_(n){return new RegExp("^("+n.join("|")+")\\b","i")}const ru="textDecorationThickness",W5=["fontSize","fontWeight","fontFamily","fontStyle"],Y5=["underline","overline","linethrough"],K5=[...W5,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],X5=[...K5,...Y5,"textBackgroundColor","direction",ru],Dct=[...W5,...Y5,ti,"strokeWidth",Nn,"deltaY","textBackgroundColor",ru],Oct={_reNewline:eA,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:dE,fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:ue,fontStyle:dE,lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:ue,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:_c,CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[ru]:66.667},Bs="justify",nb="justify-left",yp="justify-right",vp="justify-center",iu=String.raw`[-+]?(?:\d*\.\d+|\d+\.?)(?:[eE][-+]?\d+)?`,Ict=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+iu+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+iu+"))?\\s+(.*)"),Pct={cx:ue,x:ue,r:"radius",cy:Nr,y:Nr,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":ru},Aw="font-size",kw="clip-path";s_(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);s_(["symbol","image","marker","pattern","view","svg"]);const YP=s_(["symbol","g","a","svg","clipPath","defs"]),KP="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",XP=new RegExp("(?:\\s|^)"+KP+KP+"("+iu+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Gs{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof t=="string"?Gs.parseShadow(t):t;Object.assign(this,Gs.ownDefaults,e),this.id=Sl()}static parseShadow(t){const e=t.trim(),[,r=0,i=0,s=0]=(XP.exec(e)||[]).map(o=>parseFloat(o)||0);return{color:(e.replace(XP,"")||"rgb(0,0,0)").trim(),offsetX:r,offsetY:i,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(t){const e=F5(new tt(this.offsetX,this.offsetY),sn(-t.angle)),r=me.NUM_FRACTION_DIGITS,i=new Te(this.color);let s=40,o=40;return t.width&&t.height&&(s=100*Ae((Math.abs(e.x)+this.blur)/t.width,r)+20,o=100*Ae((Math.abs(e.y)+this.blur)/t.height,r)+20),t.flipX&&(e.x*=-1),t.flipY&&(e.y*=-1),`<filter id="SVGID_${ne(this.id)}" y="-${o}%" height="${100+2*o}%" x="-${s}%" width="${100+2*s}%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="${Ae(this.blur?this.blur/2:0,r)}"></feGaussianBlur>
	<feOffset dx="${Ae(e.x,r)}" dy="${Ae(e.y,r)}" result="oBlur" ></feOffset>
	<feFlood flood-color="${i.toRgb()}" flood-opacity="${i.getAlpha()}"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`}toObject(){const t={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},e=Gs.ownDefaults;return this.includeDefaultValues?t:oA(t,(r,i)=>r!==e[i])}static async fromObject(t){return new this(t)}}q(Gs,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),q(Gs,"type","shadow"),_t.setClass(Gs,"shadow");const qh=(n,t,e)=>Math.max(n,Math.min(t,e)),Nct=[Nr,ue,Vr,ki,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",lf,cf],Jo=[Nn,ti,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],Lct={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Wt,originY:Wt,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Nn,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},Vct=(n,t,e,r)=>-e*Math.cos(n/r*xm)+e+t,jct=()=>!1;class hA{constructor(t){let{startValue:e,byValue:r,duration:i=500,delay:s=0,easing:o=Vct,onStart:l=w0,onChange:u=w0,onComplete:h=w0,abort:d=jct,target:m}=t;q(this,"_state","pending"),q(this,"durationProgress",0),q(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=i,this.delay=s,this.easing=o,this._onStart=l,this._onChange=u,this._onComplete=h,this._abort=d,this.target=m,this.startValue=e,this.byValue=r,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const t=e=>{this._state==="pending"&&(this.startTime=e||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>E0(t),this.delay):E0(t)}tick(t){const e=(t||+new Date)-this.startTime,r=Math.min(e,this.duration);this.durationProgress=r/this.duration;const{value:i,valueProgress:s}=this.calculate(r);this.value=Object.freeze(i),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):e>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),E0(this.tick)))}register(){Xv.push(this)}unregister(){Xv.remove(this)}abort(){this._state="aborted",this.unregister()}}class Bct extends hA{constructor(t){let{startValue:e=0,endValue:r=100,...i}=t;super({...i,startValue:e,byValue:r-e})}calculate(t){const e=this.easing(t,this.startValue,this.byValue,this.duration);return{value:e,valueProgress:Math.abs((e-this.startValue)/this.byValue)}}}class Fct extends hA{constructor(t){let{startValue:e=[0],endValue:r=[100],...i}=t;super({...i,startValue:e,byValue:r.map((s,o)=>s-e[o])})}calculate(t){const e=this.startValue.map((r,i)=>this.easing(t,r,this.byValue[i],this.duration,i));return{value:e,valueProgress:Math.abs((e[0]-this.startValue[0])/this.byValue[0])}}}const Uct=(n,t,e,r)=>t+e*(1-Math.cos(n/r*xm)),Rw=n=>n&&((t,e,r)=>n(new Te(t).toRgba(),e,r));class zct extends hA{constructor(t){let{startValue:e,endValue:r,easing:i=Uct,onChange:s,onComplete:o,abort:l,...u}=t;const h=new Te(e).getSource(),d=new Te(r).getSource();super({...u,startValue:h,byValue:d.map((m,g)=>m-h[g]),easing:i,onChange:Rw(s),onComplete:Rw(o),abort:Rw(l)})}calculate(t){const[e,r,i,s]=this.startValue.map((l,u)=>this.easing(t,l,this.byValue[u],this.duration,u)),o=[...[e,r,i].map(Math.round),qh(0,s,1)];return{value:o,valueProgress:o.map((l,u)=>this.byValue[u]!==0?Math.abs((l-this.startValue[u])/this.byValue[u]):0).find(l=>l!==0)||0}}}function Q5(n){const t=(e=>Array.isArray(e.startValue)||Array.isArray(e.endValue))(n)?new Fct(n):new Bct(n);return t.start(),t}function Hct(n){const t=new zct(n);return t.start(),t}class je{constructor(t){this.status=t,this.points=[]}includes(t){return this.points.some(e=>e.eq(t))}append(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.points=this.points.concat(e.filter(i=>!this.includes(i))),this}static isPointContained(t,e,r){let i=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(e.eq(r))return t.eq(e);if(e.x===r.x)return t.x===e.x&&(i||t.y>=Math.min(e.y,r.y)&&t.y<=Math.max(e.y,r.y));if(e.y===r.y)return t.y===e.y&&(i||t.x>=Math.min(e.x,r.x)&&t.x<=Math.max(e.x,r.x));{const s=Zv(e,r),o=Zv(e,t).divide(s);return i?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(t,e){const r=new tt(t).setX(Math.min(t.x-1,...e.map(s=>s.x)));let i=0;for(let s=0;s<e.length;s++){const o=this.intersectSegmentSegment(e[s],e[(s+1)%e.length],t,r);if(o.includes(t))return!0;i+=+(o.status==="Intersection")}return i%2==1}static intersectLineLine(t,e,r,i){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const l=e.x-t.x,u=e.y-t.y,h=i.x-r.x,d=i.y-r.y,m=t.x-r.x,g=t.y-r.y,v=h*g-d*m,T=l*g-u*m,S=d*l-h*u;if(S!==0){const w=v/S,E=T/S;return(s||0<=w&&w<=1)&&(o||0<=E&&E<=1)?new je("Intersection").append(new tt(t.x+w*l,t.y+w*u)):new je}if(v===0||T===0){const w=s||o||je.isPointContained(t,r,i)||je.isPointContained(e,r,i)||je.isPointContained(r,t,e)||je.isPointContained(i,t,e);return new je(w?"Coincident":void 0)}return new je("Parallel")}static intersectSegmentLine(t,e,r,i){return je.intersectLineLine(t,e,r,i,!1,!0)}static intersectSegmentSegment(t,e,r,i){return je.intersectLineLine(t,e,r,i,!1,!1)}static intersectLinePolygon(t,e,r){let i=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const s=new je,o=r.length;for(let l,u,h,d=0;d<o;d++){if(l=r[d],u=r[(d+1)%o],h=je.intersectLineLine(t,e,l,u,i,!1),h.status==="Coincident")return h;s.append(...h.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(t,e,r){return je.intersectLinePolygon(t,e,r,!1)}static intersectPolygonPolygon(t,e){const r=new je,i=t.length,s=[];for(let o=0;o<i;o++){const l=t[o],u=t[(o+1)%i],h=je.intersectSegmentPolygon(l,u,e);h.status==="Coincident"?(s.push(h),r.append(l,u)):r.append(...h.points)}return s.length>0&&s.length===t.length?new je("Coincident"):(r.points.length>0&&(r.status="Intersection"),r)}static intersectPolygonRectangle(t,e,r){const i=e.min(r),s=e.max(r),o=new tt(s.x,i.y),l=new tt(i.x,s.y);return je.intersectPolygonPolygon(t,[i,o,s,l])}}class $ct extends A5{getX(){return this.getXY().x}setX(t){this.setXY(this.getXY().setX(t))}getY(){return this.getXY().y}setY(t){this.setXY(this.getXY().setY(t))}getRelativeX(){return this.left}setRelativeX(t){this.left=t}getRelativeY(){return this.top}setRelativeY(t){this.top=t}getXY(){const t=this.getRelativeXY();return this.group?Dr(t,this.group.calcTransformMatrix()):t}setXY(t,e,r){this.group&&(t=Dr(t,Zi(this.group.calcTransformMatrix()))),this.setRelativeXY(t,e,r)}getRelativeXY(){return new tt(this.left,this.top)}setRelativeXY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(t,e,r)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:t,tr:e,br:r,bl:i}=this.aCoords||(this.aCoords=this.calcACoords()),s=[t,e,r,i];if(this.group){const o=this.group.calcTransformMatrix();return s.map(l=>Dr(l,o))}return s}intersectsWithRect(t,e){return je.intersectPolygonRectangle(this.getCoords(),t,e).status==="Intersection"}intersectsWithObject(t){const e=je.intersectPolygonPolygon(this.getCoords(),t.getCoords());return e.status==="Intersection"||e.status==="Coincident"||t.isContainedWithinObject(this)||this.isContainedWithinObject(t)}isContainedWithinObject(t){return this.getCoords().every(e=>t.containsPoint(e))}isContainedWithinRect(t,e){const{left:r,top:i,width:s,height:o}=this.getBoundingRect();return r>=t.x&&r+s<=e.x&&i>=t.y&&i+o<=e.y}isOverlapping(t){return this.intersectsWithObject(t)||this.isContainedWithinObject(t)||t.isContainedWithinObject(this)}containsPoint(t){return je.isPointInPolygon(t,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return!!this.getCoords().some(r=>r.x<=e.x&&r.x>=t.x&&r.y<=e.y&&r.y>=t.y)||!!this.intersectsWithRect(t,e)||this.containsPoint(t.midPointFrom(e))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return this.intersectsWithRect(t,e)?!0:this.getCoords().every(r=>(r.x>=e.x||r.x<=t.x)&&(r.y>=e.y||r.y<=t.y))&&this.containsPoint(t.midPointFrom(e))}getBoundingRect(){return Fo(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(t){this._set(Vr,t),this._set(ki,t),this.setCoords()}scaleToWidth(t){const e=this.getBoundingRect().width/this.getScaledWidth();return this.scale(t/this.width/e)}scaleToHeight(t){const e=this.getBoundingRect().height/this.getScaledHeight();return this.scale(t/this.height/e)}getCanvasRetinaScaling(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.getRetinaScaling())||1}getTotalAngle(){return this.group?wl(M5(this.calcTransformMatrix())):this.angle}getViewportTransform(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.viewportTransform)||Tr.concat()}calcACoords(){const t=uf({angle:this.angle}),{x:e,y:r}=this.getRelativeCenterPoint(),i=Em(e,r),s=Kn(i,t),o=this._getTransformedDimensions(),l=o.x/2,u=o.y/2;return{tl:Dr({x:-l,y:-u},s),tr:Dr({x:l,y:-u},s),bl:Dr({x:-l,y:u},s),br:Dr({x:l,y:u},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=[];return!t&&this.group&&(e=this.group.transformMatrixKey(t)),e.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,fr(this.originX),fr(this.originY)),e}calcTransformMatrix(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=this.calcOwnMatrix();if(t||!this.group)return e;const r=this.transformMatrixKey(t),i=this.matrixCache;return i&&i.key.every((s,o)=>s===r[o])?i.value:(this.group&&(e=Kn(this.group.calcTransformMatrix(!1),e)),this.matrixCache={key:r,value:e},e)}calcOwnMatrix(){const t=this.transformMatrixKey(!0),e=this.ownMatrixCache;if(e&&e.key.every((o,l)=>o===t[l]))return e.value;const r=this.getRelativeCenterPoint(),i={angle:this.angle,translateX:r.x,translateY:r.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=yct(i);return this.ownMatrixCache={key:t,value:s},s}_getNonTransformedDimensions(){return new tt(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(t){return this._getTransformedDimensions(t).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth,...t},r=e.strokeWidth;let i=r,s=0;this.strokeUniform&&(i=0,s=r);const o=e.width+i,l=e.height+i;let u;return u=e.skewX===0&&e.skewY===0?new tt(o*e.scaleX,l*e.scaleY):lA(o,l,n_(e)),u.scalarAdd(s)}translateToGivenOrigin(t,e,r,i,s){let o=t.x,l=t.y;const u=fr(i)-fr(e),h=fr(s)-fr(r);if(u||h){const d=this._getTransformedDimensions();o+=u*d.x,l+=h*d.y}return new tt(o,l)}translateToCenterPoint(t,e,r){if(e===Wt&&r===Wt)return t;const i=this.translateToGivenOrigin(t,e,r,Wt,Wt);return this.angle?i.rotate(sn(this.angle),t):i}translateToOriginPoint(t,e,r){const i=this.translateToGivenOrigin(t,Wt,Wt,e,r);return this.angle?i.rotate(sn(this.angle),t):i}getCenterPoint(){const t=this.getRelativeCenterPoint();return this.group?Dr(t,this.group.calcTransformMatrix()):t}getRelativeCenterPoint(){return this.translateToCenterPoint(new tt(this.left,this.top),this.originX,this.originY)}getPointByOrigin(t,e){return this.getPositionByOrigin(t,e)}getPositionByOrigin(t,e){return this.translateToOriginPoint(this.getRelativeCenterPoint(),t,e)}setPositionByOrigin(t,e,r){const i=this.translateToCenterPoint(t,e,r),s=this.translateToOriginPoint(i,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.getPositionByOrigin(ue,Nr)}positionByLeftTop(t){return this.setPositionByOrigin(t,ue,Nr)}}let xo=class A0 extends $ct{static getDefaults(){return A0.ownDefaults}get type(){const t=this.constructor.type;return t==="FabricObject"?"object":t.toLowerCase()}set type(t){Tl("warn","Setting type has no effect",t)}constructor(t){super(),q(this,"_cacheContext",null),Object.assign(this,A0.ownDefaults),this.setOptions(t)}_createCacheCanvas(){this._cacheCanvas=Ko(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(t){const e=t.width,r=t.height,i=me.maxCacheSideLimit,s=me.minCacheSideLimit;if(e<=i&&r<=i&&e*r<=me.perfLimitSizeTotal)return e<s&&(t.width=s),r<s&&(t.height=s),t;const o=e/r,[l,u]=mp.limitDimsByArea(o),h=qh(s,l,i),d=qh(s,u,i);return e>h&&(t.zoomX/=e/h,t.width=h,t.capped=!0),r>d&&(t.zoomY/=r/d,t.height=d,t.capped=!0),t}_getCacheCanvasDimensions(){const t=this.getTotalObjectScaling(),e=this._getTransformedDimensions({skewX:0,skewY:0}),r=e.x*t.x/this.scaleX,i=e.y*t.y/this.scaleY;return{width:Math.ceil(r+2),height:Math.ceil(i+2),zoomX:t.x,zoomY:t.y,x:r,y:i}}_updateCacheCanvas(){const t=this._cacheCanvas,e=this._cacheContext,{width:r,height:i,zoomX:s,zoomY:o,x:l,y:u}=this._limitCacheSize(this._getCacheCanvasDimensions()),h=r!==t.width||i!==t.height,d=this.zoomX!==s||this.zoomY!==o;if(!t||!e)return!1;if(h||d){r!==t.width||i!==t.height?(t.width=r,t.height=i):(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height));const m=l/2,g=u/2;return this.cacheTranslationX=Math.round(t.width/2-m)+m,this.cacheTranslationY=Math.round(t.height/2-g)+g,e.translate(this.cacheTranslationX,this.cacheTranslationY),e.scale(s,o),this.zoomX=s,this.zoomY=o,!0}return!1}setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(t)}transform(t){const e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,r=this.calcTransformMatrix(!e);t.transform(r[0],r[1],r[2],r[3],r[4],r[5])}getObjectScaling(){if(!this.group)return new tt(Math.abs(this.scaleX),Math.abs(this.scaleY));const t=Qv(this.calcTransformMatrix());return new tt(Math.abs(t.scaleX),Math.abs(t.scaleY))}getTotalObjectScaling(){const t=this.getObjectScaling();if(this.canvas){const e=this.canvas.getZoom(),r=this.getCanvasRetinaScaling();return t.scalarMultiply(e*r)}return t}getObjectOpacity(){let t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t}_constrainScale(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t===0?1e-4:t}_set(t,e){t!==Vr&&t!==ki||(e=this._constrainScale(e)),t===Vr&&e<0?(this.flipX=!this.flipX,e*=-1):t==="scaleY"&&e<0?(this.flipY=!this.flipY,e*=-1):t!=="shadow"||!e||e instanceof Gs||(e=new Gs(e));const r=this[t]!==e;return this[t]=e,r&&this.constructor.cacheProperties.includes(t)&&(this.dirty=!0),this.parent&&(this.dirty||r&&this.constructor.stateProperties.includes(t))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.drawObject(t,!1,{}),this.dirty=!1),t.restore())}drawSelectionBackground(t){}renderCache(t){if(t=t||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:e,zoomY:r,cacheTranslationX:i,cacheTranslationY:s}=this,{width:o,height:l}=this._cacheCanvas;this.drawObject(this._cacheContext,t.forClipping,{zoomX:e,zoomY:r,cacheTranslationX:i,cacheTranslationY:s,width:o,height:l,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return!!this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return!!this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===ti&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(t,e,r){t.save(),e.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",t.setTransform(1,0,0,1,0,0),t.drawImage(r,0,0),t.restore()}drawObject(t,e,r){const i=this.fill,s=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this.fire("before:render",{ctx:t}),this._render(t),this._drawClipPath(t,this.clipPath,r),this.fill=i,this.stroke=s}createClipPathLayer(t,e){const r=Ri(e),i=r.getContext("2d");if(i.translate(e.cacheTranslationX,e.cacheTranslationY),i.scale(e.zoomX,e.zoomY),t._cacheCanvas=r,e.parentClipPaths.forEach(s=>{s.transform(i)}),e.parentClipPaths.push(t),t.absolutePositioned){const s=Zi(this.calcTransformMatrix());i.transform(s[0],s[1],s[2],s[3],s[4],s[5])}return t.transform(i),t.drawObject(i,!0,e),r}_drawClipPath(t,e,r){if(!e)return;e._transformDone=!0;const i=this.createClipPathLayer(e,r);this.drawClipPathOnCache(t,e,i)}drawCacheOnCanvas(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const e=this._cacheCanvas,r=this._cacheContext;return!(!e||!r||t||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(e&&r&&!t&&(r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,e.width,e.height),r.restore()),!0)}_renderBackground(t){if(!this.backgroundColor)return;const e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}_setOpacity(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity}_setStrokeStyles(t,e){const r=e.stroke;r&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,Si(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(t,r):(t.strokeStyle=r.toLive(t),this._applyPatternGradientTransform(t,r)):t.strokeStyle=e.stroke)}_setFillStyles(t,e){let{fill:r}=e;r&&(Si(r)?(t.fillStyle=r.toLive(t),this._applyPatternGradientTransform(t,r)):t.fillStyle=r)}_setClippingProperties(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"}_setLineDash(t,e){e&&e.length!==0&&t.setLineDash(e)}_setShadow(t){if(!this.shadow)return;const e=this.shadow,r=this.canvas,i=this.getCanvasRetinaScaling(),[s,,,o]=r?.viewportTransform||Tr,l=s*i,u=o*i,h=e.nonScaling?new tt(1,1):this.getObjectScaling();t.shadowColor=e.color,t.shadowBlur=e.blur*me.browserShadowBlurConstant*(l+u)*(h.x+h.y)/4,t.shadowOffsetX=e.offsetX*l*h.x,t.shadowOffsetY=e.offsetY*u*h.y}_removeShadow(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)}_applyPatternGradientTransform(t,e){if(!Si(e))return{offsetX:0,offsetY:0};const r=e.gradientTransform||e.patternTransform,i=-this.width/2+e.offsetX||0,s=-this.height/2+e.offsetY||0;return e.gradientUnits==="percentage"?t.transform(this.width,0,0,this.height,i,s):t.transform(1,0,0,1,i,s),r&&t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:i,offsetY:s}}_renderPaintInOrder(t){this.paintFirst===ti?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))}_render(t){}_renderFill(t){this.fill&&(t.save(),this._setFillStyles(t,this),this.fillRule==="evenodd"?t.fill("evenodd"):t.fill(),t.restore())}_renderStroke(t){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform){const e=this.getObjectScaling();t.scale(1/e.x,1/e.y)}this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}}_applyPatternForTransformedGradient(t,e){var r;const i=this._limitCacheSize(this._getCacheCanvasDimensions()),s=this.getCanvasRetinaScaling(),o=i.x/this.scaleX/s,l=i.y/this.scaleY/s,u=Ri({width:Math.ceil(o),height:Math.ceil(l)}),h=u.getContext("2d");h&&(h.beginPath(),h.moveTo(0,0),h.lineTo(o,0),h.lineTo(o,l),h.lineTo(0,l),h.closePath(),h.translate(o/2,l/2),h.scale(i.zoomX/this.scaleX/s,i.zoomY/this.scaleY/s),this._applyPatternGradientTransform(h,e),h.fillStyle=e.toLive(t),h.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(s*this.scaleX/i.zoomX,s*this.scaleY/i.zoomY),t.strokeStyle=(r=h.createPattern(u,"no-repeat"))!==null&&r!==void 0?r:"")}_findCenterFromElement(){return new tt(this.left+this.width/2,this.top+this.height/2)}clone(t){const e=this.toObject(t);return this.constructor.fromObject(e)}cloneAsImage(t){const e=this.toCanvasElement(t);return new(_t.getClass("image"))(e)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=j5(this),r=this.group,i=this.shadow,s=Math.abs,o=t.enableRetinaScaling?S5():1,l=(t.multiplier||1)*o,u=t.canvasProvider||(R=>new Cm(R,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,t.withoutTransform&&xct(this),t.withoutShadow&&(this.shadow=null),t.viewportTransform&&Cct(this,this.getViewportTransform()),this.setCoords();const h=Ko(),d=this.getBoundingRect(),m=this.shadow,g=new tt;if(m){const R=m.blur,P=m.nonScaling?new tt(1,1):this.getObjectScaling();g.x=2*Math.round(s(m.offsetX)+R)*s(P.x),g.y=2*Math.round(s(m.offsetY)+R)*s(P.y)}const v=d.width+g.x,T=d.height+g.y;h.width=Math.ceil(v),h.height=Math.ceil(T);const S=u(h);t.format==="jpeg"&&(S.backgroundColor="#fff"),this.setPositionByOrigin(new tt(S.width/2,S.height/2),Wt,Wt);const w=this.canvas;S._objects=[this],this.set("canvas",S),this.setCoords();const E=S.toCanvasElement(l||1,t);return this.set("canvas",w),this.shadow=i,r&&(this.group=r),this.set(e),this.setCoords(),S._objects=[],S.destroy(),E}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return k5(this.toCanvasElement(t),t.format||"png",t.quality||1)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return R5(this.toCanvasElement(t),t.format||"png",t.quality||1)}isType(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.includes(this.constructor.type)||e.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(t){const{centeredRotation:e,originX:r,originY:i}=this;if(e){const{x:s,y:o}=this.getRelativeCenterPoint();this.originX=Wt,this.originY=Wt,this.left=s,this.top=o}if(this.set("angle",t),e){const{x:s,y:o}=this.getPositionByOrigin(r,i);this.left=s,this.top=o,this.originX=r,this.originY=i}}setOnGroup(){}_setupCompositeOperation(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Xv.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Js().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(t,e){return Object.entries(t).reduce((r,i)=>{let[s,o]=i;return r[s]=this._animate(s,o,e),r},{})}_animate(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=t.split("."),s=this.constructor.colorProperties.includes(i[i.length-1]),{abort:o,startValue:l,onChange:u,onComplete:h}=r,d={...r,target:this,startValue:l??i.reduce((m,g)=>m[g],this),endValue:e,abort:o?.bind(this),onChange:(m,g,v)=>{i.reduce((T,S,w)=>(w===i.length-1&&(T[S]=m),T[S]),this),u&&u(m,g,v)},onComplete:(m,g,v)=>{this.setCoords(),h&&h(m,g,v)}};return s?Hct(d):Q5(d)}isDescendantOf(t){const{parent:e,group:r}=this;return e===t||r===t||!!e&&e.isDescendantOf(t)||!!r&&r!==e&&r.isDescendantOf(t)}getAncestors(){const t=[];let e=this;do e=e.parent,e&&t.push(e);while(e);return t}findCommonAncestors(t){if(this===t)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const e=this.getAncestors(),r=t.getAncestors();if(e.length===0&&r.length>0&&this===r[r.length-1])return{fork:[],otherFork:[t,...r.slice(0,r.length-1)],common:[this]};for(let i,s=0;s<e.length;s++){if(i=e[s],i===t)return{fork:[this,...e.slice(0,s)],otherFork:[],common:e.slice(s)};for(let o=0;o<r.length;o++){if(this===r[o])return{fork:[],otherFork:[t,...r.slice(0,o)],common:[this,...e]};if(i===r[o])return{fork:[this,...e.slice(0,s)],otherFork:[t,...r.slice(0,o)],common:e.slice(s)}}}return{fork:[this,...e],otherFork:[t,...r],common:[]}}hasCommonAncestors(t){const e=this.findCommonAncestors(t);return e&&!!e.common.length}isInFrontOf(t){if(this===t)return;const e=this.findCommonAncestors(t);if(e.fork.includes(t))return!0;if(e.otherFork.includes(this))return!1;const r=e.common[0]||this.canvas;if(!r)return;const i=e.fork.pop(),s=e.otherFork.pop(),o=r._objects.indexOf(i),l=r._objects.indexOf(s);return o>-1&&o>l}toObject(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(A0.customProperties,this.constructor.customProperties||[]);let e;const r=me.NUM_FRACTION_DIGITS,{clipPath:i,fill:s,stroke:o,shadow:l,strokeDashArray:u,left:h,top:d,originX:m,originY:g,width:v,height:T,strokeWidth:S,strokeLineCap:w,strokeDashOffset:E,strokeLineJoin:R,strokeUniform:P,strokeMiterLimit:j,scaleX:N,scaleY:W,angle:M,flipX:k,flipY:O,opacity:B,visible:F,backgroundColor:H,fillRule:V,paintFirst:yt,globalCompositeOperation:xt,skewX:J,skewY:st}=this;i&&!i.excludeFromExport&&(e=i.toObject(t.concat("inverted","absolutePositioned")));const ht=Vt=>Ae(Vt,r),Ct={...hf(this,t),type:this.constructor.type,version:hE,originX:m,originY:g,left:ht(h),top:ht(d),width:ht(v),height:ht(T),fill:jP(s)?s.toObject():s,stroke:jP(o)?o.toObject():o,strokeWidth:ht(S),strokeDashArray:u&&u.concat(),strokeLineCap:w,strokeDashOffset:E,strokeLineJoin:R,strokeUniform:P,strokeMiterLimit:ht(j),scaleX:ht(N),scaleY:ht(W),angle:ht(M),flipX:k,flipY:O,opacity:ht(B),shadow:l&&l.toObject(),visible:F,backgroundColor:H,fillRule:V,paintFirst:yt,globalCompositeOperation:xt,skewX:ht(J),skewY:ht(st),...e?{clipPath:e}:null};return this.includeDefaultValues?Ct:this._removeDefaultValues(Ct)}toDatalessObject(t){return this.toObject(t)}_removeDefaultValues(t){const e=this.constructor.getDefaults(),r=Object.keys(e).length>0?e:Object.getPrototypeOf(this);return oA(t,(i,s)=>{if(s===ue||s===Nr||s==="type")return!0;const o=r[s];return i!==o&&!(Array.isArray(i)&&Array.isArray(o)&&i.length===0&&o.length===0)})}toString(){return`#<${this.constructor.type}>`}static _fromObject(t){let{type:e,...r}=t,{extraParam:i,...s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r_(r,s).then(o=>i?(delete o[i],new this(r[i],o)):new this(o))}static fromObject(t,e){return this._fromObject(t,e)}};q(xo,"stateProperties",Nct),q(xo,"cacheProperties",Jo),q(xo,"ownDefaults",Lct),q(xo,"type","FabricObject"),q(xo,"colorProperties",[Nn,ti,"backgroundColor"]),q(xo,"customProperties",[]),_t.setClass(xo),_t.setClass(xo,"object");const J5=(n,t)=>{var e;const{transform:{target:r}}=t;(e=r.canvas)===null||e===void 0||e.fire(`object:${n}`,{...t,target:r}),r.fire(n,t)},ff=(n,t,e)=>(r,i,s,o)=>{const l=t(r,i,s,o);return l&&J5(n,{...$5(r,i,s,o),...e}),l};function df(n){return(t,e,r,i)=>{const{target:s,originX:o,originY:l}=e,u=s.getPositionByOrigin(o,l),h=n(t,e,r,i);return s.setPositionByOrigin(u,e.originX,e.originY),h}}const qct=(n,t,e,r)=>(i,s,o,l)=>{const u=uA(s,s.originX,s.originY,o,l)[e],h=fr(s[t]);if(h===0||h>0&&u<0||h<0&&u>0){const{target:d}=s,m=d.strokeWidth/(d.strokeUniform?d[r]:1),g=H5(s)?2:1,v=d[n],T=Math.abs(u*g/d[r])-m;return d.set(n,Math.max(T,1)),v!==d[n]}return!1},Gct=qct("width","originX","x","scaleX"),QP=ff(Wp,df(Gct));function Wct(n,t,e,r,i){n.save();const{stroke:s,xSize:o,ySize:l,opName:u}=this.commonRenderProps(n,t,e,i,r);let h=o;o>l?n.scale(1,l/o):l>o&&(h=l,n.scale(o/l,1)),n.beginPath(),n.arc(0,0,h/2,0,Hh,!1),n[u](),s&&n.stroke(),n.restore()}function Yct(n,t,e,r,i){n.save();const{stroke:s,xSize:o,ySize:l,opName:u}=this.commonRenderProps(n,t,e,i,r),h=o/2,d=l/2;n[`${u}Rect`](-h,-d,o,l),s&&n.strokeRect(-h,-d,o,l),n.restore()}class Gi{constructor(t){q(this,"visible",!0),q(this,"actionName",e_),q(this,"angle",0),q(this,"x",0),q(this,"y",0),q(this,"offsetX",0),q(this,"offsetY",0),q(this,"sizeX",0),q(this,"sizeY",0),q(this,"touchSizeX",0),q(this,"touchSizeY",0),q(this,"cursorStyle","crosshair"),q(this,"withConnection",!1),Object.assign(this,t)}getTransformAnchorPoint(){var t;return(t=this.transformAnchorPoint)!==null&&t!==void 0?t:new tt(.5-this.x,.5-this.y)}shouldActivate(t,e,r,i){var s;let{tl:o,tr:l,br:u,bl:h}=i;return((s=e.canvas)===null||s===void 0?void 0:s.getActiveObject())===e&&e.isControlVisible(t)&&je.isPointInPolygon(r,[o,l,u,h])}getActionHandler(t,e,r){return this.actionHandler}getMouseDownHandler(t,e,r){return this.mouseDownHandler}getMouseUpHandler(t,e,r){return this.mouseUpHandler}cursorStyleHandler(t,e,r,i){return e.cursorStyle}getActionName(t,e,r){return e.actionName}getVisibility(t,e){var r,i;return(r=(i=t._controlsVisibility)===null||i===void 0?void 0:i[e])!==null&&r!==void 0?r:this.visible}setVisibility(t,e,r){this.visible=t}positionHandler(t,e,r,i){return new tt(this.x*t.x+this.offsetX,this.y*t.y+this.offsetY).transform(e)}calcCornerCoords(t,e,r,i,s,o){const l=iA([Em(r,i),uf({angle:t}),sA((s?this.touchSizeX:this.sizeX)||e,(s?this.touchSizeY:this.sizeY)||e)]);return{tl:new tt(-.5,-.5).transform(l),tr:new tt(.5,-.5).transform(l),br:new tt(.5,.5).transform(l),bl:new tt(-.5,.5).transform(l)}}commonRenderProps(t,e,r,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const{cornerSize:o,cornerColor:l,transparentCorners:u,cornerStrokeColor:h}=s,d=o||i.cornerSize,m=this.sizeX||d,g=this.sizeY||d,v=u!==void 0?u:i.transparentCorners,T=v?ti:Nn,S=h||i.cornerStrokeColor,w=!v&&!!S;return t.fillStyle=l||i.cornerColor||"",t.strokeStyle=S||"",t.translate(e,r),t.rotate(sn(i.getTotalAngle())),{stroke:w,xSize:m,ySize:g,transparentCorners:v,opName:T}}render(t,e,r,i,s){((i=i||{}).cornerStyle||s.cornerStyle)==="circle"?Wct.call(this,t,e,r,i,s):Yct.call(this,t,e,r,i,s)}}const Kct=(n,t,e)=>e.lockRotation?tb:t.cursorStyle,Xct=ff(x5,df((n,t,e,r)=>{let{target:i,ex:s,ey:o,theta:l,originX:u,originY:h}=t;const d=i.getPositionByOrigin(u,h);if(ss(i,"lockRotation"))return!1;const m=Math.atan2(o-d.y,s-d.x),g=Math.atan2(r-d.y,e-d.x);let v=wl(g-m+l);if(i.snapAngle&&i.snapAngle>0){const S=i.snapAngle,w=i.snapThreshold||S,E=Math.ceil(v/S)*S,R=Math.floor(v/S)*S;Math.abs(v-R)<w?v=R:Math.abs(v-E)<w&&(v=E)}v<0&&(v=360+v),v%=360;const T=i.angle!==v;return i.angle=v,T}));function Z5(n,t){const e=t.canvas,r=n[e.uniScaleKey];return e.uniformScaling&&!r||!e.uniformScaling&&r}function tU(n,t,e){const r=ss(n,"lockScalingX"),i=ss(n,"lockScalingY");if(r&&i||!t&&(r||i)&&e||r&&t==="x"||i&&t==="y")return!0;const{width:s,height:o,strokeWidth:l}=n;return s===0&&l===0&&t!=="y"||o===0&&l===0&&t!=="x"}const Qct=["e","se","s","sw","w","nw","n","ne","e"],qd=(n,t,e,r)=>{const i=Z5(n,e);if(tU(e,t.x!==0&&t.y===0?"x":t.x===0&&t.y!==0?"y":"",i))return tb;const s=q5(e,0,r);return`${Qct[s]}-resize`};function fA(n,t,e,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const s=t.target,o=i.by,l=Z5(n,s);let u,h,d,m,g,v;if(tU(s,o,l))return!1;if(t.gestureScale)h=t.scaleX*t.gestureScale,d=t.scaleY*t.gestureScale;else{if(u=uA(t,t.originX,t.originY,e,r),g=o!=="y"?Math.sign(u.x||t.signX||1):1,v=o!=="x"?Math.sign(u.y||t.signY||1):1,t.signX||(t.signX=g),t.signY||(t.signY=v),ss(s,"lockScalingFlip")&&(t.signX!==g||t.signY!==v))return!1;if(m=s._getTransformedDimensions(),l&&!o){const w=Math.abs(u.x)+Math.abs(u.y),{original:E}=t,R=w/(Math.abs(m.x*E.scaleX/s.scaleX)+Math.abs(m.y*E.scaleY/s.scaleY));h=E.scaleX*R,d=E.scaleY*R}else h=Math.abs(u.x*s.scaleX/m.x),d=Math.abs(u.y*s.scaleY/m.y);H5(t)&&(h*=2,d*=2),t.signX!==g&&o!=="y"&&(t.originX=HP(t.originX),h*=-1,t.signX=g),t.signY!==v&&o!=="x"&&(t.originY=HP(t.originY),d*=-1,t.signY=v)}const T=s.scaleX,S=s.scaleY;return o?(o==="x"&&s.set(Vr,h),o==="y"&&s.set(ki,d)):(!ss(s,"lockScalingX")&&s.set(Vr,h),!ss(s,"lockScalingY")&&s.set(ki,d)),T!==s.scaleX||S!==s.scaleY}const ky=ff(t_,df((n,t,e,r)=>fA(n,t,e,r))),Jct=ff(t_,df((n,t,e,r)=>fA(n,t,e,r,{by:"x"}))),Zct=ff(t_,df((n,t,e,r)=>fA(n,t,e,r,{by:"y"}))),Mw={x:{counterAxis:"y",scale:Vr,skew:lf,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:ki,skew:cf,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},tut=["ns","nesw","ew","nwse"],eut=(n,t,e,r)=>{if(t.x!==0&&ss(e,"lockSkewingY")||t.y!==0&&ss(e,"lockSkewingX"))return tb;const i=q5(e,0,r)%4;return`${tut[i]}-resize`};function eU(n,t,e,r,i){const{target:s}=e,{counterAxis:o,origin:l,lockSkewing:u,skew:h,flip:d}=Mw[n];if(ss(s,u))return!1;const{origin:m,flip:g}=Mw[o],v=fr(e[m])*(s[g]?-1:1),T=-Math.sign(v)*(s[d]?-1:1),S=.5*-((s[h]===0&&uA(e,Wt,Wt,r,i)[n]>0||s[h]>0?1:-1)*T)+.5;return ff(E5,df((E,R,P,j)=>(function(N,W,M){let{target:k,ex:O,ey:B,skewingSide:F,...H}=W;const{skew:V}=Mw[N],yt=M.subtract(new tt(O,B)).divide(new tt(k.scaleX,k.scaleY))[N],xt=k[V],J=H[V],st=Math.tan(sn(J)),ht=N==="y"?k._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:k._getTransformedDimensions({scaleX:1,scaleY:1}).y,Ct=2*yt*F/Math.max(ht,1)+st,Vt=wl(Math.atan(Ct));k.set(V,Vt);const $=xt!==k[V];if($&&N==="y"){const{skewX:ot,scaleX:dt}=k,mt=k._getTransformedDimensions({skewY:xt}),Dt=k._getTransformedDimensions(),It=ot!==0?mt.x/Dt.x:1;It!==1&&k.set(Vr,It*dt)}return $})(n,R,new tt(P,j))))(t,{...e,[l]:S,skewingSide:T},r,i)}const nut=(n,t,e,r)=>eU("x",n,t,e,r),rut=(n,t,e,r)=>eU("y",n,t,e,r);function o_(n,t){return n[t.canvas.altActionKey]}const Ry=(n,t,e)=>{const r=o_(n,e);return t.x===0?r?lf:ki:t.y===0?r?cf:Vr:""},yh=(n,t,e,r)=>o_(n,e)?eut(0,t,e,r):qd(n,t,e,r),JP=(n,t,e,r)=>o_(n,t.target)?rut(n,t,e,r):Jct(n,t,e,r),ZP=(n,t,e,r)=>o_(n,t.target)?nut(n,t,e,r):Zct(n,t,e,r),nU=()=>({ml:new Gi({x:-.5,y:0,cursorStyleHandler:yh,actionHandler:JP,getActionName:Ry}),mr:new Gi({x:.5,y:0,cursorStyleHandler:yh,actionHandler:JP,getActionName:Ry}),mb:new Gi({x:0,y:.5,cursorStyleHandler:yh,actionHandler:ZP,getActionName:Ry}),mt:new Gi({x:0,y:-.5,cursorStyleHandler:yh,actionHandler:ZP,getActionName:Ry}),tl:new Gi({x:-.5,y:-.5,cursorStyleHandler:qd,actionHandler:ky}),tr:new Gi({x:.5,y:-.5,cursorStyleHandler:qd,actionHandler:ky}),bl:new Gi({x:-.5,y:.5,cursorStyleHandler:qd,actionHandler:ky}),br:new Gi({x:.5,y:.5,cursorStyleHandler:qd,actionHandler:ky}),mtr:new Gi({x:0,y:-.5,actionHandler:Xct,cursorStyleHandler:Kct,offsetY:-40,withConnection:!0,actionName:nA})}),iut=()=>({mr:new Gi({x:.5,y:0,actionHandler:QP,cursorStyleHandler:yh,actionName:Wp}),ml:new Gi({x:-.5,y:0,actionHandler:QP,cursorStyleHandler:yh,actionName:Wp})}),sut=()=>({...nU(),...iut()});class Qp extends xo{static getDefaults(){return{...super.getDefaults(),...Qp.ownDefaults}}constructor(t){super(),Object.assign(this,this.constructor.createControls(),Qp.ownDefaults),this.setOptions(t)}static createControls(){return{controls:nU()}}_updateCacheCanvas(){const t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){const e=t._currentTransform,r=e.target,i=e.action;if(this===r&&i&&i.startsWith(e_))return!1}return super._updateCacheCanvas()}getActiveControl(){const t=this.__corner;return t?{key:t,control:this.controls[t],coord:this.oCoords[t]}:void 0}findControl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const r=Object.entries(this.oCoords);for(let i=r.length-1;i>=0;i--){const[s,o]=r[i],l=this.controls[s];if(l.shouldActivate(s,this,t,e?o.touchCorner:o.corner))return this.__corner=s,{key:s,control:l,coord:this.oCoords[s]}}}calcOCoords(){const t=this.getViewportTransform(),e=this.getCenterPoint(),r=Em(e.x,e.y),i=uf({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=Kn(r,i),o=Kn(t,s),l=Kn(o,[1/t[0],0,0,1/t[3],0,0]),u=this.group?Qv(this.calcTransformMatrix()):void 0;u&&(u.scaleX=Math.abs(u.scaleX),u.scaleY=Math.abs(u.scaleY));const h=this._calculateCurrentDimensions(u),d={};return this.forEachControl((m,g)=>{const v=m.positionHandler(h,l,this,m);d[g]=Object.assign(v,this._calcCornerCoords(m,v))}),d}_calcCornerCoords(t,e){const r=this.getTotalAngle();return{corner:t.calcCornerCoords(r,this.cornerSize,e.x,e.y,!1,this),touchCorner:t.calcCornerCoords(r,this.touchCornerSize,e.x,e.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(t){for(const e in this.controls)t(this.controls[e],e,this)}drawSelectionBackground(t){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;t.save();const e=this.getRelativeCenterPoint(),r=this._calculateCurrentDimensions(),i=this.getViewportTransform();t.translate(e.x,e.y),t.scale(1/i[0],1/i[3]),t.rotate(sn(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-r.x/2,-r.y/2,r.x,r.y),t.restore()}strokeBorders(t,e){t.strokeRect(-e.x/2,-e.y/2,e.x,e.y)}_drawBorders(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i={hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray,...r};t.save(),t.strokeStyle=i.borderColor,this._setLineDash(t,i.borderDashArray),this.strokeBorders(t,e),i.hasControls&&this.drawControlsConnectingLines(t,e),t.restore()}_renderControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:r,hasControls:i}=this,s={hasBorders:r,hasControls:i,...e},o=this.getViewportTransform(),l=s.hasBorders,u=s.hasControls,h=Kn(o,this.calcTransformMatrix()),d=Qv(h);t.save(),t.translate(d.translateX,d.translateY),t.lineWidth=this.borderScaleFactor,this.group===this.parent&&(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(d.angle-=180),t.rotate(sn(this.group?d.angle:this.angle)),l&&this.drawBorders(t,d,e),u&&this.drawControls(t,e),t.restore()}drawBorders(t,e,r){let i;if(r&&r.forActiveSelection||this.group){const s=lA(this.width,this.height,n_(e)),o=this.isStrokeAccountedForInDimensions()?rA:(this.strokeUniform?new tt().scalarAdd(this.canvas?this.canvas.getZoom():1):new tt(e.scaleX,e.scaleY)).scalarMultiply(this.strokeWidth);i=s.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else i=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(t,i,r)}drawControlsConnectingLines(t,e){let r=!1;t.beginPath(),this.forEachControl((i,s)=>{i.withConnection&&i.getVisibility(this,s)&&(r=!0,t.moveTo(i.x*e.x,i.y*e.y),t.lineTo(i.x*e.x+i.offsetX,i.y*e.y+i.offsetY))}),r&&t.stroke()}drawControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t.save();const r=this.getCanvasRetinaScaling(),{cornerStrokeColor:i,cornerDashArray:s,cornerColor:o}=this,l={cornerStrokeColor:i,cornerDashArray:s,cornerColor:o,...e};t.setTransform(r,0,0,r,0,0),t.strokeStyle=t.fillStyle=l.cornerColor,this.transparentCorners||(t.strokeStyle=l.cornerStrokeColor),this._setLineDash(t,l.cornerDashArray),this.forEachControl((u,h)=>{if(u.getVisibility(this,h)){const d=this.oCoords[h];u.render(t,d.x,d.y,l,this)}}),t.restore()}isControlVisible(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)}setControlVisible(t,e){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e}setControlsVisibility(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(t).forEach(e=>{let[r,i]=e;return this.setControlVisible(r,i)})}clearContextTop(t){if(!this.canvas)return;const e=this.canvas.contextTop;if(!e)return;const r=this.canvas.viewportTransform;e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(e);const i=this.width+4,s=this.height+4;return e.clearRect(-i/2,-s/2,i,s),t||e.restore(),e}onDeselect(t){return!1}onSelect(t){return!1}shouldStartDragging(t){return!1}onDragStart(t){return!1}canDrop(t){return!1}renderDragSourceEffect(t){}renderDropTargetEffect(t){}}function rU(n,t){return t.forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(r=>{r!=="constructor"&&Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(e.prototype,r)||Object.create(null))})}),n}q(Qp,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class nr extends Qp{}rU(nr,[G5]),_t.setClass(nr),_t.setClass(nr,"object");const out=(n,t,e,r)=>{const i=2*(r=Math.round(r))+1,{data:s}=n.getImageData(t-r,e-r,i,i);for(let o=3;o<s.length;o+=4)if(s[o]>0)return!1;return!0};class iU{constructor(t){this.options=t,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new tt(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new tt(1/this.options.scaleX,1/this.options.scaleY):new tt(1,1)}createSideVector(t,e){const r=Zv(t,e);return this.options.strokeUniform?r.multiply(this.scale):r}projectOrthogonally(t,e,r){return this.applySkew(t.add(this.calcOrthogonalProjection(t,e,r)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(t){const e=new tt(t);return e.y+=e.x*Math.tan(sn(this.options.skewY)),e.x+=e.y*Math.tan(sn(this.options.skewX)),e}scaleUnitVector(t,e){return t.multiply(this.strokeUniformScalar).scalarMultiply(e)}}const aut=new tt;class Mh extends iU{static getOrthogonalRotationFactor(t,e){const r=e?yE(t,e):U5(t);return Math.abs(r)<xm?-1:1}constructor(t,e,r,i){super(i),q(this,"AB",void 0),q(this,"AC",void 0),q(this,"alpha",void 0),q(this,"bisector",void 0),this.A=new tt(t),this.B=new tt(e),this.C=new tt(r),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=yE(this.AB,this.AC),this.bisector=cA(F5(this.AB.eq(aut)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const i=this.createSideVector(t,e),s=z5(i),o=Mh.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,r*o)}projectBevel(){const t=[];return(this.alpha%Hh===0?[this.B]:[this.B,this.C]).forEach(e=>{t.push(this.projectOrthogonally(this.A,e)),t.push(this.projectOrthogonally(this.A,e,-this.strokeProjectionMagnitude))}),t}projectMiter(){const t=[],e=Math.abs(this.alpha),r=1/Math.sin(e/2),i=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*r),s=this.options.strokeUniform?gE(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return gE(i)/this.strokeProjectionMagnitude<=s&&t.push(this.applySkew(this.A.add(i))),t.push(...this.projectBevel()),t}projectRoundNoSkew(t,e){const r=[],i=new tt(Mh.getOrthogonalRotationFactor(this.bisector),Mh.getOrthogonalRotationFactor(new tt(this.bisector.y,this.bisector.x)));return[new tt(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i),new tt(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i)].forEach(s=>{zP(s,t,e)&&r.push(this.A.add(s))}),r}projectRoundWithSkew(t,e){const r=[],{skewX:i,skewY:s,scaleX:o,scaleY:l,strokeUniform:u}=this.options,h=new tt(Math.tan(sn(i)),Math.tan(sn(s))),d=this.strokeProjectionMagnitude,m=u?d/l/Math.sqrt(1/l**2+1/o**2*h.y**2):d/Math.sqrt(1+h.y**2),g=new tt(Math.sqrt(Math.max(d**2-m**2,0)),m),v=u?d/Math.sqrt(1+h.x**2*(1/l)**2/(1/o+1/o*h.x*h.y)**2):d/Math.sqrt(1+h.x**2/(1+h.x*h.y)**2),T=new tt(v,Math.sqrt(Math.max(d**2-v**2,0)));return[T,T.scalarMultiply(-1),g,g.scalarMultiply(-1)].map(S=>this.applySkew(u?S.multiply(this.strokeUniformScalar):S)).forEach(S=>{zP(S,t,e)&&r.push(this.applySkew(this.A).add(S))}),r}projectRound(){const t=[];t.push(...this.projectBevel());const e=this.alpha%Hh===0,r=this.applySkew(this.A),i=t[e?0:2].subtract(r),s=t[e?1:0].subtract(r),o=e?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),l=gp(i,o)>0,u=l?i:s,h=l?s:i;return this.isSkewed()?t.push(...this.projectRoundWithSkew(u,h)):t.push(...this.projectRoundNoSkew(u,h)),t}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(t=>({originPoint:this.A,projectedPoint:t,angle:this.alpha,bisector:this.bisector}))}}class tN extends iU{constructor(t,e,r){super(r),this.A=new tt(t),this.T=new tt(e)}calcOrthogonalProjection(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const i=this.createSideVector(t,e);return this.scaleUnitVector(z5(i),r)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const t=[];if(!this.isSkewed()&&this.A.eq(this.T)){const e=new tt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.applySkew(this.A.add(e)),this.applySkew(this.A.subtract(e)))}else t.push(...new Mh(this.A,this.T,this.T,this.options).projectRound());return t}projectSquare(){const t=[];if(this.A.eq(this.T)){const e=new tt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.A.add(e),this.A.subtract(e))}else{const e=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),r=this.scaleUnitVector(cA(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),i=this.A.add(r);t.push(i.add(e),i.subtract(e))}return t.map(e=>this.applySkew(e))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(t=>({originPoint:this.A,projectedPoint:t}))}}const lut=function(n,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const r=[];if(n.length===0)return r;const i=n.reduce((s,o)=>(s[s.length-1].eq(o)||s.push(new tt(o)),s),[new tt(n[0])]);if(i.length===1)e=!0;else if(!e){const s=i[0],o=((l,u)=>{for(let h=l.length-1;h>=0;h--)if(u(l[h],h,l))return h;return-1})(i,l=>!l.eq(s));i.splice(o+1)}return i.forEach((s,o,l)=>{let u,h;o===0?(h=l[1],u=e?s:l[l.length-1]):o===l.length-1?(u=l[o-1],h=e?s:l[0]):(u=l[o-1],h=l[o+1]),e&&l.length===1?r.push(...new tN(s,s,t).project()):!e||o!==0&&o!==l.length-1?r.push(...new Mh(s,u,h,t).project()):r.push(...new tN(s,o===0?h:u,t).project())}),r},dA=n=>{const t={};return Object.keys(n).forEach(e=>{t[e]={},Object.keys(n[e]).forEach(r=>{t[e][r]={...n[e][r]}})}),t},pA=function(n,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return n.fill!==t.fill||n.stroke!==t.stroke||n.strokeWidth!==t.strokeWidth||n.fontSize!==t.fontSize||n.fontFamily!==t.fontFamily||n.fontWeight!==t.fontWeight||n.fontStyle!==t.fontStyle||n.textDecorationThickness!==t.textDecorationThickness||n.textBackgroundColor!==t.textBackgroundColor||n.deltaY!==t.deltaY||e&&(n.overline!==t.overline||n.underline!==t.underline||n.linethrough!==t.linethrough)},cut=(n,t)=>{const e=t.split(`
`),r=[];let i=-1,s={};n=dA(n);for(let o=0;o<e.length;o++){const l=aA(e[o]);if(n[o])for(let u=0;u<l.length;u++){i++;const h=n[o][u];h&&Object.keys(h).length>0&&(pA(s,h,!0)?r.push({start:i,end:i+1,style:h}):r[r.length-1].end++),s=h||{}}else i+=l.length,s={}}return r},uut=(n,t)=>{if(!Array.isArray(n))return dA(n);const e=t.split(eA),r={};let i=-1,s=0;for(let o=0;o<e.length;o++){const l=aA(e[o]);for(let u=0;u<l.length;u++)i++,n[s]&&n[s].start<=i&&i<n[s].end&&(r[o]=r[o]||{},r[o][u]={...n[s].style},i===n[s].end-1&&s++)}return r},Ll=["display","transform",Nn,"fill-opacity","fill-rule","opacity",ti,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function eN(n,t){const e=n.nodeName,r=n.getAttribute("class"),i=n.getAttribute("id"),s="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+e,"i"),t=t.replace(o,""),i&&t.length&&(o=new RegExp("#"+i+s,"i"),t=t.replace(o,"")),r&&t.length){const l=r.split(" ");for(let u=l.length;u--;)o=new RegExp("\\."+l[u]+s,"i"),t=t.replace(o,"")}return t.length===0}function hut(n,t){let e=!0;const r=eN(n,t.pop());return r&&t.length&&(e=(function(i,s){let o,l=!0;for(;i.parentElement&&i.parentElement.nodeType===1&&s.length;)l&&(o=s.pop()),l=eN(i=i.parentElement,o);return s.length===0})(n,t)),r&&e&&t.length===0}function fut(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={};for(const r in t)hut(n,r.split(" "))&&(e={...e,...t[r]});return e}const dut=n=>{var t;return(t=Pct[n])!==null&&t!==void 0?t:n},put=new RegExp(`(${iu})`,"gi"),dr=`(${iu})`,mut=String.raw`(skewX)\(${dr}\)`,gut=String.raw`(skewY)\(${dr}\)`,yut=String.raw`(rotate)\(${dr}(?: ${dr} ${dr})?\)`,vut=String.raw`(scale)\(${dr}(?: ${dr})?\)`,but=String.raw`(translate)\(${dr}(?: ${dr})?\)`,mA=`(?:${String.raw`(matrix)\(${dr} ${dr} ${dr} ${dr} ${dr} ${dr}\)`}|${but}|${yut}|${vut}|${mut}|${gut})`,_ut=`(?:${mA}*)`,Tut=String.raw`^\s*(?:${_ut}?)\s*$`,Sut=new RegExp(Tut),wut=new RegExp(mA),xut=new RegExp(mA,"g");function vE(n){const t=[];if(!(n=(e=>eb(e.replace(put," $1 ").replace(/,/gi," ")))(n).replace(/\s*([()])\s*/gi,"$1"))||n&&!Sut.test(n))return[...Tr];for(const e of n.matchAll(xut)){const r=wut.exec(e[0]);if(!r)continue;let i=Tr;const s=r.filter(T=>!!T),[,o,...l]=s,[u,h,d,m,g,v]=l.map(T=>parseFloat(T));switch(o){case"translate":i=Em(u,h);break;case nA:i=uf({angle:u},{x:h,y:d});break;case e_:i=sA(u,h);break;case lf:i=O5(u);break;case cf:i=I5(u);break;case"matrix":i=[u,h,d,m,g,v]}t.push(i)}return iA(t)}function Eut(n,t,e,r){const i=Array.isArray(t);let s,o=t;if(n!==Nn&&n!==ti||t!==Lr){if(n==="strokeUniform")return t==="non-scaling-stroke";if(n==="strokeDashArray")o=t===Lr?null:t.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(n==="transformMatrix")o=e&&e.transformMatrix?Kn(e.transformMatrix,vE(t)):vE(t);else if(n==="visible")o=t!==Lr&&t!=="hidden",e&&e.visible===!1&&(o=!1);else if(n==="opacity")o=parseFloat(t),e&&e.opacity!==void 0&&(o*=e.opacity);else if(n==="textAnchor")o=t==="start"?ue:t==="end"?rn:Wt;else if(n==="charSpacing"||n===ru)s=Rh(t,r)/r*1e3;else if(n==="paintFirst"){const l=t.indexOf(Nn),u=t.indexOf(ti);o=Nn,(l>-1&&u>-1&&u<l||l===-1&&u>-1)&&(o=ti)}else{if(n==="href"||n==="xlink:href"||n==="font"||n==="id")return t;if(n==="imageSmoothing")return t==="optimizeQuality";s=i?t.map(Rh):Rh(t,r)}}else o="";return!i&&isNaN(s)?o:s}function Cut(n,t){n.replace(/;\s*$/,"").split(";").forEach(e=>{if(!e)return;const[r,i]=e.split(":");t[r.trim().toLowerCase()]=i.trim()})}function Aut(n){const t={},e=n.getAttribute("style");return e&&(typeof e=="string"?Cut(e,t):(function(r,i){Object.entries(r).forEach(s=>{let[o,l]=s;l!==void 0&&(i[o.toLowerCase()]=l)})})(e,t)),t}const kut={stroke:"strokeOpacity",fill:"fillOpacity"};function Zo(n,t,e){if(!n)return{};let r,i={},s=tA;n.parentNode&&YP.test(n.parentNode.nodeName)&&(i=Zo(n.parentElement,t,e),i.fontSize&&(r=s=Rh(i.fontSize)));const o={...t.reduce((h,d)=>{const m=n.getAttribute(d);return m&&(h[d]=m),h},{}),...fut(n,e),...Aut(n)};o[kw]&&n.setAttribute(kw,o[kw]),o[Aw]&&(r=Rh(o[Aw],s),o[Aw]=`${r}`);const l={};for(const h in o){const d=dut(h),m=Eut(d,o[h],i,r);l[d]=m}l&&l.font&&(function(h,d){const m=h.match(Ict);if(!m)return;const g=m[1],v=m[3],T=m[4],S=m[5],w=m[6];g&&(d.fontStyle=g),v&&(d.fontWeight=isNaN(parseFloat(v))?v:parseFloat(v)),T&&(d.fontSize=Rh(T)),w&&(d.fontFamily=w),S&&(d.lineHeight=S===dE?1:S)})(l.font,l);const u={...i,...l};return YP.test(n.nodeName)?u:(function(h){const d=nr.getDefaults();return Object.entries(kut).forEach(m=>{let[g,v]=m;if(h[v]===void 0||h[g]==="")return;if(h[g]===void 0){if(!d[g])return;h[g]=d[g]}if(h[g].indexOf("url(")===0)return;const T=new Te(h[g]);h[g]=T.setAlpha(Ae(T.getAlpha()*h[v],2)).toRgba()}),h})(u)}const sU=["rx","ry"];class Ns extends nr{static getDefaults(){return{...super.getDefaults(),...Ns.ownDefaults}}constructor(t){super(),Object.assign(this,Ns.ownDefaults),this.setOptions(t),this._initRxRy()}_initRxRy(){const{rx:t,ry:e}=this;t&&!e?this.ry=t:e&&!t&&(this.rx=e)}_render(t){const{width:e,height:r}=this,i=-e/2,s=-r/2,o=this.rx?Math.min(this.rx,e/2):0,l=this.ry?Math.min(this.ry,r/2):0,u=o!==0||l!==0;t.beginPath(),t.moveTo(i+o,s),t.lineTo(i+e-o,s),u&&t.bezierCurveTo(i+e-Na*o,s,i+e,s+Na*l,i+e,s+l),t.lineTo(i+e,s+r-l),u&&t.bezierCurveTo(i+e,s+r-Na*l,i+e-Na*o,s+r,i+e-o,s+r),t.lineTo(i+o,s+r),u&&t.bezierCurveTo(i+Na*o,s+r,i,s+r-Na*l,i,s+r-l),t.lineTo(i,s+l),u&&t.bezierCurveTo(i,s+Na*l,i+Na*o,s,i+o,s),t.closePath(),this._renderPaintInOrder(t)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...sU,...t])}_toSVG(){const{width:t,height:e,rx:r,ry:i}=this;return["<rect ","COMMON_PARTS",`x="${-t/2}" y="${-e/2}" rx="${ne(r)}" ry="${ne(i)}" width="${ne(t)}" height="${ne(e)}" />
`]}static async fromElement(t,e,r){const{left:i=0,top:s=0,width:o=0,height:l=0,visible:u=!0,...h}=Zo(t,this.ATTRIBUTE_NAMES,r);return new this({...e,...h,left:i,top:s,width:o,height:l,visible:!!(u&&o&&l)})}}q(Ns,"type","Rect"),q(Ns,"cacheProperties",[...Jo,...sU]),q(Ns,"ownDefaults",{rx:0,ry:0}),q(Ns,"ATTRIBUTE_NAMES",[...Ll,"x","y","rx","ry","width","height"]),_t.setClass(Ns),_t.setSVGClass(Ns);const Io="initialization",rb="added",gA="removed",ib="imperative",oU=(n,t)=>{const{strokeUniform:e,strokeWidth:r,width:i,height:s,group:o}=t,l=o&&o!==n?i_(o.calcTransformMatrix(),n.calcTransformMatrix()):null,u=l?t.getRelativeCenterPoint().transform(l):t.getRelativeCenterPoint(),h=!t.isStrokeAccountedForInDimensions(),d=e&&h?Ect(new tt(r,r),void 0,n.calcTransformMatrix()):rA,m=!e&&h?r:0,g=lA(i+m,s+m,iA([l,t.calcOwnMatrix()],!0)).add(d).scalarDivide(2);return[u.subtract(g),u.add(g)]};class a_{calcLayoutResult(t,e){if(this.shouldPerformLayout(t))return this.calcBoundingBox(e,t)}shouldPerformLayout(t){let{type:e,prevStrategy:r,strategy:i}=t;return e===Io||e===ib||!!r&&i!==r}shouldLayoutClipPath(t){let{type:e,target:{clipPath:r}}=t;return e!==Io&&r&&!r.absolutePositioned}getInitialSize(t,e){return e.size}calcBoundingBox(t,e){const{type:r,target:i}=e;if(r===ib&&e.overrides)return e.overrides;if(t.length===0)return;const{left:s,top:o,width:l,height:u}=Fo(t.map(m=>oU(i,m)).reduce((m,g)=>m.concat(g),[])),h=new tt(l,u),d=new tt(s,o).add(h.scalarDivide(2));if(r===Io){const m=this.getInitialSize(e,{size:h,center:d});return{center:d,relativeCorrection:new tt(0,0),size:m}}return{center:d.transform(i.calcOwnMatrix()),size:h}}}q(a_,"type","strategy");class bE extends a_{shouldPerformLayout(t){return!0}}q(bE,"type","fit-content"),_t.setClass(bE);const aU="layoutManager";class Jp{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new bE;q(this,"strategy",void 0),this.strategy=t,this._subscriptions=new Map}performLayout(t){const e={bubbles:!0,strategy:this.strategy,...t,prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}};this.onBeforeLayout(e);const r=this.getLayoutResult(e);r&&this.commitLayout(e,r),this.onAfterLayout(e,r),this._prevLayoutStrategy=e.strategy}attachHandlers(t,e){const{target:r}=e;return[Kv,w5,Wp,x5,t_,E5,Yv,uct,hct].map(i=>t.on(i,s=>this.performLayout(i===Kv?{type:"object_modified",trigger:i,e:s,target:r}:{type:"object_modifying",trigger:i,e:s,target:r})))}subscribe(t,e){this.unsubscribe(t,e);const r=this.attachHandlers(t,e);this._subscriptions.set(t,r)}unsubscribe(t,e){(this._subscriptions.get(t)||[]).forEach(r=>r()),this._subscriptions.delete(t)}unsubscribeTargets(t){t.targets.forEach(e=>this.unsubscribe(e,t))}subscribeTargets(t){t.targets.forEach(e=>this.subscribe(e,t))}onBeforeLayout(t){const{target:e,type:r}=t,{canvas:i}=e;if(r===Io||r===rb?this.subscribeTargets(t):r===gA&&this.unsubscribeTargets(t),e.fire("layout:before",{context:t}),i&&i.fire("object:layout:before",{target:e,context:t}),r===ib&&t.deep){const{strategy:s,...o}=t;e.forEachObject(l=>l.layoutManager&&l.layoutManager.performLayout({...o,bubbles:!1,target:l}))}}getLayoutResult(t){const{target:e,strategy:r,type:i}=t,s=r.calcLayoutResult(t,e.getObjects());if(!s)return;const o=i===Io?new tt:e.getRelativeCenterPoint(),{center:l,correction:u=new tt,relativeCorrection:h=new tt}=s,d=o.subtract(l).add(u).transform(i===Io?Tr:Zi(e.calcOwnMatrix()),!0).add(h);return{result:s,prevCenter:o,nextCenter:l,offset:d}}commitLayout(t,e){const{target:r}=t,{result:{size:i},nextCenter:s}=e;var o,l;r.set({width:i.x,height:i.y}),this.layoutObjects(t,e),t.type===Io?r.set({left:(o=t.x)!==null&&o!==void 0?o:s.x+i.x*fr(r.originX),top:(l=t.y)!==null&&l!==void 0?l:s.y+i.y*fr(r.originY)}):(r.setPositionByOrigin(s,Wt,Wt),r.setCoords(),r.set("dirty",!0))}layoutObjects(t,e){const{target:r}=t;r.forEachObject(i=>{i.group===r&&this.layoutObject(t,e,i)}),t.strategy.shouldLayoutClipPath(t)&&this.layoutObject(t,e,r.clipPath)}layoutObject(t,e,r){let{offset:i}=e;r.set({left:r.left+i.x,top:r.top+i.y})}onAfterLayout(t,e){const{target:r,strategy:i,bubbles:s,prevStrategy:o,...l}=t,{canvas:u}=r;r.fire("layout:after",{context:t,result:e}),u&&u.fire("object:layout:after",{context:t,result:e,target:r});const h=r.parent;s&&h!=null&&h.layoutManager&&((l.path||(l.path=[])).push(r),h.layoutManager.performLayout({...l,target:h})),r.set("dirty",!0)}dispose(){const{_subscriptions:t}=this;t.forEach(e=>e.forEach(r=>r())),t.clear()}toObject(){return{type:aU,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}_t.setClass(Jp,aU);class Rut extends Jp{performLayout(){}}class Uc extends C5(nr){static getDefaults(){return{...super.getDefaults(),...Uc.ownDefaults}}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),q(this,"_activeObjects",[]),q(this,"__objectSelectionTracker",void 0),q(this,"__objectSelectionDisposer",void 0),Object.assign(this,Uc.ownDefaults),this.setOptions(e),this.groupInit(t,e)}groupInit(t,e){var r;this._objects=[...t],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(i=>{this.enterGroup(i,!1)}),this.layoutManager=(r=e.layoutManager)!==null&&r!==void 0?r:new Jp,this.layoutManager.performLayout({type:Io,target:this,targets:[...t],x:e.left,y:e.top})}canEnterGroup(t){return t===this||this.isDescendantOf(t)?(Tl("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(t)===-1||(Tl("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(t){return t.filter((e,r,i)=>this.canEnterGroup(e)&&i.indexOf(e)===r)}add(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const i=this._filterObjectsBeforeEnteringGroup(e),s=super.add(...i);return this._onAfterObjectsChange(rb,i),s}insertAt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];const s=this._filterObjectsBeforeEnteringGroup(r),o=super.insertAt(t,...s);return this._onAfterObjectsChange(rb,s),o}remove(){const t=super.remove(...arguments);return this._onAfterObjectsChange(gA,t),t}_onObjectAdded(t){this.enterGroup(t,!0),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t,e){this.exitGroup(t,e),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onAfterObjectsChange(t,e){this.layoutManager.performLayout({type:t,targets:e,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(t,e){const r=this[t];return super._set(t,e),t==="canvas"&&r!==e&&(this._objects||[]).forEach(i=>{i._set(t,e)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(t,e){let{target:r}=e;const i=this._activeObjects;if(t)i.push(r),this._set("dirty",!0);else if(i.length>0){const s=i.indexOf(r);s>-1&&(i.splice(s,1),this._set("dirty",!0))}}_watchObject(t,e){t&&this._watchObject(!1,e),t?(e.on("selected",this.__objectSelectionTracker),e.on("deselected",this.__objectSelectionDisposer)):(e.off("selected",this.__objectSelectionTracker),e.off("deselected",this.__objectSelectionDisposer))}enterGroup(t,e){t.group&&t.group.remove(t),t._set("parent",this),this._enterGroup(t,e)}_enterGroup(t,e){e&&Jv(t,Kn(Zi(this.calcTransformMatrix()),t.calcTransformMatrix())),this._shouldSetNestedCoords()&&t.setCoords(),t._set("group",this),t._set("canvas",this.canvas),this._watchObject(!0,t);const r=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();r&&(r===t||t.isDescendantOf(r))&&this._activeObjects.push(t)}exitGroup(t,e){this._exitGroup(t,e),t._set("parent",void 0),t._set("canvas",void 0)}_exitGroup(t,e){t._set("group",void 0),e||(Jv(t,Kn(this.calcTransformMatrix(),t.calcTransformMatrix())),t.setCoords()),this._watchObject(!1,t);const r=this._activeObjects.length>0?this._activeObjects.indexOf(t):-1;r>-1&&this._activeObjects.splice(r,1)}shouldCache(){const t=nr.prototype.shouldCache.call(this);if(t){for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1}return t}willDrawShadow(){if(super.willDrawShadow())return!0;for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(t,e,r){this._renderBackground(t);for(let s=0;s<this._objects.length;s++){var i;const o=this._objects[s];(i=this.canvas)!==null&&i!==void 0&&i.preserveObjectStacking&&o.group!==this?(t.save(),t.transform(...Zi(this.calcTransformMatrix())),o.render(t),t.restore()):o.group===this&&o.render(t)}this._drawClipPath(t,this.clipPath,r)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(t=>t.setCoords())}triggerLayout(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout({target:this,type:ib,...t})}render(t){this._transformDone=!0,super.render(t),this._transformDone=!1}__serializeObjects(t,e){const r=this.includeDefaultValues;return this._objects.filter(function(i){return!i.excludeFromExport}).map(function(i){const s=i.includeDefaultValues;i.includeDefaultValues=r;const o=i[t||"toObject"](e);return i.includeDefaultValues=s,o})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.layoutManager.toObject();return{...super.toObject(["subTargetCheck","interactive",...t]),...e.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:e}:{},objects:this.__serializeObjects("toObject",t)}}toString(){return`#<Group: (${this.complexity()})>`}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(t=>{this._watchObject(!1,t),t.dispose()}),super.dispose()}_createSVGBgRect(t){if(!this.backgroundColor)return"";const e=Ns.prototype._toSVG.call(this),r=e.indexOf("COMMON_PARTS");e[r]='for="group" ';const i=e.join("");return t?t(i):i}_toSVG(t){const e=["<g ","COMMON_PARTS",` >
`],r=this._createSVGBgRect(t);r&&e.push("		",r);for(let i=0;i<this._objects.length;i++)e.push("		",this._objects[i].toSVG(t));return e.push(`</g>
`),e}getSvgStyles(){const t=this.opacity!==void 0&&this.opacity!==1?`opacity: ${ne(this.opacity)};`:"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")}toClipPathSVG(t){const e=[],r=this._createSVGBgRect(t);r&&e.push("	",r);for(let i=0;i<this._objects.length;i++)e.push("	",this._objects[i].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}static fromObject(t,e){let{type:r,objects:i=[],layoutManager:s,...o}=t;return Promise.all([Yp(i,e),r_(o,e)]).then(l=>{let[u,h]=l;const d=new this(u,{...o,...h,layoutManager:new Rut});if(s){const m=_t.getClass(s.type),g=_t.getClass(s.strategy);d.layoutManager=new m(new g)}else d.layoutManager=new Jp;return d.layoutManager.subscribeTargets({type:Io,target:d,targets:d.getObjects()}),d.setCoords(),d})}}q(Uc,"type","Group"),q(Uc,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),_t.setClass(Uc);const Mut=(n,t)=>Math.min(t.width/n.width,t.height/n.height),Dut=(n,t)=>Math.max(t.width/n.width,t.height/n.height),_E="\\s*,?\\s*",Od=`${_E}(${iu})`,Out=`${Od}${Od}${Od}${_E}([01])${_E}([01])${Od}${Od}`,Iut={m:"l",M:"L"},Put=(n,t,e,r,i,s,o,l,u,h,d)=>{const m=Wo(n),g=Yo(n),v=Wo(t),T=Yo(t),S=e*i*v-r*s*T+o,w=r*i*v+e*s*T+l;return["C",h+u*(-e*i*g-r*s*m),d+u*(-r*i*g+e*s*m),S+u*(e*i*T+r*s*v),w+u*(r*i*T-e*s*v),S,w]},nN=(n,t,e,r)=>{const i=Math.atan2(t,n),s=Math.atan2(r,e);return s>=i?s-i:2*Math.PI-(i-s)};function rN(n,t,e,r,i,s,o,l){let u;if(me.cachesBoundsOfCurve&&(u=[...arguments].join(),mp.boundsOfCurveCache[u]))return mp.boundsOfCurveCache[u];const h=Math.sqrt,d=Math.abs,m=[],g=[[0,0],[0,0]];let v=6*n-12*e+6*i,T=-3*n+9*e-9*i+3*o,S=3*e-3*n;for(let j=0;j<2;++j){if(j>0&&(v=6*t-12*r+6*s,T=-3*t+9*r-9*s+3*l,S=3*r-3*t),d(T)<1e-12){if(d(v)<1e-12)continue;const O=-S/v;0<O&&O<1&&m.push(O);continue}const N=v*v-4*S*T;if(N<0)continue;const W=h(N),M=(-v+W)/(2*T);0<M&&M<1&&m.push(M);const k=(-v-W)/(2*T);0<k&&k<1&&m.push(k)}let w=m.length;const E=w,R=lU(n,t,e,r,i,s,o,l);for(;w--;){const{x:j,y:N}=R(m[w]);g[0][w]=j,g[1][w]=N}g[0][E]=n,g[1][E]=t,g[0][E+1]=o,g[1][E+1]=l;const P=[new tt(Math.min(...g[0]),Math.min(...g[1])),new tt(Math.max(...g[0]),Math.max(...g[1]))];return me.cachesBoundsOfCurve&&(mp.boundsOfCurveCache[u]=P),P}const Nut=(n,t,e)=>{let[r,i,s,o,l,u,h,d]=e;const m=((g,v,T,S,w,E,R)=>{if(T===0||S===0)return[];let P=0,j=0,N=0;const W=Math.PI,M=R*ZC,k=Yo(M),O=Wo(M),B=.5*(-O*g-k*v),F=.5*(-O*v+k*g),H=T**2,V=S**2,yt=F**2,xt=B**2,J=H*V-H*yt-V*xt;let st=Math.abs(T),ht=Math.abs(S);if(J<0){const Rt=Math.sqrt(1-J/(H*V));st*=Rt,ht*=Rt}else N=(w===E?-1:1)*Math.sqrt(J/(H*yt+V*xt));const Ct=N*st*F/ht,Vt=-N*ht*B/st,$=O*Ct-k*Vt+.5*g,ot=k*Ct+O*Vt+.5*v;let dt=nN(1,0,(B-Ct)/st,(F-Vt)/ht),mt=nN((B-Ct)/st,(F-Vt)/ht,(-B-Ct)/st,(-F-Vt)/ht);E===0&&mt>0?mt-=2*W:E===1&&mt<0&&(mt+=2*W);const Dt=Math.ceil(Math.abs(mt/W*2)),It=[],Ut=mt/Dt,Ve=8/3*Math.sin(Ut/4)*Math.sin(Ut/4)/Math.sin(Ut/2);let ce=dt+Ut;for(let Rt=0;Rt<Dt;Rt++)It[Rt]=Put(dt,ce,O,k,st,ht,$,ot,Ve,P,j),P=It[Rt][5],j=It[Rt][6],dt=ce,ce+=Ut;return It})(h-n,d-t,i,s,l,u,o);for(let g=0,v=m.length;g<v;g++)m[g][1]+=n,m[g][2]+=t,m[g][3]+=n,m[g][4]+=t,m[g][5]+=n,m[g][6]+=t;return m},Lut=n=>{let t=0,e=0,r=0,i=0;const s=[];let o,l=0,u=0;for(const h of n){const d=[...h];let m;switch(d[0]){case"l":d[1]+=t,d[2]+=e;case"L":t=d[1],e=d[2],m=["L",t,e];break;case"h":d[1]+=t;case"H":t=d[1],m=["L",t,e];break;case"v":d[1]+=e;case"V":e=d[1],m=["L",t,e];break;case"m":d[1]+=t,d[2]+=e;case"M":t=d[1],e=d[2],r=d[1],i=d[2],m=["M",t,e];break;case"c":d[1]+=t,d[2]+=e,d[3]+=t,d[4]+=e,d[5]+=t,d[6]+=e;case"C":l=d[3],u=d[4],t=d[5],e=d[6],m=["C",d[1],d[2],l,u,t,e];break;case"s":d[1]+=t,d[2]+=e,d[3]+=t,d[4]+=e;case"S":o==="C"?(l=2*t-l,u=2*e-u):(l=t,u=e),t=d[3],e=d[4],m=["C",l,u,d[1],d[2],t,e],l=m[3],u=m[4];break;case"q":d[1]+=t,d[2]+=e,d[3]+=t,d[4]+=e;case"Q":l=d[1],u=d[2],t=d[3],e=d[4],m=["Q",l,u,t,e];break;case"t":d[1]+=t,d[2]+=e;case"T":o==="Q"?(l=2*t-l,u=2*e-u):(l=t,u=e),t=d[1],e=d[2],m=["Q",l,u,t,e];break;case"a":d[6]+=t,d[7]+=e;case"A":Nut(t,e,d).forEach(g=>s.push(g)),t=d[6],e=d[7];break;case"z":case"Z":t=r,e=i,m=["Z"]}m?(s.push(m),o=m[0]):o=""}return s},sb=(n,t,e,r)=>Math.sqrt((e-n)**2+(r-t)**2),lU=(n,t,e,r,i,s,o,l)=>u=>{const h=u**3,d=(v=>3*v**2*(1-v))(u),m=(v=>3*v*(1-v)**2)(u),g=(v=>(1-v)**3)(u);return new tt(o*h+i*d+e*m+n*g,l*h+s*d+r*m+t*g)},cU=n=>n**2,uU=n=>2*n*(1-n),hU=n=>(1-n)**2,Vut=(n,t,e,r,i,s,o,l)=>u=>{const h=cU(u),d=uU(u),m=hU(u),g=3*(m*(e-n)+d*(i-e)+h*(o-i)),v=3*(m*(r-t)+d*(s-r)+h*(l-s));return Math.atan2(v,g)},jut=(n,t,e,r,i,s)=>o=>{const l=cU(o),u=uU(o),h=hU(o);return new tt(i*l+e*u+n*h,s*l+r*u+t*h)},But=(n,t,e,r,i,s)=>o=>{const l=1-o,u=2*(l*(e-n)+o*(i-e)),h=2*(l*(r-t)+o*(s-r));return Math.atan2(h,u)},iN=(n,t,e)=>{let r=new tt(t,e),i=0;for(let s=1;s<=100;s+=1){const o=n(s/100);i+=sb(r.x,r.y,o.x,o.y),r=o}return i},Fut=(n,t)=>{let e,r=0,i=0,s={x:n.x,y:n.y},o={...s},l=.01,u=0;const h=n.iterator,d=n.angleFinder;for(;i<t&&l>1e-4;)o=h(r),u=r,e=sb(s.x,s.y,o.x,o.y),e+i>t?(r-=l,l/=2):(s=o,r+=l,i+=e);return{...o,angle:d(u)}},fU=n=>{let t,e,r=0,i=0,s=0,o=0,l=0;const u=[];for(const h of n){const d={x:i,y:s,command:h[0],length:0};switch(h[0]){case"M":e=d,e.x=o=i=h[1],e.y=l=s=h[2];break;case"L":e=d,e.length=sb(i,s,h[1],h[2]),i=h[1],s=h[2];break;case"C":t=lU(i,s,h[1],h[2],h[3],h[4],h[5],h[6]),e=d,e.iterator=t,e.angleFinder=Vut(i,s,h[1],h[2],h[3],h[4],h[5],h[6]),e.length=iN(t,i,s),i=h[5],s=h[6];break;case"Q":t=jut(i,s,h[1],h[2],h[3],h[4]),e=d,e.iterator=t,e.angleFinder=But(i,s,h[1],h[2],h[3],h[4]),e.length=iN(t,i,s),i=h[3],s=h[4];break;case"Z":e=d,e.destX=o,e.destY=l,e.length=sb(i,s,o,l),i=o,s=l}r+=e.length,u.push(e)}return u.push({length:r,x:i,y:s}),u},Uut=function(n,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fU(n),r=0;for(;t-e[r].length>0&&r<e.length-2;)t-=e[r].length,r++;const i=e[r],s=t/i.length,o=n[r];switch(i.command){case"M":return{x:i.x,y:i.y,angle:0};case"Z":return{...new tt(i.x,i.y).lerp(new tt(i.destX,i.destY),s),angle:Math.atan2(i.destY-i.y,i.destX-i.x)};case"L":return{...new tt(i.x,i.y).lerp(new tt(o[1],o[2]),s),angle:Math.atan2(o[2]-i.y,o[1]-i.x)};case"C":case"Q":return Fut(i,t)}},zut=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),sN=new RegExp(Out,"g"),Hut=new RegExp(iu,"gi"),$ut={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},qut=n=>{var t;const e=[],r=(t=n.match(zut))!==null&&t!==void 0?t:[];for(const i of r){const s=i[0];if(s==="z"||s==="Z"){e.push([s]);continue}const o=$ut[s.toLowerCase()];let l=[];if(s==="a"||s==="A"){sN.lastIndex=0;for(let u=null;u=sN.exec(i);)l.push(...u.slice(1))}else l=i.match(Hut)||[];for(let u=0;u<l.length;u+=o){const h=new Array(o),d=Iut[s];h[0]=u>0&&d?d:s;for(let m=0;m<o;m++)h[m+1]=parseFloat(l[u+m]);e.push(h)}}return e},Gut=function(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=new tt(n[0]),r=new tt(n[1]),i=1,s=0;const o=[],l=n.length,u=l>2;let h;for(u&&(i=n[2].x<r.x?-1:n[2].x===r.x?0:1,s=n[2].y<r.y?-1:n[2].y===r.y?0:1),o.push(["M",e.x-i*t,e.y-s*t]),h=1;h<l;h++){if(!e.eq(r)){const d=e.midPointFrom(r);o.push(["Q",e.x,e.y,d.x,d.y])}e=n[h],h+1<n.length&&(r=n[h+1])}return u&&(i=e.x>n[h-2].x?1:e.x===n[h-2].x?0:-1,s=e.y>n[h-2].y?1:e.y===n[h-2].y?0:-1),o.push(["L",e.x+i*t,e.y+s*t]),o},dU=(n,t)=>n.map(e=>e.map((r,i)=>i===0||t===void 0?r:Ae(r,t)).join(" ")).join(" ");function TE(n,t){const e=n.style;e&&Object.entries(t).forEach(r=>{let[i,s]=r;return e.setProperty(i,s)})}class Wut extends V5{constructor(t){let{allowTouchScrolling:e=!1,containerClass:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t),q(this,"upper",void 0),q(this,"container",void 0);const{el:i}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(i,{allowTouchScrolling:e}),this.applyCanvasStyle(s,{allowTouchScrolling:e,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(r),i.parentNode&&i.parentNode.replaceChild(o,i),o.append(i,s),this.container=o}createUpperCanvas(){const{el:t}=this.lower,e=Ko();return e.className=t.className,e.classList.remove("lower-canvas"),e.classList.add("upper-canvas"),e.setAttribute("data-fabric","top"),e.style.cssText=t.style.cssText,e.setAttribute("draggable","true"),e}createContainerElement(){const t=af().createElement("div");return t.setAttribute("data-fabric","wrapper"),TE(t,{position:"relative"}),FP(t),t}applyCanvasStyle(t,e){const{styles:r,allowTouchScrolling:i}=e;TE(t,{...r,"touch-action":i?"manipulation":Lr}),FP(t)}setDimensions(t,e){super.setDimensions(t,e);const{el:r,ctx:i}=this.upper;L5(r,i,t,e)}setCSSDimensions(t){super.setCSSDimensions(t),pE(this.upper.el,t),pE(this.container,t)}cleanupDOM(t){const e=this.container,{el:r}=this.lower,{el:i}=this.upper;super.cleanupDOM(t),e.removeChild(i),e.removeChild(r),e.parentNode&&e.parentNode.replaceChild(r,e)}dispose(){super.dispose(),Js().dispose(this.upper.el),delete this.upper,delete this.container}}const Yut=(n,t,e,r)=>{const{target:i,offsetX:s,offsetY:o}=t,l=e-s,u=r-o,h=!ss(i,"lockMovementX")&&i.left!==l,d=!ss(i,"lockMovementY")&&i.top!==u;return h&&i.set(ue,l),d&&i.set(Nr,u),(h||d)&&J5(w5,$5(n,t,e,r)),h||d};class l_ extends Cm{constructor(){super(...arguments),q(this,"_hoveredTargets",[]),q(this,"_currentTransform",null),q(this,"_groupSelector",null),q(this,"contextTopDirty",!1)}static getDefaults(){return{...super.getDefaults(),...l_.ownDefaults}}get upperCanvasEl(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.el}get contextTop(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.ctx}get wrapperEl(){return this.elements.container}initElements(t){this.elements=new Wut(t,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(t){this._objectsToRender=void 0,super._onObjectAdded(t)}_onObjectRemoved(t){this._objectsToRender=void 0,t===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[t]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[t]}),t.fire("deselected",{target:t})),t===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(t)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const t=this._activeObject;return!this.preserveObjectStacking&&t?this._objects.filter(e=>!e.group&&e!==t).concat(t):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()}renderTop(){const t=this.contextTop;this.clearContext(t),this.renderTopLayer(t),this.fire("after:render",{ctx:t})}setTargetFindTolerance(t){t=Math.round(t),this.targetFindTolerance=t;const e=this.getRetinaScaling(),r=Math.ceil((2*t+1)*e);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=r,this.pixelFindContext.scale(e,e)}isTargetTransparent(t,e,r){const i=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-e+i,-r+i),s.transform(...this.viewportTransform);const o=t.selectionBackgroundColor;t.selectionBackgroundColor="",t.render(s),t.selectionBackgroundColor=o,s.restore();const l=Math.round(i*this.getRetinaScaling());return out(s,l,l,l)}_isSelectionKeyPressed(t){const e=this.selectionKey;return!!e&&(Array.isArray(e)?!!e.find(r=>!!r&&t[r]===!0):t[e])}_shouldClearSelection(t,e){const r=this.getActiveObjects(),i=this._activeObject;return!!(!e||e&&i&&r.length>1&&r.indexOf(e)===-1&&i!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&i&&i!==e)}_shouldCenterTransform(t,e,r){if(!t)return;let i;return e===e_||e===Vr||e===ki||e===Wp?i=this.centeredScaling||t.centeredScaling:e===nA&&(i=this.centeredRotation||t.centeredRotation),i?!r:r}_getOriginFromCorner(t,e){const r=e?t.controls[e].getTransformAnchorPoint():{x:t.originX,y:t.originY};return e&&(["ml","tl","bl"].includes(e)?r.x=rn:["mr","tr","br"].includes(e)&&(r.x=ue),["tl","mt","tr"].includes(e)?r.y=fE:["bl","mb","br"].includes(e)&&(r.y=Nr)),r}_setupCurrentTransform(t,e,r){var i;const s=e.group?$h(this.getScenePoint(t),void 0,e.group.calcTransformMatrix()):this.getScenePoint(t),{key:o="",control:l}=e.getActiveControl()||{},u=r&&l?(i=l.getActionHandler(t,e,l))===null||i===void 0?void 0:i.bind(l):Yut,h=((k,O,B,F)=>{if(!O||!k)return"drag";const H=F.controls[O];return H.getActionName(B,H,F)})(r,o,t,e),d=t[this.centeredKey],m=this._shouldCenterTransform(e,h,d)?{x:Wt,y:Wt}:this._getOriginFromCorner(e,o),{scaleX:g,scaleY:v,skewX:T,skewY:S,left:w,top:E,angle:R,width:P,height:j,cropX:N,cropY:W}=e,M={target:e,action:h,actionHandler:u,actionPerformed:!1,corner:o,scaleX:g,scaleY:v,skewX:T,skewY:S,offsetX:s.x-w,offsetY:s.y-E,originX:m.x,originY:m.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:sn(R),width:P,height:j,shiftKey:t.shiftKey,altKey:d,original:{...j5(e),originX:m.x,originY:m.y,cropX:N,cropY:W}};this._currentTransform=M,this.fire("before:transform",{e:t,transform:M})}setCursor(t){this.upperCanvasEl.style.cursor=t}_drawSelection(t){const{x:e,y:r,deltaX:i,deltaY:s}=this._groupSelector,o=new tt(e,r).transform(this.viewportTransform),l=new tt(e+i,r+s).transform(this.viewportTransform),u=this.selectionLineWidth/2;let h=Math.min(o.x,l.x),d=Math.min(o.y,l.y),m=Math.max(o.x,l.x),g=Math.max(o.y,l.y);this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(h,d,m-h,g-d)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,h+=u,d+=u,m-=u,g-=u,nr.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(h,d,m-h,g-d))}findTarget(t){if(this._targetInfo)return this._targetInfo;if(this.skipTargetFind)return{subTargets:[],currentSubTargets:[]};const e=this.getScenePoint(t),r=this._activeObject,i=this.getActiveObjects(),s=this.searchPossibleTargets(this._objects,e),{subTargets:o,container:l,target:u}=s,h={...s,currentSubTargets:o,currentContainer:l,currentTarget:u};if(!r)return h;const d={...this.searchPossibleTargets([r],e),currentSubTargets:o,currentContainer:l,currentTarget:u};return r.findControl(this.getViewportPoint(t),mE(t))?{...d,target:r}:d.target&&(i.length>1||!this.preserveObjectStacking||this.preserveObjectStacking&&t[this.altSelectionKey])?d:h}_pointIsInObjectSelectionArea(t,e){let r=t.getCoords();const i=this.getZoom(),s=t.padding/i;if(s){const[o,l,u,h]=r,d=Math.atan2(l.y-o.y,l.x-o.x),m=Wo(d)*s,g=Yo(d)*s,v=m+g,T=m-g;r=[new tt(o.x-T,o.y-v),new tt(l.x+v,l.y-T),new tt(u.x+T,u.y+v),new tt(h.x-v,h.y+T)]}return je.isPointInPolygon(e,r)}_checkTarget(t,e){if(t&&t.visible&&t.evented&&this._pointIsInObjectSelectionArea(t,e)){if(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing)return!0;{const r=e.transform(this.viewportTransform);if(!this.isTargetTransparent(t,r.x,r.y))return!0}}return!1}_searchPossibleTargets(t,e,r){let i=t.length;for(;i--;){const s=t[i];if(this._checkTarget(s,e)){if(x0(s)&&s.subTargetCheck){const{target:o}=this._searchPossibleTargets(s._objects,e,r);o&&r.push(o)}return{target:s,subTargets:r}}}return{subTargets:[]}}searchPossibleTargets(t,e){const r=this._searchPossibleTargets(t,e,[]);r.container=r.target;const{container:i,subTargets:s}=r;if(i&&x0(i)&&i.interactive&&s[0]){for(let o=s.length-1;o>0;o--){const l=s[o];if(!x0(l)||!l.interactive)return r.target=l,r}return r.target=s[0],r}return r}getViewportPoint(t){return this._viewportPoint?this._viewportPoint:this._getPointerImpl(t,!0)}getScenePoint(t){return this._scenePoint?this._scenePoint:this._getPointerImpl(t)}_getPointerImpl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=this.upperCanvasEl,i=r.getBoundingClientRect();let s=Sct(t),o=i.width||0,l=i.height||0;o&&l||(Nr in i&&fE in i&&(l=Math.abs(i.top-i.bottom)),rn in i&&ue in i&&(o=Math.abs(i.right-i.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,e||(s=$h(s,void 0,this.viewportTransform));const u=this.getRetinaScaling();u!==1&&(s.x/=u,s.y/=u);const h=o===0||l===0?new tt(1,1):new tt(r.width/o,r.height/l);return s.multiply(h)}_setDimensionsImpl(t,e){this._resetTransformEventData(),super._setDimensionsImpl(t,e),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=Ko(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const t=this._activeObject;return Tc(t)?t.getObjects():t?[t]:[]}_fireSelectionEvents(t,e){let r=!1,i=!1;const s=this.getActiveObjects(),o=[],l=[];t.forEach(u=>{s.includes(u)||(r=!0,u.fire("deselected",{e,target:u}),l.push(u))}),s.forEach(u=>{t.includes(u)||(r=!0,u.fire("selected",{e,target:u}),o.push(u))}),t.length>0&&s.length>0?(i=!0,r&&this.fire("selection:updated",{e,selected:o,deselected:l})):s.length>0?(i=!0,this.fire("selection:created",{e,selected:o})):t.length>0&&(i=!0,this.fire("selection:cleared",{e,deselected:l})),i&&(this._objectsToRender=void 0)}setActiveObject(t,e){const r=this.getActiveObjects(),i=this._setActiveObject(t,e);return this._fireSelectionEvents(r,e),i}_setActiveObject(t,e){const r=this._activeObject;return r!==t&&!(!this._discardActiveObject(e,t)&&this._activeObject)&&!t.onSelect({e})&&(this._activeObject=t,Tc(t)&&r!==t&&t.set("canvas",this),t.setCoords(),!0)}_discardActiveObject(t,e){const r=this._activeObject;return!!r&&!r.onDeselect({e:t,object:e})&&(this._currentTransform&&this._currentTransform.target===r&&this.endCurrentTransform(t),Tc(r)&&r===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(t){const e=this.getActiveObjects(),r=this.getActiveObject();e.length&&this.fire("before:selection:cleared",{e:t,deselected:[r]});const i=this._discardActiveObject(t);return this._fireSelectionEvents(e,t),i}endCurrentTransform(t){const e=this._currentTransform;this._finalizeCurrentTransform(t),e&&e.target&&(e.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(t){const e=this._currentTransform,r=e.target,i={e:t,target:r,transform:e,action:e.action};r._scaling&&(r._scaling=!1),r.setCoords(),e.actionPerformed&&(this.fire("object:modified",i),r.fire(Kv,i))}setViewportTransform(t){super.setViewportTransform(t);const e=this._activeObject;e&&e.setCoords()}destroy(){const t=this._activeObject;Tc(t)&&(t.removeAll(),t.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(t){const e=this._activeObject;e&&e._renderControls(t)}_toObject(t,e,r){const i=this._realizeGroupTransformOnObject(t),s=super._toObject(t,e,r);return t.set(i),s}_realizeGroupTransformOnObject(t){const{group:e}=t;if(e&&Tc(e)&&this._activeObject===e){const r=hf(t,["angle","flipX","flipY",ue,Vr,ki,lf,cf,Nr]);return wct(t,e.calcOwnMatrix()),r}return{}}_setSVGObject(t,e,r){const i=this._realizeGroupTransformOnObject(e);super._setSVGObject(t,e,r),e.set(i)}}q(l_,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!0,fireRightClick:!0,fireMiddleClick:!0,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!0});class Kut{constructor(t){q(this,"targets",[]),q(this,"__disposer",void 0);const e=()=>{const{hiddenTextarea:i}=t.getActiveObject()||{};i&&i.focus()},r=t.upperCanvasEl;r.addEventListener("click",e),this.__disposer=()=>r.removeEventListener("click",e)}exitTextEditing(){this.target=void 0,this.targets.forEach(t=>{t.isEditing&&t.exitEditing()})}add(t){this.targets.push(t)}remove(t){this.unregister(t),ch(this.targets,t)}register(t){this.target=t}unregister(t){t===this.target&&(this.target=void 0)}onMouseMove(t){var e;!((e=this.target)===null||e===void 0)&&e.isEditing&&this.target.updateSelectionOnMouseMove(t)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const Wr={passive:!1},mc=(n,t)=>({viewportPoint:n.getViewportPoint(t),scenePoint:n.getScenePoint(t)}),La=function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return n.addEventListener(...e)},vi=function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return n.removeEventListener(...e)},Xut={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class SE extends l_{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),q(this,"_isClick",void 0),q(this,"textEditingManager",new Kut(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(e=>{this[e]=this[e].bind(this)}),this.addOrRemove(La)}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=this.upperCanvasEl,i=this._getEventPrefix();t(N5(r),"resize",this._onResize),t(r,i+"down",this._onMouseDown),t(r,`${i}move`,this._onMouseMove,Wr),t(r,`${i}out`,this._onMouseOut),t(r,`${i}enter`,this._onMouseEnter),t(r,"wheel",this._onMouseWheel,{passive:!1}),t(r,"contextmenu",this._onContextMenu),e||(t(r,"click",this._onClick),t(r,"dblclick",this._onClick)),t(r,"dragstart",this._onDragStart),t(r,"dragend",this._onDragEnd),t(r,"dragover",this._onDragOver),t(r,"dragenter",this._onDragEnter),t(r,"dragleave",this._onDragLeave),t(r,"drop",this._onDrop),this.enablePointerEvents||t(r,"touchstart",this._onTouchStart,Wr)}removeListeners(){this.addOrRemove(vi);const t=this._getEventPrefix(),e=Ki(this.upperCanvasEl);vi(e,`${t}up`,this._onMouseUp),vi(e,"touchend",this._onTouchEnd,Wr),vi(e,`${t}move`,this._onMouseMove,Wr),vi(e,"touchmove",this._onMouseMove,Wr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()}_onMouseOut(t){const e=this._hoveredTarget,r={e:t,...mc(this,t)};this.fire("mouse:out",{...r,target:e}),this._hoveredTarget=void 0,e&&e.fire("mouseout",{...r}),this._hoveredTargets.forEach(i=>{this.fire("mouse:out",{...r,target:i}),i&&i.fire("mouseout",{...r})}),this._hoveredTargets=[]}_onMouseEnter(t){const{target:e}=this.findTarget(t);this._currentTransform||e||(this.fire("mouse:over",{e:t,...mc(this,t)}),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(t){this._isClick=!1;const e=this.getActiveObject();if(e&&e.onDragStart(t)){this._dragSource=e;const r={e:t,target:e};return this.fire("dragstart",r),e.fire("dragstart",r),void La(this.upperCanvasEl,"drag",this._onDragProgress)}UP(t)}_renderDragEffects(t,e,r){let i=!1;const s=this._dropTarget;s&&s!==e&&s!==r&&(s.clearContextTop(),i=!0),e?.clearContextTop(),r!==e&&r?.clearContextTop();const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),e&&(o.save(),e.transform(o),e.renderDragSourceEffect(t),o.restore(),i=!0),r&&(o.save(),r.transform(o),r.renderDropTargetEffect(t),o.restore(),i=!0),o.restore(),i&&(this.contextTopDirty=!0)}_onDragEnd(t){const{currentSubTargets:e}=this.findTarget(t),r=!!t.dataTransfer&&t.dataTransfer.dropEffect!==Lr,i=r?this._activeObject:void 0,s={e:t,target:this._dragSource,subTargets:e,dragSource:this._dragSource,didDrop:r,dropTarget:i};vi(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(t)}_onDragProgress(t){const e={e:t,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",e),this._dragSource&&this._dragSource.fire("drag",e)}_onDragOver(t){const e="dragover",{currentContainer:r,currentSubTargets:i}=this.findTarget(t),s=this._dragSource,o={e:t,target:r,subTargets:i,dragSource:s,canDrop:!1,dropTarget:void 0};let l;this.fire(e,o),this._fireEnterLeaveEvents(t,r,o),r&&(r.canDrop(t)&&(l=r),r.fire(e,o));for(let u=0;u<i.length;u++){const h=i[u];h.canDrop(t)&&(l=h),h.fire(e,o)}this._renderDragEffects(t,s,l),this._dropTarget=l}_onDragEnter(t){const{currentContainer:e,currentSubTargets:r}=this.findTarget(t),i={e:t,target:e,subTargets:r,dragSource:this._dragSource};this.fire("dragenter",i),this._fireEnterLeaveEvents(t,e,i)}_onDragLeave(t){const{currentSubTargets:e}=this.findTarget(t),r={e:t,target:this._draggedoverTarget,subTargets:e,dragSource:this._dragSource};this.fire("dragleave",r),this._fireEnterLeaveEvents(t,void 0,r),this._renderDragEffects(t,this._dragSource),this._dropTarget=void 0,this._hoveredTargets=[]}_onDrop(t){const{currentContainer:e,currentSubTargets:r}=this.findTarget(t),i=this._basicEventHandler("drop:before",{e:t,target:e,subTargets:r,dragSource:this._dragSource,...mc(this,t)});i.didDrop=!1,i.dropTarget=void 0,this._basicEventHandler("drop",i),this.fire("drop:after",i)}_onContextMenu(t){const{target:e,subTargets:r}=this.findTarget(t),i=this._basicEventHandler("contextmenu:before",{e:t,target:e,subTargets:r});return this.stopContextMenu&&UP(t),this._basicEventHandler("contextmenu",i),!1}_onClick(t){const e=t.detail;e>3||e<2||(this._cacheTransformEventData(t),e==2&&t.type==="dblclick"&&this._handleEvent(t,"dblclick"),e==3&&this._handleEvent(t,"tripleclick"),this._resetTransformEventData())}fireEventFromPointerEvent(t,e,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._cacheTransformEventData(t);const{target:s,subTargets:o}=this.findTarget(t),l={e:t,target:s,subTargets:o,...mc(this,t),transform:this._currentTransform,...i};this.fire(e,l),s&&s.fire(r,l);for(let u=0;u<o.length;u++)o[u]!==s&&o[u].fire(r,l);this._resetTransformEventData()}getPointerId(t){const e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1}_isMainEvent(t){return t.isPrimary===!0||t.isPrimary!==!1&&(t.type==="touchend"&&t.touches.length===0||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(t){this._cacheTransformEventData(t);let e=!this.allowTouchScrolling;const r=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t);const{target:i}=this.findTarget(t);(this.isDrawingMode||r&&i===r)&&(e=!0),e&&t.preventDefault();const s=this.upperCanvasEl,o=this._getEventPrefix(),l=Ki(s);La(l,"touchend",this._onTouchEnd,Wr),e&&La(l,"touchmove",this._onMouseMove,Wr),vi(s,`${o}down`,this._onMouseDown),this._resetTransformEventData()}_onMouseDown(t){this._cacheTransformEventData(t),this.__onMouseDown(t);const e=this.upperCanvasEl,r=this._getEventPrefix();vi(e,`${r}move`,this._onMouseMove,Wr);const i=Ki(e);La(i,`${r}up`,this._onMouseUp),La(i,`${r}move`,this._onMouseMove,Wr),this._resetTransformEventData()}_onTouchEnd(t){if(t.touches.length>0)return;this._cacheTransformEventData(t),this.__onMouseUp(t),this._resetTransformEventData(),delete this.mainTouchId;const e=this._getEventPrefix(),r=Ki(this.upperCanvasEl);vi(r,"touchend",this._onTouchEnd,Wr),vi(r,"touchmove",this._onMouseMove,Wr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{La(this.upperCanvasEl,`${e}down`,this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(t){this._cacheTransformEventData(t),this.__onMouseUp(t);const e=this.upperCanvasEl,r=this._getEventPrefix();if(this._isMainEvent(t)){const i=Ki(this.upperCanvasEl);vi(i,`${r}up`,this._onMouseUp),vi(i,`${r}move`,this._onMouseMove,Wr),La(e,`${r}move`,this._onMouseMove,Wr)}this._resetTransformEventData()}_onMouseMove(t){this._cacheTransformEventData(t);const e=this.getActiveObject();!this.allowTouchScrolling&&(!e||!e.shouldStartDragging(t))&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t),this._resetTransformEventData()}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(t){const e=this.getActiveObject();return!!e!=!!t||e&&t&&e!==t}__onMouseUp(t){var e;this._handleEvent(t,"up:before");const r=this._currentTransform,i=this._isClick,{target:s}=this.findTarget(t),{button:o}=t;if(o)return void((this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(t,"up"));if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);if(!this._isMainEvent(t))return;let l,u,h=!1;if(r&&(this._finalizeCurrentTransform(t),h=r.actionPerformed),!i){const d=s===this._activeObject;this.handleSelection(t),h||(h=this._shouldRender(s)||!d&&s===this._activeObject)}if(s){const d=s.findControl(this.getViewportPoint(t),mE(t)),{key:m,control:g}=d||{};if(u=m,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,t),h=!0;else if(g){const v=g.getMouseUpHandler(t,s,g);v&&(l=this.getScenePoint(t),v.call(g,t,r,l.x,l.y))}s.isMoving=!1}if(r&&(r.target!==s||r.corner!==u)){const d=r.target&&r.target.controls[r.corner],m=d&&d.getMouseUpHandler(t,r.target,d);l=l||this.getScenePoint(t),m&&m.call(d,t,r,l.x,l.y)}this._setCursorFromEvent(t,s),this._handleEvent(t,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),h?this.requestRenderAll():i||(e=this._activeObject)!==null&&e!==void 0&&e.isEditing||this.renderTop()}_basicEventHandler(t,e){const{target:r,subTargets:i=[]}=e;this.fire(t,e),r&&r.fire(t,e);for(let s=0;s<i.length;s++)i[s]!==r&&i[s].fire(t,e);return e}_handleEvent(t,e,r){const{target:i,subTargets:s}=this.findTarget(t),o={e:t,target:i,subTargets:s,...mc(this,t),transform:this._currentTransform,...e==="down:before"||e==="down"?r:{}};e!=="up:before"&&e!=="up"||(o.isClick=this._isClick),this.fire(`mouse:${e}`,o),i&&i.fire(`mouse${e}`,o);for(let l=0;l<s.length;l++)s[l]!==i&&s[l].fire(`mouse${e}`,o)}_onMouseDownInDrawingMode(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(t),this.requestRenderAll());const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(t){if(this._isCurrentlyDrawing){const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")}_onMouseUpInDrawingMode(t){const e=this.getScenePoint(t);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:t,pointer:e}):this._isCurrentlyDrawing=!1,this._handleEvent(t,"up")}__onMouseDown(t){this._isClick=!0,this._handleEvent(t,"down:before");let{target:e}=this.findTarget(t),r=!!e&&e===this._activeObject;const{button:i}=t;if(i)return void((this.fireMiddleClick&&i===1||this.fireRightClick&&i===2)&&this._handleEvent(t,"down",{alreadySelected:r}));if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._isMainEvent(t)||this._currentTransform)return;let s=this._shouldRender(e),o=!1;if(this.handleMultiSelection(t,e)?(e=this._activeObject,o=!0,s=!0):this._shouldClearSelection(t,e)&&this.discardActiveObject(t),this.selection&&(!e||!e.selectable&&!e.isEditing&&e!==this._activeObject)){const l=this.getScenePoint(t);this._groupSelector={x:l.x,y:l.y,deltaY:0,deltaX:0}}if(r=!!e&&e===this._activeObject,e){e.selectable&&e.activeOn==="down"&&this.setActiveObject(e,t);const l=e.findControl(this.getViewportPoint(t),mE(t));if(e===this._activeObject&&(l||!o)){this._setupCurrentTransform(t,e,r);const u=l?l.control:void 0,h=this.getScenePoint(t),d=u&&u.getMouseDownHandler(t,e,u);d&&d.call(u,t,this._currentTransform,h.x,h.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(t,"down",{alreadySelected:r}),s&&this.requestRenderAll()}_resetTransformEventData(){this._targetInfo=this._viewportPoint=this._scenePoint=void 0}_cacheTransformEventData(t){this._resetTransformEventData(),this._viewportPoint=this.getViewportPoint(t),this._scenePoint=$h(this._viewportPoint,void 0,this.viewportTransform),this._targetInfo=this.findTarget(t),this._currentTransform&&(this._targetInfo.target=this._currentTransform.target)}__onMouseMove(t){if(this._isClick=!1,this._handleEvent(t,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!this._isMainEvent(t))return;const e=this._groupSelector;if(e){const r=this.getScenePoint(t);e.deltaX=r.x-e.x,e.deltaY=r.y-e.y,this.renderTop()}else if(this._currentTransform)this._transformObject(t);else{const{target:r}=this.findTarget(t);this._setCursorFromEvent(t,r),this._fireOverOutEvents(t,r)}this.textEditingManager.onMouseMove(t),this._handleEvent(t,"move")}_fireOverOutEvents(t,e){const{_hoveredTarget:r,_hoveredTargets:i}=this,{subTargets:s}=this.findTarget(t),o=Math.max(i.length,s.length);this.fireSyntheticInOutEvents("mouse",{e:t,target:e,oldTarget:r,fireCanvas:!0});for(let l=0;l<o;l++)s[l]===e||i[l]&&i[l]===r||this.fireSyntheticInOutEvents("mouse",{e:t,target:s[l],oldTarget:i[l]});this._hoveredTarget=e,this._hoveredTargets=s}_fireEnterLeaveEvents(t,e,r){const i=this._draggedoverTarget,s=this._hoveredTargets,{subTargets:o}=this.findTarget(t),l=Math.max(s.length,o.length);this.fireSyntheticInOutEvents("drag",{...r,target:e,oldTarget:i,fireCanvas:!0});for(let u=0;u<l;u++)this.fireSyntheticInOutEvents("drag",{...r,target:o[u],oldTarget:s[u]});this._draggedoverTarget=e}fireSyntheticInOutEvents(t,e){let{target:r,oldTarget:i,fireCanvas:s,e:o,...l}=e;const{targetIn:u,targetOut:h,canvasIn:d,canvasOut:m}=Xut[t],g=i!==r;if(i&&g){const v={...l,e:o,target:i,nextTarget:r,...mc(this,o)};s&&this.fire(m,v),i.fire(h,v)}if(r&&g){const v={...l,e:o,target:r,previousTarget:i,...mc(this,o)};s&&this.fire(d,v),r.fire(u,v)}}_transformObject(t){const e=this.getScenePoint(t),r=this._currentTransform,i=r.target,s=i.group?$h(e,void 0,i.group.calcTransformMatrix()):e;r.shiftKey=t.shiftKey,r.altKey=!!this.centeredKey&&t[this.centeredKey],this._performTransformAction(t,r,s),r.actionPerformed&&this.requestRenderAll()}_performTransformAction(t,e,r){const{action:i,actionHandler:s,target:o}=e,l=!!s&&s(t,e,r.x,r.y);l&&o.setCoords(),i==="drag"&&l&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||l}_setCursorFromEvent(t,e){if(!e)return void this.setCursor(this.defaultCursor);let r=e.hoverCursor||this.hoverCursor;const i=Tc(this._activeObject)?this._activeObject:null,s=(!i||e.group!==i)&&e.findControl(this.getViewportPoint(t));if(s){const{control:o,coord:l}=s;this.setCursor(o.cursorStyleHandler(t,o,e,l))}else{if(e.subTargetCheck){const{subTargets:o}=this.findTarget(t);o.concat().reverse().forEach(l=>{r=l.hoverCursor||r})}this.setCursor(r)}}handleMultiSelection(t,e){const r=this._activeObject,i=Tc(r);if(r&&this._isSelectionKeyPressed(t)&&this.selection&&e&&e.selectable&&(r!==e||i)&&(i||!e.isDescendantOf(r)&&!r.isDescendantOf(e))&&!e.onSelect({e:t})&&!r.getActiveControl()){if(i){const s=r.getObjects();let o=[];if(e===r){const l=this.getScenePoint(t);let u=this.searchPossibleTargets(s,l);if(u.target?(e=u.target,o=u.subTargets):(u=this.searchPossibleTargets(this._objects,l),e=u.target,o=u.subTargets),!e||!e.selectable)return!1}e.group===r?(r.remove(e),this._hoveredTarget=e,this._hoveredTargets=o,r.size()===1&&this._setActiveObject(r.item(0),t)):(r.multiSelectAdd(e),this._hoveredTarget=r,this._hoveredTargets=o),this._fireSelectionEvents(s,t)}else{r.isEditing&&r.exitEditing();const s=new(_t.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(r,e),this._hoveredTarget=s,this._setActiveObject(s,t),this._fireSelectionEvents([r],t)}return!0}return!1}handleSelection(t){if(!this.selection||!this._groupSelector)return!1;const{x:e,y:r,deltaX:i,deltaY:s}=this._groupSelector,o=new tt(e,r),l=o.add(new tt(i,s)),u=o.min(l),h=o.max(l).subtract(u),d=this.collectObjects({left:u.x,top:u.y,width:h.x,height:h.y},{includeIntersecting:!this.selectionFullyContained}),m=o.eq(l)?d[0]?[d[0]]:[]:d.length>1?d.filter(g=>!g.onSelect({e:t})).reverse():d;if(m.length===1)this.setActiveObject(m[0],t);else if(m.length>1){const g=_t.getClass("ActiveSelection");this.setActiveObject(new g(m,{canvas:this}),t)}return this._groupSelector=null,!0}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0;const{upper:r}=this.elements;r.ctx=void 0;const i=super.toCanvasElement(t,e);return r.ctx=r.el.getContext("2d"),i}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const pU={x1:0,y1:0,x2:0,y2:0},Qut={...pU,r1:0,r2:0},vh=(n,t)=>isNaN(n)&&typeof t=="number"?t:n;function mU(n){return n&&/%$/.test(n)&&Number.isFinite(parseFloat(n))}function gU(n,t){const e=typeof n=="number"?n:typeof n=="string"?parseFloat(n)/(mU(n)?100:1):NaN;return qh(0,vh(e,t),1)}const Jut=/\s*;\s*/,Zut=/\s*:\s*/;function tht(n,t){let e,r;const i=n.getAttribute("style");if(i){const o=i.split(Jut);o[o.length-1]===""&&o.pop();for(let l=o.length;l--;){const[u,h]=o[l].split(Zut).map(d=>d.trim());u==="stop-color"?e=h:u==="stop-opacity"&&(r=h)}}e=e||n.getAttribute("stop-color")||"rgb(0,0,0)",r=vh(parseFloat(r||n.getAttribute("stop-opacity")||""),1);const s=new Te(e);return s.setAlpha(s.getAlpha()*r*t),{offset:gU(n.getAttribute("offset"),0),color:s.toRgba()}}function eht(n,t){const e=[],r=n.getElementsByTagName("stop"),i=gU(t,1);for(let s=r.length;s--;)e.push(tht(r[s],i));return e}function yU(n){return n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?"linear":"radial"}function vU(n){return n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function $i(n,t){return n.getAttribute(t)}function nht(n,t){return(function(e,r){let i,{width:s,height:o,gradientUnits:l}=r;return Object.entries(e).reduce((u,h)=>{let[d,m]=h;if(m==="Infinity")i=1;else if(m==="-Infinity")i=0;else{const g=typeof m=="string";i=g?parseFloat(m):m,g&&mU(m)&&(i*=.01,l==="pixels"&&(d!=="x1"&&d!=="x2"&&d!=="r2"||(i*=s),d!=="y1"&&d!=="y2"||(i*=o)))}return u[d]=i,u},{})})(yU(n)==="linear"?(function(e){return{x1:$i(e,"x1")||0,y1:$i(e,"y1")||0,x2:$i(e,"x2")||"100%",y2:$i(e,"y2")||0}})(n):(function(e){return{x1:$i(e,"fx")||$i(e,"cx")||"50%",y1:$i(e,"fy")||$i(e,"cy")||"50%",r1:0,x2:$i(e,"cx")||"50%",y2:$i(e,"cy")||"50%",r2:$i(e,"r")||"50%"}})(n),{...t,gradientUnits:vU(n)})}class My{constructor(t){const{type:e="linear",gradientUnits:r="pixels",coords:i={},colorStops:s=[],offsetX:o=0,offsetY:l=0,gradientTransform:u,id:h}=t||{};Object.assign(this,{type:e,gradientUnits:r,coords:{...e==="radial"?Qut:pU,...i},colorStops:s,offsetX:o,offsetY:l,gradientTransform:u,id:h?`${h}_${Sl()}`:Sl()})}addColorStop(t){for(const e in t)this.colorStops.push({offset:parseFloat(e),color:t[e]});return this}toObject(t){return{...hf(this,t),type:this.type,coords:{...this.coords},colorStops:this.colorStops.map(e=>({...e})),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0}}toSVG(t){let{additionalTransform:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=[],i=this.gradientTransform?this.gradientTransform.concat():Tr.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(g=>({...g})).sort((g,v)=>g.offset-v.offset);let l=-this.offsetX,u=-this.offsetY;var h;s==="objectBoundingBox"?(l/=t.width,u/=t.height):(l+=t.width/2,u+=t.height/2),(h=t)&&typeof h._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(l-=t.pathOffset.x,u-=t.pathOffset.y),i[4]-=l,i[5]-=u;const d=[`id="SVGID_${ne(String(this.id))}"`,`gradientUnits="${s}"`,`gradientTransform="${e?e+" ":""}${Kp(i)}"`,""].join(" "),m=g=>parseFloat(String(g));if(this.type==="linear"){const{x1:g,y1:v,x2:T,y2:S}=this.coords,w=m(g),E=m(v),R=m(T),P=m(S);r.push("<linearGradient ",d,' x1="',w,'" y1="',E,'" x2="',R,'" y2="',P,`">
`)}else if(this.type==="radial"){const{x1:g,y1:v,x2:T,y2:S,r1:w,r2:E}=this.coords,R=m(g),P=m(v),j=m(T),N=m(S),W=m(w),M=m(E),k=W>M;r.push("<radialGradient ",d,' cx="',k?R:j,'" cy="',k?P:N,'" r="',k?W:M,'" fx="',k?j:R,'" fy="',k?N:P,`">
`),k&&(o.reverse(),o.forEach(B=>{B.offset=1-B.offset}));const O=Math.min(W,M);if(O>0){const B=O/Math.max(W,M);o.forEach(F=>{F.offset+=B*(1-F.offset)})}}return o.forEach(g=>{let{color:v,offset:T}=g;r.push(`<stop offset="${100*T}%" style="stop-color:${v};"/>
`)}),r.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),r.join("")}toLive(t){const{x1:e,y1:r,x2:i,y2:s,r1:o,r2:l}=this.coords,u=this.type==="linear"?t.createLinearGradient(e,r,i,s):t.createRadialGradient(e,r,o,i,s,l);return this.colorStops.forEach(h=>{let{color:d,offset:m}=h;u.addColorStop(m,d)}),u}static async fromObject(t){const{colorStops:e,gradientTransform:r}=t;return new this({...t,colorStops:e?e.map(i=>({...i})):void 0,gradientTransform:r?[...r]:void 0})}static fromElement(t,e,r){const i=vU(t),s=e._findCenterFromElement();return new this({id:t.getAttribute("id")||void 0,type:yU(t),coords:nht(t,{width:r.viewBoxWidth||r.width,height:r.viewBoxHeight||r.height}),colorStops:eht(t,r.opacity),gradientUnits:i,gradientTransform:vE(t.getAttribute("gradientTransform")||""),...i==="pixels"?{offsetX:e.width/2-s.x,offsetY:e.height/2-s.y}:{offsetX:0,offsetY:0}})}}q(My,"type","Gradient"),_t.setClass(My,"gradient"),_t.setClass(My,"linear"),_t.setClass(My,"radial");class Dw{get type(){return"pattern"}set type(t){Tl("warn","Setting type has no effect",t)}constructor(t){q(this,"repeat","repeat"),q(this,"offsetX",0),q(this,"offsetY",0),q(this,"crossOrigin",""),this.id=Sl(),Object.assign(this,t)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(t){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?t.createPattern(this.source,this.repeat):null}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:e,crossOrigin:r}=this;return{...hf(this,t),type:"pattern",source:this.sourceToString(),repeat:e,crossOrigin:r,offsetX:Ae(this.offsetX,me.NUM_FRACTION_DIGITS),offsetY:Ae(this.offsetY,me.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null}}toSVG(t){let{width:e,height:r}=t;const{source:i,repeat:s,id:o}=this,l=vh(this.offsetX/e,0),u=vh(this.offsetY/r,0),h=s==="repeat-y"||s==="no-repeat"?1+Math.abs(l||0):vh(i.width/e,0),d=s==="repeat-x"||s==="no-repeat"?1+Math.abs(u||0):vh(i.height/r,0);return[`<pattern id="SVGID_${ne(o)}" x="${l}" y="${u}" width="${h}" height="${d}">`,`<image x="0" y="0" width="${i.width}" height="${i.height}" xlink:href="${ne(this.sourceToString())}"></image>`,"</pattern>",""].join(`
`)}static async fromObject(t,e){let{type:r,source:i,patternTransform:s,...o}=t;const l=await C0(i,{...e,crossOrigin:o.crossOrigin});return new this({...o,patternTransform:s&&s.slice(0),source:l})}}q(Dw,"type","Pattern"),_t.setClass(Dw),_t.setClass(Dw,"pattern");class rht{constructor(t){q(this,"color","rgb(0, 0, 0)"),q(this,"width",1),q(this,"shadow",null),q(this,"strokeLineCap","round"),q(this,"strokeLineJoin","round"),q(this,"strokeMiterLimit",10),q(this,"strokeDashArray",null),q(this,"limitedToCanvasSize",!1),this.canvas=t}_setBrushStyles(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])}_saveAndTransform(t){const e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}needsFullRender(){return new Te(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;const t=this.canvas,e=this.shadow,r=t.contextTop,i=t.getZoom()*t.getRetinaScaling();r.shadowColor=e.color,r.shadowBlur=e.blur*i,r.shadowOffsetX=e.offsetX*i,r.shadowOffsetY=e.offsetY*i}_resetShadow(){const t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}_isOutSideCanvas(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}}class Ka extends nr{constructor(t){let{path:e,left:r,top:i,...s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Ka.ownDefaults),this.setOptions(s),this._setPath(t||[],!0),typeof r=="number"&&this.set(ue,r),typeof i=="number"&&this.set(Nr,i)}_setPath(t,e){this.path=Lut(Array.isArray(t)?t:qut(t)),this.setBoundingBox(e)}_findCenterFromElement(){const t=this._calcBoundsFromPath();return new tt(t.left+t.width/2,t.top+t.height/2)}_renderPathCommands(t){const e=-this.pathOffset.x,r=-this.pathOffset.y;t.beginPath();for(const i of this.path)switch(i[0]){case"L":t.lineTo(i[1]+e,i[2]+r);break;case"M":t.moveTo(i[1]+e,i[2]+r);break;case"C":t.bezierCurveTo(i[1]+e,i[2]+r,i[3]+e,i[4]+r,i[5]+e,i[6]+r);break;case"Q":t.quadraticCurveTo(i[1]+e,i[2]+r,i[3]+e,i[4]+r);break;case"Z":t.closePath()}}_render(t){this._renderPathCommands(t),this._renderPaintInOrder(t)}toString(){return`#<Path (${this.complexity()}): { "top": ${this.top}, "left": ${this.left} }>`}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject(t),path:this.path.map(e=>e.slice())}}toDatalessObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.toObject(t);return this.sourcePath&&(delete e.path,e.sourcePath=this.sourcePath),e}_toSVG(){return["<path ","COMMON_PARTS",`d="${dU(this.path,me.NUM_FRACTION_DIGITS)}" stroke-linecap="round" />
`]}_getOffsetTransform(){const t=me.NUM_FRACTION_DIGITS;return` translate(${Ae(-this.pathOffset.x,t)}, ${Ae(-this.pathOffset.y,t)})`}toClipPathSVG(t){const e=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}toSVG(t){const e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{width:e,height:r,pathOffset:i}=this._calcDimensions();this.set({width:e,height:r,pathOffset:i}),t&&this.setPositionByOrigin(i,Wt,Wt)}_calcBoundsFromPath(){const t=[];let e=0,r=0,i=0,s=0;for(const o of this.path)switch(o[0]){case"L":i=o[1],s=o[2],t.push({x:e,y:r},{x:i,y:s});break;case"M":i=o[1],s=o[2],e=i,r=s;break;case"C":t.push(...rN(i,s,o[1],o[2],o[3],o[4],o[5],o[6])),i=o[5],s=o[6];break;case"Q":t.push(...rN(i,s,o[1],o[2],o[1],o[2],o[3],o[4])),i=o[3],s=o[4];break;case"Z":i=e,s=r}return Fo(t)}_calcDimensions(){const t=this._calcBoundsFromPath();return{...t,pathOffset:new tt(t.left+t.width/2,t.top+t.height/2)}}static fromObject(t){return this._fromObject(t,{extraParam:"path"})}static async fromElement(t,e,r){const{d:i,...s}=Zo(t,this.ATTRIBUTE_NAMES,r);return new this(i,{...s,...e,left:void 0,top:void 0})}}q(Ka,"type","Path"),q(Ka,"cacheProperties",[...Jo,"path","fillRule"]),q(Ka,"ATTRIBUTE_NAMES",[...Ll,"d"]),_t.setClass(Ka),_t.setSVGClass(Ka);class ob extends rht{constructor(t){super(t),q(this,"decimate",.4),q(this,"drawStraightLine",!1),q(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(t,e,r){const i=e.midPointFrom(r);return t.quadraticCurveTo(e.x,e.y,i.x,i.y),i}onMouseDown(t,e){let{e:r}=e;this.canvas._isMainEvent(r)&&(this.drawStraightLine=!!this.straightLineKey&&r[this.straightLineKey],this._prepareForDrawing(t),this._addPoint(t),this._render())}onMouseMove(t,e){let{e:r}=e;if(this.canvas._isMainEvent(r)&&(this.drawStraightLine=!!this.straightLineKey&&r[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(t))&&this._addPoint(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{const i=this._points,s=i.length,o=this.canvas.contextTop;this._saveAndTransform(o),this.oldEnd&&(o.beginPath(),o.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=ob.drawSegment(o,i[s-2],i[s-1]),o.stroke(),o.restore()}}onMouseUp(t){let{e}=t;return!this.canvas._isMainEvent(e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(t){this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)}_addPoint(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,e=this._points[0],r=this._points[1];if(this._saveAndTransform(t),t.beginPath(),this._points.length===2&&e.x===r.x&&e.y===r.y){const i=this.width/1e3;e.x-=i,r.x+=i}t.moveTo(e.x,e.y);for(let i=1;i<this._points.length;i++)ob.drawSegment(t,e,r),e=this._points[i],r=this._points[i+1];t.lineTo(e.x,e.y),t.stroke(),t.restore()}convertPointsToSVGPath(t){const e=this.width/1e3;return Gut(t,e)}createPath(t){const e=new Ka(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new Gs(this.shadow)),e}decimatePoints(t,e){if(t.length<=2)return t;let r,i=t[0];const s=this.canvas.getZoom(),o=Math.pow(e/s,2),l=t.length-1,u=[i];for(let h=1;h<l-1;h++)r=Math.pow(i.x-t[h].x,2)+Math.pow(i.y-t[h].y,2),r>=o&&(i=t[h],u.push(i));return u.push(t[l]),u}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));const t=this.convertPointsToSVGPath(this._points);if((function(r){return dU(r)==="M 0 0 Q 0 0 0 0 L 0 0"})(t))return void this.canvas.requestRenderAll();const e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.requestRenderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}}const bU=["radius","startAngle","endAngle","counterClockwise"];class Ao extends nr{static getDefaults(){return{...super.getDefaults(),...Ao.ownDefaults}}constructor(t){super(),Object.assign(this,Ao.ownDefaults),this.setOptions(t)}_set(t,e){return super._set(t,e),t==="radius"&&this.setRadius(e),this}_render(t){t.beginPath(),t.arc(0,0,this.radius,sn(this.startAngle),sn(this.endAngle),this.counterClockwise),this._renderPaintInOrder(t)}getRadiusX(){return this.get("radius")*this.get(Vr)}getRadiusY(){return this.get("radius")*this.get(ki)}setRadius(t){this.radius=t,this.set({width:2*t,height:2*t})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...bU,...t])}_toSVG(){const{radius:t,startAngle:e,endAngle:r}=this,i=(r-e)%360;if(i===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',`${ne(t)}`,`" />
`];{const s=sn(e),o=sn(r),l=Wo(s)*t,u=Yo(s)*t,h=Wo(o)*t,d=Yo(o)*t;return[`<path d="M ${l} ${u} A ${t} ${t} 0 ${i>180?1:0} ${this.counterClockwise?0:1} ${h} ${d}" `,"COMMON_PARTS",` />
`]}}static async fromElement(t,e,r){const{left:i=0,top:s=0,radius:o=0,...l}=Zo(t,this.ATTRIBUTE_NAMES,r);return new this({...l,radius:o,left:i-o,top:s-o})}static fromObject(t){return super._fromObject(t)}}q(Ao,"type","Circle"),q(Ao,"cacheProperties",[...Jo,...bU]),q(Ao,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),q(Ao,"ATTRIBUTE_NAMES",["cx","cy","r",...Ll]),_t.setClass(Ao),_t.setSVGClass(Ao);const wE=["x1","x2","y1","y2"];class Sc extends nr{constructor(){let[t,e,r,i]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Sc.ownDefaults),this.setOptions(s),this.x1=t,this.x2=r,this.y1=e,this.y2=i,this._setWidthHeight();const{left:o,top:l}=s;typeof o=="number"&&this.set(ue,o),typeof l=="number"&&this.set(Nr,l)}_setWidthHeight(){const{x1:t,y1:e,x2:r,y2:i}=this;this.width=Math.abs(r-t),this.height=Math.abs(i-e);const{left:s,top:o,width:l,height:u}=Fo([{x:t,y:e},{x:r,y:i}]),h=new tt(s+l/2,o+u/2);this.setPositionByOrigin(h,Wt,Wt)}_set(t,e){return super._set(t,e),wE.includes(t)&&this._setWidthHeight(),this}_render(t){t.beginPath();const e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;const r=t.strokeStyle;var i;Si(this.stroke)?t.strokeStyle=this.stroke.toLive(t):t.strokeStyle=(i=this.stroke)!==null&&i!==void 0?i:t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=r}_findCenterFromElement(){return new tt((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject(t),...this.calcLinePoints()}}_getNonTransformedDimensions(){const t=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(t.y-=this.strokeWidth),this.height===0&&(t.x-=this.strokeWidth)),t}calcLinePoints(){const{x1:t,x2:e,y1:r,y2:i,width:s,height:o}=this,l=t<=e?-.5:.5,u=r<=i?-.5:.5;return{x1:l*s,x2:l*-s,y1:u*o,y2:u*-o}}_toSVG(){const{x1:t,x2:e,y1:r,y2:i}=this.calcLinePoints();return["<line ","COMMON_PARTS",`x1="${t}" y1="${r}" x2="${e}" y2="${i}" />
`]}static async fromElement(t,e,r){const{x1:i=0,y1:s=0,x2:o=0,y2:l=0,...u}=Zo(t,this.ATTRIBUTE_NAMES,r);return new this([i,s,o,l],u)}static fromObject(t){let{x1:e,y1:r,x2:i,y2:s,...o}=t;return this._fromObject({...o,points:[e,r,i,s]},{extraParam:"points"})}}q(Sc,"type","Line"),q(Sc,"cacheProperties",[...Jo,...wE]),q(Sc,"ATTRIBUTE_NAMES",Ll.concat(wE)),_t.setClass(Sc),_t.setSVGClass(Sc);class Dc extends nr{static getDefaults(){return{...super.getDefaults(),...Dc.ownDefaults}}constructor(t){super(),Object.assign(this,Dc.ownDefaults),this.setOptions(t)}_render(t){const e=this.width/2,r=this.height/2;t.beginPath(),t.moveTo(-e,r),t.lineTo(0,-r),t.lineTo(e,r),t.closePath(),this._renderPaintInOrder(t)}_toSVG(){const t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',`${-t} ${e},0 ${-e},${t} ${e}`,'" />']}}q(Dc,"type","Triangle"),q(Dc,"ownDefaults",{width:100,height:100}),_t.setClass(Dc),_t.setSVGClass(Dc);const _U=["rx","ry"];class ko extends nr{static getDefaults(){return{...super.getDefaults(),...ko.ownDefaults}}constructor(t){super(),Object.assign(this,ko.ownDefaults),this.setOptions(t)}_set(t,e){switch(super._set(t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this}getRx(){return this.get("rx")*this.get(Vr)}getRy(){return this.get("ry")*this.get(ki)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([..._U,...t])}_toSVG(){return["<ellipse ","COMMON_PARTS",`cx="0" cy="0" rx="${ne(this.rx)}" ry="${ne(this.ry)}" />
`]}_render(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,Hh,!1),t.restore(),this._renderPaintInOrder(t)}static async fromElement(t,e,r){const i=Zo(t,this.ATTRIBUTE_NAMES,r);return i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,new this(i)}}q(ko,"type","Ellipse"),q(ko,"cacheProperties",[...Jo,..._U]),q(ko,"ownDefaults",{rx:0,ry:0}),q(ko,"ATTRIBUTE_NAMES",[...Ll,"cx","cy","rx","ry"]),_t.setClass(ko),_t.setSVGClass(ko);const TU={exactBoundingBox:!1};class Wi extends nr{static getDefaults(){return{...super.getDefaults(),...Wi.ownDefaults}}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),q(this,"strokeDiff",void 0),Object.assign(this,Wi.ownDefaults),this.setOptions(e),this.points=t;const{left:r,top:i}=e;this.initialized=!0,this.setBoundingBox(!0),typeof r=="number"&&this.set(ue,r),typeof i=="number"&&this.set(Nr,i)}isOpen(){return!0}_projectStrokeOnPoints(t){return lut(this.points,t,this.isOpen())}_calcDimensions(t){t={scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth,...t||{}};const e=this.exactBoundingBox?this._projectStrokeOnPoints(t).map(h=>h.projectedPoint):this.points;if(e.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new tt,strokeOffset:new tt,strokeDiff:new tt};const r=Fo(e),i=n_({...t,scaleX:1,scaleY:1}),s=Fo(this.points.map(h=>Dr(h,i,!0))),o=new tt(this.scaleX,this.scaleY);let l=r.left+r.width/2,u=r.top+r.height/2;return this.exactBoundingBox&&(l-=u*Math.tan(sn(this.skewX)),u-=l*Math.tan(sn(this.skewY))),{...r,pathOffset:new tt(l,u),strokeOffset:new tt(s.left,s.top).subtract(new tt(r.left,r.top)).multiply(o),strokeDiff:new tt(r.width,r.height).subtract(new tt(s.width,s.height)).multiply(o)}}_findCenterFromElement(){const t=Fo(this.points);return new tt(t.left+t.width/2,t.top+t.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{left:e,top:r,width:i,height:s,pathOffset:o,strokeOffset:l,strokeDiff:u}=this._calcDimensions();this.set({width:i,height:s,pathOffset:o,strokeOffset:l,strokeDiff:u}),t&&this.setPositionByOrigin(new tt(e+i/2,r+s/2),Wt,Wt)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new tt(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(t).some(l=>this.strokeUniform||this.constructor.layoutProperties.includes(l))){var e,r;const{width:l,height:u}=this._calcDimensions(t);o=new tt((e=t.width)!==null&&e!==void 0?e:l,(r=t.height)!==null&&r!==void 0?r:u)}else{var i,s;o=new tt((i=t.width)!==null&&i!==void 0?i:this.width,(s=t.height)!==null&&s!==void 0?s:this.height)}return o.multiply(new tt(t.scaleX||this.scaleX,t.scaleY||this.scaleY))}return super._getTransformedDimensions(t)}_set(t,e){const r=this.initialized&&this[t]!==e,i=super._set(t,e);return this.exactBoundingBox&&r&&((t===Vr||t===ki)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(t))&&this.setDimensions(),i}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject(t),points:this.points.map(e=>{let{x:r,y:i}=e;return{x:r,y:i}})}}_toSVG(){const t=this.pathOffset.x,e=this.pathOffset.y,r=me.NUM_FRACTION_DIGITS,i=this.points.map(s=>{let{x:o,y:l}=s;return`${Ae(o-t,r)},${Ae(l-e,r)}`}).join(" ");return[`<${ne(this.constructor.type).toLowerCase()} `,"COMMON_PARTS",`points="${i}" />
`]}_render(t){const e=this.points.length,r=this.pathOffset.x,i=this.pathOffset.y;if(e&&!isNaN(this.points[e-1].y)){t.beginPath(),t.moveTo(this.points[0].x-r,this.points[0].y-i);for(let s=0;s<e;s++){const o=this.points[s];t.lineTo(o.x-r,o.y-i)}!this.isOpen()&&t.closePath(),this._renderPaintInOrder(t)}}complexity(){return this.points.length}static async fromElement(t,e,r){const i=(function(u){if(!u)return[];const h=u.replace(/,/g," ").trim().split(/\s+/),d=[];for(let m=0;m<h.length;m+=2)d.push({x:parseFloat(h[m]),y:parseFloat(h[m+1])});return d})(t.getAttribute("points")),{left:s,top:o,...l}=Zo(t,this.ATTRIBUTE_NAMES,r);return new this(i,{...l,...e})}static fromObject(t){return this._fromObject(t,{extraParam:"points"})}}q(Wi,"ownDefaults",TU),q(Wi,"type","Polyline"),q(Wi,"layoutProperties",[lf,cf,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),q(Wi,"cacheProperties",[...Jo,"points"]),q(Wi,"ATTRIBUTE_NAMES",[...Ll]),_t.setClass(Wi),_t.setSVGClass(Wi);class Dy extends Wi{isOpen(){return!1}}q(Dy,"ownDefaults",TU),q(Dy,"type","Polygon"),_t.setClass(Dy),_t.setSVGClass(Dy);class SU extends nr{isEmptyStyles(t){if(!this.styles||t!==void 0&&!this.styles[t])return!0;const e=t===void 0?this.styles:{line:this.styles[t]};for(const r in e)for(const i in e[r])for(const s in e[r][i])return!1;return!0}styleHas(t,e){if(!this.styles||e!==void 0&&!this.styles[e])return!1;const r=e===void 0?this.styles:{0:this.styles[e]};for(const i in r)for(const s in r[i])if(r[i][s][t]!==void 0)return!0;return!1}cleanStyle(t){if(!this.styles)return!1;const e=this.styles;let r,i,s=0,o=!0,l=0;for(const u in e){r=0;for(const h in e[u]){const d=e[u][h]||{};s++,d[t]!==void 0?(i?d[t]!==i&&(o=!1):i=d[t],d[t]===this[t]&&delete d[t]):o=!1,Object.keys(d).length!==0?r++:delete e[u][h]}r===0&&delete e[u]}for(let u=0;u<this._textLines.length;u++)l+=this._textLines[u].length;o&&s===l&&(this[t]=i,this.removeStyle(t))}removeStyle(t){if(!this.styles)return;const e=this.styles;let r,i,s;for(i in e){for(s in r=e[i],r)delete r[s][t],Object.keys(r[s]).length===0&&delete r[s];Object.keys(r).length===0&&delete e[i]}}_extendStyles(t,e){const{lineIndex:r,charIndex:i}=this.get2DCursorLocation(t);this._getLineStyle(r)||this._setLineStyle(r);const s=oA({...this._getStyleDeclaration(r,i),...e},o=>o!==void 0);this._setStyleDeclaration(r,i,s)}getSelectionStyles(t,e,r){const i=[];for(let s=t;s<(e||t);s++)i.push(this.getStyleAtPosition(s,r));return i}getStyleAtPosition(t,e){const{lineIndex:r,charIndex:i}=this.get2DCursorLocation(t);return e?this.getCompleteStyleDeclaration(r,i):this._getStyleDeclaration(r,i)}setSelectionStyles(t,e,r){for(let i=e;i<(r||e);i++)this._extendStyles(i,t);this._forceClearCache=!0}_getStyleDeclaration(t,e){var r;const i=this.styles&&this.styles[t];return i&&(r=i[e])!==null&&r!==void 0?r:{}}getCompleteStyleDeclaration(t,e){return{...hf(this,this.constructor._styleProperties),...this._getStyleDeclaration(t,e)}}_setStyleDeclaration(t,e,r){this.styles[t][e]=r}_deleteStyleDeclaration(t,e){delete this.styles[t][e]}_getLineStyle(t){return!!this.styles[t]}_setLineStyle(t){this.styles[t]={}}_deleteLineStyle(t){delete this.styles[t]}}q(SU,"_styleProperties",Dct);const iht=/  +/g,sht=/"/g;function Ow(n,t,e,r,i){return`		${(function(s,o){let{left:l,top:u,width:h,height:d}=o,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:me.NUM_FRACTION_DIGITS;const g=Xp(Nn,s,!1),[v,T,S,w]=[l,u,h,d].map(E=>Ae(E,m));return`<rect ${g} x="${v}" y="${T}" width="${S}" height="${w}"></rect>`})(n,{left:t,top:e,width:r,height:i})}
`}let Iw;class ur extends SU{static getDefaults(){return{...super.getDefaults(),...ur.ownDefaults}}constructor(t,e){super(),q(this,"__charBounds",[]),Object.assign(this,ur.ownDefaults),this.setOptions(e),this.styles||(this.styles={}),this.text=t,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const t=this.path;t&&(t.segmentsInfo=fU(t.path))}_splitText(){const t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Bs)&&this.enlargeSpaces()}enlargeSpaces(){let t,e,r,i,s,o,l;for(let u=0,h=this._textLines.length;u<h;u++)if((this.textAlign===Bs||u!==h-1&&!this.isEndOfWrapping(u))&&(i=0,s=this._textLines[u],e=this.getLineWidth(u),e<this.width&&(l=this.textLines[u].match(this._reSpacesAndTabs)))){r=l.length,t=(this.width-e)/r;for(let d=0;d<=s.length;d++)o=this.__charBounds[u][d],this._reSpaceAndTab.test(s[d])?(o.width+=t,o.kernedWidth+=t,o.left+=i,i+=t):o.left+=i}}isEndOfWrapping(t){return t===this._textLines.length-1}missingNewlineOffset(t){return 1}get2DCursorLocation(t,e){const r=e?this._unwrappedTextLines:this._textLines;let i;for(i=0;i<r.length;i++){if(t<=r[i].length)return{lineIndex:i,charIndex:t};t-=r[i].length+this.missingNewlineOffset(i,e)}return{lineIndex:i-1,charIndex:r[i-1].length<t?r[i-1].length:t}}toString(){return`#<Text (${this.complexity()}): { "text": "${this.text}", "fontFamily": "${this.fontFamily}" }>`}_getCacheCanvasDimensions(){const t=super._getCacheCanvasDimensions(),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t}_render(t){const e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")}_renderText(t){this.paintFirst===ti?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))}_setTextStyles(t,e,r){if(t.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Wt:t.textBaseline="middle";break;case"ascender":t.textBaseline=Nr;break;case"descender":t.textBaseline=fE}t.font=this._getFontDeclaration(e,r)}calcTextWidth(){let t=this.getLineWidth(0);for(let e=1,r=this._textLines.length;e<r;e++){const i=this.getLineWidth(e);i>t&&(t=i)}return t}_renderTextLine(t,e,r,i,s,o){this._renderChars(t,e,r,i,s,o)}_renderTextLinesBackground(t){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const e=t.fillStyle,r=this._getLeftOffset();let i=this._getTopOffset();for(let s=0,o=this._textLines.length;s<o;s++){const l=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){i+=l;continue}const u=this._textLines[s].length,h=this._getLineLeftOffset(s);let d,m,g=0,v=0,T=this.getValueOfPropertyAt(s,0,"textBackgroundColor");const S=this.getHeightOfLineImpl(s);for(let w=0;w<u;w++){const E=this.__charBounds[s][w];m=this.getValueOfPropertyAt(s,w,"textBackgroundColor"),this.path?(t.save(),t.translate(E.renderLeft,E.renderTop),t.rotate(E.angle),t.fillStyle=m,m&&t.fillRect(-E.width/2,-S*(1-this._fontSizeFraction),E.width,S),t.restore()):m!==T?(d=r+h+v,this.direction===Co&&(d=this.width-d-g),t.fillStyle=T,T&&t.fillRect(d,i,g,S),v=E.left,g=E.width,T=m):g+=E.kernedWidth}m&&!this.path&&(d=r+h+v,this.direction===Co&&(d=this.width-d-g),t.fillStyle=m,t.fillRect(d,i,g,S)),i+=l}t.fillStyle=e,this._removeShadow(t)}_measureChar(t,e,r,i){const s=mp.getFontCache(e),o=this._getFontDeclaration(e),l=r?r+t:t,u=r&&o===this._getFontDeclaration(i),h=e.fontSize/this.CACHE_FONT_SIZE;let d,m,g,v;if(r&&s.has(r)&&(g=s.get(r)),s.has(t)&&(v=d=s.get(t)),u&&s.has(l)&&(m=s.get(l),v=m-g),d===void 0||g===void 0||m===void 0){const T=(function(){return Iw||(Iw=Ri({width:0,height:0}).getContext("2d")),Iw})();this._setTextStyles(T,e,!0),d===void 0&&(v=d=T.measureText(t).width,s.set(t,d)),g===void 0&&u&&r&&(g=T.measureText(r).width,s.set(r,g)),u&&m===void 0&&(m=T.measureText(l).width,s.set(l,m),v=m-g)}return{width:d*h,kernedWidth:v*h}}getHeightOfChar(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")}measureLine(t){const e=this._measureLine(t);return this.charSpacing!==0&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e}_measureLine(t){let e,r,i=0;const s=this.pathSide===rn,o=this.path,l=this._textLines[t],u=l.length,h=new Array(u);this.__charBounds[t]=h;for(let d=0;d<u;d++){const m=l[d];r=this._getGraphemeBox(m,t,d,e),h[d]=r,i+=r.kernedWidth,e=m}if(h[u]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let d=0;const m=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case ue:d=s?m-i:0;break;case Wt:d=(m-i)/2;break;case rn:d=s?0:m-i}d+=this.pathStartOffset*(s?-1:1);for(let g=s?u-1:0;s?g>=0:g<u;s?g--:g++)r=h[g],d>m?d%=m:d<0&&(d+=m),this._setGraphemeOnPath(d,r),d+=r.kernedWidth}return{width:i,numOfSpaces:0}}_setGraphemeOnPath(t,e){const r=t+e.kernedWidth/2,i=this.path,s=Uut(i.path,r,i.segmentsInfo);e.renderLeft=s.x-i.pathOffset.x,e.renderTop=s.y-i.pathOffset.y,e.angle=s.angle+(this.pathSide===rn?Math.PI:0)}_getGraphemeBox(t,e,r,i,s){const o=this.getCompleteStyleDeclaration(e,r),l=i?this.getCompleteStyleDeclaration(e,r-1):{},u=this._measureChar(t,o,i,l);let h,d=u.kernedWidth,m=u.width;this.charSpacing!==0&&(h=this._getWidthOfCharSpacing(),m+=h,d+=h);const g={width:m,left:0,height:o.fontSize,kernedWidth:d,deltaY:o.deltaY};if(r>0&&!s){const v=this.__charBounds[e][r-1];g.left=v.left+v.width+u.kernedWidth-u.width}return g}getHeightOfLineImpl(t){const e=this.__lineHeights;if(e[t])return e[t];let r=this.getHeightOfChar(t,0);for(let i=1,s=this._textLines[t].length;i<s;i++)r=Math.max(this.getHeightOfChar(t,i),r);return e[t]=r*this._fontSizeMult}getHeightOfLine(t){return this.getHeightOfLineImpl(t)*this.lineHeight}calcTextHeight(){let t=0;for(let e=0,r=this._textLines.length;e<r;e++)t+=e===r-1?this.getHeightOfLineImpl(e):this.getHeightOfLine(e);return t}_getLeftOffset(){return this.direction===_c?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(t,e){t.save();let r=0;const i=this._getLeftOffset(),s=this._getTopOffset();for(let o=0,l=this._textLines.length;o<l;o++)this._renderTextLine(e,t,this._textLines[o],i+this._getLineLeftOffset(o),s+r+this.getHeightOfLineImpl(o),o),r+=this.getHeightOfLine(o);t.restore()}_renderTextFill(t){(this.fill||this.styleHas(Nn))&&this._renderTextCommon(t,"fillText")}_renderTextStroke(t){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())}_renderChars(t,e,r,i,s,o){const l=this.textAlign.includes(Bs),u=this.path,h=!l&&this.charSpacing===0&&this.isEmptyStyles(o)&&!u,d=this.direction===_c,m=this.direction===_c?1:-1,g=e.direction;let v,T,S,w,E,R="",P=0;if(e.save(),g!==this.direction&&(e.canvas.setAttribute("dir",d?_c:Co),e.direction=d?_c:Co,e.textAlign=d?ue:rn),s-=this.getHeightOfLineImpl(o)*this._fontSizeFraction,h)return this._renderChar(t,e,o,0,r.join(""),i,s),void e.restore();for(let j=0,N=r.length-1;j<=N;j++)w=j===N||this.charSpacing||u,R+=r[j],S=this.__charBounds[o][j],P===0?(i+=m*(S.kernedWidth-S.width),P+=S.width):P+=S.kernedWidth,l&&!w&&this._reSpaceAndTab.test(r[j])&&(w=!0),w||(v=v||this.getCompleteStyleDeclaration(o,j),T=this.getCompleteStyleDeclaration(o,j+1),w=pA(v,T,!1)),w&&(u?(e.save(),e.translate(S.renderLeft,S.renderTop),e.rotate(S.angle),this._renderChar(t,e,o,j,R,-P/2,0),e.restore()):(E=i,this._renderChar(t,e,o,j,R,E,s)),R="",v=T,i+=m*P,P=0);e.restore()}_applyPatternGradientTransformText(t){const e=this.width+this.strokeWidth,r=this.height+this.strokeWidth,i=Ri({width:e,height:r}),s=i.getContext("2d");return i.width=e,i.height=r,s.beginPath(),s.moveTo(0,0),s.lineTo(e,0),s.lineTo(e,r),s.lineTo(0,r),s.closePath(),s.translate(e/2,r/2),s.fillStyle=t.toLive(s),this._applyPatternGradientTransform(s,t),s.fill(),s.createPattern(i,"no-repeat")}handleFiller(t,e,r){let i,s;return Si(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(i=-this.width/2,s=-this.height/2,t.translate(i,s),t[e]=this._applyPatternGradientTransformText(r),{offsetX:i,offsetY:s}):(t[e]=r.toLive(t),this._applyPatternGradientTransform(t,r)):(t[e]=r,{offsetX:0,offsetY:0})}_setStrokeStyles(t,e){let{stroke:r,strokeWidth:i}=e;return t.lineWidth=i,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",r)}_setFillStyles(t,e){let{fill:r}=e;return this.handleFiller(t,"fillStyle",r)}_renderChar(t,e,r,i,s,o,l){const u=this._getStyleDeclaration(r,i),h=this.getCompleteStyleDeclaration(r,i),d=t==="fillText"&&h.fill,m=t==="strokeText"&&h.stroke&&h.strokeWidth;if(m||d){if(e.save(),e.font=this._getFontDeclaration(h),u.textBackgroundColor&&this._removeShadow(e),u.deltaY&&(l+=u.deltaY),d){const g=this._setFillStyles(e,h);e.fillText(s,o-g.offsetX,l-g.offsetY)}if(m){const g=this._setStrokeStyles(e,h);e.strokeText(s,o-g.offsetX,l-g.offsetY)}e.restore()}}setSuperscript(t,e){this._setScript(t,e,this.superscript)}setSubscript(t,e){this._setScript(t,e,this.subscript)}_setScript(t,e,r){const i=this.get2DCursorLocation(t,!0),s=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),o=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),l={fontSize:s*r.size,deltaY:o+s*r.baseline};this.setSelectionStyles(l,t,e)}_getLineLeftOffset(t){const e=this.getLineWidth(t),r=this.width-e,i=this.textAlign,s=this.direction,o=this.isEndOfWrapping(t);let l=0;return i===Bs||i===vp&&!o||i===yp&&!o||i===nb&&!o?0:(i===Wt&&(l=r/2),i===rn&&(l=r),i===vp&&(l=r/2),i===yp&&(l=r),s===Co&&(i===rn||i===yp?l=0:i===ue||i===nb?l=-r:i!==Wt&&i!==vp||(l=-r/2)),l)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(t){if(this.__lineWidths[t]!==void 0)return this.__lineWidths[t];const{width:e}=this.measureLine(t);return this.__lineWidths[t]=e,e}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(t,e,r){var i;return(i=this._getStyleDeclaration(t,e)[r])!==null&&i!==void 0?i:this[r]}_renderTextDecoration(t,e){if(!this[e]&&!this.styleHas(e))return;let r=this._getTopOffset();const i=this._getLeftOffset(),s=this.path,o=this._getWidthOfCharSpacing(),l=e==="linethrough"?.5:e==="overline"?1:0,u=this.offsets[e];for(let h=0,d=this._textLines.length;h<d;h++){const m=this.getHeightOfLine(h);if(!this[e]&&!this.styleHas(e,h)){r+=m;continue}const g=this._textLines[h],v=m/this.lineHeight,T=this._getLineLeftOffset(h);let S=0,w=0,E=this.getValueOfPropertyAt(h,0,e),R=this.getValueOfPropertyAt(h,0,Nn),P=this.getValueOfPropertyAt(h,0,ru),j=E,N=R,W=P;const M=r+v*(1-this._fontSizeFraction);let k=this.getHeightOfChar(h,0),O=this.getValueOfPropertyAt(h,0,"deltaY");for(let H=0,V=g.length;H<V;H++){const yt=this.__charBounds[h][H];j=this.getValueOfPropertyAt(h,H,e),N=this.getValueOfPropertyAt(h,H,Nn),W=this.getValueOfPropertyAt(h,H,ru);const xt=this.getHeightOfChar(h,H),J=this.getValueOfPropertyAt(h,H,"deltaY");if(s&&j&&N){const st=this.fontSize*W/1e3;t.save(),t.fillStyle=R,t.translate(yt.renderLeft,yt.renderTop),t.rotate(yt.angle),t.fillRect(-yt.kernedWidth/2,u*xt+J-l*st,yt.kernedWidth,st),t.restore()}else if((j!==E||N!==R||xt!==k||W!==P||J!==O)&&w>0){const st=this.fontSize*P/1e3;let ht=i+T+S;this.direction===Co&&(ht=this.width-ht-w),E&&R&&P&&(t.fillStyle=R,t.fillRect(ht,M+u*k+O-l*st,w,st)),S=yt.left,w=yt.width,E=j,P=W,R=N,k=xt,O=J}else w+=yt.kernedWidth}let B=i+T+S;this.direction===Co&&(B=this.width-B-w),t.fillStyle=N;const F=this.fontSize*W/1e3;j&&N&&W&&t.fillRect(B,M+u*k+O-l*F,w-o,F),r+=m}this._removeShadow(t)}_getFontDeclaration(){let{fontFamily:t=this.fontFamily,fontStyle:e=this.fontStyle,fontWeight:r=this.fontWeight,fontSize:i=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;const o=t.includes("'")||t.includes('"')||t.includes(",")||ur.genericFonts.includes(t.toLowerCase())?t:`"${t}"`;return[e,r,`${s?this.CACHE_FONT_SIZE:i}px`,o].join(" ")}render(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(t)))}graphemeSplit(t){return aA(t)}_splitTextIntoLines(t){const e=t.split(this._reNewline),r=new Array(e.length),i=[`
`];let s=[];for(let o=0;o<e.length;o++)r[o]=this.graphemeSplit(e[o]),s=s.concat(r[o],i);return s.pop(),{_unwrappedLines:r,lines:e,graphemeText:s,graphemeLines:r}}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject([...X5,...t]),styles:cut(this.styles,this.text),...this.path?{path:this.path.toObject()}:{}}}set(t,e){const{textLayoutProperties:r}=this.constructor;super.set(t,e);let i=!1,s=!1;if(typeof t=="object")for(const o in t)o==="path"&&this.setPathInfo(),i=i||r.includes(o),s=s||o==="path";else i=r.includes(t),s=t==="path";return s&&this.setPathInfo(),i&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(t,e,r){const i=Zo(t,ur.ATTRIBUTE_NAMES,r),{textAnchor:s=ue,textDecoration:o="",dx:l=0,dy:u=0,top:h=0,left:d=0,fontSize:m=tA,strokeWidth:g=1,...v}={...e,...i},T=new this(eb(t.textContent||"").trim(),{left:d+l,top:h+u,underline:o.includes("underline"),overline:o.includes("overline"),linethrough:o.includes("line-through"),strokeWidth:0,fontSize:m,...v}),S=T.getScaledHeight()/T.height,w=((T.height+T.strokeWidth)*T.lineHeight-T.height)*S,E=T.getScaledHeight()+w;let R=0;return s===Wt&&(R=T.getScaledWidth()/2),s===rn&&(R=T.getScaledWidth()),T.set({left:T.left-R,top:T.top-(E-T.fontSize*(.07+T._fontSizeFraction))/T.lineHeight,strokeWidth:g}),T}static fromObject(t){return this._fromObject({...t,styles:uut(t.styles||{},t.text)},{extraParam:"text"})}}q(ur,"textLayoutProperties",K5),q(ur,"cacheProperties",[...Jo,...X5]),q(ur,"ownDefaults",Oct),q(ur,"type","Text"),q(ur,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),q(ur,"ATTRIBUTE_NAMES",Ll.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),rU(ur,[class extends G5{_toSVG(){const n=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(t)}toSVG(n){const t=this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0}),e=this.path;return e?t+e._createBaseSVGMarkup(e._toSVG(),{reviver:n,withShadow:!0,additionalTransform:Kp(this.calcOwnMatrix())}):t}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(n){let{textBgRects:t,textSpans:e}=n;const r=this.getSvgTextDecoration(this);return[t.join(""),'		<text xml:space="preserve" ',`font-family="${ne(this.fontFamily.replace(sht,"'"))}" `,`font-size="${ne(this.fontSize)}" `,this.fontStyle?`font-style="${ne(this.fontStyle)}" `:"",this.fontWeight?`font-weight="${ne(this.fontWeight)}" `:"",r?`text-decoration="${r}" `:"",this.direction==="rtl"?'direction="rtl" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.join(""),`</text>
`]}_getSVGTextAndBg(n,t){const e=[],r=[];let i,s=n;this.backgroundColor&&r.push(Ow(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,l=this._textLines.length;o<l;o++)i=this._getLineLeftOffset(o),this.direction==="rtl"&&(i+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(r,o,t+i,s),this._setSVGTextLineText(e,o,t+i,s),s+=this.getHeightOfLine(o);return{textSpans:e,textBgRects:r}}_createTextCharSpan(n,t,e,r,i){const s=me.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(t,n!==n.trim()||!!n.match(iht)),l=o?`style="${o}"`:"",u=t.deltaY,h=u?` dy="${Ae(u,s)}" `:"",{angle:d,renderLeft:m,renderTop:g,width:v}=i;let T="";if(m!==void 0){const S=v/2;d&&(T=` rotate="${Ae(wl(d),s)}"`);const w=uf({angle:wl(d)});w[4]=m,w[5]=g;const E=new tt(-S,0).transform(w);e=E.x,r=E.y}return`<tspan x="${Ae(e,s)}" y="${Ae(r,s)}" ${h}${T}${l}>${ne(n)}</tspan>`}_setSVGTextLineText(n,t,e,r){const i=this.getHeightOfLine(t),s=this.textAlign.includes(Bs),o=this._textLines[t];let l,u,h,d,m,g="",v=0;r+=i*(1-this._fontSizeFraction)/this.lineHeight;for(let T=0,S=o.length-1;T<=S;T++)m=T===S||this.charSpacing||this.path,g+=o[T],h=this.__charBounds[t][T],v===0?(e+=h.kernedWidth-h.width,v+=h.width):v+=h.kernedWidth,s&&!m&&this._reSpaceAndTab.test(o[T])&&(m=!0),m||(l=l||this.getCompleteStyleDeclaration(t,T),u=this.getCompleteStyleDeclaration(t,T+1),m=pA(l,u,!0)),m&&(d=this._getStyleDeclaration(t,T),n.push(this._createTextCharSpan(g,d,e,r,h)),g="",l=u,this.direction==="rtl"?e-=v:e+=v,v=0)}_setSVGTextLineBg(n,t,e,r){const i=this._textLines[t],s=this.getHeightOfLine(t)/this.lineHeight;let o,l=0,u=0,h=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let d=0;d<i.length;d++){const{left:m,width:g,kernedWidth:v}=this.__charBounds[t][d];o=this.getValueOfPropertyAt(t,d,"textBackgroundColor"),o!==h?(h&&n.push(Ow(h,e+u,r,l,s)),u=m,l=g,h=o):l+=v}o&&n.push(Ow(h,e+u,r,l,s))}getSvgStyles(n){return`${super.getSvgStyles(n)} text-decoration-thickness: ${Ae(this.textDecorationThickness*this.getObjectScaling().y/10,me.NUM_FRACTION_DIGITS)}%; white-space: pre;`}getSvgSpanStyles(n,t){const{fontFamily:e,strokeWidth:r,stroke:i,fill:s,fontSize:o,fontStyle:l,fontWeight:u,textDecorationThickness:h,linethrough:d,overline:m,underline:g}=n,v=this.getSvgTextDecoration({underline:g??this.underline,overline:m??this.overline,linethrough:d??this.linethrough}),T=h||this.textDecorationThickness;return[i?Xp(ti,i):"",r?`stroke-width: ${ne(r)}; `:"",e?`font-family: ${e.includes("'")||e.includes('"')?ne(e):`'${ne(e)}'`}; `:"",o?`font-size: ${ne(o)}px; `:"",l?`font-style: ${ne(l)}; `:"",u?`font-weight: ${ne(u)}; `:"",v?`text-decoration: ${v}; text-decoration-thickness: ${Ae(T*this.getObjectScaling().y/10,me.NUM_FRACTION_DIGITS)}%; `:"",s?Xp(Nn,s):"",t?"white-space: pre; ":""].join("")}getSvgTextDecoration(n){return["overline","underline","line-through"].filter(t=>n[t.replace("-","")]).join(" ")}}]),_t.setClass(ur),_t.setSVGClass(ur);class oht{constructor(t){q(this,"target",void 0),q(this,"__mouseDownInPlace",!1),q(this,"__dragStartFired",!1),q(this,"__isDraggingOver",!1),q(this,"__dragStartSelection",void 0),q(this,"__dragImageDisposer",void 0),q(this,"_dispose",void 0),this.target=t;const e=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{e.forEach(r=>r()),this._dispose=void 0}}isPointerOverSelection(t){const e=this.target,r=e.getSelectionStartFromPointer(t);return e.isEditing&&r>=e.selectionStart&&r<=e.selectionEnd&&e.selectionStart<e.selectionEnd}start(t){return this.__mouseDownInPlace=this.isPointerOverSelection(t)}isActive(){return this.__mouseDownInPlace}end(t){const e=this.isActive();return e&&!this.__dragStartFired&&(this.target.setCursorByClick(t),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,e}getDragStartSelection(){return this.__dragStartSelection}setDragImage(t,e){var r;let{selectionStart:i,selectionEnd:s}=e;const o=this.target,l=o.canvas,u=new tt(o.flipX?-1:1,o.flipY?-1:1),h=o._getCursorBoundaries(i),d=new tt(h.left+h.leftOffset,h.top+h.topOffset).multiply(u).transform(o.calcTransformMatrix()),m=l.getScenePoint(t).subtract(d),g=o.getCanvasRetinaScaling(),v=o.getBoundingRect(),T=d.subtract(new tt(v.left,v.top)),S=l.viewportTransform,w=T.add(m).transform(S,!0),E=o.backgroundColor,R=dA(o.styles);o.backgroundColor="";const P={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(P,0,i),o.setSelectionStyles(P,s,o.text.length),o.dirty=!0;const j=o.toCanvasElement({enableRetinaScaling:l.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=E,o.styles=R,o.dirty=!0,TE(j,{position:"fixed",left:-j.width+"px",border:Lr,width:j.width/g+"px",height:j.height/g+"px"}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{j.remove()},Ki(t.target||this.target.hiddenTextarea).body.appendChild(j),(r=t.dataTransfer)===null||r===void 0||r.setDragImage(j,w.x,w.y)}onDragStart(t){this.__dragStartFired=!0;const e=this.target,r=this.isActive();if(r&&t.dataTransfer){const i=this.__dragStartSelection={selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},s=e._text.slice(i.selectionStart,i.selectionEnd).join(""),o={text:e.text,value:s,...i};t.dataTransfer.setData("text/plain",s),t.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:e.getSelectionStyles(i.selectionStart,i.selectionEnd,!0)})),t.dataTransfer.effectAllowed="copyMove",this.setDragImage(t,o)}return e.abortCursorAnimation(),r}canDrop(t){if(this.target.editable&&!this.target.getActiveControl()&&!t.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const e=this.target.getSelectionStartFromPointer(t),r=this.__dragStartSelection;return e<r.selectionStart||e>r.selectionEnd}return!0}return!1}targetCanDrop(t){return this.target.canDrop(t)}dragEnterHandler(t){let{e}=t;const r=this.targetCanDrop(e);!this.__isDraggingOver&&r&&(this.__isDraggingOver=!0)}dragOverHandler(t){const{e}=t,r=this.targetCanDrop(e);!this.__isDraggingOver&&r?this.__isDraggingOver=!0:this.__isDraggingOver&&!r&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(e.preventDefault(),t.canDrop=!0,t.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(t){var e;const{e:r}=t,i=r.defaultPrevented;this.__isDraggingOver=!1,r.preventDefault();let s=(e=r.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain");if(s&&!i){const o=this.target,l=o.canvas;let u=o.getSelectionStartFromPointer(r);const{styles:h}=r.dataTransfer.types.includes("application/fabric")?JSON.parse(r.dataTransfer.getData("application/fabric")):{},d=s[Math.max(0,s.length-1)],m=0;if(this.__dragStartSelection){const g=this.__dragStartSelection.selectionStart,v=this.__dragStartSelection.selectionEnd;u>g&&u<=v?u=g:u>v&&(u-=v-g),o.removeChars(g,v),delete this.__dragStartSelection}o._reNewline.test(d)&&(o._reNewline.test(o._text[u])||u===o._text.length)&&(s=s.trimEnd()),t.didDrop=!0,t.dropTarget=o,o.insertChars(s,h,u),l.setActiveObject(o),o.enterEditing(r),o.selectionStart=Math.min(u+m,o._text.length),o.selectionEnd=Math.min(o.selectionStart+s.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(Yv,{index:u+m,action:"drop"}),l.fire("text:changed",{target:o}),l.contextTopDirty=!0,l.requestRenderAll()}}dragEndHandler(t){let{e}=t;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var r;const i=this.target,s=this.target.canvas,{selectionStart:o,selectionEnd:l}=this.__dragStartSelection,u=((r=e.dataTransfer)===null||r===void 0?void 0:r.dropEffect)||Lr;u===Lr?(i.selectionStart=o,i.selectionEnd=l,i._updateTextarea(),i.hiddenTextarea.focus()):(i.clearContextTop(),u==="move"&&(i.removeChars(o,l),i.selectionStart=i.selectionEnd=o,i.hiddenTextarea&&(i.hiddenTextarea.value=i.text),i._updateTextarea(),i.fire(Yv,{index:o,action:"dragend"}),s.fire("text:changed",{target:i}),s.requestRenderAll()),i.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const oN=/[ \n\.,;!\?\-]/;class aht extends ur{constructor(){super(...arguments),q(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(t){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(t)}_animateCursor(t){let{toValue:e,duration:r,delay:i,onComplete:s}=t;return Q5({startValue:this._currentCursorOpacity,endValue:e,duration:r,delay:i,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(t){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(t||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var t;(t=this._currentTickCompleteState)===null||t===void 0||t.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(t){this.abortCursorAnimation(),this._tick(t?0:this.cursorDelay)}abortCursorAnimation(){let t=!1;[this._currentTickState,this._currentTickCompleteState].forEach(e=>{e&&!e.isDone()&&(t=!0,e.abort())}),this._currentCursorOpacity=1,t&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(t=>!t||t.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(t){let e=0,r=t-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)e++,r--;for(;/\S/.test(this._text[r])&&r>-1;)e++,r--;return t-e}findWordBoundaryRight(t){let e=0,r=t;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)e++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)e++,r++;return t+e}findLineBoundaryLeft(t){let e=0,r=t-1;for(;!/\n/.test(this._text[r])&&r>-1;)e++,r--;return t-e}findLineBoundaryRight(t){let e=0,r=t;for(;!/\n/.test(this._text[r])&&r<this._text.length;)e++,r++;return t+e}searchWordBoundary(t,e){const r=this._text;let i=t>0&&this._reSpace.test(r[t])&&(e===-1||!eA.test(r[t-1]))?t-1:t,s=r[i];for(;i>0&&i<r.length&&!oN.test(s);)i+=e,s=r[i];return e===-1&&oN.test(s)&&i++,i}selectWord(t){t=t??this.selectionStart;const e=this.searchWordBoundary(t,-1),r=Math.max(e,this.searchWordBoundary(t,1));this.selectionStart=e,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(t){t=t??this.selectionStart;const e=this.findLineBoundaryLeft(t),r=this.findLineBoundaryRight(t);this.selectionStart=e,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(t){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",t?{e:t}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e:t}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(t){if(this.getActiveControl())return;const e=this.hiddenTextarea;Ki(e).activeElement!==e&&e.focus();const r=this.getSelectionStartFromPointer(t),i=this.selectionStart,s=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&i!==s||i!==r&&s!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(t,e,r){const i=r.slice(0,t),s=this.graphemeSplit(i).length;if(t===e)return{selectionStart:s,selectionEnd:s};const o=r.slice(t,e);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(t,e,r){const i=r.slice(0,t).join("").length;return t===e?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+r.slice(t,e).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){const{hiddenTextarea:t,direction:e,textAlign:r,inCompositionMode:i}=this;if(!t)return;const s=r!==Bs?r.replace("justify-",""):e===_c?ue:rn,o=this.getPositionByOrigin(s,"top");this.cursorOffsetCache={},this.text=t.value,this.set("dirty",!0),this.initDimensions(),this.setPositionByOrigin(o,s,"top"),this.setCoords();const l=this.fromStringToGraphemeSelection(t.selectionStart,t.selectionEnd,t.value);this.selectionEnd=this.selectionStart=l.selectionEnd,i||(this.selectionStart=l.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),r=this.get2DCursorLocation(t),i=r.lineIndex,s=r.charIndex,o=this.getValueOfPropertyAt(i,s,"fontSize")*this.lineHeight,l=e.leftOffset,u=this.getCanvasRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/u,m=h.height/u,g=d-o,v=m-o,T=new tt(e.left+l,e.top+e.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new tt(h.clientWidth/d,h.clientHeight/m));return T.x<0&&(T.x=0),T.x>g&&(T.x=g),T.y<0&&(T.y=0),T.y>v&&(T.y=v),T.x+=this.canvas._offset.left,T.y+=this.canvas._offset.top,{left:`${T.x}px`,top:`${T.y}px`,fontSize:`${o}px`,charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}exitEditingImpl(){const t=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,t&&(t.blur&&t.blur(),t.parentNode&&t.parentNode.removeChild(t)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const t=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),t&&this.fire(Kv),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const t in this.styles)this._textLines[t]||delete this.styles[t]}removeStyleFromTo(t,e){const{lineIndex:r,charIndex:i}=this.get2DCursorLocation(t,!0),{lineIndex:s,charIndex:o}=this.get2DCursorLocation(e,!0);if(r!==s){if(this.styles[r])for(let l=i;l<this._unwrappedTextLines[r].length;l++)delete this.styles[r][l];if(this.styles[s])for(let l=o;l<this._unwrappedTextLines[s].length;l++){const u=this.styles[s][l];u&&(this.styles[r]||(this.styles[r]={}),this.styles[r][i+l-o]=u)}for(let l=r+1;l<=s;l++)delete this.styles[l];this.shiftLineStyles(s,r-s)}else if(this.styles[r]){const l=this.styles[r],u=o-i;for(let h=i;h<o;h++)delete l[h];for(const h in this.styles[r]){const d=parseInt(h,10);d>=o&&(l[d-u]=l[h],delete l[h])}}}shiftLineStyles(t,e){const r=Object.assign({},this.styles);for(const i in this.styles){const s=parseInt(i,10);s>t&&(this.styles[s+e]=r[s],r[s-e]||delete this.styles[s])}}insertNewlineStyleObject(t,e,r,i){const s={},o=this._unwrappedTextLines[t].length,l=o===e;let u=!1;r||(r=1),this.shiftLineStyles(t,r);const h=this.styles[t]?this.styles[t][e===0?e:e-1]:void 0;for(const m in this.styles[t]){const g=parseInt(m,10);g>=e&&(u=!0,s[g-e]=this.styles[t][m],l&&e===0||delete this.styles[t][m])}let d=!1;for(u&&!l&&(this.styles[t+r]=s,d=!0),(d||o>e)&&r--;r>0;)i&&i[r-1]?this.styles[t+r]={0:{...i[r-1]}}:h?this.styles[t+r]={0:{...h}}:delete this.styles[t+r],r--;this._forceClearCache=!0}insertCharStyleObject(t,e,r,i){this.styles||(this.styles={});const s=this.styles[t],o=s?{...s}:{};r||(r=1);for(const u in o){const h=parseInt(u,10);h>=e&&(s[h+r]=o[h],o[h-r]||delete s[h])}if(this._forceClearCache=!0,i){for(;r--;)Object.keys(i[r]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+r]={...i[r]});return}if(!s)return;const l=s[e?e-1:1];for(;l&&r--;)this.styles[t][e+r]={...l}}insertNewStyleBlock(t,e,r){const i=this.get2DCursorLocation(e,!0),s=[0];let o,l=0;for(let u=0;u<t.length;u++)t[u]===`
`?(l++,s[l]=0):s[l]++;for(s[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,s[0],r),r=r&&r.slice(s[0]+1)),l&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+s[0],l),o=1;o<l;o++)s[o]>0?this.insertCharStyleObject(i.lineIndex+o,0,s[o],r):r&&this.styles[i.lineIndex+o]&&r[0]&&(this.styles[i.lineIndex+o][0]=r[0]),r=r&&r.slice(s[o]+1);s[o]>0&&this.insertCharStyleObject(i.lineIndex+o,0,s[o],r)}removeChars(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t+1;this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(t,e,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;i>r&&this.removeStyleFromTo(r,i);const s=this.graphemeSplit(t);this.insertNewStyleBlock(s,r,e),this._text=[...this._text.slice(0,r),...s,...this._text.slice(i)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(t,e,r){r<=t?(e===t?this._selectionDirection=ue:this._selectionDirection===rn&&(this._selectionDirection=ue,this.selectionEnd=t),this.selectionStart=r):r>t&&r<e?this._selectionDirection===rn?this.selectionEnd=r:this.selectionStart=r:(e===t?this._selectionDirection=rn:this._selectionDirection===ue&&(this._selectionDirection=rn,this.selectionStart=e),this.selectionEnd=r)}}class lht extends aht{initHiddenTextarea(){const t=this.canvas&&Ki(this.canvas.getElement())||af(),e=t.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map(o=>{let[l,u]=o;return e.setAttribute(l,u)});const{top:r,left:i,fontSize:s}=this._calcTextareaPosition();e.style.cssText=`position: absolute; top: ${r}; left: ${i}; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ${s};`,(this.hiddenTextareaContainer||t.body).appendChild(e),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[l,u]=o;return e.addEventListener(l,this[u].bind(this))}),this.hiddenTextarea=e}blur(){this.abortCursorAnimation()}onKeyDown(t){if(!this.isEditing)return;const e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(t){const e=this.fromPaste,{value:r,selectionStart:i,selectionEnd:s}=this.hiddenTextarea;if(this.fromPaste=!1,t&&t.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(Yv),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const l=this._splitTextIntoLines(r).graphemeText,u=this._text.length,h=l.length,d=this.selectionStart,m=this.selectionEnd,g=d!==m;let v,T,S,w,E=h-u;const R=this.fromStringToGraphemeSelection(i,s,r),P=d>R.selectionStart;g?(T=this._text.slice(d,m),E+=m-d):h<u&&(T=P?this._text.slice(m+E,m):this._text.slice(d,d-E));const j=l.slice(R.selectionEnd-E,R.selectionEnd);if(T&&T.length&&(j.length&&(v=this.getSelectionStyles(d,d+1,!1),v=j.map(()=>v[0])),g?(S=d,w=m):P?(S=m-T.length,w=m):(S=m,w=m+T.length),this.removeStyleFromTo(S,w)),j.length){const{copyPasteData:N}=Js();e&&j.join("")===N.copiedText&&!me.disableStyleCopyPaste&&(v=N.copiedTextStyle),this.insertNewStyleBlock(j,d,v)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(t){let{target:e}=t;const{selectionStart:r,selectionEnd:i}=e;this.compositionStart=r,this.compositionEnd=i,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:t}=Js();t.copiedText=this.getSelectedText(),me.disableStyleCopyPaste?t.copiedTextStyle=void 0:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(t,e){let r,i=this._getLineLeftOffset(t);return e>0&&(r=this.__charBounds[t][e-1],i+=r.left+r.width),i}getDownCursorOffset(t,e){const r=this._getSelectionForOffset(t,e),i=this.get2DCursorLocation(r),s=i.lineIndex;if(s===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-r;const o=i.charIndex,l=this._getWidthBeforeCursor(s,o),u=this._getIndexOnLine(s+1,l);return this._textLines[s].slice(o).length+u+1+this.missingNewlineOffset(s)}_getSelectionForOffset(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart}getUpCursorOffset(t,e){const r=this._getSelectionForOffset(t,e),i=this.get2DCursorLocation(r),s=i.lineIndex;if(s===0||t.metaKey||t.keyCode===33)return-r;const o=i.charIndex,l=this._getWidthBeforeCursor(s,o),u=this._getIndexOnLine(s-1,l),h=this._textLines[s].slice(0,o),d=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+u-h.length+(1-d)}_getIndexOnLine(t,e){const r=this._textLines[t];let i,s,o=this._getLineLeftOffset(t),l=0;for(let u=0,h=r.length;u<h;u++)if(i=this.__charBounds[t][u].width,o+=i,o>e){s=!0;const d=o-i,m=o,g=Math.abs(d-e);l=Math.abs(m-e)<g?u:u-1;break}return s||(l=r.length-1),l}moveCursorDown(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)}moveCursorUp(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)}_moveCursorUpOrDown(t,e){const r=this[`get${t}CursorOffset`](e,this._selectionDirection===rn);if(e.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),r!==0){const i=this.text.length;this.selectionStart=qh(0,this.selectionStart,i),this.selectionEnd=qh(0,this.selectionEnd,i),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(t){const e=this._selectionDirection===ue?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0}moveCursorWithoutShift(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0}moveCursorLeft(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)}_move(t,e,r){let i;if(t.altKey)i=this[`findWordBoundary${r}`](this[e]);else{if(!t.metaKey&&t.keyCode!==35&&t.keyCode!==36)return this[e]+=r==="Left"?-1:1,!0;i=this[`findLineBoundary${r}`](this[e])}return i!==void 0&&this[e]!==i&&(this[e]=i,!0)}_moveLeft(t,e){return this._move(t,e,"Left")}_moveRight(t,e){return this._move(t,e,"Right")}moveCursorLeftWithoutShift(t){let e=!0;return this._selectionDirection=ue,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e}moveCursorLeftWithShift(t){return this._selectionDirection===rn&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=ue,this._moveLeft(t,"selectionStart")):void 0}moveCursorRight(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)}_moveCursorLeftOrRight(t,e){const r=`moveCursor${t}${e.shiftKey?"WithShift":"WithoutShift"}`;this._currentCursorOpacity=1,this[r](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(t){return this._selectionDirection===ue&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=rn,this._moveRight(t,"selectionEnd")):void 0}moveCursorRightWithoutShift(t){let e=!0;return this._selectionDirection=rn,this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e}}const aN=n=>!!n.button;class cht extends lht{constructor(){super(...arguments),q(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new oht(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(t){return this.draggableTextDelegate.onDragStart(t)}canDrop(t){return this.draggableTextDelegate.canDrop(t)}doubleClickHandler(t){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}tripleClickHandler(t){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}_mouseDownHandler(t){let{e,alreadySelected:r}=t;this.canvas&&this.editable&&!aN(e)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(e)||(this.canvas.textEditingManager.register(this),r&&(this.inCompositionMode=!1,this.setCursorByClick(e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=r||this.isEditing)))}mouseUpHandler(t){let{e,transform:r}=t;const i=this.draggableTextDelegate.end(e);if(this.canvas){this.canvas.textEditingManager.unregister(this);const s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||r&&r.actionPerformed||aN(e)||i||this.selected&&!this.getActiveControl()&&(this.enterEditing(e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(t){const e=this.getSelectionStartFromPointer(t),r=this.selectionStart,i=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(r,i,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(t){const e=this.canvas.getScenePoint(t).transform(Zi(this.calcTransformMatrix())).add(new tt(-this._getLeftOffset(),-this._getTopOffset()));let r=0,i=0,s=0;for(let h=0;h<this._textLines.length&&r<=e.y;h++)r+=this.getHeightOfLine(h),s=h,h>0&&(i+=this._textLines[h-1].length+this.missingNewlineOffset(h-1));let o=Math.abs(this._getLineLeftOffset(s));const l=this._textLines[s].length,u=this.__charBounds[s];for(let h=0;h<l;h++){const d=o+u[h].kernedWidth;if(e.x<=d){Math.abs(e.x-d)<=Math.abs(e.x-o)&&i++;break}o=d,i++}return Math.min(this.flipX?l-i:i,this._text.length)}}const Oy="moveCursorUp",Iy="moveCursorDown",Py="moveCursorLeft",Ny="moveCursorRight",Ly="exitEditing",lN=(n,t)=>{const e=t.getRetinaScaling();n.setTransform(e,0,0,e,0,0);const r=t.viewportTransform;n.transform(r[0],r[1],r[2],r[3],r[4],r[5])},uht={selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Ly,27:Ly,33:Oy,34:Iy,35:Ny,36:Py,37:Py,38:Oy,39:Ny,40:Iy},keysMapRtl:{9:Ly,27:Ly,33:Oy,34:Iy,35:Py,36:Ny,37:Ny,38:Oy,39:Py,40:Iy},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"},_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1};class Po extends cht{static getDefaults(){return{...super.getDefaults(),...Po.ownDefaults}}get type(){const t=super.type;return t==="itext"?"i-text":t}constructor(t,e){super(t,{...Po.ownDefaults,...e}),this.initBehavior()}_set(t,e){return this.isEditing&&this._savedProps&&t in this._savedProps?(this._savedProps[t]=e,this):(t==="canvas"&&(this.canvas instanceof SE&&this.canvas.textEditingManager.remove(this),e instanceof SE&&e.textEditingManager.add(this)),super._set(t,e))}setSelectionStart(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)}setSelectionEnd(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)}_updateAndFire(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,r=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(t,e,r)}setSelectionStyles(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(t,e,r)}get2DCursorLocation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(t,e)}render(t){super.render(t),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(t){const e=this.isEditing;this.isEditing=!1;const r=super.toCanvasElement(t);return this.isEditing=e,r}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const t=this.clearContextTop(!0);if(!t)return;const e=this._getCursorBoundaries(),r=this.findAncestorsWithClipPath(),i=r.length>0;let s,o=t;if(i){s=Ri(t.canvas),o=s.getContext("2d"),lN(o,this.canvas);const l=this.calcTransformMatrix();o.transform(l[0],l[1],l[2],l[3],l[4],l[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,e):this.renderCursor(o,e),i)for(const l of r){const u=l.clipPath,h=Ri(t.canvas),d=h.getContext("2d");if(lN(d,this.canvas),!u.absolutePositioned){const m=l.calcTransformMatrix();d.transform(m[0],m[1],m[2],m[3],m[4],m[5])}u.transform(d),u.drawObject(d,!0,{}),this.drawClipPathOnCache(o,u,h)}i&&(t.setTransform(1,0,0,1,0,0),t.drawImage(s,0,0)),this.canvas.contextTopDirty=!0,t.restore()}findAncestorsWithClipPath(){const t=[];let e=this;for(;e;)e.clipPath&&t.push(e),e=e.parent;return t}_getCursorBoundaries(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;const r=this._getLeftOffset(),i=this._getTopOffset(),s=this._getCursorBoundariesOffsets(t,e);return{left:r,top:i,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(t,e){return e?this.__getCursorBoundariesOffsets(t):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(t)}__getCursorBoundariesOffsets(t){let e=0,r=0;const{charIndex:i,lineIndex:s}=this.get2DCursorLocation(t),{textAlign:o,direction:l}=this;for(let m=0;m<s;m++)e+=this.getHeightOfLine(m);const u=this._getLineLeftOffset(s),h=this.__charBounds[s][i];h&&(r=h.left),this.charSpacing!==0&&i===this._textLines[s].length&&(r-=this._getWidthOfCharSpacing());let d=u+(r>0?r:0);return l===Co&&(o===rn||o===Bs||o===yp?d*=-1:o===ue||o===nb?d=u-(r>0?r:0):o!==Wt&&o!==vp||(d=u-(r>0?r:0))),{top:e,left:d}}renderCursorAt(t){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(t,!0),t)}renderCursor(t,e){this._renderCursor(t,e,this.selectionStart)}getCursorRenderingData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(t);const r=this.get2DCursorLocation(t),i=r.lineIndex,s=r.charIndex>0?r.charIndex-1:0,o=this.getValueOfPropertyAt(i,s,"fontSize"),l=this.getObjectScaling().x*this.canvas.getZoom(),u=this.cursorWidth/l,h=this.getValueOfPropertyAt(i,s,"deltaY"),d=e.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(i,s,"fill"),opacity:this._currentCursorOpacity,left:e.left+e.leftOffset-u/2,top:d+e.top+h,width:u,height:o}}_renderCursor(t,e,r){const{color:i,opacity:s,left:o,top:l,width:u,height:h}=this.getCursorRenderingData(r,e);t.fillStyle=i,t.globalAlpha=s,t.fillRect(o,l,u,h)}renderSelection(t,e){const r={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(t,r,e)}renderDragSourceEffect(){const t=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,t,this._getCursorBoundaries(t.selectionStart,!0))}renderDropTargetEffect(t){const e=this.getSelectionStartFromPointer(t);this.renderCursorAt(e)}_renderSelection(t,e,r){const{textAlign:i,direction:s}=this,o=e.selectionStart,l=e.selectionEnd,u=i.includes(Bs),h=this.get2DCursorLocation(o),d=this.get2DCursorLocation(l),m=h.lineIndex,g=d.lineIndex,v=h.charIndex<0?0:h.charIndex,T=d.charIndex<0?0:d.charIndex;for(let S=m;S<=g;S++){const w=this._getLineLeftOffset(S)||0;let E=this.getHeightOfLine(S),R=0,P=0,j=0;if(S===m&&(P=this.__charBounds[m][v].left),S>=m&&S<g)j=u&&!this.isEndOfWrapping(S)?this.width:this.getLineWidth(S)||5;else if(S===g)if(T===0)j=this.__charBounds[g][T].left;else{const O=this._getWidthOfCharSpacing();j=this.__charBounds[g][T-1].left+this.__charBounds[g][T-1].width-O}R=E,(this.lineHeight<1||S===g&&this.lineHeight>1)&&(E/=this.lineHeight);let N=r.left+w+P,W=E,M=0;const k=j-P;this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",W=1,M=E):t.fillStyle=this.selectionColor,s===Co&&(i===rn||i===Bs||i===yp?N=this.width-N-k:i===ue||i===nb?N=r.left+w-j:i!==Wt&&i!==vp||(N=r.left+w-j)),t.fillRect(N,r.top+r.topOffset+M,k,W),r.topOffset+=R}}getCurrentCharFontSize(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")}getCurrentCharColor(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,Nn)}_getCurrentCharIndex(){const t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}q(Po,"ownDefaults",uht),q(Po,"type","IText"),_t.setClass(Po),_t.setClass(Po,"i-text");class Oc extends Po{static getDefaults(){return{...super.getDefaults(),...Oc.ownDefaults}}constructor(t,e){super(t,{...Oc.ownDefaults,...e})}static createControls(){return{controls:sut()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Bs)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(t){let e=0,r=0,i=0;const s={};for(let o=0;o<t.graphemeLines.length;o++)t.graphemeText[i]===`
`&&o>0?(r=0,i++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[i])&&o>0&&(r++,i++),s[o]={line:e,offset:r},i+=t.graphemeLines[o].length,r+=t.graphemeLines[o].length;return s}styleHas(t,e){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[e];r&&(e=r.line)}return super.styleHas(t,e)}isEmptyStyles(t){if(!this.styles)return!0;let e,r=0,i=t+1,s=!1;const o=this._styleMap[t],l=this._styleMap[t+1];o&&(t=o.line,r=o.offset),l&&(i=l.line,s=i===t,e=l.offset);const u=t===void 0?this.styles:{line:this.styles[t]};for(const h in u)for(const d in u[h]){const m=parseInt(d,10);if(m>=r&&(!s||m<e))for(const g in u[h][d])return!1}return!0}_getStyleDeclaration(t,e){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[t];if(!r)return{};t=r.line,e=r.offset+e}return super._getStyleDeclaration(t,e)}_setStyleDeclaration(t,e,r){const i=this._styleMap[t];super._setStyleDeclaration(i.line,i.offset+e,r)}_deleteStyleDeclaration(t,e){const r=this._styleMap[t];super._deleteStyleDeclaration(r.line,r.offset+e)}_getLineStyle(t){const e=this._styleMap[t];return!!this.styles[e.line]}_setLineStyle(t){const e=this._styleMap[t];super._setLineStyle(e.line)}_wrapText(t,e){this.isWrapping=!0;const r=this.getGraphemeDataForRender(t),i=[];for(let s=0;s<r.wordsData.length;s++)i.push(...this._wrapLine(s,e,r));return this.isWrapping=!1,i}getGraphemeDataForRender(t){const e=this.splitByGrapheme,r=e?"":" ";let i=0;return{wordsData:t.map((s,o)=>{let l=0;const u=e?this.graphemeSplit(s):this.wordSplit(s);return u.length===0?[{word:[],width:0}]:u.map(h=>{const d=e?[h]:this.graphemeSplit(h),m=this._measureWord(d,o,l);return i=Math.max(m,i),l+=d.length+r.length,{word:d,width:m}})}),largestWordWidth:i}}_measureWord(t,e){let r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let o=0,l=t.length;o<l;o++)s+=this._getGraphemeBox(t[o],e,o+i,r,!0).kernedWidth,r=t[o];return s}wordSplit(t){return t.split(this._wordJoiners)}_wrapLine(t,e,r){let{largestWordWidth:i,wordsData:s}=r,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const l=this._getWidthOfCharSpacing(),u=this.splitByGrapheme,h=[],d=u?"":" ";let m=0,g=[],v=0,T=0,S=!0;e-=o;const w=Math.max(e,i,this.dynamicMinWidth),E=s[t];let R;for(v=0,R=0;R<E.length;R++){const{word:P,width:j}=E[R];v+=P.length,m+=T+j-l,m>w&&!S?(h.push(g),g=[],m=j,S=!0):m+=l,S||u||g.push(d),g=g.concat(P),T=u?0:this._measureWord([d],t,v),v++,S=!1}return R&&h.push(g),i+o>this.dynamicMinWidth&&(this.dynamicMinWidth=i-l+o),h}isEndOfWrapping(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line}missingNewlineOffset(t,e){return this.splitByGrapheme&&!e?this.isEndOfWrapping(t)?1:0:1}_splitTextIntoLines(t){const e=super._splitTextIntoLines(t),r=this._wrapText(e.lines,this.width),i=new Array(r.length);for(let s=0;s<r.length;s++)i[s]=r[s].join("");return e.lines=i,e.graphemeLines=r,e}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const t=new Map;for(const e in this._styleMap){const r=parseInt(e,10);if(this._textLines[r]){const i=this._styleMap[e].line;t.set(`${i}`,!0)}}for(const e in this.styles)t.has(e)||delete this.styles[e]}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...t])}}q(Oc,"type","Textbox"),q(Oc,"textLayoutProperties",[...Po.textLayoutProperties,"width"]),q(Oc,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),_t.setClass(Oc);class cN extends a_{shouldPerformLayout(t){return!!t.target.clipPath&&super.shouldPerformLayout(t)}shouldLayoutClipPath(){return!1}calcLayoutResult(t,e){const{target:r}=t,{clipPath:i,group:s}=r;if(!i||!this.shouldPerformLayout(t))return;const{width:o,height:l}=Fo(oU(r,i)),u=new tt(o,l);if(i.absolutePositioned)return{center:$h(i.getRelativeCenterPoint(),void 0,s?s.calcTransformMatrix():void 0),size:u};{const h=i.getRelativeCenterPoint().transform(r.calcOwnMatrix(),!0);if(this.shouldPerformLayout(t)){const{center:d=new tt,correction:m=new tt}=this.calcBoundingBox(e,t)||{};return{center:d.add(h),correction:m.subtract(h),size:u}}return{center:r.getRelativeCenterPoint().add(h),size:u}}}}q(cN,"type","clip-path"),_t.setClass(cN);class uN extends a_{getInitialSize(t,e){let{target:r}=t,{size:i}=e;return new tt(r.width||i.x,r.height||i.y)}}q(uN,"type","fixed"),_t.setClass(uN);class hht extends Jp{subscribeTargets(t){const e=t.target;t.targets.reduce((r,i)=>(i.parent&&r.add(i.parent),r),new Set).forEach(r=>{r.layoutManager.subscribeTargets({target:r,targets:[e]})})}unsubscribeTargets(t){const e=t.target,r=e.getObjects();t.targets.reduce((i,s)=>(s.parent&&i.add(s.parent),i),new Set).forEach(i=>{!r.some(s=>s.parent===i)&&i.layoutManager.unsubscribeTargets({target:i,targets:[e]})})}}class Ic extends Uc{static getDefaults(){return{...super.getDefaults(),...Ic.ownDefaults}}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Ic.ownDefaults),this.setOptions(e);const{left:r,top:i,layoutManager:s}=e;this.groupInit(t,{left:r,top:i,layoutManager:s??new hht})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.multiSelectionStacking==="selection-order"?this.add(...e):e.forEach(i=>{const s=this._objects.findIndex(l=>l.isInFrontOf(i)),o=s===-1?this.size():s;this.insertAt(o,i)})}canEnterGroup(t){return this.getObjects().some(e=>e.isDescendantOf(t)||t.isDescendantOf(e))?(Tl("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(t)}enterGroup(t,e){t.parent&&t.parent===t.group?t.parent._exitGroup(t):t.group&&t.parent!==t.group&&t.group.remove(t),this._enterGroup(t,e)}exitGroup(t,e){this._exitGroup(t,e),t.parent&&t.parent._enterGroup(t,!0)}_onAfterObjectsChange(t,e){super._onAfterObjectsChange(t,e);const r=new Set;e.forEach(i=>{const{parent:s}=i;s&&r.add(s)}),t===gA?r.forEach(i=>{i._onAfterObjectsChange(rb,e)}):r.forEach(i=>{i._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return`#<ActiveSelection: (${this.complexity()})>`}shouldCache(){return!1}isOnACache(){return!1}_renderControls(t,e,r){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const i={hasControls:!1,...r,forActiveSelection:!0};for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(t,i);super._renderControls(t,e),t.restore()}}q(Ic,"type","ActiveSelection"),q(Ic,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),_t.setClass(Ic),_t.setClass(Ic,"activeSelection");class fht{constructor(){q(this,"resources",{})}applyFilters(t,e,r,i,s){const o=s.getContext("2d",{willReadFrequently:!0,desynchronized:!0});if(!o)return;o.drawImage(e,0,0,r,i);const l={sourceWidth:r,sourceHeight:i,imageData:o.getImageData(0,0,r,i),originalEl:e,originalImageData:o.getImageData(0,0,r,i),canvasEl:s,ctx:o,filterBackend:this};t.forEach(h=>{h.applyTo(l)});const{imageData:u}=l;return u.width===r&&u.height===i||(s.width=u.width,s.height=u.height),o.putImageData(u,0,0),l}}class wU{constructor(){let{tileSize:t=me.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};q(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),q(this,"resources",{}),this.tileSize=t,this.setupGLContext(t,t),this.captureGPUInfo()}setupGLContext(t,e){this.dispose(),this.createWebGLCanvas(t,e)}createWebGLCanvas(t,e){const r=Ri({width:t,height:e}),i=r.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});i&&(i.clearColor(0,0,0,0),this.canvas=r,this.gl=i)}applyFilters(t,e,r,i,s,o){const l=this.gl,u=s.getContext("2d");if(!l||!u)return;let h;o&&(h=this.getCachedTexture(o,e));const d={originalWidth:e.width||e.naturalWidth||0,originalHeight:e.height||e.naturalHeight||0,sourceWidth:r,sourceHeight:i,destinationWidth:r,destinationHeight:i,context:l,sourceTexture:this.createTexture(l,r,i,h?void 0:e),targetTexture:this.createTexture(l,r,i),originalTexture:h||this.createTexture(l,r,i,h?void 0:e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},m=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,m),t.forEach(g=>{g&&g.applyTo(d)}),(function(g){const v=g.targetCanvas,T=v.width,S=v.height,w=g.destinationWidth,E=g.destinationHeight;T===w&&S===E||(v.width=w,v.height=E)})(d),this.copyGLTo2D(l,d),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(d.sourceTexture),l.deleteTexture(d.targetTexture),l.deleteFramebuffer(m),u.setTransform(1,0,0,1,0,0),d}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(t,e,r,i,s){const{NEAREST:o,TEXTURE_2D:l,RGBA:u,UNSIGNED_BYTE:h,CLAMP_TO_EDGE:d,TEXTURE_MAG_FILTER:m,TEXTURE_MIN_FILTER:g,TEXTURE_WRAP_S:v,TEXTURE_WRAP_T:T}=t,S=t.createTexture();return t.bindTexture(l,S),t.texParameteri(l,m,s||o),t.texParameteri(l,g,s||o),t.texParameteri(l,v,d),t.texParameteri(l,T,d),i?t.texImage2D(l,0,u,u,h,i):t.texImage2D(l,0,u,e,r,0,u,h,null),S}getCachedTexture(t,e,r){const{textureCache:i}=this;if(i[t])return i[t];{const s=this.createTexture(this.gl,e.width,e.height,e,r);return s&&(i[t]=s),s}}evictCachesForKey(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])}copyGLTo2D(t,e){const r=t.canvas,i=e.targetCanvas,s=i.getContext("2d");if(!s)return;s.translate(0,i.height),s.scale(1,-1);const o=r.height-i.height;s.drawImage(r,0,o,i.width,i.height,0,0,i.width,i.height)}copyGLTo2DPutImageData(t,e){const r=e.targetCanvas.getContext("2d"),i=e.destinationWidth,s=e.destinationHeight,o=i*s*4;if(!r)return;const l=new Uint8Array(this.imageBuffer,0,o),u=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,i,s,t.RGBA,t.UNSIGNED_BYTE,l);const h=new ImageData(u,i,s);r.putImageData(h,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const t=this.gl,e={renderer:"",vendor:""};if(!t)return e;const r=t.getExtension("WEBGL_debug_renderer_info");if(r){const i=t.getParameter(r.UNMASKED_RENDERER_WEBGL),s=t.getParameter(r.UNMASKED_VENDOR_WEBGL);i&&(e.renderer=i.toLowerCase()),s&&(e.vendor=s.toLowerCase())}return this.gpuInfo=e,e}}let Pw;function dht(){const{WebGLProbe:n}=Js();return n.queryWebGL(Ko()),me.enableGLFiltering&&n.isSupported(me.textureSize)?new wU({tileSize:me.textureSize}):new fht}function Nw(){return!Pw&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Pw=dht()),Pw}const xU=["cropX","cropY"];class Ls extends nr{static getDefaults(){return{...super.getDefaults(),...Ls.ownDefaults}}constructor(t,e){super(),q(this,"_lastScaleX",1),q(this,"_lastScaleY",1),q(this,"_filterScalingX",1),q(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Ls.ownDefaults),this.setOptions(e),this.cacheKey=`texture${Sl()}`,this.setElement(typeof t=="string"?(this.canvas&&Ki(this.canvas.getElement())||af()).getElementById(t):t,e)}getElement(){return this._element}setElement(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._element=t,this._originalElement=t,this._setWidthHeight(e),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(t){const e=Nw(!1);e instanceof wU&&e.evictCachesForKey(t)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(t=>{const e=this[t];e&&Js().dispose(e),this[t]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const t=this.getElement();return t?{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}:{width:0,height:0}}_stroke(t){if(!this.stroke||this.strokeWidth===0)return;const e=this.width/2,r=this.height/2;t.beginPath(),t.moveTo(-e,-r),t.lineTo(e,-r),t.lineTo(e,r),t.lineTo(-e,r),t.lineTo(-e,-r),t.closePath()}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=[];return this.filters.forEach(r=>{r&&e.push(r.toObject())}),{...super.toObject([...xU,...t]),src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:e,...this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{}}}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const t=[],e=this._element,r=-this.width/2,i=-this.height/2;let s=[],o=[],l="",u="";if(!e)return[];if(this.hasCrop()){const h=Sl();s.push('<clipPath id="imageCrop_'+h+`">
`,'	<rect x="'+r+'" y="'+i+'" width="'+ne(this.width)+'" height="'+ne(this.height)+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+h+')" '}if(this.imageSmoothing||(u=' image-rendering="optimizeSpeed"'),t.push("	<image ","COMMON_PARTS",`xlink:href="${ne(this.getSrc(!0))}" x="${r-this.cropX}" y="${i-this.cropY}" width="${e.width||e.naturalWidth}" height="${e.height||e.naturalHeight}"${u}${l}></image>
`),this.stroke||this.strokeDashArray){const h=this.fill;this.fill=null,o=[`	<rect x="${r}" y="${i}" width="${ne(this.width)}" height="${ne(this.height)}" style="${this.getSvgStyles()}" />
`],this.fill=h}return s=this.paintFirst!==Nn?s.concat(o,t):s.concat(t,o),s}getSrc(t){const e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src")||"":e.src:this.src||""}getSvgSrc(t){return this.getSrc(t)}setSrc(t){let{crossOrigin:e,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return C0(t,{crossOrigin:e,signal:r}).then(i=>{e!==void 0&&this.set({crossOrigin:e}),this.setElement(i)})}toString(){return`#<Image: { src: "${this.getSrc()}" }>`}applyResizeFilters(){const t=this.resizeFilter,e=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),i=r.x,s=r.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||i>e&&s>e)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=s);const l=Ri(o),{width:u,height:h}=o;this._element=l,this._lastScaleX=t.scaleX=i,this._lastScaleY=t.scaleY=s,Nw().applyFilters([t],o,u,h,this._element),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height}applyFilters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(t=t.filter(s=>s&&!s.isNeutralState()),this.set("dirty",!0),this.removeTexture(`${this.cacheKey}_filtered`),t.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const e=this._originalElement,r=e.naturalWidth||e.width,i=e.naturalHeight||e.height;if(this._element===this._originalElement){const s=Ri({width:r,height:i});this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,i),this._lastScaleX=1,this._lastScaleY=1);Nw().applyFilters(t,this._originalElement,r,i,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(t){t.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)}drawCacheOnCanvas(t){t.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(t)}shouldCache(){return this.needsItsOwnCache()}_renderFill(t){const e=this._element;if(!e)return;const r=this._filterScalingX,i=this._filterScalingY,s=this.width,o=this.height,l=Math.max(this.cropX,0),u=Math.max(this.cropY,0),h=e.naturalWidth||e.width,d=e.naturalHeight||e.height,m=l*r,g=u*i,v=Math.min(s*r,h-m),T=Math.min(o*i,d-g),S=-s/2,w=-o/2,E=Math.min(s,h/r-l),R=Math.min(o,d/i-u);e&&t.drawImage(e,m,g,v,T,S,w,E,R)}_needsResize(){const t=this.getTotalObjectScaling();return t.x!==this._lastScaleX||t.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:t,height:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=this.getOriginalSize();this.width=t||r.width,this.height=e||r.height}parsePreserveAspectRatioAttribute(){const t=Mct(this.preserveAspectRatio||""),e=this.width,r=this.height,i={width:e,height:r};let s,o=this._element.width,l=this._element.height,u=1,h=1,d=0,m=0,g=0,v=0;return!t||t.alignX===Lr&&t.alignY===Lr?(u=e/o,h=r/l):(t.meetOrSlice==="meet"&&(u=h=Mut(this._element,i),s=(e-o*u)/2,t.alignX==="Min"&&(d=-s),t.alignX==="Max"&&(d=s),s=(r-l*h)/2,t.alignY==="Min"&&(m=-s),t.alignY==="Max"&&(m=s)),t.meetOrSlice==="slice"&&(u=h=Dut(this._element,i),s=o-e/u,t.alignX==="Mid"&&(g=s/2),t.alignX==="Max"&&(g=s),s=l-r/h,t.alignY==="Mid"&&(v=s/2),t.alignY==="Max"&&(v=s),o=e/u,l=r/h)),{width:o,height:l,scaleX:u,scaleY:h,offsetLeft:d,offsetTop:m,cropX:g,cropY:v}}static fromObject(t,e){let{filters:r,resizeFilter:i,src:s,crossOrigin:o,type:l,...u}=t;return Promise.all([C0(s,{...e,crossOrigin:o}),r&&Yp(r,e),i?Yp([i],e):[],r_(u,e)]).then(h=>{let[d,m=[],[g],v={}]=h;return new this(d,{...u,src:s,filters:m,resizeFilter:g,...v})})}static fromURL(t){let{crossOrigin:e=null,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return C0(t,{crossOrigin:e,signal:r}).then(s=>new this(s,i))}static async fromElement(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const i=Zo(t,this.ATTRIBUTE_NAMES,r);return this.fromURL(i["xlink:href"]||i.href,e,i).catch(s=>(Tl("log","Unable to parse Image",s),null))}}q(Ls,"type","Image"),q(Ls,"cacheProperties",[...Jo,...xU]),q(Ls,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),q(Ls,"ATTRIBUTE_NAMES",[...Ll,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),_t.setClass(Ls),_t.setSVGClass(Ls);s_(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const c_=n=>n.webgl!==void 0,yA="precision highp float",pht=`
    ${yA};
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`,mht=new RegExp(yA,"g");class En{get type(){return this.constructor.type}constructor(){let{type:t,...e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return pht}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:i="highp"}}=Js();i!=="highp"&&(e=e.replace(mht,yA.replace("highp",i)));const s=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER),l=t.createProgram();if(!s||!o||!l)throw new js("Vertex, fragment shader or program creation error");if(t.shaderSource(s,r),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))throw new js(`Vertex shader compile error for ${this.type}: ${t.getShaderInfoLog(s)}`);if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new js(`Fragment shader compile error for ${this.type}: ${t.getShaderInfoLog(o)}`);if(t.attachShader(l,s),t.attachShader(l,o),t.linkProgram(l),!t.getProgramParameter(l,t.LINK_STATUS))throw new js(`Shader link error for "${this.type}" ${t.getProgramInfoLog(l)}`);const u=this.getUniformLocations(t,l)||{};return u.uStepW=t.getUniformLocation(l,"uStepW"),u.uStepH=t.getUniformLocation(l,"uStepH"),{program:l,attributeLocations:this.getAttributeLocations(t,l),uniformLocations:u}}getAttributeLocations(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}}getUniformLocations(t,e){const r=this.constructor.uniformLocations,i={};for(let s=0;s<r.length;s++)i[r[s]]=t.getUniformLocation(e,r[s]);return i}sendAttributeData(t,e,r){const i=e.aPosition,s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW)}_setupFrameBuffer(t){const e=t.context;if(t.passes>1){const r=t.destinationWidth,i=t.destinationHeight;t.sourceWidth===r&&t.sourceHeight===i||(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,r,i)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)}else e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish()}_swapTextures(t){t.passes--,t.pass++;const e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e}isNeutralState(t){return!1}applyTo(t){c_(t)?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){}getCacheKey(){return this.type}retrieveShader(t){const e=this.getCacheKey();return t.programCache[e]||(t.programCache[e]=this.createProgram(t.context)),t.programCache[e]}applyToWebGL(t){const e=t.context,r=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(r.program),this.sendAttributeData(e,r.attributeLocations,t.aPosition),e.uniform1f(r.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(r.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,r.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(t,e,r){t.activeTexture(r),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)}unbindAdditionalTexture(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)}sendUniformData(t,e){}createHelpLayer(t){if(!t.helpLayer){const{sourceWidth:e,sourceHeight:r}=t,i=Ri({width:e,height:r});t.helpLayer=i}}toObject(){const t=Object.keys(this.constructor.defaults||{});return{type:this.type,...t.reduce((e,r)=>(e[r]=this[r],e),{})}}toJSON(){return this.toObject()}static async fromObject(t,e){let{type:r,...i}=t;return new this(i)}}q(En,"type","BaseFilter"),q(En,"uniformLocations",[]);const ght={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class Vy extends En{getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          ${ght[this.mode]}
        }
      }
      `}applyTo2d(t){let{imageData:{data:e}}=t;const r=new Te(this.color).getSource(),i=this.alpha,s=r[0]*i,o=r[1]*i,l=r[2]*i,u=1-i;for(let h=0;h<e.length;h+=4){const d=e[h],m=e[h+1],g=e[h+2];let v,T,S;switch(this.mode){case"multiply":v=d*s/255,T=m*o/255,S=g*l/255;break;case"screen":v=255-(255-d)*(255-s)/255,T=255-(255-m)*(255-o)/255,S=255-(255-g)*(255-l)/255;break;case"add":v=d+s,T=m+o,S=g+l;break;case"difference":v=Math.abs(d-s),T=Math.abs(m-o),S=Math.abs(g-l);break;case"subtract":v=d-s,T=m-o,S=g-l;break;case"darken":v=Math.min(d,s),T=Math.min(m,o),S=Math.min(g,l);break;case"lighten":v=Math.max(d,s),T=Math.max(m,o),S=Math.max(g,l);break;case"overlay":v=s<128?2*d*s/255:255-2*(255-d)*(255-s)/255,T=o<128?2*m*o/255:255-2*(255-m)*(255-o)/255,S=l<128?2*g*l/255:255-2*(255-g)*(255-l)/255;break;case"exclusion":v=s+d-2*s*d/255,T=o+m-2*o*m/255,S=l+g-2*l*g/255;break;case"tint":v=s+d*u,T=o+m*u,S=l+g*u}e[h]=v,e[h+1]=T,e[h+2]=S}}sendUniformData(t,e){const r=new Te(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,t.uniform4fv(e.uColor,r)}}q(Vy,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),q(Vy,"type","BlendColor"),q(Vy,"uniformLocations",["uColor"]),_t.setClass(Vy);const yht={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `};class jy extends En{getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return yht[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(t){const e=t.context,r=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,r,e.TEXTURE1),super.applyToWebGL(t),this.unbindAdditionalTexture(e,e.TEXTURE1)}createTexture(t,e){return t.getCachedTexture(e.cacheKey,e.getElement())}calculateMatrix(){const t=this.image,{width:e,height:r}=t.getElement();return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/r,1]}applyTo2d(t){let{imageData:{data:e,width:r,height:i},filterBackend:{resources:s}}=t;const o=this.image;s.blendImage||(s.blendImage=Ko());const l=s.blendImage,u=l.getContext("2d");l.width!==r||l.height!==i?(l.width=r,l.height=i):u.clearRect(0,0,r,i),u.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),u.drawImage(o.getElement(),0,0,r,i);const h=u.getImageData(0,0,r,i).data;for(let d=0;d<e.length;d+=4){const m=e[d],g=e[d+1],v=e[d+2],T=e[d+3],S=h[d],w=h[d+1],E=h[d+2],R=h[d+3];switch(this.mode){case"multiply":e[d]=m*S/255,e[d+1]=g*w/255,e[d+2]=v*E/255,e[d+3]=T*R/255;break;case"mask":e[d+3]=R}}}sendUniformData(t,e){const r=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,r)}toObject(){return{...super.toObject(),image:this.image&&this.image.toObject()}}static async fromObject(t,e){let{type:r,image:i,...s}=t;return Ls.fromObject(i,e).then(o=>new this({...s,image:o}))}}q(jy,"type","BlendImage"),q(jy,"defaults",{mode:"multiply",alpha:1}),q(jy,"uniformLocations",["uTransformMatrix","uImage"]),_t.setClass(jy);class By extends En{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(t){c_(t)?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){let{imageData:{data:e,width:r,height:i}}=t;this.aspectRatio=r/i,this.horizontal=!0;let s=this.getBlurValue()*r;const o=new Uint8ClampedArray(e),l=15,u=4*r;for(let h=0;h<e.length;h+=4){let d=0,m=0,g=0,v=0,T=0;const S=h-h%u,w=S+u;for(let E=-14;E<l;E++){const R=E/l,P=4*Math.floor(s*R),j=1-Math.abs(R);let N=h+P;N<S?N=S:N>w&&(N=w);const W=e[N+3]*j;d+=e[N]*W,m+=e[N+1]*W,g+=e[N+2]*W,v+=W,T+=j}o[h]=d/v,o[h+1]=m/v,o[h+2]=g/v,o[h+3]=v/T}this.horizontal=!1,s=this.getBlurValue()*i;for(let h=0;h<o.length;h+=4){let d=0,m=0,g=0,v=0,T=0;const S=h%u,w=o.length-u+S;for(let E=-14;E<l;E++){const R=E/l,P=Math.floor(s*R)*u,j=1-Math.abs(R);let N=h+P;N<S?N=S:N>w&&(N=w);const W=o[N+3]*j;d+=o[N]*W,m+=o[N+1]*W,g+=o[N+2]*W,v+=W,T+=j}e[h]=d/v,e[h+1]=m/v,e[h+2]=g/v,e[h+3]=v/T}}sendUniformData(t,e){const r=this.chooseRightDelta();t.uniform2fv(e.uDelta,r)}isNeutralState(){return this.blur===0}getBlurValue(){let t=1;const{horizontal:e,aspectRatio:r}=this;return e?r>1&&(t=1/r):r<1&&(t=r),t*this.blur*.12}chooseRightDelta(){const t=this.getBlurValue();return this.horizontal?[t,0]:[0,t]}}q(By,"type","Blur"),q(By,"defaults",{blur:0}),q(By,"uniformLocations",["uDelta"]),_t.setClass(By);class Fy extends En{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const r=Math.round(255*this.brightness);for(let i=0;i<e.length;i+=4)e[i]+=r,e[i+1]+=r,e[i+2]+=r}isNeutralState(){return this.brightness===0}sendUniformData(t,e){t.uniform1f(e.uBrightness,this.brightness)}}q(Fy,"type","Brightness"),q(Fy,"defaults",{brightness:0}),q(Fy,"uniformLocations",["uBrightness"]),_t.setClass(Fy);const EU={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class bh extends En{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(t){const e=t.imageData.data,r=this.matrix,i=this.colorsOnly;for(let s=0;s<e.length;s+=4){const o=e[s],l=e[s+1],u=e[s+2];if(e[s]=o*r[0]+l*r[1]+u*r[2]+255*r[4],e[s+1]=o*r[5]+l*r[6]+u*r[7]+255*r[9],e[s+2]=o*r[10]+l*r[11]+u*r[12]+255*r[14],!i){const h=e[s+3];e[s]+=h*r[3],e[s+1]+=h*r[8],e[s+2]+=h*r[13],e[s+3]=o*r[15]+l*r[16]+u*r[17]+h*r[18]+255*r[19]}}}sendUniformData(t,e){const r=this.matrix,i=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],s=[r[4],r[9],r[14],r[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,i),t.uniform4fv(e.uConstants,s)}toObject(){return{...super.toObject(),matrix:[...this.matrix]}}}function uu(n,t){var e;const r=(q(e=class extends bh{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",n),q(e,"defaults",{colorsOnly:!1,matrix:t}),e);return _t.setClass(r,n),r}q(bh,"type","ColorMatrix"),q(bh,"defaults",EU),q(bh,"uniformLocations",["uColorMatrix","uConstants"]),_t.setClass(bh);uu("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);uu("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);uu("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);uu("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);uu("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);uu("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);uu("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class hN extends En{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.subFilters=t.subFilters||[]}applyTo(t){c_(t)&&(t.passes+=this.subFilters.length-1),this.subFilters.forEach(e=>{e.applyTo(t)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(t=>t.toObject())}}isNeutralState(){return!this.subFilters.some(t=>!t.isNeutralState())}static fromObject(t,e){return Promise.all((t.subFilters||[]).map(r=>_t.getClass(r.type).fromObject(r,e))).then(r=>new this({subFilters:r}))}}q(hN,"type","Composed"),_t.setClass(hN);class Uy extends En{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(t){let{imageData:{data:e}}=t;const r=Math.floor(255*this.contrast),i=259*(r+255)/(255*(259-r));for(let s=0;s<e.length;s+=4)e[s]=i*(e[s]-128)+128,e[s+1]=i*(e[s+1]-128)+128,e[s+2]=i*(e[s+2]-128)+128}sendUniformData(t,e){t.uniform1f(e.uContrast,this.contrast)}}q(Uy,"type","Contrast"),q(Uy,"defaults",{contrast:0}),q(Uy,"uniformLocations",["uContrast"]),_t.setClass(Uy);const vht={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class zy extends En{getCacheKey(){return`${this.type}_${Math.sqrt(this.matrix.length)}_${this.opaque?1:0}`}getFragmentSource(){return vht[this.getCacheKey()]}applyTo2d(t){const e=t.imageData,r=e.data,i=this.matrix,s=Math.round(Math.sqrt(i.length)),o=Math.floor(s/2),l=e.width,u=e.height,h=t.ctx.createImageData(l,u),d=h.data,m=this.opaque?1:0;let g,v,T,S,w,E,R,P,j,N,W,M,k;for(W=0;W<u;W++)for(N=0;N<l;N++){for(w=4*(W*l+N),g=0,v=0,T=0,S=0,k=0;k<s;k++)for(M=0;M<s;M++)R=W+k-o,E=N+M-o,R<0||R>=u||E<0||E>=l||(P=4*(R*l+E),j=i[k*s+M],g+=r[P]*j,v+=r[P+1]*j,T+=r[P+2]*j,m||(S+=r[P+3]*j));d[w]=g,d[w+1]=v,d[w+2]=T,d[w+3]=m?r[w+3]:S}t.imageData=h}sendUniformData(t,e){t.uniform1fv(e.uMatrix,this.matrix)}toObject(){return{...super.toObject(),opaque:this.opaque,matrix:[...this.matrix]}}}q(zy,"type","Convolute"),q(zy,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),q(zy,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),_t.setClass(zy);const CU="Gamma";class Hy extends En{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.gamma=t.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(t){let{imageData:{data:e}}=t;const r=this.gamma,i=1/r[0],s=1/r[1],o=1/r[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const l=this.rgbValues;for(let u=0;u<256;u++)l.r[u]=255*Math.pow(u/255,i),l.g[u]=255*Math.pow(u/255,s),l.b[u]=255*Math.pow(u/255,o);for(let u=0;u<e.length;u+=4)e[u]=l.r[e[u]],e[u+1]=l.g[e[u+1]],e[u+2]=l.b[e[u+2]]}sendUniformData(t,e){t.uniform3fv(e.uGamma,this.gamma)}isNeutralState(){const{gamma:t}=this;return t[0]===1&&t[1]===1&&t[2]===1}toObject(){return{type:CU,gamma:this.gamma.concat()}}}q(Hy,"type",CU),q(Hy,"defaults",{gamma:[1,1,1]}),q(Hy,"uniformLocations",["uGamma"]),_t.setClass(Hy);const bht={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class $y extends En{applyTo2d(t){let{imageData:{data:e}}=t;for(let r,i=0;i<e.length;i+=4){const s=e[i],o=e[i+1],l=e[i+2];switch(this.mode){case"average":r=(s+o+l)/3;break;case"lightness":r=(Math.min(s,o,l)+Math.max(s,o,l))/2;break;case"luminosity":r=.21*s+.72*o+.07*l}e[i+2]=e[i+1]=e[i]=r}}getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return bht[this.mode]}sendUniformData(t,e){t.uniform1i(e.uMode,1)}isNeutralState(){return!1}}q($y,"type","Grayscale"),q($y,"defaults",{mode:"average"}),q($y,"uniformLocations",["uMode"]),_t.setClass($y);const _ht={...EU,rotation:0};class Lw extends bh{calculateMatrix(){const t=this.rotation*Math.PI,e=Wo(t),r=Yo(t),i=1/3,s=Math.sqrt(i)*r,o=1-e;this.matrix=[e+o/3,i*o-s,i*o+s,0,0,i*o+s,e+i*o,i*o-s,0,0,i*o-s,i*o+s,e+i*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(t){this.calculateMatrix(),super.applyTo(t)}toObject(){return{type:this.type,rotation:this.rotation}}}q(Lw,"type","HueRotation"),q(Lw,"defaults",_ht),_t.setClass(Lw);class qy extends En{applyTo2d(t){let{imageData:{data:e}}=t;for(let r=0;r<e.length;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2],this.alpha&&(e[r+3]=255-e[r+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(t,e){t.uniform1i(e.uInvert,Number(this.invert)),t.uniform1i(e.uAlpha,Number(this.alpha))}}q(qy,"type","Invert"),q(qy,"defaults",{alpha:!1,invert:!0}),q(qy,"uniformLocations",["uInvert","uAlpha"]),_t.setClass(qy);class Gy extends En{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const r=this.noise;for(let i=0;i<e.length;i+=4){const s=(.5-Math.random())*r;e[i]+=s,e[i+1]+=s,e[i+2]+=s}}sendUniformData(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())}isNeutralState(){return this.noise===0}}q(Gy,"type","Noise"),q(Gy,"defaults",{noise:0}),q(Gy,"uniformLocations",["uNoise","uSeed"]),_t.setClass(Gy);class Wy extends En{applyTo2d(t){let{imageData:{data:e,width:r,height:i}}=t;for(let s=0;s<i;s+=this.blocksize)for(let o=0;o<r;o+=this.blocksize){const l=4*s*r+4*o,u=e[l],h=e[l+1],d=e[l+2],m=e[l+3];for(let g=s;g<Math.min(s+this.blocksize,i);g++)for(let v=o;v<Math.min(o+this.blocksize,r);v++){const T=4*g*r+4*v;e[T]=u,e[T+1]=h,e[T+2]=d,e[T+3]=m}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}q(Wy,"type","Pixelate"),q(Wy,"defaults",{blocksize:4}),q(Wy,"uniformLocations",["uBlocksize"]),_t.setClass(Wy);class Yy extends En{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(t){let{imageData:{data:e}}=t;const r=255*this.distance,i=new Te(this.color).getSource(),s=[i[0]-r,i[1]-r,i[2]-r],o=[i[0]+r,i[1]+r,i[2]+r];for(let l=0;l<e.length;l+=4){const u=e[l],h=e[l+1],d=e[l+2];u>s[0]&&h>s[1]&&d>s[2]&&u<o[0]&&h<o[1]&&d<o[2]&&(e[l+3]=0)}}sendUniformData(t,e){const r=new Te(this.color).getSource(),i=this.distance,s=[0+r[0]/255-i,0+r[1]/255-i,0+r[2]/255-i,1],o=[r[0]/255+i,r[1]/255+i,r[2]/255+i,1];t.uniform4fv(e.uLow,s),t.uniform4fv(e.uHigh,o)}}q(Yy,"type","RemoveColor"),q(Yy,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),q(Yy,"uniformLocations",["uLow","uHigh"]),_t.setClass(Yy);class Ky extends En{sendUniformData(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)}getFilterWindow(){const t=this.tempScale;return Math.ceil(this.lanczosLobes/t)}getCacheKey(){const t=this.getFilterWindow();return`${this.type}_${t}`}getFragmentSource(){const t=this.getFilterWindow();return this.generateShader(t)}getTaps(){const t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,r=this.getFilterWindow(),i=new Array(r);for(let s=1;s<=r;s++)i[s-1]=t(s*e);return i}generateShader(t){const e=new Array(t);for(let r=1;r<=t;r++)e[r-1]=`${r}.0 * uDelta`;return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[${t}];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        ${e.map((r,i)=>`
              color += texture2D(uTexture, vTexCoord + ${r}) * uTaps[${i}] + texture2D(uTexture, vTexCoord - ${r}) * uTaps[${i}];
              sum += 2.0 * uTaps[${i}];
            `).join(`
`)}
        gl_FragColor = color / sum;
      }
    `}applyToForWebgl(t){t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,super.applyTo(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,super.applyTo(t),t.sourceHeight=t.destinationHeight}applyTo(t){c_(t)?this.applyToForWebgl(t):this.applyTo2d(t)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(t){return e=>{if(e>=t||e<=-t)return 0;if(e<11920929e-14&&e>-11920929e-14)return 1;const r=(e*=Math.PI)/t;return Math.sin(e)/e*Math.sin(r)/r}}applyTo2d(t){const e=t.imageData,r=this.scaleX,i=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/i;const s=e.width,o=e.height,l=Math.round(s*r),u=Math.round(o*i);let h;h=this.resizeType==="sliceHack"?this.sliceByTwo(t,s,o,l,u):this.resizeType==="hermite"?this.hermiteFastResize(t,s,o,l,u):this.resizeType==="bilinear"?this.bilinearFiltering(t,s,o,l,u):this.resizeType==="lanczos"?this.lanczosResize(t,s,o,l,u):new ImageData(l,u),t.imageData=h}sliceByTwo(t,e,r,i,s){const o=t.imageData,l=.5;let u=!1,h=!1,d=e*l,m=r*l;const g=t.filterBackend.resources;let v=0,T=0;const S=e;let w=0;g.sliceByTwo||(g.sliceByTwo=Ko());const E=g.sliceByTwo;(E.width<1.5*e||E.height<r)&&(E.width=1.5*e,E.height=r);const R=E.getContext("2d");for(R.clearRect(0,0,1.5*e,r),R.putImageData(o,0,0),i=Math.floor(i),s=Math.floor(s);!u||!h;)e=d,r=m,i<Math.floor(d*l)?d=Math.floor(d*l):(d=i,u=!0),s<Math.floor(m*l)?m=Math.floor(m*l):(m=s,h=!0),R.drawImage(E,v,T,e,r,S,w,d,m),v=S,T=w,w+=m;return R.getImageData(v,T,i,s)}lanczosResize(t,e,r,i,s){const o=t.imageData.data,l=t.ctx.createImageData(i,s),u=l.data,h=this.lanczosCreate(this.lanczosLobes),d=this.rcpScaleX,m=this.rcpScaleY,g=2/this.rcpScaleX,v=2/this.rcpScaleY,T=Math.ceil(d*this.lanczosLobes/2),S=Math.ceil(m*this.lanczosLobes/2),w={},E={x:0,y:0},R={x:0,y:0};return(function P(j){let N,W,M,k,O,B,F,H,V,yt,xt;for(E.x=(j+.5)*d,R.x=Math.floor(E.x),N=0;N<s;N++){for(E.y=(N+.5)*m,R.y=Math.floor(E.y),O=0,B=0,F=0,H=0,V=0,W=R.x-T;W<=R.x+T;W++)if(!(W<0||W>=e)){yt=Math.floor(1e3*Math.abs(W-E.x)),w[yt]||(w[yt]={});for(let J=R.y-S;J<=R.y+S;J++)J<0||J>=r||(xt=Math.floor(1e3*Math.abs(J-E.y)),w[yt][xt]||(w[yt][xt]=h(Math.sqrt(Math.pow(yt*g,2)+Math.pow(xt*v,2))/1e3)),M=w[yt][xt],M>0&&(k=4*(J*e+W),O+=M,B+=M*o[k],F+=M*o[k+1],H+=M*o[k+2],V+=M*o[k+3]))}k=4*(N*i+j),u[k]=B/O,u[k+1]=F/O,u[k+2]=H/O,u[k+3]=V/O}return++j<i?P(j):l})(0)}bilinearFiltering(t,e,r,i,s){let o,l,u,h,d,m,g,v,T,S,w,E,R,P=0;const j=this.rcpScaleX,N=this.rcpScaleY,W=4*(e-1),M=t.imageData.data,k=t.ctx.createImageData(i,s),O=k.data;for(g=0;g<s;g++)for(v=0;v<i;v++)for(d=Math.floor(j*v),m=Math.floor(N*g),T=j*v-d,S=N*g-m,R=4*(m*e+d),w=0;w<4;w++)o=M[R+w],l=M[R+4+w],u=M[R+W+w],h=M[R+W+4+w],E=o*(1-T)*(1-S)+l*T*(1-S)+u*S*(1-T)+h*T*S,O[P++]=E;return k}hermiteFastResize(t,e,r,i,s){const o=this.rcpScaleX,l=this.rcpScaleY,u=Math.ceil(o/2),h=Math.ceil(l/2),d=t.imageData.data,m=t.ctx.createImageData(i,s),g=m.data;for(let v=0;v<s;v++)for(let T=0;T<i;T++){const S=4*(T+v*i);let w=0,E=0,R=0,P=0,j=0,N=0,W=0;const M=(v+.5)*l;for(let k=Math.floor(v*l);k<(v+1)*l;k++){const O=Math.abs(M-(k+.5))/h,B=(T+.5)*o,F=O*O;for(let H=Math.floor(T*o);H<(T+1)*o;H++){let V=Math.abs(B-(H+.5))/u;const yt=Math.sqrt(F+V*V);yt>1&&yt<-1||(w=2*yt*yt*yt-3*yt*yt+1,w>0&&(V=4*(H+k*e),W+=w*d[V+3],R+=w,d[V+3]<255&&(w=w*d[V+3]/250),P+=w*d[V],j+=w*d[V+1],N+=w*d[V+2],E+=w))}}g[S]=P/E,g[S+1]=j/E,g[S+2]=N/E,g[S+3]=W/R}return m}}q(Ky,"type","Resize"),q(Ky,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),q(Ky,"uniformLocations",["uDelta","uTaps"]),_t.setClass(Ky);class Xy extends En{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const r=-this.saturation;for(let i=0;i<e.length;i+=4){const s=e[i],o=e[i+1],l=e[i+2],u=Math.max(s,o,l);e[i]+=u!==s?(u-s)*r:0,e[i+1]+=u!==o?(u-o)*r:0,e[i+2]+=u!==l?(u-l)*r:0}}sendUniformData(t,e){t.uniform1f(e.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}q(Xy,"type","Saturation"),q(Xy,"defaults",{saturation:0}),q(Xy,"uniformLocations",["uSaturation"]),_t.setClass(Xy);class Qy extends En{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const r=-this.vibrance;for(let i=0;i<e.length;i+=4){const s=e[i],o=e[i+1],l=e[i+2],u=Math.max(s,o,l),h=(s+o+l)/3,d=2*Math.abs(u-h)/255*r;e[i]+=u!==s?(u-s)*d:0,e[i+1]+=u!==o?(u-o)*d:0,e[i+2]+=u!==l?(u-l)*d:0}}sendUniformData(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}q(Qy,"type","Vibrance"),q(Qy,"defaults",{vibrance:0}),q(Qy,"uniformLocations",["uVibrance"]),_t.setClass(Qy);const Jy=["#2D2D2D","#FF6B6B","#FFB347","#FDFD96","#77DD77","#89CFF0","#B19CD9","#FFB6C1","#FFFFFF"],Tht=2,Sht=30,fN=5,wht="#FFFFFF";function xht({width:n,height:t,onSave:e,onClose:r}){const i=L.useRef(null),s=L.useRef(null),[o,l]=L.useState("pencil"),[u,h]=L.useState(Jy[0]),[d,m]=L.useState(fN),g=L.useRef(Jy[0]);L.useEffect(()=>{if(!i.current)return;const w=new SE(i.current,{isDrawingMode:!0,width:n,height:t,backgroundColor:"#FFFFFF"}),E=new ob(w);return E.color=Jy[0],E.width=fN,w.freeDrawingBrush=E,s.current=w,()=>{w.dispose(),s.current=null}},[n,t]),L.useEffect(()=>{const w=s.current;!w||!w.freeDrawingBrush||(o==="eraser"?(w.freeDrawingBrush.color=wht,w.freeDrawingBrush.width=d*3):(w.freeDrawingBrush.color=u,w.freeDrawingBrush.width=d))},[o,u,d]);const v=L.useCallback(w=>{w==="pencil"&&o==="eraser"&&h(g.current),w==="eraser"&&o==="pencil"&&(g.current=u),l(w)},[o,u]),T=L.useCallback(w=>{h(w),g.current=w,o==="eraser"&&l("pencil")},[o]),S=L.useCallback(()=>{const w=s.current;if(w)try{const E=w.toDataURL({format:"png"});e(E)}catch(E){console.error("Failed to export canvas:",E)}},[e]);return z.jsxs("div",{className:"flex flex-col items-center",children:[z.jsxs("div",{className:"flex flex-wrap items-center gap-3 p-3 bg-white/90 backdrop-blur rounded-2xl shadow-md mb-3 w-full max-w-[600px]",children:[z.jsxs("div",{className:"flex gap-1",children:[z.jsx("button",{type:"button",onClick:()=>v("pencil"),className:`px-3 py-1.5 rounded-xl text-sm font-['Poppins'] font-medium transition-colors cursor-pointer ${o==="pencil"?"bg-pink-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,"aria-label":"Pencil tool",children:" Pencil"}),z.jsx("button",{type:"button",onClick:()=>v("eraser"),className:`px-3 py-1.5 rounded-xl text-sm font-['Poppins'] font-medium transition-colors cursor-pointer ${o==="eraser"?"bg-pink-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,"aria-label":"Eraser tool",children:" Eraser"})]}),z.jsx("div",{className:"w-px h-6 bg-gray-200"}),z.jsx("div",{className:"flex gap-1 flex-wrap",children:Jy.map(w=>z.jsx("button",{type:"button",onClick:()=>T(w),className:`w-6 h-6 rounded-full border-2 transition-transform cursor-pointer ${u===w&&o==="pencil"?"border-pink-500 scale-110":"border-gray-200 hover:scale-105"}`,style:{backgroundColor:w},"aria-label":`Color ${w}`},w))}),z.jsx("div",{className:"w-px h-6 bg-gray-200"}),z.jsxs("div",{className:"flex items-center gap-2",children:[z.jsx("span",{className:"text-xs font-['Poppins'] text-gray-500",children:"Size"}),z.jsx("input",{type:"range",min:Tht,max:Sht,value:d,onChange:w=>m(Number(w.target.value)),className:"w-20 accent-pink-500","aria-label":"Brush size"}),z.jsx("span",{className:"text-xs font-['Poppins'] text-gray-500 w-5 text-center",children:d})]})]}),z.jsx("div",{className:"rounded-2xl overflow-hidden border border-pink-100 shadow-sm bg-white",children:z.jsx("canvas",{ref:i})}),z.jsxs("div",{className:"flex gap-3 mt-3",children:[z.jsx("button",{type:"button",onClick:r,className:"px-6 py-2 rounded-xl font-['Poppins'] text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors cursor-pointer",children:"Cancel"}),z.jsx("button",{type:"button",onClick:S,className:"px-6 py-2 rounded-xl font-['Poppins'] text-sm font-medium bg-pink-500 text-white hover:bg-pink-600 transition-colors shadow-md cursor-pointer",children:" Save Drawing"})]})]})}const vA="dearme-draft",Eht=3e4;function dN(){try{const n=localStorage.getItem(vA);return n?JSON.parse(n):null}catch{return null}}function Cht(n){try{localStorage.setItem(vA,JSON.stringify(n))}catch{}}function pN(){localStorage.removeItem(vA)}function Aht(){const{entryId:n}=X6(),t=em(),{user:e}=Ib(),[r,i]=L.useState(""),[s,o]=L.useState("neutral"),[l,u]=L.useState([]),[h,d]=L.useState(null),[m,g]=L.useState([]),[v,T]=L.useState(!1),[S,w]=L.useState(!1),[E,R]=L.useState(!!n),[P,j]=L.useState(!1),[N,W]=L.useState(n||null),[M,k]=L.useState(null),[O,B]=L.useState(!1),[F,H]=L.useState(!1),[V,yt]=L.useState(null),[xt,J]=L.useState(!1),st=L.useRef(n||(typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))),ht=L.useRef(null),Ct=L.useRef(null),Vt=L.useRef(!1),$=Got({extensions:[Olt,p5,y5,Vlt,jlt,zlt.configure({multicolor:!0})],content:"<p>Start writing your thoughts...</p>",editorProps:{attributes:{class:"prose prose-sm sm:prose-base max-w-none focus:outline-none min-h-[300px] font-['Poppins'] text-gray-800 p-4"}},onUpdate:()=>{Vt.current=!0}});L.useEffect(()=>{if(!n||!e)return;let Rt=!1;async function ge(){try{R(!0);const Re=await Qlt(n,e.uid);if(Rt)return;i(Re.title||""),o(Re.mood||"neutral"),u(Re.images||[]),d(Re.drawingURL||null),W(n),$&&Re.content&&$.commands.setContent(Re.content)}catch(Re){Rt||g([Re.message||"Failed to load entry"])}finally{Rt||R(!1)}}return ge(),()=>{Rt=!0}},[n,e,$]),L.useEffect(()=>{if(n)return;const Rt=dN();Rt&&(Rt.title||Rt.mood!=="neutral"||Rt.content)&&j(!0)},[n]);const ot=L.useCallback(()=>{const Rt=dN();Rt&&(Rt.title&&i(Rt.title),Rt.mood&&o(Rt.mood),$&&Rt.content&&$.commands.setContent(Rt.content),j(!1))},[$]),dt=L.useCallback(()=>{pN(),j(!1)},[]);L.useEffect(()=>{if(!n)return Ct.current=setInterval(()=>{if(!$)return;const Rt={title:r,mood:s,content:$.getJSON(),savedAt:new Date().toISOString()};Cht(Rt)},Eht),()=>{Ct.current&&clearInterval(Ct.current)}},[n,r,s,$]);const mt=L.useCallback(async Rt=>{const ge=Rt.target.files?.[0];if(ge){if(ht.current&&(ht.current.value=""),k(null),l.length>=vc){k(`Maximum ${vc} images per entry`);return}if(ge.size>EB){k("Image must be under 5MB");return}if(!CB.includes(ge.type)){k("Please upload a JPEG, PNG, GIF, or WebP image");return}B(!0);try{const Re=N||st.current,Sr=await Jlt(e.uid,Re,ge);u(ri=>[...ri,Sr])}catch(Re){k(Re.message||"Failed to upload image. Please try again.")}finally{B(!1)}}},[l,N,e]),Dt=L.useCallback(Rt=>{u(ge=>ge.filter((Re,Sr)=>Sr!==Rt))},[]),It=L.useCallback(async Rt=>{if(e){yt(null),J(!0);try{const ge=N||st.current,Re=await Zlt(e.uid,ge,Rt);d(Re),H(!1)}catch(ge){yt(ge.message||"Could not save your drawing. Please try simplifying it.")}finally{J(!1)}}},[e,N]),Ut=L.useCallback(()=>{H(!1)},[]),Ve=L.useCallback(()=>{d(null)},[]),ce=L.useCallback(async()=>{if(!$||!e)return;const Rt=[],ge=_5(r);ge.valid||Rt.push(ge.error);const Re=T5(new Date);if(Re.valid||Rt.push(Re.error),Rt.length>0){g(Rt);return}g([]),T(!0);try{const Sr={title:r.trim(),content:$.getJSON(),mood:s,images:l,drawingURL:h,theme:"pastel-pink",date:new Date};await Xlt(e.uid,Sr,N||void 0),pN(),w(!0),setTimeout(()=>{t("/dashboard")},1200)}catch(Sr){g([Sr.message||"Failed to save entry"])}finally{T(!1)}},[$,e,r,s,l,h,N,t]);return E?z.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:z.jsxs("div",{className:"text-center",children:[z.jsx("div",{className:"w-10 h-10 border-4 border-pink-200 border-t-pink-500 rounded-full animate-spin mx-auto mb-3"}),z.jsx("p",{className:"font-['Poppins'] text-gray-500",children:"Loading entry..."})]})}):z.jsxs("div",{className:"max-w-3xl mx-auto p-4 sm:p-6",children:[z.jsx(US,{children:S&&z.jsx(hr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20",children:z.jsxs(hr.div,{initial:{y:20},animate:{y:0},className:"bg-white rounded-3xl p-8 shadow-2xl text-center",children:[z.jsx("span",{className:"text-5xl mb-3 block",children:""}),z.jsx("p",{className:"font-['Caveat'] text-2xl text-pink-600",children:"Entry saved!"})]})})}),z.jsx(US,{children:P&&z.jsxs(hr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-2xl flex items-center justify-between",children:[z.jsx("p",{className:"font-['Poppins'] text-sm text-yellow-800",children:"You have an unsaved draft. Would you like to restore it?"}),z.jsxs("div",{className:"flex gap-2 ml-4",children:[z.jsx("button",{type:"button",onClick:ot,className:"px-3 py-1.5 bg-yellow-400 text-yellow-900 rounded-lg text-sm font-medium hover:bg-yellow-500 transition-colors",children:"Restore"}),z.jsx("button",{type:"button",onClick:dt,className:"px-3 py-1.5 bg-white text-gray-600 rounded-lg text-sm border border-gray-200 hover:bg-gray-50 transition-colors",children:"Discard"})]})]})}),z.jsx("h1",{className:"font-['Caveat'] text-3xl sm:text-4xl text-[var(--color-text,#4A2040)] mb-6",children:N?" Edit Entry":" New Entry"}),m.length>0&&z.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-2xl",role:"alert",children:m.map((Rt,ge)=>z.jsx("p",{className:"font-['Poppins'] text-sm text-red-600",children:Rt},ge))}),z.jsxs("div",{className:"mb-4",children:[z.jsx("label",{htmlFor:"entry-title",className:"block font-['Poppins'] text-sm text-gray-600 mb-1",children:"Title"}),z.jsx("input",{id:"entry-title",type:"text",value:r,onChange:Rt=>i(Rt.target.value),placeholder:"Give your entry a title...",maxLength:200,className:"w-full px-4 py-3 rounded-2xl border border-pink-200 bg-white font-['Caveat'] text-xl text-gray-800 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-300 focus:border-transparent transition-shadow"}),z.jsxs("p",{className:"mt-1 text-xs font-['Poppins'] text-gray-400 text-right",children:[r.length,"/200"]})]}),z.jsxs("div",{className:"mb-6",children:[z.jsx("p",{className:"font-['Poppins'] text-sm text-gray-600 mb-2",children:"How are you feeling?"}),z.jsx(AB,{value:s,onChange:o})]}),z.jsx(ict,{editor:$}),z.jsx("div",{className:"bg-white rounded-2xl border border-pink-100 shadow-sm min-h-[350px] mb-6 overflow-hidden",style:{backgroundImage:"repeating-linear-gradient(transparent, transparent 31px, #f9e4ec 31px, #f9e4ec 32px)",backgroundSize:"100% 32px"},children:z.jsx(jF,{editor:$})}),z.jsxs("div",{className:"mb-6",children:[z.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[z.jsxs("label",{className:"font-['Poppins'] text-sm text-gray-600",children:["Images (",l.length,"/",vc,")"]}),z.jsx("input",{ref:ht,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:mt,className:"hidden",id:"image-upload","aria-label":"Upload image"}),z.jsx("button",{type:"button",onClick:()=>ht.current?.click(),disabled:O||l.length>=vc,className:`px-4 py-1.5 rounded-xl font-['Poppins'] text-sm font-medium transition-colors ${O||l.length>=vc?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-pink-100 text-pink-600 hover:bg-pink-200 cursor-pointer"}`,children:O?"Uploading...":" Add Image"}),z.jsx("button",{type:"button",onClick:()=>H(!0),className:"px-4 py-1.5 rounded-xl font-['Poppins'] text-sm font-medium bg-purple-100 text-purple-600 hover:bg-purple-200 transition-colors cursor-pointer",children:" Open Drawing"})]}),M&&z.jsx("p",{className:"font-['Poppins'] text-sm text-red-500 mb-2",role:"alert",children:M}),V&&z.jsx("p",{className:"font-['Poppins'] text-sm text-red-500 mb-2",role:"alert",children:V}),l.length>0&&z.jsx("div",{className:"flex flex-wrap gap-3",children:l.map((Rt,ge)=>z.jsxs("div",{className:"relative group w-24 h-24 rounded-xl overflow-hidden border border-pink-100 shadow-sm",children:[z.jsx("img",{src:Rt,alt:`Upload ${ge+1}`,className:"w-full h-full object-cover"}),z.jsx("button",{type:"button",onClick:()=>Dt(ge),className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer","aria-label":`Remove image ${ge+1}`,children:""})]},Rt))}),h&&z.jsxs("div",{className:"mt-3",children:[z.jsx("p",{className:"font-['Poppins'] text-sm text-gray-600 mb-1",children:"Drawing"}),z.jsxs("div",{className:"relative group w-32 h-24 rounded-xl overflow-hidden border border-purple-200 shadow-sm bg-white",children:[z.jsx("img",{src:h,alt:"Saved drawing",className:"w-full h-full object-contain"}),z.jsx("button",{type:"button",onClick:Ve,className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer","aria-label":"Remove drawing",children:""})]})]})]}),z.jsx(US,{children:F&&z.jsx(hr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",children:z.jsxs(hr.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white/95 rounded-3xl p-4 sm:p-6 shadow-2xl max-w-[650px] w-full max-h-[90vh] overflow-auto",children:[z.jsx("h2",{className:"font-['Caveat'] text-2xl text-purple-600 mb-3 text-center",children:" Draw Something"}),xt&&z.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[z.jsx("div",{className:"w-4 h-4 border-2 border-purple-200 border-t-purple-500 rounded-full animate-spin"}),z.jsx("span",{className:"font-['Poppins'] text-sm text-gray-500",children:"Saving drawing..."})]}),z.jsx(xht,{width:560,height:400,onSave:It,onClose:Ut})]})})}),z.jsx("div",{className:"flex justify-end",children:z.jsx(hr.button,{type:"button",onClick:ce,disabled:v,whileHover:{scale:1.02},whileTap:{scale:.98},className:`px-8 py-3 rounded-2xl font-['Poppins'] font-medium text-white shadow-lg transition-colors ${v?"bg-pink-300 cursor-not-allowed":"bg-pink-500 hover:bg-pink-600 cursor-pointer"}`,children:v?"Saving...":N?"Update Entry":"Save Entry"})})]})}function kht(){return z.jsxs("div",{className:"p-6",children:[z.jsx("h1",{className:"font-['Caveat'] text-3xl text-[var(--color-text)] mb-4",children:"Calendar"}),z.jsx("p",{className:"font-['Poppins'] text-[var(--color-text)]",children:"Your diary calendar view "})]})}function Rht(){return z.jsx(IK,{children:z.jsx(NH,{children:z.jsxs(hH,{children:[z.jsx(Va,{path:"/login",element:z.jsx(Mtt,{})}),z.jsx(Va,{element:z.jsx(LK,{}),children:z.jsxs(Va,{element:z.jsx(NK,{}),children:[z.jsx(Va,{path:"/dashboard",element:z.jsx(jtt,{})}),z.jsx(Va,{path:"/editor/:entryId?",element:z.jsx(Aht,{})}),z.jsx(Va,{path:"/calendar",element:z.jsx(kht,{})})]})}),z.jsx(Va,{path:"*",element:z.jsx(MN,{to:"/dashboard",replace:!0})})]})})})}h6.createRoot(document.getElementById("root")).render(z.jsx(L.StrictMode,{children:z.jsx(Rht,{})}));
