(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();function nL(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var OS={exports:{}},Rd={};var bO;function Q6(){if(bO)return Rd;bO=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(r,i,s){var o=null;if(s!==void 0&&(o=""+s),i.key!==void 0&&(o=""+i.key),"key"in i){s={};for(var l in i)l!=="key"&&(s[l]=i[l])}else s=i;return i=s.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:s}}return Rd.Fragment=t,Rd.jsx=e,Rd.jsxs=e,Rd}var _O;function J6(){return _O||(_O=1,OS.exports=Q6()),OS.exports}var B=J6(),RS={exports:{}},Bt={};var TO;function Z6(){if(TO)return Bt;TO=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),g=Symbol.iterator;function v($){return $===null||typeof $!="object"?null:($=g&&$[g]||$["@@iterator"],typeof $=="function"?$:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,w={};function E($,ot,dt){this.props=$,this.context=ot,this.refs=w,this.updater=dt||T}E.prototype.isReactComponent={},E.prototype.setState=function($,ot){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,ot,"setState")},E.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function D(){}D.prototype=E.prototype;function P($,ot,dt){this.props=$,this.context=ot,this.refs=w,this.updater=dt||T}var V=P.prototype=new D;V.constructor=P,S(V,E.prototype),V.isPureReactComponent=!0;var N=Array.isArray;function q(){}var M={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function R($,ot,dt){var mt=dt.ref;return{$$typeof:n,type:$,key:ot,ref:mt!==void 0?mt:null,props:dt}}function F($,ot){return R($.type,ot,$.props)}function U($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function H($){var ot={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(dt){return ot[dt]})}var j=/\/+/g;function yt($,ot){return typeof $=="object"&&$!==null&&$.key!=null?H(""+$.key):ot.toString(36)}function xt($){switch($.status){case"fulfilled":return $.value;case"rejected":throw $.reason;default:switch(typeof $.status=="string"?$.then(q,q):($.status="pending",$.then(function(ot){$.status==="pending"&&($.status="fulfilled",$.value=ot)},function(ot){$.status==="pending"&&($.status="rejected",$.reason=ot)})),$.status){case"fulfilled":return $.value;case"rejected":throw $.reason}}throw $}function J($,ot,dt,mt,Ot){var It=typeof $;(It==="undefined"||It==="boolean")&&($=null);var Ut=!1;if($===null)Ut=!0;else switch(It){case"bigint":case"string":case"number":Ut=!0;break;case"object":switch($.$$typeof){case n:case t:Ut=!0;break;case d:return Ut=$._init,J(Ut($._payload),ot,dt,mt,Ot)}}if(Ut)return Ot=Ot($),Ut=mt===""?"."+yt($,0):mt,N(Ot)?(dt="",Ut!=null&&(dt=Ut.replace(j,"$&/")+"/"),J(Ot,ot,dt,"",function(Mt){return Mt})):Ot!=null&&(U(Ot)&&(Ot=F(Ot,dt+(Ot.key==null||$&&$.key===Ot.key?"":(""+Ot.key).replace(j,"$&/")+"/")+Ut)),ot.push(Ot)),1;Ut=0;var Fe=mt===""?".":mt+":";if(N($))for(var he=0;he<$.length;he++)mt=$[he],It=Fe+yt(mt,he),Ut+=J(mt,ot,dt,It,Ot);else if(he=v($),typeof he=="function")for($=he.call($),he=0;!(mt=$.next()).done;)mt=mt.value,It=Fe+yt(mt,he++),Ut+=J(mt,ot,dt,It,Ot);else if(It==="object"){if(typeof $.then=="function")return J(xt($),ot,dt,mt,Ot);throw ot=String($),Error("Objects are not valid as a React child (found: "+(ot==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":ot)+"). If you meant to render a collection of children, use an array instead.")}return Ut}function st($,ot,dt){if($==null)return $;var mt=[],Ot=0;return J($,mt,"","",function(It){return ot.call(dt,It,Ot++)}),mt}function ht($){if($._status===-1){var ot=$._result;ot=ot(),ot.then(function(dt){($._status===0||$._status===-1)&&($._status=1,$._result=dt)},function(dt){($._status===0||$._status===-1)&&($._status=2,$._result=dt)}),$._status===-1&&($._status=0,$._result=ot)}if($._status===1)return $._result.default;throw $._result}var Ct=typeof reportError=="function"?reportError:function($){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ot=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof $=="object"&&$!==null&&typeof $.message=="string"?String($.message):String($),error:$});if(!window.dispatchEvent(ot))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",$);return}console.error($)},Vt={map:st,forEach:function($,ot,dt){st($,function(){ot.apply(this,arguments)},dt)},count:function($){var ot=0;return st($,function(){ot++}),ot},toArray:function($){return st($,function(ot){return ot})||[]},only:function($){if(!U($))throw Error("React.Children.only expected to receive a single React element child.");return $}};return Bt.Activity=p,Bt.Children=Vt,Bt.Component=E,Bt.Fragment=e,Bt.Profiler=i,Bt.PureComponent=P,Bt.StrictMode=r,Bt.Suspense=u,Bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Bt.__COMPILER_RUNTIME={__proto__:null,c:function($){return M.H.useMemoCache($)}},Bt.cache=function($){return function(){return $.apply(null,arguments)}},Bt.cacheSignal=function(){return null},Bt.cloneElement=function($,ot,dt){if($==null)throw Error("The argument must be a React element, but you passed "+$+".");var mt=S({},$.props),Ot=$.key;if(ot!=null)for(It in ot.key!==void 0&&(Ot=""+ot.key),ot)!k.call(ot,It)||It==="key"||It==="__self"||It==="__source"||It==="ref"&&ot.ref===void 0||(mt[It]=ot[It]);var It=arguments.length-2;if(It===1)mt.children=dt;else if(1<It){for(var Ut=Array(It),Fe=0;Fe<It;Fe++)Ut[Fe]=arguments[Fe+2];mt.children=Ut}return R($.type,Ot,mt)},Bt.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null},$.Provider=$,$.Consumer={$$typeof:s,_context:$},$},Bt.createElement=function($,ot,dt){var mt,Ot={},It=null;if(ot!=null)for(mt in ot.key!==void 0&&(It=""+ot.key),ot)k.call(ot,mt)&&mt!=="key"&&mt!=="__self"&&mt!=="__source"&&(Ot[mt]=ot[mt]);var Ut=arguments.length-2;if(Ut===1)Ot.children=dt;else if(1<Ut){for(var Fe=Array(Ut),he=0;he<Ut;he++)Fe[he]=arguments[he+2];Ot.children=Fe}if($&&$.defaultProps)for(mt in Ut=$.defaultProps,Ut)Ot[mt]===void 0&&(Ot[mt]=Ut[mt]);return R($,It,Ot)},Bt.createRef=function(){return{current:null}},Bt.forwardRef=function($){return{$$typeof:l,render:$}},Bt.isValidElement=U,Bt.lazy=function($){return{$$typeof:d,_payload:{_status:-1,_result:$},_init:ht}},Bt.memo=function($,ot){return{$$typeof:h,type:$,compare:ot===void 0?null:ot}},Bt.startTransition=function($){var ot=M.T,dt={};M.T=dt;try{var mt=$(),Ot=M.S;Ot!==null&&Ot(dt,mt),typeof mt=="object"&&mt!==null&&typeof mt.then=="function"&&mt.then(q,Ct)}catch(It){Ct(It)}finally{ot!==null&&dt.types!==null&&(ot.types=dt.types),M.T=ot}},Bt.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},Bt.use=function($){return M.H.use($)},Bt.useActionState=function($,ot,dt){return M.H.useActionState($,ot,dt)},Bt.useCallback=function($,ot){return M.H.useCallback($,ot)},Bt.useContext=function($){return M.H.useContext($)},Bt.useDebugValue=function(){},Bt.useDeferredValue=function($,ot){return M.H.useDeferredValue($,ot)},Bt.useEffect=function($,ot){return M.H.useEffect($,ot)},Bt.useEffectEvent=function($){return M.H.useEffectEvent($)},Bt.useId=function(){return M.H.useId()},Bt.useImperativeHandle=function($,ot,dt){return M.H.useImperativeHandle($,ot,dt)},Bt.useInsertionEffect=function($,ot){return M.H.useInsertionEffect($,ot)},Bt.useLayoutEffect=function($,ot){return M.H.useLayoutEffect($,ot)},Bt.useMemo=function($,ot){return M.H.useMemo($,ot)},Bt.useOptimistic=function($,ot){return M.H.useOptimistic($,ot)},Bt.useReducer=function($,ot,dt){return M.H.useReducer($,ot,dt)},Bt.useRef=function($){return M.H.useRef($)},Bt.useState=function($){return M.H.useState($)},Bt.useSyncExternalStore=function($,ot,dt){return M.H.useSyncExternalStore($,ot,dt)},Bt.useTransition=function(){return M.H.useTransition()},Bt.version="19.2.4",Bt}var SO;function mm(){return SO||(SO=1,RS.exports=Z6()),RS.exports}var L=mm();const In=nL(L);var IS={exports:{}},Id={},PS={exports:{}},NS={};var wO;function tH(){return wO||(wO=1,(function(n){function t(J,st){var ht=J.length;J.push(st);t:for(;0<ht;){var Ct=ht-1>>>1,Vt=J[Ct];if(0<i(Vt,st))J[Ct]=st,J[ht]=Vt,ht=Ct;else break t}}function e(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var st=J[0],ht=J.pop();if(ht!==st){J[0]=ht;t:for(var Ct=0,Vt=J.length,$=Vt>>>1;Ct<$;){var ot=2*(Ct+1)-1,dt=J[ot],mt=ot+1,Ot=J[mt];if(0>i(dt,ht))mt<Vt&&0>i(Ot,dt)?(J[Ct]=Ot,J[mt]=ht,Ct=mt):(J[Ct]=dt,J[ot]=ht,Ct=ot);else if(mt<Vt&&0>i(Ot,ht))J[Ct]=Ot,J[mt]=ht,Ct=mt;else break t}}return st}function i(J,st){var ht=J.sortIndex-st.sortIndex;return ht!==0?ht:J.id-st.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],d=1,p=null,g=3,v=!1,T=!1,S=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function V(J){for(var st=e(h);st!==null;){if(st.callback===null)r(h);else if(st.startTime<=J)r(h),st.sortIndex=st.expirationTime,t(u,st);else break;st=e(h)}}function N(J){if(S=!1,V(J),!T)if(e(u)!==null)T=!0,q||(q=!0,H());else{var st=e(h);st!==null&&xt(N,st.startTime-J)}}var q=!1,M=-1,k=5,R=-1;function F(){return w?!0:!(n.unstable_now()-R<k)}function U(){if(w=!1,q){var J=n.unstable_now();R=J;var st=!0;try{t:{T=!1,S&&(S=!1,D(M),M=-1),v=!0;var ht=g;try{e:{for(V(J),p=e(u);p!==null&&!(p.expirationTime>J&&F());){var Ct=p.callback;if(typeof Ct=="function"){p.callback=null,g=p.priorityLevel;var Vt=Ct(p.expirationTime<=J);if(J=n.unstable_now(),typeof Vt=="function"){p.callback=Vt,V(J),st=!0;break e}p===e(u)&&r(u),V(J)}else r(u);p=e(u)}if(p!==null)st=!0;else{var $=e(h);$!==null&&xt(N,$.startTime-J),st=!1}}break t}finally{p=null,g=ht,v=!1}st=void 0}}finally{st?H():q=!1}}}var H;if(typeof P=="function")H=function(){P(U)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,yt=j.port2;j.port1.onmessage=U,H=function(){yt.postMessage(null)}}else H=function(){E(U,0)};function xt(J,st){M=E(function(){J(n.unstable_now())},st)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_next=function(J){switch(g){case 1:case 2:case 3:var st=3;break;default:st=g}var ht=g;g=st;try{return J()}finally{g=ht}},n.unstable_requestPaint=function(){w=!0},n.unstable_runWithPriority=function(J,st){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ht=g;g=J;try{return st()}finally{g=ht}},n.unstable_scheduleCallback=function(J,st,ht){var Ct=n.unstable_now();switch(typeof ht=="object"&&ht!==null?(ht=ht.delay,ht=typeof ht=="number"&&0<ht?Ct+ht:Ct):ht=Ct,J){case 1:var Vt=-1;break;case 2:Vt=250;break;case 5:Vt=1073741823;break;case 4:Vt=1e4;break;default:Vt=5e3}return Vt=ht+Vt,J={id:d++,callback:st,priorityLevel:J,startTime:ht,expirationTime:Vt,sortIndex:-1},ht>Ct?(J.sortIndex=ht,t(h,J),e(u)===null&&J===e(h)&&(S?(D(M),M=-1):S=!0,xt(N,ht-Ct))):(J.sortIndex=Vt,t(u,J),T||v||(T=!0,q||(q=!0,H()))),J},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(J){var st=g;return function(){var ht=g;g=st;try{return J.apply(this,arguments)}finally{g=ht}}}})(NS)),NS}var xO;function eH(){return xO||(xO=1,PS.exports=tH()),PS.exports}var LS={exports:{}},er={};var EO;function nH(){if(EO)return er;EO=1;var n=mm();function t(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)h+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var r={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(u,h,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:h,implementation:d}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return er.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,er.createPortal=function(u,h){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return s(u,h,null,d)},er.flushSync=function(u){var h=o.T,d=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=h,r.p=d,r.d.f()}},er.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,r.d.C(u,h))},er.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},er.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var d=h.as,p=l(d,h.crossOrigin),g=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;d==="style"?r.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:p,integrity:g,fetchPriority:v}):d==="script"&&r.d.X(u,{crossOrigin:p,integrity:g,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},er.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var d=l(h.as,h.crossOrigin);r.d.M(u,{crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&r.d.M(u)},er.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var d=h.as,p=l(d,h.crossOrigin);r.d.L(u,d,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},er.preloadModule=function(u,h){if(typeof u=="string")if(h){var d=l(h.as,h.crossOrigin);r.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else r.d.m(u)},er.requestFormReset=function(u){r.d.r(u)},er.unstable_batchedUpdates=function(u,h){return u(h)},er.useFormState=function(u,h,d){return o.H.useFormState(u,h,d)},er.useFormStatus=function(){return o.H.useHostTransitionStatus()},er.version="19.2.4",er}var CO;function rL(){if(CO)return LS.exports;CO=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),LS.exports=nH(),LS.exports}var AO;function rH(){if(AO)return Id;AO=1;var n=eH(),t=mm(),e=rL();function r(a){var c="https://react.dev/errors/"+a;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var c=a,f=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(f=c.return),a=c.return;while(a)}return c.tag===3?f:null}function o(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function l(a){if(a.tag===31){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function u(a){if(s(a)!==a)throw Error(r(188))}function h(a){var c=a.alternate;if(!c){if(c=s(a),c===null)throw Error(r(188));return c!==a?null:a}for(var f=a,m=c;;){var b=f.return;if(b===null)break;var _=b.alternate;if(_===null){if(m=b.return,m!==null){f=m;continue}break}if(b.child===_.child){for(_=b.child;_;){if(_===f)return u(b),a;if(_===m)return u(b),c;_=_.sibling}throw Error(r(188))}if(f.return!==m.return)f=b,m=_;else{for(var C=!1,O=b.child;O;){if(O===f){C=!0,f=b,m=_;break}if(O===m){C=!0,m=b,f=_;break}O=O.sibling}if(!C){for(O=_.child;O;){if(O===f){C=!0,f=_,m=b;break}if(O===m){C=!0,m=_,f=b;break}O=O.sibling}if(!C)throw Error(r(189))}}if(f.alternate!==m)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?a:c}function d(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a;for(a=a.child;a!==null;){if(c=d(a),c!==null)return c;a=a.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),P=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function H(a){return a===null||typeof a!="object"?null:(a=U&&a[U]||a["@@iterator"],typeof a=="function"?a:null)}var j=Symbol.for("react.client.reference");function yt(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===j?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case S:return"Fragment";case E:return"Profiler";case w:return"StrictMode";case N:return"Suspense";case q:return"SuspenseList";case R:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case T:return"Portal";case P:return a.displayName||"Context";case D:return(a._context.displayName||"Context")+".Consumer";case V:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case M:return c=a.displayName||null,c!==null?c:yt(a.type)||"Memo";case k:c=a._payload,a=a._init;try{return yt(a(c))}catch{}}return null}var xt=Array.isArray,J=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,st=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ht={pending:!1,data:null,method:null,action:null},Ct=[],Vt=-1;function $(a){return{current:a}}function ot(a){0>Vt||(a.current=Ct[Vt],Ct[Vt]=null,Vt--)}function dt(a,c){Vt++,Ct[Vt]=a.current,a.current=c}var mt=$(null),Ot=$(null),It=$(null),Ut=$(null);function Fe(a,c){switch(dt(It,c),dt(Ot,a),dt(mt,null),c.nodeType){case 9:case 11:a=(a=c.documentElement)&&(a=a.namespaceURI)?zD(a):0;break;default:if(a=c.tagName,c=c.namespaceURI)c=zD(c),a=HD(c,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}ot(mt),dt(mt,a)}function he(){ot(mt),ot(Ot),ot(It)}function Mt(a){a.memoizedState!==null&&dt(Ut,a);var c=mt.current,f=HD(c,a.type);c!==f&&(dt(Ot,a),dt(mt,f))}function be(a){Ot.current===a&&(ot(mt),ot(Ot)),Ut.current===a&&(ot(Ut),kd._currentValue=ht)}var Oe,Cr;function li(a){if(Oe===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);Oe=c&&c[1]||"",Cr=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Oe+a+Cr}var kf=!1;function $l(a,c){if(!a||kf)return"";kf=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(c){var lt=function(){throw Error()};if(Object.defineProperty(lt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(lt,[])}catch(nt){var Z=nt}Reflect.construct(a,[],lt)}else{try{lt.call()}catch(nt){Z=nt}a.call(lt.prototype)}}else{try{throw Error()}catch(nt){Z=nt}(lt=a())&&typeof lt.catch=="function"&&lt.catch(function(){})}}catch(nt){if(nt&&Z&&typeof nt.stack=="string")return[nt.stack,Z.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=m.DetermineComponentFrameRoot(),C=_[0],O=_[1];if(C&&O){var z=C.split(`
`),Q=O.split(`
`);for(b=m=0;m<z.length&&!z[m].includes("DetermineComponentFrameRoot");)m++;for(;b<Q.length&&!Q[b].includes("DetermineComponentFrameRoot");)b++;if(m===z.length||b===Q.length)for(m=z.length-1,b=Q.length-1;1<=m&&0<=b&&z[m]!==Q[b];)b--;for(;1<=m&&0<=b;m--,b--)if(z[m]!==Q[b]){if(m!==1||b!==1)do if(m--,b--,0>b||z[m]!==Q[b]){var rt=`
`+z[m].replace(" at new "," at ");return a.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",a.displayName)),rt}while(1<=m&&0<=b);break}}}finally{kf=!1,Error.prepareStackTrace=f}return(f=a?a.displayName||a.name:"")?li(f):""}function Mf(a,c){switch(a.tag){case 26:case 27:case 5:return li(a.type);case 16:return li("Lazy");case 13:return a.child!==c&&c!==null?li("Suspense Fallback"):li("Suspense");case 19:return li("SuspenseList");case 0:case 15:return $l(a.type,!1);case 11:return $l(a.type.render,!1);case 1:return $l(a.type,!0);case 31:return li("Activity");default:return""}}function Df(a){try{var c="",f=null;do c+=Mf(a,f),f=a,a=a.return;while(a);return c}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var ln=Object.prototype.hasOwnProperty,wn=n.unstable_scheduleCallback,oa=n.unstable_cancelCallback,I_=n.unstable_shouldYield,qm=n.unstable_requestPaint,ur=n.unstable_now,ql=n.unstable_getCurrentPriorityLevel,Of=n.unstable_ImmediatePriority,Rf=n.unstable_UserBlockingPriority,aa=n.unstable_NormalPriority,P_=n.unstable_LowPriority,Wm=n.unstable_IdlePriority,Gm=n.log,Ym=n.unstable_setDisableYieldValue,Li=null,Bn=null;function ci(a){if(typeof Gm=="function"&&Ym(a),Bn&&typeof Bn.setStrictMode=="function")try{Bn.setStrictMode(Li,a)}catch{}}var tn=Math.clz32?Math.clz32:Xm,Km=Math.log,_u=Math.LN2;function Xm(a){return a>>>=0,a===0?32:31-(Km(a)/_u|0)|0}var ps=256,Wl=262144,cn=4194304;function ms(a){var c=a&42;if(c!==0)return c;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function gs(a,c,f){var m=a.pendingLanes;if(m===0)return 0;var b=0,_=a.suspendedLanes,C=a.pingedLanes;a=a.warmLanes;var O=m&134217727;return O!==0?(m=O&~_,m!==0?b=ms(m):(C&=O,C!==0?b=ms(C):f||(f=O&~a,f!==0&&(b=ms(f))))):(O=m&~_,O!==0?b=ms(O):C!==0?b=ms(C):f||(f=m&~a,f!==0&&(b=ms(f)))),b===0?0:c!==0&&c!==b&&(c&_)===0&&(_=b&-b,f=c&-c,_>=f||_===32&&(f&4194048)!==0)?c:b}function Vi(a,c){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&c)===0}function N_(a,c){switch(a){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qm(){var a=cn;return cn<<=1,(cn&62914560)===0&&(cn=4194304),a}function ys(a){for(var c=[],f=0;31>f;f++)c.push(a);return c}function Gl(a,c){a.pendingLanes|=c,c!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function L_(a,c,f,m,b,_){var C=a.pendingLanes;a.pendingLanes=f,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=f,a.entangledLanes&=f,a.errorRecoveryDisabledLanes&=f,a.shellSuspendCounter=0;var O=a.entanglements,z=a.expirationTimes,Q=a.hiddenUpdates;for(f=C&~f;0<f;){var rt=31-tn(f),lt=1<<rt;O[rt]=0,z[rt]=-1;var Z=Q[rt];if(Z!==null)for(Q[rt]=null,rt=0;rt<Z.length;rt++){var nt=Z[rt];nt!==null&&(nt.lane&=-536870913)}f&=~lt}m!==0&&Yl(a,m,0),_!==0&&b===0&&a.tag!==0&&(a.suspendedLanes|=_&~(C&~c))}function Yl(a,c,f){a.pendingLanes|=c,a.suspendedLanes&=~c;var m=31-tn(c);a.entangledLanes|=c,a.entanglements[m]=a.entanglements[m]|1073741824|f&261930}function If(a,c){var f=a.entangledLanes|=c;for(a=a.entanglements;f;){var m=31-tn(f),b=1<<m;b&c|a[m]&c&&(a[m]|=c),f&=~b}}function Pf(a,c){var f=c&-c;return f=(f&42)!==0?1:Kl(f),(f&(a.suspendedLanes|c))!==0?0:f}function Kl(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function oo(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Jm(){var a=st.p;return a!==0?a:(a=window.event,a===void 0?32:fO(a.type))}function ji(a,c){var f=st.p;try{return st.p=a,c()}finally{st.p=f}}var Fi=Math.random().toString(36).slice(2),un="__reactFiber$"+Fi,Dn="__reactProps$"+Fi,vs="__reactContainer$"+Fi,Tu="__reactEvents$"+Fi,V_="__reactListeners$"+Fi,Zm="__reactHandles$"+Fi,tg="__reactResources$"+Fi,bs="__reactMarker$"+Fi;function Su(a){delete a[un],delete a[Dn],delete a[Tu],delete a[V_],delete a[Zm]}function _s(a){var c=a[un];if(c)return c;for(var f=a.parentNode;f;){if(c=f[vs]||f[un]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(a=XD(a);a!==null;){if(f=a[un])return f;a=XD(a)}return c}a=f,f=a.parentNode}return null}function ui(a){if(a=a[un]||a[vs]){var c=a.tag;if(c===5||c===6||c===13||c===31||c===26||c===27||c===3)return a}return null}function zr(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a.stateNode;throw Error(r(33))}function Ts(a){var c=a[tg];return c||(c=a[tg]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function hn(a){a[bs]=!0}var Nf=new Set,Lf={};function Ss(a,c){ws(a,c),ws(a+"Capture",c)}function ws(a,c){for(Lf[a]=c,a=0;a<c.length;a++)Nf.add(c[a])}var Vf=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),jf={},Ff={};function eg(a){return ln.call(Ff,a)?!0:ln.call(jf,a)?!1:Vf.test(a)?Ff[a]=!0:(jf[a]=!0,!1)}function wu(a,c,f){if(eg(c))if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":a.removeAttribute(c);return;case"boolean":var m=c.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){a.removeAttribute(c);return}}a.setAttribute(c,""+f)}}function Hr(a,c,f){if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttribute(c,""+f)}}function fn(a,c,f,m){if(m===null)a.removeAttribute(f);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(f);return}a.setAttributeNS(c,f,""+m)}}function On(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function la(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Bf(a,c,f){var m=Object.getOwnPropertyDescriptor(a.constructor.prototype,c);if(!a.hasOwnProperty(c)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var b=m.get,_=m.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return b.call(this)},set:function(C){f=""+C,_.call(this,C)}}),Object.defineProperty(a,c,{enumerable:m.enumerable}),{getValue:function(){return f},setValue:function(C){f=""+C},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function de(a){if(!a._valueTracker){var c=la(a)?"checked":"value";a._valueTracker=Bf(a,c,""+a[c])}}function Xl(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var f=c.getValue(),m="";return a&&(m=la(a)?a.checked?"true":"false":a.value),a=m,a!==f?(c.setValue(a),!0):!1}function xs(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Ql=/[\n"\\]/g;function Ar(a){return a.replace(Ql,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function xu(a,c,f,m,b,_,C,O){a.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?a.type=C:a.removeAttribute("type"),c!=null?C==="number"?(c===0&&a.value===""||a.value!=c)&&(a.value=""+On(c)):a.value!==""+On(c)&&(a.value=""+On(c)):C!=="submit"&&C!=="reset"||a.removeAttribute("value"),c!=null?Uf(a,C,On(c)):f!=null?Uf(a,C,On(f)):m!=null&&a.removeAttribute("value"),b==null&&_!=null&&(a.defaultChecked=!!_),b!=null&&(a.checked=b&&typeof b!="function"&&typeof b!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?a.name=""+On(O):a.removeAttribute("name")}function ng(a,c,f,m,b,_,C,O){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(a.type=_),c!=null||f!=null){if(!(_!=="submit"&&_!=="reset"||c!=null)){de(a);return}f=f!=null?""+On(f):"",c=c!=null?""+On(c):f,O||c===a.value||(a.value=c),a.defaultValue=c}m=m??b,m=typeof m!="function"&&typeof m!="symbol"&&!!m,a.checked=O?a.checked:!!m,a.defaultChecked=!!m,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(a.name=C),de(a)}function Uf(a,c,f){c==="number"&&xs(a.ownerDocument)===a||a.defaultValue===""+f||(a.defaultValue=""+f)}function ca(a,c,f,m){if(a=a.options,c){c={};for(var b=0;b<f.length;b++)c["$"+f[b]]=!0;for(f=0;f<a.length;f++)b=c.hasOwnProperty("$"+a[f].value),a[f].selected!==b&&(a[f].selected=b),b&&m&&(a[f].defaultSelected=!0)}else{for(f=""+On(f),c=null,b=0;b<a.length;b++){if(a[b].value===f){a[b].selected=!0,m&&(a[b].defaultSelected=!0);return}c!==null||a[b].disabled||(c=a[b])}c!==null&&(c.selected=!0)}}function rg(a,c,f){if(c!=null&&(c=""+On(c),c!==a.value&&(a.value=c),f==null)){a.defaultValue!==c&&(a.defaultValue=c);return}a.defaultValue=f!=null?""+On(f):""}function ua(a,c,f,m){if(c==null){if(m!=null){if(f!=null)throw Error(r(92));if(xt(m)){if(1<m.length)throw Error(r(93));m=m[0]}f=m}f==null&&(f=""),c=f}f=On(c),a.defaultValue=f,m=a.textContent,m===f&&m!==""&&m!==null&&(a.value=m),de(a)}function kr(a,c){if(c){var f=a.firstChild;if(f&&f===a.lastChild&&f.nodeType===3){f.nodeValue=c;return}}a.textContent=c}var ig=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zf(a,c,f){var m=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?m?a.setProperty(c,""):c==="float"?a.cssFloat="":a[c]="":m?a.setProperty(c,f):typeof f!="number"||f===0||ig.has(c)?c==="float"?a.cssFloat=f:a[c]=(""+f).trim():a[c]=f+"px"}function Hf(a,c,f){if(c!=null&&typeof c!="object")throw Error(r(62));if(a=a.style,f!=null){for(var m in f)!f.hasOwnProperty(m)||c!=null&&c.hasOwnProperty(m)||(m.indexOf("--")===0?a.setProperty(m,""):m==="float"?a.cssFloat="":a[m]="");for(var b in c)m=c[b],c.hasOwnProperty(b)&&f[b]!==m&&zf(a,b,m)}else for(var _ in c)c.hasOwnProperty(_)&&zf(a,_,c[_])}function Eu(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sg=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ha=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Cu(a){return ha.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Bi(){}var $f=null;function hi(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var fa=null,Es=null;function Jl(a){var c=ui(a);if(c&&(a=c.stateNode)){var f=a[Dn]||null;t:switch(a=c.stateNode,c.type){case"input":if(xu(a,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=a;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Ar(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var m=f[c];if(m!==a&&m.form===a.form){var b=m[Dn]||null;if(!b)throw Error(r(90));xu(m,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(c=0;c<f.length;c++)m=f[c],m.form===a.form&&Xl(m)}break t;case"textarea":rg(a,f.value,f.defaultValue);break t;case"select":c=f.value,c!=null&&ca(a,!!f.multiple,c,!1)}}}var Au=!1;function da(a,c,f){if(Au)return a(c,f);Au=!0;try{var m=a(c);return m}finally{if(Au=!1,(fa!==null||Es!==null)&&(Jg(),fa&&(c=fa,a=Es,Es=fa=null,Jl(c),a)))for(c=0;c<a.length;c++)Jl(a[c])}}function Ui(a,c){var f=a.stateNode;if(f===null)return null;var m=f[Dn]||null;if(m===null)return null;f=m[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break t;default:a=!1}if(a)return null;if(f&&typeof f!="function")throw Error(r(231,c,typeof f));return f}var fi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zl=!1;if(fi)try{var _e={};Object.defineProperty(_e,"passive",{get:function(){Zl=!0}}),window.addEventListener("test",_e,_e),window.removeEventListener("test",_e,_e)}catch{Zl=!1}var Cs=null,qf=null,tc=null;function Wf(){if(tc)return tc;var a,c=qf,f=c.length,m,b="value"in Cs?Cs.value:Cs.textContent,_=b.length;for(a=0;a<f&&c[a]===b[a];a++);var C=f-a;for(m=1;m<=C&&c[f-m]===b[_-m];m++);return tc=b.slice(a,1<m?1-m:void 0)}function ec(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function ao(){return!0}function zi(){return!1}function Un(a){function c(f,m,b,_,C){this._reactName=f,this._targetInst=b,this.type=m,this.nativeEvent=_,this.target=C,this.currentTarget=null;for(var O in a)a.hasOwnProperty(O)&&(f=a[O],this[O]=f?f(_):_[O]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ao:zi,this.isPropagationStopped=zi,this}return p(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ao)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ao)},persist:function(){},isPersistent:ao}),c}var lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},As=Un(lo),pa=p({},lo,{view:0,detail:0}),Gf=Un(pa),ma,ku,ks,Mu=p({},pa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ga,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ks&&(ks&&a.type==="mousemove"?(ma=a.screenX-ks.screenX,ku=a.screenY-ks.screenY):ku=ma=0,ks=a),ma)},movementY:function(a){return"movementY"in a?a.movementY:ku}}),Yf=Un(Mu),nc=p({},Mu,{dataTransfer:0}),og=Un(nc),ag=p({},pa,{relatedTarget:0}),rc=Un(ag),Kf=p({},lo,{animationName:0,elapsedTime:0,pseudoElement:0}),lg=Un(Kf),Du=p({},lo,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),cg=Un(Du),ug=p({},lo,{data:0}),Ms=Un(ug),hg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pg(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=dg[a])?!!c[a]:!1}function ga(){return pg}var hr=p({},pa,{key:function(a){if(a.key){var c=hg[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=ec(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?fg[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ga,charCode:function(a){return a.type==="keypress"?ec(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?ec(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),mg=Un(hr),gg=p({},Mu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),co=Un(gg),y=p({},pa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ga}),x=Un(y),A=p({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),I=Un(A),K=p({},Mu,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),et=Un(K),pt=p({},lo,{newState:0,oldState:0}),zt=Un(pt),en=[9,13,27,32],le=fi&&"CompositionEvent"in window,Ne=null;fi&&"documentMode"in document&&(Ne=document.documentMode);var di=fi&&"TextEvent"in window&&!Ne,Ds=fi&&(!le||Ne&&8<Ne&&11>=Ne),Hi=" ",$i=!1;function ic(a,c){switch(a){case"keyup":return en.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ou(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ru=!1;function Tz(a,c){switch(a){case"compositionend":return Ou(c);case"keypress":return c.which!==32?null:($i=!0,Hi);case"textInput":return a=c.data,a===Hi&&$i?null:a;default:return null}}function Sz(a,c){if(Ru)return a==="compositionend"||!le&&ic(a,c)?(a=Wf(),tc=qf=Cs=null,Ru=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Ds&&c.locale!=="ko"?null:c.data;default:return null}}var wz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ZA(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!wz[a.type]:c==="textarea"}function tk(a,c,f,m){fa?Es?Es.push(m):Es=[m]:fa=m,c=sy(c,"onChange"),0<c.length&&(f=new As("onChange","change",null,f,m),a.push({event:f,listeners:c}))}var Xf=null,Qf=null;function xz(a){LD(a,0)}function yg(a){var c=zr(a);if(Xl(c))return a}function ek(a,c){if(a==="change")return c}var nk=!1;if(fi){var j_;if(fi){var F_="oninput"in document;if(!F_){var rk=document.createElement("div");rk.setAttribute("oninput","return;"),F_=typeof rk.oninput=="function"}j_=F_}else j_=!1;nk=j_&&(!document.documentMode||9<document.documentMode)}function ik(){Xf&&(Xf.detachEvent("onpropertychange",sk),Qf=Xf=null)}function sk(a){if(a.propertyName==="value"&&yg(Qf)){var c=[];tk(c,Qf,a,hi(a)),da(xz,c)}}function Ez(a,c,f){a==="focusin"?(ik(),Xf=c,Qf=f,Xf.attachEvent("onpropertychange",sk)):a==="focusout"&&ik()}function Cz(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return yg(Qf)}function Az(a,c){if(a==="click")return yg(c)}function kz(a,c){if(a==="input"||a==="change")return yg(c)}function Mz(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var $r=typeof Object.is=="function"?Object.is:Mz;function Jf(a,c){if($r(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var f=Object.keys(a),m=Object.keys(c);if(f.length!==m.length)return!1;for(m=0;m<f.length;m++){var b=f[m];if(!ln.call(c,b)||!$r(a[b],c[b]))return!1}return!0}function ok(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function ak(a,c){var f=ok(a);a=0;for(var m;f;){if(f.nodeType===3){if(m=a+f.textContent.length,a<=c&&m>=c)return{node:f,offset:c-a};a=m}t:{for(;f;){if(f.nextSibling){f=f.nextSibling;break t}f=f.parentNode}f=void 0}f=ok(f)}}function lk(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?lk(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function ck(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var c=xs(a.document);c instanceof a.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)a=c.contentWindow;else break;c=xs(a.document)}return c}function B_(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}var Dz=fi&&"documentMode"in document&&11>=document.documentMode,Iu=null,U_=null,Zf=null,z_=!1;function uk(a,c,f){var m=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;z_||Iu==null||Iu!==xs(m)||(m=Iu,"selectionStart"in m&&B_(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Zf&&Jf(Zf,m)||(Zf=m,m=sy(U_,"onSelect"),0<m.length&&(c=new As("onSelect","select",null,c,f),a.push({event:c,listeners:m}),c.target=Iu)))}function sc(a,c){var f={};return f[a.toLowerCase()]=c.toLowerCase(),f["Webkit"+a]="webkit"+c,f["Moz"+a]="moz"+c,f}var Pu={animationend:sc("Animation","AnimationEnd"),animationiteration:sc("Animation","AnimationIteration"),animationstart:sc("Animation","AnimationStart"),transitionrun:sc("Transition","TransitionRun"),transitionstart:sc("Transition","TransitionStart"),transitioncancel:sc("Transition","TransitionCancel"),transitionend:sc("Transition","TransitionEnd")},H_={},hk={};fi&&(hk=document.createElement("div").style,"AnimationEvent"in window||(delete Pu.animationend.animation,delete Pu.animationiteration.animation,delete Pu.animationstart.animation),"TransitionEvent"in window||delete Pu.transitionend.transition);function oc(a){if(H_[a])return H_[a];if(!Pu[a])return a;var c=Pu[a],f;for(f in c)if(c.hasOwnProperty(f)&&f in hk)return H_[a]=c[f];return a}var fk=oc("animationend"),dk=oc("animationiteration"),pk=oc("animationstart"),Oz=oc("transitionrun"),Rz=oc("transitionstart"),Iz=oc("transitioncancel"),mk=oc("transitionend"),gk=new Map,$_="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");$_.push("scrollEnd");function qi(a,c){gk.set(a,c),Ss(c,[a])}var vg=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},pi=[],Nu=0,q_=0;function bg(){for(var a=Nu,c=q_=Nu=0;c<a;){var f=pi[c];pi[c++]=null;var m=pi[c];pi[c++]=null;var b=pi[c];pi[c++]=null;var _=pi[c];if(pi[c++]=null,m!==null&&b!==null){var C=m.pending;C===null?b.next=b:(b.next=C.next,C.next=b),m.pending=b}_!==0&&yk(f,b,_)}}function _g(a,c,f,m){pi[Nu++]=a,pi[Nu++]=c,pi[Nu++]=f,pi[Nu++]=m,q_|=m,a.lanes|=m,a=a.alternate,a!==null&&(a.lanes|=m)}function W_(a,c,f,m){return _g(a,c,f,m),Tg(a)}function ac(a,c){return _g(a,null,null,c),Tg(a)}function yk(a,c,f){a.lanes|=f;var m=a.alternate;m!==null&&(m.lanes|=f);for(var b=!1,_=a.return;_!==null;)_.childLanes|=f,m=_.alternate,m!==null&&(m.childLanes|=f),_.tag===22&&(a=_.stateNode,a===null||a._visibility&1||(b=!0)),a=_,_=_.return;return a.tag===3?(_=a.stateNode,b&&c!==null&&(b=31-tn(f),a=_.hiddenUpdates,m=a[b],m===null?a[b]=[c]:m.push(c),c.lane=f|536870912),_):null}function Tg(a){if(50<Td)throw Td=0,eS=null,Error(r(185));for(var c=a.return;c!==null;)a=c,c=a.return;return a.tag===3?a.stateNode:null}var Lu={};function Pz(a,c,f,m){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qr(a,c,f,m){return new Pz(a,c,f,m)}function G_(a){return a=a.prototype,!(!a||!a.isReactComponent)}function uo(a,c){var f=a.alternate;return f===null?(f=qr(a.tag,c,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=c,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&65011712,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,c=a.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f.refCleanup=a.refCleanup,f}function vk(a,c){a.flags&=65011714;var f=a.alternate;return f===null?(a.childLanes=0,a.lanes=c,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=f.childLanes,a.lanes=f.lanes,a.child=f.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=f.memoizedProps,a.memoizedState=f.memoizedState,a.updateQueue=f.updateQueue,a.type=f.type,c=f.dependencies,a.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),a}function Sg(a,c,f,m,b,_){var C=0;if(m=a,typeof a=="function")G_(a)&&(C=1);else if(typeof a=="string")C=F6(a,f,mt.current)?26:a==="html"||a==="head"||a==="body"?27:5;else t:switch(a){case R:return a=qr(31,f,c,b),a.elementType=R,a.lanes=_,a;case S:return lc(f.children,b,_,c);case w:C=8,b|=24;break;case E:return a=qr(12,f,c,b|2),a.elementType=E,a.lanes=_,a;case N:return a=qr(13,f,c,b),a.elementType=N,a.lanes=_,a;case q:return a=qr(19,f,c,b),a.elementType=q,a.lanes=_,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case P:C=10;break t;case D:C=9;break t;case V:C=11;break t;case M:C=14;break t;case k:C=16,m=null;break t}C=29,f=Error(r(130,a===null?"null":typeof a,"")),m=null}return c=qr(C,f,c,b),c.elementType=a,c.type=m,c.lanes=_,c}function lc(a,c,f,m){return a=qr(7,a,m,c),a.lanes=f,a}function Y_(a,c,f){return a=qr(6,a,null,c),a.lanes=f,a}function bk(a){var c=qr(18,null,null,0);return c.stateNode=a,c}function K_(a,c,f){return c=qr(4,a.children!==null?a.children:[],a.key,c),c.lanes=f,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}var _k=new WeakMap;function mi(a,c){if(typeof a=="object"&&a!==null){var f=_k.get(a);return f!==void 0?f:(c={value:a,source:c,stack:Df(c)},_k.set(a,c),c)}return{value:a,source:c,stack:Df(c)}}var Vu=[],ju=0,wg=null,td=0,gi=[],yi=0,ya=null,Os=1,Rs="";function ho(a,c){Vu[ju++]=td,Vu[ju++]=wg,wg=a,td=c}function Tk(a,c,f){gi[yi++]=Os,gi[yi++]=Rs,gi[yi++]=ya,ya=a;var m=Os;a=Rs;var b=32-tn(m)-1;m&=~(1<<b),f+=1;var _=32-tn(c)+b;if(30<_){var C=b-b%5;_=(m&(1<<C)-1).toString(32),m>>=C,b-=C,Os=1<<32-tn(c)+b|f<<b|m,Rs=_+a}else Os=1<<_|f<<b|m,Rs=a}function X_(a){a.return!==null&&(ho(a,1),Tk(a,1,0))}function Q_(a){for(;a===wg;)wg=Vu[--ju],Vu[ju]=null,td=Vu[--ju],Vu[ju]=null;for(;a===ya;)ya=gi[--yi],gi[yi]=null,Rs=gi[--yi],gi[yi]=null,Os=gi[--yi],gi[yi]=null}function Sk(a,c){gi[yi++]=Os,gi[yi++]=Rs,gi[yi++]=ya,Os=c.id,Rs=c.overflow,ya=a}var zn=null,Re=null,ee=!1,va=null,vi=!1,J_=Error(r(519));function ba(a){var c=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ed(mi(c,a)),J_}function wk(a){var c=a.stateNode,f=a.type,m=a.memoizedProps;switch(c[un]=a,c[Dn]=m,f){case"dialog":Kt("cancel",c),Kt("close",c);break;case"iframe":case"object":case"embed":Kt("load",c);break;case"video":case"audio":for(f=0;f<wd.length;f++)Kt(wd[f],c);break;case"source":Kt("error",c);break;case"img":case"image":case"link":Kt("error",c),Kt("load",c);break;case"details":Kt("toggle",c);break;case"input":Kt("invalid",c),ng(c,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Kt("invalid",c);break;case"textarea":Kt("invalid",c),ua(c,m.value,m.defaultValue,m.children)}f=m.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||m.suppressHydrationWarning===!0||BD(c.textContent,f)?(m.popover!=null&&(Kt("beforetoggle",c),Kt("toggle",c)),m.onScroll!=null&&Kt("scroll",c),m.onScrollEnd!=null&&Kt("scrollend",c),m.onClick!=null&&(c.onclick=Bi),c=!0):c=!1,c||ba(a,!0)}function xk(a){for(zn=a.return;zn;)switch(zn.tag){case 5:case 31:case 13:vi=!1;return;case 27:case 3:vi=!0;return;default:zn=zn.return}}function Fu(a){if(a!==zn)return!1;if(!ee)return xk(a),ee=!0,!1;var c=a.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=a.type,f=!(f!=="form"&&f!=="button")||gS(a.type,a.memoizedProps)),f=!f),f&&Re&&ba(a),xk(a),c===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));Re=KD(a)}else if(c===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));Re=KD(a)}else c===27?(c=Re,Ia(a.type)?(a=TS,TS=null,Re=a):Re=c):Re=zn?_i(a.stateNode.nextSibling):null;return!0}function cc(){Re=zn=null,ee=!1}function Z_(){var a=va;return a!==null&&(Rr===null?Rr=a:Rr.push.apply(Rr,a),va=null),a}function ed(a){va===null?va=[a]:va.push(a)}var tT=$(null),uc=null,fo=null;function _a(a,c,f){dt(tT,c._currentValue),c._currentValue=f}function po(a){a._currentValue=tT.current,ot(tT)}function eT(a,c,f){for(;a!==null;){var m=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),a===f)break;a=a.return}}function nT(a,c,f,m){var b=a.child;for(b!==null&&(b.return=a);b!==null;){var _=b.dependencies;if(_!==null){var C=b.child;_=_.firstContext;t:for(;_!==null;){var O=_;_=b;for(var z=0;z<c.length;z++)if(O.context===c[z]){_.lanes|=f,O=_.alternate,O!==null&&(O.lanes|=f),eT(_.return,f,a),m||(C=null);break t}_=O.next}}else if(b.tag===18){if(C=b.return,C===null)throw Error(r(341));C.lanes|=f,_=C.alternate,_!==null&&(_.lanes|=f),eT(C,f,a),C=null}else C=b.child;if(C!==null)C.return=b;else for(C=b;C!==null;){if(C===a){C=null;break}if(b=C.sibling,b!==null){b.return=C.return,C=b;break}C=C.return}b=C}}function Bu(a,c,f,m){a=null;for(var b=c,_=!1;b!==null;){if(!_){if((b.flags&524288)!==0)_=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var C=b.alternate;if(C===null)throw Error(r(387));if(C=C.memoizedProps,C!==null){var O=b.type;$r(b.pendingProps.value,C.value)||(a!==null?a.push(O):a=[O])}}else if(b===Ut.current){if(C=b.alternate,C===null)throw Error(r(387));C.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(a!==null?a.push(kd):a=[kd])}b=b.return}a!==null&&nT(c,a,f,m),c.flags|=262144}function xg(a){for(a=a.firstContext;a!==null;){if(!$r(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function hc(a){uc=a,fo=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Hn(a){return Ek(uc,a)}function Eg(a,c){return uc===null&&hc(a),Ek(a,c)}function Ek(a,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},fo===null){if(a===null)throw Error(r(308));fo=c,a.dependencies={lanes:0,firstContext:c},a.flags|=524288}else fo=fo.next=c;return f}var Nz=typeof AbortController<"u"?AbortController:function(){var a=[],c=this.signal={aborted:!1,addEventListener:function(f,m){a.push(m)}};this.abort=function(){c.aborted=!0,a.forEach(function(f){return f()})}},Lz=n.unstable_scheduleCallback,Vz=n.unstable_NormalPriority,dn={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function rT(){return{controller:new Nz,data:new Map,refCount:0}}function nd(a){a.refCount--,a.refCount===0&&Lz(Vz,function(){a.controller.abort()})}var rd=null,iT=0,Uu=0,zu=null;function jz(a,c){if(rd===null){var f=rd=[];iT=0,Uu=aS(),zu={status:"pending",value:void 0,then:function(m){f.push(m)}}}return iT++,c.then(Ck,Ck),c}function Ck(){if(--iT===0&&rd!==null){zu!==null&&(zu.status="fulfilled");var a=rd;rd=null,Uu=0,zu=null;for(var c=0;c<a.length;c++)(0,a[c])()}}function Fz(a,c){var f=[],m={status:"pending",value:null,reason:null,then:function(b){f.push(b)}};return a.then(function(){m.status="fulfilled",m.value=c;for(var b=0;b<f.length;b++)(0,f[b])(c)},function(b){for(m.status="rejected",m.reason=b,b=0;b<f.length;b++)(0,f[b])(void 0)}),m}var Ak=J.S;J.S=function(a,c){uD=ur(),typeof c=="object"&&c!==null&&typeof c.then=="function"&&jz(a,c),Ak!==null&&Ak(a,c)};var fc=$(null);function sT(){var a=fc.current;return a!==null?a:Ce.pooledCache}function Cg(a,c){c===null?dt(fc,fc.current):dt(fc,c.pool)}function kk(){var a=sT();return a===null?null:{parent:dn._currentValue,pool:a}}var Hu=Error(r(460)),oT=Error(r(474)),Ag=Error(r(542)),kg={then:function(){}};function Mk(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Dk(a,c,f){switch(f=a[f],f===void 0?a.push(c):f!==c&&(c.then(Bi,Bi),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,Rk(a),a;default:if(typeof c.status=="string")c.then(Bi,Bi);else{if(a=Ce,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=c,a.status="pending",a.then(function(m){if(c.status==="pending"){var b=c;b.status="fulfilled",b.value=m}},function(m){if(c.status==="pending"){var b=c;b.status="rejected",b.reason=m}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,Rk(a),a}throw pc=c,Hu}}function dc(a){try{var c=a._init;return c(a._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(pc=f,Hu):f}}var pc=null;function Ok(){if(pc===null)throw Error(r(459));var a=pc;return pc=null,a}function Rk(a){if(a===Hu||a===Ag)throw Error(r(483))}var $u=null,id=0;function Mg(a){var c=id;return id+=1,$u===null&&($u=[]),Dk($u,a,c)}function sd(a,c){c=c.props.ref,a.ref=c!==void 0?c:null}function Dg(a,c){throw c.$$typeof===g?Error(r(525)):(a=Object.prototype.toString.call(c),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a)))}function Ik(a){function c(Y,G){if(a){var X=Y.deletions;X===null?(Y.deletions=[G],Y.flags|=16):X.push(G)}}function f(Y,G){if(!a)return null;for(;G!==null;)c(Y,G),G=G.sibling;return null}function m(Y){for(var G=new Map;Y!==null;)Y.key!==null?G.set(Y.key,Y):G.set(Y.index,Y),Y=Y.sibling;return G}function b(Y,G){return Y=uo(Y,G),Y.index=0,Y.sibling=null,Y}function _(Y,G,X){return Y.index=X,a?(X=Y.alternate,X!==null?(X=X.index,X<G?(Y.flags|=67108866,G):X):(Y.flags|=67108866,G)):(Y.flags|=1048576,G)}function C(Y){return a&&Y.alternate===null&&(Y.flags|=67108866),Y}function O(Y,G,X,at){return G===null||G.tag!==6?(G=Y_(X,Y.mode,at),G.return=Y,G):(G=b(G,X),G.return=Y,G)}function z(Y,G,X,at){var kt=X.type;return kt===S?rt(Y,G,X.props.children,at,X.key):G!==null&&(G.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===k&&dc(kt)===G.type)?(G=b(G,X.props),sd(G,X),G.return=Y,G):(G=Sg(X.type,X.key,X.props,null,Y.mode,at),sd(G,X),G.return=Y,G)}function Q(Y,G,X,at){return G===null||G.tag!==4||G.stateNode.containerInfo!==X.containerInfo||G.stateNode.implementation!==X.implementation?(G=K_(X,Y.mode,at),G.return=Y,G):(G=b(G,X.children||[]),G.return=Y,G)}function rt(Y,G,X,at,kt){return G===null||G.tag!==7?(G=lc(X,Y.mode,at,kt),G.return=Y,G):(G=b(G,X),G.return=Y,G)}function lt(Y,G,X){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Y_(""+G,Y.mode,X),G.return=Y,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case v:return X=Sg(G.type,G.key,G.props,null,Y.mode,X),sd(X,G),X.return=Y,X;case T:return G=K_(G,Y.mode,X),G.return=Y,G;case k:return G=dc(G),lt(Y,G,X)}if(xt(G)||H(G))return G=lc(G,Y.mode,X,null),G.return=Y,G;if(typeof G.then=="function")return lt(Y,Mg(G),X);if(G.$$typeof===P)return lt(Y,Eg(Y,G),X);Dg(Y,G)}return null}function Z(Y,G,X,at){var kt=G!==null?G.key:null;if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return kt!==null?null:O(Y,G,""+X,at);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case v:return X.key===kt?z(Y,G,X,at):null;case T:return X.key===kt?Q(Y,G,X,at):null;case k:return X=dc(X),Z(Y,G,X,at)}if(xt(X)||H(X))return kt!==null?null:rt(Y,G,X,at,null);if(typeof X.then=="function")return Z(Y,G,Mg(X),at);if(X.$$typeof===P)return Z(Y,G,Eg(Y,X),at);Dg(Y,X)}return null}function nt(Y,G,X,at,kt){if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return Y=Y.get(X)||null,O(G,Y,""+at,kt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case v:return Y=Y.get(at.key===null?X:at.key)||null,z(G,Y,at,kt);case T:return Y=Y.get(at.key===null?X:at.key)||null,Q(G,Y,at,kt);case k:return at=dc(at),nt(Y,G,X,at,kt)}if(xt(at)||H(at))return Y=Y.get(X)||null,rt(G,Y,at,kt,null);if(typeof at.then=="function")return nt(Y,G,X,Mg(at),kt);if(at.$$typeof===P)return nt(Y,G,X,Eg(G,at),kt);Dg(G,at)}return null}function Tt(Y,G,X,at){for(var kt=null,oe=null,wt=G,$t=G=0,Qt=null;wt!==null&&$t<X.length;$t++){wt.index>$t?(Qt=wt,wt=null):Qt=wt.sibling;var ae=Z(Y,wt,X[$t],at);if(ae===null){wt===null&&(wt=Qt);break}a&&wt&&ae.alternate===null&&c(Y,wt),G=_(ae,G,$t),oe===null?kt=ae:oe.sibling=ae,oe=ae,wt=Qt}if($t===X.length)return f(Y,wt),ee&&ho(Y,$t),kt;if(wt===null){for(;$t<X.length;$t++)wt=lt(Y,X[$t],at),wt!==null&&(G=_(wt,G,$t),oe===null?kt=wt:oe.sibling=wt,oe=wt);return ee&&ho(Y,$t),kt}for(wt=m(wt);$t<X.length;$t++)Qt=nt(wt,Y,$t,X[$t],at),Qt!==null&&(a&&Qt.alternate!==null&&wt.delete(Qt.key===null?$t:Qt.key),G=_(Qt,G,$t),oe===null?kt=Qt:oe.sibling=Qt,oe=Qt);return a&&wt.forEach(function(ja){return c(Y,ja)}),ee&&ho(Y,$t),kt}function Pt(Y,G,X,at){if(X==null)throw Error(r(151));for(var kt=null,oe=null,wt=G,$t=G=0,Qt=null,ae=X.next();wt!==null&&!ae.done;$t++,ae=X.next()){wt.index>$t?(Qt=wt,wt=null):Qt=wt.sibling;var ja=Z(Y,wt,ae.value,at);if(ja===null){wt===null&&(wt=Qt);break}a&&wt&&ja.alternate===null&&c(Y,wt),G=_(ja,G,$t),oe===null?kt=ja:oe.sibling=ja,oe=ja,wt=Qt}if(ae.done)return f(Y,wt),ee&&ho(Y,$t),kt;if(wt===null){for(;!ae.done;$t++,ae=X.next())ae=lt(Y,ae.value,at),ae!==null&&(G=_(ae,G,$t),oe===null?kt=ae:oe.sibling=ae,oe=ae);return ee&&ho(Y,$t),kt}for(wt=m(wt);!ae.done;$t++,ae=X.next())ae=nt(wt,Y,$t,ae.value,at),ae!==null&&(a&&ae.alternate!==null&&wt.delete(ae.key===null?$t:ae.key),G=_(ae,G,$t),oe===null?kt=ae:oe.sibling=ae,oe=ae);return a&&wt.forEach(function(X6){return c(Y,X6)}),ee&&ho(Y,$t),kt}function we(Y,G,X,at){if(typeof X=="object"&&X!==null&&X.type===S&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case v:t:{for(var kt=X.key;G!==null;){if(G.key===kt){if(kt=X.type,kt===S){if(G.tag===7){f(Y,G.sibling),at=b(G,X.props.children),at.return=Y,Y=at;break t}}else if(G.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===k&&dc(kt)===G.type){f(Y,G.sibling),at=b(G,X.props),sd(at,X),at.return=Y,Y=at;break t}f(Y,G);break}else c(Y,G);G=G.sibling}X.type===S?(at=lc(X.props.children,Y.mode,at,X.key),at.return=Y,Y=at):(at=Sg(X.type,X.key,X.props,null,Y.mode,at),sd(at,X),at.return=Y,Y=at)}return C(Y);case T:t:{for(kt=X.key;G!==null;){if(G.key===kt)if(G.tag===4&&G.stateNode.containerInfo===X.containerInfo&&G.stateNode.implementation===X.implementation){f(Y,G.sibling),at=b(G,X.children||[]),at.return=Y,Y=at;break t}else{f(Y,G);break}else c(Y,G);G=G.sibling}at=K_(X,Y.mode,at),at.return=Y,Y=at}return C(Y);case k:return X=dc(X),we(Y,G,X,at)}if(xt(X))return Tt(Y,G,X,at);if(H(X)){if(kt=H(X),typeof kt!="function")throw Error(r(150));return X=kt.call(X),Pt(Y,G,X,at)}if(typeof X.then=="function")return we(Y,G,Mg(X),at);if(X.$$typeof===P)return we(Y,G,Eg(Y,X),at);Dg(Y,X)}return typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint"?(X=""+X,G!==null&&G.tag===6?(f(Y,G.sibling),at=b(G,X),at.return=Y,Y=at):(f(Y,G),at=Y_(X,Y.mode,at),at.return=Y,Y=at),C(Y)):f(Y,G)}return function(Y,G,X,at){try{id=0;var kt=we(Y,G,X,at);return $u=null,kt}catch(wt){if(wt===Hu||wt===Ag)throw wt;var oe=qr(29,wt,null,Y.mode);return oe.lanes=at,oe.return=Y,oe}}}var mc=Ik(!0),Pk=Ik(!1),Ta=!1;function aT(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lT(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Sa(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function wa(a,c,f){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(ce&2)!==0){var b=m.pending;return b===null?c.next=c:(c.next=b.next,b.next=c),m.pending=c,c=Tg(a),yk(a,null,f),c}return _g(a,m,c,f),Tg(a)}function od(a,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var m=c.lanes;m&=a.pendingLanes,f|=m,c.lanes=f,If(a,f)}}function cT(a,c){var f=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,f===m)){var b=null,_=null;if(f=f.firstBaseUpdate,f!==null){do{var C={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};_===null?b=_=C:_=_.next=C,f=f.next}while(f!==null);_===null?b=_=c:_=_.next=c}else b=_=c;f={baseState:m.baseState,firstBaseUpdate:b,lastBaseUpdate:_,shared:m.shared,callbacks:m.callbacks},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=c:a.next=c,f.lastBaseUpdate=c}var uT=!1;function ad(){if(uT){var a=zu;if(a!==null)throw a}}function ld(a,c,f,m){uT=!1;var b=a.updateQueue;Ta=!1;var _=b.firstBaseUpdate,C=b.lastBaseUpdate,O=b.shared.pending;if(O!==null){b.shared.pending=null;var z=O,Q=z.next;z.next=null,C===null?_=Q:C.next=Q,C=z;var rt=a.alternate;rt!==null&&(rt=rt.updateQueue,O=rt.lastBaseUpdate,O!==C&&(O===null?rt.firstBaseUpdate=Q:O.next=Q,rt.lastBaseUpdate=z))}if(_!==null){var lt=b.baseState;C=0,rt=Q=z=null,O=_;do{var Z=O.lane&-536870913,nt=Z!==O.lane;if(nt?(Xt&Z)===Z:(m&Z)===Z){Z!==0&&Z===Uu&&(uT=!0),rt!==null&&(rt=rt.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});t:{var Tt=a,Pt=O;Z=c;var we=f;switch(Pt.tag){case 1:if(Tt=Pt.payload,typeof Tt=="function"){lt=Tt.call(we,lt,Z);break t}lt=Tt;break t;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=Pt.payload,Z=typeof Tt=="function"?Tt.call(we,lt,Z):Tt,Z==null)break t;lt=p({},lt,Z);break t;case 2:Ta=!0}}Z=O.callback,Z!==null&&(a.flags|=64,nt&&(a.flags|=8192),nt=b.callbacks,nt===null?b.callbacks=[Z]:nt.push(Z))}else nt={lane:Z,tag:O.tag,payload:O.payload,callback:O.callback,next:null},rt===null?(Q=rt=nt,z=lt):rt=rt.next=nt,C|=Z;if(O=O.next,O===null){if(O=b.shared.pending,O===null)break;nt=O,O=nt.next,nt.next=null,b.lastBaseUpdate=nt,b.shared.pending=null}}while(!0);rt===null&&(z=lt),b.baseState=z,b.firstBaseUpdate=Q,b.lastBaseUpdate=rt,_===null&&(b.shared.lanes=0),ka|=C,a.lanes=C,a.memoizedState=lt}}function Nk(a,c){if(typeof a!="function")throw Error(r(191,a));a.call(c)}function Lk(a,c){var f=a.callbacks;if(f!==null)for(a.callbacks=null,a=0;a<f.length;a++)Nk(f[a],c)}var qu=$(null),Og=$(0);function Vk(a,c){a=wo,dt(Og,a),dt(qu,c),wo=a|c.baseLanes}function hT(){dt(Og,wo),dt(qu,qu.current)}function fT(){wo=Og.current,ot(qu),ot(Og)}var Wr=$(null),bi=null;function xa(a){var c=a.alternate;dt(nn,nn.current&1),dt(Wr,a),bi===null&&(c===null||qu.current!==null||c.memoizedState!==null)&&(bi=a)}function dT(a){dt(nn,nn.current),dt(Wr,a),bi===null&&(bi=a)}function jk(a){a.tag===22?(dt(nn,nn.current),dt(Wr,a),bi===null&&(bi=a)):Ea()}function Ea(){dt(nn,nn.current),dt(Wr,Wr.current)}function Gr(a){ot(Wr),bi===a&&(bi=null),ot(nn)}var nn=$(0);function Rg(a){for(var c=a;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||bS(f)||_S(f)))return c}else if(c.tag===19&&(c.memoizedProps.revealOrder==="forwards"||c.memoizedProps.revealOrder==="backwards"||c.memoizedProps.revealOrder==="unstable_legacy-backwards"||c.memoizedProps.revealOrder==="together")){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var mo=0,Ht=null,Te=null,pn=null,Ig=!1,Wu=!1,gc=!1,Pg=0,cd=0,Gu=null,Bz=0;function qe(){throw Error(r(321))}function pT(a,c){if(c===null)return!1;for(var f=0;f<c.length&&f<a.length;f++)if(!$r(a[f],c[f]))return!1;return!0}function mT(a,c,f,m,b,_){return mo=_,Ht=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,J.H=a===null||a.memoizedState===null?TM:DT,gc=!1,_=f(m,b),gc=!1,Wu&&(_=Bk(c,f,m,b)),Fk(a),_}function Fk(a){J.H=fd;var c=Te!==null&&Te.next!==null;if(mo=0,pn=Te=Ht=null,Ig=!1,cd=0,Gu=null,c)throw Error(r(300));a===null||mn||(a=a.dependencies,a!==null&&xg(a)&&(mn=!0))}function Bk(a,c,f,m){Ht=a;var b=0;do{if(Wu&&(Gu=null),cd=0,Wu=!1,25<=b)throw Error(r(301));if(b+=1,pn=Te=null,a.updateQueue!=null){var _=a.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}J.H=SM,_=c(f,m)}while(Wu);return _}function Uz(){var a=J.H,c=a.useState()[0];return c=typeof c.then=="function"?ud(c):c,a=a.useState()[0],(Te!==null?Te.memoizedState:null)!==a&&(Ht.flags|=1024),c}function gT(){var a=Pg!==0;return Pg=0,a}function yT(a,c,f){c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~f}function vT(a){if(Ig){for(a=a.memoizedState;a!==null;){var c=a.queue;c!==null&&(c.pending=null),a=a.next}Ig=!1}mo=0,pn=Te=Ht=null,Wu=!1,cd=Pg=0,Gu=null}function fr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Ht.memoizedState=pn=a:pn=pn.next=a,pn}function rn(){if(Te===null){var a=Ht.alternate;a=a!==null?a.memoizedState:null}else a=Te.next;var c=pn===null?Ht.memoizedState:pn.next;if(c!==null)pn=c,Te=a;else{if(a===null)throw Ht.alternate===null?Error(r(467)):Error(r(310));Te=a,a={memoizedState:Te.memoizedState,baseState:Te.baseState,baseQueue:Te.baseQueue,queue:Te.queue,next:null},pn===null?Ht.memoizedState=pn=a:pn=pn.next=a}return pn}function Ng(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ud(a){var c=cd;return cd+=1,Gu===null&&(Gu=[]),a=Dk(Gu,a,c),c=Ht,(pn===null?c.memoizedState:pn.next)===null&&(c=c.alternate,J.H=c===null||c.memoizedState===null?TM:DT),a}function Lg(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return ud(a);if(a.$$typeof===P)return Hn(a)}throw Error(r(438,String(a)))}function bT(a){var c=null,f=Ht.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var m=Ht.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(c={data:m.data.map(function(b){return b.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=Ng(),Ht.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(a),m=0;m<a;m++)f[m]=F;return c.index++,f}function go(a,c){return typeof c=="function"?c(a):c}function Vg(a){var c=rn();return _T(c,Te,a)}function _T(a,c,f){var m=a.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=f;var b=a.baseQueue,_=m.pending;if(_!==null){if(b!==null){var C=b.next;b.next=_.next,_.next=C}c.baseQueue=b=_,m.pending=null}if(_=a.baseState,b===null)a.memoizedState=_;else{c=b.next;var O=C=null,z=null,Q=c,rt=!1;do{var lt=Q.lane&-536870913;if(lt!==Q.lane?(Xt&lt)===lt:(mo&lt)===lt){var Z=Q.revertLane;if(Z===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),lt===Uu&&(rt=!0);else if((mo&Z)===Z){Q=Q.next,Z===Uu&&(rt=!0);continue}else lt={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},z===null?(O=z=lt,C=_):z=z.next=lt,Ht.lanes|=Z,ka|=Z;lt=Q.action,gc&&f(_,lt),_=Q.hasEagerState?Q.eagerState:f(_,lt)}else Z={lane:lt,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},z===null?(O=z=Z,C=_):z=z.next=Z,Ht.lanes|=lt,ka|=lt;Q=Q.next}while(Q!==null&&Q!==c);if(z===null?C=_:z.next=O,!$r(_,a.memoizedState)&&(mn=!0,rt&&(f=zu,f!==null)))throw f;a.memoizedState=_,a.baseState=C,a.baseQueue=z,m.lastRenderedState=_}return b===null&&(m.lanes=0),[a.memoizedState,m.dispatch]}function TT(a){var c=rn(),f=c.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=a;var m=f.dispatch,b=f.pending,_=c.memoizedState;if(b!==null){f.pending=null;var C=b=b.next;do _=a(_,C.action),C=C.next;while(C!==b);$r(_,c.memoizedState)||(mn=!0),c.memoizedState=_,c.baseQueue===null&&(c.baseState=_),f.lastRenderedState=_}return[_,m]}function Uk(a,c,f){var m=Ht,b=rn(),_=ee;if(_){if(f===void 0)throw Error(r(407));f=f()}else f=c();var C=!$r((Te||b).memoizedState,f);if(C&&(b.memoizedState=f,mn=!0),b=b.queue,xT($k.bind(null,m,b,a),[a]),b.getSnapshot!==c||C||pn!==null&&pn.memoizedState.tag&1){if(m.flags|=2048,Yu(9,{destroy:void 0},Hk.bind(null,m,b,f,c),null),Ce===null)throw Error(r(349));_||(mo&127)!==0||zk(m,c,f)}return f}function zk(a,c,f){a.flags|=16384,a={getSnapshot:c,value:f},c=Ht.updateQueue,c===null?(c=Ng(),Ht.updateQueue=c,c.stores=[a]):(f=c.stores,f===null?c.stores=[a]:f.push(a))}function Hk(a,c,f,m){c.value=f,c.getSnapshot=m,qk(c)&&Wk(a)}function $k(a,c,f){return f(function(){qk(c)&&Wk(a)})}function qk(a){var c=a.getSnapshot;a=a.value;try{var f=c();return!$r(a,f)}catch{return!0}}function Wk(a){var c=ac(a,2);c!==null&&Ir(c,a,2)}function ST(a){var c=fr();if(typeof a=="function"){var f=a;if(a=f(),gc){ci(!0);try{f()}finally{ci(!1)}}}return c.memoizedState=c.baseState=a,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:a},c}function Gk(a,c,f,m){return a.baseState=f,_T(a,Te,typeof m=="function"?m:go)}function zz(a,c,f,m,b){if(Bg(a))throw Error(r(485));if(a=c.action,a!==null){var _={payload:b,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){_.listeners.push(C)}};J.T!==null?f(!0):_.isTransition=!1,m(_),f=c.pending,f===null?(_.next=c.pending=_,Yk(c,_)):(_.next=f.next,c.pending=f.next=_)}}function Yk(a,c){var f=c.action,m=c.payload,b=a.state;if(c.isTransition){var _=J.T,C={};J.T=C;try{var O=f(b,m),z=J.S;z!==null&&z(C,O),Kk(a,c,O)}catch(Q){wT(a,c,Q)}finally{_!==null&&C.types!==null&&(_.types=C.types),J.T=_}}else try{_=f(b,m),Kk(a,c,_)}catch(Q){wT(a,c,Q)}}function Kk(a,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(m){Xk(a,c,m)},function(m){return wT(a,c,m)}):Xk(a,c,f)}function Xk(a,c,f){c.status="fulfilled",c.value=f,Qk(c),a.state=f,c=a.pending,c!==null&&(f=c.next,f===c?a.pending=null:(f=f.next,c.next=f,Yk(a,f)))}function wT(a,c,f){var m=a.pending;if(a.pending=null,m!==null){m=m.next;do c.status="rejected",c.reason=f,Qk(c),c=c.next;while(c!==m)}a.action=null}function Qk(a){a=a.listeners;for(var c=0;c<a.length;c++)(0,a[c])()}function Jk(a,c){return c}function Zk(a,c){if(ee){var f=Ce.formState;if(f!==null){t:{var m=Ht;if(ee){if(Re){e:{for(var b=Re,_=vi;b.nodeType!==8;){if(!_){b=null;break e}if(b=_i(b.nextSibling),b===null){b=null;break e}}_=b.data,b=_==="F!"||_==="F"?b:null}if(b){Re=_i(b.nextSibling),m=b.data==="F!";break t}}ba(m)}m=!1}m&&(c=f[0])}}return f=fr(),f.memoizedState=f.baseState=c,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jk,lastRenderedState:c},f.queue=m,f=vM.bind(null,Ht,m),m.dispatch=f,m=ST(!1),_=MT.bind(null,Ht,!1,m.queue),m=fr(),b={state:c,dispatch:null,action:a,pending:null},m.queue=b,f=zz.bind(null,Ht,b,_,f),b.dispatch=f,m.memoizedState=a,[c,f,!1]}function tM(a){var c=rn();return eM(c,Te,a)}function eM(a,c,f){if(c=_T(a,c,Jk)[0],a=Vg(go)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var m=ud(c)}catch(C){throw C===Hu?Ag:C}else m=c;c=rn();var b=c.queue,_=b.dispatch;return f!==c.memoizedState&&(Ht.flags|=2048,Yu(9,{destroy:void 0},Hz.bind(null,b,f),null)),[m,_,a]}function Hz(a,c){a.action=c}function nM(a){var c=rn(),f=Te;if(f!==null)return eM(c,f,a);rn(),c=c.memoizedState,f=rn();var m=f.queue.dispatch;return f.memoizedState=a,[c,m,!1]}function Yu(a,c,f,m){return a={tag:a,create:f,deps:m,inst:c,next:null},c=Ht.updateQueue,c===null&&(c=Ng(),Ht.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=a.next=a:(m=f.next,f.next=a,a.next=m,c.lastEffect=a),a}function rM(){return rn().memoizedState}function jg(a,c,f,m){var b=fr();Ht.flags|=a,b.memoizedState=Yu(1|c,{destroy:void 0},f,m===void 0?null:m)}function Fg(a,c,f,m){var b=rn();m=m===void 0?null:m;var _=b.memoizedState.inst;Te!==null&&m!==null&&pT(m,Te.memoizedState.deps)?b.memoizedState=Yu(c,_,f,m):(Ht.flags|=a,b.memoizedState=Yu(1|c,_,f,m))}function iM(a,c){jg(8390656,8,a,c)}function xT(a,c){Fg(2048,8,a,c)}function $z(a){Ht.flags|=4;var c=Ht.updateQueue;if(c===null)c=Ng(),Ht.updateQueue=c,c.events=[a];else{var f=c.events;f===null?c.events=[a]:f.push(a)}}function sM(a){var c=rn().memoizedState;return $z({ref:c,nextImpl:a}),function(){if((ce&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}function oM(a,c){return Fg(4,2,a,c)}function aM(a,c){return Fg(4,4,a,c)}function lM(a,c){if(typeof c=="function"){a=a();var f=c(a);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function cM(a,c,f){f=f!=null?f.concat([a]):null,Fg(4,4,lM.bind(null,c,a),f)}function ET(){}function uM(a,c){var f=rn();c=c===void 0?null:c;var m=f.memoizedState;return c!==null&&pT(c,m[1])?m[0]:(f.memoizedState=[a,c],a)}function hM(a,c){var f=rn();c=c===void 0?null:c;var m=f.memoizedState;if(c!==null&&pT(c,m[1]))return m[0];if(m=a(),gc){ci(!0);try{a()}finally{ci(!1)}}return f.memoizedState=[m,c],m}function CT(a,c,f){return f===void 0||(mo&1073741824)!==0&&(Xt&261930)===0?a.memoizedState=c:(a.memoizedState=f,a=fD(),Ht.lanes|=a,ka|=a,f)}function fM(a,c,f,m){return $r(f,c)?f:qu.current!==null?(a=CT(a,f,m),$r(a,c)||(mn=!0),a):(mo&42)===0||(mo&1073741824)!==0&&(Xt&261930)===0?(mn=!0,a.memoizedState=f):(a=fD(),Ht.lanes|=a,ka|=a,c)}function dM(a,c,f,m,b){var _=st.p;st.p=_!==0&&8>_?_:8;var C=J.T,O={};J.T=O,MT(a,!1,c,f);try{var z=b(),Q=J.S;if(Q!==null&&Q(O,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var rt=Fz(z,m);hd(a,c,rt,Xr(a))}else hd(a,c,m,Xr(a))}catch(lt){hd(a,c,{then:function(){},status:"rejected",reason:lt},Xr())}finally{st.p=_,C!==null&&O.types!==null&&(C.types=O.types),J.T=C}}function qz(){}function AT(a,c,f,m){if(a.tag!==5)throw Error(r(476));var b=pM(a).queue;dM(a,b,c,ht,f===null?qz:function(){return mM(a),f(m)})}function pM(a){var c=a.memoizedState;if(c!==null)return c;c={memoizedState:ht,baseState:ht,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:ht},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:f},next:null},a.memoizedState=c,a=a.alternate,a!==null&&(a.memoizedState=c),c}function mM(a){var c=pM(a);c.next===null&&(c=a.alternate.memoizedState),hd(a,c.next.queue,{},Xr())}function kT(){return Hn(kd)}function gM(){return rn().memoizedState}function yM(){return rn().memoizedState}function Wz(a){for(var c=a.return;c!==null;){switch(c.tag){case 24:case 3:var f=Xr();a=Sa(f);var m=wa(c,a,f);m!==null&&(Ir(m,c,f),od(m,c,f)),c={cache:rT()},a.payload=c;return}c=c.return}}function Gz(a,c,f){var m=Xr();f={lane:m,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Bg(a)?bM(c,f):(f=W_(a,c,f,m),f!==null&&(Ir(f,a,m),_M(f,c,m)))}function vM(a,c,f){var m=Xr();hd(a,c,f,m)}function hd(a,c,f,m){var b={lane:m,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Bg(a))bM(c,b);else{var _=a.alternate;if(a.lanes===0&&(_===null||_.lanes===0)&&(_=c.lastRenderedReducer,_!==null))try{var C=c.lastRenderedState,O=_(C,f);if(b.hasEagerState=!0,b.eagerState=O,$r(O,C))return _g(a,c,b,0),Ce===null&&bg(),!1}catch{}if(f=W_(a,c,b,m),f!==null)return Ir(f,a,m),_M(f,c,m),!0}return!1}function MT(a,c,f,m){if(m={lane:2,revertLane:aS(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Bg(a)){if(c)throw Error(r(479))}else c=W_(a,f,m,2),c!==null&&Ir(c,a,2)}function Bg(a){var c=a.alternate;return a===Ht||c!==null&&c===Ht}function bM(a,c){Wu=Ig=!0;var f=a.pending;f===null?c.next=c:(c.next=f.next,f.next=c),a.pending=c}function _M(a,c,f){if((f&4194048)!==0){var m=c.lanes;m&=a.pendingLanes,f|=m,c.lanes=f,If(a,f)}}var fd={readContext:Hn,use:Lg,useCallback:qe,useContext:qe,useEffect:qe,useImperativeHandle:qe,useLayoutEffect:qe,useInsertionEffect:qe,useMemo:qe,useReducer:qe,useRef:qe,useState:qe,useDebugValue:qe,useDeferredValue:qe,useTransition:qe,useSyncExternalStore:qe,useId:qe,useHostTransitionStatus:qe,useFormState:qe,useActionState:qe,useOptimistic:qe,useMemoCache:qe,useCacheRefresh:qe};fd.useEffectEvent=qe;var TM={readContext:Hn,use:Lg,useCallback:function(a,c){return fr().memoizedState=[a,c===void 0?null:c],a},useContext:Hn,useEffect:iM,useImperativeHandle:function(a,c,f){f=f!=null?f.concat([a]):null,jg(4194308,4,lM.bind(null,c,a),f)},useLayoutEffect:function(a,c){return jg(4194308,4,a,c)},useInsertionEffect:function(a,c){jg(4,2,a,c)},useMemo:function(a,c){var f=fr();c=c===void 0?null:c;var m=a();if(gc){ci(!0);try{a()}finally{ci(!1)}}return f.memoizedState=[m,c],m},useReducer:function(a,c,f){var m=fr();if(f!==void 0){var b=f(c);if(gc){ci(!0);try{f(c)}finally{ci(!1)}}}else b=c;return m.memoizedState=m.baseState=b,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:b},m.queue=a,a=a.dispatch=Gz.bind(null,Ht,a),[m.memoizedState,a]},useRef:function(a){var c=fr();return a={current:a},c.memoizedState=a},useState:function(a){a=ST(a);var c=a.queue,f=vM.bind(null,Ht,c);return c.dispatch=f,[a.memoizedState,f]},useDebugValue:ET,useDeferredValue:function(a,c){var f=fr();return CT(f,a,c)},useTransition:function(){var a=ST(!1);return a=dM.bind(null,Ht,a.queue,!0,!1),fr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,c,f){var m=Ht,b=fr();if(ee){if(f===void 0)throw Error(r(407));f=f()}else{if(f=c(),Ce===null)throw Error(r(349));(Xt&127)!==0||zk(m,c,f)}b.memoizedState=f;var _={value:f,getSnapshot:c};return b.queue=_,iM($k.bind(null,m,_,a),[a]),m.flags|=2048,Yu(9,{destroy:void 0},Hk.bind(null,m,_,f,c),null),f},useId:function(){var a=fr(),c=Ce.identifierPrefix;if(ee){var f=Rs,m=Os;f=(m&~(1<<32-tn(m)-1)).toString(32)+f,c="_"+c+"R_"+f,f=Pg++,0<f&&(c+="H"+f.toString(32)),c+="_"}else f=Bz++,c="_"+c+"r_"+f.toString(32)+"_";return a.memoizedState=c},useHostTransitionStatus:kT,useFormState:Zk,useActionState:Zk,useOptimistic:function(a){var c=fr();c.memoizedState=c.baseState=a;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=MT.bind(null,Ht,!0,f),f.dispatch=c,[a,c]},useMemoCache:bT,useCacheRefresh:function(){return fr().memoizedState=Wz.bind(null,Ht)},useEffectEvent:function(a){var c=fr(),f={impl:a};return c.memoizedState=f,function(){if((ce&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}},DT={readContext:Hn,use:Lg,useCallback:uM,useContext:Hn,useEffect:xT,useImperativeHandle:cM,useInsertionEffect:oM,useLayoutEffect:aM,useMemo:hM,useReducer:Vg,useRef:rM,useState:function(){return Vg(go)},useDebugValue:ET,useDeferredValue:function(a,c){var f=rn();return fM(f,Te.memoizedState,a,c)},useTransition:function(){var a=Vg(go)[0],c=rn().memoizedState;return[typeof a=="boolean"?a:ud(a),c]},useSyncExternalStore:Uk,useId:gM,useHostTransitionStatus:kT,useFormState:tM,useActionState:tM,useOptimistic:function(a,c){var f=rn();return Gk(f,Te,a,c)},useMemoCache:bT,useCacheRefresh:yM};DT.useEffectEvent=sM;var SM={readContext:Hn,use:Lg,useCallback:uM,useContext:Hn,useEffect:xT,useImperativeHandle:cM,useInsertionEffect:oM,useLayoutEffect:aM,useMemo:hM,useReducer:TT,useRef:rM,useState:function(){return TT(go)},useDebugValue:ET,useDeferredValue:function(a,c){var f=rn();return Te===null?CT(f,a,c):fM(f,Te.memoizedState,a,c)},useTransition:function(){var a=TT(go)[0],c=rn().memoizedState;return[typeof a=="boolean"?a:ud(a),c]},useSyncExternalStore:Uk,useId:gM,useHostTransitionStatus:kT,useFormState:nM,useActionState:nM,useOptimistic:function(a,c){var f=rn();return Te!==null?Gk(f,Te,a,c):(f.baseState=a,[a,f.queue.dispatch])},useMemoCache:bT,useCacheRefresh:yM};SM.useEffectEvent=sM;function OT(a,c,f,m){c=a.memoizedState,f=f(m,c),f=f==null?c:p({},c,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var RT={enqueueSetState:function(a,c,f){a=a._reactInternals;var m=Xr(),b=Sa(m);b.payload=c,f!=null&&(b.callback=f),c=wa(a,b,m),c!==null&&(Ir(c,a,m),od(c,a,m))},enqueueReplaceState:function(a,c,f){a=a._reactInternals;var m=Xr(),b=Sa(m);b.tag=1,b.payload=c,f!=null&&(b.callback=f),c=wa(a,b,m),c!==null&&(Ir(c,a,m),od(c,a,m))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var f=Xr(),m=Sa(f);m.tag=2,c!=null&&(m.callback=c),c=wa(a,m,f),c!==null&&(Ir(c,a,f),od(c,a,f))}};function wM(a,c,f,m,b,_,C){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,_,C):c.prototype&&c.prototype.isPureReactComponent?!Jf(f,m)||!Jf(b,_):!0}function xM(a,c,f,m){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,m),c.state!==a&&RT.enqueueReplaceState(c,c.state,null)}function yc(a,c){var f=c;if("ref"in c){f={};for(var m in c)m!=="ref"&&(f[m]=c[m])}if(a=a.defaultProps){f===c&&(f=p({},f));for(var b in a)f[b]===void 0&&(f[b]=a[b])}return f}function EM(a){vg(a)}function CM(a){console.error(a)}function AM(a){vg(a)}function Ug(a,c){try{var f=a.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(m){setTimeout(function(){throw m})}}function kM(a,c,f){try{var m=a.onCaughtError;m(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function IT(a,c,f){return f=Sa(f),f.tag=3,f.payload={element:null},f.callback=function(){Ug(a,c)},f}function MM(a){return a=Sa(a),a.tag=3,a}function DM(a,c,f,m){var b=f.type.getDerivedStateFromError;if(typeof b=="function"){var _=m.value;a.payload=function(){return b(_)},a.callback=function(){kM(c,f,m)}}var C=f.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(a.callback=function(){kM(c,f,m),typeof b!="function"&&(Ma===null?Ma=new Set([this]):Ma.add(this));var O=m.stack;this.componentDidCatch(m.value,{componentStack:O!==null?O:""})})}function Yz(a,c,f,m,b){if(f.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(c=f.alternate,c!==null&&Bu(c,f,b,!0),f=Wr.current,f!==null){switch(f.tag){case 31:case 13:return bi===null?Zg():f.alternate===null&&We===0&&(We=3),f.flags&=-257,f.flags|=65536,f.lanes=b,m===kg?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([m]):c.add(m),iS(a,m,b)),!1;case 22:return f.flags|=65536,m===kg?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([m])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([m]):f.add(m)),iS(a,m,b)),!1}throw Error(r(435,f.tag))}return iS(a,m,b),Zg(),!1}if(ee)return c=Wr.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=b,m!==J_&&(a=Error(r(422),{cause:m}),ed(mi(a,f)))):(m!==J_&&(c=Error(r(423),{cause:m}),ed(mi(c,f))),a=a.current.alternate,a.flags|=65536,b&=-b,a.lanes|=b,m=mi(m,f),b=IT(a.stateNode,m,b),cT(a,b),We!==4&&(We=2)),!1;var _=Error(r(520),{cause:m});if(_=mi(_,f),_d===null?_d=[_]:_d.push(_),We!==4&&(We=2),c===null)return!0;m=mi(m,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,a=b&-b,f.lanes|=a,a=IT(f.stateNode,m,a),cT(f,a),!1;case 1:if(c=f.type,_=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Ma===null||!Ma.has(_))))return f.flags|=65536,b&=-b,f.lanes|=b,b=MM(b),DM(b,a,f,m),cT(f,b),!1}f=f.return}while(f!==null);return!1}var PT=Error(r(461)),mn=!1;function $n(a,c,f,m){c.child=a===null?Pk(c,null,f,m):mc(c,a.child,f,m)}function OM(a,c,f,m,b){f=f.render;var _=c.ref;if("ref"in m){var C={};for(var O in m)O!=="ref"&&(C[O]=m[O])}else C=m;return hc(c),m=mT(a,c,f,C,_,b),O=gT(),a!==null&&!mn?(yT(a,c,b),yo(a,c,b)):(ee&&O&&X_(c),c.flags|=1,$n(a,c,m,b),c.child)}function RM(a,c,f,m,b){if(a===null){var _=f.type;return typeof _=="function"&&!G_(_)&&_.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=_,IM(a,c,_,m,b)):(a=Sg(f.type,null,m,c,c.mode,b),a.ref=c.ref,a.return=c,c.child=a)}if(_=a.child,!zT(a,b)){var C=_.memoizedProps;if(f=f.compare,f=f!==null?f:Jf,f(C,m)&&a.ref===c.ref)return yo(a,c,b)}return c.flags|=1,a=uo(_,m),a.ref=c.ref,a.return=c,c.child=a}function IM(a,c,f,m,b){if(a!==null){var _=a.memoizedProps;if(Jf(_,m)&&a.ref===c.ref)if(mn=!1,c.pendingProps=m=_,zT(a,b))(a.flags&131072)!==0&&(mn=!0);else return c.lanes=a.lanes,yo(a,c,b)}return NT(a,c,f,m,b)}function PM(a,c,f,m){var b=m.children,_=a!==null?a.memoizedState:null;if(a===null&&c.stateNode===null&&(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((c.flags&128)!==0){if(_=_!==null?_.baseLanes|f:f,a!==null){for(m=c.child=a.child,b=0;m!==null;)b=b|m.lanes|m.childLanes,m=m.sibling;m=b&~_}else m=0,c.child=null;return NM(a,c,_,f,m)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},a!==null&&Cg(c,_!==null?_.cachePool:null),_!==null?Vk(c,_):hT(),jk(c);else return m=c.lanes=536870912,NM(a,c,_!==null?_.baseLanes|f:f,f,m)}else _!==null?(Cg(c,_.cachePool),Vk(c,_),Ea(),c.memoizedState=null):(a!==null&&Cg(c,null),hT(),Ea());return $n(a,c,b,f),c.child}function dd(a,c){return a!==null&&a.tag===22||c.stateNode!==null||(c.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.sibling}function NM(a,c,f,m,b){var _=sT();return _=_===null?null:{parent:dn._currentValue,pool:_},c.memoizedState={baseLanes:f,cachePool:_},a!==null&&Cg(c,null),hT(),jk(c),a!==null&&Bu(a,c,m,!0),c.childLanes=b,null}function zg(a,c){return c=$g({mode:c.mode,children:c.children},a.mode),c.ref=a.ref,a.child=c,c.return=a,c}function LM(a,c,f){return mc(c,a.child,null,f),a=zg(c,c.pendingProps),a.flags|=2,Gr(c),c.memoizedState=null,a}function Kz(a,c,f){var m=c.pendingProps,b=(c.flags&128)!==0;if(c.flags&=-129,a===null){if(ee){if(m.mode==="hidden")return a=zg(c,m),c.lanes=536870912,dd(null,a);if(dT(c),(a=Re)?(a=YD(a,vi),a=a!==null&&a.data==="&"?a:null,a!==null&&(c.memoizedState={dehydrated:a,treeContext:ya!==null?{id:Os,overflow:Rs}:null,retryLane:536870912,hydrationErrors:null},f=bk(a),f.return=c,c.child=f,zn=c,Re=null)):a=null,a===null)throw ba(c);return c.lanes=536870912,null}return zg(c,m)}var _=a.memoizedState;if(_!==null){var C=_.dehydrated;if(dT(c),b)if(c.flags&256)c.flags&=-257,c=LM(a,c,f);else if(c.memoizedState!==null)c.child=a.child,c.flags|=128,c=null;else throw Error(r(558));else if(mn||Bu(a,c,f,!1),b=(f&a.childLanes)!==0,mn||b){if(m=Ce,m!==null&&(C=Pf(m,f),C!==0&&C!==_.retryLane))throw _.retryLane=C,ac(a,C),Ir(m,a,C),PT;Zg(),c=LM(a,c,f)}else a=_.treeContext,Re=_i(C.nextSibling),zn=c,ee=!0,va=null,vi=!1,a!==null&&Sk(c,a),c=zg(c,m),c.flags|=4096;return c}return a=uo(a.child,{mode:m.mode,children:m.children}),a.ref=c.ref,c.child=a,a.return=c,a}function Hg(a,c){var f=c.ref;if(f===null)a!==null&&a.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(a===null||a.ref!==f)&&(c.flags|=4194816)}}function NT(a,c,f,m,b){return hc(c),f=mT(a,c,f,m,void 0,b),m=gT(),a!==null&&!mn?(yT(a,c,b),yo(a,c,b)):(ee&&m&&X_(c),c.flags|=1,$n(a,c,f,b),c.child)}function VM(a,c,f,m,b,_){return hc(c),c.updateQueue=null,f=Bk(c,m,f,b),Fk(a),m=gT(),a!==null&&!mn?(yT(a,c,_),yo(a,c,_)):(ee&&m&&X_(c),c.flags|=1,$n(a,c,f,_),c.child)}function jM(a,c,f,m,b){if(hc(c),c.stateNode===null){var _=Lu,C=f.contextType;typeof C=="object"&&C!==null&&(_=Hn(C)),_=new f(m,_),c.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=RT,c.stateNode=_,_._reactInternals=c,_=c.stateNode,_.props=m,_.state=c.memoizedState,_.refs={},aT(c),C=f.contextType,_.context=typeof C=="object"&&C!==null?Hn(C):Lu,_.state=c.memoizedState,C=f.getDerivedStateFromProps,typeof C=="function"&&(OT(c,f,C,m),_.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(C=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),C!==_.state&&RT.enqueueReplaceState(_,_.state,null),ld(c,m,_,b),ad(),_.state=c.memoizedState),typeof _.componentDidMount=="function"&&(c.flags|=4194308),m=!0}else if(a===null){_=c.stateNode;var O=c.memoizedProps,z=yc(f,O);_.props=z;var Q=_.context,rt=f.contextType;C=Lu,typeof rt=="object"&&rt!==null&&(C=Hn(rt));var lt=f.getDerivedStateFromProps;rt=typeof lt=="function"||typeof _.getSnapshotBeforeUpdate=="function",O=c.pendingProps!==O,rt||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(O||Q!==C)&&xM(c,_,m,C),Ta=!1;var Z=c.memoizedState;_.state=Z,ld(c,m,_,b),ad(),Q=c.memoizedState,O||Z!==Q||Ta?(typeof lt=="function"&&(OT(c,f,lt,m),Q=c.memoizedState),(z=Ta||wM(c,f,z,m,Z,Q,C))?(rt||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(c.flags|=4194308)):(typeof _.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=Q),_.props=m,_.state=Q,_.context=C,m=z):(typeof _.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{_=c.stateNode,lT(a,c),C=c.memoizedProps,rt=yc(f,C),_.props=rt,lt=c.pendingProps,Z=_.context,Q=f.contextType,z=Lu,typeof Q=="object"&&Q!==null&&(z=Hn(Q)),O=f.getDerivedStateFromProps,(Q=typeof O=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(C!==lt||Z!==z)&&xM(c,_,m,z),Ta=!1,Z=c.memoizedState,_.state=Z,ld(c,m,_,b),ad();var nt=c.memoizedState;C!==lt||Z!==nt||Ta||a!==null&&a.dependencies!==null&&xg(a.dependencies)?(typeof O=="function"&&(OT(c,f,O,m),nt=c.memoizedState),(rt=Ta||wM(c,f,rt,m,Z,nt,z)||a!==null&&a.dependencies!==null&&xg(a.dependencies))?(Q||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(m,nt,z),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(m,nt,z)),typeof _.componentDidUpdate=="function"&&(c.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof _.componentDidUpdate!="function"||C===a.memoizedProps&&Z===a.memoizedState||(c.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||C===a.memoizedProps&&Z===a.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=nt),_.props=m,_.state=nt,_.context=z,m=rt):(typeof _.componentDidUpdate!="function"||C===a.memoizedProps&&Z===a.memoizedState||(c.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||C===a.memoizedProps&&Z===a.memoizedState||(c.flags|=1024),m=!1)}return _=m,Hg(a,c),m=(c.flags&128)!==0,_||m?(_=c.stateNode,f=m&&typeof f.getDerivedStateFromError!="function"?null:_.render(),c.flags|=1,a!==null&&m?(c.child=mc(c,a.child,null,b),c.child=mc(c,null,f,b)):$n(a,c,f,b),c.memoizedState=_.state,a=c.child):a=yo(a,c,b),a}function FM(a,c,f,m){return cc(),c.flags|=256,$n(a,c,f,m),c.child}var LT={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function VT(a){return{baseLanes:a,cachePool:kk()}}function jT(a,c,f){return a=a!==null?a.childLanes&~f:0,c&&(a|=Kr),a}function BM(a,c,f){var m=c.pendingProps,b=!1,_=(c.flags&128)!==0,C;if((C=_)||(C=a!==null&&a.memoizedState===null?!1:(nn.current&2)!==0),C&&(b=!0,c.flags&=-129),C=(c.flags&32)!==0,c.flags&=-33,a===null){if(ee){if(b?xa(c):Ea(),(a=Re)?(a=YD(a,vi),a=a!==null&&a.data!=="&"?a:null,a!==null&&(c.memoizedState={dehydrated:a,treeContext:ya!==null?{id:Os,overflow:Rs}:null,retryLane:536870912,hydrationErrors:null},f=bk(a),f.return=c,c.child=f,zn=c,Re=null)):a=null,a===null)throw ba(c);return _S(a)?c.lanes=32:c.lanes=536870912,null}var O=m.children;return m=m.fallback,b?(Ea(),b=c.mode,O=$g({mode:"hidden",children:O},b),m=lc(m,b,f,null),O.return=c,m.return=c,O.sibling=m,c.child=O,m=c.child,m.memoizedState=VT(f),m.childLanes=jT(a,C,f),c.memoizedState=LT,dd(null,m)):(xa(c),FT(c,O))}var z=a.memoizedState;if(z!==null&&(O=z.dehydrated,O!==null)){if(_)c.flags&256?(xa(c),c.flags&=-257,c=BT(a,c,f)):c.memoizedState!==null?(Ea(),c.child=a.child,c.flags|=128,c=null):(Ea(),O=m.fallback,b=c.mode,m=$g({mode:"visible",children:m.children},b),O=lc(O,b,f,null),O.flags|=2,m.return=c,O.return=c,m.sibling=O,c.child=m,mc(c,a.child,null,f),m=c.child,m.memoizedState=VT(f),m.childLanes=jT(a,C,f),c.memoizedState=LT,c=dd(null,m));else if(xa(c),_S(O)){if(C=O.nextSibling&&O.nextSibling.dataset,C)var Q=C.dgst;C=Q,m=Error(r(419)),m.stack="",m.digest=C,ed({value:m,source:null,stack:null}),c=BT(a,c,f)}else if(mn||Bu(a,c,f,!1),C=(f&a.childLanes)!==0,mn||C){if(C=Ce,C!==null&&(m=Pf(C,f),m!==0&&m!==z.retryLane))throw z.retryLane=m,ac(a,m),Ir(C,a,m),PT;bS(O)||Zg(),c=BT(a,c,f)}else bS(O)?(c.flags|=192,c.child=a.child,c=null):(a=z.treeContext,Re=_i(O.nextSibling),zn=c,ee=!0,va=null,vi=!1,a!==null&&Sk(c,a),c=FT(c,m.children),c.flags|=4096);return c}return b?(Ea(),O=m.fallback,b=c.mode,z=a.child,Q=z.sibling,m=uo(z,{mode:"hidden",children:m.children}),m.subtreeFlags=z.subtreeFlags&65011712,Q!==null?O=uo(Q,O):(O=lc(O,b,f,null),O.flags|=2),O.return=c,m.return=c,m.sibling=O,c.child=m,dd(null,m),m=c.child,O=a.child.memoizedState,O===null?O=VT(f):(b=O.cachePool,b!==null?(z=dn._currentValue,b=b.parent!==z?{parent:z,pool:z}:b):b=kk(),O={baseLanes:O.baseLanes|f,cachePool:b}),m.memoizedState=O,m.childLanes=jT(a,C,f),c.memoizedState=LT,dd(a.child,m)):(xa(c),f=a.child,a=f.sibling,f=uo(f,{mode:"visible",children:m.children}),f.return=c,f.sibling=null,a!==null&&(C=c.deletions,C===null?(c.deletions=[a],c.flags|=16):C.push(a)),c.child=f,c.memoizedState=null,f)}function FT(a,c){return c=$g({mode:"visible",children:c},a.mode),c.return=a,a.child=c}function $g(a,c){return a=qr(22,a,null,c),a.lanes=0,a}function BT(a,c,f){return mc(c,a.child,null,f),a=FT(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function UM(a,c,f){a.lanes|=c;var m=a.alternate;m!==null&&(m.lanes|=c),eT(a.return,c,f)}function UT(a,c,f,m,b,_){var C=a.memoizedState;C===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:f,tailMode:b,treeForkCount:_}:(C.isBackwards=c,C.rendering=null,C.renderingStartTime=0,C.last=m,C.tail=f,C.tailMode=b,C.treeForkCount=_)}function zM(a,c,f){var m=c.pendingProps,b=m.revealOrder,_=m.tail;m=m.children;var C=nn.current,O=(C&2)!==0;if(O?(C=C&1|2,c.flags|=128):C&=1,dt(nn,C),$n(a,c,m,f),m=ee?td:0,!O&&a!==null&&(a.flags&128)!==0)t:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&UM(a,f,c);else if(a.tag===19)UM(a,f,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break t;for(;a.sibling===null;){if(a.return===null||a.return===c)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(b){case"forwards":for(f=c.child,b=null;f!==null;)a=f.alternate,a!==null&&Rg(a)===null&&(b=f),f=f.sibling;f=b,f===null?(b=c.child,c.child=null):(b=f.sibling,f.sibling=null),UT(c,!1,b,f,_,m);break;case"backwards":case"unstable_legacy-backwards":for(f=null,b=c.child,c.child=null;b!==null;){if(a=b.alternate,a!==null&&Rg(a)===null){c.child=b;break}a=b.sibling,b.sibling=f,f=b,b=a}UT(c,!0,f,null,_,m);break;case"together":UT(c,!1,null,null,void 0,m);break;default:c.memoizedState=null}return c.child}function yo(a,c,f){if(a!==null&&(c.dependencies=a.dependencies),ka|=c.lanes,(f&c.childLanes)===0)if(a!==null){if(Bu(a,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(a!==null&&c.child!==a.child)throw Error(r(153));if(c.child!==null){for(a=c.child,f=uo(a,a.pendingProps),c.child=f,f.return=c;a.sibling!==null;)a=a.sibling,f=f.sibling=uo(a,a.pendingProps),f.return=c;f.sibling=null}return c.child}function zT(a,c){return(a.lanes&c)!==0?!0:(a=a.dependencies,!!(a!==null&&xg(a)))}function Xz(a,c,f){switch(c.tag){case 3:Fe(c,c.stateNode.containerInfo),_a(c,dn,a.memoizedState.cache),cc();break;case 27:case 5:Mt(c);break;case 4:Fe(c,c.stateNode.containerInfo);break;case 10:_a(c,c.type,c.memoizedProps.value);break;case 31:if(c.memoizedState!==null)return c.flags|=128,dT(c),null;break;case 13:var m=c.memoizedState;if(m!==null)return m.dehydrated!==null?(xa(c),c.flags|=128,null):(f&c.child.childLanes)!==0?BM(a,c,f):(xa(c),a=yo(a,c,f),a!==null?a.sibling:null);xa(c);break;case 19:var b=(a.flags&128)!==0;if(m=(f&c.childLanes)!==0,m||(Bu(a,c,f,!1),m=(f&c.childLanes)!==0),b){if(m)return zM(a,c,f);c.flags|=128}if(b=c.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),dt(nn,nn.current),m)break;return null;case 22:return c.lanes=0,PM(a,c,f,c.pendingProps);case 24:_a(c,dn,a.memoizedState.cache)}return yo(a,c,f)}function HM(a,c,f){if(a!==null)if(a.memoizedProps!==c.pendingProps)mn=!0;else{if(!zT(a,f)&&(c.flags&128)===0)return mn=!1,Xz(a,c,f);mn=(a.flags&131072)!==0}else mn=!1,ee&&(c.flags&1048576)!==0&&Tk(c,td,c.index);switch(c.lanes=0,c.tag){case 16:t:{var m=c.pendingProps;if(a=dc(c.elementType),c.type=a,typeof a=="function")G_(a)?(m=yc(a,m),c.tag=1,c=jM(null,c,a,m,f)):(c.tag=0,c=NT(null,c,a,m,f));else{if(a!=null){var b=a.$$typeof;if(b===V){c.tag=11,c=OM(null,c,a,m,f);break t}else if(b===M){c.tag=14,c=RM(null,c,a,m,f);break t}}throw c=yt(a)||a,Error(r(306,c,""))}}return c;case 0:return NT(a,c,c.type,c.pendingProps,f);case 1:return m=c.type,b=yc(m,c.pendingProps),jM(a,c,m,b,f);case 3:t:{if(Fe(c,c.stateNode.containerInfo),a===null)throw Error(r(387));m=c.pendingProps;var _=c.memoizedState;b=_.element,lT(a,c),ld(c,m,null,f);var C=c.memoizedState;if(m=C.cache,_a(c,dn,m),m!==_.cache&&nT(c,[dn],f,!0),ad(),m=C.element,_.isDehydrated)if(_={element:m,isDehydrated:!1,cache:C.cache},c.updateQueue.baseState=_,c.memoizedState=_,c.flags&256){c=FM(a,c,m,f);break t}else if(m!==b){b=mi(Error(r(424)),c),ed(b),c=FM(a,c,m,f);break t}else for(a=c.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,Re=_i(a.firstChild),zn=c,ee=!0,va=null,vi=!0,f=Pk(c,null,m,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(cc(),m===b){c=yo(a,c,f);break t}$n(a,c,m,f)}c=c.child}return c;case 26:return Hg(a,c),a===null?(f=tO(c.type,null,c.pendingProps,null))?c.memoizedState=f:ee||(f=c.type,a=c.pendingProps,m=oy(It.current).createElement(f),m[un]=c,m[Dn]=a,qn(m,f,a),hn(m),c.stateNode=m):c.memoizedState=tO(c.type,a.memoizedProps,c.pendingProps,a.memoizedState),null;case 27:return Mt(c),a===null&&ee&&(m=c.stateNode=QD(c.type,c.pendingProps,It.current),zn=c,vi=!0,b=Re,Ia(c.type)?(TS=b,Re=_i(m.firstChild)):Re=b),$n(a,c,c.pendingProps.children,f),Hg(a,c),a===null&&(c.flags|=4194304),c.child;case 5:return a===null&&ee&&((b=m=Re)&&(m=C6(m,c.type,c.pendingProps,vi),m!==null?(c.stateNode=m,zn=c,Re=_i(m.firstChild),vi=!1,b=!0):b=!1),b||ba(c)),Mt(c),b=c.type,_=c.pendingProps,C=a!==null?a.memoizedProps:null,m=_.children,gS(b,_)?m=null:C!==null&&gS(b,C)&&(c.flags|=32),c.memoizedState!==null&&(b=mT(a,c,Uz,null,null,f),kd._currentValue=b),Hg(a,c),$n(a,c,m,f),c.child;case 6:return a===null&&ee&&((a=f=Re)&&(f=A6(f,c.pendingProps,vi),f!==null?(c.stateNode=f,zn=c,Re=null,a=!0):a=!1),a||ba(c)),null;case 13:return BM(a,c,f);case 4:return Fe(c,c.stateNode.containerInfo),m=c.pendingProps,a===null?c.child=mc(c,null,m,f):$n(a,c,m,f),c.child;case 11:return OM(a,c,c.type,c.pendingProps,f);case 7:return $n(a,c,c.pendingProps,f),c.child;case 8:return $n(a,c,c.pendingProps.children,f),c.child;case 12:return $n(a,c,c.pendingProps.children,f),c.child;case 10:return m=c.pendingProps,_a(c,c.type,m.value),$n(a,c,m.children,f),c.child;case 9:return b=c.type._context,m=c.pendingProps.children,hc(c),b=Hn(b),m=m(b),c.flags|=1,$n(a,c,m,f),c.child;case 14:return RM(a,c,c.type,c.pendingProps,f);case 15:return IM(a,c,c.type,c.pendingProps,f);case 19:return zM(a,c,f);case 31:return Kz(a,c,f);case 22:return PM(a,c,f,c.pendingProps);case 24:return hc(c),m=Hn(dn),a===null?(b=sT(),b===null&&(b=Ce,_=rT(),b.pooledCache=_,_.refCount++,_!==null&&(b.pooledCacheLanes|=f),b=_),c.memoizedState={parent:m,cache:b},aT(c),_a(c,dn,b)):((a.lanes&f)!==0&&(lT(a,c),ld(c,null,null,f),ad()),b=a.memoizedState,_=c.memoizedState,b.parent!==m?(b={parent:m,cache:m},c.memoizedState=b,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=b),_a(c,dn,m)):(m=_.cache,_a(c,dn,m),m!==b.cache&&nT(c,[dn],f,!0))),$n(a,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function vo(a){a.flags|=4}function HT(a,c,f,m,b){if((c=(a.mode&32)!==0)&&(c=!1),c){if(a.flags|=16777216,(b&335544128)===b)if(a.stateNode.complete)a.flags|=8192;else if(gD())a.flags|=8192;else throw pc=kg,oT}else a.flags&=-16777217}function $M(a,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!sO(c))if(gD())a.flags|=8192;else throw pc=kg,oT}function qg(a,c){c!==null&&(a.flags|=4),a.flags&16384&&(c=a.tag!==22?Qm():536870912,a.lanes|=c,Ju|=c)}function pd(a,c){if(!ee)switch(a.tailMode){case"hidden":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function Ie(a){var c=a.alternate!==null&&a.alternate.child===a.child,f=0,m=0;if(c)for(var b=a.child;b!==null;)f|=b.lanes|b.childLanes,m|=b.subtreeFlags&65011712,m|=b.flags&65011712,b.return=a,b=b.sibling;else for(b=a.child;b!==null;)f|=b.lanes|b.childLanes,m|=b.subtreeFlags,m|=b.flags,b.return=a,b=b.sibling;return a.subtreeFlags|=m,a.childLanes=f,c}function Qz(a,c,f){var m=c.pendingProps;switch(Q_(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ie(c),null;case 1:return Ie(c),null;case 3:return f=c.stateNode,m=null,a!==null&&(m=a.memoizedState.cache),c.memoizedState.cache!==m&&(c.flags|=2048),po(dn),he(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(a===null||a.child===null)&&(Fu(c)?vo(c):a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Z_())),Ie(c),null;case 26:var b=c.type,_=c.memoizedState;return a===null?(vo(c),_!==null?(Ie(c),$M(c,_)):(Ie(c),HT(c,b,null,m,f))):_?_!==a.memoizedState?(vo(c),Ie(c),$M(c,_)):(Ie(c),c.flags&=-16777217):(a=a.memoizedProps,a!==m&&vo(c),Ie(c),HT(c,b,a,m,f)),null;case 27:if(be(c),f=It.current,b=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==m&&vo(c);else{if(!m){if(c.stateNode===null)throw Error(r(166));return Ie(c),null}a=mt.current,Fu(c)?wk(c):(a=QD(b,m,f),c.stateNode=a,vo(c))}return Ie(c),null;case 5:if(be(c),b=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==m&&vo(c);else{if(!m){if(c.stateNode===null)throw Error(r(166));return Ie(c),null}if(_=mt.current,Fu(c))wk(c);else{var C=oy(It.current);switch(_){case 1:_=C.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:_=C.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":_=C.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":_=C.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":_=C.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof m.is=="string"?C.createElement("select",{is:m.is}):C.createElement("select"),m.multiple?_.multiple=!0:m.size&&(_.size=m.size);break;default:_=typeof m.is=="string"?C.createElement(b,{is:m.is}):C.createElement(b)}}_[un]=c,_[Dn]=m;t:for(C=c.child;C!==null;){if(C.tag===5||C.tag===6)_.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===c)break t;for(;C.sibling===null;){if(C.return===null||C.return===c)break t;C=C.return}C.sibling.return=C.return,C=C.sibling}c.stateNode=_;t:switch(qn(_,b,m),b){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break t;case"img":m=!0;break t;default:m=!1}m&&vo(c)}}return Ie(c),HT(c,c.type,a===null?null:a.memoizedProps,c.pendingProps,f),null;case 6:if(a&&c.stateNode!=null)a.memoizedProps!==m&&vo(c);else{if(typeof m!="string"&&c.stateNode===null)throw Error(r(166));if(a=It.current,Fu(c)){if(a=c.stateNode,f=c.memoizedProps,m=null,b=zn,b!==null)switch(b.tag){case 27:case 5:m=b.memoizedProps}a[un]=c,a=!!(a.nodeValue===f||m!==null&&m.suppressHydrationWarning===!0||BD(a.nodeValue,f)),a||ba(c,!0)}else a=oy(a).createTextNode(m),a[un]=c,c.stateNode=a}return Ie(c),null;case 31:if(f=c.memoizedState,a===null||a.memoizedState!==null){if(m=Fu(c),f!==null){if(a===null){if(!m)throw Error(r(318));if(a=c.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(557));a[un]=c}else cc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ie(c),a=!1}else f=Z_(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=f),a=!0;if(!a)return c.flags&256?(Gr(c),c):(Gr(c),null);if((c.flags&128)!==0)throw Error(r(558))}return Ie(c),null;case 13:if(m=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(b=Fu(c),m!==null&&m.dehydrated!==null){if(a===null){if(!b)throw Error(r(318));if(b=c.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));b[un]=c}else cc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ie(c),b=!1}else b=Z_(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=b),b=!0;if(!b)return c.flags&256?(Gr(c),c):(Gr(c),null)}return Gr(c),(c.flags&128)!==0?(c.lanes=f,c):(f=m!==null,a=a!==null&&a.memoizedState!==null,f&&(m=c.child,b=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(b=m.alternate.memoizedState.cachePool.pool),_=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(_=m.memoizedState.cachePool.pool),_!==b&&(m.flags|=2048)),f!==a&&f&&(c.child.flags|=8192),qg(c,c.updateQueue),Ie(c),null);case 4:return he(),a===null&&hS(c.stateNode.containerInfo),Ie(c),null;case 10:return po(c.type),Ie(c),null;case 19:if(ot(nn),m=c.memoizedState,m===null)return Ie(c),null;if(b=(c.flags&128)!==0,_=m.rendering,_===null)if(b)pd(m,!1);else{if(We!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(_=Rg(a),_!==null){for(c.flags|=128,pd(m,!1),a=_.updateQueue,c.updateQueue=a,qg(c,a),c.subtreeFlags=0,a=f,f=c.child;f!==null;)vk(f,a),f=f.sibling;return dt(nn,nn.current&1|2),ee&&ho(c,m.treeForkCount),c.child}a=a.sibling}m.tail!==null&&ur()>Xg&&(c.flags|=128,b=!0,pd(m,!1),c.lanes=4194304)}else{if(!b)if(a=Rg(_),a!==null){if(c.flags|=128,b=!0,a=a.updateQueue,c.updateQueue=a,qg(c,a),pd(m,!0),m.tail===null&&m.tailMode==="hidden"&&!_.alternate&&!ee)return Ie(c),null}else 2*ur()-m.renderingStartTime>Xg&&f!==536870912&&(c.flags|=128,b=!0,pd(m,!1),c.lanes=4194304);m.isBackwards?(_.sibling=c.child,c.child=_):(a=m.last,a!==null?a.sibling=_:c.child=_,m.last=_)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=ur(),a.sibling=null,f=nn.current,dt(nn,b?f&1|2:f&1),ee&&ho(c,m.treeForkCount),a):(Ie(c),null);case 22:case 23:return Gr(c),fT(),m=c.memoizedState!==null,a!==null?a.memoizedState!==null!==m&&(c.flags|=8192):m&&(c.flags|=8192),m?(f&536870912)!==0&&(c.flags&128)===0&&(Ie(c),c.subtreeFlags&6&&(c.flags|=8192)):Ie(c),f=c.updateQueue,f!==null&&qg(c,f.retryQueue),f=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(f=a.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048),a!==null&&ot(fc),null;case 24:return f=null,a!==null&&(f=a.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),po(dn),Ie(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function Jz(a,c){switch(Q_(c),c.tag){case 1:return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return po(dn),he(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 26:case 27:case 5:return be(c),null;case 31:if(c.memoizedState!==null){if(Gr(c),c.alternate===null)throw Error(r(340));cc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 13:if(Gr(c),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(r(340));cc()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return ot(nn),null;case 4:return he(),null;case 10:return po(c.type),null;case 22:case 23:return Gr(c),fT(),a!==null&&ot(fc),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 24:return po(dn),null;case 25:return null;default:return null}}function qM(a,c){switch(Q_(c),c.tag){case 3:po(dn),he();break;case 26:case 27:case 5:be(c);break;case 4:he();break;case 31:c.memoizedState!==null&&Gr(c);break;case 13:Gr(c);break;case 19:ot(nn);break;case 10:po(c.type);break;case 22:case 23:Gr(c),fT(),a!==null&&ot(fc);break;case 24:po(dn)}}function md(a,c){try{var f=c.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var b=m.next;f=b;do{if((f.tag&a)===a){m=void 0;var _=f.create,C=f.inst;m=_(),C.destroy=m}f=f.next}while(f!==b)}}catch(O){me(c,c.return,O)}}function Ca(a,c,f){try{var m=c.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var _=b.next;m=_;do{if((m.tag&a)===a){var C=m.inst,O=C.destroy;if(O!==void 0){C.destroy=void 0,b=c;var z=f,Q=O;try{Q()}catch(rt){me(b,z,rt)}}}m=m.next}while(m!==_)}}catch(rt){me(c,c.return,rt)}}function WM(a){var c=a.updateQueue;if(c!==null){var f=a.stateNode;try{Lk(c,f)}catch(m){me(a,a.return,m)}}}function GM(a,c,f){f.props=yc(a.type,a.memoizedProps),f.state=a.memoizedState;try{f.componentWillUnmount()}catch(m){me(a,c,m)}}function gd(a,c){try{var f=a.ref;if(f!==null){switch(a.tag){case 26:case 27:case 5:var m=a.stateNode;break;case 30:m=a.stateNode;break;default:m=a.stateNode}typeof f=="function"?a.refCleanup=f(m):f.current=m}}catch(b){me(a,c,b)}}function Is(a,c){var f=a.ref,m=a.refCleanup;if(f!==null)if(typeof m=="function")try{m()}catch(b){me(a,c,b)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(b){me(a,c,b)}else f.current=null}function YM(a){var c=a.type,f=a.memoizedProps,m=a.stateNode;try{t:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&m.focus();break t;case"img":f.src?m.src=f.src:f.srcSet&&(m.srcset=f.srcSet)}}catch(b){me(a,a.return,b)}}function $T(a,c,f){try{var m=a.stateNode;_6(m,a.type,f,c),m[Dn]=c}catch(b){me(a,a.return,b)}}function KM(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ia(a.type)||a.tag===4}function qT(a){t:for(;;){for(;a.sibling===null;){if(a.return===null||KM(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ia(a.type)||a.flags&2||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function WT(a,c,f){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(a,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(a),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=Bi));else if(m!==4&&(m===27&&Ia(a.type)&&(f=a.stateNode,c=null),a=a.child,a!==null))for(WT(a,c,f),a=a.sibling;a!==null;)WT(a,c,f),a=a.sibling}function Wg(a,c,f){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?f.insertBefore(a,c):f.appendChild(a);else if(m!==4&&(m===27&&Ia(a.type)&&(f=a.stateNode),a=a.child,a!==null))for(Wg(a,c,f),a=a.sibling;a!==null;)Wg(a,c,f),a=a.sibling}function XM(a){var c=a.stateNode,f=a.memoizedProps;try{for(var m=a.type,b=c.attributes;b.length;)c.removeAttributeNode(b[0]);qn(c,m,f),c[un]=a,c[Dn]=f}catch(_){me(a,a.return,_)}}var bo=!1,gn=!1,GT=!1,QM=typeof WeakSet=="function"?WeakSet:Set,Rn=null;function Zz(a,c){if(a=a.containerInfo,pS=dy,a=ck(a),B_(a)){if("selectionStart"in a)var f={start:a.selectionStart,end:a.selectionEnd};else t:{f=(f=a.ownerDocument)&&f.defaultView||window;var m=f.getSelection&&f.getSelection();if(m&&m.rangeCount!==0){f=m.anchorNode;var b=m.anchorOffset,_=m.focusNode;m=m.focusOffset;try{f.nodeType,_.nodeType}catch{f=null;break t}var C=0,O=-1,z=-1,Q=0,rt=0,lt=a,Z=null;e:for(;;){for(var nt;lt!==f||b!==0&&lt.nodeType!==3||(O=C+b),lt!==_||m!==0&&lt.nodeType!==3||(z=C+m),lt.nodeType===3&&(C+=lt.nodeValue.length),(nt=lt.firstChild)!==null;)Z=lt,lt=nt;for(;;){if(lt===a)break e;if(Z===f&&++Q===b&&(O=C),Z===_&&++rt===m&&(z=C),(nt=lt.nextSibling)!==null)break;lt=Z,Z=lt.parentNode}lt=nt}f=O===-1||z===-1?null:{start:O,end:z}}else f=null}f=f||{start:0,end:0}}else f=null;for(mS={focusedElem:a,selectionRange:f},dy=!1,Rn=c;Rn!==null;)if(c=Rn,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,Rn=a;else for(;Rn!==null;){switch(c=Rn,_=c.alternate,a=c.flags,c.tag){case 0:if((a&4)!==0&&(a=c.updateQueue,a=a!==null?a.events:null,a!==null))for(f=0;f<a.length;f++)b=a[f],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&_!==null){a=void 0,f=c,b=_.memoizedProps,_=_.memoizedState,m=f.stateNode;try{var Tt=yc(f.type,b);a=m.getSnapshotBeforeUpdate(Tt,_),m.__reactInternalSnapshotBeforeUpdate=a}catch(Pt){me(f,f.return,Pt)}}break;case 3:if((a&1024)!==0){if(a=c.stateNode.containerInfo,f=a.nodeType,f===9)vS(a);else if(f===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":vS(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=c.sibling,a!==null){a.return=c.return,Rn=a;break}Rn=c.return}}function JM(a,c,f){var m=f.flags;switch(f.tag){case 0:case 11:case 15:To(a,f),m&4&&md(5,f);break;case 1:if(To(a,f),m&4)if(a=f.stateNode,c===null)try{a.componentDidMount()}catch(C){me(f,f.return,C)}else{var b=yc(f.type,c.memoizedProps);c=c.memoizedState;try{a.componentDidUpdate(b,c,a.__reactInternalSnapshotBeforeUpdate)}catch(C){me(f,f.return,C)}}m&64&&WM(f),m&512&&gd(f,f.return);break;case 3:if(To(a,f),m&64&&(a=f.updateQueue,a!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{Lk(a,c)}catch(C){me(f,f.return,C)}}break;case 27:c===null&&m&4&&XM(f);case 26:case 5:To(a,f),c===null&&m&4&&YM(f),m&512&&gd(f,f.return);break;case 12:To(a,f);break;case 31:To(a,f),m&4&&eD(a,f);break;case 13:To(a,f),m&4&&nD(a,f),m&64&&(a=f.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(f=l6.bind(null,f),k6(a,f))));break;case 22:if(m=f.memoizedState!==null||bo,!m){c=c!==null&&c.memoizedState!==null||gn,b=bo;var _=gn;bo=m,(gn=c)&&!_?So(a,f,(f.subtreeFlags&8772)!==0):To(a,f),bo=b,gn=_}break;case 30:break;default:To(a,f)}}function ZM(a){var c=a.alternate;c!==null&&(a.alternate=null,ZM(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&Su(c)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Le=null,Mr=!1;function _o(a,c,f){for(f=f.child;f!==null;)tD(a,c,f),f=f.sibling}function tD(a,c,f){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(Li,f)}catch{}switch(f.tag){case 26:gn||Is(f,c),_o(a,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:gn||Is(f,c);var m=Le,b=Mr;Ia(f.type)&&(Le=f.stateNode,Mr=!1),_o(a,c,f),Ed(f.stateNode),Le=m,Mr=b;break;case 5:gn||Is(f,c);case 6:if(m=Le,b=Mr,Le=null,_o(a,c,f),Le=m,Mr=b,Le!==null)if(Mr)try{(Le.nodeType===9?Le.body:Le.nodeName==="HTML"?Le.ownerDocument.body:Le).removeChild(f.stateNode)}catch(_){me(f,c,_)}else try{Le.removeChild(f.stateNode)}catch(_){me(f,c,_)}break;case 18:Le!==null&&(Mr?(a=Le,WD(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,f.stateNode),oh(a)):WD(Le,f.stateNode));break;case 4:m=Le,b=Mr,Le=f.stateNode.containerInfo,Mr=!0,_o(a,c,f),Le=m,Mr=b;break;case 0:case 11:case 14:case 15:Ca(2,f,c),gn||Ca(4,f,c),_o(a,c,f);break;case 1:gn||(Is(f,c),m=f.stateNode,typeof m.componentWillUnmount=="function"&&GM(f,c,m)),_o(a,c,f);break;case 21:_o(a,c,f);break;case 22:gn=(m=gn)||f.memoizedState!==null,_o(a,c,f),gn=m;break;default:_o(a,c,f)}}function eD(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{oh(a)}catch(f){me(c,c.return,f)}}}function nD(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{oh(a)}catch(f){me(c,c.return,f)}}function t6(a){switch(a.tag){case 31:case 13:case 19:var c=a.stateNode;return c===null&&(c=a.stateNode=new QM),c;case 22:return a=a.stateNode,c=a._retryCache,c===null&&(c=a._retryCache=new QM),c;default:throw Error(r(435,a.tag))}}function Gg(a,c){var f=t6(a);c.forEach(function(m){if(!f.has(m)){f.add(m);var b=c6.bind(null,a,m);m.then(b,b)}})}function Dr(a,c){var f=c.deletions;if(f!==null)for(var m=0;m<f.length;m++){var b=f[m],_=a,C=c,O=C;t:for(;O!==null;){switch(O.tag){case 27:if(Ia(O.type)){Le=O.stateNode,Mr=!1;break t}break;case 5:Le=O.stateNode,Mr=!1;break t;case 3:case 4:Le=O.stateNode.containerInfo,Mr=!0;break t}O=O.return}if(Le===null)throw Error(r(160));tD(_,C,b),Le=null,Mr=!1,_=b.alternate,_!==null&&(_.return=null),b.return=null}if(c.subtreeFlags&13886)for(c=c.child;c!==null;)rD(c,a),c=c.sibling}var Wi=null;function rD(a,c){var f=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Dr(c,a),Or(a),m&4&&(Ca(3,a,a.return),md(3,a),Ca(5,a,a.return));break;case 1:Dr(c,a),Or(a),m&512&&(gn||f===null||Is(f,f.return)),m&64&&bo&&(a=a.updateQueue,a!==null&&(m=a.callbacks,m!==null&&(f=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=f===null?m:f.concat(m))));break;case 26:var b=Wi;if(Dr(c,a),Or(a),m&512&&(gn||f===null||Is(f,f.return)),m&4){var _=f!==null?f.memoizedState:null;if(m=a.memoizedState,f===null)if(m===null)if(a.stateNode===null){t:{m=a.type,f=a.memoizedProps,b=b.ownerDocument||b;e:switch(m){case"title":_=b.getElementsByTagName("title")[0],(!_||_[bs]||_[un]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=b.createElement(m),b.head.insertBefore(_,b.querySelector("head > title"))),qn(_,m,f),_[un]=a,hn(_),m=_;break t;case"link":var C=rO("link","href",b).get(m+(f.href||""));if(C){for(var O=0;O<C.length;O++)if(_=C[O],_.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&_.getAttribute("rel")===(f.rel==null?null:f.rel)&&_.getAttribute("title")===(f.title==null?null:f.title)&&_.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){C.splice(O,1);break e}}_=b.createElement(m),qn(_,m,f),b.head.appendChild(_);break;case"meta":if(C=rO("meta","content",b).get(m+(f.content||""))){for(O=0;O<C.length;O++)if(_=C[O],_.getAttribute("content")===(f.content==null?null:""+f.content)&&_.getAttribute("name")===(f.name==null?null:f.name)&&_.getAttribute("property")===(f.property==null?null:f.property)&&_.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&_.getAttribute("charset")===(f.charSet==null?null:f.charSet)){C.splice(O,1);break e}}_=b.createElement(m),qn(_,m,f),b.head.appendChild(_);break;default:throw Error(r(468,m))}_[un]=a,hn(_),m=_}a.stateNode=m}else iO(b,a.type,a.stateNode);else a.stateNode=nO(b,m,a.memoizedProps);else _!==m?(_===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):_.count--,m===null?iO(b,a.type,a.stateNode):nO(b,m,a.memoizedProps)):m===null&&a.stateNode!==null&&$T(a,a.memoizedProps,f.memoizedProps)}break;case 27:Dr(c,a),Or(a),m&512&&(gn||f===null||Is(f,f.return)),f!==null&&m&4&&$T(a,a.memoizedProps,f.memoizedProps);break;case 5:if(Dr(c,a),Or(a),m&512&&(gn||f===null||Is(f,f.return)),a.flags&32){b=a.stateNode;try{kr(b,"")}catch(Tt){me(a,a.return,Tt)}}m&4&&a.stateNode!=null&&(b=a.memoizedProps,$T(a,b,f!==null?f.memoizedProps:b)),m&1024&&(GT=!0);break;case 6:if(Dr(c,a),Or(a),m&4){if(a.stateNode===null)throw Error(r(162));m=a.memoizedProps,f=a.stateNode;try{f.nodeValue=m}catch(Tt){me(a,a.return,Tt)}}break;case 3:if(cy=null,b=Wi,Wi=ay(c.containerInfo),Dr(c,a),Wi=b,Or(a),m&4&&f!==null&&f.memoizedState.isDehydrated)try{oh(c.containerInfo)}catch(Tt){me(a,a.return,Tt)}GT&&(GT=!1,iD(a));break;case 4:m=Wi,Wi=ay(a.stateNode.containerInfo),Dr(c,a),Or(a),Wi=m;break;case 12:Dr(c,a),Or(a);break;case 31:Dr(c,a),Or(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Gg(a,m)));break;case 13:Dr(c,a),Or(a),a.child.flags&8192&&a.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Kg=ur()),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Gg(a,m)));break;case 22:b=a.memoizedState!==null;var z=f!==null&&f.memoizedState!==null,Q=bo,rt=gn;if(bo=Q||b,gn=rt||z,Dr(c,a),gn=rt,bo=Q,Or(a),m&8192)t:for(c=a.stateNode,c._visibility=b?c._visibility&-2:c._visibility|1,b&&(f===null||z||bo||gn||vc(a)),f=null,c=a;;){if(c.tag===5||c.tag===26){if(f===null){z=f=c;try{if(_=z.stateNode,b)C=_.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{O=z.stateNode;var lt=z.memoizedProps.style,Z=lt!=null&&lt.hasOwnProperty("display")?lt.display:null;O.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(Tt){me(z,z.return,Tt)}}}else if(c.tag===6){if(f===null){z=c;try{z.stateNode.nodeValue=b?"":z.memoizedProps}catch(Tt){me(z,z.return,Tt)}}}else if(c.tag===18){if(f===null){z=c;try{var nt=z.stateNode;b?GD(nt,!0):GD(z.stateNode,!1)}catch(Tt){me(z,z.return,Tt)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===a)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break t;for(;c.sibling===null;){if(c.return===null||c.return===a)break t;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}m&4&&(m=a.updateQueue,m!==null&&(f=m.retryQueue,f!==null&&(m.retryQueue=null,Gg(a,f))));break;case 19:Dr(c,a),Or(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,Gg(a,m)));break;case 30:break;case 21:break;default:Dr(c,a),Or(a)}}function Or(a){var c=a.flags;if(c&2){try{for(var f,m=a.return;m!==null;){if(KM(m)){f=m;break}m=m.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var b=f.stateNode,_=qT(a);Wg(a,_,b);break;case 5:var C=f.stateNode;f.flags&32&&(kr(C,""),f.flags&=-33);var O=qT(a);Wg(a,O,C);break;case 3:case 4:var z=f.stateNode.containerInfo,Q=qT(a);WT(a,Q,z);break;default:throw Error(r(161))}}catch(rt){me(a,a.return,rt)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function iD(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var c=a;iD(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),a=a.sibling}}function To(a,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)JM(a,c.alternate,c),c=c.sibling}function vc(a){for(a=a.child;a!==null;){var c=a;switch(c.tag){case 0:case 11:case 14:case 15:Ca(4,c,c.return),vc(c);break;case 1:Is(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&GM(c,c.return,f),vc(c);break;case 27:Ed(c.stateNode);case 26:case 5:Is(c,c.return),vc(c);break;case 22:c.memoizedState===null&&vc(c);break;case 30:vc(c);break;default:vc(c)}a=a.sibling}}function So(a,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var m=c.alternate,b=a,_=c,C=_.flags;switch(_.tag){case 0:case 11:case 15:So(b,_,f),md(4,_);break;case 1:if(So(b,_,f),m=_,b=m.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(Q){me(m,m.return,Q)}if(m=_,b=m.updateQueue,b!==null){var O=m.stateNode;try{var z=b.shared.hiddenCallbacks;if(z!==null)for(b.shared.hiddenCallbacks=null,b=0;b<z.length;b++)Nk(z[b],O)}catch(Q){me(m,m.return,Q)}}f&&C&64&&WM(_),gd(_,_.return);break;case 27:XM(_);case 26:case 5:So(b,_,f),f&&m===null&&C&4&&YM(_),gd(_,_.return);break;case 12:So(b,_,f);break;case 31:So(b,_,f),f&&C&4&&eD(b,_);break;case 13:So(b,_,f),f&&C&4&&nD(b,_);break;case 22:_.memoizedState===null&&So(b,_,f),gd(_,_.return);break;case 30:break;default:So(b,_,f)}c=c.sibling}}function YT(a,c){var f=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(f=a.memoizedState.cachePool.pool),a=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(a=c.memoizedState.cachePool.pool),a!==f&&(a!=null&&a.refCount++,f!=null&&nd(f))}function KT(a,c){a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&nd(a))}function Gi(a,c,f,m){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)sD(a,c,f,m),c=c.sibling}function sD(a,c,f,m){var b=c.flags;switch(c.tag){case 0:case 11:case 15:Gi(a,c,f,m),b&2048&&md(9,c);break;case 1:Gi(a,c,f,m);break;case 3:Gi(a,c,f,m),b&2048&&(a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&nd(a)));break;case 12:if(b&2048){Gi(a,c,f,m),a=c.stateNode;try{var _=c.memoizedProps,C=_.id,O=_.onPostCommit;typeof O=="function"&&O(C,c.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(z){me(c,c.return,z)}}else Gi(a,c,f,m);break;case 31:Gi(a,c,f,m);break;case 13:Gi(a,c,f,m);break;case 23:break;case 22:_=c.stateNode,C=c.alternate,c.memoizedState!==null?_._visibility&2?Gi(a,c,f,m):yd(a,c):_._visibility&2?Gi(a,c,f,m):(_._visibility|=2,Ku(a,c,f,m,(c.subtreeFlags&10256)!==0||!1)),b&2048&&YT(C,c);break;case 24:Gi(a,c,f,m),b&2048&&KT(c.alternate,c);break;default:Gi(a,c,f,m)}}function Ku(a,c,f,m,b){for(b=b&&((c.subtreeFlags&10256)!==0||!1),c=c.child;c!==null;){var _=a,C=c,O=f,z=m,Q=C.flags;switch(C.tag){case 0:case 11:case 15:Ku(_,C,O,z,b),md(8,C);break;case 23:break;case 22:var rt=C.stateNode;C.memoizedState!==null?rt._visibility&2?Ku(_,C,O,z,b):yd(_,C):(rt._visibility|=2,Ku(_,C,O,z,b)),b&&Q&2048&&YT(C.alternate,C);break;case 24:Ku(_,C,O,z,b),b&&Q&2048&&KT(C.alternate,C);break;default:Ku(_,C,O,z,b)}c=c.sibling}}function yd(a,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=a,m=c,b=m.flags;switch(m.tag){case 22:yd(f,m),b&2048&&YT(m.alternate,m);break;case 24:yd(f,m),b&2048&&KT(m.alternate,m);break;default:yd(f,m)}c=c.sibling}}var vd=8192;function Xu(a,c,f){if(a.subtreeFlags&vd)for(a=a.child;a!==null;)oD(a,c,f),a=a.sibling}function oD(a,c,f){switch(a.tag){case 26:Xu(a,c,f),a.flags&vd&&a.memoizedState!==null&&B6(f,Wi,a.memoizedState,a.memoizedProps);break;case 5:Xu(a,c,f);break;case 3:case 4:var m=Wi;Wi=ay(a.stateNode.containerInfo),Xu(a,c,f),Wi=m;break;case 22:a.memoizedState===null&&(m=a.alternate,m!==null&&m.memoizedState!==null?(m=vd,vd=16777216,Xu(a,c,f),vd=m):Xu(a,c,f));break;default:Xu(a,c,f)}}function aD(a){var c=a.alternate;if(c!==null&&(a=c.child,a!==null)){c.child=null;do c=a.sibling,a.sibling=null,a=c;while(a!==null)}}function bd(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var m=c[f];Rn=m,cD(m,a)}aD(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)lD(a),a=a.sibling}function lD(a){switch(a.tag){case 0:case 11:case 15:bd(a),a.flags&2048&&Ca(9,a,a.return);break;case 3:bd(a);break;case 12:bd(a);break;case 22:var c=a.stateNode;a.memoizedState!==null&&c._visibility&2&&(a.return===null||a.return.tag!==13)?(c._visibility&=-3,Yg(a)):bd(a);break;default:bd(a)}}function Yg(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var m=c[f];Rn=m,cD(m,a)}aD(a)}for(a=a.child;a!==null;){switch(c=a,c.tag){case 0:case 11:case 15:Ca(8,c,c.return),Yg(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,Yg(c));break;default:Yg(c)}a=a.sibling}}function cD(a,c){for(;Rn!==null;){var f=Rn;switch(f.tag){case 0:case 11:case 15:Ca(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var m=f.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:nd(f.memoizedState.cache)}if(m=f.child,m!==null)m.return=f,Rn=m;else t:for(f=a;Rn!==null;){m=Rn;var b=m.sibling,_=m.return;if(ZM(m),m===f){Rn=null;break t}if(b!==null){b.return=_,Rn=b;break t}Rn=_}}}var e6={getCacheForType:function(a){var c=Hn(dn),f=c.data.get(a);return f===void 0&&(f=a(),c.data.set(a,f)),f},cacheSignal:function(){return Hn(dn).controller.signal}},n6=typeof WeakMap=="function"?WeakMap:Map,ce=0,Ce=null,Yt=null,Xt=0,pe=0,Yr=null,Aa=!1,Qu=!1,XT=!1,wo=0,We=0,ka=0,bc=0,QT=0,Kr=0,Ju=0,_d=null,Rr=null,JT=!1,Kg=0,uD=0,Xg=1/0,Qg=null,Ma=null,xn=0,Da=null,Zu=null,xo=0,ZT=0,tS=null,hD=null,Td=0,eS=null;function Xr(){return(ce&2)!==0&&Xt!==0?Xt&-Xt:J.T!==null?aS():Jm()}function fD(){if(Kr===0)if((Xt&536870912)===0||ee){var a=Wl;Wl<<=1,(Wl&3932160)===0&&(Wl=262144),Kr=a}else Kr=536870912;return a=Wr.current,a!==null&&(a.flags|=32),Kr}function Ir(a,c,f){(a===Ce&&(pe===2||pe===9)||a.cancelPendingCommit!==null)&&(th(a,0),Oa(a,Xt,Kr,!1)),Gl(a,f),((ce&2)===0||a!==Ce)&&(a===Ce&&((ce&2)===0&&(bc|=f),We===4&&Oa(a,Xt,Kr,!1)),Ps(a))}function dD(a,c,f){if((ce&6)!==0)throw Error(r(327));var m=!f&&(c&127)===0&&(c&a.expiredLanes)===0||Vi(a,c),b=m?s6(a,c):rS(a,c,!0),_=m;do{if(b===0){Qu&&!m&&Oa(a,c,0,!1);break}else{if(f=a.current.alternate,_&&!r6(f)){b=rS(a,c,!1),_=!1;continue}if(b===2){if(_=c,a.errorRecoveryDisabledLanes&_)var C=0;else C=a.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){c=C;t:{var O=a;b=_d;var z=O.current.memoizedState.isDehydrated;if(z&&(th(O,C).flags|=256),C=rS(O,C,!1),C!==2){if(XT&&!z){O.errorRecoveryDisabledLanes|=_,bc|=_,b=4;break t}_=Rr,Rr=b,_!==null&&(Rr===null?Rr=_:Rr.push.apply(Rr,_))}b=C}if(_=!1,b!==2)continue}}if(b===1){th(a,0),Oa(a,c,0,!0);break}t:{switch(m=a,_=b,_){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:Oa(m,c,Kr,!Aa);break t;case 2:Rr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(b=Kg+300-ur(),10<b)){if(Oa(m,c,Kr,!Aa),gs(m,0,!0)!==0)break t;xo=c,m.timeoutHandle=$D(pD.bind(null,m,f,Rr,Qg,JT,c,Kr,bc,Ju,Aa,_,"Throttled",-0,0),b);break t}pD(m,f,Rr,Qg,JT,c,Kr,bc,Ju,Aa,_,null,-0,0)}}break}while(!0);Ps(a)}function pD(a,c,f,m,b,_,C,O,z,Q,rt,lt,Z,nt){if(a.timeoutHandle=-1,lt=c.subtreeFlags,lt&8192||(lt&16785408)===16785408){lt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Bi},oD(c,_,lt);var Tt=(_&62914560)===_?Kg-ur():(_&4194048)===_?uD-ur():0;if(Tt=U6(lt,Tt),Tt!==null){xo=_,a.cancelPendingCommit=Tt(SD.bind(null,a,c,_,f,m,b,C,O,z,rt,lt,null,Z,nt)),Oa(a,_,C,!Q);return}}SD(a,c,_,f,m,b,C,O,z)}function r6(a){for(var c=a;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var m=0;m<f.length;m++){var b=f[m],_=b.getSnapshot;b=b.value;try{if(!$r(_(),b))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Oa(a,c,f,m){c&=~QT,c&=~bc,a.suspendedLanes|=c,a.pingedLanes&=~c,m&&(a.warmLanes|=c),m=a.expirationTimes;for(var b=c;0<b;){var _=31-tn(b),C=1<<_;m[_]=-1,b&=~C}f!==0&&Yl(a,f,c)}function Jg(){return(ce&6)===0?(Sd(0),!1):!0}function nS(){if(Yt!==null){if(pe===0)var a=Yt.return;else a=Yt,fo=uc=null,vT(a),$u=null,id=0,a=Yt;for(;a!==null;)qM(a.alternate,a),a=a.return;Yt=null}}function th(a,c){var f=a.timeoutHandle;f!==-1&&(a.timeoutHandle=-1,w6(f)),f=a.cancelPendingCommit,f!==null&&(a.cancelPendingCommit=null,f()),xo=0,nS(),Ce=a,Yt=f=uo(a.current,null),Xt=c,pe=0,Yr=null,Aa=!1,Qu=Vi(a,c),XT=!1,Ju=Kr=QT=bc=ka=We=0,Rr=_d=null,JT=!1,(c&8)!==0&&(c|=c&32);var m=a.entangledLanes;if(m!==0)for(a=a.entanglements,m&=c;0<m;){var b=31-tn(m),_=1<<b;c|=a[b],m&=~_}return wo=c,bg(),f}function mD(a,c){Ht=null,J.H=fd,c===Hu||c===Ag?(c=Ok(),pe=3):c===oT?(c=Ok(),pe=4):pe=c===PT?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Yr=c,Yt===null&&(We=1,Ug(a,mi(c,a.current)))}function gD(){var a=Wr.current;return a===null?!0:(Xt&4194048)===Xt?bi===null:(Xt&62914560)===Xt||(Xt&536870912)!==0?a===bi:!1}function yD(){var a=J.H;return J.H=fd,a===null?fd:a}function vD(){var a=J.A;return J.A=e6,a}function Zg(){We=4,Aa||(Xt&4194048)!==Xt&&Wr.current!==null||(Qu=!0),(ka&134217727)===0&&(bc&134217727)===0||Ce===null||Oa(Ce,Xt,Kr,!1)}function rS(a,c,f){var m=ce;ce|=2;var b=yD(),_=vD();(Ce!==a||Xt!==c)&&(Qg=null,th(a,c)),c=!1;var C=We;t:do try{if(pe!==0&&Yt!==null){var O=Yt,z=Yr;switch(pe){case 8:nS(),C=6;break t;case 3:case 2:case 9:case 6:Wr.current===null&&(c=!0);var Q=pe;if(pe=0,Yr=null,eh(a,O,z,Q),f&&Qu){C=0;break t}break;default:Q=pe,pe=0,Yr=null,eh(a,O,z,Q)}}i6(),C=We;break}catch(rt){mD(a,rt)}while(!0);return c&&a.shellSuspendCounter++,fo=uc=null,ce=m,J.H=b,J.A=_,Yt===null&&(Ce=null,Xt=0,bg()),C}function i6(){for(;Yt!==null;)bD(Yt)}function s6(a,c){var f=ce;ce|=2;var m=yD(),b=vD();Ce!==a||Xt!==c?(Qg=null,Xg=ur()+500,th(a,c)):Qu=Vi(a,c);t:do try{if(pe!==0&&Yt!==null){c=Yt;var _=Yr;e:switch(pe){case 1:pe=0,Yr=null,eh(a,c,_,1);break;case 2:case 9:if(Mk(_)){pe=0,Yr=null,_D(c);break}c=function(){pe!==2&&pe!==9||Ce!==a||(pe=7),Ps(a)},_.then(c,c);break t;case 3:pe=7;break t;case 4:pe=5;break t;case 7:Mk(_)?(pe=0,Yr=null,_D(c)):(pe=0,Yr=null,eh(a,c,_,7));break;case 5:var C=null;switch(Yt.tag){case 26:C=Yt.memoizedState;case 5:case 27:var O=Yt;if(C?sO(C):O.stateNode.complete){pe=0,Yr=null;var z=O.sibling;if(z!==null)Yt=z;else{var Q=O.return;Q!==null?(Yt=Q,ty(Q)):Yt=null}break e}}pe=0,Yr=null,eh(a,c,_,5);break;case 6:pe=0,Yr=null,eh(a,c,_,6);break;case 8:nS(),We=6;break t;default:throw Error(r(462))}}o6();break}catch(rt){mD(a,rt)}while(!0);return fo=uc=null,J.H=m,J.A=b,ce=f,Yt!==null?0:(Ce=null,Xt=0,bg(),We)}function o6(){for(;Yt!==null&&!I_();)bD(Yt)}function bD(a){var c=HM(a.alternate,a,wo);a.memoizedProps=a.pendingProps,c===null?ty(a):Yt=c}function _D(a){var c=a,f=c.alternate;switch(c.tag){case 15:case 0:c=VM(f,c,c.pendingProps,c.type,void 0,Xt);break;case 11:c=VM(f,c,c.pendingProps,c.type.render,c.ref,Xt);break;case 5:vT(c);default:qM(f,c),c=Yt=vk(c,wo),c=HM(f,c,wo)}a.memoizedProps=a.pendingProps,c===null?ty(a):Yt=c}function eh(a,c,f,m){fo=uc=null,vT(c),$u=null,id=0;var b=c.return;try{if(Yz(a,b,c,f,Xt)){We=1,Ug(a,mi(f,a.current)),Yt=null;return}}catch(_){if(b!==null)throw Yt=b,_;We=1,Ug(a,mi(f,a.current)),Yt=null;return}c.flags&32768?(ee||m===1?a=!0:Qu||(Xt&536870912)!==0?a=!1:(Aa=a=!0,(m===2||m===9||m===3||m===6)&&(m=Wr.current,m!==null&&m.tag===13&&(m.flags|=16384))),TD(c,a)):ty(c)}function ty(a){var c=a;do{if((c.flags&32768)!==0){TD(c,Aa);return}a=c.return;var f=Qz(c.alternate,c,wo);if(f!==null){Yt=f;return}if(c=c.sibling,c!==null){Yt=c;return}Yt=c=a}while(c!==null);We===0&&(We=5)}function TD(a,c){do{var f=Jz(a.alternate,a);if(f!==null){f.flags&=32767,Yt=f;return}if(f=a.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(a=a.sibling,a!==null)){Yt=a;return}Yt=a=f}while(a!==null);We=6,Yt=null}function SD(a,c,f,m,b,_,C,O,z){a.cancelPendingCommit=null;do ey();while(xn!==0);if((ce&6)!==0)throw Error(r(327));if(c!==null){if(c===a.current)throw Error(r(177));if(_=c.lanes|c.childLanes,_|=q_,L_(a,f,_,C,O,z),a===Ce&&(Yt=Ce=null,Xt=0),Zu=c,Da=a,xo=f,ZT=_,tS=b,hD=m,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,u6(aa,function(){return AD(),null})):(a.callbackNode=null,a.callbackPriority=0),m=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||m){m=J.T,J.T=null,b=st.p,st.p=2,C=ce,ce|=4;try{Zz(a,c,f)}finally{ce=C,st.p=b,J.T=m}}xn=1,wD(),xD(),ED()}}function wD(){if(xn===1){xn=0;var a=Da,c=Zu,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=J.T,J.T=null;var m=st.p;st.p=2;var b=ce;ce|=4;try{rD(c,a);var _=mS,C=ck(a.containerInfo),O=_.focusedElem,z=_.selectionRange;if(C!==O&&O&&O.ownerDocument&&lk(O.ownerDocument.documentElement,O)){if(z!==null&&B_(O)){var Q=z.start,rt=z.end;if(rt===void 0&&(rt=Q),"selectionStart"in O)O.selectionStart=Q,O.selectionEnd=Math.min(rt,O.value.length);else{var lt=O.ownerDocument||document,Z=lt&&lt.defaultView||window;if(Z.getSelection){var nt=Z.getSelection(),Tt=O.textContent.length,Pt=Math.min(z.start,Tt),we=z.end===void 0?Pt:Math.min(z.end,Tt);!nt.extend&&Pt>we&&(C=we,we=Pt,Pt=C);var Y=ak(O,Pt),G=ak(O,we);if(Y&&G&&(nt.rangeCount!==1||nt.anchorNode!==Y.node||nt.anchorOffset!==Y.offset||nt.focusNode!==G.node||nt.focusOffset!==G.offset)){var X=lt.createRange();X.setStart(Y.node,Y.offset),nt.removeAllRanges(),Pt>we?(nt.addRange(X),nt.extend(G.node,G.offset)):(X.setEnd(G.node,G.offset),nt.addRange(X))}}}}for(lt=[],nt=O;nt=nt.parentNode;)nt.nodeType===1&&lt.push({element:nt,left:nt.scrollLeft,top:nt.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<lt.length;O++){var at=lt[O];at.element.scrollLeft=at.left,at.element.scrollTop=at.top}}dy=!!pS,mS=pS=null}finally{ce=b,st.p=m,J.T=f}}a.current=c,xn=2}}function xD(){if(xn===2){xn=0;var a=Da,c=Zu,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=J.T,J.T=null;var m=st.p;st.p=2;var b=ce;ce|=4;try{JM(a,c.alternate,c)}finally{ce=b,st.p=m,J.T=f}}xn=3}}function ED(){if(xn===4||xn===3){xn=0,qm();var a=Da,c=Zu,f=xo,m=hD;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?xn=5:(xn=0,Zu=Da=null,CD(a,a.pendingLanes));var b=a.pendingLanes;if(b===0&&(Ma=null),oo(f),c=c.stateNode,Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(Li,c,void 0,(c.current.flags&128)===128)}catch{}if(m!==null){c=J.T,b=st.p,st.p=2,J.T=null;try{for(var _=a.onRecoverableError,C=0;C<m.length;C++){var O=m[C];_(O.value,{componentStack:O.stack})}}finally{J.T=c,st.p=b}}(xo&3)!==0&&ey(),Ps(a),b=a.pendingLanes,(f&261930)!==0&&(b&42)!==0?a===eS?Td++:(Td=0,eS=a):Td=0,Sd(0)}}function CD(a,c){(a.pooledCacheLanes&=c)===0&&(c=a.pooledCache,c!=null&&(a.pooledCache=null,nd(c)))}function ey(){return wD(),xD(),ED(),AD()}function AD(){if(xn!==5)return!1;var a=Da,c=ZT;ZT=0;var f=oo(xo),m=J.T,b=st.p;try{st.p=32>f?32:f,J.T=null,f=tS,tS=null;var _=Da,C=xo;if(xn=0,Zu=Da=null,xo=0,(ce&6)!==0)throw Error(r(331));var O=ce;if(ce|=4,lD(_.current),sD(_,_.current,C,f),ce=O,Sd(0,!1),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(Li,_)}catch{}return!0}finally{st.p=b,J.T=m,CD(a,c)}}function kD(a,c,f){c=mi(f,c),c=IT(a.stateNode,c,2),a=wa(a,c,2),a!==null&&(Gl(a,2),Ps(a))}function me(a,c,f){if(a.tag===3)kD(a,a,f);else for(;c!==null;){if(c.tag===3){kD(c,a,f);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Ma===null||!Ma.has(m))){a=mi(f,a),f=MM(2),m=wa(c,f,2),m!==null&&(DM(f,m,c,a),Gl(m,2),Ps(m));break}}c=c.return}}function iS(a,c,f){var m=a.pingCache;if(m===null){m=a.pingCache=new n6;var b=new Set;m.set(c,b)}else b=m.get(c),b===void 0&&(b=new Set,m.set(c,b));b.has(f)||(XT=!0,b.add(f),a=a6.bind(null,a,c,f),c.then(a,a))}function a6(a,c,f){var m=a.pingCache;m!==null&&m.delete(c),a.pingedLanes|=a.suspendedLanes&f,a.warmLanes&=~f,Ce===a&&(Xt&f)===f&&(We===4||We===3&&(Xt&62914560)===Xt&&300>ur()-Kg?(ce&2)===0&&th(a,0):QT|=f,Ju===Xt&&(Ju=0)),Ps(a)}function MD(a,c){c===0&&(c=Qm()),a=ac(a,c),a!==null&&(Gl(a,c),Ps(a))}function l6(a){var c=a.memoizedState,f=0;c!==null&&(f=c.retryLane),MD(a,f)}function c6(a,c){var f=0;switch(a.tag){case 31:case 13:var m=a.stateNode,b=a.memoizedState;b!==null&&(f=b.retryLane);break;case 19:m=a.stateNode;break;case 22:m=a.stateNode._retryCache;break;default:throw Error(r(314))}m!==null&&m.delete(c),MD(a,f)}function u6(a,c){return wn(a,c)}var ny=null,nh=null,sS=!1,ry=!1,oS=!1,Ra=0;function Ps(a){a!==nh&&a.next===null&&(nh===null?ny=nh=a:nh=nh.next=a),ry=!0,sS||(sS=!0,f6())}function Sd(a,c){if(!oS&&ry){oS=!0;do for(var f=!1,m=ny;m!==null;){if(a!==0){var b=m.pendingLanes;if(b===0)var _=0;else{var C=m.suspendedLanes,O=m.pingedLanes;_=(1<<31-tn(42|a)+1)-1,_&=b&~(C&~O),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(f=!0,ID(m,_))}else _=Xt,_=gs(m,m===Ce?_:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(_&3)===0||Vi(m,_)||(f=!0,ID(m,_));m=m.next}while(f);oS=!1}}function h6(){DD()}function DD(){ry=sS=!1;var a=0;Ra!==0&&S6()&&(a=Ra);for(var c=ur(),f=null,m=ny;m!==null;){var b=m.next,_=OD(m,c);_===0?(m.next=null,f===null?ny=b:f.next=b,b===null&&(nh=f)):(f=m,(a!==0||(_&3)!==0)&&(ry=!0)),m=b}xn!==0&&xn!==5||Sd(a),Ra!==0&&(Ra=0)}function OD(a,c){for(var f=a.suspendedLanes,m=a.pingedLanes,b=a.expirationTimes,_=a.pendingLanes&-62914561;0<_;){var C=31-tn(_),O=1<<C,z=b[C];z===-1?((O&f)===0||(O&m)!==0)&&(b[C]=N_(O,c)):z<=c&&(a.expiredLanes|=O),_&=~O}if(c=Ce,f=Xt,f=gs(a,a===c?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m=a.callbackNode,f===0||a===c&&(pe===2||pe===9)||a.cancelPendingCommit!==null)return m!==null&&m!==null&&oa(m),a.callbackNode=null,a.callbackPriority=0;if((f&3)===0||Vi(a,f)){if(c=f&-f,c===a.callbackPriority)return c;switch(m!==null&&oa(m),oo(f)){case 2:case 8:f=Rf;break;case 32:f=aa;break;case 268435456:f=Wm;break;default:f=aa}return m=RD.bind(null,a),f=wn(f,m),a.callbackPriority=c,a.callbackNode=f,c}return m!==null&&m!==null&&oa(m),a.callbackPriority=2,a.callbackNode=null,2}function RD(a,c){if(xn!==0&&xn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var f=a.callbackNode;if(ey()&&a.callbackNode!==f)return null;var m=Xt;return m=gs(a,a===Ce?m:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m===0?null:(dD(a,m,c),OD(a,ur()),a.callbackNode!=null&&a.callbackNode===f?RD.bind(null,a):null)}function ID(a,c){if(ey())return null;dD(a,c,!0)}function f6(){x6(function(){(ce&6)!==0?wn(Of,h6):DD()})}function aS(){if(Ra===0){var a=Uu;a===0&&(a=ps,ps<<=1,(ps&261888)===0&&(ps=256)),Ra=a}return Ra}function PD(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Cu(""+a)}function ND(a,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,a.id&&f.setAttribute("form",a.id),c.parentNode.insertBefore(f,c),a=new FormData(a),f.parentNode.removeChild(f),a}function d6(a,c,f,m,b){if(c==="submit"&&f&&f.stateNode===b){var _=PD((b[Dn]||null).action),C=m.submitter;C&&(c=(c=C[Dn]||null)?PD(c.formAction):C.getAttribute("formAction"),c!==null&&(_=c,C=null));var O=new As("action","action",null,m,b);a.push({event:O,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Ra!==0){var z=C?ND(b,C):new FormData(b);AT(f,{pending:!0,data:z,method:b.method,action:_},null,z)}}else typeof _=="function"&&(O.preventDefault(),z=C?ND(b,C):new FormData(b),AT(f,{pending:!0,data:z,method:b.method,action:_},_,z))},currentTarget:b}]})}}for(var lS=0;lS<$_.length;lS++){var cS=$_[lS],p6=cS.toLowerCase(),m6=cS[0].toUpperCase()+cS.slice(1);qi(p6,"on"+m6)}qi(fk,"onAnimationEnd"),qi(dk,"onAnimationIteration"),qi(pk,"onAnimationStart"),qi("dblclick","onDoubleClick"),qi("focusin","onFocus"),qi("focusout","onBlur"),qi(Oz,"onTransitionRun"),qi(Rz,"onTransitionStart"),qi(Iz,"onTransitionCancel"),qi(mk,"onTransitionEnd"),ws("onMouseEnter",["mouseout","mouseover"]),ws("onMouseLeave",["mouseout","mouseover"]),ws("onPointerEnter",["pointerout","pointerover"]),ws("onPointerLeave",["pointerout","pointerover"]),Ss("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ss("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ss("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ss("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ss("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ss("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(wd));function LD(a,c){c=(c&4)!==0;for(var f=0;f<a.length;f++){var m=a[f],b=m.event;m=m.listeners;t:{var _=void 0;if(c)for(var C=m.length-1;0<=C;C--){var O=m[C],z=O.instance,Q=O.currentTarget;if(O=O.listener,z!==_&&b.isPropagationStopped())break t;_=O,b.currentTarget=Q;try{_(b)}catch(rt){vg(rt)}b.currentTarget=null,_=z}else for(C=0;C<m.length;C++){if(O=m[C],z=O.instance,Q=O.currentTarget,O=O.listener,z!==_&&b.isPropagationStopped())break t;_=O,b.currentTarget=Q;try{_(b)}catch(rt){vg(rt)}b.currentTarget=null,_=z}}}}function Kt(a,c){var f=c[Tu];f===void 0&&(f=c[Tu]=new Set);var m=a+"__bubble";f.has(m)||(VD(c,a,2,!1),f.add(m))}function uS(a,c,f){var m=0;c&&(m|=4),VD(f,a,m,c)}var iy="_reactListening"+Math.random().toString(36).slice(2);function hS(a){if(!a[iy]){a[iy]=!0,Nf.forEach(function(f){f!=="selectionchange"&&(g6.has(f)||uS(f,!1,a),uS(f,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[iy]||(c[iy]=!0,uS("selectionchange",!1,c))}}function VD(a,c,f,m){switch(fO(c)){case 2:var b=$6;break;case 8:b=q6;break;default:b=CS}f=b.bind(null,c,f,a),b=void 0,!Zl||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(b=!0),m?b!==void 0?a.addEventListener(c,f,{capture:!0,passive:b}):a.addEventListener(c,f,!0):b!==void 0?a.addEventListener(c,f,{passive:b}):a.addEventListener(c,f,!1)}function fS(a,c,f,m,b){var _=m;if((c&1)===0&&(c&2)===0&&m!==null)t:for(;;){if(m===null)return;var C=m.tag;if(C===3||C===4){var O=m.stateNode.containerInfo;if(O===b)break;if(C===4)for(C=m.return;C!==null;){var z=C.tag;if((z===3||z===4)&&C.stateNode.containerInfo===b)return;C=C.return}for(;O!==null;){if(C=_s(O),C===null)return;if(z=C.tag,z===5||z===6||z===26||z===27){m=_=C;continue t}O=O.parentNode}}m=m.return}da(function(){var Q=_,rt=hi(f),lt=[];t:{var Z=gk.get(a);if(Z!==void 0){var nt=As,Tt=a;switch(a){case"keypress":if(ec(f)===0)break t;case"keydown":case"keyup":nt=mg;break;case"focusin":Tt="focus",nt=rc;break;case"focusout":Tt="blur",nt=rc;break;case"beforeblur":case"afterblur":nt=rc;break;case"click":if(f.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Yf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=og;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=x;break;case fk:case dk:case pk:nt=lg;break;case mk:nt=I;break;case"scroll":case"scrollend":nt=Gf;break;case"wheel":nt=et;break;case"copy":case"cut":case"paste":nt=cg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=co;break;case"toggle":case"beforetoggle":nt=zt}var Pt=(c&4)!==0,we=!Pt&&(a==="scroll"||a==="scrollend"),Y=Pt?Z!==null?Z+"Capture":null:Z;Pt=[];for(var G=Q,X;G!==null;){var at=G;if(X=at.stateNode,at=at.tag,at!==5&&at!==26&&at!==27||X===null||Y===null||(at=Ui(G,Y),at!=null&&Pt.push(xd(G,at,X))),we)break;G=G.return}0<Pt.length&&(Z=new nt(Z,Tt,null,f,rt),lt.push({event:Z,listeners:Pt}))}}if((c&7)===0){t:{if(Z=a==="mouseover"||a==="pointerover",nt=a==="mouseout"||a==="pointerout",Z&&f!==$f&&(Tt=f.relatedTarget||f.fromElement)&&(_s(Tt)||Tt[vs]))break t;if((nt||Z)&&(Z=rt.window===rt?rt:(Z=rt.ownerDocument)?Z.defaultView||Z.parentWindow:window,nt?(Tt=f.relatedTarget||f.toElement,nt=Q,Tt=Tt?_s(Tt):null,Tt!==null&&(we=s(Tt),Pt=Tt.tag,Tt!==we||Pt!==5&&Pt!==27&&Pt!==6)&&(Tt=null)):(nt=null,Tt=Q),nt!==Tt)){if(Pt=Yf,at="onMouseLeave",Y="onMouseEnter",G="mouse",(a==="pointerout"||a==="pointerover")&&(Pt=co,at="onPointerLeave",Y="onPointerEnter",G="pointer"),we=nt==null?Z:zr(nt),X=Tt==null?Z:zr(Tt),Z=new Pt(at,G+"leave",nt,f,rt),Z.target=we,Z.relatedTarget=X,at=null,_s(rt)===Q&&(Pt=new Pt(Y,G+"enter",Tt,f,rt),Pt.target=X,Pt.relatedTarget=we,at=Pt),we=at,nt&&Tt)e:{for(Pt=y6,Y=nt,G=Tt,X=0,at=Y;at;at=Pt(at))X++;at=0;for(var kt=G;kt;kt=Pt(kt))at++;for(;0<X-at;)Y=Pt(Y),X--;for(;0<at-X;)G=Pt(G),at--;for(;X--;){if(Y===G||G!==null&&Y===G.alternate){Pt=Y;break e}Y=Pt(Y),G=Pt(G)}Pt=null}else Pt=null;nt!==null&&jD(lt,Z,nt,Pt,!1),Tt!==null&&we!==null&&jD(lt,we,Tt,Pt,!0)}}t:{if(Z=Q?zr(Q):window,nt=Z.nodeName&&Z.nodeName.toLowerCase(),nt==="select"||nt==="input"&&Z.type==="file")var oe=ek;else if(ZA(Z))if(nk)oe=kz;else{oe=Cz;var wt=Ez}else nt=Z.nodeName,!nt||nt.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?Q&&Eu(Q.elementType)&&(oe=ek):oe=Az;if(oe&&(oe=oe(a,Q))){tk(lt,oe,f,rt);break t}wt&&wt(a,Z,Q),a==="focusout"&&Q&&Z.type==="number"&&Q.memoizedProps.value!=null&&Uf(Z,"number",Z.value)}switch(wt=Q?zr(Q):window,a){case"focusin":(ZA(wt)||wt.contentEditable==="true")&&(Iu=wt,U_=Q,Zf=null);break;case"focusout":Zf=U_=Iu=null;break;case"mousedown":z_=!0;break;case"contextmenu":case"mouseup":case"dragend":z_=!1,uk(lt,f,rt);break;case"selectionchange":if(Dz)break;case"keydown":case"keyup":uk(lt,f,rt)}var $t;if(le)t:{switch(a){case"compositionstart":var Qt="onCompositionStart";break t;case"compositionend":Qt="onCompositionEnd";break t;case"compositionupdate":Qt="onCompositionUpdate";break t}Qt=void 0}else Ru?ic(a,f)&&(Qt="onCompositionEnd"):a==="keydown"&&f.keyCode===229&&(Qt="onCompositionStart");Qt&&(Ds&&f.locale!=="ko"&&(Ru||Qt!=="onCompositionStart"?Qt==="onCompositionEnd"&&Ru&&($t=Wf()):(Cs=rt,qf="value"in Cs?Cs.value:Cs.textContent,Ru=!0)),wt=sy(Q,Qt),0<wt.length&&(Qt=new Ms(Qt,a,null,f,rt),lt.push({event:Qt,listeners:wt}),$t?Qt.data=$t:($t=Ou(f),$t!==null&&(Qt.data=$t)))),($t=di?Tz(a,f):Sz(a,f))&&(Qt=sy(Q,"onBeforeInput"),0<Qt.length&&(wt=new Ms("onBeforeInput","beforeinput",null,f,rt),lt.push({event:wt,listeners:Qt}),wt.data=$t)),d6(lt,a,Q,f,rt)}LD(lt,c)})}function xd(a,c,f){return{instance:a,listener:c,currentTarget:f}}function sy(a,c){for(var f=c+"Capture",m=[];a!==null;){var b=a,_=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||_===null||(b=Ui(a,f),b!=null&&m.unshift(xd(a,b,_)),b=Ui(a,c),b!=null&&m.push(xd(a,b,_))),a.tag===3)return m;a=a.return}return[]}function y6(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function jD(a,c,f,m,b){for(var _=c._reactName,C=[];f!==null&&f!==m;){var O=f,z=O.alternate,Q=O.stateNode;if(O=O.tag,z!==null&&z===m)break;O!==5&&O!==26&&O!==27||Q===null||(z=Q,b?(Q=Ui(f,_),Q!=null&&C.unshift(xd(f,Q,z))):b||(Q=Ui(f,_),Q!=null&&C.push(xd(f,Q,z)))),f=f.return}C.length!==0&&a.push({event:c,listeners:C})}var v6=/\r\n?/g,b6=/\u0000|\uFFFD/g;function FD(a){return(typeof a=="string"?a:""+a).replace(v6,`
`).replace(b6,"")}function BD(a,c){return c=FD(c),FD(a)===c}function Se(a,c,f,m,b,_){switch(f){case"children":typeof m=="string"?c==="body"||c==="textarea"&&m===""||kr(a,m):(typeof m=="number"||typeof m=="bigint")&&c!=="body"&&kr(a,""+m);break;case"className":Hr(a,"class",m);break;case"tabIndex":Hr(a,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Hr(a,f,m);break;case"style":Hf(a,m,_);break;case"data":if(c!=="object"){Hr(a,"data",m);break}case"src":case"href":if(m===""&&(c!=="a"||f!=="href")){a.removeAttribute(f);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(f);break}m=Cu(""+m),a.setAttribute(f,m);break;case"action":case"formAction":if(typeof m=="function"){a.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(f==="formAction"?(c!=="input"&&Se(a,c,"name",b.name,b,null),Se(a,c,"formEncType",b.formEncType,b,null),Se(a,c,"formMethod",b.formMethod,b,null),Se(a,c,"formTarget",b.formTarget,b,null)):(Se(a,c,"encType",b.encType,b,null),Se(a,c,"method",b.method,b,null),Se(a,c,"target",b.target,b,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(f);break}m=Cu(""+m),a.setAttribute(f,m);break;case"onClick":m!=null&&(a.onclick=Bi);break;case"onScroll":m!=null&&Kt("scroll",a);break;case"onScrollEnd":m!=null&&Kt("scrollend",a);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(f=m.__html,f!=null){if(b.children!=null)throw Error(r(60));a.innerHTML=f}}break;case"multiple":a.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":a.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){a.removeAttribute("xlink:href");break}f=Cu(""+m),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(f,""+m):a.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(f,""):a.removeAttribute(f);break;case"capture":case"download":m===!0?a.setAttribute(f,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(f,m):a.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?a.setAttribute(f,m):a.removeAttribute(f);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?a.removeAttribute(f):a.setAttribute(f,m);break;case"popover":Kt("beforetoggle",a),Kt("toggle",a),wu(a,"popover",m);break;case"xlinkActuate":fn(a,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":fn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":fn(a,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":fn(a,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":fn(a,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":fn(a,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":fn(a,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":fn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":fn(a,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":wu(a,"is",m);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=sg.get(f)||f,wu(a,f,m))}}function dS(a,c,f,m,b,_){switch(f){case"style":Hf(a,m,_);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(f=m.__html,f!=null){if(b.children!=null)throw Error(r(60));a.innerHTML=f}}break;case"children":typeof m=="string"?kr(a,m):(typeof m=="number"||typeof m=="bigint")&&kr(a,""+m);break;case"onScroll":m!=null&&Kt("scroll",a);break;case"onScrollEnd":m!=null&&Kt("scrollend",a);break;case"onClick":m!=null&&(a.onclick=Bi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lf.hasOwnProperty(f))t:{if(f[0]==="o"&&f[1]==="n"&&(b=f.endsWith("Capture"),c=f.slice(2,b?f.length-7:void 0),_=a[Dn]||null,_=_!=null?_[f]:null,typeof _=="function"&&a.removeEventListener(c,_,b),typeof m=="function")){typeof _!="function"&&_!==null&&(f in a?a[f]=null:a.hasAttribute(f)&&a.removeAttribute(f)),a.addEventListener(c,m,b);break t}f in a?a[f]=m:m===!0?a.setAttribute(f,""):wu(a,f,m)}}}function qn(a,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Kt("error",a),Kt("load",a);var m=!1,b=!1,_;for(_ in f)if(f.hasOwnProperty(_)){var C=f[_];if(C!=null)switch(_){case"src":m=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Se(a,c,_,C,f,null)}}b&&Se(a,c,"srcSet",f.srcSet,f,null),m&&Se(a,c,"src",f.src,f,null);return;case"input":Kt("invalid",a);var O=_=C=b=null,z=null,Q=null;for(m in f)if(f.hasOwnProperty(m)){var rt=f[m];if(rt!=null)switch(m){case"name":b=rt;break;case"type":C=rt;break;case"checked":z=rt;break;case"defaultChecked":Q=rt;break;case"value":_=rt;break;case"defaultValue":O=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(r(137,c));break;default:Se(a,c,m,rt,f,null)}}ng(a,_,O,z,Q,C,b,!1);return;case"select":Kt("invalid",a),m=C=_=null;for(b in f)if(f.hasOwnProperty(b)&&(O=f[b],O!=null))switch(b){case"value":_=O;break;case"defaultValue":C=O;break;case"multiple":m=O;default:Se(a,c,b,O,f,null)}c=_,f=C,a.multiple=!!m,c!=null?ca(a,!!m,c,!1):f!=null&&ca(a,!!m,f,!0);return;case"textarea":Kt("invalid",a),_=b=m=null;for(C in f)if(f.hasOwnProperty(C)&&(O=f[C],O!=null))switch(C){case"value":m=O;break;case"defaultValue":b=O;break;case"children":_=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(r(91));break;default:Se(a,c,C,O,f,null)}ua(a,m,b,_);return;case"option":for(z in f)f.hasOwnProperty(z)&&(m=f[z],m!=null)&&(z==="selected"?a.selected=m&&typeof m!="function"&&typeof m!="symbol":Se(a,c,z,m,f,null));return;case"dialog":Kt("beforetoggle",a),Kt("toggle",a),Kt("cancel",a),Kt("close",a);break;case"iframe":case"object":Kt("load",a);break;case"video":case"audio":for(m=0;m<wd.length;m++)Kt(wd[m],a);break;case"image":Kt("error",a),Kt("load",a);break;case"details":Kt("toggle",a);break;case"embed":case"source":case"link":Kt("error",a),Kt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in f)if(f.hasOwnProperty(Q)&&(m=f[Q],m!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Se(a,c,Q,m,f,null)}return;default:if(Eu(c)){for(rt in f)f.hasOwnProperty(rt)&&(m=f[rt],m!==void 0&&dS(a,c,rt,m,f,void 0));return}}for(O in f)f.hasOwnProperty(O)&&(m=f[O],m!=null&&Se(a,c,O,m,f,null))}function _6(a,c,f,m){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,_=null,C=null,O=null,z=null,Q=null,rt=null;for(nt in f){var lt=f[nt];if(f.hasOwnProperty(nt)&&lt!=null)switch(nt){case"checked":break;case"value":break;case"defaultValue":z=lt;default:m.hasOwnProperty(nt)||Se(a,c,nt,null,m,lt)}}for(var Z in m){var nt=m[Z];if(lt=f[Z],m.hasOwnProperty(Z)&&(nt!=null||lt!=null))switch(Z){case"type":_=nt;break;case"name":b=nt;break;case"checked":Q=nt;break;case"defaultChecked":rt=nt;break;case"value":C=nt;break;case"defaultValue":O=nt;break;case"children":case"dangerouslySetInnerHTML":if(nt!=null)throw Error(r(137,c));break;default:nt!==lt&&Se(a,c,Z,nt,m,lt)}}xu(a,C,O,z,Q,rt,_,b);return;case"select":nt=C=O=Z=null;for(_ in f)if(z=f[_],f.hasOwnProperty(_)&&z!=null)switch(_){case"value":break;case"multiple":nt=z;default:m.hasOwnProperty(_)||Se(a,c,_,null,m,z)}for(b in m)if(_=m[b],z=f[b],m.hasOwnProperty(b)&&(_!=null||z!=null))switch(b){case"value":Z=_;break;case"defaultValue":O=_;break;case"multiple":C=_;default:_!==z&&Se(a,c,b,_,m,z)}c=O,f=C,m=nt,Z!=null?ca(a,!!f,Z,!1):!!m!=!!f&&(c!=null?ca(a,!!f,c,!0):ca(a,!!f,f?[]:"",!1));return;case"textarea":nt=Z=null;for(O in f)if(b=f[O],f.hasOwnProperty(O)&&b!=null&&!m.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:Se(a,c,O,null,m,b)}for(C in m)if(b=m[C],_=f[C],m.hasOwnProperty(C)&&(b!=null||_!=null))switch(C){case"value":Z=b;break;case"defaultValue":nt=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(r(91));break;default:b!==_&&Se(a,c,C,b,m,_)}rg(a,Z,nt);return;case"option":for(var Tt in f)Z=f[Tt],f.hasOwnProperty(Tt)&&Z!=null&&!m.hasOwnProperty(Tt)&&(Tt==="selected"?a.selected=!1:Se(a,c,Tt,null,m,Z));for(z in m)Z=m[z],nt=f[z],m.hasOwnProperty(z)&&Z!==nt&&(Z!=null||nt!=null)&&(z==="selected"?a.selected=Z&&typeof Z!="function"&&typeof Z!="symbol":Se(a,c,z,Z,m,nt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pt in f)Z=f[Pt],f.hasOwnProperty(Pt)&&Z!=null&&!m.hasOwnProperty(Pt)&&Se(a,c,Pt,null,m,Z);for(Q in m)if(Z=m[Q],nt=f[Q],m.hasOwnProperty(Q)&&Z!==nt&&(Z!=null||nt!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(137,c));break;default:Se(a,c,Q,Z,m,nt)}return;default:if(Eu(c)){for(var we in f)Z=f[we],f.hasOwnProperty(we)&&Z!==void 0&&!m.hasOwnProperty(we)&&dS(a,c,we,void 0,m,Z);for(rt in m)Z=m[rt],nt=f[rt],!m.hasOwnProperty(rt)||Z===nt||Z===void 0&&nt===void 0||dS(a,c,rt,Z,m,nt);return}}for(var Y in f)Z=f[Y],f.hasOwnProperty(Y)&&Z!=null&&!m.hasOwnProperty(Y)&&Se(a,c,Y,null,m,Z);for(lt in m)Z=m[lt],nt=f[lt],!m.hasOwnProperty(lt)||Z===nt||Z==null&&nt==null||Se(a,c,lt,Z,m,nt)}function UD(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function T6(){if(typeof performance.getEntriesByType=="function"){for(var a=0,c=0,f=performance.getEntriesByType("resource"),m=0;m<f.length;m++){var b=f[m],_=b.transferSize,C=b.initiatorType,O=b.duration;if(_&&O&&UD(C)){for(C=0,O=b.responseEnd,m+=1;m<f.length;m++){var z=f[m],Q=z.startTime;if(Q>O)break;var rt=z.transferSize,lt=z.initiatorType;rt&&UD(lt)&&(z=z.responseEnd,C+=rt*(z<O?1:(O-Q)/(z-Q)))}if(--m,c+=8*(_+C)/(b.duration/1e3),a++,10<a)break}}if(0<a)return c/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var pS=null,mS=null;function oy(a){return a.nodeType===9?a:a.ownerDocument}function zD(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function HD(a,c){if(a===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&c==="foreignObject"?0:a}function gS(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var yS=null;function S6(){var a=window.event;return a&&a.type==="popstate"?a===yS?!1:(yS=a,!0):(yS=null,!1)}var $D=typeof setTimeout=="function"?setTimeout:void 0,w6=typeof clearTimeout=="function"?clearTimeout:void 0,qD=typeof Promise=="function"?Promise:void 0,x6=typeof queueMicrotask=="function"?queueMicrotask:typeof qD<"u"?function(a){return qD.resolve(null).then(a).catch(E6)}:$D;function E6(a){setTimeout(function(){throw a})}function Ia(a){return a==="head"}function WD(a,c){var f=c,m=0;do{var b=f.nextSibling;if(a.removeChild(f),b&&b.nodeType===8)if(f=b.data,f==="/$"||f==="/&"){if(m===0){a.removeChild(b),oh(c);return}m--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")m++;else if(f==="html")Ed(a.ownerDocument.documentElement);else if(f==="head"){f=a.ownerDocument.head,Ed(f);for(var _=f.firstChild;_;){var C=_.nextSibling,O=_.nodeName;_[bs]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&_.rel.toLowerCase()==="stylesheet"||f.removeChild(_),_=C}}else f==="body"&&Ed(a.ownerDocument.body);f=b}while(f);oh(c)}function GD(a,c){var f=a;a=0;do{var m=f.nextSibling;if(f.nodeType===1?c?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(c?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),m&&m.nodeType===8)if(f=m.data,f==="/$"){if(a===0)break;a--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||a++;f=m}while(f)}function vS(a){var c=a.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":vS(f),Su(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}a.removeChild(f)}}function C6(a,c,f,m){for(;a.nodeType===1;){var b=f;if(a.nodeName.toLowerCase()!==c.toLowerCase()){if(!m&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(m){if(!a[bs])switch(c){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(_=a.getAttribute("rel"),_==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(_!==b.rel||a.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||a.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||a.getAttribute("title")!==(b.title==null?null:b.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(_=a.getAttribute("src"),(_!==(b.src==null?null:b.src)||a.getAttribute("type")!==(b.type==null?null:b.type)||a.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&_&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(c==="input"&&a.type==="hidden"){var _=b.name==null?null:""+b.name;if(b.type==="hidden"&&a.getAttribute("name")===_)return a}else return a;if(a=_i(a.nextSibling),a===null)break}return null}function A6(a,c,f){if(c==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!f||(a=_i(a.nextSibling),a===null))return null;return a}function YD(a,c){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=_i(a.nextSibling),a===null))return null;return a}function bS(a){return a.data==="$?"||a.data==="$~"}function _S(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function k6(a,c){var f=a.ownerDocument;if(a.data==="$~")a._reactRetry=c;else if(a.data!=="$?"||f.readyState!=="loading")c();else{var m=function(){c(),f.removeEventListener("DOMContentLoaded",m)};f.addEventListener("DOMContentLoaded",m),a._reactRetry=m}}function _i(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"||c==="F!"||c==="F")break;if(c==="/$"||c==="/&")return null}}return a}var TS=null;function KD(a){a=a.nextSibling;for(var c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="/$"||f==="/&"){if(c===0)return _i(a.nextSibling);c--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||c++}a=a.nextSibling}return null}function XD(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(c===0)return a;c--}else f!=="/$"&&f!=="/&"||c++}a=a.previousSibling}return null}function QD(a,c,f){switch(c=oy(f),a){case"html":if(a=c.documentElement,!a)throw Error(r(452));return a;case"head":if(a=c.head,!a)throw Error(r(453));return a;case"body":if(a=c.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function Ed(a){for(var c=a.attributes;c.length;)a.removeAttributeNode(c[0]);Su(a)}var Ti=new Map,JD=new Set;function ay(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Eo=st.d;st.d={f:M6,r:D6,D:O6,C:R6,L:I6,m:P6,X:L6,S:N6,M:V6};function M6(){var a=Eo.f(),c=Jg();return a||c}function D6(a){var c=ui(a);c!==null&&c.tag===5&&c.type==="form"?mM(c):Eo.r(a)}var rh=typeof document>"u"?null:document;function ZD(a,c,f){var m=rh;if(m&&typeof c=="string"&&c){var b=Ar(c);b='link[rel="'+a+'"][href="'+b+'"]',typeof f=="string"&&(b+='[crossorigin="'+f+'"]'),JD.has(b)||(JD.add(b),a={rel:a,crossOrigin:f,href:c},m.querySelector(b)===null&&(c=m.createElement("link"),qn(c,"link",a),hn(c),m.head.appendChild(c)))}}function O6(a){Eo.D(a),ZD("dns-prefetch",a,null)}function R6(a,c){Eo.C(a,c),ZD("preconnect",a,c)}function I6(a,c,f){Eo.L(a,c,f);var m=rh;if(m&&a&&c){var b='link[rel="preload"][as="'+Ar(c)+'"]';c==="image"&&f&&f.imageSrcSet?(b+='[imagesrcset="'+Ar(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(b+='[imagesizes="'+Ar(f.imageSizes)+'"]')):b+='[href="'+Ar(a)+'"]';var _=b;switch(c){case"style":_=ih(a);break;case"script":_=sh(a)}Ti.has(_)||(a=p({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:a,as:c},f),Ti.set(_,a),m.querySelector(b)!==null||c==="style"&&m.querySelector(Cd(_))||c==="script"&&m.querySelector(Ad(_))||(c=m.createElement("link"),qn(c,"link",a),hn(c),m.head.appendChild(c)))}}function P6(a,c){Eo.m(a,c);var f=rh;if(f&&a){var m=c&&typeof c.as=="string"?c.as:"script",b='link[rel="modulepreload"][as="'+Ar(m)+'"][href="'+Ar(a)+'"]',_=b;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=sh(a)}if(!Ti.has(_)&&(a=p({rel:"modulepreload",href:a},c),Ti.set(_,a),f.querySelector(b)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Ad(_)))return}m=f.createElement("link"),qn(m,"link",a),hn(m),f.head.appendChild(m)}}}function N6(a,c,f){Eo.S(a,c,f);var m=rh;if(m&&a){var b=Ts(m).hoistableStyles,_=ih(a);c=c||"default";var C=b.get(_);if(!C){var O={loading:0,preload:null};if(C=m.querySelector(Cd(_)))O.loading=5;else{a=p({rel:"stylesheet",href:a,"data-precedence":c},f),(f=Ti.get(_))&&SS(a,f);var z=C=m.createElement("link");hn(z),qn(z,"link",a),z._p=new Promise(function(Q,rt){z.onload=Q,z.onerror=rt}),z.addEventListener("load",function(){O.loading|=1}),z.addEventListener("error",function(){O.loading|=2}),O.loading|=4,ly(C,c,m)}C={type:"stylesheet",instance:C,count:1,state:O},b.set(_,C)}}}function L6(a,c){Eo.X(a,c);var f=rh;if(f&&a){var m=Ts(f).hoistableScripts,b=sh(a),_=m.get(b);_||(_=f.querySelector(Ad(b)),_||(a=p({src:a,async:!0},c),(c=Ti.get(b))&&wS(a,c),_=f.createElement("script"),hn(_),qn(_,"link",a),f.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},m.set(b,_))}}function V6(a,c){Eo.M(a,c);var f=rh;if(f&&a){var m=Ts(f).hoistableScripts,b=sh(a),_=m.get(b);_||(_=f.querySelector(Ad(b)),_||(a=p({src:a,async:!0,type:"module"},c),(c=Ti.get(b))&&wS(a,c),_=f.createElement("script"),hn(_),qn(_,"link",a),f.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},m.set(b,_))}}function tO(a,c,f,m){var b=(b=It.current)?ay(b):null;if(!b)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=ih(f.href),f=Ts(b).hoistableStyles,m=f.get(c),m||(m={type:"style",instance:null,count:0,state:null},f.set(c,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){a=ih(f.href);var _=Ts(b).hoistableStyles,C=_.get(a);if(C||(b=b.ownerDocument||b,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(a,C),(_=b.querySelector(Cd(a)))&&!_._p&&(C.instance=_,C.state.loading=5),Ti.has(a)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Ti.set(a,f),_||j6(b,a,f,C.state))),c&&m===null)throw Error(r(528,""));return C}if(c&&m!==null)throw Error(r(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=sh(f),f=Ts(b).hoistableScripts,m=f.get(c),m||(m={type:"script",instance:null,count:0,state:null},f.set(c,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function ih(a){return'href="'+Ar(a)+'"'}function Cd(a){return'link[rel="stylesheet"]['+a+"]"}function eO(a){return p({},a,{"data-precedence":a.precedence,precedence:null})}function j6(a,c,f,m){a.querySelector('link[rel="preload"][as="style"]['+c+"]")?m.loading=1:(c=a.createElement("link"),m.preload=c,c.addEventListener("load",function(){return m.loading|=1}),c.addEventListener("error",function(){return m.loading|=2}),qn(c,"link",f),hn(c),a.head.appendChild(c))}function sh(a){return'[src="'+Ar(a)+'"]'}function Ad(a){return"script[async]"+a}function nO(a,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var m=a.querySelector('style[data-href~="'+Ar(f.href)+'"]');if(m)return c.instance=m,hn(m),m;var b=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return m=(a.ownerDocument||a).createElement("style"),hn(m),qn(m,"style",b),ly(m,f.precedence,a),c.instance=m;case"stylesheet":b=ih(f.href);var _=a.querySelector(Cd(b));if(_)return c.state.loading|=4,c.instance=_,hn(_),_;m=eO(f),(b=Ti.get(b))&&SS(m,b),_=(a.ownerDocument||a).createElement("link"),hn(_);var C=_;return C._p=new Promise(function(O,z){C.onload=O,C.onerror=z}),qn(_,"link",m),c.state.loading|=4,ly(_,f.precedence,a),c.instance=_;case"script":return _=sh(f.src),(b=a.querySelector(Ad(_)))?(c.instance=b,hn(b),b):(m=f,(b=Ti.get(_))&&(m=p({},f),wS(m,b)),a=a.ownerDocument||a,b=a.createElement("script"),hn(b),qn(b,"link",m),a.head.appendChild(b),c.instance=b);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(m=c.instance,c.state.loading|=4,ly(m,f.precedence,a));return c.instance}function ly(a,c,f){for(var m=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=m.length?m[m.length-1]:null,_=b,C=0;C<m.length;C++){var O=m[C];if(O.dataset.precedence===c)_=O;else if(_!==b)break}_?_.parentNode.insertBefore(a,_.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(a,c.firstChild))}function SS(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.title==null&&(a.title=c.title)}function wS(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.integrity==null&&(a.integrity=c.integrity)}var cy=null;function rO(a,c,f){if(cy===null){var m=new Map,b=cy=new Map;b.set(f,m)}else b=cy,m=b.get(f),m||(m=new Map,b.set(f,m));if(m.has(a))return m;for(m.set(a,null),f=f.getElementsByTagName(a),b=0;b<f.length;b++){var _=f[b];if(!(_[bs]||_[un]||a==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var C=_.getAttribute(c)||"";C=a+C;var O=m.get(C);O?O.push(_):m.set(C,[_])}}return m}function iO(a,c,f){a=a.ownerDocument||a,a.head.insertBefore(f,c==="title"?a.querySelector("head > title"):null)}function F6(a,c,f){if(f===1||c.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;return c.rel==="stylesheet"?(a=c.disabled,typeof c.precedence=="string"&&a==null):!0;case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function sO(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function B6(a,c,f,m){if(f.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var b=ih(m.href),_=c.querySelector(Cd(b));if(_){c=_._p,c!==null&&typeof c=="object"&&typeof c.then=="function"&&(a.count++,a=uy.bind(a),c.then(a,a)),f.state.loading|=4,f.instance=_,hn(_);return}_=c.ownerDocument||c,m=eO(m),(b=Ti.get(b))&&SS(m,b),_=_.createElement("link"),hn(_);var C=_;C._p=new Promise(function(O,z){C.onload=O,C.onerror=z}),qn(_,"link",m),f.instance=_}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(f,c),(c=f.state.preload)&&(f.state.loading&3)===0&&(a.count++,f=uy.bind(a),c.addEventListener("load",f),c.addEventListener("error",f))}}var xS=0;function U6(a,c){return a.stylesheets&&a.count===0&&fy(a,a.stylesheets),0<a.count||0<a.imgCount?function(f){var m=setTimeout(function(){if(a.stylesheets&&fy(a,a.stylesheets),a.unsuspend){var _=a.unsuspend;a.unsuspend=null,_()}},6e4+c);0<a.imgBytes&&xS===0&&(xS=62500*T6());var b=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&fy(a,a.stylesheets),a.unsuspend)){var _=a.unsuspend;a.unsuspend=null,_()}},(a.imgBytes>xS?50:800)+c);return a.unsuspend=f,function(){a.unsuspend=null,clearTimeout(m),clearTimeout(b)}}:null}function uy(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fy(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var hy=null;function fy(a,c){a.stylesheets=null,a.unsuspend!==null&&(a.count++,hy=new Map,c.forEach(z6,a),hy=null,uy.call(a))}function z6(a,c){if(!(c.state.loading&4)){var f=hy.get(a);if(f)var m=f.get(null);else{f=new Map,hy.set(a,f);for(var b=a.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<b.length;_++){var C=b[_];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(f.set(C.dataset.precedence,C),m=C)}m&&f.set(null,m)}b=c.instance,C=b.getAttribute("data-precedence"),_=f.get(C)||m,_===m&&f.set(null,b),f.set(C,b),this.count++,m=uy.bind(this),b.addEventListener("load",m),b.addEventListener("error",m),_?_.parentNode.insertBefore(b,_.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(b,a.firstChild)),c.state.loading|=4}}var kd={$$typeof:P,Provider:null,Consumer:null,_currentValue:ht,_currentValue2:ht,_threadCount:0};function H6(a,c,f,m,b,_,C,O,z){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ys(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ys(0),this.hiddenUpdates=ys(null),this.identifierPrefix=m,this.onUncaughtError=b,this.onCaughtError=_,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function oO(a,c,f,m,b,_,C,O,z,Q,rt,lt){return a=new H6(a,c,f,C,z,Q,rt,lt,O),c=1,_===!0&&(c|=24),_=qr(3,null,null,c),a.current=_,_.stateNode=a,c=rT(),c.refCount++,a.pooledCache=c,c.refCount++,_.memoizedState={element:m,isDehydrated:f,cache:c},aT(_),a}function aO(a){return a?(a=Lu,a):Lu}function lO(a,c,f,m,b,_){b=aO(b),m.context===null?m.context=b:m.pendingContext=b,m=Sa(c),m.payload={element:f},_=_===void 0?null:_,_!==null&&(m.callback=_),f=wa(a,m,c),f!==null&&(Ir(f,a,c),od(f,a,c))}function cO(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<c?f:c}}function ES(a,c){cO(a,c),(a=a.alternate)&&cO(a,c)}function uO(a){if(a.tag===13||a.tag===31){var c=ac(a,67108864);c!==null&&Ir(c,a,67108864),ES(a,67108864)}}function hO(a){if(a.tag===13||a.tag===31){var c=Xr();c=Kl(c);var f=ac(a,c);f!==null&&Ir(f,a,c),ES(a,c)}}var dy=!0;function $6(a,c,f,m){var b=J.T;J.T=null;var _=st.p;try{st.p=2,CS(a,c,f,m)}finally{st.p=_,J.T=b}}function q6(a,c,f,m){var b=J.T;J.T=null;var _=st.p;try{st.p=8,CS(a,c,f,m)}finally{st.p=_,J.T=b}}function CS(a,c,f,m){if(dy){var b=AS(m);if(b===null)fS(a,c,m,py,f),dO(a,m);else if(G6(b,a,c,f,m))m.stopPropagation();else if(dO(a,m),c&4&&-1<W6.indexOf(a)){for(;b!==null;){var _=ui(b);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var C=ms(_.pendingLanes);if(C!==0){var O=_;for(O.pendingLanes|=2,O.entangledLanes|=2;C;){var z=1<<31-tn(C);O.entanglements[1]|=z,C&=~z}Ps(_),(ce&6)===0&&(Xg=ur()+500,Sd(0))}}break;case 31:case 13:O=ac(_,2),O!==null&&Ir(O,_,2),Jg(),ES(_,2)}if(_=AS(m),_===null&&fS(a,c,m,py,f),_===b)break;b=_}b!==null&&m.stopPropagation()}else fS(a,c,m,null,f)}}function AS(a){return a=hi(a),kS(a)}var py=null;function kS(a){if(py=null,a=_s(a),a!==null){var c=s(a);if(c===null)a=null;else{var f=c.tag;if(f===13){if(a=o(c),a!==null)return a;a=null}else if(f===31){if(a=l(c),a!==null)return a;a=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null)}}return py=a,null}function fO(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ql()){case Of:return 2;case Rf:return 8;case aa:case P_:return 32;case Wm:return 268435456;default:return 32}default:return 32}}var MS=!1,Pa=null,Na=null,La=null,Md=new Map,Dd=new Map,Va=[],W6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dO(a,c){switch(a){case"focusin":case"focusout":Pa=null;break;case"dragenter":case"dragleave":Na=null;break;case"mouseover":case"mouseout":La=null;break;case"pointerover":case"pointerout":Md.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dd.delete(c.pointerId)}}function Od(a,c,f,m,b,_){return a===null||a.nativeEvent!==_?(a={blockedOn:c,domEventName:f,eventSystemFlags:m,nativeEvent:_,targetContainers:[b]},c!==null&&(c=ui(c),c!==null&&uO(c)),a):(a.eventSystemFlags|=m,c=a.targetContainers,b!==null&&c.indexOf(b)===-1&&c.push(b),a)}function G6(a,c,f,m,b){switch(c){case"focusin":return Pa=Od(Pa,a,c,f,m,b),!0;case"dragenter":return Na=Od(Na,a,c,f,m,b),!0;case"mouseover":return La=Od(La,a,c,f,m,b),!0;case"pointerover":var _=b.pointerId;return Md.set(_,Od(Md.get(_)||null,a,c,f,m,b)),!0;case"gotpointercapture":return _=b.pointerId,Dd.set(_,Od(Dd.get(_)||null,a,c,f,m,b)),!0}return!1}function pO(a){var c=_s(a.target);if(c!==null){var f=s(c);if(f!==null){if(c=f.tag,c===13){if(c=o(f),c!==null){a.blockedOn=c,ji(a.priority,function(){hO(f)});return}}else if(c===31){if(c=l(f),c!==null){a.blockedOn=c,ji(a.priority,function(){hO(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){a.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}a.blockedOn=null}function my(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var f=AS(a.nativeEvent);if(f===null){f=a.nativeEvent;var m=new f.constructor(f.type,f);$f=m,f.target.dispatchEvent(m),$f=null}else return c=ui(f),c!==null&&uO(c),a.blockedOn=f,!1;c.shift()}return!0}function mO(a,c,f){my(a)&&f.delete(c)}function Y6(){MS=!1,Pa!==null&&my(Pa)&&(Pa=null),Na!==null&&my(Na)&&(Na=null),La!==null&&my(La)&&(La=null),Md.forEach(mO),Dd.forEach(mO)}function gy(a,c){a.blockedOn===c&&(a.blockedOn=null,MS||(MS=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Y6)))}var yy=null;function gO(a){yy!==a&&(yy=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){yy===a&&(yy=null);for(var c=0;c<a.length;c+=3){var f=a[c],m=a[c+1],b=a[c+2];if(typeof m!="function"){if(kS(m||f)===null)continue;break}var _=ui(f);_!==null&&(a.splice(c,3),c-=3,AT(_,{pending:!0,data:b,method:f.method,action:m},m,b))}}))}function oh(a){function c(z){return gy(z,a)}Pa!==null&&gy(Pa,a),Na!==null&&gy(Na,a),La!==null&&gy(La,a),Md.forEach(c),Dd.forEach(c);for(var f=0;f<Va.length;f++){var m=Va[f];m.blockedOn===a&&(m.blockedOn=null)}for(;0<Va.length&&(f=Va[0],f.blockedOn===null);)pO(f),f.blockedOn===null&&Va.shift();if(f=(a.ownerDocument||a).$$reactFormReplay,f!=null)for(m=0;m<f.length;m+=3){var b=f[m],_=f[m+1],C=b[Dn]||null;if(typeof _=="function")C||gO(f);else if(C){var O=null;if(_&&_.hasAttribute("formAction")){if(b=_,C=_[Dn]||null)O=C.formAction;else if(kS(b)!==null)continue}else O=C.action;typeof O=="function"?f[m+1]=O:(f.splice(m,3),m-=3),gO(f)}}}function yO(){function a(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(C){return b=C})},focusReset:"manual",scroll:"manual"})}function c(){b!==null&&(b(),b=null),m||setTimeout(f,20)}function f(){if(!m&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,b=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",c),navigation.addEventListener("navigateerror",c),setTimeout(f,100),function(){m=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",c),navigation.removeEventListener("navigateerror",c),b!==null&&(b(),b=null)}}}function DS(a){this._internalRoot=a}vy.prototype.render=DS.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(r(409));var f=c.current,m=Xr();lO(f,m,a,c,null,null)},vy.prototype.unmount=DS.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;lO(a.current,2,null,a,null,null),Jg(),c[vs]=null}};function vy(a){this._internalRoot=a}vy.prototype.unstable_scheduleHydration=function(a){if(a){var c=Jm();a={blockedOn:null,target:a,priority:c};for(var f=0;f<Va.length&&c!==0&&c<Va[f].priority;f++);Va.splice(f,0,a),f===0&&pO(a)}};var vO=t.version;if(vO!=="19.2.4")throw Error(r(527,vO,"19.2.4"));st.findDOMNode=function(a){var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=h(c),a=a!==null?d(a):null,a=a===null?null:a.stateNode,a};var K6={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var by=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!by.isDisabled&&by.supportsFiber)try{Li=by.inject(K6),Bn=by}catch{}}return Id.createRoot=function(a,c){if(!i(a))throw Error(r(299));var f=!1,m="",b=EM,_=CM,C=AM;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(_=c.onCaughtError),c.onRecoverableError!==void 0&&(C=c.onRecoverableError)),c=oO(a,1,!1,null,null,f,m,null,b,_,C,yO),a[vs]=c.current,hS(a),new DS(c)},Id.hydrateRoot=function(a,c,f){if(!i(a))throw Error(r(299));var m=!1,b="",_=EM,C=CM,O=AM,z=null;return f!=null&&(f.unstable_strictMode===!0&&(m=!0),f.identifierPrefix!==void 0&&(b=f.identifierPrefix),f.onUncaughtError!==void 0&&(_=f.onUncaughtError),f.onCaughtError!==void 0&&(C=f.onCaughtError),f.onRecoverableError!==void 0&&(O=f.onRecoverableError),f.formState!==void 0&&(z=f.formState)),c=oO(a,1,!0,c,f??null,m,b,z,_,C,O,yO),c.context=aO(null),f=c.current,m=Xr(),m=Kl(m),b=Sa(m),b.callback=null,wa(f,b,m),f=m,c.current.lanes=f,Gl(c,f),Ps(c),a[vs]=c.current,hS(a),new vy(c)},Id.version="19.2.4",Id}var kO;function iH(){if(kO)return IS.exports;kO=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),IS.exports=rH(),IS.exports}var sH=iH();var MO="popstate";function oH(n={}){function t(r,i){let{pathname:s,search:o,hash:l}=r.location;return cx("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function e(r,i){return typeof i=="string"?i:Pp(i)}return lH(t,e,null,n)}function Ve(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function hs(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function aH(){return Math.random().toString(36).substring(2,10)}function DO(n,t){return{usr:n.state,key:n.key,idx:t}}function cx(n,t,e=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof t=="string"?af(t):t,state:e,key:t&&t.key||r||aH()}}function Pp({pathname:n="/",search:t="",hash:e=""}){return t&&t!=="?"&&(n+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(n+=e.charAt(0)==="#"?e:"#"+e),n}function af(n){let t={};if(n){let e=n.indexOf("#");e>=0&&(t.hash=n.substring(e),n=n.substring(0,e));let r=n.indexOf("?");r>=0&&(t.search=n.substring(r),n=n.substring(0,r)),n&&(t.pathname=n)}return t}function lH(n,t,e,r={}){let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,l="POP",u=null,h=d();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function d(){return(o.state||{idx:null}).idx}function p(){l="POP";let w=d(),E=w==null?null:w-h;h=w,u&&u({action:l,location:S.location,delta:E})}function g(w,E){l="PUSH";let D=cx(S.location,w,E);h=d()+1;let P=DO(D,h),V=S.createHref(D);try{o.pushState(P,"",V)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(V)}s&&u&&u({action:l,location:S.location,delta:1})}function v(w,E){l="REPLACE";let D=cx(S.location,w,E);h=d();let P=DO(D,h),V=S.createHref(D);o.replaceState(P,"",V),s&&u&&u({action:l,location:S.location,delta:0})}function T(w){return cH(w)}let S={get action(){return l},get location(){return n(i,o)},listen(w){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(MO,p),u=w,()=>{i.removeEventListener(MO,p),u=null}},createHref(w){return t(i,w)},createURL:T,encodeLocation(w){let E=T(w);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:g,replace:v,go(w){return o.go(w)}};return S}function cH(n,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Ve(e,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Pp(n);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=e+r),new URL(r,e)}function iL(n,t,e="/"){return uH(n,t,e,!1)}function uH(n,t,e,r){let i=typeof t=="string"?af(t):t,s=Go(i.pathname||"/",e);if(s==null)return null;let o=sL(n);hH(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let h=SH(s);l=_H(o[u],h,r)}return l}function sL(n,t=[],e=[],r="",i=!1){let s=(o,l,u=i,h)=>{let d={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(r)&&u)return;Ve(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length)}let p=Uo([r,d.relativePath]),g=e.concat(d);o.children&&o.children.length>0&&(Ve(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),sL(o.children,t,g,p,u)),!(o.path==null&&!o.index)&&t.push({path:p,score:vH(p,o.index),routesMeta:g})};return n.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))s(o,l);else for(let u of oL(o.path))s(o,l,!0,u)}),t}function oL(n){let t=n.split("/");if(t.length===0)return[];let[e,...r]=t,i=e.endsWith("?"),s=e.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=oL(r.join("/")),l=[];return l.push(...o.map(u=>u===""?s:[s,u].join("/"))),i&&l.push(...o),l.map(u=>n.startsWith("/")&&u===""?"/":u)}function hH(n){n.sort((t,e)=>t.score!==e.score?e.score-t.score:bH(t.routesMeta.map(r=>r.childrenIndex),e.routesMeta.map(r=>r.childrenIndex)))}var fH=/^:[\w-]+$/,dH=3,pH=2,mH=1,gH=10,yH=-2,OO=n=>n==="*";function vH(n,t){let e=n.split("/"),r=e.length;return e.some(OO)&&(r+=yH),t&&(r+=pH),e.filter(i=>!OO(i)).reduce((i,s)=>i+(fH.test(s)?dH:s===""?mH:gH),r)}function bH(n,t){return n.length===t.length&&n.slice(0,-1).every((r,i)=>r===t[i])?n[n.length-1]-t[t.length-1]:0}function _H(n,t,e=!1){let{routesMeta:r}=n,i={},s="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],h=l===r.length-1,d=s==="/"?t:t.slice(s.length)||"/",p=K0({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},d),g=u.route;if(!p&&h&&e&&!r[r.length-1].route.index&&(p=K0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Uo([s,p.pathname]),pathnameBase:CH(Uo([s,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(s=Uo([s,p.pathnameBase]))}return o}function K0(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[e,r]=TH(n.path,n.caseSensitive,n.end),i=t.match(e);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((h,{paramName:d,isOptional:p},g)=>{if(d==="*"){let T=l[g]||"";o=s.slice(0,s.length-T.length).replace(/(.)\/+$/,"$1")}const v=l[g];return p&&!v?h[d]=void 0:h[d]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:o,pattern:n}}function TH(n,t=!1,e=!0){hs(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function SH(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return hs(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),n}}function Go(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,r=n.charAt(e);return r&&r!=="/"?null:n.slice(e)||"/"}var wH=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function xH(n,t="/"){let{pathname:e,search:r="",hash:i=""}=typeof n=="string"?af(n):n,s;return e?(e=e.replace(/\/\/+/g,"/"),e.startsWith("/")?s=RO(e.substring(1),"/"):s=RO(e,t)):s=t,{pathname:s,search:AH(r),hash:kH(i)}}function RO(n,t){let e=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?e.length>1&&e.pop():i!=="."&&e.push(i)}),e.length>1?e.join("/"):"/"}function VS(n,t,e,r){return`Cannot include a '${n}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function EH(n){return n.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function n1(n){let t=EH(n);return t.map((e,r)=>r===t.length-1?e.pathname:e.pathnameBase)}function r1(n,t,e,r=!1){let i;typeof n=="string"?i=af(n):(i={...n},Ve(!i.pathname||!i.pathname.includes("?"),VS("?","pathname","search",i)),Ve(!i.pathname||!i.pathname.includes("#"),VS("#","pathname","hash",i)),Ve(!i.search||!i.search.includes("#"),VS("#","search","hash",i)));let s=n===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=e;else{let p=t.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;i.pathname=g.join("/")}l=p>=0?t[p]:"/"}let u=xH(i,l),h=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&e.endsWith("/");return!u.pathname.endsWith("/")&&(h||d)&&(u.pathname+="/"),u}var Uo=n=>n.join("/").replace(/\/\/+/g,"/"),CH=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),AH=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,kH=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,MH=class{constructor(n,t,e,r=!1){this.status=n,this.statusText=t||"",this.internal=r,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function DH(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function OH(n){return n.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var aL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function lL(n,t){let e=n;if(typeof e!="string"||!wH.test(e))return{absoluteURL:void 0,isExternal:!1,to:e};let r=e,i=!1;if(aL)try{let s=new URL(window.location.href),o=e.startsWith("//")?new URL(s.protocol+e):new URL(e),l=Go(o.pathname,t);o.origin===s.origin&&l!=null?e=l+o.search+o.hash:i=!0}catch{hs(!1,`<Link to="${e}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var cL=["POST","PUT","PATCH","DELETE"];new Set(cL);var RH=["GET",...cL];new Set(RH);var lf=L.createContext(null);lf.displayName="DataRouter";var Db=L.createContext(null);Db.displayName="DataRouterState";var IH=L.createContext(!1),uL=L.createContext({isTransitioning:!1});uL.displayName="ViewTransition";var PH=L.createContext(new Map);PH.displayName="Fetchers";var NH=L.createContext(null);NH.displayName="Await";var oi=L.createContext(null);oi.displayName="Navigation";var gm=L.createContext(null);gm.displayName="Location";var Ni=L.createContext({outlet:null,matches:[],isDataRoute:!1});Ni.displayName="Route";var i1=L.createContext(null);i1.displayName="RouteError";var hL="REACT_ROUTER_ERROR",LH="REDIRECT",VH="ROUTE_ERROR_RESPONSE";function jH(n){if(n.startsWith(`${hL}:${LH}:{`))try{let t=JSON.parse(n.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function FH(n){if(n.startsWith(`${hL}:${VH}:{`))try{let t=JSON.parse(n.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new MH(t.status,t.statusText,t.data)}catch{}}function BH(n,{relative:t}={}){Ve(cf(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:r}=L.useContext(oi),{hash:i,pathname:s,search:o}=vm(n,{relative:t}),l=s;return e!=="/"&&(l=s==="/"?e:Uo([e,s])),r.createHref({pathname:l,search:o,hash:i})}function cf(){return L.useContext(gm)!=null}function Ol(){return Ve(cf(),"useLocation() may be used only in the context of a <Router> component."),L.useContext(gm).location}var fL="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function dL(n){L.useContext(oi).static||L.useLayoutEffect(n)}function ym(){let{isDataRoute:n}=L.useContext(Ni);return n?n9():UH()}function UH(){Ve(cf(),"useNavigate() may be used only in the context of a <Router> component.");let n=L.useContext(lf),{basename:t,navigator:e}=L.useContext(oi),{matches:r}=L.useContext(Ni),{pathname:i}=Ol(),s=JSON.stringify(n1(r)),o=L.useRef(!1);return dL(()=>{o.current=!0}),L.useCallback((u,h={})=>{if(hs(o.current,fL),!o.current)return;if(typeof u=="number"){e.go(u);return}let d=r1(u,JSON.parse(s),i,h.relative==="path");n==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Uo([t,d.pathname])),(h.replace?e.replace:e.push)(d,h.state,h)},[t,e,s,i,n])}var zH=L.createContext(null);function HH(n){let t=L.useContext(Ni).outlet;return L.useMemo(()=>t&&L.createElement(zH.Provider,{value:n},t),[t,n])}function $H(){let{matches:n}=L.useContext(Ni),t=n[n.length-1];return t?t.params:{}}function vm(n,{relative:t}={}){let{matches:e}=L.useContext(Ni),{pathname:r}=Ol(),i=JSON.stringify(n1(e));return L.useMemo(()=>r1(n,JSON.parse(i),r,t==="path"),[n,i,r,t])}function qH(n,t){return pL(n,t)}function pL(n,t,e,r,i){Ve(cf(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=L.useContext(oi),{matches:o}=L.useContext(Ni),l=o[o.length-1],u=l?l.params:{},h=l?l.pathname:"/",d=l?l.pathnameBase:"/",p=l&&l.route;{let D=p&&p.path||"";gL(h,!p||D.endsWith("*")||D.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${D}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${D}"> to <Route path="${D==="/"?"*":`${D}/*`}">.`)}let g=Ol(),v;if(t){let D=typeof t=="string"?af(t):t;Ve(d==="/"||D.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${D.pathname}" was given in the \`location\` prop.`),v=D}else v=g;let T=v.pathname||"/",S=T;if(d!=="/"){let D=d.replace(/^\//,"").split("/");S="/"+T.replace(/^\//,"").split("/").slice(D.length).join("/")}let w=iL(n,{pathname:S});hs(p||w!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),hs(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=XH(w&&w.map(D=>Object.assign({},D,{params:Object.assign({},u,D.params),pathname:Uo([d,s.encodeLocation?s.encodeLocation(D.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?d:Uo([d,s.encodeLocation?s.encodeLocation(D.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:D.pathnameBase])})),o,e,r,i);return t&&E?L.createElement(gm.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function WH(){let n=e9(),t=DH(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),e=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=L.createElement(L.Fragment,null,L.createElement("p",null," Hey developer "),L.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",L.createElement("code",{style:s},"ErrorBoundary")," or"," ",L.createElement("code",{style:s},"errorElement")," prop on your route.")),L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},t),e?L.createElement("pre",{style:i},e):null,o)}var GH=L.createElement(WH,null),mL=class extends L.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,t){return t.location!==n.location||t.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:t.error,location:t.location,revalidation:n.revalidation||t.revalidation}}componentDidCatch(n,t){this.props.onError?this.props.onError(n,t):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const e=FH(n.digest);e&&(n=e)}let t=n!==void 0?L.createElement(Ni.Provider,{value:this.props.routeContext},L.createElement(i1.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?L.createElement(YH,{error:n},t):t}};mL.contextType=IH;var jS=new WeakMap;function YH({children:n,error:t}){let{basename:e}=L.useContext(oi);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let r=jH(t.digest);if(r){let i=jS.get(t);if(i)throw i;let s=lL(r.location,e);if(aL&&!jS.get(t))if(s.isExternal||r.reloadDocument)window.location.href=s.absoluteURL||s.to;else{const o=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(s.to,{replace:r.replace}));throw jS.set(t,o),o}return L.createElement("meta",{httpEquiv:"refresh",content:`0;url=${s.absoluteURL||s.to}`})}}return n}function KH({routeContext:n,match:t,children:e}){let r=L.useContext(lf);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),L.createElement(Ni.Provider,{value:n},e)}function XH(n,t=[],e=null,r=null,i=null){if(n==null){if(!e)return null;if(e.errors)n=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)n=e.matches;else return null}let s=n,o=e?.errors;if(o!=null){let d=s.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);Ve(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,d+1))}let l=!1,u=-1;if(e)for(let d=0;d<s.length;d++){let p=s[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=d),p.route.id){let{loaderData:g,errors:v}=e,T=p.route.loader&&!g.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||T){l=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}let h=e&&r?(d,p)=>{r(d,{location:e.location,params:e.matches?.[0]?.params??{},unstable_pattern:OH(e.matches),errorInfo:p})}:void 0;return s.reduceRight((d,p,g)=>{let v,T=!1,S=null,w=null;e&&(v=o&&p.route.id?o[p.route.id]:void 0,S=p.route.errorElement||GH,l&&(u<0&&g===0?(gL("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),T=!0,w=null):u===g&&(T=!0,w=p.route.hydrateFallbackElement||null)));let E=t.concat(s.slice(0,g+1)),D=()=>{let P;return v?P=S:T?P=w:p.route.Component?P=L.createElement(p.route.Component,null):p.route.element?P=p.route.element:P=d,L.createElement(KH,{match:p,routeContext:{outlet:d,matches:E,isDataRoute:e!=null},children:P})};return e&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?L.createElement(mL,{location:e.location,revalidation:e.revalidation,component:S,error:v,children:D(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:h}):D()},null)}function s1(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function QH(n){let t=L.useContext(lf);return Ve(t,s1(n)),t}function JH(n){let t=L.useContext(Db);return Ve(t,s1(n)),t}function ZH(n){let t=L.useContext(Ni);return Ve(t,s1(n)),t}function o1(n){let t=ZH(n),e=t.matches[t.matches.length-1];return Ve(e.route.id,`${n} can only be used on routes that contain a unique "id"`),e.route.id}function t9(){return o1("useRouteId")}function e9(){let n=L.useContext(i1),t=JH("useRouteError"),e=o1("useRouteError");return n!==void 0?n:t.errors?.[e]}function n9(){let{router:n}=QH("useNavigate"),t=o1("useNavigate"),e=L.useRef(!1);return dL(()=>{e.current=!0}),L.useCallback(async(i,s={})=>{hs(e.current,fL),e.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:t,...s}))},[n,t])}var IO={};function gL(n,t,e){!t&&!IO[n]&&(IO[n]=!0,hs(!1,e))}L.memo(r9);function r9({routes:n,future:t,state:e,onError:r}){return pL(n,void 0,e,r,t)}function yL({to:n,replace:t,state:e,relative:r}){Ve(cf(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=L.useContext(oi);hs(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=L.useContext(Ni),{pathname:o}=Ol(),l=ym(),u=r1(n,n1(s),o,r==="path"),h=JSON.stringify(u);return L.useEffect(()=>{l(JSON.parse(h),{replace:t,state:e,relative:r})},[l,h,r,t,e]),null}function vL(n){return HH(n.context)}function $a(n){Ve(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function i9({basename:n="/",children:t=null,location:e,navigationType:r="POP",navigator:i,static:s=!1,unstable_useTransitions:o}){Ve(!cf(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),u=L.useMemo(()=>({basename:l,navigator:i,static:s,unstable_useTransitions:o,future:{}}),[l,i,s,o]);typeof e=="string"&&(e=af(e));let{pathname:h="/",search:d="",hash:p="",state:g=null,key:v="default"}=e,T=L.useMemo(()=>{let S=Go(h,l);return S==null?null:{location:{pathname:S,search:d,hash:p,state:g,key:v},navigationType:r}},[l,h,d,p,g,v,r]);return hs(T!=null,`<Router basename="${l}"> is not able to match the URL "${h}${d}${p}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:L.createElement(oi.Provider,{value:u},L.createElement(gm.Provider,{children:t,value:T}))}function s9({children:n,location:t}){return qH(ux(n),t)}function ux(n,t=[]){let e=[];return L.Children.forEach(n,(r,i)=>{if(!L.isValidElement(r))return;let s=[...t,i];if(r.type===L.Fragment){e.push.apply(e,ux(r.props.children,s));return}Ve(r.type===$a,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ve(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=ux(r.props.children,s)),e.push(o)}),e}var v0="get",b0="application/x-www-form-urlencoded";function Ob(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function o9(n){return Ob(n)&&n.tagName.toLowerCase()==="button"}function a9(n){return Ob(n)&&n.tagName.toLowerCase()==="form"}function l9(n){return Ob(n)&&n.tagName.toLowerCase()==="input"}function c9(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function u9(n,t){return n.button===0&&(!t||t==="_self")&&!c9(n)}var _y=null;function h9(){if(_y===null)try{new FormData(document.createElement("form"),0),_y=!1}catch{_y=!0}return _y}var f9=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function FS(n){return n!=null&&!f9.has(n)?(hs(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${b0}"`),null):n}function d9(n,t){let e,r,i,s,o;if(a9(n)){let l=n.getAttribute("action");r=l?Go(l,t):null,e=n.getAttribute("method")||v0,i=FS(n.getAttribute("enctype"))||b0,s=new FormData(n)}else if(o9(n)||l9(n)&&(n.type==="submit"||n.type==="image")){let l=n.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=n.getAttribute("formaction")||l.getAttribute("action");if(r=u?Go(u,t):null,e=n.getAttribute("formmethod")||l.getAttribute("method")||v0,i=FS(n.getAttribute("formenctype"))||FS(l.getAttribute("enctype"))||b0,s=new FormData(l,n),!h9()){let{name:h,type:d,value:p}=n;if(d==="image"){let g=h?`${h}.`:"";s.append(`${g}x`,"0"),s.append(`${g}y`,"0")}else h&&s.append(h,p)}}else{if(Ob(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=v0,r=null,i=b0,o=n}return s&&i==="text/plain"&&(o=s,s=void 0),{action:r,method:e.toLowerCase(),encType:i,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function a1(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function p9(n,t,e,r){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:t&&Go(i.pathname,t)==="/"?i.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function m9(n,t){if(n.id in t)return t[n.id];try{let e=await import(n.module);return t[n.id]=e,e}catch(e){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function g9(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function y9(n,t,e){let r=await Promise.all(n.map(async i=>{let s=t.routes[i.route.id];if(s){let o=await m9(s,e);return o.links?o.links():[]}return[]}));return T9(r.flat(1).filter(g9).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function PO(n,t,e,r,i,s){let o=(u,h)=>e[h]?u.route.id!==e[h].route.id:!0,l=(u,h)=>e[h].pathname!==u.pathname||e[h].route.path?.endsWith("*")&&e[h].params["*"]!==u.params["*"];return s==="assets"?t.filter((u,h)=>o(u,h)||l(u,h)):s==="data"?t.filter((u,h)=>{let d=r.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(o(u,h)||l(u,h))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function v9(n,t,{includeHydrateFallback:e}={}){return b9(n.map(r=>{let i=t.routes[r.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),e&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function b9(n){return[...new Set(n)]}function _9(n){let t={},e=Object.keys(n).sort();for(let r of e)t[r]=n[r];return t}function T9(n,t){let e=new Set;return new Set(t),n.reduce((r,i)=>{let s=JSON.stringify(_9(i));return e.has(s)||(e.add(s),r.push({key:s,link:i})),r},[])}function bL(){let n=L.useContext(lf);return a1(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function S9(){let n=L.useContext(Db);return a1(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var l1=L.createContext(void 0);l1.displayName="FrameworkContext";function _L(){let n=L.useContext(l1);return a1(n,"You must render this element inside a <HydratedRouter> element"),n}function w9(n,t){let e=L.useContext(l1),[r,i]=L.useState(!1),[s,o]=L.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:h,onMouseLeave:d,onTouchStart:p}=t,g=L.useRef(null);L.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let S=E=>{E.forEach(D=>{o(D.isIntersecting)})},w=new IntersectionObserver(S,{threshold:.5});return g.current&&w.observe(g.current),()=>{w.disconnect()}}},[n]),L.useEffect(()=>{if(r){let S=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(S)}}},[r]);let v=()=>{i(!0)},T=()=>{i(!1),o(!1)};return e?n!=="intent"?[s,g,{}]:[s,g,{onFocus:Pd(l,v),onBlur:Pd(u,T),onMouseEnter:Pd(h,v),onMouseLeave:Pd(d,T),onTouchStart:Pd(p,v)}]:[!1,g,{}]}function Pd(n,t){return e=>{n&&n(e),e.defaultPrevented||t(e)}}function x9({page:n,...t}){let{router:e}=bL(),r=L.useMemo(()=>iL(e.routes,n,e.basename),[e.routes,n,e.basename]);return r?L.createElement(C9,{page:n,matches:r,...t}):null}function E9(n){let{manifest:t,routeModules:e}=_L(),[r,i]=L.useState([]);return L.useEffect(()=>{let s=!1;return y9(n,t,e).then(o=>{s||i(o)}),()=>{s=!0}},[n,t,e]),r}function C9({page:n,matches:t,...e}){let r=Ol(),{future:i,manifest:s,routeModules:o}=_L(),{basename:l}=bL(),{loaderData:u,matches:h}=S9(),d=L.useMemo(()=>PO(n,t,h,s,r,"data"),[n,t,h,s,r]),p=L.useMemo(()=>PO(n,t,h,s,r,"assets"),[n,t,h,s,r]),g=L.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let S=new Set,w=!1;if(t.forEach(D=>{let P=s.routes[D.route.id];!P||!P.hasLoader||(!d.some(V=>V.route.id===D.route.id)&&D.route.id in u&&o[D.route.id]?.shouldRevalidate||P.hasClientLoader?w=!0:S.add(D.route.id))}),S.size===0)return[];let E=p9(n,l,i.unstable_trailingSlashAwareDataRequests,"data");return w&&S.size>0&&E.searchParams.set("_routes",t.filter(D=>S.has(D.route.id)).map(D=>D.route.id).join(",")),[E.pathname+E.search]},[l,i.unstable_trailingSlashAwareDataRequests,u,r,s,d,t,n,o]),v=L.useMemo(()=>v9(p,s),[p,s]),T=E9(p);return L.createElement(L.Fragment,null,g.map(S=>L.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...e})),v.map(S=>L.createElement("link",{key:S,rel:"modulepreload",href:S,...e})),T.map(({key:S,link:w})=>L.createElement("link",{key:S,nonce:e.nonce,...w,crossOrigin:w.crossOrigin??e.crossOrigin})))}function A9(...n){return t=>{n.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var k9=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{k9&&(window.__reactRouterVersion="7.13.0")}catch{}function M9({basename:n,children:t,unstable_useTransitions:e,window:r}){let i=L.useRef();i.current==null&&(i.current=oH({window:r,v5Compat:!0}));let s=i.current,[o,l]=L.useState({action:s.action,location:s.location}),u=L.useCallback(h=>{e===!1?l(h):L.startTransition(()=>l(h))},[e]);return L.useLayoutEffect(()=>s.listen(u),[s,u]),L.createElement(i9,{basename:n,children:t,location:o.location,navigationType:o.action,navigator:s,unstable_useTransitions:e})}var TL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,c1=L.forwardRef(function({onClick:t,discover:e="render",prefetch:r="none",relative:i,reloadDocument:s,replace:o,state:l,target:u,to:h,preventScrollReset:d,viewTransition:p,unstable_defaultShouldRevalidate:g,...v},T){let{basename:S,unstable_useTransitions:w}=L.useContext(oi),E=typeof h=="string"&&TL.test(h),D=lL(h,S);h=D.to;let P=BH(h,{relative:i}),[V,N,q]=w9(r,v),M=R9(h,{replace:o,state:l,target:u,preventScrollReset:d,relative:i,viewTransition:p,unstable_defaultShouldRevalidate:g,unstable_useTransitions:w});function k(F){t&&t(F),F.defaultPrevented||M(F)}let R=L.createElement("a",{...v,...q,href:D.absoluteURL||P,onClick:D.isExternal||s?t:k,ref:A9(T,N),target:u,"data-discover":!E&&e==="render"?"true":void 0});return V&&!E?L.createElement(L.Fragment,null,R,L.createElement(x9,{page:P})):R});c1.displayName="Link";var SL=L.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:r="",end:i=!1,style:s,to:o,viewTransition:l,children:u,...h},d){let p=vm(o,{relative:h.relative}),g=Ol(),v=L.useContext(Db),{navigator:T,basename:S}=L.useContext(oi),w=v!=null&&V9(p)&&l===!0,E=T.encodeLocation?T.encodeLocation(p).pathname:p.pathname,D=g.pathname,P=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;e||(D=D.toLowerCase(),P=P?P.toLowerCase():null,E=E.toLowerCase()),P&&S&&(P=Go(P,S)||P);const V=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let N=D===E||!i&&D.startsWith(E)&&D.charAt(V)==="/",q=P!=null&&(P===E||!i&&P.startsWith(E)&&P.charAt(E.length)==="/"),M={isActive:N,isPending:q,isTransitioning:w},k=N?t:void 0,R;typeof r=="function"?R=r(M):R=[r,N?"active":null,q?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let F=typeof s=="function"?s(M):s;return L.createElement(c1,{...h,"aria-current":k,className:R,ref:d,style:F,to:o,viewTransition:l},typeof u=="function"?u(M):u)});SL.displayName="NavLink";var D9=L.forwardRef(({discover:n="render",fetcherKey:t,navigate:e,reloadDocument:r,replace:i,state:s,method:o=v0,action:l,onSubmit:u,relative:h,preventScrollReset:d,viewTransition:p,unstable_defaultShouldRevalidate:g,...v},T)=>{let{unstable_useTransitions:S}=L.useContext(oi),w=N9(),E=L9(l,{relative:h}),D=o.toLowerCase()==="get"?"get":"post",P=typeof l=="string"&&TL.test(l),V=N=>{if(u&&u(N),N.defaultPrevented)return;N.preventDefault();let q=N.nativeEvent.submitter,M=q?.getAttribute("formmethod")||o,k=()=>w(q||N.currentTarget,{fetcherKey:t,method:M,navigate:e,replace:i,state:s,relative:h,preventScrollReset:d,viewTransition:p,unstable_defaultShouldRevalidate:g});S&&e!==!1?L.startTransition(()=>k()):k()};return L.createElement("form",{ref:T,method:D,action:E,onSubmit:r?u:V,...v,"data-discover":!P&&n==="render"?"true":void 0})});D9.displayName="Form";function O9(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wL(n){let t=L.useContext(lf);return Ve(t,O9(n)),t}function R9(n,{target:t,replace:e,state:r,preventScrollReset:i,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:l,unstable_useTransitions:u}={}){let h=ym(),d=Ol(),p=vm(n,{relative:s});return L.useCallback(g=>{if(u9(g,t)){g.preventDefault();let v=e!==void 0?e:Pp(d)===Pp(p),T=()=>h(n,{replace:v,state:r,preventScrollReset:i,relative:s,viewTransition:o,unstable_defaultShouldRevalidate:l});u?L.startTransition(()=>T()):T()}},[d,h,p,e,r,t,n,i,s,o,l,u])}var I9=0,P9=()=>`__${String(++I9)}__`;function N9(){let{router:n}=wL("useSubmit"),{basename:t}=L.useContext(oi),e=t9(),r=n.fetch,i=n.navigate;return L.useCallback(async(s,o={})=>{let{action:l,method:u,encType:h,formData:d,body:p}=d9(s,t);if(o.navigate===!1){let g=o.fetcherKey||P9();await r(g,e,o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:p,formMethod:o.method||u,formEncType:o.encType||h,flushSync:o.flushSync})}else await i(o.action||l,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:d,body:p,formMethod:o.method||u,formEncType:o.encType||h,replace:o.replace,state:o.state,fromRouteId:e,flushSync:o.flushSync,viewTransition:o.viewTransition})},[r,i,t,e])}function L9(n,{relative:t}={}){let{basename:e}=L.useContext(oi),r=L.useContext(Ni);Ve(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s={...vm(n||".",{relative:t})},o=Ol();if(n==null){s.search=o.search;let l=new URLSearchParams(s.search),u=l.getAll("index");if(u.some(d=>d==="")){l.delete("index"),u.filter(p=>p).forEach(p=>l.append("index",p));let d=l.toString();s.search=d?`?${d}`:""}}return(!n||n===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(s.pathname=s.pathname==="/"?e:Uo([e,s.pathname])),Pp(s)}function V9(n,{relative:t}={}){let e=L.useContext(uL);Ve(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=wL("useViewTransitionState"),i=vm(n,{relative:t});if(!e.isTransitioning)return!1;let s=Go(e.currentLocation.pathname,r)||e.currentLocation.pathname,o=Go(e.nextLocation.pathname,r)||e.nextLocation.pathname;return K0(i.pathname,o)!=null||K0(i.pathname,s)!=null}var j9=rL();const F9=nL(j9),B9=()=>{};var NO={};const xL=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128)}return t},U9=function(n){const t=[];let e=0,r=0;for(;e<n.length;){const i=n[e++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[e++];t[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[e++],o=n[e++],l=n[e++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(u&1023))}else{const s=n[e++],o=n[e++];t[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},EL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,l=o?n[i+1]:0,u=i+2<n.length,h=u?n[i+2]:0,d=s>>2,p=(s&3)<<4|l>>4;let g=(l&15)<<2|h>>6,v=h&63;u||(v=64,o||(g=64)),r.push(e[d],e[p],e[g],e[v])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(xL(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):U9(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=e[n.charAt(i++)],l=i<n.length?e[n.charAt(i)]:0;++i;const h=i<n.length?e[n.charAt(i)]:64;++i;const p=i<n.length?e[n.charAt(i)]:64;if(++i,s==null||l==null||h==null||p==null)throw new z9;const g=s<<2|l>>4;if(r.push(g),h!==64){const v=l<<4&240|h>>2;if(r.push(v),p!==64){const T=h<<6&192|p;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class z9 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const H9=function(n){const t=xL(n);return EL.encodeByteArray(t,!0)},X0=function(n){return H9(n).replace(/\./g,"")},CL=function(n){try{return EL.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function $9(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const q9=()=>$9().__FIREBASE_DEFAULTS__,W9=()=>{if(typeof process>"u"||typeof NO>"u")return;const n=NO.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},G9=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&CL(n[1]);return t&&JSON.parse(t)},Rb=()=>{try{return B9()||q9()||W9()||G9()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},AL=n=>Rb()?.emulatorHosts?.[n],kL=n=>{const t=AL(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),r]:[t.substring(0,e),r]},ML=()=>Rb()?.config,DL=n=>Rb()?.[`_${n}`];class Y9{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,r))}}}function Rl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function u1(n){return(await fetch(n,{credentials:"include"})).ok}function OL(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},r=t||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[X0(JSON.stringify(e)),X0(JSON.stringify(o)),""].join(".")}const ap={};function K9(){const n={prod:[],emulator:[]};for(const t of Object.keys(ap))ap[t]?n.emulator.push(t):n.prod.push(t);return n}function X9(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let LO=!1;function h1(n,t){if(typeof window>"u"||typeof document>"u"||!Rl(window.location.host)||ap[n]===t||ap[n]||LO)return;ap[n]=t;function e(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=K9().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{LO=!0,o()},g}function d(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=X9(r),v=e("text"),T=document.getElementById(v)||document.createElement("span"),S=e("learnmore"),w=document.getElementById(S)||document.createElement("a"),E=e("preprendIcon"),D=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const P=g.element;l(P),d(w,S);const V=h();u(D,E),P.append(D,T,w,V),document.body.appendChild(P)}s?(T.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function ar(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Q9(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ar())}function J9(){const n=Rb()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Z9(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function t$(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function e$(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function n$(){const n=ar();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function r$(){return!J9()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function i$(){try{return typeof indexedDB=="object"}catch{return!1}}function s$(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{e=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(e){t(e)}})}const o$="FirebaseError";class so extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=o$,Object.setPrototypeOf(this,so.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,bm.prototype.create)}}class bm{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?a$(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new so(i,l,r)}}function a$(n,t){return n.replace(l$,(e,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const l$=/\{\$([^}]+)}/g;function c$(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function Jc(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const i of e){if(!r.includes(i))return!1;const s=n[i],o=t[i];if(VO(s)&&VO(o)){if(!Jc(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!e.includes(i))return!1;return!0}function VO(n){return n!==null&&typeof n=="object"}function _m(n){const t=[];for(const[e,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Yd(n){const t={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");t[decodeURIComponent(i)]=decodeURIComponent(s)}}),t}function Kd(n){const t=n.indexOf("?");if(!t)return"";const e=n.indexOf("#",t);return n.substring(t,e>0?e:void 0)}function u$(n,t){const e=new h$(n,t);return e.subscribe.bind(e)}class h${constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let i;if(t===void 0&&e===void 0&&r===void 0)throw new Error("Missing Observer.");f$(t,["next","error","complete"])?i=t:i={next:t,error:e,complete:r},i.next===void 0&&(i.next=BS),i.error===void 0&&(i.error=BS),i.complete===void 0&&(i.complete=BS);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function f$(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function BS(){}function je(n){return n&&n._delegate?n._delegate:n}class yl{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Ec="[DEFAULT]";class d${constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new Y9;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:e});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),r=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(m$(t))try{this.getOrInitializeService({instanceIdentifier:Ec})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(e);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(t=Ec){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ec){return this.instances.has(t)}getOptions(t=Ec){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(t,e){const r=this.normalizeInstanceIdentifier(e),i=this.onInitCallbacks.get(r)??new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const i of r)try{i(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:p$(t),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=Ec){return this.component?this.component.multipleInstances?t:Ec:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function p$(n){return n===Ec?void 0:n}function m$(n){return n.instantiationMode==="EAGER"}class g${constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new d$(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var Jt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Jt||(Jt={}));const y$={debug:Jt.DEBUG,verbose:Jt.VERBOSE,info:Jt.INFO,warn:Jt.WARN,error:Jt.ERROR,silent:Jt.SILENT},v$=Jt.INFO,b$={[Jt.DEBUG]:"log",[Jt.VERBOSE]:"log",[Jt.INFO]:"info",[Jt.WARN]:"warn",[Jt.ERROR]:"error"},_$=(n,t,...e)=>{if(t<n.logLevel)return;const r=new Date().toISOString(),i=b$[t];if(i)console[i](`[${r}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class f1{constructor(t){this.name=t,this._logLevel=v$,this._logHandler=_$,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Jt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?y$[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Jt.DEBUG,...t),this._logHandler(this,Jt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Jt.VERBOSE,...t),this._logHandler(this,Jt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Jt.INFO,...t),this._logHandler(this,Jt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Jt.WARN,...t),this._logHandler(this,Jt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Jt.ERROR,...t),this._logHandler(this,Jt.ERROR,...t)}}const T$=(n,t)=>t.some(e=>n instanceof e);let jO,FO;function S$(){return jO||(jO=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function w$(){return FO||(FO=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const RL=new WeakMap,hx=new WeakMap,IL=new WeakMap,US=new WeakMap,d1=new WeakMap;function x$(n){const t=new Promise((e,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{e(ll(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&RL.set(e,n)}).catch(()=>{}),d1.set(t,n),t}function E$(n){if(hx.has(n))return;const t=new Promise((e,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{e(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});hx.set(n,t)}let fx={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return hx.get(n);if(t==="objectStoreNames")return n.objectStoreNames||IL.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return ll(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function C$(n){fx=n(fx)}function A$(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const r=n.call(zS(this),t,...e);return IL.set(r,t.sort?t.sort():[t]),ll(r)}:w$().includes(n)?function(...t){return n.apply(zS(this),t),ll(RL.get(this))}:function(...t){return ll(n.apply(zS(this),t))}}function k$(n){return typeof n=="function"?A$(n):(n instanceof IDBTransaction&&E$(n),T$(n,S$())?new Proxy(n,fx):n)}function ll(n){if(n instanceof IDBRequest)return x$(n);if(US.has(n))return US.get(n);const t=k$(n);return t!==n&&(US.set(n,t),d1.set(t,n)),t}const zS=n=>d1.get(n);function M$(n,t,{blocked:e,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,t),l=ll(o);return r&&o.addEventListener("upgradeneeded",u=>{r(ll(o.result),u.oldVersion,u.newVersion,ll(o.transaction),u)}),e&&o.addEventListener("blocked",u=>e(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const D$=["get","getKey","getAll","getAllKeys","count"],O$=["put","add","delete","clear"],HS=new Map;function BO(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(HS.get(t))return HS.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,i=O$.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!(i||D$.includes(e)))return;const s=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let h=u.store;return r&&(h=h.index(l.shift())),(await Promise.all([h[e](...l),i&&u.done]))[0]};return HS.set(t,s),s}C$(n=>({...n,get:(t,e,r)=>BO(t,e)||n.get(t,e,r),has:(t,e)=>!!BO(t,e)||n.has(t,e)}));class R${constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(I$(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(e=>e).join(" ")}}function I$(n){return n.getComponent()?.type==="VERSION"}const dx="@firebase/app",UO="0.14.8";const Yo=new f1("@firebase/app"),P$="@firebase/app-compat",N$="@firebase/analytics-compat",L$="@firebase/analytics",V$="@firebase/app-check-compat",j$="@firebase/app-check",F$="@firebase/auth",B$="@firebase/auth-compat",U$="@firebase/database",z$="@firebase/data-connect",H$="@firebase/database-compat",$$="@firebase/functions",q$="@firebase/functions-compat",W$="@firebase/installations",G$="@firebase/installations-compat",Y$="@firebase/messaging",K$="@firebase/messaging-compat",X$="@firebase/performance",Q$="@firebase/performance-compat",J$="@firebase/remote-config",Z$="@firebase/remote-config-compat",tq="@firebase/storage",eq="@firebase/storage-compat",nq="@firebase/firestore",rq="@firebase/ai",iq="@firebase/firestore-compat",sq="firebase",oq="12.9.0";const px="[DEFAULT]",aq={[dx]:"fire-core",[P$]:"fire-core-compat",[L$]:"fire-analytics",[N$]:"fire-analytics-compat",[j$]:"fire-app-check",[V$]:"fire-app-check-compat",[F$]:"fire-auth",[B$]:"fire-auth-compat",[U$]:"fire-rtdb",[z$]:"fire-data-connect",[H$]:"fire-rtdb-compat",[$$]:"fire-fn",[q$]:"fire-fn-compat",[W$]:"fire-iid",[G$]:"fire-iid-compat",[Y$]:"fire-fcm",[K$]:"fire-fcm-compat",[X$]:"fire-perf",[Q$]:"fire-perf-compat",[J$]:"fire-rc",[Z$]:"fire-rc-compat",[tq]:"fire-gcs",[eq]:"fire-gcs-compat",[nq]:"fire-fst",[iq]:"fire-fst-compat",[rq]:"fire-vertex","fire-js":"fire-js",[sq]:"fire-js-all"};const Q0=new Map,lq=new Map,mx=new Map;function zO(n,t){try{n.container.addComponent(t)}catch(e){Yo.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Zc(n){const t=n.name;if(mx.has(t))return Yo.debug(`There were multiple attempts to register component ${t}.`),!1;mx.set(t,n);for(const e of Q0.values())zO(e,n);for(const e of lq.values())zO(e,n);return!0}function Ib(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function Vr(n){return n==null?!1:n.settings!==void 0}const cq={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cl=new bm("app","Firebase",cq);class uq{constructor(t,e,r){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new yl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw cl.create("app-deleted",{appName:this._name})}}const pu=oq;function PL(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const r={name:px,automaticDataCollectionEnabled:!0,...t},i=r.name;if(typeof i!="string"||!i)throw cl.create("bad-app-name",{appName:String(i)});if(e||(e=ML()),!e)throw cl.create("no-options");const s=Q0.get(i);if(s){if(Jc(e,s.options)&&Jc(r,s.config))return s;throw cl.create("duplicate-app",{appName:i})}const o=new g$(i);for(const u of mx.values())o.addComponent(u);const l=new uq(e,r,o);return Q0.set(i,l),l}function p1(n=px){const t=Q0.get(n);if(!t&&n===px&&ML())return PL();if(!t)throw cl.create("no-app",{appName:n});return t}function Ws(n,t,e){let r=aq[n]??n;e&&(r+=`-${e}`);const i=r.match(/\s|\//),s=t.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${t}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Yo.warn(o.join(" "));return}Zc(new yl(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const hq="firebase-heartbeat-database",fq=1,Np="firebase-heartbeat-store";let $S=null;function NL(){return $S||($S=M$(hq,fq,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Np)}catch(e){console.warn(e)}}}}).catch(n=>{throw cl.create("idb-open",{originalErrorMessage:n.message})})),$S}async function dq(n){try{const e=(await NL()).transaction(Np),r=await e.objectStore(Np).get(LL(n));return await e.done,r}catch(t){if(t instanceof so)Yo.warn(t.message);else{const e=cl.create("idb-get",{originalErrorMessage:t?.message});Yo.warn(e.message)}}}async function HO(n,t){try{const r=(await NL()).transaction(Np,"readwrite");await r.objectStore(Np).put(t,LL(n)),await r.done}catch(e){if(e instanceof so)Yo.warn(e.message);else{const r=cl.create("idb-set",{originalErrorMessage:e?.message});Yo.warn(r.message)}}}function LL(n){return`${n.name}!${n.options.appId}`}const pq=1024,mq=30;class gq{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new vq(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=$O();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:e}),this._heartbeatsCache.heartbeats.length>mq){const i=bq(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){Yo.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=$O(),{heartbeatsToSend:e,unsentEntries:r}=yq(this._heartbeatsCache.heartbeats),i=X0(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Yo.warn(t),""}}}function $O(){return new Date().toISOString().substring(0,10)}function yq(n,t=pq){const e=[];let r=n.slice();for(const i of n){const s=e.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),qO(e)>t){s.dates.pop();break}}else if(e.push({agent:i.agent,dates:[i.date]}),qO(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}class vq{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return i$()?s$().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await dq(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return HO(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return HO(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function qO(n){return X0(JSON.stringify({version:2,heartbeats:n})).length}function bq(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let r=1;r<n.length;r++)n[r].date<e&&(e=n[r].date,t=r);return t}function _q(n){Zc(new yl("platform-logger",t=>new R$(t),"PRIVATE")),Zc(new yl("heartbeat",t=>new gq(t),"PRIVATE")),Ws(dx,UO,n),Ws(dx,UO,"esm2020"),Ws("fire-js","")}_q("");function VL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Tq=VL,jL=new bm("auth","Firebase",VL());const J0=new f1("@firebase/auth");function Sq(n,...t){J0.logLevel<=Jt.WARN&&J0.warn(`Auth (${pu}): ${n}`,...t)}function _0(n,...t){J0.logLevel<=Jt.ERROR&&J0.error(`Auth (${pu}): ${n}`,...t)}function Ri(n,...t){throw g1(n,...t)}function is(n,...t){return g1(n,...t)}function m1(n,t,e){const r={...Tq(),[t]:e};return new bm("auth","Firebase",r).create(t,{appName:n.name})}function zo(n){return m1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wq(n,t,e){const r=e;if(!(t instanceof r))throw r.name!==t.constructor.name&&Ri(n,"argument-error"),m1(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function g1(n,...t){if(typeof n!="string"){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(e,...r)}return jL.create(n,...t)}function Lt(n,t,...e){if(!n)throw g1(t,...e)}function Lo(n){const t="INTERNAL ASSERTION FAILED: "+n;throw _0(t),new Error(t)}function Ko(n,t){n||Lo(t)}function gx(){return typeof self<"u"&&self.location?.href||""}function xq(){return WO()==="http:"||WO()==="https:"}function WO(){return typeof self<"u"&&self.location?.protocol||null}function Eq(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xq()||t$()||"connection"in navigator)?navigator.onLine:!0}function Cq(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Tm{constructor(t,e){this.shortDelay=t,this.longDelay=e,Ko(e>t,"Short delay should be less than long delay!"),this.isMobile=Q9()||e$()}get(){return Eq()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function y1(n,t){Ko(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class FL{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Lo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Lo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Lo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Aq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const kq=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Mq=new Tm(3e4,6e4);function Il(n,t){return n.tenantId&&!t.tenantId?{...t,tenantId:n.tenantId}:t}async function Pl(n,t,e,r,i={}){return BL(n,i,async()=>{let s={},o={};r&&(t==="GET"?o=r:s={body:JSON.stringify(r)});const l=_m({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);const h={method:t,headers:u,...s};return Z9()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Rl(n.emulatorConfig.host)&&(h.credentials="include"),FL.fetch()(await UL(n,n.config.apiHost,e,l),h)})}async function BL(n,t,e){n._canInitEmulator=!1;const r={...Aq,...t};try{const i=new Oq(n),s=await Promise.race([e(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Ty(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,h]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ty(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ty(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ty(n,"user-disabled",o);const d=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw m1(n,d,h);Ri(n,d)}}catch(i){if(i instanceof so)throw i;Ri(n,"network-request-failed",{message:String(i)})}}async function Sm(n,t,e,r,i={}){const s=await Pl(n,t,e,r,i);return"mfaPendingCredential"in s&&Ri(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function UL(n,t,e,r){const i=`${t}${e}?${r}`,s=n,o=s.config.emulator?y1(n.config,i):`${n.config.apiScheme}://${i}`;return kq.includes(e)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function Dq(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Oq{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(is(this.auth,"network-request-failed")),Mq.get())})}}function Ty(n,t,e){const r={appName:n.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const i=is(n,t,r);return i.customData._tokenResponse=e,i}function GO(n){return n!==void 0&&n.enterprise!==void 0}class Rq{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return Dq(e.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Iq(n,t){return Pl(n,"GET","/v2/recaptchaConfig",Il(n,t))}async function Pq(n,t){return Pl(n,"POST","/v1/accounts:delete",t)}async function Z0(n,t){return Pl(n,"POST","/v1/accounts:lookup",t)}function lp(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function Nq(n,t=!1){const e=je(n),r=await e.getIdToken(t),i=v1(r);Lt(i&&i.exp&&i.auth_time&&i.iat,e.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:lp(qS(i.auth_time)),issuedAtTime:lp(qS(i.iat)),expirationTime:lp(qS(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function qS(n){return Number(n)*1e3}function v1(n){const[t,e,r]=n.split(".");if(t===void 0||e===void 0||r===void 0)return _0("JWT malformed, contained fewer than 3 sections"),null;try{const i=CL(e);return i?JSON.parse(i):(_0("Failed to decode base64 JWT payload"),null)}catch(i){return _0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function YO(n){const t=v1(n);return Lt(t,"internal-error"),Lt(typeof t.exp<"u","internal-error"),Lt(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function Lp(n,t,e=!1){if(e)return t;try{return await t}catch(r){throw r instanceof so&&Lq(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function Lq({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class Vq{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class yx{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=lp(this.lastLoginAt),this.creationTime=lp(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function tv(n){const t=n.auth,e=await n.getIdToken(),r=await Lp(n,Z0(t,{idToken:e}));Lt(r?.users.length,t,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const s=i.providerUserInfo?.length?zL(i.providerUserInfo):[],o=Fq(n.providerData,s),l=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,h=l?u:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new yx(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function jq(n){const t=je(n);await tv(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function Fq(n,t){return[...n.filter(r=>!t.some(i=>i.providerId===r.providerId)),...t]}function zL(n){return n.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}async function Bq(n,t){const e=await BL(n,{},async()=>{const r=_m({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await UL(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return n.emulatorConfig&&Rl(n.emulatorConfig.host)&&(u.credentials="include"),FL.fetch()(o,u)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function Uq(n,t){return Pl(n,"POST","/v2/accounts:revokeToken",Il(n,t))}class Oh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Lt(t.idToken,"internal-error"),Lt(typeof t.idToken<"u","internal-error"),Lt(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):YO(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){Lt(t.length!==0,"internal-error");const e=YO(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(Lt(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:r,refreshToken:i,expiresIn:s}=await Bq(t,e);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(t,e){const{refreshToken:r,accessToken:i,expirationTime:s}=e,o=new Oh;return r&&(Lt(typeof r=="string","internal-error",{appName:t}),o.refreshToken=r),i&&(Lt(typeof i=="string","internal-error",{appName:t}),o.accessToken=i),s&&(Lt(typeof s=="number","internal-error",{appName:t}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Oh,this.toJSON())}_performRefresh(){return Lo("not implemented")}}function Fa(n,t){Lt(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class es{constructor({uid:t,auth:e,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Vq(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new yx(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(t){const e=await Lp(this,this.stsTokenManager.getToken(this.auth,t));return Lt(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return Nq(this,t)}reload(){return jq(this)}_assign(t){this!==t&&(Lt(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new es({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){Lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let r=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),e&&await tv(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Vr(this.auth.app))return Promise.reject(zo(this.auth));const t=await this.getIdToken();return await Lp(this,Pq(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const r=e.displayName??void 0,i=e.email??void 0,s=e.phoneNumber??void 0,o=e.photoURL??void 0,l=e.tenantId??void 0,u=e._redirectEventId??void 0,h=e.createdAt??void 0,d=e.lastLoginAt??void 0,{uid:p,emailVerified:g,isAnonymous:v,providerData:T,stsTokenManager:S}=e;Lt(p&&S,t,"internal-error");const w=Oh.fromJSON(this.name,S);Lt(typeof p=="string",t,"internal-error"),Fa(r,t.name),Fa(i,t.name),Lt(typeof g=="boolean",t,"internal-error"),Lt(typeof v=="boolean",t,"internal-error"),Fa(s,t.name),Fa(o,t.name),Fa(l,t.name),Fa(u,t.name),Fa(h,t.name),Fa(d,t.name);const E=new es({uid:p,auth:t,email:i,emailVerified:g,displayName:r,isAnonymous:v,photoURL:o,phoneNumber:s,tenantId:l,stsTokenManager:w,createdAt:h,lastLoginAt:d});return T&&Array.isArray(T)&&(E.providerData=T.map(D=>({...D}))),u&&(E._redirectEventId=u),E}static async _fromIdTokenResponse(t,e,r=!1){const i=new Oh;i.updateFromServerResponse(e);const s=new es({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:r});return await tv(s),s}static async _fromGetAccountInfoResponse(t,e,r){const i=e.users[0];Lt(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?zL(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,l=new Oh;l.updateFromIdToken(r);const u=new es({uid:i.localId,auth:t,stsTokenManager:l,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new yx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,h),u}}const KO=new Map;function Vo(n){Ko(n instanceof Function,"Expected a class definition");let t=KO.get(n);return t?(Ko(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,KO.set(n,t),t)}class HL{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}HL.type="NONE";const XO=HL;function T0(n,t,e){return`firebase:${n}:${t}:${e}`}class Rh{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=T0(this.userKey,i.apiKey,s),this.fullPersistenceKey=T0("persistence",i.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await Z0(this.auth,{idToken:t}).catch(()=>{});return e?es._fromGetAccountInfoResponse(this.auth,e,t):null}return es._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,r="authUser"){if(!e.length)return new Rh(Vo(XO),t,r);const i=(await Promise.all(e.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=i[0]||Vo(XO);const o=T0(r,t.config.apiKey,t.name);let l=null;for(const h of e)try{const d=await h._get(o);if(d){let p;if(typeof d=="string"){const g=await Z0(t,{idToken:d}).catch(()=>{});if(!g)break;p=await es._fromGetAccountInfoResponse(t,g,d)}else p=es._fromJSON(t,d);h!==s&&(l=p),s=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Rh(s,t,r):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(e.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Rh(s,t,r))}}function QO(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(GL(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if($L(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(KL(t))return"Blackberry";if(XL(t))return"Webos";if(qL(t))return"Safari";if((t.includes("chrome/")||WL(t))&&!t.includes("edge/"))return"Chrome";if(YL(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(e);if(r?.length===2)return r[1]}return"Other"}function $L(n=ar()){return/firefox\//i.test(n)}function qL(n=ar()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function WL(n=ar()){return/crios\//i.test(n)}function GL(n=ar()){return/iemobile/i.test(n)}function YL(n=ar()){return/android/i.test(n)}function KL(n=ar()){return/blackberry/i.test(n)}function XL(n=ar()){return/webos/i.test(n)}function b1(n=ar()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function zq(n=ar()){return b1(n)&&!!window.navigator?.standalone}function Hq(){return n$()&&document.documentMode===10}function QL(n=ar()){return b1(n)||YL(n)||XL(n)||KL(n)||/windows phone/i.test(n)||GL(n)}function JL(n,t=[]){let e;switch(n){case"Browser":e=QO(ar());break;case"Worker":e=`${QO(ar())}-${n}`;break;default:e=n}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${pu}/${r}`}class $q{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=s=>new Promise((o,l)=>{try{const u=t(s);o(u)}catch(u){l(u)}});r.onAbort=e,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const r of this.queue)await r(t),r.onAbort&&e.push(r.onAbort)}catch(r){e.reverse();for(const i of e)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function qq(n,t={}){return Pl(n,"GET","/v2/passwordPolicy",Il(n,t))}const Wq=6;class Gq{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??Wq,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(e.meetsMinPasswordLength=t.length>=r),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let r;for(let i=0;i<t.length;i++)r=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(t,e,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}class Yq{constructor(t,e,r,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new JO(this),this.idTokenSubscription=new JO(this),this.beforeStateQueue=new $q(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jL,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Vo(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Rh.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await Z0(this,{idToken:t}),r=await es._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(Vr(this.app)){const s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let r=e,i=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,l=await this.tryRedirectSignIn(t);(!s||s===o)&&l?.user&&(r=l.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await tv(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=Cq()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Vr(this.app))return Promise.reject(zo(this));const e=t?je(t):null;return e&&Lt(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Lt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Vr(this.app)?Promise.reject(zo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Vr(this.app)?Promise.reject(zo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vo(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await qq(this),e=new Gq(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new bm("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const r=this.onAuthStateChanged(()=>{r(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(r.tenantId=this.tenantId),await Uq(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const r=await this.getOrInitRedirectPersistenceManager(e);return t===null?r.removeCurrentUser():r.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Vo(t)||this._popupRedirectResolver;Lt(e,this,"argument-error"),this.redirectPersistenceManager=await Rh.create(this,[Vo(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,i){if(this._deleted)return()=>{};const s=typeof e=="function"?e:e.next.bind(e);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Lt(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof e=="function"){const u=t.addObserver(e,r,i);return()=>{o=!0,u()}}else{const u=t.addObserver(e);return()=>{o=!0,u()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=JL(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){if(Vr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&Sq(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Nl(n){return je(n)}class JO{constructor(t){this.auth=t,this.observer=null,this.addObserver=u$(e=>this.observer=e)}get next(){return Lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Pb={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Kq(n){Pb=n}function ZL(n){return Pb.loadJS(n)}function Xq(){return Pb.recaptchaEnterpriseScript}function Qq(){return Pb.gapiScript}function Jq(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Zq{constructor(){this.enterprise=new t8}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class t8{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const e8="recaptcha-enterprise",tV="NO_RECAPTCHA";class n8{constructor(t){this.type=e8,this.auth=Nl(t)}async verify(t="verify",e=!1){async function r(s){if(!e){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{Iq(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const h=new Rq(u);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(u=>{l(u)})})}function i(s,o,l){const u=window.grecaptcha;GO(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:t}).then(h=>{o(h)}).catch(()=>{o(tV)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Zq().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(l=>{if(!e&&GO(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=Xq();u.length!==0&&(u+=l),ZL(u).then(()=>{i(l,s,o)}).catch(h=>{o(h)})}}).catch(l=>{o(l)})})}}async function ZO(n,t,e,r=!1,i=!1){const s=new n8(n);let o;if(i)o=tV;else try{o=await s.verify(e)}catch{o=await s.verify(e,!0)}const l={...t};if(e==="mfaSmsEnrollment"||e==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,h=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function vx(n,t,e,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await ZO(n,t,e,e==="getOobCode");return r(n,s)}else return r(n,t).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${e} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await ZO(n,t,e,e==="getOobCode");return r(n,o)}else return Promise.reject(s)})}function r8(n,t){const e=Ib(n,"auth");if(e.isInitialized()){const i=e.getImmediate(),s=e.getOptions();if(Jc(s,t??{}))return i;Ri(i,"already-initialized")}return e.initialize({options:t})}function i8(n,t){const e=t?.persistence||[],r=(Array.isArray(e)?e:[e]).map(Vo);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(r,t?.popupRedirectResolver)}function s8(n,t,e){const r=Nl(n);Lt(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!1,s=eV(t),{host:o,port:l}=o8(t),u=l===null?"":`:${l}`,h={url:`${s}//${o}${u}/`},d=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Lt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Lt(Jc(h,r.config.emulator)&&Jc(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Rl(o)?(u1(`${s}//${o}${u}`),h1("Auth",!0)):a8()}function eV(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function o8(n){const t=eV(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:tR(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:tR(o)}}}function tR(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function a8(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class _1{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Lo("not implemented")}_getIdTokenResponse(t){return Lo("not implemented")}_linkToIdToken(t,e){return Lo("not implemented")}_getReauthenticationResolver(t){return Lo("not implemented")}}async function l8(n,t){return Pl(n,"POST","/v1/accounts:signUp",t)}async function c8(n,t){return Sm(n,"POST","/v1/accounts:signInWithPassword",Il(n,t))}async function u8(n,t){return Sm(n,"POST","/v1/accounts:signInWithEmailLink",Il(n,t))}async function h8(n,t){return Sm(n,"POST","/v1/accounts:signInWithEmailLink",Il(n,t))}class Vp extends _1{constructor(t,e,r,i=null){super("password",r),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new Vp(t,e,"password")}static _fromEmailAndCode(t,e,r=null){return new Vp(t,e,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t;if(e?.email&&e?.password){if(e.signInMethod==="password")return this._fromEmailAndPassword(e.email,e.password);if(e.signInMethod==="emailLink")return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const e={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return vx(t,e,"signInWithPassword",c8);case"emailLink":return u8(t,{email:this._email,oobCode:this._password});default:Ri(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":const r={idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return vx(t,r,"signUpPassword",l8);case"emailLink":return h8(t,{idToken:e,email:this._email,oobCode:this._password});default:Ri(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function Ih(n,t){return Sm(n,"POST","/v1/accounts:signInWithIdp",Il(n,t))}const f8="http://localhost";class tu extends _1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new tu(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Ri("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:r,signInMethod:i,...s}=e;if(!r||!i)return null;const o=new tu(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(t){const e=this.buildRequest();return Ih(t,e)}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,Ih(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Ih(t,e)}buildRequest(){const t={requestUri:f8,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=_m(e)}return t}}function d8(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function p8(n){const t=Yd(Kd(n)).link,e=t?Yd(Kd(t)).deep_link_id:null,r=Yd(Kd(n)).deep_link_id;return(r?Yd(Kd(r)).link:null)||r||e||t||n}class T1{constructor(t){const e=Yd(Kd(t)),r=e.apiKey??null,i=e.oobCode??null,s=d8(e.mode??null);Lt(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=e.continueUrl??null,this.languageCode=e.lang??null,this.tenantId=e.tenantId??null}static parseLink(t){const e=p8(t);try{return new T1(e)}catch{return null}}}class uf{constructor(){this.providerId=uf.PROVIDER_ID}static credential(t,e){return Vp._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const r=T1.parseLink(e);return Lt(r,"argument-error"),Vp._fromEmailAndCode(t,r.code,r.tenantId)}}uf.PROVIDER_ID="password";uf.EMAIL_PASSWORD_SIGN_IN_METHOD="password";uf.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class S1{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class wm extends S1{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class Xa extends wm{constructor(){super("facebook.com")}static credential(t){return tu._fromParams({providerId:Xa.PROVIDER_ID,signInMethod:Xa.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Xa.credentialFromTaggedObject(t)}static credentialFromError(t){return Xa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Xa.credential(t.oauthAccessToken)}catch{return null}}}Xa.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xa.PROVIDER_ID="facebook.com";class No extends wm{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return tu._fromParams({providerId:No.PROVIDER_ID,signInMethod:No.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return No.credentialFromTaggedObject(t)}static credentialFromError(t){return No.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:r}=t;if(!e&&!r)return null;try{return No.credential(e,r)}catch{return null}}}No.GOOGLE_SIGN_IN_METHOD="google.com";No.PROVIDER_ID="google.com";class Qa extends wm{constructor(){super("github.com")}static credential(t){return tu._fromParams({providerId:Qa.PROVIDER_ID,signInMethod:Qa.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Qa.credentialFromTaggedObject(t)}static credentialFromError(t){return Qa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Qa.credential(t.oauthAccessToken)}catch{return null}}}Qa.GITHUB_SIGN_IN_METHOD="github.com";Qa.PROVIDER_ID="github.com";class Ja extends wm{constructor(){super("twitter.com")}static credential(t,e){return tu._fromParams({providerId:Ja.PROVIDER_ID,signInMethod:Ja.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Ja.credentialFromTaggedObject(t)}static credentialFromError(t){return Ja.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:r}=t;if(!e||!r)return null;try{return Ja.credential(e,r)}catch{return null}}}Ja.TWITTER_SIGN_IN_METHOD="twitter.com";Ja.PROVIDER_ID="twitter.com";async function m8(n,t){return Sm(n,"POST","/v1/accounts:signUp",Il(n,t))}class eu{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,r,i=!1){const s=await es._fromIdTokenResponse(t,r,i),o=eR(r);return new eu({user:s,providerId:o,_tokenResponse:r,operationType:e})}static async _forOperation(t,e,r){await t._updateTokensIfNecessary(r,!0);const i=eR(r);return new eu({user:t,providerId:i,_tokenResponse:r,operationType:e})}}function eR(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class ev extends so{constructor(t,e,r,i){super(e.code,e.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,ev.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,i){return new ev(t,e,r,i)}}function nV(n,t,e,r){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?ev._fromErrorAndOperation(n,s,t,r):s})}async function g8(n,t,e=!1){const r=await Lp(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return eu._forOperation(n,"link",r)}async function y8(n,t,e=!1){const{auth:r}=n;if(Vr(r.app))return Promise.reject(zo(r));const i="reauthenticate";try{const s=await Lp(n,nV(r,i,t,n),e);Lt(s.idToken,r,"internal-error");const o=v1(s.idToken);Lt(o,r,"internal-error");const{sub:l}=o;return Lt(n.uid===l,r,"user-mismatch"),eu._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Ri(r,"user-mismatch"),s}}async function rV(n,t,e=!1){if(Vr(n.app))return Promise.reject(zo(n));const r="signIn",i=await nV(n,r,t),s=await eu._fromIdTokenResponse(n,r,i);return e||await n._updateCurrentUser(s.user),s}async function v8(n,t){return rV(Nl(n),t)}async function iV(n){const t=Nl(n);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function b8(n,t,e){if(Vr(n.app))return Promise.reject(zo(n));const r=Nl(n),o=await vx(r,{returnSecureToken:!0,email:t,password:e,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",m8).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&iV(n),u}),l=await eu._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function _8(n,t,e){return Vr(n.app)?Promise.reject(zo(n)):v8(je(n),uf.credential(t,e)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&iV(n),r})}function T8(n,t,e,r){return je(n).onIdTokenChanged(t,e,r)}function S8(n,t,e){return je(n).beforeAuthStateChanged(t,e)}function w8(n,t,e,r){return je(n).onAuthStateChanged(t,e,r)}function x8(n){return je(n).signOut()}const nv="__sak";class sV{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(nv,"1"),this.storage.removeItem(nv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const E8=1e3,C8=10;class oV extends sV{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=QL(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const r=this.storage.getItem(e),i=this.localCache[e];r!==i&&t(e,i,r)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=t.key;e?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!e&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);Hq()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(i,C8):i()}notifyListeners(t,e){this.localCache[t]=e;const r=this.listeners[t];if(r)for(const i of Array.from(r))i(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:r}),!0)})},E8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}oV.type="LOCAL";const A8=oV;class aV extends sV{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}aV.type="SESSION";const lV=aV;function k8(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}class Nb{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(i=>i.isListeningto(t));if(e)return e;const r=new Nb(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:r,eventType:i,data:s}=e.data,o=this.handlersMap[i];if(!o?.size)return;e.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async h=>h(e.origin,s)),u=await k8(l);e.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Nb.receivers=[];function w1(n="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(Math.random()*10);return n+e}class M8{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const h=w1("",20);i.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(d),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:h,data:e},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Gs(){return window}function D8(n){Gs().location.href=n}function cV(){return typeof Gs().WorkerGlobalScope<"u"&&typeof Gs().importScripts=="function"}async function O8(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function R8(){return navigator?.serviceWorker?.controller||null}function I8(){return cV()?self:null}const uV="firebaseLocalStorageDb",P8=1,rv="firebaseLocalStorage",hV="fbase_key";class xm{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function Lb(n,t){return n.transaction([rv],t?"readwrite":"readonly").objectStore(rv)}function N8(){const n=indexedDB.deleteDatabase(uV);return new xm(n).toPromise()}function bx(){const n=indexedDB.open(uV,P8);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(rv,{keyPath:hV})}catch(i){e(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(rv)?t(r):(r.close(),await N8(),t(await bx()))})})}async function nR(n,t,e){const r=Lb(n,!0).put({[hV]:t,value:e});return new xm(r).toPromise()}async function L8(n,t){const e=Lb(n,!1).get(t),r=await new xm(e).toPromise();return r===void 0?null:r.value}function rR(n,t){const e=Lb(n,!0).delete(t);return new xm(e).toPromise()}const V8=800,j8=3;class fV{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await bx(),this.db)}async _withRetries(t){let e=0;for(;;)try{const r=await this._openDb();return await t(r)}catch(r){if(e++>j8)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return cV()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nb._getInstance(I8()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await O8(),!this.activeServiceWorker)return;this.sender=new M8(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||R8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await bx();return await nR(t,nv,"1"),await rR(t,nv),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(r=>nR(r,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(r=>L8(r,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>rR(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(i=>{const s=Lb(i,!1).getAll();return new xm(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],r=new Set;if(t.length!==0)for(const{fbase_key:i,value:s}of t)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),e.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),e.push(i));return e}notifyListeners(t,e){this.localCache[t]=e;const r=this.listeners[t];if(r)for(const i of Array.from(r))i(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),V8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}fV.type="LOCAL";const F8=fV;new Tm(3e4,6e4);function dV(n,t){return t?Vo(t):(Lt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class x1 extends _1{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Ih(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Ih(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Ih(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function B8(n){return rV(n.auth,new x1(n),n.bypassAuthState)}function U8(n){const{auth:t,user:e}=n;return Lt(e,t,"internal-error"),y8(e,new x1(n),n.bypassAuthState)}async function z8(n){const{auth:t,user:e}=n;return Lt(e,t,"internal-error"),g8(e,new x1(n),n.bypassAuthState)}class pV{constructor(t,e,r,i,s=!1){this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=t;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:e,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(h){this.reject(h)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return B8;case"linkViaPopup":case"linkViaRedirect":return z8;case"reauthViaPopup":case"reauthViaRedirect":return U8;default:Ri(this.auth,"internal-error")}}resolve(t){Ko(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Ko(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const H8=new Tm(2e3,1e4);async function $8(n,t,e){if(Vr(n.app))return Promise.reject(is(n,"operation-not-supported-in-this-environment"));const r=Nl(n);wq(n,t,S1);const i=dV(r,e);return new Ic(r,"signInViaPopup",t,i).executeNotNull()}class Ic extends pV{constructor(t,e,r,i,s){super(t,e,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Ic.currentPopupAction&&Ic.currentPopupAction.cancel(),Ic.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Lt(t,this.auth,"internal-error"),t}async onExecution(){Ko(this.filter.length===1,"Popup operations only handle one event");const t=w1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(is(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(is(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ic.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(is(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,H8.get())};t()}}Ic.currentPopupAction=null;const q8="pendingRedirect",S0=new Map;class W8 extends pV{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}async execute(){let t=S0.get(this.auth._key());if(!t){try{const r=await G8(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(r)}catch(e){t=()=>Promise.reject(e)}S0.set(this.auth._key(),t)}return this.bypassAuthState||S0.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function G8(n,t){const e=X8(t),r=K8(n);if(!await r._isAvailable())return!1;const i=await r._get(e)==="true";return await r._remove(e),i}function Y8(n,t){S0.set(n._key(),t)}function K8(n){return Vo(n._redirectPersistence)}function X8(n){return T0(q8,n.config.apiKey,n.name)}async function Q8(n,t,e=!1){if(Vr(n.app))return Promise.reject(zo(n));const r=Nl(n),i=dV(r,t),o=await new W8(r,i,e).execute();return o&&!e&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}const J8=600*1e3;class Z8{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!tW(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!mV(t)){const r=t.error.code?.split("auth/")[1]||"internal-error";e.onError(is(this.auth,r))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=J8&&this.cachedEventUids.clear(),this.cachedEventUids.has(iR(t))}saveEventToCache(t){this.cachedEventUids.add(iR(t)),this.lastProcessedEventTime=Date.now()}}function iR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function mV({type:n,error:t}){return n==="unknown"&&t?.code==="auth/no-auth-event"}function tW(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return mV(n);default:return!1}}async function eW(n,t={}){return Pl(n,"GET","/v1/projects",t)}const nW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rW=/^https?/;async function iW(n){if(n.config.emulator)return;const{authorizedDomains:t}=await eW(n);for(const e of t)try{if(sW(e))return}catch{}Ri(n,"unauthorized-domain")}function sW(n){const t=gx(),{protocol:e,hostname:r}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&o.hostname===r}if(!rW.test(e))return!1;if(nW.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const oW=new Tm(3e4,6e4);function sR(){const n=Gs().___jsl;if(n?.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function aW(n){return new Promise((t,e)=>{function r(){sR(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{sR(),e(is(n,"network-request-failed"))},timeout:oW.get()})}if(Gs().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(Gs().gapi?.load)r();else{const i=Jq("iframefcb");return Gs()[i]=()=>{gapi.load?r():e(is(n,"network-request-failed"))},ZL(`${Qq()}?onload=${i}`).catch(s=>e(s))}}).catch(t=>{throw w0=null,t})}let w0=null;function lW(n){return w0=w0||aW(n),w0}const cW=new Tm(5e3,15e3),uW="__/auth/iframe",hW="emulator/auth/iframe",fW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pW(n){const t=n.config;Lt(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?y1(t,hW):`https://${n.config.authDomain}/${uW}`,r={apiKey:t.apiKey,appName:n.name,v:pu},i=dW.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${e}?${_m(r).slice(1)}`}async function mW(n){const t=await lW(n),e=Gs().gapi;return Lt(e,n,"internal-error"),t.open({where:document.body,url:pW(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fW,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=is(n,"network-request-failed"),l=Gs().setTimeout(()=>{s(o)},cW.get());function u(){Gs().clearTimeout(l),i(r)}r.ping(u).then(u,()=>{s(o)})}))}const gW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yW=500,vW=600,bW="_blank",_W="http://localhost";class oR{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function TW(n,t,e,r=yW,i=vW){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u={...gW,width:r.toString(),height:i.toString(),top:s,left:o},h=ar().toLowerCase();e&&(l=WL(h)?bW:e),$L(h)&&(t=t||_W,u.scrollbars="yes");const d=Object.entries(u).reduce((g,[v,T])=>`${g}${v}=${T},`,"");if(zq(h)&&l!=="_self")return SW(t||"",l),new oR(null);const p=window.open(t||"",l,d);Lt(p,n,"popup-blocked");try{p.focus()}catch{}return new oR(p)}function SW(n,t){const e=document.createElement("a");e.href=n,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}const wW="__/auth/handler",xW="emulator/auth/handler",EW=encodeURIComponent("fac");async function aR(n,t,e,r,i,s){Lt(n.config.authDomain,n,"auth-domain-config-required"),Lt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:r,v:pu,eventId:i};if(t instanceof S1){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",c$(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[d,p]of Object.entries({}))o[d]=p}if(t instanceof wm){const d=t.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const u=await n._getAppCheckToken(),h=u?`#${EW}=${encodeURIComponent(u)}`:"";return`${CW(n)}?${_m(l).slice(1)}${h}`}function CW({config:n}){return n.emulator?y1(n,xW):`https://${n.authDomain}/${wW}`}const WS="webStorageSupport";class AW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=lV,this._completeRedirectFn=Q8,this._overrideRedirectResult=Y8}async _openPopup(t,e,r,i){Ko(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const s=await aR(t,e,r,gx(),i);return TW(t,s,w1())}async _openRedirect(t,e,r,i){await this._originValidation(t);const s=await aR(t,e,r,gx(),i);return D8(s),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:i,promise:s}=this.eventManagers[e];return i?Promise.resolve(i):(Ko(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}async initAndGetManager(t){const e=await mW(t),r=new Z8(t);return e.register("authEvent",i=>(Lt(i?.authEvent,t,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=e,r}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(WS,{type:WS},i=>{const s=i?.[0]?.[WS];s!==void 0&&e(!!s),Ri(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=iW(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return QL()||qL()||b1()}}const kW=AW;var lR="@firebase/auth",cR="1.12.0";class MW{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{t(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function DW(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function OW(n){Zc(new yl("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Lt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:JL(n)},h=new Yq(r,i,s,u);return i8(h,e),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),Zc(new yl("auth-internal",t=>{const e=Nl(t.getProvider("auth").getImmediate());return(r=>new MW(r))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ws(lR,cR,DW(n)),Ws(lR,cR,"esm2020")}const RW=300,IW=DL("authIdTokenMaxAge")||RW;let uR=null;const PW=n=>async t=>{const e=t&&await t.getIdTokenResult(),r=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(r&&r>IW)return;const i=e?.token;uR!==i&&(uR=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function NW(n=p1()){const t=Ib(n,"auth");if(t.isInitialized())return t.getImmediate();const e=r8(n,{popupRedirectResolver:kW,persistence:[F8,A8,lV]}),r=DL("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=PW(s.toString());S8(e,o,()=>o(e.currentUser)),T8(e,l=>o(l))}}const i=AL("auth");return i&&s8(e,`http://${i}`),e}function LW(){return document.getElementsByTagName("head")?.[0]??document}Kq({loadJS(n){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=t,r.onerror=i=>{const s=is("internal-error");s.customData=i,e(s)},r.type="text/javascript",r.charset="UTF-8",LW().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});OW("Browser");var hR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ul,gV;(function(){var n;function t(M,k){function R(){}R.prototype=k.prototype,M.F=k.prototype,M.prototype=new R,M.prototype.constructor=M,M.D=function(F,U,H){for(var j=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)j[yt-2]=arguments[yt];return k.prototype[U].apply(F,j)}}function e(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(r,e),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(M,k,R){R||(R=0);const F=Array(16);if(typeof k=="string")for(var U=0;U<16;++U)F[U]=k.charCodeAt(R++)|k.charCodeAt(R++)<<8|k.charCodeAt(R++)<<16|k.charCodeAt(R++)<<24;else for(U=0;U<16;++U)F[U]=k[R++]|k[R++]<<8|k[R++]<<16|k[R++]<<24;k=M.g[0],R=M.g[1],U=M.g[2];let H=M.g[3],j;j=k+(H^R&(U^H))+F[0]+3614090360&4294967295,k=R+(j<<7&4294967295|j>>>25),j=H+(U^k&(R^U))+F[1]+3905402710&4294967295,H=k+(j<<12&4294967295|j>>>20),j=U+(R^H&(k^R))+F[2]+606105819&4294967295,U=H+(j<<17&4294967295|j>>>15),j=R+(k^U&(H^k))+F[3]+3250441966&4294967295,R=U+(j<<22&4294967295|j>>>10),j=k+(H^R&(U^H))+F[4]+4118548399&4294967295,k=R+(j<<7&4294967295|j>>>25),j=H+(U^k&(R^U))+F[5]+1200080426&4294967295,H=k+(j<<12&4294967295|j>>>20),j=U+(R^H&(k^R))+F[6]+2821735955&4294967295,U=H+(j<<17&4294967295|j>>>15),j=R+(k^U&(H^k))+F[7]+4249261313&4294967295,R=U+(j<<22&4294967295|j>>>10),j=k+(H^R&(U^H))+F[8]+1770035416&4294967295,k=R+(j<<7&4294967295|j>>>25),j=H+(U^k&(R^U))+F[9]+2336552879&4294967295,H=k+(j<<12&4294967295|j>>>20),j=U+(R^H&(k^R))+F[10]+4294925233&4294967295,U=H+(j<<17&4294967295|j>>>15),j=R+(k^U&(H^k))+F[11]+2304563134&4294967295,R=U+(j<<22&4294967295|j>>>10),j=k+(H^R&(U^H))+F[12]+1804603682&4294967295,k=R+(j<<7&4294967295|j>>>25),j=H+(U^k&(R^U))+F[13]+4254626195&4294967295,H=k+(j<<12&4294967295|j>>>20),j=U+(R^H&(k^R))+F[14]+2792965006&4294967295,U=H+(j<<17&4294967295|j>>>15),j=R+(k^U&(H^k))+F[15]+1236535329&4294967295,R=U+(j<<22&4294967295|j>>>10),j=k+(U^H&(R^U))+F[1]+4129170786&4294967295,k=R+(j<<5&4294967295|j>>>27),j=H+(R^U&(k^R))+F[6]+3225465664&4294967295,H=k+(j<<9&4294967295|j>>>23),j=U+(k^R&(H^k))+F[11]+643717713&4294967295,U=H+(j<<14&4294967295|j>>>18),j=R+(H^k&(U^H))+F[0]+3921069994&4294967295,R=U+(j<<20&4294967295|j>>>12),j=k+(U^H&(R^U))+F[5]+3593408605&4294967295,k=R+(j<<5&4294967295|j>>>27),j=H+(R^U&(k^R))+F[10]+38016083&4294967295,H=k+(j<<9&4294967295|j>>>23),j=U+(k^R&(H^k))+F[15]+3634488961&4294967295,U=H+(j<<14&4294967295|j>>>18),j=R+(H^k&(U^H))+F[4]+3889429448&4294967295,R=U+(j<<20&4294967295|j>>>12),j=k+(U^H&(R^U))+F[9]+568446438&4294967295,k=R+(j<<5&4294967295|j>>>27),j=H+(R^U&(k^R))+F[14]+3275163606&4294967295,H=k+(j<<9&4294967295|j>>>23),j=U+(k^R&(H^k))+F[3]+4107603335&4294967295,U=H+(j<<14&4294967295|j>>>18),j=R+(H^k&(U^H))+F[8]+1163531501&4294967295,R=U+(j<<20&4294967295|j>>>12),j=k+(U^H&(R^U))+F[13]+2850285829&4294967295,k=R+(j<<5&4294967295|j>>>27),j=H+(R^U&(k^R))+F[2]+4243563512&4294967295,H=k+(j<<9&4294967295|j>>>23),j=U+(k^R&(H^k))+F[7]+1735328473&4294967295,U=H+(j<<14&4294967295|j>>>18),j=R+(H^k&(U^H))+F[12]+2368359562&4294967295,R=U+(j<<20&4294967295|j>>>12),j=k+(R^U^H)+F[5]+4294588738&4294967295,k=R+(j<<4&4294967295|j>>>28),j=H+(k^R^U)+F[8]+2272392833&4294967295,H=k+(j<<11&4294967295|j>>>21),j=U+(H^k^R)+F[11]+1839030562&4294967295,U=H+(j<<16&4294967295|j>>>16),j=R+(U^H^k)+F[14]+4259657740&4294967295,R=U+(j<<23&4294967295|j>>>9),j=k+(R^U^H)+F[1]+2763975236&4294967295,k=R+(j<<4&4294967295|j>>>28),j=H+(k^R^U)+F[4]+1272893353&4294967295,H=k+(j<<11&4294967295|j>>>21),j=U+(H^k^R)+F[7]+4139469664&4294967295,U=H+(j<<16&4294967295|j>>>16),j=R+(U^H^k)+F[10]+3200236656&4294967295,R=U+(j<<23&4294967295|j>>>9),j=k+(R^U^H)+F[13]+681279174&4294967295,k=R+(j<<4&4294967295|j>>>28),j=H+(k^R^U)+F[0]+3936430074&4294967295,H=k+(j<<11&4294967295|j>>>21),j=U+(H^k^R)+F[3]+3572445317&4294967295,U=H+(j<<16&4294967295|j>>>16),j=R+(U^H^k)+F[6]+76029189&4294967295,R=U+(j<<23&4294967295|j>>>9),j=k+(R^U^H)+F[9]+3654602809&4294967295,k=R+(j<<4&4294967295|j>>>28),j=H+(k^R^U)+F[12]+3873151461&4294967295,H=k+(j<<11&4294967295|j>>>21),j=U+(H^k^R)+F[15]+530742520&4294967295,U=H+(j<<16&4294967295|j>>>16),j=R+(U^H^k)+F[2]+3299628645&4294967295,R=U+(j<<23&4294967295|j>>>9),j=k+(U^(R|~H))+F[0]+4096336452&4294967295,k=R+(j<<6&4294967295|j>>>26),j=H+(R^(k|~U))+F[7]+1126891415&4294967295,H=k+(j<<10&4294967295|j>>>22),j=U+(k^(H|~R))+F[14]+2878612391&4294967295,U=H+(j<<15&4294967295|j>>>17),j=R+(H^(U|~k))+F[5]+4237533241&4294967295,R=U+(j<<21&4294967295|j>>>11),j=k+(U^(R|~H))+F[12]+1700485571&4294967295,k=R+(j<<6&4294967295|j>>>26),j=H+(R^(k|~U))+F[3]+2399980690&4294967295,H=k+(j<<10&4294967295|j>>>22),j=U+(k^(H|~R))+F[10]+4293915773&4294967295,U=H+(j<<15&4294967295|j>>>17),j=R+(H^(U|~k))+F[1]+2240044497&4294967295,R=U+(j<<21&4294967295|j>>>11),j=k+(U^(R|~H))+F[8]+1873313359&4294967295,k=R+(j<<6&4294967295|j>>>26),j=H+(R^(k|~U))+F[15]+4264355552&4294967295,H=k+(j<<10&4294967295|j>>>22),j=U+(k^(H|~R))+F[6]+2734768916&4294967295,U=H+(j<<15&4294967295|j>>>17),j=R+(H^(U|~k))+F[13]+1309151649&4294967295,R=U+(j<<21&4294967295|j>>>11),j=k+(U^(R|~H))+F[4]+4149444226&4294967295,k=R+(j<<6&4294967295|j>>>26),j=H+(R^(k|~U))+F[11]+3174756917&4294967295,H=k+(j<<10&4294967295|j>>>22),j=U+(k^(H|~R))+F[2]+718787259&4294967295,U=H+(j<<15&4294967295|j>>>17),j=R+(H^(U|~k))+F[9]+3951481745&4294967295,M.g[0]=M.g[0]+k&4294967295,M.g[1]=M.g[1]+(U+(j<<21&4294967295|j>>>11))&4294967295,M.g[2]=M.g[2]+U&4294967295,M.g[3]=M.g[3]+H&4294967295}r.prototype.v=function(M,k){k===void 0&&(k=M.length);const R=k-this.blockSize,F=this.C;let U=this.h,H=0;for(;H<k;){if(U==0)for(;H<=R;)i(this,M,H),H+=this.blockSize;if(typeof M=="string"){for(;H<k;)if(F[U++]=M.charCodeAt(H++),U==this.blockSize){i(this,F),U=0;break}}else for(;H<k;)if(F[U++]=M[H++],U==this.blockSize){i(this,F),U=0;break}}this.h=U,this.o+=k},r.prototype.A=function(){var M=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);M[0]=128;for(var k=1;k<M.length-8;++k)M[k]=0;k=this.o*8;for(var R=M.length-8;R<M.length;++R)M[R]=k&255,k/=256;for(this.v(M),M=Array(16),k=0,R=0;R<4;++R)for(let F=0;F<32;F+=8)M[k++]=this.g[R]>>>F&255;return M};function s(M,k){var R=l;return Object.prototype.hasOwnProperty.call(R,M)?R[M]:R[M]=k(M)}function o(M,k){this.h=k;const R=[];let F=!0;for(let U=M.length-1;U>=0;U--){const H=M[U]|0;F&&H==k||(R[U]=H,F=!1)}this.g=R}var l={};function u(M){return-128<=M&&M<128?s(M,function(k){return new o([k|0],k<0?-1:0)}):new o([M|0],M<0?-1:0)}function h(M){if(isNaN(M)||!isFinite(M))return p;if(M<0)return w(h(-M));const k=[];let R=1;for(let F=0;M>=R;F++)k[F]=M/R|0,R*=4294967296;return new o(k,0)}function d(M,k){if(M.length==0)throw Error("number format error: empty string");if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(M.charAt(0)=="-")return w(d(M.substring(1),k));if(M.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=h(Math.pow(k,8));let F=p;for(let H=0;H<M.length;H+=8){var U=Math.min(8,M.length-H);const j=parseInt(M.substring(H,H+U),k);U<8?(U=h(Math.pow(k,U)),F=F.j(U).add(h(j))):(F=F.j(R),F=F.add(h(j)))}return F}var p=u(0),g=u(1),v=u(16777216);n=o.prototype,n.m=function(){if(S(this))return-w(this).m();let M=0,k=1;for(let R=0;R<this.g.length;R++){const F=this.i(R);M+=(F>=0?F:4294967296+F)*k,k*=4294967296}return M},n.toString=function(M){if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(T(this))return"0";if(S(this))return"-"+w(this).toString(M);const k=h(Math.pow(M,6));var R=this;let F="";for(;;){const U=V(R,k).g;R=E(R,U.j(k));let H=((R.g.length>0?R.g[0]:R.h)>>>0).toString(M);if(R=U,T(R))return H+F;for(;H.length<6;)H="0"+H;F=H+F}},n.i=function(M){return M<0?0:M<this.g.length?this.g[M]:this.h};function T(M){if(M.h!=0)return!1;for(let k=0;k<M.g.length;k++)if(M.g[k]!=0)return!1;return!0}function S(M){return M.h==-1}n.l=function(M){return M=E(this,M),S(M)?-1:T(M)?0:1};function w(M){const k=M.g.length,R=[];for(let F=0;F<k;F++)R[F]=~M.g[F];return new o(R,~M.h).add(g)}n.abs=function(){return S(this)?w(this):this},n.add=function(M){const k=Math.max(this.g.length,M.g.length),R=[];let F=0;for(let U=0;U<=k;U++){let H=F+(this.i(U)&65535)+(M.i(U)&65535),j=(H>>>16)+(this.i(U)>>>16)+(M.i(U)>>>16);F=j>>>16,H&=65535,j&=65535,R[U]=j<<16|H}return new o(R,R[R.length-1]&-2147483648?-1:0)};function E(M,k){return M.add(w(k))}n.j=function(M){if(T(this)||T(M))return p;if(S(this))return S(M)?w(this).j(w(M)):w(w(this).j(M));if(S(M))return w(this.j(w(M)));if(this.l(v)<0&&M.l(v)<0)return h(this.m()*M.m());const k=this.g.length+M.g.length,R=[];for(var F=0;F<2*k;F++)R[F]=0;for(F=0;F<this.g.length;F++)for(let U=0;U<M.g.length;U++){const H=this.i(F)>>>16,j=this.i(F)&65535,yt=M.i(U)>>>16,xt=M.i(U)&65535;R[2*F+2*U]+=j*xt,D(R,2*F+2*U),R[2*F+2*U+1]+=H*xt,D(R,2*F+2*U+1),R[2*F+2*U+1]+=j*yt,D(R,2*F+2*U+1),R[2*F+2*U+2]+=H*yt,D(R,2*F+2*U+2)}for(M=0;M<k;M++)R[M]=R[2*M+1]<<16|R[2*M];for(M=k;M<2*k;M++)R[M]=0;return new o(R,0)};function D(M,k){for(;(M[k]&65535)!=M[k];)M[k+1]+=M[k]>>>16,M[k]&=65535,k++}function P(M,k){this.g=M,this.h=k}function V(M,k){if(T(k))throw Error("division by zero");if(T(M))return new P(p,p);if(S(M))return k=V(w(M),k),new P(w(k.g),w(k.h));if(S(k))return k=V(M,w(k)),new P(w(k.g),k.h);if(M.g.length>30){if(S(M)||S(k))throw Error("slowDivide_ only works with positive integers.");for(var R=g,F=k;F.l(M)<=0;)R=N(R),F=N(F);var U=q(R,1),H=q(F,1);for(F=q(F,2),R=q(R,2);!T(F);){var j=H.add(F);j.l(M)<=0&&(U=U.add(R),H=j),F=q(F,1),R=q(R,1)}return k=E(M,U.j(k)),new P(U,k)}for(U=p;M.l(k)>=0;){for(R=Math.max(1,Math.floor(M.m()/k.m())),F=Math.ceil(Math.log(R)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),H=h(R),j=H.j(k);S(j)||j.l(M)>0;)R-=F,H=h(R),j=H.j(k);T(H)&&(H=g),U=U.add(H),M=E(M,j)}return new P(U,M)}n.B=function(M){return V(this,M).h},n.and=function(M){const k=Math.max(this.g.length,M.g.length),R=[];for(let F=0;F<k;F++)R[F]=this.i(F)&M.i(F);return new o(R,this.h&M.h)},n.or=function(M){const k=Math.max(this.g.length,M.g.length),R=[];for(let F=0;F<k;F++)R[F]=this.i(F)|M.i(F);return new o(R,this.h|M.h)},n.xor=function(M){const k=Math.max(this.g.length,M.g.length),R=[];for(let F=0;F<k;F++)R[F]=this.i(F)^M.i(F);return new o(R,this.h^M.h)};function N(M){const k=M.g.length+1,R=[];for(let F=0;F<k;F++)R[F]=M.i(F)<<1|M.i(F-1)>>>31;return new o(R,M.h)}function q(M,k){const R=k>>5;k%=32;const F=M.g.length-R,U=[];for(let H=0;H<F;H++)U[H]=k>0?M.i(H+R)>>>k|M.i(H+R+1)<<32-k:M.i(H+R);return new o(U,M.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,gV=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,ul=o}).apply(typeof hR<"u"?hR:typeof self<"u"?self:typeof window<"u"?window:{});var Sy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var yV,Xd,vV,x0,_x,bV,_V,TV;(function(){var n,t=Object.defineProperty;function e(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sy=="object"&&Sy];for(var x=0;x<y.length;++x){var A=y[x];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var r=e(this);function i(y,x){if(x)t:{var A=r;y=y.split(".");for(var I=0;I<y.length-1;I++){var K=y[I];if(!(K in A))break t;A=A[K]}y=y[y.length-1],I=A[y],x=x(I),x!=I&&x!=null&&t(A,y,{configurable:!0,writable:!0,value:x})}}i("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(y){return y||function(x){var A=[],I;for(I in x)Object.prototype.hasOwnProperty.call(x,I)&&A.push([I,x[I]]);return A}});var s=s||{},o=this||self;function l(y){var x=typeof y;return x=="object"&&y!=null||x=="function"}function u(y,x,A){return y.call.apply(y.bind,arguments)}function h(y,x,A){return h=u,h.apply(null,arguments)}function d(y,x){var A=Array.prototype.slice.call(arguments,1);return function(){var I=A.slice();return I.push.apply(I,arguments),y.apply(this,I)}}function p(y,x){function A(){}A.prototype=x.prototype,y.Z=x.prototype,y.prototype=new A,y.prototype.constructor=y,y.Ob=function(I,K,et){for(var pt=Array(arguments.length-2),zt=2;zt<arguments.length;zt++)pt[zt-2]=arguments[zt];return x.prototype[K].apply(I,pt)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function v(y){const x=y.length;if(x>0){const A=Array(x);for(let I=0;I<x;I++)A[I]=y[I];return A}return[]}function T(y,x){for(let I=1;I<arguments.length;I++){const K=arguments[I];var A=typeof K;if(A=A!="object"?A:K?Array.isArray(K)?"array":A:"null",A=="array"||A=="object"&&typeof K.length=="number"){A=y.length||0;const et=K.length||0;y.length=A+et;for(let pt=0;pt<et;pt++)y[A+pt]=K[pt]}else y.push(K)}}class S{constructor(x,A){this.i=x,this.j=A,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function w(y){o.setTimeout(()=>{throw y},0)}function E(){var y=M;let x=null;return y.g&&(x=y.g,y.g=y.g.next,y.g||(y.h=null),x.next=null),x}class D{constructor(){this.h=this.g=null}add(x,A){const I=P.get();I.set(x,A),this.h?this.h.next=I:this.g=I,this.h=I}}var P=new S(()=>new V,y=>y.reset());class V{constructor(){this.next=this.g=this.h=null}set(x,A){this.h=x,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let N,q=!1,M=new D,k=()=>{const y=Promise.resolve(void 0);N=()=>{y.then(R)}};function R(){for(var y;y=E();){try{y.h.call(y.g)}catch(A){w(A)}var x=P;x.j(y),x.h<100&&(x.h++,y.next=x.g,x.g=y)}q=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function U(y,x){this.type=y,this.g=this.target=x,this.defaultPrevented=!1}U.prototype.h=function(){this.defaultPrevented=!0};var H=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var y=!1,x=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const A=()=>{};o.addEventListener("test",A,x),o.removeEventListener("test",A,x)}catch{}return y})();function j(y){return/^[\s\xa0]*$/.test(y)}function yt(y,x){U.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,x)}p(yt,U),yt.prototype.init=function(y,x){const A=this.type=y.type,I=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=x,x=y.relatedTarget,x||(A=="mouseover"?x=y.fromElement:A=="mouseout"&&(x=y.toElement)),this.relatedTarget=x,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&yt.Z.h.call(this)},yt.prototype.h=function(){yt.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var xt="closure_listenable_"+(Math.random()*1e6|0),J=0;function st(y,x,A,I,K){this.listener=y,this.proxy=null,this.src=x,this.type=A,this.capture=!!I,this.ha=K,this.key=++J,this.da=this.fa=!1}function ht(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function Ct(y,x,A){for(const I in y)x.call(A,y[I],I,y)}function Vt(y,x){for(const A in y)x.call(void 0,y[A],A,y)}function $(y){const x={};for(const A in y)x[A]=y[A];return x}const ot="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function dt(y,x){let A,I;for(let K=1;K<arguments.length;K++){I=arguments[K];for(A in I)y[A]=I[A];for(let et=0;et<ot.length;et++)A=ot[et],Object.prototype.hasOwnProperty.call(I,A)&&(y[A]=I[A])}}function mt(y){this.src=y,this.g={},this.h=0}mt.prototype.add=function(y,x,A,I,K){const et=y.toString();y=this.g[et],y||(y=this.g[et]=[],this.h++);const pt=It(y,x,I,K);return pt>-1?(x=y[pt],A||(x.fa=!1)):(x=new st(x,this.src,et,!!I,K),x.fa=A,y.push(x)),x};function Ot(y,x){const A=x.type;if(A in y.g){var I=y.g[A],K=Array.prototype.indexOf.call(I,x,void 0),et;(et=K>=0)&&Array.prototype.splice.call(I,K,1),et&&(ht(x),y.g[A].length==0&&(delete y.g[A],y.h--))}}function It(y,x,A,I){for(let K=0;K<y.length;++K){const et=y[K];if(!et.da&&et.listener==x&&et.capture==!!A&&et.ha==I)return K}return-1}var Ut="closure_lm_"+(Math.random()*1e6|0),Fe={};function he(y,x,A,I,K){if(Array.isArray(x)){for(let et=0;et<x.length;et++)he(y,x[et],A,I,K);return null}return A=Df(A),y&&y[xt]?y.J(x,A,l(I)?!!I.capture:!1,K):Mt(y,x,A,!1,I,K)}function Mt(y,x,A,I,K,et){if(!x)throw Error("Invalid event type");const pt=l(K)?!!K.capture:!!K;let zt=$l(y);if(zt||(y[Ut]=zt=new mt(y)),A=zt.add(x,A,I,pt,et),A.proxy)return A;if(I=be(),A.proxy=I,I.src=y,I.listener=A,y.addEventListener)H||(K=pt),K===void 0&&(K=!1),y.addEventListener(x.toString(),I,K);else if(y.attachEvent)y.attachEvent(li(x.toString()),I);else if(y.addListener&&y.removeListener)y.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return A}function be(){function y(A){return x.call(y.src,y.listener,A)}const x=kf;return y}function Oe(y,x,A,I,K){if(Array.isArray(x))for(var et=0;et<x.length;et++)Oe(y,x[et],A,I,K);else I=l(I)?!!I.capture:!!I,A=Df(A),y&&y[xt]?(y=y.i,et=String(x).toString(),et in y.g&&(x=y.g[et],A=It(x,A,I,K),A>-1&&(ht(x[A]),Array.prototype.splice.call(x,A,1),x.length==0&&(delete y.g[et],y.h--)))):y&&(y=$l(y))&&(x=y.g[x.toString()],y=-1,x&&(y=It(x,A,I,K)),(A=y>-1?x[y]:null)&&Cr(A))}function Cr(y){if(typeof y!="number"&&y&&!y.da){var x=y.src;if(x&&x[xt])Ot(x.i,y);else{var A=y.type,I=y.proxy;x.removeEventListener?x.removeEventListener(A,I,y.capture):x.detachEvent?x.detachEvent(li(A),I):x.addListener&&x.removeListener&&x.removeListener(I),(A=$l(x))?(Ot(A,y),A.h==0&&(A.src=null,x[Ut]=null)):ht(y)}}}function li(y){return y in Fe?Fe[y]:Fe[y]="on"+y}function kf(y,x){if(y.da)y=!0;else{x=new yt(x,this);const A=y.listener,I=y.ha||y.src;y.fa&&Cr(y),y=A.call(I,x)}return y}function $l(y){return y=y[Ut],y instanceof mt?y:null}var Mf="__closure_events_fn_"+(Math.random()*1e9>>>0);function Df(y){return typeof y=="function"?y:(y[Mf]||(y[Mf]=function(x){return y.handleEvent(x)}),y[Mf])}function ln(){F.call(this),this.i=new mt(this),this.M=this,this.G=null}p(ln,F),ln.prototype[xt]=!0,ln.prototype.removeEventListener=function(y,x,A,I){Oe(this,y,x,A,I)};function wn(y,x){var A,I=y.G;if(I)for(A=[];I;I=I.G)A.push(I);if(y=y.M,I=x.type||x,typeof x=="string")x=new U(x,y);else if(x instanceof U)x.target=x.target||y;else{var K=x;x=new U(I,y),dt(x,K)}K=!0;let et,pt;if(A)for(pt=A.length-1;pt>=0;pt--)et=x.g=A[pt],K=oa(et,I,!0,x)&&K;if(et=x.g=y,K=oa(et,I,!0,x)&&K,K=oa(et,I,!1,x)&&K,A)for(pt=0;pt<A.length;pt++)et=x.g=A[pt],K=oa(et,I,!1,x)&&K}ln.prototype.N=function(){if(ln.Z.N.call(this),this.i){var y=this.i;for(const x in y.g){const A=y.g[x];for(let I=0;I<A.length;I++)ht(A[I]);delete y.g[x],y.h--}}this.G=null},ln.prototype.J=function(y,x,A,I){return this.i.add(String(y),x,!1,A,I)},ln.prototype.K=function(y,x,A,I){return this.i.add(String(y),x,!0,A,I)};function oa(y,x,A,I){if(x=y.i.g[String(x)],!x)return!0;x=x.concat();let K=!0;for(let et=0;et<x.length;++et){const pt=x[et];if(pt&&!pt.da&&pt.capture==A){const zt=pt.listener,en=pt.ha||pt.src;pt.fa&&Ot(y.i,pt),K=zt.call(en,I)!==!1&&K}}return K&&!I.defaultPrevented}function I_(y,x){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=h(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:o.setTimeout(y,x||0)}function qm(y){y.g=I_(()=>{y.g=null,y.i&&(y.i=!1,qm(y))},y.l);const x=y.h;y.h=null,y.m.apply(null,x)}class ur extends F{constructor(x,A){super(),this.m=x,this.l=A,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:qm(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ql(y){F.call(this),this.h=y,this.g={}}p(ql,F);var Of=[];function Rf(y){Ct(y.g,function(x,A){this.g.hasOwnProperty(A)&&Cr(x)},y),y.g={}}ql.prototype.N=function(){ql.Z.N.call(this),Rf(this)},ql.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var aa=o.JSON.stringify,P_=o.JSON.parse,Wm=class{stringify(y){return o.JSON.stringify(y,void 0)}parse(y){return o.JSON.parse(y,void 0)}};function Gm(){}function Ym(){}var Li={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Bn(){U.call(this,"d")}p(Bn,U);function ci(){U.call(this,"c")}p(ci,U);var tn={},Km=null;function _u(){return Km=Km||new ln}tn.Ia="serverreachability";function Xm(y){U.call(this,tn.Ia,y)}p(Xm,U);function ps(y){const x=_u();wn(x,new Xm(x))}tn.STAT_EVENT="statevent";function Wl(y,x){U.call(this,tn.STAT_EVENT,y),this.stat=x}p(Wl,U);function cn(y){const x=_u();wn(x,new Wl(x,y))}tn.Ja="timingevent";function ms(y,x){U.call(this,tn.Ja,y),this.size=x}p(ms,U);function gs(y,x){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){y()},x)}function Vi(){this.g=!0}Vi.prototype.ua=function(){this.g=!1};function N_(y,x,A,I,K,et){y.info(function(){if(y.g)if(et){var pt="",zt=et.split("&");for(let le=0;le<zt.length;le++){var en=zt[le].split("=");if(en.length>1){const Ne=en[0];en=en[1];const di=Ne.split("_");pt=di.length>=2&&di[1]=="type"?pt+(Ne+"="+en+"&"):pt+(Ne+"=redacted&")}}}else pt=null;else pt=et;return"XMLHTTP REQ ("+I+") [attempt "+K+"]: "+x+`
`+A+`
`+pt})}function Qm(y,x,A,I,K,et,pt){y.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+K+"]: "+x+`
`+A+`
`+et+" "+pt})}function ys(y,x,A,I){y.info(function(){return"XMLHTTP TEXT ("+x+"): "+L_(y,A)+(I?" "+I:"")})}function Gl(y,x){y.info(function(){return"TIMEOUT: "+x})}Vi.prototype.info=function(){};function L_(y,x){if(!y.g)return x;if(!x)return null;try{const et=JSON.parse(x);if(et){for(y=0;y<et.length;y++)if(Array.isArray(et[y])){var A=et[y];if(!(A.length<2)){var I=A[1];if(Array.isArray(I)&&!(I.length<1)){var K=I[0];if(K!="noop"&&K!="stop"&&K!="close")for(let pt=1;pt<I.length;pt++)I[pt]=""}}}}return aa(et)}catch{return x}}var Yl={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},If={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Pf;function Kl(){}p(Kl,Gm),Kl.prototype.g=function(){return new XMLHttpRequest},Pf=new Kl;function oo(y){return encodeURIComponent(String(y))}function Jm(y){var x=1;y=y.split(":");const A=[];for(;x>0&&y.length;)A.push(y.shift()),x--;return y.length&&A.push(y.join(":")),A}function ji(y,x,A,I){this.j=y,this.i=x,this.l=A,this.S=I||1,this.V=new ql(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Fi}function Fi(){this.i=null,this.g="",this.h=!1}var un={},Dn={};function vs(y,x,A){y.M=1,y.A=Xl(fn(x)),y.u=A,y.R=!0,Tu(y,null)}function Tu(y,x){y.F=Date.now(),bs(y),y.B=fn(y.A);var A=y.B,I=y.S;Array.isArray(I)||(I=[String(I)]),Eu(A.i,"t",I),y.C=0,A=y.j.L,y.h=new Fi,y.g=dg(y.j,A?x:null,!y.u),y.P>0&&(y.O=new ur(h(y.Y,y,y.g),y.P)),x=y.V,A=y.g,I=y.ba;var K="readystatechange";Array.isArray(K)||(K&&(Of[0]=K.toString()),K=Of);for(let et=0;et<K.length;et++){const pt=he(A,K[et],I||x.handleEvent,!1,x.h||x);if(!pt)break;x.g[pt.key]=pt}x=y.J?$(y.J):{},y.u?(y.v||(y.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,x)):(y.v="GET",y.g.ea(y.B,y.v,null,x)),ps(),N_(y.i,y.v,y.B,y.l,y.S,y.u)}ji.prototype.ba=function(y){y=y.target;const x=this.O;x&&zi(y)==3?x.j():this.Y(y)},ji.prototype.Y=function(y){try{if(y==this.g)t:{const zt=zi(this.g),en=this.g.ya(),le=this.g.ca();if(!(zt<3)&&(zt!=3||this.g&&(this.h.h||this.g.la()||Un(this.g)))){this.K||zt!=4||en==7||(en==8||le<=0?ps(3):ps(2)),_s(this);var x=this.g.ca();this.X=x;var A=V_(this);if(this.o=x==200,Qm(this.i,this.v,this.B,this.l,this.S,zt,x),this.o){if(this.U&&!this.L){e:{if(this.g){var I,K=this.g;if((I=K.g?K.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(I)){var et=I;break e}}et=null}if(y=et)ys(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ts(this,y);else{this.o=!1,this.m=3,cn(12),zr(this),ui(this);break t}}if(this.R){y=!0;let Ne;for(;!this.K&&this.C<A.length;)if(Ne=tg(this,A),Ne==Dn){zt==4&&(this.m=4,cn(14),y=!1),ys(this.i,this.l,null,"[Incomplete Response]");break}else if(Ne==un){this.m=4,cn(15),ys(this.i,this.l,A,"[Invalid Chunk]"),y=!1;break}else ys(this.i,this.l,Ne,null),Ts(this,Ne);if(Zm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),zt!=4||A.length!=0||this.h.h||(this.m=1,cn(16),y=!1),this.o=this.o&&y,!y)ys(this.i,this.l,A,"[Invalid Chunked Response]"),zr(this),ui(this);else if(A.length>0&&!this.W){this.W=!0;var pt=this.j;pt.g==this&&pt.aa&&!pt.P&&(pt.j.info("Great, no buffering proxy detected. Bytes received: "+A.length),Kf(pt),pt.P=!0,cn(11))}}else ys(this.i,this.l,A,null),Ts(this,A);zt==4&&zr(this),this.o&&!this.K&&(zt==4?cg(this.j,this):(this.o=!1,bs(this)))}else lo(this.g),x==400&&A.indexOf("Unknown SID")>0?(this.m=3,cn(12)):(this.m=0,cn(13)),zr(this),ui(this)}}}catch{}};function V_(y){if(!Zm(y))return y.g.la();const x=Un(y.g);if(x==="")return"";let A="";const I=x.length,K=zi(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return zr(y),ui(y),"";y.h.i=new o.TextDecoder}for(let et=0;et<I;et++)y.h.h=!0,A+=y.h.i.decode(x[et],{stream:!(K&&et==I-1)});return x.length=0,y.h.g+=A,y.C=0,y.h.g}function Zm(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function tg(y,x){var A=y.C,I=x.indexOf(`
`,A);return I==-1?Dn:(A=Number(x.substring(A,I)),isNaN(A)?un:(I+=1,I+A>x.length?Dn:(x=x.slice(I,I+A),y.C=I+A,x)))}ji.prototype.cancel=function(){this.K=!0,zr(this)};function bs(y){y.T=Date.now()+y.H,Su(y,y.H)}function Su(y,x){if(y.D!=null)throw Error("WatchDog timer not null");y.D=gs(h(y.aa,y),x)}function _s(y){y.D&&(o.clearTimeout(y.D),y.D=null)}ji.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(Gl(this.i,this.B),this.M!=2&&(ps(),cn(17)),zr(this),this.m=2,ui(this)):Su(this,this.T-y)};function ui(y){y.j.I==0||y.K||cg(y.j,y)}function zr(y){_s(y);var x=y.O;x&&typeof x.dispose=="function"&&x.dispose(),y.O=null,Rf(y.V),y.g&&(x=y.g,y.g=null,x.abort(),x.dispose())}function Ts(y,x){try{var A=y.j;if(A.I!=0&&(A.g==y||ws(A.h,y))){if(!y.L&&ws(A.h,y)&&A.I==3){try{var I=A.Ba.g.parse(x)}catch{I=null}if(Array.isArray(I)&&I.length==3){var K=I;if(K[0]==0){t:if(!A.v){if(A.g)if(A.g.F+3e3<y.F)Du(A),ma(A);else break t;rc(A),cn(18)}}else A.xa=K[1],0<A.xa-A.K&&K[2]<37500&&A.F&&A.A==0&&!A.C&&(A.C=gs(h(A.Va,A),6e3));Ss(A.h)<=1&&A.ta&&(A.ta=void 0)}else Ms(A,11)}else if((y.L||A.g==y)&&Du(A),!j(x))for(K=A.Ba.g.parse(x),x=0;x<K.length;x++){let le=K[x];const Ne=le[0];if(!(Ne<=A.K))if(A.K=Ne,le=le[1],A.I==2)if(le[0]=="c"){A.M=le[1],A.ba=le[2];const di=le[3];di!=null&&(A.ka=di,A.j.info("VER="+A.ka));const Ds=le[4];Ds!=null&&(A.za=Ds,A.j.info("SVER="+A.za));const Hi=le[5];Hi!=null&&typeof Hi=="number"&&Hi>0&&(I=1.5*Hi,A.O=I,A.j.info("backChannelRequestTimeoutMs_="+I)),I=A;const $i=y.g;if($i){const ic=$i.g?$i.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ic){var et=I.h;et.g||ic.indexOf("spdy")==-1&&ic.indexOf("quic")==-1&&ic.indexOf("h2")==-1||(et.j=et.l,et.g=new Set,et.h&&(Vf(et,et.h),et.h=null))}if(I.G){const Ou=$i.g?$i.g.getResponseHeader("X-HTTP-Session-Id"):null;Ou&&(I.wa=Ou,de(I.J,I.G,Ou))}}A.I=3,A.l&&A.l.ra(),A.aa&&(A.T=Date.now()-y.F,A.j.info("Handshake RTT: "+A.T+"ms")),I=A;var pt=y;if(I.na=fg(I,I.L?I.ba:null,I.W),pt.L){jf(I.h,pt);var zt=pt,en=I.O;en&&(zt.H=en),zt.D&&(_s(zt),bs(zt)),I.g=pt}else ag(I);A.i.length>0&&ks(A)}else le[0]!="stop"&&le[0]!="close"||Ms(A,7);else A.I==3&&(le[0]=="stop"||le[0]=="close"?le[0]=="stop"?Ms(A,7):Gf(A):le[0]!="noop"&&A.l&&A.l.qa(le),A.A=0)}}ps(4)}catch{}}var hn=class{constructor(y,x){this.g=y,this.map=x}};function Nf(y){this.l=y||10,o.PerformanceNavigationTiming?(y=o.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Lf(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Ss(y){return y.h?1:y.g?y.g.size:0}function ws(y,x){return y.h?y.h==x:y.g?y.g.has(x):!1}function Vf(y,x){y.g?y.g.add(x):y.h=x}function jf(y,x){y.h&&y.h==x?y.h=null:y.g&&y.g.has(x)&&y.g.delete(x)}Nf.prototype.cancel=function(){if(this.i=Ff(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Ff(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let x=y.i;for(const A of y.g.values())x=x.concat(A.G);return x}return v(y.i)}var eg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wu(y,x){if(y){y=y.split("&");for(let A=0;A<y.length;A++){const I=y[A].indexOf("=");let K,et=null;I>=0?(K=y[A].substring(0,I),et=y[A].substring(I+1)):K=y[A],x(K,et?decodeURIComponent(et.replace(/\+/g," ")):"")}}}function Hr(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;y instanceof Hr?(this.l=y.l,On(this,y.j),this.o=y.o,this.g=y.g,la(this,y.u),this.h=y.h,Bf(this,sg(y.i)),this.m=y.m):y&&(x=String(y).match(eg))?(this.l=!1,On(this,x[1]||"",!0),this.o=xs(x[2]||""),this.g=xs(x[3]||"",!0),la(this,x[4]),this.h=xs(x[5]||"",!0),Bf(this,x[6]||"",!0),this.m=xs(x[7]||"")):(this.l=!1,this.i=new ua(null,this.l))}Hr.prototype.toString=function(){const y=[];var x=this.j;x&&y.push(Ql(x,xu,!0),":");var A=this.g;return(A||x=="file")&&(y.push("//"),(x=this.o)&&y.push(Ql(x,xu,!0),"@"),y.push(oo(A).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.u,A!=null&&y.push(":",String(A))),(A=this.h)&&(this.g&&A.charAt(0)!="/"&&y.push("/"),y.push(Ql(A,A.charAt(0)=="/"?Uf:ng,!0))),(A=this.i.toString())&&y.push("?",A),(A=this.m)&&y.push("#",Ql(A,rg)),y.join("")},Hr.prototype.resolve=function(y){const x=fn(this);let A=!!y.j;A?On(x,y.j):A=!!y.o,A?x.o=y.o:A=!!y.g,A?x.g=y.g:A=y.u!=null;var I=y.h;if(A)la(x,y.u);else if(A=!!y.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var K=x.h.lastIndexOf("/");K!=-1&&(I=x.h.slice(0,K+1)+I)}if(K=I,K==".."||K==".")I="";else if(K.indexOf("./")!=-1||K.indexOf("/.")!=-1){I=K.lastIndexOf("/",0)==0,K=K.split("/");const et=[];for(let pt=0;pt<K.length;){const zt=K[pt++];zt=="."?I&&pt==K.length&&et.push(""):zt==".."?((et.length>1||et.length==1&&et[0]!="")&&et.pop(),I&&pt==K.length&&et.push("")):(et.push(zt),I=!0)}I=et.join("/")}else I=K}return A?x.h=I:A=y.i.toString()!=="",A?Bf(x,sg(y.i)):A=!!y.m,A&&(x.m=y.m),x};function fn(y){return new Hr(y)}function On(y,x,A){y.j=A?xs(x,!0):x,y.j&&(y.j=y.j.replace(/:$/,""))}function la(y,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);y.u=x}else y.u=null}function Bf(y,x,A){x instanceof ua?(y.i=x,Cu(y.i,y.l)):(A||(x=Ql(x,ca)),y.i=new ua(x,y.l))}function de(y,x,A){y.i.set(x,A)}function Xl(y){return de(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function xs(y,x){return y?x?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Ql(y,x,A){return typeof y=="string"?(y=encodeURI(y).replace(x,Ar),A&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Ar(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var xu=/[#\/\?@]/g,ng=/[#\?:]/g,Uf=/[#\?]/g,ca=/[#\?@]/g,rg=/#/g;function ua(y,x){this.h=this.g=null,this.i=y||null,this.j=!!x}function kr(y){y.g||(y.g=new Map,y.h=0,y.i&&wu(y.i,function(x,A){y.add(decodeURIComponent(x.replace(/\+/g," ")),A)}))}n=ua.prototype,n.add=function(y,x){kr(this),this.i=null,y=ha(this,y);let A=this.g.get(y);return A||this.g.set(y,A=[]),A.push(x),this.h+=1,this};function ig(y,x){kr(y),x=ha(y,x),y.g.has(x)&&(y.i=null,y.h-=y.g.get(x).length,y.g.delete(x))}function zf(y,x){return kr(y),x=ha(y,x),y.g.has(x)}n.forEach=function(y,x){kr(this),this.g.forEach(function(A,I){A.forEach(function(K){y.call(x,K,I,this)},this)},this)};function Hf(y,x){kr(y);let A=[];if(typeof x=="string")zf(y,x)&&(A=A.concat(y.g.get(ha(y,x))));else for(y=Array.from(y.g.values()),x=0;x<y.length;x++)A=A.concat(y[x]);return A}n.set=function(y,x){return kr(this),this.i=null,y=ha(this,y),zf(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[x]),this.h+=1,this},n.get=function(y,x){return y?(y=Hf(this,y),y.length>0?String(y[0]):x):x};function Eu(y,x,A){ig(y,x),A.length>0&&(y.i=null,y.g.set(ha(y,x),v(A)),y.h+=A.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],x=Array.from(this.g.keys());for(let I=0;I<x.length;I++){var A=x[I];const K=oo(A);A=Hf(this,A);for(let et=0;et<A.length;et++){let pt=K;A[et]!==""&&(pt+="="+oo(A[et])),y.push(pt)}}return this.i=y.join("&")};function sg(y){const x=new ua;return x.i=y.i,y.g&&(x.g=new Map(y.g),x.h=y.h),x}function ha(y,x){return x=String(x),y.j&&(x=x.toLowerCase()),x}function Cu(y,x){x&&!y.j&&(kr(y),y.i=null,y.g.forEach(function(A,I){const K=I.toLowerCase();I!=K&&(ig(this,I),Eu(this,K,A))},y)),y.j=x}function Bi(y,x){const A=new Vi;if(o.Image){const I=new Image;I.onload=d(hi,A,"TestLoadImage: loaded",!0,x,I),I.onerror=d(hi,A,"TestLoadImage: error",!1,x,I),I.onabort=d(hi,A,"TestLoadImage: abort",!1,x,I),I.ontimeout=d(hi,A,"TestLoadImage: timeout",!1,x,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=y}else x(!1)}function $f(y,x){const A=new Vi,I=new AbortController,K=setTimeout(()=>{I.abort(),hi(A,"TestPingServer: timeout",!1,x)},1e4);fetch(y,{signal:I.signal}).then(et=>{clearTimeout(K),et.ok?hi(A,"TestPingServer: ok",!0,x):hi(A,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(K),hi(A,"TestPingServer: error",!1,x)})}function hi(y,x,A,I,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),I(A)}catch{}}function fa(){this.g=new Wm}function Es(y){this.i=y.Sb||null,this.h=y.ab||!1}p(Es,Gm),Es.prototype.g=function(){return new Jl(this.i,this.h)};function Jl(y,x){ln.call(this),this.H=y,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(Jl,ln),n=Jl.prototype,n.open=function(y,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=x,this.readyState=1,Ui(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(x.body=y),(this.H||o).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,da(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Ui(this)),this.g&&(this.readyState=3,Ui(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Au(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function Au(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var x=y.value?y.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!y.done}))&&(this.response=this.responseText+=x)}y.done?da(this):Ui(this),this.readyState==3&&Au(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,da(this))},n.Na=function(y){this.g&&(this.response=y,da(this))},n.ga=function(){this.g&&da(this)};function da(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Ui(y)}n.setRequestHeader=function(y,x){this.A.append(y,x)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],x=this.h.entries();for(var A=x.next();!A.done;)A=A.value,y.push(A[0]+": "+A[1]),A=x.next();return y.join(`\r
`)};function Ui(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Jl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function fi(y){let x="";return Ct(y,function(A,I){x+=I,x+=":",x+=A,x+=`\r
`}),x}function Zl(y,x,A){t:{for(I in A){var I=!1;break t}I=!0}I||(A=fi(A),typeof y=="string"?A!=null&&oo(A):de(y,x,A))}function _e(y){ln.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(_e,ln);var Cs=/^https?$/i,qf=["POST","PUT"];n=_e.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,x,A,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);x=x?x.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Pf.g(),this.g.onreadystatechange=g(h(this.Ca,this));try{this.B=!0,this.g.open(x,String(y),!0),this.B=!1}catch(et){tc(this,et);return}if(y=A||"",A=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var K in I)A.set(K,I[K]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const et of I.keys())A.set(et,I.get(et));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(A.keys()).find(et=>et.toLowerCase()=="content-type"),K=o.FormData&&y instanceof o.FormData,!(Array.prototype.indexOf.call(qf,x,void 0)>=0)||I||K||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[et,pt]of A)this.g.setRequestHeader(et,pt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(et){tc(this,et)}};function tc(y,x){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=x,y.o=5,Wf(y),ao(y)}function Wf(y){y.A||(y.A=!0,wn(y,"complete"),wn(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,wn(this,"complete"),wn(this,"abort"),ao(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ao(this,!0)),_e.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ec(this):this.Xa())},n.Xa=function(){ec(this)};function ec(y){if(y.h&&typeof s<"u"){if(y.v&&zi(y)==4)setTimeout(y.Ca.bind(y),0);else if(wn(y,"readystatechange"),zi(y)==4){y.h=!1;try{const et=y.ca();t:switch(et){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break t;default:x=!1}var A;if(!(A=x)){var I;if(I=et===0){let pt=String(y.D).match(eg)[1]||null;!pt&&o.self&&o.self.location&&(pt=o.self.location.protocol.slice(0,-1)),I=!Cs.test(pt?pt.toLowerCase():"")}A=I}if(A)wn(y,"complete"),wn(y,"success");else{y.o=6;try{var K=zi(y)>2?y.g.statusText:""}catch{K=""}y.l=K+" ["+y.ca()+"]",Wf(y)}}finally{ao(y)}}}}function ao(y,x){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const A=y.g;y.g=null,x||wn(y,"ready");try{A.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function zi(y){return y.g?y.g.readyState:0}n.ca=function(){try{return zi(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var x=this.g.responseText;return y&&x.indexOf(y)==0&&(x=x.substring(y.length)),P_(x)}};function Un(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function lo(y){const x={};y=(y.g&&zi(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<y.length;I++){if(j(y[I]))continue;var A=Jm(y[I]);const K=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const et=x[K]||[];x[K]=et,et.push(A)}Vt(x,function(I){return I.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function As(y,x,A){return A&&A.internalChannelParams&&A.internalChannelParams[y]||x}function pa(y){this.za=0,this.i=[],this.j=new Vi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=As("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=As("baseRetryDelayMs",5e3,y),this.Za=As("retryDelaySeedMs",1e4,y),this.Ta=As("forwardChannelMaxRetries",2,y),this.va=As("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Nf(y&&y.concurrentRequestLimit),this.Ba=new fa,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=pa.prototype,n.ka=8,n.I=1,n.connect=function(y,x,A,I){cn(0),this.W=y,this.H=x||{},A&&I!==void 0&&(this.H.OSID=A,this.H.OAID=I),this.F=this.X,this.J=fg(this,null,this.W),ks(this)};function Gf(y){if(ku(y),y.I==3){var x=y.V++,A=fn(y.J);if(de(A,"SID",y.M),de(A,"RID",x),de(A,"TYPE","terminate"),nc(y,A),x=new ji(y,y.j,x),x.M=2,x.A=Xl(fn(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(x.A.toString(),"")}catch{}!A&&o.Image&&(new Image().src=x.A,A=!0),A||(x.g=dg(x.j,null),x.g.ea(x.A)),x.F=Date.now(),bs(x)}hg(y)}function ma(y){y.g&&(Kf(y),y.g.cancel(),y.g=null)}function ku(y){ma(y),y.v&&(o.clearTimeout(y.v),y.v=null),Du(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&o.clearTimeout(y.m),y.m=null)}function ks(y){if(!Lf(y.h)&&!y.m){y.m=!0;var x=y.Ea;N||k(),q||(N(),q=!0),M.add(x,y),y.D=0}}function Mu(y,x){return Ss(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=x.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=gs(h(y.Ea,y,x),ug(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const K=new ji(this,this.j,y);let et=this.o;if(this.U&&(et?(et=$(et),dt(et,this.U)):et=this.U),this.u!==null||this.R||(K.J=et,et=null),this.S)t:{for(var x=0,A=0;A<this.i.length;A++){e:{var I=this.i[A];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break e}I=void 0}if(I===void 0)break;if(x+=I,x>4096){x=A;break t}if(x===4096||A===this.i.length-1){x=A+1;break t}}x=1e3}else x=1e3;x=og(this,K,x),A=fn(this.J),de(A,"RID",y),de(A,"CVER",22),this.G&&de(A,"X-HTTP-Session-Id",this.G),nc(this,A),et&&(this.R?x="headers="+oo(fi(et))+"&"+x:this.u&&Zl(A,this.u,et)),Vf(this.h,K),this.Ra&&de(A,"TYPE","init"),this.S?(de(A,"$req",x),de(A,"SID","null"),K.U=!0,vs(K,A,null)):vs(K,A,x),this.I=2}}else this.I==3&&(y?Yf(this,y):this.i.length==0||Lf(this.h)||Yf(this))};function Yf(y,x){var A;x?A=x.l:A=y.V++;const I=fn(y.J);de(I,"SID",y.M),de(I,"RID",A),de(I,"AID",y.K),nc(y,I),y.u&&y.o&&Zl(I,y.u,y.o),A=new ji(y,y.j,A,y.D+1),y.u===null&&(A.J=y.o),x&&(y.i=x.G.concat(y.i)),x=og(y,A,1e3),A.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Vf(y.h,A),vs(A,I,x)}function nc(y,x){y.H&&Ct(y.H,function(A,I){de(x,I,A)}),y.l&&Ct({},function(A,I){de(x,I,A)})}function og(y,x,A){A=Math.min(y.i.length,A);const I=y.l?h(y.l.Ka,y.l,y):null;t:{var K=y.i;let zt=-1;for(;;){const en=["count="+A];zt==-1?A>0?(zt=K[0].g,en.push("ofs="+zt)):zt=0:en.push("ofs="+zt);let le=!0;for(let Ne=0;Ne<A;Ne++){var et=K[Ne].g;const di=K[Ne].map;if(et-=zt,et<0)zt=Math.max(0,K[Ne].g-100),le=!1;else try{et="req"+et+"_"||"";try{var pt=di instanceof Map?di:Object.entries(di);for(const[Ds,Hi]of pt){let $i=Hi;l(Hi)&&($i=aa(Hi)),en.push(et+Ds+"="+encodeURIComponent($i))}}catch(Ds){throw en.push(et+"type="+encodeURIComponent("_badmap")),Ds}}catch{I&&I(di)}}if(le){pt=en.join("&");break t}}pt=void 0}return y=y.i.splice(0,A),x.G=y,pt}function ag(y){if(!y.g&&!y.v){y.Y=1;var x=y.Da;N||k(),q||(N(),q=!0),M.add(x,y),y.A=0}}function rc(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=gs(h(y.Da,y),ug(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,lg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=gs(h(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,cn(10),ma(this),lg(this))};function Kf(y){y.B!=null&&(o.clearTimeout(y.B),y.B=null)}function lg(y){y.g=new ji(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var x=fn(y.na);de(x,"RID","rpc"),de(x,"SID",y.M),de(x,"AID",y.K),de(x,"CI",y.F?"0":"1"),!y.F&&y.ia&&de(x,"TO",y.ia),de(x,"TYPE","xmlhttp"),nc(y,x),y.u&&y.o&&Zl(x,y.u,y.o),y.O&&(y.g.H=y.O);var A=y.g;y=y.ba,A.M=1,A.A=Xl(fn(x)),A.u=null,A.R=!0,Tu(A,y)}n.Va=function(){this.C!=null&&(this.C=null,ma(this),rc(this),cn(19))};function Du(y){y.C!=null&&(o.clearTimeout(y.C),y.C=null)}function cg(y,x){var A=null;if(y.g==x){Du(y),Kf(y),y.g=null;var I=2}else if(ws(y.h,x))A=x.G,jf(y.h,x),I=1;else return;if(y.I!=0){if(x.o)if(I==1){A=x.u?x.u.length:0,x=Date.now()-x.F;var K=y.D;I=_u(),wn(I,new ms(I,A)),ks(y)}else ag(y);else if(K=x.m,K==3||K==0&&x.X>0||!(I==1&&Mu(y,x)||I==2&&rc(y)))switch(A&&A.length>0&&(x=y.h,x.i=x.i.concat(A)),K){case 1:Ms(y,5);break;case 4:Ms(y,10);break;case 3:Ms(y,6);break;default:Ms(y,2)}}}function ug(y,x){let A=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(A*=2),A*x}function Ms(y,x){if(y.j.info("Error code "+x),x==2){var A=h(y.bb,y),I=y.Ua;const K=!I;I=new Hr(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||On(I,"https"),Xl(I),K?Bi(I.toString(),A):$f(I.toString(),A)}else cn(2);y.I=0,y.l&&y.l.pa(x),hg(y),ku(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),cn(2)):(this.j.info("Failed to ping google.com"),cn(1))};function hg(y){if(y.I=0,y.ja=[],y.l){const x=Ff(y.h);(x.length!=0||y.i.length!=0)&&(T(y.ja,x),T(y.ja,y.i),y.h.i.length=0,v(y.i),y.i.length=0),y.l.oa()}}function fg(y,x,A){var I=A instanceof Hr?fn(A):new Hr(A);if(I.g!="")x&&(I.g=x+"."+I.g),la(I,I.u);else{var K=o.location;I=K.protocol,x=x?x+"."+K.hostname:K.hostname,K=+K.port;const et=new Hr(null);I&&On(et,I),x&&(et.g=x),K&&la(et,K),A&&(et.h=A),I=et}return A=y.G,x=y.wa,A&&x&&de(I,A,x),de(I,"VER",y.ka),nc(y,I),I}function dg(y,x,A){if(x&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=y.Aa&&!y.ma?new _e(new Es({ab:A})):new _e(y.ma),x.Fa(y.L),x}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function pg(){}n=pg.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ga(){}ga.prototype.g=function(y,x){return new hr(y,x)};function hr(y,x){ln.call(this),this.g=new pa(x),this.l=y,this.h=x&&x.messageUrlParams||null,y=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(y?y["X-WebChannel-Content-Type"]=x.messageContentType:y={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(y?y["X-WebChannel-Client-Profile"]=x.sa:y={"X-WebChannel-Client-Profile":x.sa}),this.g.U=y,(y=x&&x.Qb)&&!j(y)&&(this.g.u=y),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!j(x)&&(this.g.G=x,y=this.h,y!==null&&x in y&&(y=this.h,x in y&&delete y[x])),this.j=new co(this)}p(hr,ln),hr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},hr.prototype.close=function(){Gf(this.g)},hr.prototype.o=function(y){var x=this.g;if(typeof y=="string"){var A={};A.__data__=y,y=A}else this.v&&(A={},A.__data__=aa(y),y=A);x.i.push(new hn(x.Ya++,y)),x.I==3&&ks(x)},hr.prototype.N=function(){this.g.l=null,delete this.j,Gf(this.g),delete this.g,hr.Z.N.call(this)};function mg(y){Bn.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var x=y.__sm__;if(x){t:{for(const A in x){y=A;break t}y=void 0}(this.i=y)&&(y=this.i,x=x!==null&&y in x?x[y]:void 0),this.data=x}else this.data=y}p(mg,Bn);function gg(){ci.call(this),this.status=1}p(gg,ci);function co(y){this.g=y}p(co,pg),co.prototype.ra=function(){wn(this.g,"a")},co.prototype.qa=function(y){wn(this.g,new mg(y))},co.prototype.pa=function(y){wn(this.g,new gg)},co.prototype.oa=function(){wn(this.g,"b")},ga.prototype.createWebChannel=ga.prototype.g,hr.prototype.send=hr.prototype.o,hr.prototype.open=hr.prototype.m,hr.prototype.close=hr.prototype.close,TV=function(){return new ga},_V=function(){return _u()},bV=tn,_x={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Yl.NO_ERROR=0,Yl.TIMEOUT=8,Yl.HTTP_ERROR=6,x0=Yl,If.COMPLETE="complete",vV=If,Ym.EventType=Li,Li.OPEN="a",Li.CLOSE="b",Li.ERROR="c",Li.MESSAGE="d",ln.prototype.listen=ln.prototype.J,Xd=Ym,_e.prototype.listenOnce=_e.prototype.K,_e.prototype.getLastError=_e.prototype.Ha,_e.prototype.getLastErrorCode=_e.prototype.ya,_e.prototype.getStatus=_e.prototype.ca,_e.prototype.getResponseJson=_e.prototype.La,_e.prototype.getResponseText=_e.prototype.la,_e.prototype.send=_e.prototype.ea,_e.prototype.setWithCredentials=_e.prototype.Fa,yV=_e}).apply(typeof Sy<"u"?Sy:typeof self<"u"?self:typeof window<"u"?window:{});class ir{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}ir.UNAUTHENTICATED=new ir(null),ir.GOOGLE_CREDENTIALS=new ir("google-credentials-uid"),ir.FIRST_PARTY=new ir("first-party-uid"),ir.MOCK_USER=new ir("mock-user");let hf="12.9.0";function VW(n){hf=n}const nu=new f1("@firebase/firestore");function fh(){return nu.logLevel}function bt(n,...t){if(nu.logLevel<=Jt.DEBUG){const e=t.map(E1);nu.debug(`Firestore (${hf}): ${n}`,...e)}}function Xo(n,...t){if(nu.logLevel<=Jt.ERROR){const e=t.map(E1);nu.error(`Firestore (${hf}): ${n}`,...e)}}function ru(n,...t){if(nu.logLevel<=Jt.WARN){const e=t.map(E1);nu.warn(`Firestore (${hf}): ${n}`,...e)}}function E1(n){if(typeof n=="string")return n;try{return(function(e){return JSON.stringify(e)})(n)}catch{return n}}function Rt(n,t,e){let r="Unexpected state";typeof t=="string"?r=t:e=t,SV(n,r,e)}function SV(n,t,e){let r=`FIRESTORE (${hf}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{r+=" CONTEXT: "+JSON.stringify(e)}catch{r+=" CONTEXT: "+e}throw Xo(r),new Error(r)}function ie(n,t,e,r){let i="Unexpected state";typeof e=="string"?i=e:r=e,n||SV(t,i,r)}function Ft(n,t){return n}const it={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class gt extends so{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ys{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class wV{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class jW{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(ir.UNAUTHENTICATED)))}shutdown(){}}class FW{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class BW{constructor(t){this.t=t,this.currentUser=ir.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){ie(this.o===void 0,42304);let r=this.i;const i=u=>this.i!==r?(r=this.i,e(u)):Promise.resolve();let s=new Ys;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ys,t.enqueueRetryable((()=>i(this.currentUser)))};const o=()=>{const u=s;t.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},l=u=>{bt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>l(u))),setTimeout((()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(bt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ys)}}),0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((r=>this.i!==t?(bt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ie(typeof r.accessToken=="string",31837,{l:r}),new wV(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return ie(t===null||typeof t=="string",2055,{h:t}),new ir(t)}}class UW{constructor(t,e,r){this.P=t,this.T=e,this.I=r,this.type="FirstParty",this.user=ir.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const t=this.A();return t&&this.R.set("Authorization",t),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class zW{constructor(t,e,r){this.P=t,this.T=e,this.I=r}getToken(){return Promise.resolve(new UW(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(ir.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class fR{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class HW{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Vr(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){ie(this.o===void 0,3512);const r=s=>{s.error!=null&&bt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,bt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable((()=>r(s)))};const i=s=>{bt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):bt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new fR(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(ie(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new fR(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function $W(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class C1{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=$W(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<e&&(r+=t.charAt(i[s]%62))}return r}}function Zt(n,t){return n<t?-1:n>t?1:0}function Tx(n,t){const e=Math.min(n.length,t.length);for(let r=0;r<e;r++){const i=n.charAt(r),s=t.charAt(r);if(i!==s)return GS(i)===GS(s)?Zt(i,s):GS(i)?1:-1}return Zt(n.length,t.length)}const qW=55296,WW=57343;function GS(n){const t=n.charCodeAt(0);return t>=qW&&t<=WW}function Hh(n,t,e){return n.length===t.length&&n.every(((r,i)=>e(r,t[i])))}const dR="__name__";class Bs{constructor(t,e,r){e===void 0?e=0:e>t.length&&Rt(637,{offset:e,range:t.length}),r===void 0?r=t.length-e:r>t.length-e&&Rt(1746,{length:r,range:t.length-e}),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return Bs.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Bs?t.forEach((r=>{e.push(r)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let i=0;i<r;i++){const s=Bs.compareSegments(t.get(i),e.get(i));if(s!==0)return s}return Zt(t.length,e.length)}static compareSegments(t,e){const r=Bs.isNumericId(t),i=Bs.isNumericId(e);return r&&!i?-1:!r&&i?1:r&&i?Bs.extractNumericId(t).compare(Bs.extractNumericId(e)):Tx(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return ul.fromString(t.substring(4,t.length-2))}}class Ee extends Bs{construct(t,e,r){return new Ee(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new gt(it.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter((i=>i.length>0)))}return new Ee(e)}static emptyPath(){return new Ee([])}}const GW=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qn extends Bs{construct(t,e,r){return new Qn(t,e,r)}static isValidIdentifier(t){return GW.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qn.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===dR}static keyField(){return new Qn([dR])}static fromServerFormat(t){const e=[];let r="",i=0;const s=()=>{if(r.length===0)throw new gt(it.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;i<t.length;){const l=t[i];if(l==="\\"){if(i+1===t.length)throw new gt(it.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new gt(it.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new gt(it.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Qn(e)}static emptyPath(){return new Qn([])}}class At{constructor(t){this.path=t}static fromPath(t){return new At(Ee.fromString(t))}static fromName(t){return new At(Ee.fromString(t).popFirst(5))}static empty(){return new At(Ee.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Ee.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return Ee.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new At(new Ee(t.slice()))}}function xV(n,t,e){if(!e)throw new gt(it.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function YW(n,t,e,r){if(t===!0&&r===!0)throw new gt(it.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function pR(n){if(!At.isDocumentKey(n))throw new gt(it.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mR(n){if(At.isDocumentKey(n))throw new gt(it.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function EV(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Vb(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(r){return r.constructor?r.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":Rt(12329,{type:typeof n})}function Zs(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new gt(it.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Vb(n);throw new gt(it.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function _n(n,t){const e={typeString:n};return t&&(e.value=t),e}function Em(n,t){if(!EV(n))throw new gt(it.INVALID_ARGUMENT,"JSON must be an object");let e;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in n)){e=`JSON missing required field: '${r}'`;break}const o=n[r];if(i&&typeof o!==i){e=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){e=`Expected '${r}' field to equal '${s.value}'`;break}}if(e)throw new gt(it.INVALID_ARGUMENT,e);return!0}const gR=-62135596800,yR=1e6;class ue{static now(){return ue.fromMillis(Date.now())}static fromDate(t){return ue.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor((t-1e3*e)*yR);return new ue(e,r)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new gt(it.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new gt(it.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<gR)throw new gt(it.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new gt(it.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yR}_compareTo(t){return this.seconds===t.seconds?Zt(this.nanoseconds,t.nanoseconds):Zt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ue._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Em(t,ue._jsonSchema))return new ue(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-gR;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ue._jsonSchemaVersion="firestore/timestamp/1.0",ue._jsonSchema={type:_n("string",ue._jsonSchemaVersion),seconds:_n("number"),nanoseconds:_n("number")};class Nt{static fromTimestamp(t){return new Nt(t)}static min(){return new Nt(new ue(0,0))}static max(){return new Nt(new ue(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const jp=-1;function KW(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Nt.fromTimestamp(r===1e9?new ue(e+1,0):new ue(e,r));return new vl(i,At.empty(),t)}function XW(n){return new vl(n.readTime,n.key,jp)}class vl{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new vl(Nt.min(),At.empty(),jp)}static max(){return new vl(Nt.max(),At.empty(),jp)}}function QW(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=At.comparator(n.documentKey,t.documentKey),e!==0?e:Zt(n.largestBatchId,t.largestBatchId))}const JW="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ZW{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function ff(n){if(n.code!==it.FAILED_PRECONDITION||n.message!==JW)throw n;bt("LocalStore","Unexpectedly lost primary lease")}class ct{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Rt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new ct(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(e,s).next(r,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof ct?e:ct.resolve(e)}catch(e){return ct.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):ct.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):ct.reject(e)}static resolve(t){return new ct(((e,r)=>{e(t)}))}static reject(t){return new ct(((e,r)=>{r(t)}))}static waitFor(t){return new ct(((e,r)=>{let i=0,s=0,o=!1;t.forEach((l=>{++i,l.next((()=>{++s,o&&s===i&&e()}),(u=>r(u)))})),o=!0,s===i&&e()}))}static or(t){let e=ct.resolve(!1);for(const r of t)e=e.next((i=>i?ct.resolve(i):r()));return e}static forEach(t,e){const r=[];return t.forEach(((i,s)=>{r.push(e.call(this,i,s))})),this.waitFor(r)}static mapArray(t,e){return new ct(((r,i)=>{const s=t.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const h=u;e(t[h]).next((d=>{o[h]=d,++l,l===s&&r(o)}),(d=>i(d)))}}))}static doWhile(t,e){return new ct(((r,i)=>{const s=()=>{t()===!0?e().next((()=>{s()}),i):r()};s()}))}}function tG(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function df(n){return n.name==="IndexedDbTransactionError"}class jb{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>e.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}jb.ce=-1;const A1=-1;function Cm(n){return n==null}function iv(n){return n===0&&1/n==-1/0}function eG(n){return typeof n=="number"&&Number.isInteger(n)&&!iv(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const CV="";function nG(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=vR(t)),t=rG(n.get(e),t);return vR(t)}function rG(n,t){let e=t;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":e+="";break;case CV:e+="";break;default:e+=s}}return e}function vR(n){return n+CV+""}function bR(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Ll(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function AV(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}class He{constructor(t,e){this.comparator=t,this.root=e||Yn.EMPTY}insert(t,e){return new He(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Yn.BLACK,null,null))}remove(t){return new He(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Yn.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(r===0)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return e+r.left.size;i<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,r)=>(t(e,r),!1)))}toString(){const t=[];return this.inorderTraversal(((e,r)=>(t.push(`${e}:${r}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new wy(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new wy(this.root,t,this.comparator,!1)}getReverseIterator(){return new wy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new wy(this.root,t,this.comparator,!0)}}class wy{constructor(t,e,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?r(t.key,e):1,e&&i&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Yn{constructor(t,e,r,i,s){this.key=t,this.value=e,this.color=r??Yn.RED,this.left=i??Yn.EMPTY,this.right=s??Yn.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,i,s){return new Yn(t??this.key,e??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let i=this;const s=r(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,r),null):s===0?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Yn.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),e(t,i.key)===0){if(i.right.isEmpty())return Yn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Yn.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Yn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Rt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Rt(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw Rt(27949);return t+(this.isRed()?0:1)}}Yn.EMPTY=null,Yn.RED=!0,Yn.BLACK=!1;Yn.EMPTY=new class{constructor(){this.size=0}get key(){throw Rt(57766)}get value(){throw Rt(16141)}get color(){throw Rt(16727)}get left(){throw Rt(29726)}get right(){throw Rt(36894)}copy(t,e,r,i,s){return this}insert(t,e,r){return new Yn(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class An{constructor(t){this.comparator=t,this.data=new He(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,r)=>(t(e),!1)))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let r;for(r=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new _R(this.data.getIterator())}getIteratorFrom(t){return new _R(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((r=>{e=e.add(r)})),e}isEqual(t){if(!(t instanceof An)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const i=e.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new An(this.comparator);return e.data=t,e}}class _R{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ti{constructor(t){this.fields=t,t.sort(Qn.comparator)}static empty(){return new ti([])}unionWith(t){let e=new An(Qn.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new ti(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Hh(this.fields,t.fields,((e,r)=>e.isEqual(r)))}}class kV extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class tr{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new kV("Invalid base64 string: "+s):s}})(t);return new tr(e)}static fromUint8Array(t){const e=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(t);return new tr(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Zt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}tr.EMPTY_BYTE_STRING=new tr("");const iG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bl(n){if(ie(!!n,39018),typeof n=="string"){let t=0;const e=iG.exec(n);if(ie(!!e,46558,{timestamp:n}),e[1]){let i=e[1];i=(i+"000000000").substr(0,9),t=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:sn(n.seconds),nanos:sn(n.nanos)}}function sn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _l(n){return typeof n=="string"?tr.fromBase64String(n):tr.fromUint8Array(n)}const MV="server_timestamp",DV="__type__",OV="__previous_value__",RV="__local_write_time__";function k1(n){return(n?.mapValue?.fields||{})[DV]?.stringValue===MV}function Fb(n){const t=n.mapValue.fields[OV];return k1(t)?Fb(t):t}function Fp(n){const t=bl(n.mapValue.fields[RV].timestampValue);return new ue(t.seconds,t.nanos)}class sG{constructor(t,e,r,i,s,o,l,u,h,d,p){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=d,this.apiKey=p}}const sv="(default)";class Bp{constructor(t,e){this.projectId=t,this.database=e||sv}static empty(){return new Bp("","")}get isDefaultDatabase(){return this.database===sv}isEqual(t){return t instanceof Bp&&t.projectId===this.projectId&&t.database===this.database}}function oG(n,t){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new gt(it.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bp(n.options.projectId,t)}const IV="__type__",aG="__max__",xy={mapValue:{}},PV="__vector__",ov="value";function Tl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?k1(n)?4:cG(n)?9007199254740991:lG(n)?10:11:Rt(28295,{value:n})}function to(n,t){if(n===t)return!0;const e=Tl(n);if(e!==Tl(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Fp(n).isEqual(Fp(t));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=bl(i.timestampValue),l=bl(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(i,s){return _l(i.bytesValue).isEqual(_l(s.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(i,s){return sn(i.geoPointValue.latitude)===sn(s.geoPointValue.latitude)&&sn(i.geoPointValue.longitude)===sn(s.geoPointValue.longitude)})(n,t);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return sn(i.integerValue)===sn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=sn(i.doubleValue),l=sn(s.doubleValue);return o===l?iv(o)===iv(l):isNaN(o)&&isNaN(l)}return!1})(n,t);case 9:return Hh(n.arrayValue.values||[],t.arrayValue.values||[],to);case 10:case 11:return(function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(bR(o)!==bR(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!to(o[u],l[u])))return!1;return!0})(n,t);default:return Rt(52216,{left:n})}}function Up(n,t){return(n.values||[]).find((e=>to(e,t)))!==void 0}function $h(n,t){if(n===t)return 0;const e=Tl(n),r=Tl(t);if(e!==r)return Zt(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return Zt(n.booleanValue,t.booleanValue);case 2:return(function(s,o){const l=sn(s.integerValue||s.doubleValue),u=sn(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1})(n,t);case 3:return TR(n.timestampValue,t.timestampValue);case 4:return TR(Fp(n),Fp(t));case 5:return Tx(n.stringValue,t.stringValue);case 6:return(function(s,o){const l=_l(s),u=_l(o);return l.compareTo(u)})(n.bytesValue,t.bytesValue);case 7:return(function(s,o){const l=s.split("/"),u=o.split("/");for(let h=0;h<l.length&&h<u.length;h++){const d=Zt(l[h],u[h]);if(d!==0)return d}return Zt(l.length,u.length)})(n.referenceValue,t.referenceValue);case 8:return(function(s,o){const l=Zt(sn(s.latitude),sn(o.latitude));return l!==0?l:Zt(sn(s.longitude),sn(o.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return SR(n.arrayValue,t.arrayValue);case 10:return(function(s,o){const l=s.fields||{},u=o.fields||{},h=l[ov]?.arrayValue,d=u[ov]?.arrayValue,p=Zt(h?.values?.length||0,d?.values?.length||0);return p!==0?p:SR(h,d)})(n.mapValue,t.mapValue);case 11:return(function(s,o){if(s===xy.mapValue&&o===xy.mapValue)return 0;if(s===xy.mapValue)return 1;if(o===xy.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),h=o.fields||{},d=Object.keys(h);u.sort(),d.sort();for(let p=0;p<u.length&&p<d.length;++p){const g=Tx(u[p],d[p]);if(g!==0)return g;const v=$h(l[u[p]],h[d[p]]);if(v!==0)return v}return Zt(u.length,d.length)})(n.mapValue,t.mapValue);default:throw Rt(23264,{he:e})}}function TR(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return Zt(n,t);const e=bl(n),r=bl(t),i=Zt(e.seconds,r.seconds);return i!==0?i:Zt(e.nanos,r.nanos)}function SR(n,t){const e=n.values||[],r=t.values||[];for(let i=0;i<e.length&&i<r.length;++i){const s=$h(e[i],r[i]);if(s)return s}return Zt(e.length,r.length)}function qh(n){return Sx(n)}function Sx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(e){const r=bl(e);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(e){return _l(e).toBase64()})(n.bytesValue):"referenceValue"in n?(function(e){return At.fromName(e).toString()})(n.referenceValue):"geoPointValue"in n?(function(e){return`geo(${e.latitude},${e.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(e){let r="[",i=!0;for(const s of e.values||[])i?i=!1:r+=",",r+=Sx(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(e){const r=Object.keys(e.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Sx(e.fields[o])}`;return i+"}"})(n.mapValue):Rt(61005,{value:n})}function E0(n){switch(Tl(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Fb(n);return t?16+E0(t):16;case 5:return 2*n.stringValue.length;case 6:return _l(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+E0(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Ll(r.fields,((s,o)=>{i+=s.length+E0(o)})),i})(n.mapValue);default:throw Rt(13486,{value:n})}}function wR(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function wx(n){return!!n&&"integerValue"in n}function M1(n){return!!n&&"arrayValue"in n}function xR(n){return!!n&&"nullValue"in n}function ER(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function C0(n){return!!n&&"mapValue"in n}function lG(n){return(n?.mapValue?.fields||{})[IV]?.stringValue===PV}function cp(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return Ll(n.mapValue.fields,((e,r)=>t.mapValue.fields[e]=cp(r))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=cp(n.arrayValue.values[e]);return t}return{...n}}function cG(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===aG}class yr{constructor(t){this.value=t}static empty(){return new yr({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!C0(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=cp(e)}setAll(t){let e=Qn.emptyPath(),r={},i=[];t.forEach(((o,l)=>{if(!e.isImmediateParentOf(l)){const u=this.getFieldsMap(e);this.applyChanges(u,r,i),r={},i=[],e=l.popLast()}o?r[l.lastSegment()]=cp(o):i.push(l.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,r,i)}delete(t){const e=this.field(t.popLast());C0(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return to(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let i=e.mapValue.fields[t.get(r)];C0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,r){Ll(e,((i,s)=>t[i]=s));for(const i of r)delete t[i]}clone(){return new yr(cp(this.value))}}function NV(n){const t=[];return Ll(n.fields,((e,r)=>{const i=new Qn([e]);if(C0(r)){const s=NV(r.mapValue).fields;if(s.length===0)t.push(i);else for(const o of s)t.push(i.child(o))}else t.push(i)})),new ti(t)}class Nn{constructor(t,e,r,i,s,o,l){this.key=t,this.documentType=e,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(t){return new Nn(t,0,Nt.min(),Nt.min(),Nt.min(),yr.empty(),0)}static newFoundDocument(t,e,r,i){return new Nn(t,1,e,Nt.min(),r,i,0)}static newNoDocument(t,e){return new Nn(t,2,e,Nt.min(),Nt.min(),yr.empty(),0)}static newUnknownDocument(t,e){return new Nn(t,3,e,Nt.min(),Nt.min(),yr.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Nt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=yr.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Nt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Nn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Nn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class av{constructor(t,e){this.position=t,this.inclusive=e}}function CR(n,t,e){let r=0;for(let i=0;i<n.position.length;i++){const s=t[i],o=n.position[i];if(s.field.isKeyField()?r=At.comparator(At.fromName(o.referenceValue),e.key):r=$h(o,e.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function AR(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!to(n.position[e],t.position[e]))return!1;return!0}class zp{constructor(t,e="asc"){this.field=t,this.dir=e}}function uG(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class LV{}class bn extends LV{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,r):new fG(t,e,r):e==="array-contains"?new mG(t,r):e==="in"?new gG(t,r):e==="not-in"?new yG(t,r):e==="array-contains-any"?new vG(t,r):new bn(t,e,r)}static createKeyFieldInFilter(t,e,r){return e==="in"?new dG(t,r):new pG(t,r)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison($h(e,this.value)):e!==null&&Tl(this.value)===Tl(e)&&this.matchesComparison($h(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Rt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fs extends LV{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new fs(t,e)}matches(t){return VV(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function VV(n){return n.op==="and"}function jV(n){return hG(n)&&VV(n)}function hG(n){for(const t of n.filters)if(t instanceof fs)return!1;return!0}function xx(n){if(n instanceof bn)return n.field.canonicalString()+n.op.toString()+qh(n.value);if(jV(n))return n.filters.map((t=>xx(t))).join(",");{const t=n.filters.map((e=>xx(e))).join(",");return`${n.op}(${t})`}}function FV(n,t){return n instanceof bn?(function(r,i){return i instanceof bn&&r.op===i.op&&r.field.isEqual(i.field)&&to(r.value,i.value)})(n,t):n instanceof fs?(function(r,i){return i instanceof fs&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,o,l)=>s&&FV(o,i.filters[l])),!0):!1})(n,t):void Rt(19439)}function BV(n){return n instanceof bn?(function(e){return`${e.field.canonicalString()} ${e.op} ${qh(e.value)}`})(n):n instanceof fs?(function(e){return e.op.toString()+" {"+e.getFilters().map(BV).join(" ,")+"}"})(n):"Filter"}class fG extends bn{constructor(t,e,r){super(t,e,r),this.key=At.fromName(r.referenceValue)}matches(t){const e=At.comparator(t.key,this.key);return this.matchesComparison(e)}}class dG extends bn{constructor(t,e){super(t,"in",e),this.keys=UV("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class pG extends bn{constructor(t,e){super(t,"not-in",e),this.keys=UV("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function UV(n,t){return(t.arrayValue?.values||[]).map((e=>At.fromName(e.referenceValue)))}class mG extends bn{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return M1(e)&&Up(e.arrayValue,this.value)}}class gG extends bn{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Up(this.value.arrayValue,e)}}class yG extends bn{constructor(t,e){super(t,"not-in",e)}matches(t){if(Up(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Up(this.value.arrayValue,e)}}class vG extends bn{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!M1(e)||!e.arrayValue.values)&&e.arrayValue.values.some((r=>Up(this.value.arrayValue,r)))}}class bG{constructor(t,e=null,r=[],i=[],s=null,o=null,l=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.Te=null}}function kR(n,t=null,e=[],r=[],i=null,s=null,o=null){return new bG(n,t,e,r,i,s,o)}function D1(n){const t=Ft(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((r=>xx(r))).join(","),e+="|ob:",e+=t.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),Cm(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((r=>qh(r))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((r=>qh(r))).join(",")),t.Te=e}return t.Te}function O1(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!uG(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!FV(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!AR(n.startAt,t.startAt)&&AR(n.endAt,t.endAt)}function Ex(n){return At.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class pf{constructor(t,e=null,r=[],i=[],s=null,o="F",l=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function _G(n,t,e,r,i,s,o,l){return new pf(n,t,e,r,i,s,o,l)}function R1(n){return new pf(n)}function MR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function TG(n){return At.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function zV(n){return n.collectionGroup!==null}function up(n){const t=Ft(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const s of t.explicitOrderBy)t.Ie.push(s),e.add(s.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new An(Qn.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(t).forEach((s=>{e.has(s.canonicalString())||s.isKeyField()||t.Ie.push(new zp(s,r))})),e.has(Qn.keyField().canonicalString())||t.Ie.push(new zp(Qn.keyField(),r))}return t.Ie}function Ks(n){const t=Ft(n);return t.Ee||(t.Ee=SG(t,up(n))),t.Ee}function SG(n,t){if(n.limitType==="F")return kR(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new zp(i.field,s)}));const e=n.endAt?new av(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new av(n.startAt.position,n.startAt.inclusive):null;return kR(n.path,n.collectionGroup,t,n.filters,n.limit,e,r)}}function Cx(n,t){const e=n.filters.concat([t]);return new pf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function wG(n,t){const e=n.explicitOrderBy.concat([t]);return new pf(n.path,n.collectionGroup,e,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function lv(n,t,e){return new pf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Bb(n,t){return O1(Ks(n),Ks(t))&&n.limitType===t.limitType}function HV(n){return`${D1(Ks(n))}|lt:${n.limitType}`}function dh(n){return`Query(target=${(function(e){let r=e.path.canonicalString();return e.collectionGroup!==null&&(r+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(r+=`, filters: [${e.filters.map((i=>BV(i))).join(", ")}]`),Cm(e.limit)||(r+=", limit: "+e.limit),e.orderBy.length>0&&(r+=`, orderBy: [${e.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),e.startAt&&(r+=", startAt: ",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((i=>qh(i))).join(",")),e.endAt&&(r+=", endAt: ",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((i=>qh(i))).join(",")),`Target(${r})`})(Ks(n))}; limitType=${n.limitType})`}function Ub(n,t){return t.isFoundDocument()&&(function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):At.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,t)&&(function(r,i){for(const s of up(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,t)&&(function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0})(n,t)&&(function(r,i){return!(r.startAt&&!(function(o,l,u){const h=CR(o,l,u);return o.inclusive?h<=0:h<0})(r.startAt,up(r),i)||r.endAt&&!(function(o,l,u){const h=CR(o,l,u);return o.inclusive?h>=0:h>0})(r.endAt,up(r),i))})(n,t)}function xG(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function $V(n){return(t,e)=>{let r=!1;for(const i of up(n)){const s=EG(i,t,e);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function EG(n,t,e){const r=n.field.isKeyField()?At.comparator(t.key,e.key):(function(s,o,l){const u=o.data.field(s),h=l.data.field(s);return u!==null&&h!==null?$h(u,h):Rt(42886)})(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Rt(19790,{direction:n.dir})}}class mu{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,t))return s}}has(t){return this.get(t)!==void 0}set(t,e){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return this.inner[r]=[[t,e]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return void(i[s]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return r.length===1?delete this.inner[e]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(t){Ll(this.inner,((e,r)=>{for(const[i,s]of r)t(i,s)}))}isEmpty(){return AV(this.inner)}size(){return this.innerSize}}const CG=new He(At.comparator);function Qo(){return CG}const qV=new He(At.comparator);function Qd(...n){let t=qV;for(const e of n)t=t.insert(e.key,e);return t}function WV(n){let t=qV;return n.forEach(((e,r)=>t=t.insert(e,r.overlayedDocument))),t}function Pc(){return hp()}function GV(){return hp()}function hp(){return new mu((n=>n.toString()),((n,t)=>n.isEqual(t)))}const AG=new He(At.comparator),kG=new An(At.comparator);function te(...n){let t=kG;for(const e of n)t=t.add(e);return t}const MG=new An(Zt);function DG(){return MG}function I1(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:iv(t)?"-0":t}}function YV(n){return{integerValue:""+n}}function OG(n,t){return eG(t)?YV(t):I1(n,t)}class zb{constructor(){this._=void 0}}function RG(n,t,e){return n instanceof Hp?(function(i,s){const o={fields:{[DV]:{stringValue:MV},[RV]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&k1(s)&&(s=Fb(s)),s&&(o.fields[OV]=s),{mapValue:o}})(e,t):n instanceof $p?XV(n,t):n instanceof qp?QV(n,t):(function(i,s){const o=KV(i,s),l=DR(o)+DR(i.Ae);return wx(o)&&wx(i.Ae)?YV(l):I1(i.serializer,l)})(n,t)}function IG(n,t,e){return n instanceof $p?XV(n,t):n instanceof qp?QV(n,t):e}function KV(n,t){return n instanceof cv?(function(r){return wx(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(t)?t:{integerValue:0}:null}class Hp extends zb{}class $p extends zb{constructor(t){super(),this.elements=t}}function XV(n,t){const e=JV(t);for(const r of n.elements)e.some((i=>to(i,r)))||e.push(r);return{arrayValue:{values:e}}}class qp extends zb{constructor(t){super(),this.elements=t}}function QV(n,t){let e=JV(t);for(const r of n.elements)e=e.filter((i=>!to(i,r)));return{arrayValue:{values:e}}}class cv extends zb{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function DR(n){return sn(n.integerValue||n.doubleValue)}function JV(n){return M1(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class PG{constructor(t,e){this.field=t,this.transform=e}}function NG(n,t){return n.field.isEqual(t.field)&&(function(r,i){return r instanceof $p&&i instanceof $p||r instanceof qp&&i instanceof qp?Hh(r.elements,i.elements,to):r instanceof cv&&i instanceof cv?to(r.Ae,i.Ae):r instanceof Hp&&i instanceof Hp})(n.transform,t.transform)}class LG{constructor(t,e){this.version=t,this.transformResults=e}}class vr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new vr}static exists(t){return new vr(void 0,t)}static updateTime(t){return new vr(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function A0(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class Hb{}function ZV(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new P1(n.key,vr.none()):new Am(n.key,n.data,vr.none());{const e=n.data,r=yr.empty();let i=new An(Qn.comparator);for(let s of t.fields)if(!i.has(s)){let o=e.field(s);o===null&&s.length>1&&(s=s.popLast(),o=e.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Vl(n.key,r,new ti(i.toArray()),vr.none())}}function VG(n,t,e){n instanceof Am?(function(i,s,o){const l=i.value.clone(),u=RR(i.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(n,t,e):n instanceof Vl?(function(i,s,o){if(!A0(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=RR(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(tj(i)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,t,e):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,t,e)}function fp(n,t,e,r){return n instanceof Am?(function(s,o,l,u){if(!A0(s.precondition,o))return l;const h=s.value.clone(),d=IR(s.fieldTransforms,u,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,t,e,r):n instanceof Vl?(function(s,o,l,u){if(!A0(s.precondition,o))return l;const h=IR(s.fieldTransforms,u,o),d=o.data;return d.setAll(tj(s)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((p=>p.field)))})(n,t,e,r):(function(s,o,l){return A0(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l})(n,t,e)}function jG(n,t){let e=null;for(const r of n.fieldTransforms){const i=t.data.field(r.field),s=KV(r.transform,i||null);s!=null&&(e===null&&(e=yr.empty()),e.set(r.field,s))}return e||null}function OR(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Hh(r,i,((s,o)=>NG(s,o)))})(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class Am extends Hb{constructor(t,e,r,i=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Vl extends Hb{constructor(t,e,r,i,s=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function tj(n){const t=new Map;return n.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}})),t}function RR(n,t,e){const r=new Map;ie(n.length===e.length,32656,{Ve:e.length,de:n.length});for(let i=0;i<e.length;i++){const s=n[i],o=s.transform,l=t.data.field(s.field);r.set(s.field,IG(o,l,e[i]))}return r}function IR(n,t,e){const r=new Map;for(const i of n){const s=i.transform,o=e.data.field(i.field);r.set(i.field,RG(s,o,t))}return r}class P1 extends Hb{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ej extends Hb{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class FG{constructor(t,e,r,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(t.key)&&VG(s,t,r[i])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=fp(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=fp(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=GV();return this.mutations.forEach((i=>{const s=t.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=e.has(i.key)?null:l;const u=ZV(o,l);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Nt.min())})),r}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),te())}isEqual(t){return this.batchId===t.batchId&&Hh(this.mutations,t.mutations,((e,r)=>OR(e,r)))&&Hh(this.baseMutations,t.baseMutations,((e,r)=>OR(e,r)))}}class N1{constructor(t,e,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=i}static from(t,e,r){ie(t.mutations.length===r.length,58842,{me:t.mutations.length,fe:r.length});let i=(function(){return AG})();const s=t.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new N1(t,e,r,i)}}class BG{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class UG{constructor(t,e){this.count=t,this.unchangedNames=e}}var yn,re;function nj(n){switch(n){case it.OK:return Rt(64938);case it.CANCELLED:case it.UNKNOWN:case it.DEADLINE_EXCEEDED:case it.RESOURCE_EXHAUSTED:case it.INTERNAL:case it.UNAVAILABLE:case it.UNAUTHENTICATED:return!1;case it.INVALID_ARGUMENT:case it.NOT_FOUND:case it.ALREADY_EXISTS:case it.PERMISSION_DENIED:case it.FAILED_PRECONDITION:case it.ABORTED:case it.OUT_OF_RANGE:case it.UNIMPLEMENTED:case it.DATA_LOSS:return!0;default:return Rt(15467,{code:n})}}function rj(n){if(n===void 0)return Xo("GRPC error has no .code"),it.UNKNOWN;switch(n){case yn.OK:return it.OK;case yn.CANCELLED:return it.CANCELLED;case yn.UNKNOWN:return it.UNKNOWN;case yn.DEADLINE_EXCEEDED:return it.DEADLINE_EXCEEDED;case yn.RESOURCE_EXHAUSTED:return it.RESOURCE_EXHAUSTED;case yn.INTERNAL:return it.INTERNAL;case yn.UNAVAILABLE:return it.UNAVAILABLE;case yn.UNAUTHENTICATED:return it.UNAUTHENTICATED;case yn.INVALID_ARGUMENT:return it.INVALID_ARGUMENT;case yn.NOT_FOUND:return it.NOT_FOUND;case yn.ALREADY_EXISTS:return it.ALREADY_EXISTS;case yn.PERMISSION_DENIED:return it.PERMISSION_DENIED;case yn.FAILED_PRECONDITION:return it.FAILED_PRECONDITION;case yn.ABORTED:return it.ABORTED;case yn.OUT_OF_RANGE:return it.OUT_OF_RANGE;case yn.UNIMPLEMENTED:return it.UNIMPLEMENTED;case yn.DATA_LOSS:return it.DATA_LOSS;default:return Rt(39323,{code:n})}}(re=yn||(yn={}))[re.OK=0]="OK",re[re.CANCELLED=1]="CANCELLED",re[re.UNKNOWN=2]="UNKNOWN",re[re.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",re[re.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",re[re.NOT_FOUND=5]="NOT_FOUND",re[re.ALREADY_EXISTS=6]="ALREADY_EXISTS",re[re.PERMISSION_DENIED=7]="PERMISSION_DENIED",re[re.UNAUTHENTICATED=16]="UNAUTHENTICATED",re[re.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",re[re.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",re[re.ABORTED=10]="ABORTED",re[re.OUT_OF_RANGE=11]="OUT_OF_RANGE",re[re.UNIMPLEMENTED=12]="UNIMPLEMENTED",re[re.INTERNAL=13]="INTERNAL",re[re.UNAVAILABLE=14]="UNAVAILABLE",re[re.DATA_LOSS=15]="DATA_LOSS";function zG(){return new TextEncoder}const HG=new ul([4294967295,4294967295],0);function PR(n){const t=zG().encode(n),e=new gV;return e.update(t),new Uint8Array(e.digest())}function NR(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new ul([e,r],0),new ul([i,s],0)]}class L1{constructor(t,e,r){if(this.bitmap=t,this.padding=e,this.hashCount=r,e<0||e>=8)throw new Jd(`Invalid padding: ${e}`);if(r<0)throw new Jd(`Invalid hash count: ${r}`);if(t.length>0&&this.hashCount===0)throw new Jd(`Invalid hash count: ${r}`);if(t.length===0&&e!==0)throw new Jd(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=ul.fromNumber(this.ge)}ye(t,e,r){let i=t.add(e.multiply(ul.fromNumber(r)));return i.compare(HG)===1&&(i=new ul([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=PR(t),[r,i]=NR(e);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(t,e,r){const i=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new L1(s,i,e);return r.forEach((l=>o.insert(l))),o}insert(t){if(this.ge===0)return;const e=PR(t),[r,i]=NR(e);for(let s=0;s<this.hashCount;s++){const o=this.ye(r,i,s);this.be(o)}}be(t){const e=Math.floor(t/8),r=t%8;this.bitmap[e]|=1<<r}}class Jd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class $b{constructor(t,e,r,i,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const i=new Map;return i.set(t,km.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new $b(Nt.min(),i,new He(Zt),Qo(),te())}}class km{constructor(t,e,r,i,s){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new km(r,e,te(),te(),te())}}class k0{constructor(t,e,r,i){this.Se=t,this.removedTargetIds=e,this.key=r,this.De=i}}class ij{constructor(t,e){this.targetId=t,this.Ce=e}}class sj{constructor(t,e,r=tr.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=i}}class LR{constructor(){this.ve=0,this.Fe=VR(),this.Me=tr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=te(),e=te(),r=te();return this.Fe.forEach(((i,s)=>{switch(s){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:r=r.add(i);break;default:Rt(38017,{changeType:s})}})),new km(this.Me,this.xe,t,e,r)}Ke(){this.Oe=!1,this.Fe=VR()}qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}Ue(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}$e(){this.ve+=1}We(){this.ve-=1,ie(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class $G{constructor(t){this.Ge=t,this.ze=new Map,this.je=Qo(),this.He=Ey(),this.Je=Ey(),this.Ze=new He(Zt)}Xe(t){for(const e of t.Se)t.De&&t.De.isFoundDocument()?this.Ye(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const r=this.nt(e);switch(t.state){case 0:this.rt(e)&&r.Le(t.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(t.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(r.Qe(),r.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),r.Le(t.resumeToken));break;default:Rt(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((r,i)=>{this.rt(i)&&e(i)}))}st(t){const e=t.targetId,r=t.Ce.count,i=this.ot(e);if(i){const s=i.target;if(Ex(s))if(r===0){const o=new At(s.path);this.et(e,o,Nn.newNoDocument(o,Nt.min()))}else ie(r===1,20013,{expectedCount:r});else{const o=this._t(e);if(o!==r){const l=this.ut(t),u=l?this.ct(l,t,o):1;if(u!==0){this.it(e);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(e,h)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=e;let o,l;try{o=_l(r).toUint8Array()}catch(u){if(u instanceof kV)return ru("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new L1(o,i,s)}catch(u){return ru(u instanceof Jd?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(t,e,r){return e.Ce.count===r-this.Pt(t,e.targetId)?0:2}Pt(t,e){const r=this.Ge.getRemoteKeysForTarget(e);let i=0;return r.forEach((s=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(l)||(this.et(e,s,null),i++)})),i}Tt(t){const e=new Map;this.ze.forEach(((s,o)=>{const l=this.ot(o);if(l){if(s.current&&Ex(l.target)){const u=new At(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Nn.newNoDocument(u,t))}s.Be&&(e.set(o,s.ke()),s.Ke())}}));let r=te();this.Je.forEach(((s,o)=>{let l=!0;o.forEachWhile((u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(r=r.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(t)));const i=new $b(t,e,this.Ze,this.je,r);return this.je=Qo(),this.He=Ey(),this.Je=Ey(),this.Ze=new He(Zt),i}Ye(t,e){if(!this.rt(t))return;const r=this.Et(t,e.key)?2:0;this.nt(t).qe(e.key,r),this.je=this.je.insert(e.key,e),this.He=this.He.insert(e.key,this.It(e.key).add(t)),this.Je=this.Je.insert(e.key,this.Rt(e.key).add(t))}et(t,e,r){if(!this.rt(t))return;const i=this.nt(t);this.Et(t,e)?i.qe(e,1):i.Ue(e),this.Je=this.Je.insert(e,this.Rt(e).delete(t)),this.Je=this.Je.insert(e,this.Rt(e).add(t)),r&&(this.je=this.je.insert(e,r))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}$e(t){this.nt(t).$e()}nt(t){let e=this.ze.get(t);return e||(e=new LR,this.ze.set(t,e)),e}Rt(t){let e=this.Je.get(t);return e||(e=new An(Zt),this.Je=this.Je.insert(t,e)),e}It(t){let e=this.He.get(t);return e||(e=new An(Zt),this.He=this.He.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||bt("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new LR),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function Ey(){return new He(At.comparator)}function VR(){return new He(At.comparator)}const qG={asc:"ASCENDING",desc:"DESCENDING"},WG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GG={and:"AND",or:"OR"};class YG{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Ax(n,t){return n.useProto3Json||Cm(t)?t:{value:t}}function uv(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function oj(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function KG(n,t){return uv(n,t.toTimestamp())}function ri(n){return ie(!!n,49232),Nt.fromTimestamp((function(e){const r=bl(e);return new ue(r.seconds,r.nanos)})(n))}function V1(n,t){return kx(n,t).canonicalString()}function kx(n,t){const e=(function(i){return new Ee(["projects",i.projectId,"databases",i.database])})(n).child("documents");return t===void 0?e:e.child(t)}function aj(n){const t=Ee.fromString(n);return ie(dj(t),10190,{key:t.toString()}),t}function hv(n,t){return V1(n.databaseId,t.path)}function dp(n,t){const e=aj(t);if(e.get(1)!==n.databaseId.projectId)throw new gt(it.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new gt(it.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new At(cj(e))}function lj(n,t){return V1(n.databaseId,t)}function XG(n){const t=aj(n);return t.length===4?Ee.emptyPath():cj(t)}function Mx(n){return new Ee(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function cj(n){return ie(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function jR(n,t,e){return{name:hv(n,t),fields:e.value.mapValue.fields}}function QG(n,t){return"found"in t?(function(r,i){ie(!!i.found,43571),i.found.name,i.found.updateTime;const s=dp(r,i.found.name),o=ri(i.found.updateTime),l=i.found.createTime?ri(i.found.createTime):Nt.min(),u=new yr({mapValue:{fields:i.found.fields}});return Nn.newFoundDocument(s,o,l,u)})(n,t):"missing"in t?(function(r,i){ie(!!i.missing,3894),ie(!!i.readTime,22933);const s=dp(r,i.missing),o=ri(i.readTime);return Nn.newNoDocument(s,o)})(n,t):Rt(7234,{result:t})}function JG(n,t){let e;if("targetChange"in t){t.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Rt(39313,{state:h})})(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=(function(h,d){return h.useProto3Json?(ie(d===void 0||typeof d=="string",58123),tr.fromBase64String(d||"")):(ie(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),tr.fromUint8Array(d||new Uint8Array))})(n,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&(function(h){const d=h.code===void 0?it.UNKNOWN:rj(h.code);return new gt(d,h.message||"")})(o);e=new sj(r,i,s,l||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=dp(n,r.document.name),s=ri(r.document.updateTime),o=r.document.createTime?ri(r.document.createTime):Nt.min(),l=new yr({mapValue:{fields:r.document.fields}}),u=Nn.newFoundDocument(i,s,o,l),h=r.targetIds||[],d=r.removedTargetIds||[];e=new k0(h,d,u.key,u)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=dp(n,r.document),s=r.readTime?ri(r.readTime):Nt.min(),o=Nn.newNoDocument(i,s),l=r.removedTargetIds||[];e=new k0([],l,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=dp(n,r.document),s=r.removedTargetIds||[];e=new k0([],s,i,null)}else{if(!("filter"in t))return Rt(11601,{Vt:t});{t.filter;const r=t.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new UG(i,s),l=r.targetId;e=new ij(l,o)}}return e}function uj(n,t){let e;if(t instanceof Am)e={update:jR(n,t.key,t.value)};else if(t instanceof P1)e={delete:hv(n,t.key)};else if(t instanceof Vl)e={update:jR(n,t.key,t.data),updateMask:a7(t.fieldMask)};else{if(!(t instanceof ej))return Rt(16599,{dt:t.type});e={verify:hv(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((r=>(function(s,o){const l=o.transform;if(l instanceof Hp)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof $p)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof qp)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof cv)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw Rt(20930,{transform:o.transform})})(0,r)))),t.precondition.isNone||(e.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:KG(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Rt(27497)})(n,t.precondition)),e}function ZG(n,t){return n&&n.length>0?(ie(t!==void 0,14353),n.map((e=>(function(i,s){let o=i.updateTime?ri(i.updateTime):ri(s);return o.isEqual(Nt.min())&&(o=ri(s)),new LG(o,i.transformResults||[])})(e,t)))):[]}function t7(n,t){return{documents:[lj(n,t.path)]}}function e7(n,t){const e={structuredQuery:{}},r=t.path;let i;t.collectionGroup!==null?(i=r,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),e.structuredQuery.from=[{collectionId:r.lastSegment()}]),e.parent=lj(n,i);const s=(function(h){if(h.length!==0)return fj(fs.create(h,"and"))})(t.filters);s&&(e.structuredQuery.where=s);const o=(function(h){if(h.length!==0)return h.map((d=>(function(g){return{field:ph(g.field),direction:i7(g.dir)}})(d)))})(t.orderBy);o&&(e.structuredQuery.orderBy=o);const l=Ax(n,t.limit);return l!==null&&(e.structuredQuery.limit=l),t.startAt&&(e.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(t.endAt)),{ft:e,parent:i}}function n7(n){let t=XG(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let i=null;if(r>0){ie(r===1,65062);const d=e.from[0];d.allDescendants?i=d.collectionId:t=t.child(d.collectionId)}let s=[];e.where&&(s=(function(p){const g=hj(p);return g instanceof fs&&jV(g)?g.getFilters():[g]})(e.where));let o=[];e.orderBy&&(o=(function(p){return p.map((g=>(function(T){return new zp(mh(T.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(g)))})(e.orderBy));let l=null;e.limit&&(l=(function(p){let g;return g=typeof p=="object"?p.value:p,Cm(g)?null:g})(e.limit));let u=null;e.startAt&&(u=(function(p){const g=!!p.before,v=p.values||[];return new av(v,g)})(e.startAt));let h=null;return e.endAt&&(h=(function(p){const g=!p.before,v=p.values||[];return new av(v,g)})(e.endAt)),_G(t,i,o,s,l,"F",u,h)}function r7(n,t){const e=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Rt(28987,{purpose:i})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function hj(n){return n.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const r=mh(e.unaryFilter.field);return bn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=mh(e.unaryFilter.field);return bn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=mh(e.unaryFilter.field);return bn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=mh(e.unaryFilter.field);return bn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Rt(61313);default:return Rt(60726)}})(n):n.fieldFilter!==void 0?(function(e){return bn.create(mh(e.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Rt(58110);default:return Rt(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(e){return fs.create(e.compositeFilter.filters.map((r=>hj(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Rt(1026)}})(e.compositeFilter.op))})(n):Rt(30097,{filter:n})}function i7(n){return qG[n]}function s7(n){return WG[n]}function o7(n){return GG[n]}function ph(n){return{fieldPath:n.canonicalString()}}function mh(n){return Qn.fromServerFormat(n.fieldPath)}function fj(n){return n instanceof bn?(function(e){if(e.op==="=="){if(ER(e.value))return{unaryFilter:{field:ph(e.field),op:"IS_NAN"}};if(xR(e.value))return{unaryFilter:{field:ph(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(ER(e.value))return{unaryFilter:{field:ph(e.field),op:"IS_NOT_NAN"}};if(xR(e.value))return{unaryFilter:{field:ph(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ph(e.field),op:s7(e.op),value:e.value}}})(n):n instanceof fs?(function(e){const r=e.getFilters().map((i=>fj(i)));return r.length===1?r[0]:{compositeFilter:{op:o7(e.op),filters:r}}})(n):Rt(54877,{filter:n})}function a7(n){const t=[];return n.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function dj(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function pj(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class rl{constructor(t,e,r,i,s=Nt.min(),o=Nt.min(),l=tr.EMPTY_BYTE_STRING,u=null){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(t){return new rl(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new rl(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new rl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new rl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class l7{constructor(t){this.yt=t}}function c7(n){const t=n7({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?lv(t,t.limit,"L"):t}class u7{constructor(){this.Sn=new h7}addToCollectionParentIndex(t,e){return this.Sn.add(e),ct.resolve()}getCollectionParents(t,e){return ct.resolve(this.Sn.getEntries(e))}addFieldIndex(t,e){return ct.resolve()}deleteFieldIndex(t,e){return ct.resolve()}deleteAllFieldIndexes(t){return ct.resolve()}createTargetIndexes(t,e){return ct.resolve()}getDocumentsMatchingTarget(t,e){return ct.resolve(null)}getIndexType(t,e){return ct.resolve(0)}getFieldIndexes(t,e){return ct.resolve([])}getNextCollectionGroupToUpdate(t){return ct.resolve(null)}getMinOffset(t,e){return ct.resolve(vl.min())}getMinOffsetFromCollectionGroup(t,e){return ct.resolve(vl.min())}updateCollectionGroup(t,e,r){return ct.resolve()}updateIndexEntries(t,e){return ct.resolve()}}class h7{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),i=this.index[e]||new An(Ee.comparator),s=!i.has(r);return this.index[e]=i.add(r),s}has(t){const e=t.lastSegment(),r=t.popLast(),i=this.index[e];return i&&i.has(r)}getEntries(t){return(this.index[t]||new An(Ee.comparator)).toArray()}}const FR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mj=41943040;class Pr{static withCacheSize(t){return new Pr(t,Pr.DEFAULT_COLLECTION_PERCENTILE,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}}Pr.DEFAULT_COLLECTION_PERCENTILE=10,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pr.DEFAULT=new Pr(mj,Pr.DEFAULT_COLLECTION_PERCENTILE,Pr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pr.DISABLED=new Pr(-1,0,0);class Wh{constructor(t){this.sr=t}next(){return this.sr+=2,this.sr}static _r(){return new Wh(0)}static ar(){return new Wh(-1)}}const BR="LruGarbageCollector",f7=1048576;function UR([n,t],[e,r]){const i=Zt(n,e);return i===0?Zt(t,r):i}class d7{constructor(t){this.Pr=t,this.buffer=new An(UR),this.Tr=0}Ir(){return++this.Tr}Er(t){const e=[t,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(e);else{const r=this.buffer.last();UR(e,r)<0&&(this.buffer=this.buffer.delete(r).add(e))}}get maxValue(){return this.buffer.last()[0]}}class p7{constructor(t,e,r){this.garbageCollector=t,this.asyncQueue=e,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(t){bt(BR,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){df(e)?bt(BR,"Ignoring IndexedDB error during garbage collection: ",e):await ff(e)}await this.Ar(3e5)}))}}class m7{constructor(t,e){this.Vr=t,this.params=e}calculateTargetCount(t,e){return this.Vr.dr(t).next((r=>Math.floor(e/100*r)))}nthSequenceNumber(t,e){if(e===0)return ct.resolve(jb.ce);const r=new d7(e);return this.Vr.forEachTarget(t,(i=>r.Er(i.sequenceNumber))).next((()=>this.Vr.mr(t,(i=>r.Er(i))))).next((()=>r.maxValue))}removeTargets(t,e,r){return this.Vr.removeTargets(t,e,r)}removeOrphanedDocuments(t,e){return this.Vr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(bt("LruGarbageCollector","Garbage collection skipped; disabled"),ct.resolve(FR)):this.getCacheSize(t).next((r=>r<this.params.cacheSizeCollectionThreshold?(bt("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),FR):this.gr(t,e)))}getCacheSize(t){return this.Vr.getCacheSize(t)}gr(t,e){let r,i,s,o,l,u,h;const d=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((p=>(p>this.params.maximumSequenceNumbersToCollect?(bt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(t,i)))).next((p=>(r=p,l=Date.now(),this.removeTargets(t,r,e)))).next((p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(t,r)))).next((p=>(h=Date.now(),fh()<=Jt.DEBUG&&bt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(h-u)+`ms
Total Duration: ${h-d}ms`),ct.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p}))))}}function g7(n,t){return new m7(n,t)}class y7{constructor(){this.changes=new mu((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Nn.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return r!==void 0?ct.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class v7{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class b7{constructor(t,e,r,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=i}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(r=i,this.remoteDocumentCache.getEntry(t,e)))).next((i=>(r!==null&&fp(r.mutation,i,ti.empty(),ue.now()),i)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((r=>this.getLocalViewOfDocuments(t,r,te()).next((()=>r))))}getLocalViewOfDocuments(t,e,r=te()){const i=Pc();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,r).next((s=>{let o=Qd();return s.forEach(((l,u)=>{o=o.insert(l,u.overlayedDocument)})),o}))))}getOverlayedDocuments(t,e){const r=Pc();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,te())))}populateOverlays(t,e,r){const i=[];return r.forEach((s=>{e.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(t,i).next((s=>{s.forEach(((o,l)=>{e.set(o,l)}))}))}computeViews(t,e,r,i){let s=Qo();const o=hp(),l=(function(){return hp()})();return e.forEach(((u,h)=>{const d=r.get(h.key);i.has(h.key)&&(d===void 0||d.mutation instanceof Vl)?s=s.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),fp(d.mutation,h,d.mutation.getFieldMask(),ue.now())):o.set(h.key,ti.empty())})),this.recalculateAndSaveOverlays(t,s).next((u=>(u.forEach(((h,d)=>o.set(h,d))),e.forEach(((h,d)=>l.set(h,new v7(d,o.get(h)??null)))),l)))}recalculateAndSaveOverlays(t,e){const r=hp();let i=new He(((o,l)=>o-l)),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((o=>{for(const l of o)l.keys().forEach((u=>{const h=e.get(u);if(h===null)return;let d=r.get(u)||ti.empty();d=l.applyToLocalView(h,d),r.set(u,d);const p=(i.get(l.batchId)||te()).add(u);i=i.insert(l.batchId,p)}))})).next((()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),h=u.key,d=u.value,p=GV();d.forEach((g=>{if(!s.has(g)){const v=ZV(e.get(g),r.get(g));v!==null&&p.set(g,v),s=s.add(g)}})),o.push(this.documentOverlayCache.saveOverlays(t,h,p))}return ct.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((r=>this.recalculateAndSaveOverlays(t,r)))}getDocumentsMatchingQuery(t,e,r,i){return TG(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):zV(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r,i):this.getDocumentsMatchingCollectionQuery(t,e,r,i)}getNextDocuments(t,e,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,i).next((s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,i-s.size):ct.resolve(Pc());let l=jp,u=s;return o.next((h=>ct.forEach(h,((d,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(d)?ct.resolve():this.remoteDocumentCache.getEntry(t,d).next((g=>{u=u.insert(d,g)}))))).next((()=>this.populateOverlays(t,h,s))).next((()=>this.computeViews(t,u,h,te()))).next((d=>({batchId:l,changes:WV(d)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new At(e)).next((r=>{let i=Qd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(t,e,r,i){const s=e.collectionGroup;let o=Qd();return this.indexManager.getCollectionParents(t,s).next((l=>ct.forEach(l,(u=>{const h=(function(p,g){return new pf(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(e,u.child(s));return this.getDocumentsMatchingCollectionQuery(t,h,r,i).next((d=>{d.forEach(((p,g)=>{o=o.insert(p,g)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(t,e,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,r,s,i)))).next((o=>{s.forEach(((u,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Nn.newInvalidDocument(d)))}));let l=Qd();return o.forEach(((u,h)=>{const d=s.get(u);d!==void 0&&fp(d.mutation,h,ti.empty(),ue.now()),Ub(e,h)&&(l=l.insert(u,h))})),l}))}}class _7{constructor(t){this.serializer=t,this.Nr=new Map,this.Br=new Map}getBundleMetadata(t,e){return ct.resolve(this.Nr.get(e))}saveBundleMetadata(t,e){return this.Nr.set(e.id,(function(i){return{id:i.id,version:i.version,createTime:ri(i.createTime)}})(e)),ct.resolve()}getNamedQuery(t,e){return ct.resolve(this.Br.get(e))}saveNamedQuery(t,e){return this.Br.set(e.name,(function(i){return{name:i.name,query:c7(i.bundledQuery),readTime:ri(i.readTime)}})(e)),ct.resolve()}}class T7{constructor(){this.overlays=new He(At.comparator),this.Lr=new Map}getOverlay(t,e){return ct.resolve(this.overlays.get(e))}getOverlays(t,e){const r=Pc();return ct.forEach(e,(i=>this.getOverlay(t,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(t,e,r){return r.forEach(((i,s)=>{this.bt(t,e,s)})),ct.resolve()}removeOverlaysForBatchId(t,e,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.Lr.delete(r)),ct.resolve()}getOverlaysForCollection(t,e,r){const i=Pc(),s=e.length+1,o=new At(e.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,h=u.getKey();if(!e.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return ct.resolve(i)}getOverlaysForCollectionGroup(t,e,r,i){let s=new He(((h,d)=>h-d));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===e&&h.largestBatchId>r){let d=s.get(h.largestBatchId);d===null&&(d=Pc(),s=s.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const l=Pc(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,d)=>l.set(h,d))),!(l.size()>=i)););return ct.resolve(l)}bt(t,e,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new BG(e,r));let s=this.Lr.get(e);s===void 0&&(s=te(),this.Lr.set(e,s)),this.Lr.set(e,s.add(r.key))}}class S7{constructor(){this.sessionToken=tr.EMPTY_BYTE_STRING}getSessionToken(t){return ct.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,ct.resolve()}}class j1{constructor(){this.kr=new An(Pn.Kr),this.qr=new An(Pn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(t,e){const r=new Pn(t,e);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(t,e){t.forEach((r=>this.addReference(r,e)))}removeReference(t,e){this.Wr(new Pn(t,e))}Qr(t,e){t.forEach((r=>this.removeReference(r,e)))}Gr(t){const e=new At(new Ee([])),r=new Pn(e,t),i=new Pn(e,t+1),s=[];return this.qr.forEachInRange([r,i],(o=>{this.Wr(o),s.push(o.key)})),s}zr(){this.kr.forEach((t=>this.Wr(t)))}Wr(t){this.kr=this.kr.delete(t),this.qr=this.qr.delete(t)}jr(t){const e=new At(new Ee([])),r=new Pn(e,t),i=new Pn(e,t+1);let s=te();return this.qr.forEachInRange([r,i],(o=>{s=s.add(o.key)})),s}containsKey(t){const e=new Pn(t,0),r=this.kr.firstAfterOrEqual(e);return r!==null&&t.isEqual(r.key)}}class Pn{constructor(t,e){this.key=t,this.Hr=e}static Kr(t,e){return At.comparator(t.key,e.key)||Zt(t.Hr,e.Hr)}static Ur(t,e){return Zt(t.Hr,e.Hr)||At.comparator(t.key,e.key)}}class w7{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.Yn=1,this.Jr=new An(Pn.Kr)}checkEmpty(t){return ct.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,r,i){const s=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new FG(s,e,r,i);this.mutationQueue.push(o);for(const l of i)this.Jr=this.Jr.add(new Pn(l.key,s)),this.indexManager.addToCollectionParentIndex(t,l.key.path.popLast());return ct.resolve(o)}lookupMutationBatch(t,e){return ct.resolve(this.Zr(e))}getNextMutationBatchAfterBatchId(t,e){const r=e+1,i=this.Xr(r),s=i<0?0:i;return ct.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ct.resolve(this.mutationQueue.length===0?A1:this.Yn-1)}getAllMutationBatches(t){return ct.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new Pn(e,0),i=new Pn(e,Number.POSITIVE_INFINITY),s=[];return this.Jr.forEachInRange([r,i],(o=>{const l=this.Zr(o.Hr);s.push(l)})),ct.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new An(Zt);return e.forEach((i=>{const s=new Pn(i,0),o=new Pn(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([s,o],(l=>{r=r.add(l.Hr)}))})),ct.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,i=r.length+1;let s=r;At.isDocumentKey(s)||(s=s.child(""));const o=new Pn(new At(s),0);let l=new An(Zt);return this.Jr.forEachWhile((u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(l=l.add(u.Hr)),!0)}),o),ct.resolve(this.Yr(l))}Yr(t){const e=[];return t.forEach((r=>{const i=this.Zr(r);i!==null&&e.push(i)})),e}removeMutationBatch(t,e){ie(this.ei(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return ct.forEach(e.mutations,(i=>{const s=new Pn(i.key,e.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.Jr=r}))}nr(t){}containsKey(t,e){const r=new Pn(e,0),i=this.Jr.firstAfterOrEqual(r);return ct.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,ct.resolve()}ei(t,e){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const e=this.Xr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class x7{constructor(t){this.ti=t,this.docs=(function(){return new He(At.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,i=this.docs.get(r),s=i?i.size:0,o=this.ti(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return ct.resolve(r?r.document.mutableCopy():Nn.newInvalidDocument(e))}getEntries(t,e){let r=Qo();return e.forEach((i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Nn.newInvalidDocument(i))})),ct.resolve(r)}getDocumentsMatchingQuery(t,e,r,i){let s=Qo();const o=e.path,l=new At(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:h,value:{document:d}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||QW(XW(d),r)<=0||(i.has(d.key)||Ub(e,d))&&(s=s.insert(d.key,d.mutableCopy()))}return ct.resolve(s)}getAllFromCollectionGroup(t,e,r,i){Rt(9500)}ni(t,e){return ct.forEach(this.docs,(r=>e(r)))}newChangeBuffer(t){return new E7(this)}getSize(t){return ct.resolve(this.size)}}class E7 extends y7{constructor(t){super(),this.Mr=t}applyChanges(t){const e=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?e.push(this.Mr.addEntry(t,i)):this.Mr.removeEntry(r)})),ct.waitFor(e)}getFromCache(t,e){return this.Mr.getEntry(t,e)}getAllFromCache(t,e){return this.Mr.getEntries(t,e)}}class C7{constructor(t){this.persistence=t,this.ri=new mu((e=>D1(e)),O1),this.lastRemoteSnapshotVersion=Nt.min(),this.highestTargetId=0,this.ii=0,this.si=new j1,this.targetCount=0,this.oi=Wh._r()}forEachTarget(t,e){return this.ri.forEach(((r,i)=>e(i))),ct.resolve()}getLastRemoteSnapshotVersion(t){return ct.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ct.resolve(this.ii)}allocateTargetId(t){return this.highestTargetId=this.oi.next(),ct.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.ii&&(this.ii=e),ct.resolve()}lr(t){this.ri.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.oi=new Wh(e),this.highestTargetId=e),t.sequenceNumber>this.ii&&(this.ii=t.sequenceNumber)}addTargetData(t,e){return this.lr(e),this.targetCount+=1,ct.resolve()}updateTargetData(t,e){return this.lr(e),ct.resolve()}removeTargetData(t,e){return this.ri.delete(e.target),this.si.Gr(e.targetId),this.targetCount-=1,ct.resolve()}removeTargets(t,e,r){let i=0;const s=[];return this.ri.forEach(((o,l)=>{l.sequenceNumber<=e&&r.get(l.targetId)===null&&(this.ri.delete(o),s.push(this.removeMatchingKeysForTargetId(t,l.targetId)),i++)})),ct.waitFor(s).next((()=>i))}getTargetCount(t){return ct.resolve(this.targetCount)}getTargetData(t,e){const r=this.ri.get(e)||null;return ct.resolve(r)}addMatchingKeys(t,e,r){return this.si.$r(e,r),ct.resolve()}removeMatchingKeys(t,e,r){this.si.Qr(e,r);const i=this.persistence.referenceDelegate,s=[];return i&&e.forEach((o=>{s.push(i.markPotentiallyOrphaned(t,o))})),ct.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.si.Gr(e),ct.resolve()}getMatchingKeysForTargetId(t,e){const r=this.si.jr(e);return ct.resolve(r)}containsKey(t,e){return ct.resolve(this.si.containsKey(e))}}class gj{constructor(t,e){this._i={},this.overlays={},this.ai=new jb(0),this.ui=!1,this.ui=!0,this.ci=new S7,this.referenceDelegate=t(this),this.li=new C7(this),this.indexManager=new u7,this.remoteDocumentCache=(function(i){return new x7(i)})((r=>this.referenceDelegate.hi(r))),this.serializer=new l7(e),this.Pi=new _7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new T7,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this._i[t.toKey()];return r||(r=new w7(e,this.referenceDelegate),this._i[t.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(t,e,r){bt("MemoryPersistence","Starting transaction:",t);const i=new A7(this.ai.next());return this.referenceDelegate.Ti(),r(i).next((s=>this.referenceDelegate.Ii(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ei(t,e){return ct.or(Object.values(this._i).map((r=>()=>r.containsKey(t,e))))}}class A7 extends ZW{constructor(t){super(),this.currentSequenceNumber=t}}class F1{constructor(t){this.persistence=t,this.Ri=new j1,this.Ai=null}static Vi(t){return new F1(t)}get di(){if(this.Ai)return this.Ai;throw Rt(60996)}addReference(t,e,r){return this.Ri.addReference(r,e),this.di.delete(r.toString()),ct.resolve()}removeReference(t,e,r){return this.Ri.removeReference(r,e),this.di.add(r.toString()),ct.resolve()}markPotentiallyOrphaned(t,e){return this.di.add(e.toString()),ct.resolve()}removeTarget(t,e){this.Ri.Gr(e.targetId).forEach((i=>this.di.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((i=>{i.forEach((s=>this.di.add(s.toString())))})).next((()=>r.removeTargetData(t,e)))}Ti(){this.Ai=new Set}Ii(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ct.forEach(this.di,(r=>{const i=At.fromPath(r);return this.mi(t,i).next((s=>{s||e.removeEntry(i,Nt.min())}))})).next((()=>(this.Ai=null,e.apply(t))))}updateLimboDocument(t,e){return this.mi(t,e).next((r=>{r?this.di.delete(e.toString()):this.di.add(e.toString())}))}hi(t){return 0}mi(t,e){return ct.or([()=>ct.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ei(t,e)])}}class fv{constructor(t,e){this.persistence=t,this.fi=new mu((r=>nG(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=g7(this,e)}static Vi(t,e){return new fv(t,e)}Ti(){}Ii(t){return ct.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}dr(t){const e=this.pr(t);return this.persistence.getTargetCache().getTargetCount(t).next((r=>e.next((i=>r+i))))}pr(t){let e=0;return this.mr(t,(r=>{e++})).next((()=>e))}mr(t,e){return ct.forEach(this.fi,((r,i)=>this.wr(t,r,i).next((s=>s?ct.resolve():e(i)))))}removeTargets(t,e,r){return this.persistence.getTargetCache().removeTargets(t,e,r)}removeOrphanedDocuments(t,e){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ni(t,(o=>this.wr(t,o,e).next((l=>{l||(r++,s.removeEntry(o,Nt.min()))})))).next((()=>s.apply(t))).next((()=>r))}markPotentiallyOrphaned(t,e){return this.fi.set(e,t.currentSequenceNumber),ct.resolve()}removeTarget(t,e){const r=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,e,r){return this.fi.set(r,t.currentSequenceNumber),ct.resolve()}removeReference(t,e,r){return this.fi.set(r,t.currentSequenceNumber),ct.resolve()}updateLimboDocument(t,e){return this.fi.set(e,t.currentSequenceNumber),ct.resolve()}hi(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=E0(t.data.value)),e}wr(t,e,r){return ct.or([()=>this.persistence.Ei(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const i=this.fi.get(e);return ct.resolve(i!==void 0&&i>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class B1{constructor(t,e,r,i){this.targetId=t,this.fromCache=e,this.Ts=r,this.Is=i}static Es(t,e){let r=te(),i=te();for(const s of e.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new B1(t,e.fromCache,r,i)}}class k7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class M7{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return r$()?8:tG(ar())>0?6:4})()}initialize(t,e){this.fs=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,r,i){const s={result:null};return this.gs(t,e).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ps(t,e,i,r).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;const o=new k7;return this.ys(t,e,o).next((l=>{if(s.result=l,this.As)return this.ws(t,e,o,l.size)}))})).next((()=>s.result))}ws(t,e,r,i){return r.documentReadCount<this.Vs?(fh()<=Jt.DEBUG&&bt("QueryEngine","SDK will not create cache indexes for query:",dh(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ct.resolve()):(fh()<=Jt.DEBUG&&bt("QueryEngine","Query:",dh(e),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(fh()<=Jt.DEBUG&&bt("QueryEngine","The SDK decides to create cache indexes for query:",dh(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ks(e))):ct.resolve())}gs(t,e){if(MR(e))return ct.resolve(null);let r=Ks(e);return this.indexManager.getIndexType(t,r).next((i=>i===0?null:(e.limit!==null&&i===1&&(e=lv(e,null,"F"),r=Ks(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next((s=>{const o=te(...s);return this.fs.getDocuments(t,o).next((l=>this.indexManager.getMinOffset(t,r).next((u=>{const h=this.bs(e,l);return this.Ss(e,h,o,u.readTime)?this.gs(t,lv(e,null,"F")):this.Ds(t,h,e,u)}))))})))))}ps(t,e,r,i){return MR(e)||i.isEqual(Nt.min())?ct.resolve(null):this.fs.getDocuments(t,r).next((s=>{const o=this.bs(e,s);return this.Ss(e,o,r,i)?ct.resolve(null):(fh()<=Jt.DEBUG&&bt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),dh(e)),this.Ds(t,o,e,KW(i,jp)).next((l=>l)))}))}bs(t,e){let r=new An($V(t));return e.forEach(((i,s)=>{Ub(t,s)&&(r=r.add(s))})),r}Ss(t,e,r,i){if(t.limit===null)return!1;if(r.size!==e.size)return!0;const s=t.limitType==="F"?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ys(t,e,r){return fh()<=Jt.DEBUG&&bt("QueryEngine","Using full collection scan to execute query:",dh(e)),this.fs.getDocumentsMatchingQuery(t,e,vl.min(),r)}Ds(t,e,r,i){return this.fs.getDocumentsMatchingQuery(t,r,i).next((s=>(e.forEach((o=>{s=s.insert(o.key,o)})),s)))}}const U1="LocalStore",D7=3e8;class O7{constructor(t,e,r,i){this.persistence=t,this.Cs=e,this.serializer=i,this.vs=new He(Zt),this.Fs=new mu((s=>D1(s)),O1),this.Ms=new Map,this.xs=t.getRemoteDocumentCache(),this.li=t.getTargetCache(),this.Pi=t.getBundleCache(),this.Os(r)}Os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new b7(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.vs)))}}function R7(n,t,e,r){return new O7(n,t,e,r)}async function yj(n,t){const e=Ft(n);return await e.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return e.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,e.Os(t),e.mutationQueue.getAllMutationBatches(r)))).next((s=>{const o=[],l=[];let u=te();for(const h of i){o.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}for(const h of s){l.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}return e.localDocuments.getDocuments(r,u).next((h=>({Ns:h,removedBatchIds:o,addedBatchIds:l})))}))}))}function I7(n,t){const e=Ft(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=t.batch.keys(),s=e.xs.newChangeBuffer({trackRemovals:!0});return(function(l,u,h,d){const p=h.batch,g=p.keys();let v=ct.resolve();return g.forEach((T=>{v=v.next((()=>d.getEntry(u,T))).next((S=>{const w=h.docVersions.get(T);ie(w!==null,48541),S.version.compareTo(w)<0&&(p.applyToRemoteDocument(S,h),S.isValidDocument()&&(S.setReadTime(h.commitVersion),d.addEntry(S)))}))})),v.next((()=>l.mutationQueue.removeMutationBatch(u,p)))})(e,r,t,s).next((()=>s.apply(r))).next((()=>e.mutationQueue.performConsistencyCheck(r))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(r,i,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(l){let u=te();for(let h=0;h<l.mutationResults.length;++h)l.mutationResults[h].transformResults.length>0&&(u=u.add(l.batch.mutations[h].key));return u})(t)))).next((()=>e.localDocuments.getDocuments(r,i)))}))}function vj(n){const t=Ft(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.li.getLastRemoteSnapshotVersion(e)))}function P7(n,t){const e=Ft(n),r=t.snapshotVersion;let i=e.vs;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const o=e.xs.newChangeBuffer({trackRemovals:!0});i=e.vs;const l=[];t.targetChanges.forEach(((d,p)=>{const g=i.get(p);if(!g)return;l.push(e.li.removeMatchingKeys(s,d.removedDocuments,p).next((()=>e.li.addMatchingKeys(s,d.addedDocuments,p))));let v=g.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(p)!==null?v=v.withResumeToken(tr.EMPTY_BYTE_STRING,Nt.min()).withLastLimboFreeSnapshotVersion(Nt.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,r)),i=i.insert(p,v),(function(S,w,E){return S.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=D7?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0})(g,v,d)&&l.push(e.li.updateTargetData(s,v))}));let u=Qo(),h=te();if(t.documentUpdates.forEach((d=>{t.resolvedLimboDocuments.has(d)&&l.push(e.persistence.referenceDelegate.updateLimboDocument(s,d))})),l.push(N7(s,o,t.documentUpdates).next((d=>{u=d.Bs,h=d.Ls}))),!r.isEqual(Nt.min())){const d=e.li.getLastRemoteSnapshotVersion(s).next((p=>e.li.setTargetsMetadata(s,s.currentSequenceNumber,r)));l.push(d)}return ct.waitFor(l).next((()=>o.apply(s))).next((()=>e.localDocuments.getLocalViewOfDocuments(s,u,h))).next((()=>u))})).then((s=>(e.vs=i,s)))}function N7(n,t,e){let r=te(),i=te();return e.forEach((s=>r=r.add(s))),t.getEntries(n,r).next((s=>{let o=Qo();return e.forEach(((l,u)=>{const h=s.get(l);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(Nt.min())?(t.removeEntry(l,u.readTime),o=o.insert(l,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(l,u)):bt(U1,"Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",u.version)})),{Bs:o,Ls:i}}))}function L7(n,t){const e=Ft(n);return e.persistence.runTransaction("Get next mutation batch","readonly",(r=>(t===void 0&&(t=A1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t))))}function V7(n,t){const e=Ft(n);return e.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return e.li.getTargetData(r,t).next((s=>s?(i=s,ct.resolve(i)):e.li.allocateTargetId(r).next((o=>(i=new rl(t,o,"TargetPurposeListen",r.currentSequenceNumber),e.li.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=e.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(e.vs=e.vs.insert(r.targetId,r),e.Fs.set(t,r.targetId)),r}))}async function Dx(n,t,e){const r=Ft(n),i=r.vs.get(t),s=e?"readwrite":"readwrite-primary";try{e||await r.persistence.runTransaction("Release target",s,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!df(o))throw o;bt(U1,`Failed to update sequence numbers for target ${t}: ${o}`)}r.vs=r.vs.remove(t),r.Fs.delete(i.target)}function zR(n,t,e){const r=Ft(n);let i=Nt.min(),s=te();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,h,d){const p=Ft(u),g=p.Fs.get(d);return g!==void 0?ct.resolve(p.vs.get(g)):p.li.getTargetData(h,d)})(r,o,Ks(t)).next((l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,l.targetId).next((u=>{s=u}))})).next((()=>r.Cs.getDocumentsMatchingQuery(o,t,e?i:Nt.min(),e?s:te()))).next((l=>(j7(r,xG(t),l),{documents:l,ks:s})))))}function j7(n,t,e){let r=n.Ms.get(t)||Nt.min();e.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Ms.set(t,r)}class HR{constructor(){this.activeTargetIds=DG()}Qs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class F7{constructor(){this.vo=new HR,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t,e=!0){return e&&this.vo.Qs(t),this.Fo[t]||"not-current"}updateQueryState(t,e,r){this.Fo[t]=e}removeLocalQueryTarget(t){this.vo.Gs(t)}isLocalQueryTarget(t){return this.vo.activeTargetIds.has(t)}clearQueryState(t){delete this.Fo[t]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(t){return this.vo.activeTargetIds.has(t)}start(){return this.vo=new HR,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class B7{Mo(t){}shutdown(){}}const $R="ConnectivityMonitor";class qR{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(t){this.Lo.push(t)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){bt($R,"Network connectivity changed: AVAILABLE");for(const t of this.Lo)t(0)}Bo(){bt($R,"Network connectivity changed: UNAVAILABLE");for(const t of this.Lo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Cy=null;function Ox(){return Cy===null?Cy=(function(){return 268435456+Math.round(2147483648*Math.random())})():Cy++,"0x"+Cy.toString(16)}const YS="RestConnection",U7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class z7{get Ko(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=e+"://"+t.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===sv?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(t,e,r,i,s){const o=Ox(),l=this.Qo(t,e.toUriEncodedString());bt(YS,`Sending RPC '${t}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(u,i,s);const{host:h}=new URL(l),d=Rl(h);return this.zo(t,l,u,r,d).then((p=>(bt(YS,`Received RPC '${t}' ${o}: `,p),p)),(p=>{throw ru(YS,`RPC '${t}' ${o} failed with error: `,p,"url: ",l,"request:",r),p}))}jo(t,e,r,i,s,o){return this.Wo(t,e,r,i,s)}Go(t,e,r){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+hf})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((i,s)=>t[s]=i)),r&&r.headers.forEach(((i,s)=>t[s]=i))}Qo(t,e){const r=U7[t];let i=`${this.qo}/v1/${e}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}class H7{constructor(t){this.Ho=t.Ho,this.Jo=t.Jo}Zo(t){this.Xo=t}Yo(t){this.e_=t}t_(t){this.n_=t}onMessage(t){this.r_=t}close(){this.Jo()}send(t){this.Ho(t)}i_(){this.Xo()}s_(){this.e_()}o_(t){this.n_(t)}__(t){this.r_(t)}}const nr="WebChannelConnection",Nd=(n,t,e)=>{n.listen(t,(r=>{try{e(r)}catch(i){setTimeout((()=>{throw i}),0)}}))};class Ph extends z7{constructor(t){super(t),this.a_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}static u_(){if(!Ph.c_){const t=_V();Nd(t,bV.STAT_EVENT,(e=>{e.stat===_x.PROXY?bt(nr,"STAT_EVENT: detected buffering proxy"):e.stat===_x.NOPROXY&&bt(nr,"STAT_EVENT: detected no buffering proxy")})),Ph.c_=!0}}zo(t,e,r,i,s){const o=Ox();return new Promise(((l,u)=>{const h=new yV;h.setWithCredentials(!0),h.listenOnce(vV.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case x0.NO_ERROR:const p=h.getResponseJson();bt(nr,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(p)),l(p);break;case x0.TIMEOUT:bt(nr,`RPC '${t}' ${o} timed out`),u(new gt(it.DEADLINE_EXCEEDED,"Request time out"));break;case x0.HTTP_ERROR:const g=h.getStatus();if(bt(nr,`RPC '${t}' ${o} failed with status:`,g,"response text:",h.getResponseText()),g>0){let v=h.getResponseJson();Array.isArray(v)&&(v=v[0]);const T=v?.error;if(T&&T.status&&T.message){const S=(function(E){const D=E.toLowerCase().replace(/_/g,"-");return Object.values(it).indexOf(D)>=0?D:it.UNKNOWN})(T.status);u(new gt(S,T.message))}else u(new gt(it.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new gt(it.UNAVAILABLE,"Connection failed."));break;default:Rt(9055,{l_:t,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{bt(nr,`RPC '${t}' ${o} completed.`)}}));const d=JSON.stringify(i);bt(nr,`RPC '${t}' ${o} sending request:`,i),h.send(e,"POST",d,r,15)}))}T_(t,e,r){const i=Ox(),s=[this.qo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=this.createWebChannelTransport(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Go(l.initMessageHeaders,e,r),l.encodeInitMessageHeaders=!0;const h=s.join("");bt(nr,`Creating RPC '${t}' stream ${i}: ${h}`,l);const d=o.createWebChannel(h,l);this.I_(d);let p=!1,g=!1;const v=new H7({Ho:T=>{g?bt(nr,`Not sending because RPC '${t}' stream ${i} is closed:`,T):(p||(bt(nr,`Opening RPC '${t}' stream ${i} transport.`),d.open(),p=!0),bt(nr,`RPC '${t}' stream ${i} sending:`,T),d.send(T))},Jo:()=>d.close()});return Nd(d,Xd.EventType.OPEN,(()=>{g||(bt(nr,`RPC '${t}' stream ${i} transport opened.`),v.i_())})),Nd(d,Xd.EventType.CLOSE,(()=>{g||(g=!0,bt(nr,`RPC '${t}' stream ${i} transport closed`),v.o_(),this.E_(d))})),Nd(d,Xd.EventType.ERROR,(T=>{g||(g=!0,ru(nr,`RPC '${t}' stream ${i} transport errored. Name:`,T.name,"Message:",T.message),v.o_(new gt(it.UNAVAILABLE,"The operation could not be completed")))})),Nd(d,Xd.EventType.MESSAGE,(T=>{if(!g){const S=T.data[0];ie(!!S,16349);const w=S,E=w?.error||w[0]?.error;if(E){bt(nr,`RPC '${t}' stream ${i} received error:`,E);const D=E.status;let P=(function(q){const M=yn[q];if(M!==void 0)return rj(M)})(D),V=E.message;D==="NOT_FOUND"&&V.includes("database")&&V.includes("does not exist")&&V.includes(this.databaseId.database)&&ru(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),P===void 0&&(P=it.INTERNAL,V="Unknown error status: "+D+" with message "+E.message),g=!0,v.o_(new gt(P,V)),d.close()}else bt(nr,`RPC '${t}' stream ${i} received:`,S),v.__(S)}})),Ph.u_(),setTimeout((()=>{v.s_()}),0),v}terminate(){this.a_.forEach((t=>t.close())),this.a_=[]}I_(t){this.a_.push(t)}E_(t){this.a_=this.a_.filter((e=>e===t))}Go(t,e,r){super.Go(t,e,r),this.databaseInfo.apiKey&&(t["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return TV()}}function $7(n){return new Ph(n)}function KS(){return typeof document<"u"?document:null}function qb(n){return new YG(n,!0)}Ph.c_=!1;class z1{constructor(t,e,r=1e3,i=1.5,s=6e4){this.Ci=t,this.timerId=e,this.R_=r,this.A_=i,this.V_=s,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(t){this.cancel();const e=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,e-r);i>0&&bt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),t()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const WR="PersistentStream";class bj{constructor(t,e,r,i,s,o,l,u){this.Ci=t,this.b_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new z1(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(t){this.q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===it.RESOURCE_EXHAUSTED?(Xo(e.toString()),Xo("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===it.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.t_(e)}W_(){}auth(){this.state=1;const t=this.Q_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===e&&this.G_(r,i)}),(r=>{t((()=>{const i=new gt(it.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(t,e){const r=this.Q_(this.D_);this.stream=this.j_(t,e),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.H_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return bt(WR,`close with error: ${t}`),this.stream=null,this.close(4,t)}Q_(t){return e=>{this.Ci.enqueueAndForget((()=>this.D_===t?e():(bt(WR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class q7 extends bj{constructor(t,e,r,i,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,i,o),this.serializer=s}j_(t,e){return this.connection.T_("Listen",t,e)}H_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=JG(this.serializer,t),r=(function(s){if(!("targetChange"in s))return Nt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Nt.min():o.readTime?ri(o.readTime):Nt.min()})(t);return this.listener.J_(e,r)}Z_(t){const e={};e.database=Mx(this.serializer),e.addTarget=(function(s,o){let l;const u=o.target;if(l=Ex(u)?{documents:t7(s,u)}:{query:e7(s,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=oj(s,o.resumeToken);const h=Ax(s,o.expectedCount);h!==null&&(l.expectedCount=h)}else if(o.snapshotVersion.compareTo(Nt.min())>0){l.readTime=uv(s,o.snapshotVersion.toTimestamp());const h=Ax(s,o.expectedCount);h!==null&&(l.expectedCount=h)}return l})(this.serializer,t);const r=r7(this.serializer,t);r&&(e.labels=r),this.K_(e)}X_(t){const e={};e.database=Mx(this.serializer),e.removeTarget=t,this.K_(e)}}class W7 extends bj{constructor(t,e,r,i,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,i,o),this.serializer=s}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}H_(t){return ie(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,ie(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){ie(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=ZG(t.writeResults,t.commitTime),r=ri(t.commitTime);return this.listener.na(r,e)}ra(){const t={};t.database=Mx(this.serializer),this.K_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((r=>uj(this.serializer,r)))};this.K_(e)}}class G7{}class Y7 extends G7{constructor(t,e,r,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new gt(it.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,e,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Wo(t,kx(e,r),i,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===it.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new gt(it.UNKNOWN,s.toString())}))}jo(t,e,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.jo(t,kx(e,r),i,o,l,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===it.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new gt(it.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function K7(n,t,e,r){return new Y7(n,t,e,r)}class X7{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Xo(e),this.aa=!1):bt("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const iu="RemoteStore";class Q7{constructor(t,e,r,i,s){this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=s,this.Aa.Mo((o=>{r.enqueueAndForget((async()=>{gu(this)&&(bt(iu,"Restarting streams for network reachability change."),await(async function(u){const h=Ft(u);h.Ea.add(4),await Mm(h),h.Va.set("Unknown"),h.Ea.delete(4),await Wb(h)})(this))}))})),this.Va=new X7(r,i)}}async function Wb(n){if(gu(n))for(const t of n.Ra)await t(!0)}async function Mm(n){for(const t of n.Ra)await t(!1)}function _j(n,t){const e=Ft(n);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),W1(e)?q1(e):mf(e).O_()&&$1(e,t))}function H1(n,t){const e=Ft(n),r=mf(e);e.Ia.delete(t),r.O_()&&Tj(e,t),e.Ia.size===0&&(r.O_()?r.L_():gu(e)&&e.Va.set("Unknown"))}function $1(n,t){if(n.da.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Nt.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}mf(n).Z_(t)}function Tj(n,t){n.da.$e(t),mf(n).X_(t)}function q1(n){n.da=new $G({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),mf(n).start(),n.Va.ua()}function W1(n){return gu(n)&&!mf(n).x_()&&n.Ia.size>0}function gu(n){return Ft(n).Ea.size===0}function Sj(n){n.da=void 0}async function J7(n){n.Va.set("Online")}async function Z7(n){n.Ia.forEach(((t,e)=>{$1(n,t)}))}async function tY(n,t){Sj(n),W1(n)?(n.Va.ha(t),q1(n)):n.Va.set("Unknown")}async function eY(n,t,e){if(n.Va.set("Online"),t instanceof sj&&t.state===2&&t.cause)try{await(async function(i,s){const o=s.cause;for(const l of s.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.Ia.delete(l),i.da.removeTarget(l))})(n,t)}catch(r){bt(iu,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await dv(n,r)}else if(t instanceof k0?n.da.Xe(t):t instanceof ij?n.da.st(t):n.da.tt(t),!e.isEqual(Nt.min()))try{const r=await vj(n.localStore);e.compareTo(r)>=0&&await(function(s,o){const l=s.da.Tt(o);return l.targetChanges.forEach(((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.Ia.get(h);d&&s.Ia.set(h,d.withResumeToken(u.resumeToken,o))}})),l.targetMismatches.forEach(((u,h)=>{const d=s.Ia.get(u);if(!d)return;s.Ia.set(u,d.withResumeToken(tr.EMPTY_BYTE_STRING,d.snapshotVersion)),Tj(s,u);const p=new rl(d.target,u,h,d.sequenceNumber);$1(s,p)})),s.remoteSyncer.applyRemoteEvent(l)})(n,e)}catch(r){bt(iu,"Failed to raise snapshot:",r),await dv(n,r)}}async function dv(n,t,e){if(!df(t))throw t;n.Ea.add(1),await Mm(n),n.Va.set("Offline"),e||(e=()=>vj(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{bt(iu,"Retrying IndexedDB access"),await e(),n.Ea.delete(1),await Wb(n)}))}function wj(n,t){return t().catch((e=>dv(n,e,t)))}async function Gb(n){const t=Ft(n),e=Sl(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:A1;for(;nY(t);)try{const i=await L7(t.localStore,r);if(i===null){t.Ta.length===0&&e.L_();break}r=i.batchId,rY(t,i)}catch(i){await dv(t,i)}xj(t)&&Ej(t)}function nY(n){return gu(n)&&n.Ta.length<10}function rY(n,t){n.Ta.push(t);const e=Sl(n);e.O_()&&e.Y_&&e.ea(t.mutations)}function xj(n){return gu(n)&&!Sl(n).x_()&&n.Ta.length>0}function Ej(n){Sl(n).start()}async function iY(n){Sl(n).ra()}async function sY(n){const t=Sl(n);for(const e of n.Ta)t.ea(e.mutations)}async function oY(n,t,e){const r=n.Ta.shift(),i=N1.from(r,t,e);await wj(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Gb(n)}async function aY(n,t){t&&Sl(n).Y_&&await(async function(r,i){if((function(o){return nj(o)&&o!==it.ABORTED})(i.code)){const s=r.Ta.shift();Sl(r).B_(),await wj(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await Gb(r)}})(n,t),xj(n)&&Ej(n)}async function GR(n,t){const e=Ft(n);e.asyncQueue.verifyOperationInProgress(),bt(iu,"RemoteStore received new credentials");const r=gu(e);e.Ea.add(3),await Mm(e),r&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await Wb(e)}async function lY(n,t){const e=Ft(n);t?(e.Ea.delete(2),await Wb(e)):t||(e.Ea.add(2),await Mm(e),e.Va.set("Unknown"))}function mf(n){return n.ma||(n.ma=(function(e,r,i){const s=Ft(e);return s.sa(),new q7(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:J7.bind(null,n),Yo:Z7.bind(null,n),t_:tY.bind(null,n),J_:eY.bind(null,n)}),n.Ra.push((async t=>{t?(n.ma.B_(),W1(n)?q1(n):n.Va.set("Unknown")):(await n.ma.stop(),Sj(n))}))),n.ma}function Sl(n){return n.fa||(n.fa=(function(e,r,i){const s=Ft(e);return s.sa(),new W7(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:iY.bind(null,n),t_:aY.bind(null,n),ta:sY.bind(null,n),na:oY.bind(null,n)}),n.Ra.push((async t=>{t?(n.fa.B_(),await Gb(n)):(await n.fa.stop(),n.Ta.length>0&&(bt(iu,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class G1{constructor(t,e,r,i,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,r,i,s){const o=Date.now()+r,l=new G1(t,e,o,i,s);return l.start(r),l}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new gt(it.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Y1(n,t){if(Xo("AsyncQueue",`${t}: ${n}`),df(n))return new gt(it.UNAVAILABLE,`${t}: ${n}`);throw n}class Nh{static emptySet(t){return new Nh(t.comparator)}constructor(t){this.comparator=t?(e,r)=>t(e,r)||At.comparator(e.key,r.key):(e,r)=>At.comparator(e.key,r.key),this.keyedMap=Qd(),this.sortedSet=new He(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,r)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Nh)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const i=e.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const r=new Nh;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class YR{constructor(){this.ga=new He(At.comparator)}track(t){const e=t.doc.key,r=this.ga.get(e);r?t.type!==0&&r.type===3?this.ga=this.ga.insert(e,t):t.type===3&&r.type!==1?this.ga=this.ga.insert(e,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.ga=this.ga.remove(e):t.type===1&&r.type===2?this.ga=this.ga.insert(e,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):Rt(63341,{Vt:t,pa:r}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,r)=>{t.push(r)})),t}}class Gh{constructor(t,e,r,i,s,o,l,u,h){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,e,r,i,s){const o=[];return e.forEach((l=>{o.push({type:0,doc:l})})),new Gh(t,e,Nh.emptySet(e),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Bb(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==r[i].type||!e[i].doc.isEqual(r[i].doc))return!1;return!0}}class cY{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((t=>t.Da()))}}class uY{constructor(){this.queries=KR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,r){const i=Ft(e),s=i.queries;i.queries=KR(),s.forEach(((o,l)=>{for(const u of l.ba)u.onError(r)}))})(this,new gt(it.ABORTED,"Firestore shutting down"))}}function KR(){return new mu((n=>HV(n)),Bb)}async function Cj(n,t){const e=Ft(n);let r=3;const i=t.query;let s=e.queries.get(i);s?!s.Sa()&&t.Da()&&(r=2):(s=new cY,r=t.Da()?0:1);try{switch(r){case 0:s.wa=await e.onListen(i,!0);break;case 1:s.wa=await e.onListen(i,!1);break;case 2:await e.onFirstRemoteStoreListen(i)}}catch(o){const l=Y1(o,`Initialization of query '${dh(t.query)}' failed`);return void t.onError(l)}e.queries.set(i,s),s.ba.push(t),t.va(e.onlineState),s.wa&&t.Fa(s.wa)&&K1(e)}async function Aj(n,t){const e=Ft(n),r=t.query;let i=3;const s=e.queries.get(r);if(s){const o=s.ba.indexOf(t);o>=0&&(s.ba.splice(o,1),s.ba.length===0?i=t.Da()?0:1:!s.Sa()&&t.Da()&&(i=2))}switch(i){case 0:return e.queries.delete(r),e.onUnlisten(r,!0);case 1:return e.queries.delete(r),e.onUnlisten(r,!1);case 2:return e.onLastRemoteStoreUnlisten(r);default:return}}function hY(n,t){const e=Ft(n);let r=!1;for(const i of t){const s=i.query,o=e.queries.get(s);if(o){for(const l of o.ba)l.Fa(i)&&(r=!0);o.wa=i}}r&&K1(e)}function fY(n,t,e){const r=Ft(n),i=r.queries.get(t);if(i)for(const s of i.ba)s.onError(e);r.queries.delete(t)}function K1(n){n.Ca.forEach((t=>{t.next()}))}var Rx,XR;(XR=Rx||(Rx={})).Ma="default",XR.Cache="cache";class kj{constructor(t,e,r){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(t){if(!this.options.includeMetadataChanges){const r=[];for(const i of t.docChanges)i.type!==3&&r.push(i);t=new Gh(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const r=e!=="Offline";return(!this.options.Ka||!r)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Gh.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==Rx.Cache}}class Mj{constructor(t){this.key=t}}class Dj{constructor(t){this.key=t}}class dY{constructor(t,e){this.query=t,this.Za=e,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=te(),this.mutatedKeys=te(),this.eu=$V(t),this.tu=new Nh(this.eu)}get nu(){return this.Za}ru(t,e){const r=e?e.iu:new YR,i=e?e.tu:this.tu;let s=e?e.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((d,p)=>{const g=i.get(d),v=Ub(this.query,p)?p:null,T=!!g&&this.mutatedKeys.has(g.key),S=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let w=!1;g&&v?g.data.isEqual(v.data)?T!==S&&(r.track({type:3,doc:v}),w=!0):this.su(g,v)||(r.track({type:2,doc:v}),w=!0,(u&&this.eu(v,u)>0||h&&this.eu(v,h)<0)&&(l=!0)):!g&&v?(r.track({type:0,doc:v}),w=!0):g&&!v&&(r.track({type:1,doc:g}),w=!0,(u||h)&&(l=!0)),w&&(v?(o=o.add(v),s=S?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{tu:o,iu:r,Ss:l,mutatedKeys:s}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r,i){const s=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const o=t.iu.ya();o.sort(((d,p)=>(function(v,T){const S=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rt(20277,{Vt:w})}};return S(v)-S(T)})(d.type,p.type)||this.eu(d.doc,p.doc))),this.ou(r),i=i??!1;const l=e&&!i?this._u():[],u=this.Ya.size===0&&this.current&&!i?1:0,h=u!==this.Xa;return this.Xa=u,o.length!==0||h?{snapshot:new Gh(this.query,t.tu,s,o,t.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new YR,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(t){return!this.Za.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Za=this.Za.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Za=this.Za.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Ya;this.Ya=te(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const e=[];return t.forEach((r=>{this.Ya.has(r)||e.push(new Dj(r))})),this.Ya.forEach((r=>{t.has(r)||e.push(new Mj(r))})),e}cu(t){this.Za=t.ks,this.Ya=te();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Gh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const X1="SyncEngine";class pY{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class mY{constructor(t){this.key=t,this.hu=!1}}class gY{constructor(t,e,r,i,s,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new mu((l=>HV(l)),Bb),this.Iu=new Map,this.Eu=new Set,this.Ru=new He(At.comparator),this.Au=new Map,this.Vu=new j1,this.du={},this.mu=new Map,this.fu=Wh.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function yY(n,t,e=!0){const r=Lj(n);let i;const s=r.Tu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await Oj(r,t,e,!0),i}async function vY(n,t){const e=Lj(n);await Oj(e,t,!0,!1)}async function Oj(n,t,e,r){const i=await V7(n.localStore,Ks(t)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,e);let l;return r&&(l=await bY(n,t,s,o==="current",i.resumeToken)),n.isPrimaryClient&&e&&_j(n.remoteStore,i),l}async function bY(n,t,e,r,i){n.pu=(p,g,v)=>(async function(S,w,E,D){let P=w.view.ru(E);P.Ss&&(P=await zR(S.localStore,w.query,!1).then((({documents:M})=>w.view.ru(M,P))));const V=D&&D.targetChanges.get(w.targetId),N=D&&D.targetMismatches.get(w.targetId)!=null,q=w.view.applyChanges(P,S.isPrimaryClient,V,N);return JR(S,w.targetId,q.au),q.snapshot})(n,p,g,v);const s=await zR(n.localStore,t,!0),o=new dY(t,s.ks),l=o.ru(s.documents),u=km.createSynthesizedTargetChangeForCurrentChange(e,r&&n.onlineState!=="Offline",i),h=o.applyChanges(l,n.isPrimaryClient,u);JR(n,e,h.au);const d=new pY(t,e,o);return n.Tu.set(t,d),n.Iu.has(e)?n.Iu.get(e).push(t):n.Iu.set(e,[t]),h.snapshot}async function _Y(n,t,e){const r=Ft(n),i=r.Tu.get(t),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((o=>!Bb(o,t)))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Dx(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),e&&H1(r.remoteStore,i.targetId),Ix(r,i.targetId)})).catch(ff)):(Ix(r,i.targetId),await Dx(r.localStore,i.targetId,!0))}async function TY(n,t){const e=Ft(n),r=e.Tu.get(t),i=e.Iu.get(r.targetId);e.isPrimaryClient&&i.length===1&&(e.sharedClientState.removeLocalQueryTarget(r.targetId),H1(e.remoteStore,r.targetId))}async function SY(n,t,e){const r=MY(n);try{const i=await(function(o,l){const u=Ft(o),h=ue.now(),d=l.reduce(((v,T)=>v.add(T.key)),te());let p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",(v=>{let T=Qo(),S=te();return u.xs.getEntries(v,d).next((w=>{T=w,T.forEach(((E,D)=>{D.isValidDocument()||(S=S.add(E))}))})).next((()=>u.localDocuments.getOverlayedDocuments(v,T))).next((w=>{p=w;const E=[];for(const D of l){const P=jG(D,p.get(D.key).overlayedDocument);P!=null&&E.push(new Vl(D.key,P,NV(P.value.mapValue),vr.exists(!0)))}return u.mutationQueue.addMutationBatch(v,h,E,l)})).next((w=>{g=w;const E=w.applyToLocalDocumentSet(p,S);return u.documentOverlayCache.saveOverlays(v,w.batchId,E)}))})).then((()=>({batchId:g.batchId,changes:WV(p)})))})(r.localStore,t);r.sharedClientState.addPendingMutation(i.batchId),(function(o,l,u){let h=o.du[o.currentUser.toKey()];h||(h=new He(Zt)),h=h.insert(l,u),o.du[o.currentUser.toKey()]=h})(r,i.batchId,e),await Dm(r,i.changes),await Gb(r.remoteStore)}catch(i){const s=Y1(i,"Failed to persist write");e.reject(s)}}async function Rj(n,t){const e=Ft(n);try{const r=await P7(e.localStore,t);t.targetChanges.forEach(((i,s)=>{const o=e.Au.get(s);o&&(ie(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?ie(o.hu,14607):i.removedDocuments.size>0&&(ie(o.hu,42227),o.hu=!1))})),await Dm(e,r,t)}catch(r){await ff(r)}}function QR(n,t,e){const r=Ft(n);if(r.isPrimaryClient&&e===0||!r.isPrimaryClient&&e===1){const i=[];r.Tu.forEach(((s,o)=>{const l=o.view.va(t);l.snapshot&&i.push(l.snapshot)})),(function(o,l){const u=Ft(o);u.onlineState=l;let h=!1;u.queries.forEach(((d,p)=>{for(const g of p.ba)g.va(l)&&(h=!0)})),h&&K1(u)})(r.eventManager,t),i.length&&r.Pu.J_(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function wY(n,t,e){const r=Ft(n);r.sharedClientState.updateQueryState(t,"rejected",e);const i=r.Au.get(t),s=i&&i.key;if(s){let o=new He(At.comparator);o=o.insert(s,Nn.newNoDocument(s,Nt.min()));const l=te().add(s),u=new $b(Nt.min(),new Map,new He(Zt),o,l);await Rj(r,u),r.Ru=r.Ru.remove(s),r.Au.delete(t),Q1(r)}else await Dx(r.localStore,t,!1).then((()=>Ix(r,t,e))).catch(ff)}async function xY(n,t){const e=Ft(n),r=t.batch.batchId;try{const i=await I7(e.localStore,t);Pj(e,r,null),Ij(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),await Dm(e,i)}catch(i){await ff(i)}}async function EY(n,t,e){const r=Ft(n);try{const i=await(function(o,l){const u=Ft(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let d;return u.mutationQueue.lookupMutationBatch(h,l).next((p=>(ie(p!==null,37113),d=p.keys(),u.mutationQueue.removeMutationBatch(h,p)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,d,l))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d))).next((()=>u.localDocuments.getDocuments(h,d)))}))})(r.localStore,t);Pj(r,t,e),Ij(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),await Dm(r,i)}catch(i){await ff(i)}}function Ij(n,t){(n.mu.get(t)||[]).forEach((e=>{e.resolve()})),n.mu.delete(t)}function Pj(n,t,e){const r=Ft(n);let i=r.du[r.currentUser.toKey()];if(i){const s=i.get(t);s&&(e?s.reject(e):s.resolve(),i=i.remove(t)),r.du[r.currentUser.toKey()]=i}}function Ix(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.Iu.get(t))n.Tu.delete(r),e&&n.Pu.yu(r,e);n.Iu.delete(t),n.isPrimaryClient&&n.Vu.Gr(t).forEach((r=>{n.Vu.containsKey(r)||Nj(n,r)}))}function Nj(n,t){n.Eu.delete(t.path.canonicalString());const e=n.Ru.get(t);e!==null&&(H1(n.remoteStore,e),n.Ru=n.Ru.remove(t),n.Au.delete(e),Q1(n))}function JR(n,t,e){for(const r of e)r instanceof Mj?(n.Vu.addReference(r.key,t),CY(n,r)):r instanceof Dj?(bt(X1,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,t),n.Vu.containsKey(r.key)||Nj(n,r.key)):Rt(19791,{wu:r})}function CY(n,t){const e=t.key,r=e.path.canonicalString();n.Ru.get(e)||n.Eu.has(r)||(bt(X1,"New document in limbo: "+e),n.Eu.add(r),Q1(n))}function Q1(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const e=new At(Ee.fromString(t)),r=n.fu.next();n.Au.set(r,new mY(e)),n.Ru=n.Ru.insert(e,r),_j(n.remoteStore,new rl(Ks(R1(e.path)),r,"TargetPurposeLimboResolution",jb.ce))}}async function Dm(n,t,e){const r=Ft(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((l,u)=>{o.push(r.pu(u,t,e).then((h=>{if((h||e)&&r.isPrimaryClient){const d=h?!h.fromCache:e?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(h){i.push(h);const d=B1.Es(u.targetId,h);s.push(d)}})))})),await Promise.all(o),r.Pu.J_(i),await(async function(u,h){const d=Ft(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",(p=>ct.forEach(h,(g=>ct.forEach(g.Ts,(v=>d.persistence.referenceDelegate.addReference(p,g.targetId,v))).next((()=>ct.forEach(g.Is,(v=>d.persistence.referenceDelegate.removeReference(p,g.targetId,v)))))))))}catch(p){if(!df(p))throw p;bt(U1,"Failed to update sequence numbers: "+p)}for(const p of h){const g=p.targetId;if(!p.fromCache){const v=d.vs.get(g),T=v.snapshotVersion,S=v.withLastLimboFreeSnapshotVersion(T);d.vs=d.vs.insert(g,S)}}})(r.localStore,s))}async function AY(n,t){const e=Ft(n);if(!e.currentUser.isEqual(t)){bt(X1,"User change. New user:",t.toKey());const r=await yj(e.localStore,t);e.currentUser=t,(function(s,o){s.mu.forEach((l=>{l.forEach((u=>{u.reject(new gt(it.CANCELLED,o))}))})),s.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await Dm(e,r.Ns)}}function kY(n,t){const e=Ft(n),r=e.Au.get(t);if(r&&r.hu)return te().add(r.key);{let i=te();const s=e.Iu.get(t);if(!s)return i;for(const o of s){const l=e.Tu.get(o);i=i.unionWith(l.view.nu)}return i}}function Lj(n){const t=Ft(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=Rj.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=kY.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=wY.bind(null,t),t.Pu.J_=hY.bind(null,t.eventManager),t.Pu.yu=fY.bind(null,t.eventManager),t}function MY(n){const t=Ft(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=xY.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=EY.bind(null,t),t}class pv{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=qb(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return R7(this.persistence,new M7,t.initialUser,this.serializer)}Cu(t){return new gj(F1.Vi,this.serializer)}Du(t){return new F7}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}pv.provider={build:()=>new pv};class DY extends pv{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){ie(this.persistence.referenceDelegate instanceof fv,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new p7(r,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Pr.withCacheSize(this.cacheSizeBytes):Pr.DEFAULT;return new gj((r=>fv.Vi(r,e)),this.serializer)}}class Px{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>QR(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=AY.bind(null,this.syncEngine),await lY(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new uY})()}createDatastore(t){const e=qb(t.databaseInfo.databaseId),r=$7(t.databaseInfo);return K7(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return(function(r,i,s,o,l){return new Q7(r,i,s,o,l)})(this.localStore,this.datastore,t.asyncQueue,(e=>QR(this.syncEngine,e,0)),(function(){return qR.v()?new qR:new B7})())}createSyncEngine(t,e){return(function(i,s,o,l,u,h,d){const p=new gY(i,s,o,l,u,h);return d&&(p.gu=!0),p})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const r=Ft(e);bt(iu,"RemoteStore shutting down."),r.Ea.add(5),await Mm(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Px.provider={build:()=>new Px};class Vj{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):Xo("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}let OY=class{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(t){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new gt(it.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const e=await(async function(i,s){const o=Ft(i),l={documents:s.map((p=>hv(o.serializer,p)))},u=await o.jo("BatchGetDocuments",o.serializer.databaseId,Ee.emptyPath(),l,s.length),h=new Map;u.forEach((p=>{const g=QG(o.serializer,p);h.set(g.key.toString(),g)}));const d=[];return s.forEach((p=>{const g=h.get(p.toString());ie(!!g,55234,{key:p}),d.push(g)})),d})(this.datastore,t);return e.forEach((r=>this.recordVersion(r))),e}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(t.toString())}delete(t){this.write(new P1(t,this.precondition(t))),this.writtenDocs.add(t.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const t=this.readVersions;this.mutations.forEach((e=>{t.delete(e.key.toString())})),t.forEach(((e,r)=>{const i=At.fromPath(r);this.mutations.push(new ej(i,this.precondition(i)))})),await(async function(r,i){const s=Ft(r),o={writes:i.map((l=>uj(s.serializer,l)))};await s.Wo("Commit",s.serializer.databaseId,Ee.emptyPath(),o)})(this.datastore,this.mutations),this.committed=!0}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Rt(50498,{Gu:t.constructor.name});e=Nt.min()}const r=this.readVersions.get(t.key.toString());if(r){if(!e.isEqual(r))throw new gt(it.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){const e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(Nt.min())?vr.exists(!1):vr.updateTime(e):vr.none()}preconditionForUpdate(t){const e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Nt.min()))throw new gt(it.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vr.updateTime(e)}return vr.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}};class RY{constructor(t,e,r,i,s){this.asyncQueue=t,this.datastore=e,this.options=r,this.updateFunction=i,this.deferred=s,this.zu=r.maxAttempts,this.M_=new z1(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const t=new OY(this.datastore),e=this.Ju(t);e&&e.then((r=>{this.asyncQueue.enqueueAndForget((()=>t.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Zu(i)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(t){try{const e=this.updateFunction(t);return!Cm(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Zu(t){this.zu>0&&this.Xu(t)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(t)}Xu(t){if(t?.name==="FirebaseError"){const e=t.code;return e==="aborted"||e==="failed-precondition"||e==="already-exists"||!nj(e)}return!1}}const wl="FirestoreClient";class IY{constructor(t,e,r,i,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this._databaseInfo=i,this.user=ir.UNAUTHENTICATED,this.clientId=C1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async o=>{bt(wl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(bt(wl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const r=Y1(e,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}async function XS(n,t){n.asyncQueue.verifyOperationInProgress(),bt(wl,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await yj(t.localStore,i),r=i)})),t.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=t}async function ZR(n,t){n.asyncQueue.verifyOperationInProgress();const e=await PY(n);bt(wl,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener((r=>GR(t.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>GR(t.remoteStore,i))),n._onlineComponents=t}async function PY(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){bt(wl,"Using user provided OfflineComponentProvider");try{await XS(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(i){return i.name==="FirebaseError"?i.code===it.FAILED_PRECONDITION||i.code===it.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(e))throw e;ru("Error using user provided cache. Falling back to memory cache: "+e),await XS(n,new pv)}}else bt(wl,"Using default OfflineComponentProvider"),await XS(n,new DY(void 0));return n._offlineComponents}async function J1(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(bt(wl,"Using user provided OnlineComponentProvider"),await ZR(n,n._uninitializedComponentsProvider._online)):(bt(wl,"Using default OnlineComponentProvider"),await ZR(n,new Px))),n._onlineComponents}function NY(n){return J1(n).then((t=>t.syncEngine))}function LY(n){return J1(n).then((t=>t.datastore))}async function jj(n){const t=await J1(n),e=t.eventManager;return e.onListen=yY.bind(null,t.syncEngine),e.onUnlisten=_Y.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=vY.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=TY.bind(null,t.syncEngine),e}function VY(n,t,e={}){const r=new Ys;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,l,u,h){const d=new Vj({next:g=>{d.Nu(),o.enqueueAndForget((()=>Aj(s,p)));const v=g.docs.has(l);!v&&g.fromCache?h.reject(new gt(it.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&u&&u.source==="server"?h.reject(new gt(it.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(g)},error:g=>h.reject(g)}),p=new kj(R1(l.path),d,{includeMetadataChanges:!0,Ka:!0});return Cj(s,p)})(await jj(n),n.asyncQueue,t,e,r))),r.promise}function jY(n,t,e={}){const r=new Ys;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,l,u,h){const d=new Vj({next:g=>{d.Nu(),o.enqueueAndForget((()=>Aj(s,p))),g.fromCache&&u.source==="server"?h.reject(new gt(it.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(g)},error:g=>h.reject(g)}),p=new kj(l,d,{includeMetadataChanges:!0,Ka:!0});return Cj(s,p)})(await jj(n),n.asyncQueue,t,e,r))),r.promise}function FY(n,t){const e=new Ys;return n.asyncQueue.enqueueAndForget((async()=>SY(await NY(n),t,e))),e.promise}function BY(n,t,e){const r=new Ys;return n.asyncQueue.enqueueAndForget((async()=>{const i=await LY(n);new RY(n.asyncQueue,i,e,t,r).ju()})),r.promise}function Fj(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}const UY="ComponentProvider",t2=new Map;function zY(n,t,e,r,i){return new sG(n,t,e,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,Fj(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}const Bj="firestore.googleapis.com",e2=!0;class n2{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new gt(it.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Bj,this.ssl=e2}else this.host=t.host,this.ssl=t.ssl??e2;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=mj;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<f7)throw new gt(it.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}YW("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Fj(t.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new gt(it.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new gt(it.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new gt(it.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Yb{constructor(t,e,r,i){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new n2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new gt(it.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new gt(it.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new n2(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new jW;switch(r.type){case"firstParty":return new zW(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new gt(it.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const r=t2.get(e);r&&(bt(UY,"Removing Datastore"),t2.delete(e),r.terminate())})(this),Promise.resolve()}}function HY(n,t,e,r={}){n=Zs(n,Yb);const i=Rl(t),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},l=`${t}:${e}`;i&&(u1(`https://${l}`),h1("Firestore",!0)),s.host!==Bj&&s.host!==l&&ru("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:l,ssl:i,emulatorOptions:r};if(!Jc(u,o)&&(n._setSettings(u),r.mockUserToken)){let h,d;if(typeof r.mockUserToken=="string")h=r.mockUserToken,d=ir.MOCK_USER;else{h=OL(r.mockUserToken,n._app?.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new gt(it.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new ir(p)}n._authCredentials=new FW(new wV(h,d))}}class jl{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new jl(this.firestore,t,this._query)}}class Xe{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hl(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Xe(this.firestore,t,this._key)}toJSON(){return{type:Xe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,r){if(Em(e,Xe._jsonSchema))return new Xe(t,r||null,new At(Ee.fromString(e.referencePath)))}}Xe._jsonSchemaVersion="firestore/documentReference/1.0",Xe._jsonSchema={type:_n("string",Xe._jsonSchemaVersion),referencePath:_n("string")};class hl extends jl{constructor(t,e,r){super(t,e,R1(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Xe(this.firestore,null,new At(t))}withConverter(t){return new hl(this.firestore,t,this._path)}}function mv(n,t,...e){if(n=je(n),xV("collection","path",t),n instanceof Yb){const r=Ee.fromString(t,...e);return mR(r),new hl(n,null,r)}{if(!(n instanceof Xe||n instanceof hl))throw new gt(it.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ee.fromString(t,...e));return mR(r),new hl(n.firestore,null,r)}}function Ho(n,t,...e){if(n=je(n),arguments.length===1&&(t=C1.newId()),xV("doc","path",t),n instanceof Yb){const r=Ee.fromString(t,...e);return pR(r),new Xe(n,null,new At(r))}{if(!(n instanceof Xe||n instanceof hl))throw new gt(it.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ee.fromString(t,...e));return pR(r),new Xe(n.firestore,n instanceof hl?n.converter:null,new At(r))}}const r2="AsyncQueue";class i2{constructor(t=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new z1(this,"async_queue_retry"),this._c=()=>{const r=KS();r&&bt(r2,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=t;const e=KS();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=KS();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new Ys;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Yu.push(t),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(t){if(!df(t))throw t;bt(r2,"Operation failed with retryable error: "+t)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((r=>{throw this.nc=r,this.rc=!1,Xo("INTERNAL UNHANDLED ERROR: ",s2(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=e,e}enqueueAfterDelay(t,e,r){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const i=G1.createAndSchedule(this,t,e,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&Rt(47125,{Pc:s2(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,r)=>e.targetTimeMs-r.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}Rc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function s2(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}class gf extends Yb{constructor(t,e,r,i){super(t,e,r,i),this.type="firestore",this._queue=new i2,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new i2(t),this._firestoreClient=void 0,await t}}}function $Y(n,t){const e=typeof n=="object"?n:p1(),r=typeof n=="string"?n:sv,i=Ib(e,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=kL("firestore");s&&HY(i,...s)}return i}function Kb(n){if(n._terminated)throw new gt(it.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||qY(n),n._firestoreClient}function qY(n){const t=n._freezeSettings(),e=zY(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,t);n._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new IY(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}class Jr{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Jr(tr.fromBase64String(t))}catch(e){throw new gt(it.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Jr(tr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Jr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Em(t,Jr._jsonSchema))return Jr.fromBase64String(t.bytes)}}Jr._jsonSchemaVersion="firestore/bytes/1.0",Jr._jsonSchema={type:_n("string",Jr._jsonSchemaVersion),bytes:_n("string")};class Xb{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new gt(it.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qn(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Qb{constructor(t){this._methodName=t}}class Xs{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new gt(it.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new gt(it.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Zt(this._lat,t._lat)||Zt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Xs._jsonSchemaVersion}}static fromJSON(t){if(Em(t,Xs._jsonSchema))return new Xs(t.latitude,t.longitude)}}Xs._jsonSchemaVersion="firestore/geoPoint/1.0",Xs._jsonSchema={type:_n("string",Xs._jsonSchemaVersion),latitude:_n("number"),longitude:_n("number")};class ss{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,t._values)}toJSON(){return{type:ss._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Em(t,ss._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new ss(t.vectorValues);throw new gt(it.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ss._jsonSchemaVersion="firestore/vectorValue/1.0",ss._jsonSchema={type:_n("string",ss._jsonSchemaVersion),vectorValues:_n("object")};const WY=/^__.*__$/;class GY{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return this.fieldMask!==null?new Vl(t,this.data,this.fieldMask,e,this.fieldTransforms):new Am(t,this.data,e,this.fieldTransforms)}}class Uj{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new Vl(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function zj(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Rt(40011,{dataSource:n})}}class Z1{constructor(t,e,r,i,s,o){this.settings=t,this.databaseId=e,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.validatePath(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(t){return new Z1({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(t){const e=this.path?.child(t),r=this.contextWith({path:e,arrayElement:!1});return r.validatePathSegment(t),r}childContextForFieldPath(t){const e=this.path?.child(t),r=this.contextWith({path:e,arrayElement:!1});return r.validatePath(),r}childContextForArray(t){return this.contextWith({path:void 0,arrayElement:!0})}createError(t){return gv(t,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}validatePath(){if(this.path)for(let t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))}validatePathSegment(t){if(t.length===0)throw this.createError("Document fields must not be empty");if(zj(this.dataSource)&&WY.test(t))throw this.createError('Document fields cannot begin and end with "__"')}}class YY{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=r||qb(t)}createContext(t,e,r,i=!1){return new Z1({dataSource:t,methodName:e,targetDoc:r,path:Qn.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jb(n){const t=n._freezeSettings(),e=qb(n._databaseId);return new YY(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Hj(n,t,e,r,i,s={}){const o=n.createContext(s.merge||s.mergeFields?2:0,t,e,i);eC("Data must be an object, but it was:",o,r);const l=Wj(r,o);let u,h;if(s.merge)u=new ti(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const p of s.mergeFields){const g=su(t,p,e);if(!o.contains(g))throw new gt(it.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Kj(d,g)||d.push(g)}u=new ti(d),h=o.fieldTransforms.filter((p=>u.covers(p.field)))}else u=null,h=o.fieldTransforms;return new GY(new yr(l),u,h)}class Zb extends Qb{_toFieldTransform(t){if(t.dataSource!==2)throw t.dataSource===1?t.createError(`${this._methodName}() can only appear at the top level of your update data`):t.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Zb}}class tC extends Qb{_toFieldTransform(t){return new PG(t.path,new Hp)}isEqual(t){return t instanceof tC}}function $j(n,t,e,r){const i=n.createContext(1,t,e);eC("Data must be an object, but it was:",i,r);const s=[],o=yr.empty();Ll(r,((u,h)=>{const d=Yj(t,u,e);h=je(h);const p=i.childContextForFieldPath(d);if(h instanceof Zb)s.push(d);else{const g=Om(h,p);g!=null&&(s.push(d),o.set(d,g))}}));const l=new ti(s);return new Uj(o,l,i.fieldTransforms)}function qj(n,t,e,r,i,s){const o=n.createContext(1,t,e),l=[su(t,r,e)],u=[i];if(s.length%2!=0)throw new gt(it.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push(su(t,s[g])),u.push(s[g+1]);const h=[],d=yr.empty();for(let g=l.length-1;g>=0;--g)if(!Kj(h,l[g])){const v=l[g];let T=u[g];T=je(T);const S=o.childContextForFieldPath(v);if(T instanceof Zb)h.push(v);else{const w=Om(T,S);w!=null&&(h.push(v),d.set(v,w))}}const p=new ti(h);return new Uj(d,p,o.fieldTransforms)}function KY(n,t,e,r=!1){return Om(e,n.createContext(r?4:3,t))}function Om(n,t){if(Gj(n=je(n)))return eC("Unsupported field value:",t,n),Wj(n,t);if(n instanceof Qb)return(function(r,i){if(!zj(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.arrayElement&&t.dataSource!==4)throw t.createError("Nested arrays are not supported");return(function(r,i){const s=[];let o=0;for(const l of r){let u=Om(l,i.childContextForArray(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,t)}return(function(r,i){if((r=je(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return OG(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=ue.fromDate(r);return{timestampValue:uv(i.serializer,s)}}if(r instanceof ue){const s=new ue(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:uv(i.serializer,s)}}if(r instanceof Xs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jr)return{bytesValue:oj(i.serializer,r._byteString)};if(r instanceof Xe){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:V1(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ss)return(function(o,l){const u=o instanceof ss?o.toArray():o;return{mapValue:{fields:{[IV]:{stringValue:PV},[ov]:{arrayValue:{values:u.map((d=>{if(typeof d!="number")throw l.createError("VectorValues must only contain numeric values.");return I1(l.serializer,d)}))}}}}}})(r,i);if(pj(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${Vb(r)}`)})(n,t)}function Wj(n,t){const e={};return AV(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ll(n,((r,i)=>{const s=Om(i,t.childContextForField(r));s!=null&&(e[r]=s)})),{mapValue:{fields:e}}}function Gj(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ue||n instanceof Xs||n instanceof Jr||n instanceof Xe||n instanceof Qb||n instanceof ss||pj(n))}function eC(n,t,e){if(!Gj(e)||!EV(e)){const r=Vb(e);throw r==="an object"?t.createError(n+" a custom object"):t.createError(n+" "+r)}}function su(n,t,e){if((t=je(t))instanceof Xb)return t._internalPath;if(typeof t=="string")return Yj(n,t);throw gv("Field path arguments must be of type string or ",n,!1,void 0,e)}const XY=new RegExp("[~\\*/\\[\\]]");function Yj(n,t,e){if(t.search(XY)>=0)throw gv(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Xb(...t.split("."))._internalPath}catch{throw gv(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function gv(n,t,e,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${t}() called with invalid data`;e&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new gt(it.INVALID_ARGUMENT,l+n+u)}function Kj(n,t){return n.some((e=>e.isEqual(t)))}class Xj{convertValue(t,e="none"){switch(Tl(t)){case 0:return null;case 1:return t.booleanValue;case 2:return sn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(_l(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw Rt(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const r={};return Ll(t,((i,s)=>{r[i]=this.convertValue(s,e)})),r}convertVectorValue(t){const e=t.fields?.[ov].arrayValue?.values?.map((r=>sn(r.doubleValue)));return new ss(e)}convertGeoPoint(t){return new Xs(sn(t.latitude),sn(t.longitude))}convertArray(t,e){return(t.values||[]).map((r=>this.convertValue(r,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const r=Fb(t);return r==null?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(Fp(t));default:return null}}convertTimestamp(t){const e=bl(t);return new ue(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=Ee.fromString(t);ie(dj(r),9688,{name:t});const i=new Bp(r.get(1),r.get(3)),s=new At(r.popFirst(5));return i.isEqual(e)||Xo(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}class nC extends Xj{constructor(t){super(),this.firestore=t}convertBytes(t){return new Jr(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Xe(this.firestore,null,e)}}function Qj(){return new tC("serverTimestamp")}const o2="@firebase/firestore",a2="4.11.0";class yv{constructor(t,e,r,i,s){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new QY(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(t){if(this._document){const e=this._document.data.field(su("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class QY extends yv{data(){return super.data()}}function JY(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new gt(it.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rC{}class iC extends rC{}function Nx(n,t,...e){let r=[];t instanceof rC&&r.push(t),r=r.concat(e),(function(s){const o=s.filter((u=>u instanceof sC)).length,l=s.filter((u=>u instanceof t_)).length;if(o>1||o>0&&l>0)throw new gt(it.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class t_ extends iC{constructor(t,e,r){super(),this._field=t,this._op=e,this._value=r,this.type="where"}static _create(t,e,r){return new t_(t,e,r)}_apply(t){const e=this._parse(t);return Jj(t._query,e),new jl(t.firestore,t.converter,Cx(t._query,e))}_parse(t){const e=Jb(t.firestore);return(function(s,o,l,u,h,d,p){let g;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new gt(it.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){c2(p,d);const T=[];for(const S of p)T.push(l2(u,s,S));g={arrayValue:{values:T}}}else g=l2(u,s,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||c2(p,d),g=KY(l,o,p,d==="in"||d==="not-in");return bn.create(h,d,g)})(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}function Lh(n,t,e){const r=t,i=su("where",n);return t_._create(i,r,e)}class sC extends rC{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new sC(t,e)}_parse(t){const e=this._queryConstraints.map((r=>r._parse(t))).filter((r=>r.getFilters().length>0));return e.length===1?e[0]:fs.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:((function(i,s){let o=i;const l=s.getFlattenedFilters();for(const u of l)Jj(o,u),o=Cx(o,u)})(t._query,e),new jl(t.firestore,t.converter,Cx(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class oC extends iC{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new oC(t,e)}_apply(t){const e=(function(i,s,o){if(i.startAt!==null)throw new gt(it.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new gt(it.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new zp(s,o)})(t._query,this._field,this._direction);return new jl(t.firestore,t.converter,wG(t._query,e))}}function Lx(n,t="asc"){const e=t,r=su("orderBy",n);return oC._create(r,e)}class aC extends iC{constructor(t,e,r){super(),this.type=t,this._limit=e,this._limitType=r}static _create(t,e,r){return new aC(t,e,r)}_apply(t){return new jl(t.firestore,t.converter,lv(t._query,this._limit,this._limitType))}}function ZY(n){return aC._create("limit",n,"F")}function l2(n,t,e){if(typeof(e=je(e))=="string"){if(e==="")throw new gt(it.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!zV(t)&&e.indexOf("/")!==-1)throw new gt(it.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const r=t.path.child(Ee.fromString(e));if(!At.isDocumentKey(r))throw new gt(it.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return wR(n,new At(r))}if(e instanceof Xe)return wR(n,e._key);throw new gt(it.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vb(e)}.`)}function c2(n,t){if(!Array.isArray(n)||n.length===0)throw new gt(it.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Jj(n,t){const e=(function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(e!==null)throw e===t.op?new gt(it.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new gt(it.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}function Zj(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}class tK extends Xj{constructor(t){super(),this.firestore=t}convertBytes(t){return new Jr(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Xe(this.firestore,null,e)}}class Th{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class fl extends yv{constructor(t,e,r,i,s,o){super(t,e,r,i,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new M0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(su("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new gt(it.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=fl._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}fl._jsonSchemaVersion="firestore/documentSnapshot/1.0",fl._jsonSchema={type:_n("string",fl._jsonSchemaVersion),bundleSource:_n("string","DocumentSnapshot"),bundleName:_n("string"),bundle:_n("string")};class M0 extends fl{data(t={}){return super.data(t)}}class Vh{constructor(t,e,r,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Th(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((r=>{t.call(e,new M0(this._firestore,this._userDataWriter,r.key,r,new Th(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new gt(it.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((l=>{const u=new M0(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Th(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const u=new M0(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Th(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,d=-1;return l.type!==0&&(h=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:eK(l.type),doc:u,oldIndex:h,newIndex:d}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new gt(it.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Vh._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=C1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(e.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function eK(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rt(61501,{type:n})}}Vh._jsonSchemaVersion="firestore/querySnapshot/1.0",Vh._jsonSchema={type:_n("string",Vh._jsonSchemaVersion),bundleSource:_n("string","QuerySnapshot"),bundleName:_n("string"),bundle:_n("string")};const nK={maxAttempts:5};function Zd(n,t){if((n=je(n)).firestore!==t)throw new gt(it.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class rK{constructor(t,e){this._firestore=t,this._transaction=e,this._dataReader=Jb(t)}get(t){const e=Zd(t,this._firestore),r=new tK(this._firestore);return this._transaction.lookup([e._key]).then((i=>{if(!i||i.length!==1)return Rt(24041);const s=i[0];if(s.isFoundDocument())return new yv(this._firestore,r,s.key,s,e.converter);if(s.isNoDocument())return new yv(this._firestore,r,e._key,null,e.converter);throw Rt(18433,{doc:s})}))}set(t,e,r){const i=Zd(t,this._firestore),s=Zj(i.converter,e,r),o=Hj(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(t,e,r,...i){const s=Zd(t,this._firestore);let o;return o=typeof(e=je(e))=="string"||e instanceof Xb?qj(this._dataReader,"Transaction.update",s._key,e,r,i):$j(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,o),this}delete(t){const e=Zd(t,this._firestore);return this._transaction.delete(e._key),this}}let iK=class extends rK{constructor(t,e){super(t,e),this._firestore=t}get(t){const e=Zd(t,this._firestore),r=new nC(this._firestore);return super.get(t).then((i=>new fl(this._firestore,r,e._key,i._document,new Th(!1,!1),e.converter)))}};function sK(n,t,e){n=Zs(n,gf);const r={...nK,...e};(function(o){if(o.maxAttempts<1)throw new gt(it.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const i=Kb(n);return BY(i,(s=>t(new iK(n,s))),r)}function e_(n){n=Zs(n,Xe);const t=Zs(n.firestore,gf),e=Kb(t);return VY(e,n._key).then((r=>aK(t,n,r)))}function Vx(n){n=Zs(n,jl);const t=Zs(n.firestore,gf),e=Kb(t),r=new nC(t);return JY(n._query),jY(e,n._query).then((i=>new Vh(t,r,n,i)))}function t3(n,t,e){n=Zs(n,Xe);const r=Zs(n.firestore,gf),i=Zj(n.converter,t,e),s=Jb(r);return e3(r,[Hj(s,"setDoc",n._key,i,n.converter!==null,e).toMutation(n._key,vr.none())])}function oK(n,t,e,...r){n=Zs(n,Xe);const i=Zs(n.firestore,gf),s=Jb(i);let o;return o=typeof(t=je(t))=="string"||t instanceof Xb?qj(s,"updateDoc",n._key,t,e,r):$j(s,"updateDoc",n._key,t),e3(i,[o.toMutation(n._key,vr.exists(!0))])}function e3(n,t){const e=Kb(n);return FY(e,t)}function aK(n,t,e){const r=e.docs.get(t._key),i=new nC(n);return new fl(n,i,t._key,r,new Th(e.hasPendingWrites,e.fromCache),t.converter)}(function(t,e=!0){VW(pu),Zc(new yl("firestore",((r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new gf(new BW(r.getProvider("auth-internal")),new HW(o,r.getProvider("app-check-internal")),oG(o,i),o);return s={useFetchStreams:e,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),Ws(o2,a2,t),Ws(o2,a2,"esm2020")})();var lK="firebase",cK="12.9.0";Ws(lK,cK,"app");const n3="firebasestorage.googleapis.com",r3="storageBucket",uK=120*1e3,hK=600*1e3;class Ze extends so{constructor(t,e,r=0){super(QS(t),`Firebase Storage: ${e} (${QS(t)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ze.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return QS(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Qe;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Qe||(Qe={}));function QS(n){return"storage/"+n}function lC(){const n="An unknown error occurred, please check the error payload for server response.";return new Ze(Qe.UNKNOWN,n)}function fK(n){return new Ze(Qe.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function dK(n){return new Ze(Qe.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function pK(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ze(Qe.UNAUTHENTICATED,n)}function mK(){return new Ze(Qe.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function gK(n){return new Ze(Qe.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function yK(){return new Ze(Qe.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function vK(){return new Ze(Qe.CANCELED,"User canceled the upload/download.")}function bK(n){return new Ze(Qe.INVALID_URL,"Invalid URL '"+n+"'.")}function _K(n){return new Ze(Qe.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function TK(){return new Ze(Qe.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+r3+"' property when initializing the app?")}function SK(){return new Ze(Qe.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function wK(){return new Ze(Qe.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function xK(n){return new Ze(Qe.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function jx(n){return new Ze(Qe.INVALID_ARGUMENT,n)}function i3(){return new Ze(Qe.APP_DELETED,"The Firebase app was deleted.")}function EK(n){return new Ze(Qe.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function pp(n,t){return new Ze(Qe.INVALID_FORMAT,"String does not match format '"+n+"': "+t)}function Ld(n){throw new Ze(Qe.INTERNAL_ERROR,"Internal error: "+n)}class ei{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let r;try{r=ei.makeFromUrl(t,e)}catch{return new ei(t,"")}if(r.path==="")return r;throw _K(t)}static makeFromUrl(t,e){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+i+o,"i"),u={bucket:1,path:3};function h(V){V.path_=decodeURIComponent(V.path)}const d="v[A-Za-z0-9_]+",p=e.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",v=new RegExp(`^https?://${p}/${d}/b/${i}/o${g}`,"i"),T={bucket:1,path:3},S=e===n3?"(?:storage.googleapis.com|storage.cloud.google.com)":e,w="([^?#]*)",E=new RegExp(`^https?://${S}/${i}/${w}`,"i"),P=[{regex:l,indices:u,postModify:s},{regex:v,indices:T,postModify:h},{regex:E,indices:{bucket:1,path:2},postModify:h}];for(let V=0;V<P.length;V++){const N=P[V],q=N.regex.exec(t);if(q){const M=q[N.indices.bucket];let k=q[N.indices.path];k||(k=""),r=new ei(M,k),N.postModify(r);break}}if(r==null)throw bK(t);return r}}class CK{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function AK(n,t,e){let r=1,i=null,s=null,o=!1,l=0;function u(){return l===2}let h=!1;function d(...w){h||(h=!0,t.apply(null,w))}function p(w){i=setTimeout(()=>{i=null,n(v,u())},w)}function g(){s&&clearTimeout(s)}function v(w,...E){if(h){g();return}if(w){g(),d.call(null,w,...E);return}if(u()||o){g(),d.call(null,w,...E);return}r<64&&(r*=2);let P;l===1?(l=2,P=0):P=(r+Math.random())*1e3,p(P)}let T=!1;function S(w){T||(T=!0,g(),!h&&(i!==null?(w||(l=2),clearTimeout(i),p(0)):w||(l=1)))}return p(0),s=setTimeout(()=>{o=!0,S(!0)},e),S}function kK(n){n(!1)}function MK(n){return n!==void 0}function DK(n){return typeof n=="object"&&!Array.isArray(n)}function cC(n){return typeof n=="string"||n instanceof String}function u2(n){return uC()&&n instanceof Blob}function uC(){return typeof Blob<"u"}function h2(n,t,e,r){if(r<t)throw jx(`Invalid value for '${n}'. Expected ${t} or greater.`);if(r>e)throw jx(`Invalid value for '${n}'. Expected ${e} or less.`)}function hC(n,t,e){let r=t;return e==null&&(r=`https://${t}`),`${e}://${r}/v0${n}`}function s3(n){const t=encodeURIComponent;let e="?";for(const r in n)if(n.hasOwnProperty(r)){const i=t(r)+"="+t(n[r]);e=e+i+"&"}return e=e.slice(0,-1),e}var $c;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})($c||($c={}));function OK(n,t){const e=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=t.indexOf(n)!==-1;return e||i||s}class RK{constructor(t,e,r,i,s,o,l,u,h,d,p,g=!0,v=!1){this.url_=t,this.method_=e,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=d,this.connectionFactory_=p,this.retry=g,this.isUsingEmulator=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,S)=>{this.resolve_=T,this.reject_=S,this.start_()})}start_(){const t=(r,i)=>{if(i){r(!1,new Ay(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=l=>{const u=l.loaded,h=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const l=s.getErrorCode()===$c.NO_ERROR,u=s.getStatus();if(!l||OK(u,this.additionalRetryCodes_)&&this.retry){const d=s.getErrorCode()===$c.ABORT;r(!1,new Ay(!1,null,d));return}const h=this.successCodes_.indexOf(u)!==-1;r(!0,new Ay(h,s))})},e=(r,i)=>{const s=this.resolve_,o=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());MK(u)?s(u):s()}catch(u){o(u)}else if(l!==null){const u=lC();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(i.canceled){const u=this.appDelete_?i3():vK();o(u)}else{const u=yK();o(u)}};this.canceled_?e(!1,new Ay(!1,null,!0)):this.backoffId_=AK(t,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&kK(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Ay{constructor(t,e,r){this.wasSuccessCode=t,this.connection=e,this.canceled=!!r}}function IK(n,t){t!==null&&t.length>0&&(n.Authorization="Firebase "+t)}function PK(n,t){n["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function NK(n,t){t&&(n["X-Firebase-GMPID"]=t)}function LK(n,t){t!==null&&(n["X-Firebase-AppCheck"]=t)}function VK(n,t,e,r,i,s,o=!0,l=!1){const u=s3(n.urlParams),h=n.url+u,d=Object.assign({},n.headers);return NK(d,t),IK(d,e),PK(d,s),LK(d,r),new RK(h,n.method,d,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o,l)}function jK(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function FK(...n){const t=jK();if(t!==void 0){const e=new t;for(let r=0;r<n.length;r++)e.append(n[r]);return e.getBlob()}else{if(uC())return new Blob(n);throw new Ze(Qe.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function BK(n,t,e){return n.webkitSlice?n.webkitSlice(t,e):n.mozSlice?n.mozSlice(t,e):n.slice?n.slice(t,e):null}function UK(n){if(typeof atob>"u")throw xK("base-64");return atob(n)}const Hs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class JS{constructor(t,e){this.data=t,this.contentType=e||null}}function zK(n,t){switch(n){case Hs.RAW:return new JS(o3(t));case Hs.BASE64:case Hs.BASE64URL:return new JS(a3(n,t));case Hs.DATA_URL:return new JS($K(t),qK(t))}throw lC()}function o3(n){const t=[];for(let e=0;e<n.length;e++){let r=n.charCodeAt(e);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(e<n.length-1&&(n.charCodeAt(e+1)&64512)===56320))t.push(239,191,189);else{const s=r,o=n.charCodeAt(++e);r=65536|(s&1023)<<10|o&1023,t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(t)}function HK(n){let t;try{t=decodeURIComponent(n)}catch{throw pp(Hs.DATA_URL,"Malformed data URL.")}return o3(t)}function a3(n,t){switch(n){case Hs.BASE64:{const i=t.indexOf("-")!==-1,s=t.indexOf("_")!==-1;if(i||s)throw pp(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Hs.BASE64URL:{const i=t.indexOf("+")!==-1,s=t.indexOf("/")!==-1;if(i||s)throw pp(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let e;try{e=UK(t)}catch(i){throw i.message.includes("polyfill")?i:pp(n,"Invalid character found")}const r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return r}class l3{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(e===null)throw pp(Hs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=e[1]||null;r!=null&&(this.base64=WK(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}}function $K(n){const t=new l3(n);return t.base64?a3(Hs.BASE64,t.rest):HK(t.rest)}function qK(n){return new l3(n).contentType}function WK(n,t){return n.length>=t.length?n.substring(n.length-t.length)===t:!1}class Za{constructor(t,e){let r=0,i="";u2(t)?(this.data_=t,r=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,e){if(u2(this.data_)){const r=this.data_,i=BK(r,t,e);return i===null?null:new Za(i)}else{const r=new Uint8Array(this.data_.buffer,t,e-t);return new Za(r,!0)}}static getBlob(...t){if(uC()){const e=t.map(r=>r instanceof Za?r.data_:r);return new Za(FK.apply(null,e))}else{const e=t.map(o=>cC(o)?zK(Hs.RAW,o).data:o.data_);let r=0;e.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return e.forEach(o=>{for(let l=0;l<o.length;l++)i[s++]=o[l]}),new Za(i,!0)}}uploadData(){return this.data_}}function c3(n){let t;try{t=JSON.parse(n)}catch{return null}return DK(t)?t:null}function GK(n){if(n.length===0)return null;const t=n.lastIndexOf("/");return t===-1?"":n.slice(0,t)}function YK(n,t){const e=t.split("/").filter(r=>r.length>0).join("/");return n.length===0?e:n+"/"+e}function u3(n){const t=n.lastIndexOf("/",n.length-2);return t===-1?n:n.slice(t+1)}function KK(n,t){return t}let dr=class{constructor(t,e,r,i){this.server=t,this.local=e||t,this.writable=!!r,this.xform=i||KK}},ky=null;function XK(n){return!cC(n)||n.length<2?n:u3(n)}function h3(){if(ky)return ky;const n=[];n.push(new dr("bucket")),n.push(new dr("generation")),n.push(new dr("metageneration")),n.push(new dr("name","fullPath",!0));function t(s,o){return XK(o)}const e=new dr("name");e.xform=t,n.push(e);function r(s,o){return o!==void 0?Number(o):o}const i=new dr("size");return i.xform=r,n.push(i),n.push(new dr("timeCreated")),n.push(new dr("updated")),n.push(new dr("md5Hash",null,!0)),n.push(new dr("cacheControl",null,!0)),n.push(new dr("contentDisposition",null,!0)),n.push(new dr("contentEncoding",null,!0)),n.push(new dr("contentLanguage",null,!0)),n.push(new dr("contentType",null,!0)),n.push(new dr("metadata","customMetadata",!0)),ky=n,ky}function QK(n,t){function e(){const r=n.bucket,i=n.fullPath,s=new ei(r,i);return t._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:e})}function JK(n,t,e){const r={};r.type="file";const i=e.length;for(let s=0;s<i;s++){const o=e[s];r[o.local]=o.xform(r,t[o.server])}return QK(r,n),r}function f3(n,t,e){const r=c3(t);return r===null?null:JK(n,r,e)}function ZK(n,t,e,r){const i=c3(t);if(i===null||!cC(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(h=>{const d=n.bucket,p=n.fullPath,g="/b/"+o(d)+"/o/"+o(p),v=hC(g,e,r),T=s3({alt:"media",token:h});return v+T})[0]}function tX(n,t){const e={},r=t.length;for(let i=0;i<r;i++){const s=t[i];s.writable&&(e[s.server]=n[s.local])}return JSON.stringify(e)}class d3{constructor(t,e,r,i){this.url=t,this.method=e,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function p3(n){if(!n)throw lC()}function eX(n,t){function e(r,i){const s=f3(n,i,t);return p3(s!==null),s}return e}function nX(n,t){function e(r,i){const s=f3(n,i,t);return p3(s!==null),ZK(s,i,n.host,n._protocol)}return e}function m3(n){function t(e,r){let i;return e.getStatus()===401?e.getErrorText().includes("Firebase App Check token is invalid")?i=mK():i=pK():e.getStatus()===402?i=dK(n.bucket):e.getStatus()===403?i=gK(n.path):i=r,i.status=e.getStatus(),i.serverResponse=r.serverResponse,i}return t}function rX(n){const t=m3(n);function e(r,i){let s=t(r,i);return r.getStatus()===404&&(s=fK(n.path)),s.serverResponse=i.serverResponse,s}return e}function iX(n,t,e){const r=t.fullServerUrl(),i=hC(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,l=new d3(i,s,nX(n,e),o);return l.errorHandler=rX(t),l}function sX(n,t){return n&&n.contentType||t&&t.type()||"application/octet-stream"}function oX(n,t,e){const r=Object.assign({},e);return r.fullPath=n.path,r.size=t.size(),r.contentType||(r.contentType=sX(null,t)),r}function aX(n,t,e,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let P="";for(let V=0;V<2;V++)P=P+Math.random().toString().slice(2);return P}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const h=oX(t,r,i),d=tX(h,e),p="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+u+`\r
Content-Type: `+h.contentType+`\r
\r
`,g=`\r
--`+u+"--",v=Za.getBlob(p,r,g);if(v===null)throw SK();const T={name:h.fullPath},S=hC(s,n.host,n._protocol),w="POST",E=n.maxUploadRetryTime,D=new d3(S,w,eX(n,e),E);return D.urlParams=T,D.headers=o,D.body=v.uploadData(),D.errorHandler=m3(t),D}class lX{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=$c.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=$c.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=$c.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,e,r,i,s){if(this.sent_)throw Ld("cannot .send() more than once");if(Rl(t)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(e,t,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ld("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ld("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ld("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ld("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class cX extends lX{initXhr(){this.xhr_.responseType="text"}}function g3(){return new cX}class ou{constructor(t,e){this._service=t,e instanceof ei?this._location=e:this._location=ei.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new ou(t,e)}get root(){const t=new ei(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return u3(this._location.path)}get storage(){return this._service}get parent(){const t=GK(this._location.path);if(t===null)return null;const e=new ei(this._location.bucket,t);return new ou(this._service,e)}_throwIfRoot(t){if(this._location.path==="")throw EK(t)}}function uX(n,t,e){n._throwIfRoot("uploadBytes");const r=aX(n.storage,n._location,h3(),new Za(t,!0),e);return n.storage.makeRequestWithTokens(r,g3).then(i=>({metadata:i,ref:n}))}function hX(n){n._throwIfRoot("getDownloadURL");const t=iX(n.storage,n._location,h3());return n.storage.makeRequestWithTokens(t,g3).then(e=>{if(e===null)throw wK();return e})}function fX(n,t){const e=YK(n._location.path,t),r=new ei(n._location.bucket,e);return new ou(n.storage,r)}function dX(n){return/^[A-Za-z]+:\/\//.test(n)}function pX(n,t){return new ou(n,t)}function y3(n,t){if(n instanceof fC){const e=n;if(e._bucket==null)throw TK();const r=new ou(e,e._bucket);return t!=null?y3(r,t):r}else return t!==void 0?fX(n,t):n}function mX(n,t){if(t&&dX(t)){if(n instanceof fC)return pX(n,t);throw jx("To use ref(service, url), the first argument must be a Storage instance.")}else return y3(n,t)}function f2(n,t){const e=t?.[r3];return e==null?null:ei.makeFromBucketSpec(e,n)}function gX(n,t,e,r={}){n.host=`${t}:${e}`;const i=Rl(t);i&&(u1(`https://${n.host}/b`),h1("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:OL(s,n.app.options.projectId))}class fC{constructor(t,e,r,i,s,o=!1){this.app=t,this._authProvider=e,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=n3,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=uK,this._maxUploadRetryTime=hK,this._requests=new Set,i!=null?this._bucket=ei.makeFromBucketSpec(i,this._host):this._bucket=f2(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=ei.makeFromBucketSpec(this._url,t):this._bucket=f2(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){h2("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){h2("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(e!==null)return e.accessToken}return null}async _getAppCheckToken(){if(Vr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new ou(this,t)}_makeRequest(t,e,r,i,s=!0){if(this._deleted)return new CK(i3());{const o=VK(t,this._appId,r,i,e,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,e){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,r,i).getPromise()}}const d2="@firebase/storage",p2="0.14.0";const v3="storage";function b3(n,t,e){return n=je(n),uX(n,t,e)}function _3(n){return n=je(n),hX(n)}function T3(n,t){return n=je(n),mX(n,t)}function yX(n=p1(),t){n=je(n);const r=Ib(n,v3).getImmediate({identifier:t}),i=kL("storage");return i&&vX(r,...i),r}function vX(n,t,e,r={}){gX(n,t,e,r)}function bX(n,{instanceIdentifier:t}){const e=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new fC(e,r,i,t,pu)}function _X(){Zc(new yl(v3,bX,"PUBLIC").setMultipleInstances(!0)),Ws(d2,p2,""),Ws(d2,p2,"esm2020")}_X();const TX={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0},dC=PL(TX),Vd=NW(dC),ni=$Y(dC),S3=yX(dC),w3=L.createContext(null),SX=new No;async function m2(n){const t=Ho(ni,"users",n.uid);(await e_(t)).exists()||await t3(t,{name:n.displayName||"",email:n.email||"",streak:0,longestStreak:0,theme:"pastel-pink",darkMode:!1,pinHash:null,lastEntryDate:null,createdAt:Qj()})}function wX({children:n}){const[t,e]=L.useState(null),[r,i]=L.useState(!0);L.useEffect(()=>w8(Vd,async v=>{v?(await m2(v),e(v)):e(null),i(!1)}),[]);const p={user:t,loading:r,signInWithGoogle:async()=>{const g=await $8(Vd,SX);await m2(g.user)},signInWithEmail:async(g,v)=>{await _8(Vd,g,v)},signUp:async(g,v,T)=>{const S=await b8(Vd,g,v),w=Ho(ni,"users",S.user.uid);await t3(w,{name:T||"",email:S.user.email||"",streak:0,longestStreak:0,theme:"pastel-pink",darkMode:!1,pinHash:null,lastEntryDate:null,createdAt:Qj()})},signOut:async()=>{await x8(Vd)},verifyPin:async g=>{if(!t)return!1;const v=Ho(ni,"users",t.uid),T=await e_(v);if(!T.exists())return!1;const S=T.data();return S.pinHash?S.pinHash===btoa(g):!1},setPin:async g=>{if(!t)return;const v=Ho(ni,"users",t.uid);await oK(v,{pinHash:btoa(g)})}};return B.jsx(w3.Provider,{value:p,children:n})}function Rm(){const n=L.useContext(w3);if(n===null)throw new Error("useAuth must be used within an AuthProvider");return n}const xX=[{to:"/dashboard",label:"Dashboard",icon:""},{to:"/editor",label:"New Entry",icon:""},{to:"/calendar",label:"Calendar",icon:""}];function EX(){return B.jsxs("div",{className:"min-h-screen flex bg-[var(--color-background)]",children:[B.jsxs("aside",{className:"w-56 bg-[var(--color-surface)] border-r border-pink-100 flex flex-col shadow-sm",children:[B.jsx("div",{className:"p-5 border-b border-pink-100",children:B.jsx("h1",{className:"font-['Pacifico'] text-2xl text-pink-300",children:"DearMe "})}),B.jsx("nav",{className:"flex-1 p-3 flex flex-col gap-1",children:xX.map(({to:n,label:t,icon:e})=>B.jsxs(SL,{to:n,className:({isActive:r})=>`flex items-center gap-3 px-4 py-3 rounded-xl font-['Poppins'] text-sm transition-colors ${r?"bg-pink-100 text-pink-600 font-medium":"text-[var(--color-text)] hover:bg-pink-50"}`,children:[B.jsx("span",{className:"text-lg",children:e}),t]},n))}),B.jsx("div",{className:"p-3 border-t border-pink-100",children:B.jsxs("button",{className:"flex items-center gap-3 w-full px-4 py-3 rounded-xl font-['Poppins'] text-sm text-[var(--color-text)] hover:bg-red-50 hover:text-red-400 transition-colors cursor-pointer",children:[B.jsx("span",{className:"text-lg",children:""}),"Sign Out"]})})]}),B.jsx("main",{className:"flex-1 overflow-y-auto",children:B.jsx(vL,{})})]})}function CX(){const{user:n,loading:t}=Rm();return t?B.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[var(--color-background)]",children:B.jsxs("div",{className:"animate-pulse flex flex-col items-center gap-3",children:[B.jsx("div",{className:"w-12 h-12 rounded-full bg-pink-200"}),B.jsx("p",{className:"font-['Poppins'] text-sm text-pink-300",children:"Loading..."})]})}):n?B.jsx(vL,{}):B.jsx(yL,{to:"/login",replace:!0})}const pC=L.createContext({});function mC(n){const t=L.useRef(null);return t.current===null&&(t.current=n()),t.current}const x3=typeof window<"u",E3=x3?L.useLayoutEffect:L.useEffect,n_=L.createContext(null);function gC(n,t){n.indexOf(t)===-1&&n.push(t)}function vv(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}const eo=(n,t,e)=>e>t?t:e<n?n:e;let yC=()=>{};const Jo={},C3=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function A3(n){return typeof n=="object"&&n!==null}const k3=n=>/^0[^.\s]+$/u.test(n);function M3(n){let t;return()=>(t===void 0&&(t=n()),t)}const Mi=n=>n,AX=(n,t)=>e=>t(n(e)),Im=(...n)=>n.reduce(AX),Wp=(n,t,e)=>{const r=t-n;return r===0?1:(e-n)/r};class vC{constructor(){this.subscriptions=[]}add(t){return gC(this.subscriptions,t),()=>vv(this.subscriptions,t)}notify(t,e,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](t,e,r);else for(let s=0;s<i;s++){const o=this.subscriptions[s];o&&o(t,e,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const as=n=>n*1e3,ki=n=>n/1e3;function D3(n,t){return t?n*(1e3/t):0}const O3=(n,t,e)=>(((1-3*e+3*t)*n+(3*e-6*t))*n+3*t)*n,kX=1e-7,MX=12;function DX(n,t,e,r,i){let s,o,l=0;do o=t+(e-t)/2,s=O3(o,r,i)-n,s>0?e=o:t=o;while(Math.abs(s)>kX&&++l<MX);return o}function Pm(n,t,e,r){if(n===t&&e===r)return Mi;const i=s=>DX(s,0,1,n,e);return s=>s===0||s===1?s:O3(i(s),t,r)}const R3=n=>t=>t<=.5?n(2*t)/2:(2-n(2*(1-t)))/2,I3=n=>t=>1-n(1-t),P3=Pm(.33,1.53,.69,.99),bC=I3(P3),N3=R3(bC),L3=n=>(n*=2)<1?.5*bC(n):.5*(2-Math.pow(2,-10*(n-1))),_C=n=>1-Math.sin(Math.acos(n)),V3=I3(_C),j3=R3(_C),OX=Pm(.42,0,1,1),RX=Pm(0,0,.58,1),F3=Pm(.42,0,.58,1),IX=n=>Array.isArray(n)&&typeof n[0]!="number",B3=n=>Array.isArray(n)&&typeof n[0]=="number",PX={linear:Mi,easeIn:OX,easeInOut:F3,easeOut:RX,circIn:_C,circInOut:j3,circOut:V3,backIn:bC,backInOut:N3,backOut:P3,anticipate:L3},NX=n=>typeof n=="string",g2=n=>{if(B3(n)){yC(n.length===4);const[t,e,r,i]=n;return Pm(t,e,r,i)}else if(NX(n))return PX[n];return n},My=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function LX(n,t){let e=new Set,r=new Set,i=!1,s=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function u(d){o.has(d)&&(h.schedule(d),n()),d(l)}const h={schedule:(d,p=!1,g=!1)=>{const T=g&&i?e:r;return p&&o.add(d),T.has(d)||T.add(d),d},cancel:d=>{r.delete(d),o.delete(d)},process:d=>{if(l=d,i){s=!0;return}i=!0,[e,r]=[r,e],e.forEach(u),e.clear(),i=!1,s&&(s=!1,h.process(d))}};return h}const VX=40;function U3(n,t){let e=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>e=!0,o=My.reduce((P,V)=>(P[V]=LX(s),P),{}),{setup:l,read:u,resolveKeyframes:h,preUpdate:d,update:p,preRender:g,render:v,postRender:T}=o,S=()=>{const P=Jo.useManualTiming?i.timestamp:performance.now();e=!1,Jo.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(P-i.timestamp,VX),1)),i.timestamp=P,i.isProcessing=!0,l.process(i),u.process(i),h.process(i),d.process(i),p.process(i),g.process(i),v.process(i),T.process(i),i.isProcessing=!1,e&&t&&(r=!1,n(S))},w=()=>{e=!0,r=!0,i.isProcessing||n(S)};return{schedule:My.reduce((P,V)=>{const N=o[V];return P[V]=(q,M=!1,k=!1)=>(e||w(),N.schedule(q,M,k)),P},{}),cancel:P=>{for(let V=0;V<My.length;V++)o[My[V]].cancel(P)},state:i,steps:o}}const{schedule:De,cancel:xl,state:Gn,steps:ZS}=U3(typeof requestAnimationFrame<"u"?requestAnimationFrame:Mi,!0);let D0;function jX(){D0=void 0}const br={now:()=>(D0===void 0&&br.set(Gn.isProcessing||Jo.useManualTiming?Gn.timestamp:performance.now()),D0),set:n=>{D0=n,queueMicrotask(jX)}},z3=n=>t=>typeof t=="string"&&t.startsWith(n),H3=z3("--"),FX=z3("var(--"),TC=n=>FX(n)?BX.test(n.split("/*")[0].trim()):!1,BX=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function y2(n){return typeof n!="string"?!1:n.split("/*")[0].includes("var(--")}const yf={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Gp={...yf,transform:n=>eo(0,1,n)},Dy={...yf,default:1},mp=n=>Math.round(n*1e5)/1e5,SC=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function UX(n){return n==null}const zX=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,wC=(n,t)=>e=>!!(typeof e=="string"&&zX.test(e)&&e.startsWith(n)||t&&!UX(e)&&Object.prototype.hasOwnProperty.call(e,t)),$3=(n,t,e)=>r=>{if(typeof r!="string")return r;const[i,s,o,l]=r.match(SC);return{[n]:parseFloat(i),[t]:parseFloat(s),[e]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},HX=n=>eo(0,255,n),tw={...yf,transform:n=>Math.round(HX(n))},Nc={test:wC("rgb","red"),parse:$3("red","green","blue"),transform:({red:n,green:t,blue:e,alpha:r=1})=>"rgba("+tw.transform(n)+", "+tw.transform(t)+", "+tw.transform(e)+", "+mp(Gp.transform(r))+")"};function $X(n){let t="",e="",r="",i="";return n.length>5?(t=n.substring(1,3),e=n.substring(3,5),r=n.substring(5,7),i=n.substring(7,9)):(t=n.substring(1,2),e=n.substring(2,3),r=n.substring(3,4),i=n.substring(4,5),t+=t,e+=e,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(e,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const Fx={test:wC("#"),parse:$X,transform:Nc.transform},Nm=n=>({test:t=>typeof t=="string"&&t.endsWith(n)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${n}`}),qa=Nm("deg"),Qs=Nm("%"),St=Nm("px"),qX=Nm("vh"),WX=Nm("vw"),v2={...Qs,parse:n=>Qs.parse(n)/100,transform:n=>Qs.transform(n*100)},Sh={test:wC("hsl","hue"),parse:$3("hue","saturation","lightness"),transform:({hue:n,saturation:t,lightness:e,alpha:r=1})=>"hsla("+Math.round(n)+", "+Qs.transform(mp(t))+", "+Qs.transform(mp(e))+", "+mp(Gp.transform(r))+")"},vn={test:n=>Nc.test(n)||Fx.test(n)||Sh.test(n),parse:n=>Nc.test(n)?Nc.parse(n):Sh.test(n)?Sh.parse(n):Fx.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?Nc.transform(n):Sh.transform(n),getAnimatableNone:n=>{const t=vn.parse(n);return t.alpha=0,vn.transform(t)}},GX=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function YX(n){return isNaN(n)&&typeof n=="string"&&(n.match(SC)?.length||0)+(n.match(GX)?.length||0)>0}const q3="number",W3="color",KX="var",XX="var(",b2="${}",QX=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Yp(n){const t=n.toString(),e=[],r={color:[],number:[],var:[]},i=[];let s=0;const l=t.replace(QX,u=>(vn.test(u)?(r.color.push(s),i.push(W3),e.push(vn.parse(u))):u.startsWith(XX)?(r.var.push(s),i.push(KX),e.push(u)):(r.number.push(s),i.push(q3),e.push(parseFloat(u))),++s,b2)).split(b2);return{values:e,split:l,indexes:r,types:i}}function G3(n){return Yp(n).values}function Y3(n){const{split:t,types:e}=Yp(n),r=t.length;return i=>{let s="";for(let o=0;o<r;o++)if(s+=t[o],i[o]!==void 0){const l=e[o];l===q3?s+=mp(i[o]):l===W3?s+=vn.transform(i[o]):s+=i[o]}return s}}const JX=n=>typeof n=="number"?0:vn.test(n)?vn.getAnimatableNone(n):n;function ZX(n){const t=G3(n);return Y3(n)(t.map(JX))}const ls={test:YX,parse:G3,createTransformer:Y3,getAnimatableNone:ZX};function ew(n,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+(t-n)*6*e:e<1/2?t:e<2/3?n+(t-n)*(2/3-e)*6:n}function tQ({hue:n,saturation:t,lightness:e,alpha:r}){n/=360,t/=100,e/=100;let i=0,s=0,o=0;if(!t)i=s=o=e;else{const l=e<.5?e*(1+t):e+t-e*t,u=2*e-l;i=ew(u,l,n+1/3),s=ew(u,l,n),o=ew(u,l,n-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:r}}function bv(n,t){return e=>e>0?t:n}const ze=(n,t,e)=>n+(t-n)*e,nw=(n,t,e)=>{const r=n*n,i=e*(t*t-r)+r;return i<0?0:Math.sqrt(i)},eQ=[Fx,Nc,Sh],nQ=n=>eQ.find(t=>t.test(n));function _2(n){const t=nQ(n);if(!t)return!1;let e=t.parse(n);return t===Sh&&(e=tQ(e)),e}const T2=(n,t)=>{const e=_2(n),r=_2(t);if(!e||!r)return bv(n,t);const i={...e};return s=>(i.red=nw(e.red,r.red,s),i.green=nw(e.green,r.green,s),i.blue=nw(e.blue,r.blue,s),i.alpha=ze(e.alpha,r.alpha,s),Nc.transform(i))},Bx=new Set(["none","hidden"]);function rQ(n,t){return Bx.has(n)?e=>e<=0?n:t:e=>e>=1?t:n}function iQ(n,t){return e=>ze(n,t,e)}function xC(n){return typeof n=="number"?iQ:typeof n=="string"?TC(n)?bv:vn.test(n)?T2:aQ:Array.isArray(n)?K3:typeof n=="object"?vn.test(n)?T2:sQ:bv}function K3(n,t){const e=[...n],r=e.length,i=n.map((s,o)=>xC(s)(s,t[o]));return s=>{for(let o=0;o<r;o++)e[o]=i[o](s);return e}}function sQ(n,t){const e={...n,...t},r={};for(const i in e)n[i]!==void 0&&t[i]!==void 0&&(r[i]=xC(n[i])(n[i],t[i]));return i=>{for(const s in r)e[s]=r[s](i);return e}}function oQ(n,t){const e=[],r={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const s=t.types[i],o=n.indexes[s][r[s]],l=n.values[o]??0;e[i]=l,r[s]++}return e}const aQ=(n,t)=>{const e=ls.createTransformer(t),r=Yp(n),i=Yp(t);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?Bx.has(n)&&!i.values.length||Bx.has(t)&&!r.values.length?rQ(n,t):Im(K3(oQ(r,i),i.values),e):bv(n,t)};function X3(n,t,e){return typeof n=="number"&&typeof t=="number"&&typeof e=="number"?ze(n,t,e):xC(n)(n,t)}const lQ=n=>{const t=({timestamp:e})=>n(e);return{start:(e=!0)=>De.update(t,e),stop:()=>xl(t),now:()=>Gn.isProcessing?Gn.timestamp:br.now()}},Q3=(n,t,e=10)=>{let r="";const i=Math.max(Math.round(t/e),2);for(let s=0;s<i;s++)r+=Math.round(n(s/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},_v=2e4;function EC(n){let t=0;const e=50;let r=n.next(t);for(;!r.done&&t<_v;)t+=e,r=n.next(t);return t>=_v?1/0:t}function cQ(n,t=100,e){const r=e({...n,keyframes:[0,t]}),i=Math.min(EC(r),_v);return{type:"keyframes",ease:s=>r.next(i*s).value/t,duration:ki(i)}}const uQ=5;function J3(n,t,e){const r=Math.max(t-uQ,0);return D3(e-n(r),t-r)}const Ye={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},rw=.001;function hQ({duration:n=Ye.duration,bounce:t=Ye.bounce,velocity:e=Ye.velocity,mass:r=Ye.mass}){let i,s,o=1-t;o=eo(Ye.minDamping,Ye.maxDamping,o),n=eo(Ye.minDuration,Ye.maxDuration,ki(n)),o<1?(i=h=>{const d=h*o,p=d*n,g=d-e,v=Ux(h,o),T=Math.exp(-p);return rw-g/v*T},s=h=>{const p=h*o*n,g=p*e+e,v=Math.pow(o,2)*Math.pow(h,2)*n,T=Math.exp(-p),S=Ux(Math.pow(h,2),o);return(-i(h)+rw>0?-1:1)*((g-v)*T)/S}):(i=h=>{const d=Math.exp(-h*n),p=(h-e)*n+1;return-rw+d*p},s=h=>{const d=Math.exp(-h*n),p=(e-h)*(n*n);return d*p});const l=5/n,u=dQ(i,s,l);if(n=as(n),isNaN(u))return{stiffness:Ye.stiffness,damping:Ye.damping,duration:n};{const h=Math.pow(u,2)*r;return{stiffness:h,damping:o*2*Math.sqrt(r*h),duration:n}}}const fQ=12;function dQ(n,t,e){let r=e;for(let i=1;i<fQ;i++)r=r-n(r)/t(r);return r}function Ux(n,t){return n*Math.sqrt(1-t*t)}const pQ=["duration","bounce"],mQ=["stiffness","damping","mass"];function S2(n,t){return t.some(e=>n[e]!==void 0)}function gQ(n){let t={velocity:Ye.velocity,stiffness:Ye.stiffness,damping:Ye.damping,mass:Ye.mass,isResolvedFromDuration:!1,...n};if(!S2(n,mQ)&&S2(n,pQ))if(t.velocity=0,n.visualDuration){const e=n.visualDuration,r=2*Math.PI/(e*1.2),i=r*r,s=2*eo(.05,1,1-(n.bounce||0))*Math.sqrt(i);t={...t,mass:Ye.mass,stiffness:i,damping:s}}else{const e=hQ({...n,velocity:0});t={...t,...e,mass:Ye.mass},t.isResolvedFromDuration=!0}return t}function Tv(n=Ye.visualDuration,t=Ye.bounce){const e=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:t}:n;let{restSpeed:r,restDelta:i}=e;const s=e.keyframes[0],o=e.keyframes[e.keyframes.length-1],l={done:!1,value:s},{stiffness:u,damping:h,mass:d,duration:p,velocity:g,isResolvedFromDuration:v}=gQ({...e,velocity:-ki(e.velocity||0)}),T=g||0,S=h/(2*Math.sqrt(u*d)),w=o-s,E=ki(Math.sqrt(u/d)),D=Math.abs(w)<5;r||(r=D?Ye.restSpeed.granular:Ye.restSpeed.default),i||(i=D?Ye.restDelta.granular:Ye.restDelta.default);let P;if(S<1){const N=Ux(E,S);P=q=>{const M=Math.exp(-S*E*q);return o-M*((T+S*E*w)/N*Math.sin(N*q)+w*Math.cos(N*q))}}else if(S===1)P=N=>o-Math.exp(-E*N)*(w+(T+E*w)*N);else{const N=E*Math.sqrt(S*S-1);P=q=>{const M=Math.exp(-S*E*q),k=Math.min(N*q,300);return o-M*((T+S*E*w)*Math.sinh(k)+N*w*Math.cosh(k))/N}}const V={calculatedDuration:v&&p||null,next:N=>{const q=P(N);if(v)l.done=N>=p;else{let M=N===0?T:0;S<1&&(M=N===0?as(T):J3(P,N,q));const k=Math.abs(M)<=r,R=Math.abs(o-q)<=i;l.done=k&&R}return l.value=l.done?o:q,l},toString:()=>{const N=Math.min(EC(V),_v),q=Q3(M=>V.next(N*M).value,N,30);return N+"ms "+q},toTransition:()=>{}};return V}Tv.applyToOptions=n=>{const t=cQ(n,100,Tv);return n.ease=t.ease,n.duration=as(t.duration),n.type="keyframes",n};function zx({keyframes:n,velocity:t=0,power:e=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:o,min:l,max:u,restDelta:h=.5,restSpeed:d}){const p=n[0],g={done:!1,value:p},v=k=>l!==void 0&&k<l||u!==void 0&&k>u,T=k=>l===void 0?u:u===void 0||Math.abs(l-k)<Math.abs(u-k)?l:u;let S=e*t;const w=p+S,E=o===void 0?w:o(w);E!==w&&(S=E-p);const D=k=>-S*Math.exp(-k/r),P=k=>E+D(k),V=k=>{const R=D(k),F=P(k);g.done=Math.abs(R)<=h,g.value=g.done?E:F};let N,q;const M=k=>{v(g.value)&&(N=k,q=Tv({keyframes:[g.value,T(g.value)],velocity:J3(P,k,g.value),damping:i,stiffness:s,restDelta:h,restSpeed:d}))};return M(0),{calculatedDuration:null,next:k=>{let R=!1;return!q&&N===void 0&&(R=!0,V(k),M(k)),N!==void 0&&k>=N?q.next(k-N):(!R&&V(k),g)}}}function yQ(n,t,e){const r=[],i=e||Jo.mix||X3,s=n.length-1;for(let o=0;o<s;o++){let l=i(n[o],n[o+1]);if(t){const u=Array.isArray(t)?t[o]||Mi:t;l=Im(u,l)}r.push(l)}return r}function vQ(n,t,{clamp:e=!0,ease:r,mixer:i}={}){const s=n.length;if(yC(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const o=n[0]===n[1];n[0]>n[s-1]&&(n=[...n].reverse(),t=[...t].reverse());const l=yQ(t,r,i),u=l.length,h=d=>{if(o&&d<n[0])return t[0];let p=0;if(u>1)for(;p<n.length-2&&!(d<n[p+1]);p++);const g=Wp(n[p],n[p+1],d);return l[p](g)};return e?d=>h(eo(n[0],n[s-1],d)):h}function bQ(n,t){const e=n[n.length-1];for(let r=1;r<=t;r++){const i=Wp(0,t,r);n.push(ze(e,1,i))}}function _Q(n){const t=[0];return bQ(t,n.length-1),t}function TQ(n,t){return n.map(e=>e*t)}function SQ(n,t){return n.map(()=>t||F3).splice(0,n.length-1)}function gp({duration:n=300,keyframes:t,times:e,ease:r="easeInOut"}){const i=IX(r)?r.map(g2):g2(r),s={done:!1,value:t[0]},o=TQ(e&&e.length===t.length?e:_Q(t),n),l=vQ(o,t,{ease:Array.isArray(i)?i:SQ(t,i)});return{calculatedDuration:n,next:u=>(s.value=l(u),s.done=u>=n,s)}}const wQ=n=>n!==null;function CC(n,{repeat:t,repeatType:e="loop"},r,i=1){const s=n.filter(wQ),l=i<0||t&&e!=="loop"&&t%2===1?0:s.length-1;return!l||r===void 0?s[l]:r}const xQ={decay:zx,inertia:zx,tween:gp,keyframes:gp,spring:Tv};function Z3(n){typeof n.type=="string"&&(n.type=xQ[n.type])}class AC{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,e){return this.finished.then(t,e)}}const EQ=n=>n/100;class kC extends AC{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:e}=this.options;e&&e.updatedAt!==br.now()&&this.tick(br.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;Z3(t);const{type:e=gp,repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:o=0}=t;let{keyframes:l}=t;const u=e||gp;u!==gp&&typeof l[0]!="number"&&(this.mixKeyframes=Im(EQ,X3(l[0],l[1])),l=[0,100]);const h=u({...t,keyframes:l});s==="mirror"&&(this.mirroredGenerator=u({...t,keyframes:[...l].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=EC(h));const{calculatedDuration:d}=h;this.calculatedDuration=d,this.resolvedDuration=d+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=h}updateTime(t){const e=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=e}tick(t,e=!1){const{generator:r,totalDuration:i,mixKeyframes:s,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:u}=this;if(this.startTime===null)return r.next(0);const{delay:h=0,keyframes:d,repeat:p,repeatType:g,repeatDelay:v,type:T,onUpdate:S,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-i/this.speed,this.startTime)),e?this.currentTime=t:this.updateTime(t);const E=this.currentTime-h*(this.playbackSpeed>=0?1:-1),D=this.playbackSpeed>=0?E<0:E>i;this.currentTime=Math.max(E,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let P=this.currentTime,V=r;if(p){const k=Math.min(this.currentTime,i)/l;let R=Math.floor(k),F=k%1;!F&&k>=1&&(F=1),F===1&&R--,R=Math.min(R,p+1),R%2&&(g==="reverse"?(F=1-F,v&&(F-=v/l)):g==="mirror"&&(V=o)),P=eo(0,1,F)*l}const N=D?{done:!1,value:d[0]}:V.next(P);s&&(N.value=s(N.value));let{done:q}=N;!D&&u!==null&&(q=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const M=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&q);return M&&T!==zx&&(N.value=CC(d,this.options,w,this.speed)),S&&S(N.value),M&&this.finish(),N}then(t,e){return this.finished.then(t,e)}get duration(){return ki(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+ki(t)}get time(){return ki(this.currentTime)}set time(t){t=as(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(br.now());const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=ki(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=lQ,startTime:e}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),this.options.onPlay?.();const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=e??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(br.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function CQ(n){for(let t=1;t<n.length;t++)n[t]??(n[t]=n[t-1])}const Lc=n=>n*180/Math.PI,Hx=n=>{const t=Lc(Math.atan2(n[1],n[0]));return $x(t)},AQ={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:Hx,rotateZ:Hx,skewX:n=>Lc(Math.atan(n[1])),skewY:n=>Lc(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},$x=n=>(n=n%360,n<0&&(n+=360),n),w2=Hx,x2=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),E2=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),kQ={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:x2,scaleY:E2,scale:n=>(x2(n)+E2(n))/2,rotateX:n=>$x(Lc(Math.atan2(n[6],n[5]))),rotateY:n=>$x(Lc(Math.atan2(-n[2],n[0]))),rotateZ:w2,rotate:w2,skewX:n=>Lc(Math.atan(n[4])),skewY:n=>Lc(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function qx(n){return n.includes("scale")?1:0}function Wx(n,t){if(!n||n==="none")return qx(t);const e=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(e)r=kQ,i=e;else{const l=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=AQ,i=l}if(!i)return qx(t);const s=r[t],o=i[1].split(",").map(DQ);return typeof s=="function"?s(o):o[s]}const MQ=(n,t)=>{const{transform:e="none"}=getComputedStyle(n);return Wx(e,t)};function DQ(n){return parseFloat(n.trim())}const vf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],bf=new Set(vf),C2=n=>n===yf||n===St,OQ=new Set(["x","y","z"]),RQ=vf.filter(n=>!OQ.has(n));function IQ(n){const t=[];return RQ.forEach(e=>{const r=n.getValue(e);r!==void 0&&(t.push([e,r.get()]),r.set(e.startsWith("scale")?1:0))}),t}const il={width:({x:n},{paddingLeft:t="0",paddingRight:e="0"})=>n.max-n.min-parseFloat(t)-parseFloat(e),height:({y:n},{paddingTop:t="0",paddingBottom:e="0"})=>n.max-n.min-parseFloat(t)-parseFloat(e),top:(n,{top:t})=>parseFloat(t),left:(n,{left:t})=>parseFloat(t),bottom:({y:n},{top:t})=>parseFloat(t)+(n.max-n.min),right:({x:n},{left:t})=>parseFloat(t)+(n.max-n.min),x:(n,{transform:t})=>Wx(t,"x"),y:(n,{transform:t})=>Wx(t,"y")};il.translateX=il.x;il.translateY=il.y;const qc=new Set;let Gx=!1,Yx=!1,Kx=!1;function tF(){if(Yx){const n=Array.from(qc).filter(r=>r.needsMeasurement),t=new Set(n.map(r=>r.element)),e=new Map;t.forEach(r=>{const i=IQ(r);i.length&&(e.set(r,i),r.render())}),n.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const i=e.get(r);i&&i.forEach(([s,o])=>{r.getValue(s)?.set(o)})}),n.forEach(r=>r.measureEndState()),n.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}Yx=!1,Gx=!1,qc.forEach(n=>n.complete(Kx)),qc.clear()}function eF(){qc.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(Yx=!0)})}function PQ(){Kx=!0,eF(),tF(),Kx=!1}class MC{constructor(t,e,r,i,s,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=r,this.motionValue=i,this.element=s,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(qc.add(this),Gx||(Gx=!0,De.read(eF),De.resolveKeyframes(tF))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:r,motionValue:i}=this;if(t[0]===null){const s=i?.get(),o=t[t.length-1];if(s!==void 0)t[0]=s;else if(r&&e){const l=r.readValue(e,o);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=o),i&&s===void 0&&i.set(t[0])}CQ(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),qc.delete(this)}cancel(){this.state==="scheduled"&&(qc.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const NQ=n=>n.startsWith("--");function LQ(n,t,e){NQ(t)?n.style.setProperty(t,e):n.style[t]=e}const VQ={};function nF(n,t){const e=M3(n);return()=>VQ[t]??e()}const jQ=nF(()=>window.ScrollTimeline!==void 0,"scrollTimeline"),rF=nF(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),tp=([n,t,e,r])=>`cubic-bezier(${n}, ${t}, ${e}, ${r})`,A2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:tp([0,.65,.55,1]),circOut:tp([.55,0,1,.45]),backIn:tp([.31,.01,.66,-.59]),backOut:tp([.33,1.53,.69,.99])};function iF(n,t){if(n)return typeof n=="function"?rF()?Q3(n,t):"ease-out":B3(n)?tp(n):Array.isArray(n)?n.map(e=>iF(e,t)||A2.easeOut):A2[n]}function FQ(n,t,e,{delay:r=0,duration:i=300,repeat:s=0,repeatType:o="loop",ease:l="easeOut",times:u}={},h=void 0){const d={[t]:e};u&&(d.offset=u);const p=iF(l,i);Array.isArray(p)&&(d.easing=p);const g={delay:r,duration:i,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"};return h&&(g.pseudoElement=h),n.animate(d,g)}function sF(n){return typeof n=="function"&&"applyToOptions"in n}function BQ({type:n,...t}){return sF(n)&&rF()?n.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class oF extends AC{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:e,name:r,keyframes:i,pseudoElement:s,allowFlatten:o=!1,finalKeyframe:l,onComplete:u}=t;this.isPseudoElement=!!s,this.allowFlatten=o,this.options=t,yC(typeof t.type!="string");const h=BQ(t);this.animation=FQ(e,r,i,h,s),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const d=CC(i,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(d):LQ(e,r,d),this.animation.cancel()}u?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){const t=this.options?.element;!this.isPseudoElement&&t?.isConnected&&this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return ki(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+ki(t)}get time(){return ki(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=as(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:e}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&jQ()?(this.animation.timeline=t,Mi):e(this)}}const aF={anticipate:L3,backInOut:N3,circInOut:j3};function UQ(n){return n in aF}function zQ(n){typeof n.ease=="string"&&UQ(n.ease)&&(n.ease=aF[n.ease])}const iw=10;class HQ extends oF{constructor(t){zQ(t),Z3(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:e,onUpdate:r,onComplete:i,element:s,...o}=this.options;if(!e)return;if(t!==void 0){e.set(t);return}const l=new kC({...o,autoplay:!1}),u=Math.max(iw,br.now()-this.startTime),h=eo(0,iw,u-iw);e.setWithVelocity(l.sample(Math.max(0,u-h)).value,l.sample(u).value,h),l.stop()}}const k2=(n,t)=>t==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(ls.test(n)||n==="0")&&!n.startsWith("url("));function $Q(n){const t=n[0];if(n.length===1)return!0;for(let e=0;e<n.length;e++)if(n[e]!==t)return!0}function qQ(n,t,e,r){const i=n[0];if(i===null)return!1;if(t==="display"||t==="visibility")return!0;const s=n[n.length-1],o=k2(i,t),l=k2(s,t);return!o||!l?!1:$Q(n)||(e==="spring"||sF(e))&&r}function Xx(n){n.duration=0,n.type="keyframes"}const WQ=new Set(["opacity","clipPath","filter","transform"]),GQ=M3(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function YQ(n){const{motionValue:t,name:e,repeatDelay:r,repeatType:i,damping:s,type:o}=n;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return GQ()&&e&&WQ.has(e)&&(e!=="transform"||!h)&&!u&&!r&&i!=="mirror"&&s!==0&&o!=="inertia"}const KQ=40;class XQ extends AC{constructor({autoplay:t=!0,delay:e=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o="loop",keyframes:l,name:u,motionValue:h,element:d,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=br.now();const g={autoplay:t,delay:e,type:r,repeat:i,repeatDelay:s,repeatType:o,name:u,motionValue:h,element:d,...p},v=d?.KeyframeResolver||MC;this.keyframeResolver=new v(l,(T,S,w)=>this.onKeyframesResolved(T,S,g,!w),u,h,d),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,e,r,i){this.keyframeResolver=void 0;const{name:s,type:o,velocity:l,delay:u,isHandoff:h,onUpdate:d}=r;this.resolvedAt=br.now(),qQ(t,s,o,l)||((Jo.instantAnimations||!u)&&d?.(CC(t,r,e)),t[0]=t[t.length-1],Xx(r),r.repeat=0);const g={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>KQ?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:e,...r,keyframes:t},v=!h&&YQ(g),T=g.motionValue?.owner?.current,S=v?new HQ({...g,element:T}):new kC(g);S.finished.then(()=>{this.notifyFinished()}).catch(Mi),this.pendingTimeline&&(this.stopTimeline=S.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=S}get finished(){return this._animation?this.animation.finished:this._finished}then(t,e){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),PQ()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}function lF(n,t,e,r=0,i=1){const s=Array.from(n).sort((h,d)=>h.sortNodePosition(d)).indexOf(t),o=n.size,l=(o-1)*r;return typeof e=="function"?e(s,o):i===1?s*r:l-s*r}const QQ=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function JQ(n){const t=QQ.exec(n);if(!t)return[,];const[,e,r,i]=t;return[`--${e??r}`,i]}function cF(n,t,e=1){const[r,i]=JQ(n);if(!r)return;const s=window.getComputedStyle(t).getPropertyValue(r);if(s){const o=s.trim();return C3(o)?parseFloat(o):o}return TC(i)?cF(i,t,e+1):i}const ZQ={type:"spring",stiffness:500,damping:25,restSpeed:10},tJ=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),eJ={type:"keyframes",duration:.8},nJ={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},rJ=(n,{keyframes:t})=>t.length>2?eJ:bf.has(n)?n.startsWith("scale")?tJ(t[1]):ZQ:nJ,iJ=n=>n!==null;function sJ(n,{repeat:t,repeatType:e="loop"},r){const i=n.filter(iJ),s=t&&e!=="loop"&&t%2===1?0:i.length-1;return i[s]}function uF(n,t){if(n?.inherit&&t){const{inherit:e,...r}=n;return{...t,...r}}return n}function DC(n,t){const e=n?.[t]??n?.default??n;return e!==n?uF(e,n):e}function oJ({when:n,delay:t,delayChildren:e,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:o,repeatDelay:l,from:u,elapsed:h,...d}){return!!Object.keys(d).length}const OC=(n,t,e,r={},i,s)=>o=>{const l=DC(r,n)||{},u=l.delay||r.delay||0;let{elapsed:h=0}=r;h=h-as(u);const d={keyframes:Array.isArray(e)?e:[null,e],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-h,onUpdate:g=>{t.set(g),l.onUpdate&&l.onUpdate(g)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:n,motionValue:t,element:s?void 0:i};oJ(l)||Object.assign(d,rJ(n,d)),d.duration&&(d.duration=as(d.duration)),d.repeatDelay&&(d.repeatDelay=as(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let p=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(Xx(d),d.delay===0&&(p=!0)),(Jo.instantAnimations||Jo.skipAnimations||i?.shouldSkipAnimations)&&(p=!0,Xx(d),d.delay=0),d.allowFlatten=!l.type&&!l.ease,p&&!s&&t.get()!==void 0){const g=sJ(d.keyframes,l);if(g!==void 0){De.update(()=>{d.onUpdate(g),d.onComplete()});return}}return l.isSync?new kC(d):new XQ(d)};function M2(n){const t=[{},{}];return n?.values.forEach((e,r)=>{t[0][r]=e.get(),t[1][r]=e.getVelocity()}),t}function RC(n,t,e,r){if(typeof t=="function"){const[i,s]=M2(r);t=t(e!==void 0?e:n.custom,i,s)}if(typeof t=="string"&&(t=n.variants&&n.variants[t]),typeof t=="function"){const[i,s]=M2(r);t=t(e!==void 0?e:n.custom,i,s)}return t}function jh(n,t,e){const r=n.getProps();return RC(r,t,e!==void 0?e:r.custom,n)}const hF=new Set(["width","height","top","left","right","bottom",...vf]),D2=30,aJ=n=>!isNaN(parseFloat(n));class lJ{constructor(t,e={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{const i=br.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const s of this.dependents)s.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){this.current=t,this.updatedAt=br.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=aJ(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new vC);const r=this.events[t].add(e);return t==="change"?()=>{r(),De.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,e,r){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=br.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>D2)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,D2);return D3(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Yh(n,t){return new lJ(n,t)}const Qx=n=>Array.isArray(n);function cJ(n,t,e){n.hasValue(t)?n.getValue(t).set(e):n.addValue(t,Yh(e))}function uJ(n){return Qx(n)?n[n.length-1]||0:n}function hJ(n,t){const e=jh(n,t);let{transitionEnd:r={},transition:i={},...s}=e||{};s={...s,...r};for(const o in s){const l=uJ(s[o]);cJ(n,o,l)}}const sr=n=>!!(n&&n.getVelocity);function fJ(n){return!!(sr(n)&&n.add)}function Jx(n,t){const e=n.getValue("willChange");if(fJ(e))return e.add(t);if(!e&&Jo.WillChange){const r=new Jo.WillChange("auto");n.addValue("willChange",r),r.add(t)}}function IC(n){return n.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const dJ="framerAppearId",fF="data-"+IC(dJ);function dF(n){return n.props[fF]}function pJ({protectedKeys:n,needsAnimating:t},e){const r=n.hasOwnProperty(e)&&t[e]!==!0;return t[e]=!1,r}function pF(n,t,{delay:e=0,transitionOverride:r,type:i}={}){let{transition:s,transitionEnd:o,...l}=t;const u=n.getDefaultTransition();s=s?uF(s,u):u;const h=s?.reduceMotion;r&&(s=r);const d=[],p=i&&n.animationState&&n.animationState.getState()[i];for(const g in l){const v=n.getValue(g,n.latestValues[g]??null),T=l[g];if(T===void 0||p&&pJ(p,g))continue;const S={delay:e,...DC(s||{},g)},w=v.get();if(w!==void 0&&!v.isAnimating&&!Array.isArray(T)&&T===w&&!S.velocity)continue;let E=!1;if(window.MotionHandoffAnimation){const V=dF(n);if(V){const N=window.MotionHandoffAnimation(V,g,De);N!==null&&(S.startTime=N,E=!0)}}Jx(n,g);const D=h??n.shouldReduceMotion;v.start(OC(g,v,T,D&&hF.has(g)?{type:!1}:S,n,E));const P=v.animation;P&&d.push(P)}if(o){const g=()=>De.update(()=>{o&&hJ(n,o)});d.length?Promise.all(d).then(g):g()}return d}function Zx(n,t,e={}){const r=jh(n,t,e.type==="exit"?n.presenceContext?.custom:void 0);let{transition:i=n.getDefaultTransition()||{}}=r||{};e.transitionOverride&&(i=e.transitionOverride);const s=r?()=>Promise.all(pF(n,r,e)):()=>Promise.resolve(),o=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:d,staggerDirection:p}=i;return mJ(n,t,u,h,d,p,e)}:()=>Promise.resolve(),{when:l}=i;if(l){const[u,h]=l==="beforeChildren"?[s,o]:[o,s];return u().then(()=>h())}else return Promise.all([s(),o(e.delay)])}function mJ(n,t,e=0,r=0,i=0,s=1,o){const l=[];for(const u of n.variantChildren)u.notify("AnimationStart",t),l.push(Zx(u,t,{...o,delay:e+(typeof r=="function"?0:r)+lF(n.variantChildren,u,r,i,s)}).then(()=>u.notify("AnimationComplete",t)));return Promise.all(l)}function gJ(n,t,e={}){n.notify("AnimationStart",t);let r;if(Array.isArray(t)){const i=t.map(s=>Zx(n,s,e));r=Promise.all(i)}else if(typeof t=="string")r=Zx(n,t,e);else{const i=typeof t=="function"?jh(n,t,e.custom):t;r=Promise.all(pF(n,i,e))}return r.then(()=>{n.notify("AnimationComplete",t)})}const yJ={test:n=>n==="auto",parse:n=>n},mF=n=>t=>t.test(n),gF=[yf,St,Qs,qa,WX,qX,yJ],O2=n=>gF.find(mF(n));function vJ(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||k3(n):!0}const bJ=new Set(["brightness","contrast","saturate","opacity"]);function _J(n){const[t,e]=n.slice(0,-1).split("(");if(t==="drop-shadow")return n;const[r]=e.match(SC)||[];if(!r)return n;const i=e.replace(r,"");let s=bJ.has(t)?1:0;return r!==e&&(s*=100),t+"("+s+i+")"}const TJ=/\b([a-z-]*)\(.*?\)/gu,tE={...ls,getAnimatableNone:n=>{const t=n.match(TJ);return t?t.map(_J).join(" "):n}},eE={...ls,getAnimatableNone:n=>{const t=ls.parse(n);return ls.createTransformer(n)(t.map(r=>typeof r=="number"?0:typeof r=="object"?{...r,alpha:1}:r))}},R2={...yf,transform:Math.round},SJ={rotate:qa,rotateX:qa,rotateY:qa,rotateZ:qa,scale:Dy,scaleX:Dy,scaleY:Dy,scaleZ:Dy,skew:qa,skewX:qa,skewY:qa,distance:St,translateX:St,translateY:St,translateZ:St,x:St,y:St,z:St,perspective:St,transformPerspective:St,opacity:Gp,originX:v2,originY:v2,originZ:St},PC={borderWidth:St,borderTopWidth:St,borderRightWidth:St,borderBottomWidth:St,borderLeftWidth:St,borderRadius:St,borderTopLeftRadius:St,borderTopRightRadius:St,borderBottomRightRadius:St,borderBottomLeftRadius:St,width:St,maxWidth:St,height:St,maxHeight:St,top:St,right:St,bottom:St,left:St,inset:St,insetBlock:St,insetBlockStart:St,insetBlockEnd:St,insetInline:St,insetInlineStart:St,insetInlineEnd:St,padding:St,paddingTop:St,paddingRight:St,paddingBottom:St,paddingLeft:St,paddingBlock:St,paddingBlockStart:St,paddingBlockEnd:St,paddingInline:St,paddingInlineStart:St,paddingInlineEnd:St,margin:St,marginTop:St,marginRight:St,marginBottom:St,marginLeft:St,marginBlock:St,marginBlockStart:St,marginBlockEnd:St,marginInline:St,marginInlineStart:St,marginInlineEnd:St,fontSize:St,backgroundPositionX:St,backgroundPositionY:St,...SJ,zIndex:R2,fillOpacity:Gp,strokeOpacity:Gp,numOctaves:R2},wJ={...PC,color:vn,backgroundColor:vn,outlineColor:vn,fill:vn,stroke:vn,borderColor:vn,borderTopColor:vn,borderRightColor:vn,borderBottomColor:vn,borderLeftColor:vn,filter:tE,WebkitFilter:tE,mask:eE,WebkitMask:eE},yF=n=>wJ[n],xJ=new Set([tE,eE]);function vF(n,t){let e=yF(n);return xJ.has(e)||(e=ls),e.getAnimatableNone?e.getAnimatableNone(t):void 0}const EJ=new Set(["auto","none","0"]);function CJ(n,t,e){let r=0,i;for(;r<n.length&&!i;){const s=n[r];typeof s=="string"&&!EJ.has(s)&&Yp(s).values.length&&(i=n[r]),r++}if(i&&e)for(const s of t)n[s]=vF(e,i)}class AJ extends MC{constructor(t,e,r,i,s){super(t,e,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:r}=this;if(!e||!e.current)return;super.readKeyframes();for(let d=0;d<t.length;d++){let p=t[d];if(typeof p=="string"&&(p=p.trim(),TC(p))){const g=cF(p,e.current);g!==void 0&&(t[d]=g),d===t.length-1&&(this.finalKeyframe=p)}}if(this.resolveNoneKeyframes(),!hF.has(r)||t.length!==2)return;const[i,s]=t,o=O2(i),l=O2(s),u=y2(i),h=y2(s);if(u!==h&&il[r]){this.needsMeasurement=!0;return}if(o!==l)if(C2(o)&&C2(l))for(let d=0;d<t.length;d++){const p=t[d];typeof p=="string"&&(t[d]=parseFloat(p))}else il[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,r=[];for(let i=0;i<t.length;i++)(t[i]===null||vJ(t[i]))&&r.push(i);r.length&&CJ(t,r,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=il[r](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const i=e[e.length-1];i!==void 0&&t.getValue(r,i).jump(i,!1)}measureEndState(){const{element:t,name:e,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const i=t.getValue(e);i&&i.jump(this.measuredOrigin,!1);const s=r.length-1,o=r[s];r[s]=il[e](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,u])=>{t.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const kJ=new Set(["opacity","clipPath","filter","transform"]);function bF(n,t,e){if(n==null)return[];if(n instanceof EventTarget)return[n];if(typeof n=="string"){let r=document;const i=e?.[n]??r.querySelectorAll(n);return i?Array.from(i):[]}return Array.from(n).filter(r=>r!=null)}const _F=(n,t)=>t&&typeof n=="number"?t.transform(n):n;function nE(n){return A3(n)&&"offsetHeight"in n}const{schedule:NC}=U3(queueMicrotask,!1),Xi={x:!1,y:!1};function TF(){return Xi.x||Xi.y}function MJ(n){return n==="x"||n==="y"?Xi[n]?null:(Xi[n]=!0,()=>{Xi[n]=!1}):Xi.x||Xi.y?null:(Xi.x=Xi.y=!0,()=>{Xi.x=Xi.y=!1})}function SF(n,t){const e=bF(n),r=new AbortController,i={passive:!0,...t,signal:r.signal};return[e,i,()=>r.abort()]}function DJ(n){return!(n.pointerType==="touch"||TF())}function OJ(n,t,e={}){const[r,i,s]=SF(n,e);return r.forEach(o=>{let l=!1,u=!1,h;const d=()=>{o.removeEventListener("pointerleave",T)},p=w=>{h&&(h(w),h=void 0),d()},g=w=>{l=!1,window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",g),u&&(u=!1,p(w))},v=()=>{l=!0,window.addEventListener("pointerup",g,i),window.addEventListener("pointercancel",g,i)},T=w=>{if(w.pointerType!=="touch"){if(l){u=!0;return}p(w)}},S=w=>{if(!DJ(w))return;u=!1;const E=t(o,w);typeof E=="function"&&(h=E,o.addEventListener("pointerleave",T,i))};o.addEventListener("pointerenter",S,i),o.addEventListener("pointerdown",v,i)}),s}const wF=(n,t)=>t?n===t?!0:wF(n,t.parentElement):!1,LC=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,RJ=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function IJ(n){return RJ.has(n.tagName)||n.isContentEditable===!0}const PJ=new Set(["INPUT","SELECT","TEXTAREA"]);function NJ(n){return PJ.has(n.tagName)||n.isContentEditable===!0}const O0=new WeakSet;function I2(n){return t=>{t.key==="Enter"&&n(t)}}function sw(n,t){n.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const LJ=(n,t)=>{const e=n.currentTarget;if(!e)return;const r=I2(()=>{if(O0.has(e))return;sw(e,"down");const i=I2(()=>{sw(e,"up")}),s=()=>sw(e,"cancel");e.addEventListener("keyup",i,t),e.addEventListener("blur",s,t)});e.addEventListener("keydown",r,t),e.addEventListener("blur",()=>e.removeEventListener("keydown",r),t)};function P2(n){return LC(n)&&!TF()}const N2=new WeakSet;function VJ(n,t,e={}){const[r,i,s]=SF(n,e),o=l=>{const u=l.currentTarget;if(!P2(l)||N2.has(l))return;O0.add(u),e.stopPropagation&&N2.add(l);const h=t(u,l),d=(v,T)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",g),O0.has(u)&&O0.delete(u),P2(v)&&typeof h=="function"&&h(v,{success:T})},p=v=>{d(v,u===window||u===document||e.useGlobalTarget||wF(u,v.target))},g=v=>{d(v,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",g,i)};return r.forEach(l=>{(e.useGlobalTarget?window:l).addEventListener("pointerdown",o,i),nE(l)&&(l.addEventListener("focus",h=>LJ(h,i)),!IJ(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),s}function VC(n){return A3(n)&&"ownerSVGElement"in n}const R0=new WeakMap;let I0;const xF=(n,t,e)=>(r,i)=>i&&i[0]?i[0][n+"Size"]:VC(r)&&"getBBox"in r?r.getBBox()[t]:r[e],jJ=xF("inline","width","offsetWidth"),FJ=xF("block","height","offsetHeight");function BJ({target:n,borderBoxSize:t}){R0.get(n)?.forEach(e=>{e(n,{get width(){return jJ(n,t)},get height(){return FJ(n,t)}})})}function UJ(n){n.forEach(BJ)}function zJ(){typeof ResizeObserver>"u"||(I0=new ResizeObserver(UJ))}function HJ(n,t){I0||zJ();const e=bF(n);return e.forEach(r=>{let i=R0.get(r);i||(i=new Set,R0.set(r,i)),i.add(t),I0?.observe(r)}),()=>{e.forEach(r=>{const i=R0.get(r);i?.delete(t),i?.size||I0?.unobserve(r)})}}const P0=new Set;let wh;function $J(){wh=()=>{const n={get width(){return window.innerWidth},get height(){return window.innerHeight}};P0.forEach(t=>t(n))},window.addEventListener("resize",wh)}function qJ(n){return P0.add(n),wh||$J(),()=>{P0.delete(n),!P0.size&&typeof wh=="function"&&(window.removeEventListener("resize",wh),wh=void 0)}}function L2(n,t){return typeof n=="function"?qJ(n):HJ(n,t)}function WJ(n){return VC(n)&&n.tagName==="svg"}const GJ=[...gF,vn,ls],YJ=n=>GJ.find(mF(n)),V2=()=>({translate:0,scale:1,origin:0,originPoint:0}),xh=()=>({x:V2(),y:V2()}),j2=()=>({min:0,max:0}),En=()=>({x:j2(),y:j2()}),KJ=new WeakMap;function r_(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function Kp(n){return typeof n=="string"||Array.isArray(n)}const jC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],FC=["initial",...jC];function i_(n){return r_(n.animate)||FC.some(t=>Kp(n[t]))}function EF(n){return!!(i_(n)||n.variants)}function XJ(n,t,e){for(const r in t){const i=t[r],s=e[r];if(sr(i))n.addValue(r,i);else if(sr(s))n.addValue(r,Yh(i,{owner:n}));else if(s!==i)if(n.hasValue(r)){const o=n.getValue(r);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=n.getStaticValue(r);n.addValue(r,Yh(o!==void 0?o:i,{owner:n}))}}for(const r in e)t[r]===void 0&&n.removeValue(r);return t}const rE={current:null},CF={current:!1},QJ=typeof window<"u";function JJ(){if(CF.current=!0,!!QJ)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),t=()=>rE.current=n.matches;n.addEventListener("change",t),t()}else rE.current=!1}const F2=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let Sv={};function AF(n){Sv=n}function ZJ(){return Sv}class tZ{scrapeMotionValuesFromProps(t,e,r){return{}}constructor({parent:t,props:e,presenceContext:r,reducedMotionConfig:i,skipAnimations:s,blockInitialAnimation:o,visualState:l},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.shouldSkipAnimations=!1,this.values=new Map,this.KeyframeResolver=MC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.hasBeenMounted=!1,this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=br.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,De.render(this.render,!1,!0))};const{latestValues:h,renderState:d}=l;this.latestValues=h,this.baseTarget={...h},this.initialValues=e.initial?{...h}:{},this.renderState=d,this.parent=t,this.props=e,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.skipAnimationsConfig=s,this.options=u,this.blockInitialAnimation=!!o,this.isControllingVariants=i_(e),this.isVariantNode=EF(e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:p,...g}=this.scrapeMotionValuesFromProps(e,{},this);for(const v in g){const T=g[v];h[v]!==void 0&&sr(T)&&T.set(h[v])}}mount(t){if(this.hasBeenMounted)for(const e in this.initialValues)this.values.get(e)?.jump(this.initialValues[e]),this.latestValues[e]=this.initialValues[e];this.current=t,KJ.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,r)=>this.bindToMotionValue(r,e)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(CF.current||JJ(),this.shouldReduceMotion=rE.current),this.shouldSkipAnimations=this.skipAnimationsConfig??!1,this.parent?.addChild(this),this.update(this.props,this.presenceContext),this.hasBeenMounted=!0}unmount(){this.projection&&this.projection.unmount(),xl(this.notifyUpdate),xl(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,e){if(this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)(),e.accelerate&&kJ.has(t)&&this.current instanceof HTMLElement){const{factory:o,keyframes:l,times:u,ease:h,duration:d}=e.accelerate,p=new oF({element:this.current,name:t,keyframes:l,times:u,ease:h,duration:as(d)}),g=o(p);this.valueSubscriptions.set(t,()=>{g(),p.cancel()});return}const r=bf.has(t);r&&this.onBindTransform&&this.onBindTransform();const i=e.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&De.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;typeof window<"u"&&window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,t,e)),this.valueSubscriptions.set(t,()=>{i(),s&&s(),e.owner&&e.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Sv){const e=Sv[t];if(!e)continue;const{isEnabled:r,Feature:i}=e;if(!this.features[t]&&i&&r(this.props)&&(this.features[t]=new i(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):En()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let r=0;r<F2.length;r++){const i=F2[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,o=t[s];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=XJ(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){const r=this.values.get(t);e!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,e),this.values.set(t,e),this.latestValues[t]=e.get())}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&e!==void 0&&(r=Yh(e===null?void 0:e,{owner:this}),this.addValue(t,r)),r}readValue(t,e){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(C3(r)||k3(r))?r=parseFloat(r):!YJ(r)&&ls.test(e)&&(r=vF(t,e)),this.setBaseTarget(t,sr(r)?r.get():r)),sr(r)?r.get():r}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){const{initial:e}=this.props;let r;if(typeof e=="string"||typeof e=="object"){const s=RC(this.props,e,this.presenceContext?.custom);s&&(r=s[t])}if(e&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!sr(i)?i:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,e){return this.events[t]||(this.events[t]=new vC),this.events[t].add(e)}notify(t,...e){this.events[t]&&this.events[t].notify(...e)}scheduleRenderMicrotask(){NC.render(this.render)}}class kF extends tZ{constructor(){super(...arguments),this.KeyframeResolver=AJ}sortInstanceNodePosition(t,e){return t.compareDocumentPosition(e)&2?1:-1}getBaseTargetFromProps(t,e){const r=t.style;return r?r[e]:void 0}removeValueFromRenderState(t,{vars:e,style:r}){delete e[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;sr(t)&&(this.childSubscription=t.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}class Fl{constructor(t){this.isMounted=!1,this.node=t}update(){}}function MF({top:n,left:t,right:e,bottom:r}){return{x:{min:t,max:e},y:{min:n,max:r}}}function eZ({x:n,y:t}){return{top:t.min,right:n.max,bottom:t.max,left:n.min}}function nZ(n,t){if(!t)return n;const e=t({x:n.left,y:n.top}),r=t({x:n.right,y:n.bottom});return{top:e.y,left:e.x,bottom:r.y,right:r.x}}function ow(n){return n===void 0||n===1}function iE({scale:n,scaleX:t,scaleY:e}){return!ow(n)||!ow(t)||!ow(e)}function Cc(n){return iE(n)||DF(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function DF(n){return B2(n.x)||B2(n.y)}function B2(n){return n&&n!=="0%"}function wv(n,t,e){const r=n-e,i=t*r;return e+i}function U2(n,t,e,r,i){return i!==void 0&&(n=wv(n,i,r)),wv(n,e,r)+t}function sE(n,t=0,e=1,r,i){n.min=U2(n.min,t,e,r,i),n.max=U2(n.max,t,e,r,i)}function OF(n,{x:t,y:e}){sE(n.x,t.translate,t.scale,t.originPoint),sE(n.y,e.translate,e.scale,e.originPoint)}const z2=.999999999999,H2=1.0000000000001;function rZ(n,t,e,r=!1){const i=e.length;if(!i)return;t.x=t.y=1;let s,o;for(let l=0;l<i;l++){s=e[l],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Ch(n,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,OF(n,o)),r&&Cc(s.latestValues)&&Ch(n,s.latestValues))}t.x<H2&&t.x>z2&&(t.x=1),t.y<H2&&t.y>z2&&(t.y=1)}function Eh(n,t){n.min=n.min+t,n.max=n.max+t}function $2(n,t,e,r,i=.5){const s=ze(n.min,n.max,i);sE(n,t,e,s,r)}function Ch(n,t){$2(n.x,t.x,t.scaleX,t.scale,t.originX),$2(n.y,t.y,t.scaleY,t.scale,t.originY)}function RF(n,t){return MF(nZ(n.getBoundingClientRect(),t))}function iZ(n,t,e){const r=RF(n,e),{scroll:i}=t;return i&&(Eh(r.x,i.offset.x),Eh(r.y,i.offset.y)),r}const sZ={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},oZ=vf.length;function aZ(n,t,e){let r="",i=!0;for(let s=0;s<oZ;s++){const o=vf[s],l=n[o];if(l===void 0)continue;let u=!0;if(typeof l=="number")u=l===(o.startsWith("scale")?1:0);else{const h=parseFloat(l);u=o.startsWith("scale")?h===1:h===0}if(!u||e){const h=_F(l,PC[o]);if(!u){i=!1;const d=sZ[o]||o;r+=`${d}(${h}) `}e&&(t[o]=h)}}return r=r.trim(),e?r=e(t,i?"":r):i&&(r="none"),r}function BC(n,t,e){const{style:r,vars:i,transformOrigin:s}=n;let o=!1,l=!1;for(const u in t){const h=t[u];if(bf.has(u)){o=!0;continue}else if(H3(u)){i[u]=h;continue}else{const d=_F(h,PC[u]);u.startsWith("origin")?(l=!0,s[u]=d):r[u]=d}}if(t.transform||(o||e?r.transform=aZ(t,n.transform,e):r.transform&&(r.transform="none")),l){const{originX:u="50%",originY:h="50%",originZ:d=0}=s;r.transformOrigin=`${u} ${h} ${d}`}}function IF(n,{style:t,vars:e},r,i){const s=n.style;let o;for(o in t)s[o]=t[o];i?.applyProjectionStyles(s,r);for(o in e)s.setProperty(o,e[o])}function q2(n,t){return t.max===t.min?0:n/(t.max-t.min)*100}const jd={correct:(n,t)=>{if(!t.target)return n;if(typeof n=="string")if(St.test(n))n=parseFloat(n);else return n;const e=q2(n,t.target.x),r=q2(n,t.target.y);return`${e}% ${r}%`}},lZ={correct:(n,{treeScale:t,projectionDelta:e})=>{const r=n,i=ls.parse(n);if(i.length>5)return r;const s=ls.createTransformer(n),o=typeof i[0]!="number"?1:0,l=e.x.scale*t.x,u=e.y.scale*t.y;i[0+o]/=l,i[1+o]/=u;const h=ze(l,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=h),typeof i[3+o]=="number"&&(i[3+o]/=h),s(i)}},oE={borderRadius:{...jd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:jd,borderTopRightRadius:jd,borderBottomLeftRadius:jd,borderBottomRightRadius:jd,boxShadow:lZ};function PF(n,{layout:t,layoutId:e}){return bf.has(n)||n.startsWith("origin")||(t||e!==void 0)&&(!!oE[n]||n==="opacity")}function UC(n,t,e){const r=n.style,i=t?.style,s={};if(!r)return s;for(const o in r)(sr(r[o])||i&&sr(i[o])||PF(o,n)||e?.getValue(o)?.liveStyle!==void 0)&&(s[o]=r[o]);return s}function cZ(n){return window.getComputedStyle(n)}class uZ extends kF{constructor(){super(...arguments),this.type="html",this.renderInstance=IF}readValueFromInstance(t,e){if(bf.has(e))return this.projection?.isProjecting?qx(e):MQ(t,e);{const r=cZ(t),i=(H3(e)?r.getPropertyValue(e):r[e])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:e}){return RF(t,e)}build(t,e,r){BC(t,e,r.transformTemplate)}scrapeMotionValuesFromProps(t,e,r){return UC(t,e,r)}}const hZ={offset:"stroke-dashoffset",array:"stroke-dasharray"},fZ={offset:"strokeDashoffset",array:"strokeDasharray"};function dZ(n,t,e=1,r=0,i=!0){n.pathLength=1;const s=i?hZ:fZ;n[s.offset]=`${-r}`,n[s.array]=`${t} ${e}`}const pZ=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function NF(n,{attrX:t,attrY:e,attrScale:r,pathLength:i,pathSpacing:s=1,pathOffset:o=0,...l},u,h,d){if(BC(n,l,h),u){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:g}=n;p.transform&&(g.transform=p.transform,delete p.transform),(g.transform||p.transformOrigin)&&(g.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),g.transform&&(g.transformBox=d?.transformBox??"fill-box",delete p.transformBox);for(const v of pZ)p[v]!==void 0&&(g[v]=p[v],delete p[v]);t!==void 0&&(p.x=t),e!==void 0&&(p.y=e),r!==void 0&&(p.scale=r),i!==void 0&&dZ(p,i,s,o,!1)}const LF=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),VF=n=>typeof n=="string"&&n.toLowerCase()==="svg";function mZ(n,t,e,r){IF(n,t,void 0,r);for(const i in t.attrs)n.setAttribute(LF.has(i)?i:IC(i),t.attrs[i])}function jF(n,t,e){const r=UC(n,t,e);for(const i in n)if(sr(n[i])||sr(t[i])){const s=vf.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=n[i]}return r}class gZ extends kF{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=En}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(bf.has(e)){const r=yF(e);return r&&r.default||0}return e=LF.has(e)?e:IC(e),t.getAttribute(e)}scrapeMotionValuesFromProps(t,e,r){return jF(t,e,r)}build(t,e,r){NF(t,e,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,e,r,i){mZ(t,e,r,i)}mount(t){this.isSVGTag=VF(t.tagName),super.mount(t)}}const yZ=FC.length;function FF(n){if(!n)return;if(!n.isControllingVariants){const e=n.parent?FF(n.parent)||{}:{};return n.props.initial!==void 0&&(e.initial=n.props.initial),e}const t={};for(let e=0;e<yZ;e++){const r=FC[e],i=n.props[r];(Kp(i)||i===!1)&&(t[r]=i)}return t}function BF(n,t){if(!Array.isArray(t))return!1;const e=t.length;if(e!==n.length)return!1;for(let r=0;r<e;r++)if(t[r]!==n[r])return!1;return!0}const vZ=[...jC].reverse(),bZ=jC.length;function _Z(n){return t=>Promise.all(t.map(({animation:e,options:r})=>gJ(n,e,r)))}function TZ(n){let t=_Z(n),e=W2(),r=!0;const i=u=>(h,d)=>{const p=jh(n,d,u==="exit"?n.presenceContext?.custom:void 0);if(p){const{transition:g,transitionEnd:v,...T}=p;h={...h,...T,...v}}return h};function s(u){t=u(n)}function o(u){const{props:h}=n,d=FF(n.parent)||{},p=[],g=new Set;let v={},T=1/0;for(let w=0;w<bZ;w++){const E=vZ[w],D=e[E],P=h[E]!==void 0?h[E]:d[E],V=Kp(P),N=E===u?D.isActive:null;N===!1&&(T=w);let q=P===d[E]&&P!==h[E]&&V;if(q&&r&&n.manuallyAnimateOnMount&&(q=!1),D.protectedKeys={...v},!D.isActive&&N===null||!P&&!D.prevProp||r_(P)||typeof P=="boolean")continue;if(E==="exit"&&D.isActive&&N!==!0){D.prevResolvedValues&&(v={...v,...D.prevResolvedValues});continue}const M=SZ(D.prevProp,P);let k=M||E===u&&D.isActive&&!q&&V||w>T&&V,R=!1;const F=Array.isArray(P)?P:[P];let U=F.reduce(i(E),{});N===!1&&(U={});const{prevResolvedValues:H={}}=D,j={...H,...U},yt=st=>{k=!0,g.has(st)&&(R=!0,g.delete(st)),D.needsAnimating[st]=!0;const ht=n.getValue(st);ht&&(ht.liveStyle=!1)};for(const st in j){const ht=U[st],Ct=H[st];if(v.hasOwnProperty(st))continue;let Vt=!1;Qx(ht)&&Qx(Ct)?Vt=!BF(ht,Ct):Vt=ht!==Ct,Vt?ht!=null?yt(st):g.add(st):ht!==void 0&&g.has(st)?yt(st):D.protectedKeys[st]=!0}D.prevProp=P,D.prevResolvedValues=U,D.isActive&&(v={...v,...U}),r&&n.blockInitialAnimation&&(k=!1);const xt=q&&M;k&&(!xt||R)&&p.push(...F.map(st=>{const ht={type:E};if(typeof st=="string"&&r&&!xt&&n.manuallyAnimateOnMount&&n.parent){const{parent:Ct}=n,Vt=jh(Ct,st);if(Ct.enteringChildren&&Vt){const{delayChildren:$}=Vt.transition||{};ht.delay=lF(Ct.enteringChildren,n,$)}}return{animation:st,options:ht}}))}if(g.size){const w={};if(typeof h.initial!="boolean"){const E=jh(n,Array.isArray(h.initial)?h.initial[0]:h.initial);E&&E.transition&&(w.transition=E.transition)}g.forEach(E=>{const D=n.getBaseTarget(E),P=n.getValue(E);P&&(P.liveStyle=!0),w[E]=D??null}),p.push({animation:w})}let S=!!p.length;return r&&(h.initial===!1||h.initial===h.animate)&&!n.manuallyAnimateOnMount&&(S=!1),r=!1,S?t(p):Promise.resolve()}function l(u,h){if(e[u].isActive===h)return Promise.resolve();n.variantChildren?.forEach(p=>p.animationState?.setActive(u,h)),e[u].isActive=h;const d=o(u);for(const p in e)e[p].protectedKeys={};return d}return{animateChanges:o,setActive:l,setAnimateFunction:s,getState:()=>e,reset:()=>{e=W2()}}}function SZ(n,t){return typeof t=="string"?t!==n:Array.isArray(t)?!BF(t,n):!1}function _c(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function W2(){return{animate:_c(!0),whileInView:_c(),whileHover:_c(),whileTap:_c(),whileDrag:_c(),whileFocus:_c(),exit:_c()}}function G2(n,t){n.min=t.min,n.max=t.max}function Yi(n,t){G2(n.x,t.x),G2(n.y,t.y)}function Y2(n,t){n.translate=t.translate,n.scale=t.scale,n.originPoint=t.originPoint,n.origin=t.origin}const UF=1e-4,wZ=1-UF,xZ=1+UF,zF=.01,EZ=0-zF,CZ=0+zF;function _r(n){return n.max-n.min}function AZ(n,t,e){return Math.abs(n-t)<=e}function K2(n,t,e,r=.5){n.origin=r,n.originPoint=ze(t.min,t.max,n.origin),n.scale=_r(e)/_r(t),n.translate=ze(e.min,e.max,n.origin)-n.originPoint,(n.scale>=wZ&&n.scale<=xZ||isNaN(n.scale))&&(n.scale=1),(n.translate>=EZ&&n.translate<=CZ||isNaN(n.translate))&&(n.translate=0)}function yp(n,t,e,r){K2(n.x,t.x,e.x,r?r.originX:void 0),K2(n.y,t.y,e.y,r?r.originY:void 0)}function X2(n,t,e){n.min=e.min+t.min,n.max=n.min+_r(t)}function kZ(n,t,e){X2(n.x,t.x,e.x),X2(n.y,t.y,e.y)}function Q2(n,t,e){n.min=t.min-e.min,n.max=n.min+_r(t)}function xv(n,t,e){Q2(n.x,t.x,e.x),Q2(n.y,t.y,e.y)}function J2(n,t,e,r,i){return n-=t,n=wv(n,1/e,r),i!==void 0&&(n=wv(n,1/i,r)),n}function MZ(n,t=0,e=1,r=.5,i,s=n,o=n){if(Qs.test(t)&&(t=parseFloat(t),t=ze(o.min,o.max,t/100)-o.min),typeof t!="number")return;let l=ze(s.min,s.max,r);n===s&&(l-=t),n.min=J2(n.min,t,e,l,i),n.max=J2(n.max,t,e,l,i)}function Z2(n,t,[e,r,i],s,o){MZ(n,t[e],t[r],t[i],t.scale,s,o)}const DZ=["x","scaleX","originX"],OZ=["y","scaleY","originY"];function tI(n,t,e,r){Z2(n.x,t,DZ,e?e.x:void 0,r?r.x:void 0),Z2(n.y,t,OZ,e?e.y:void 0,r?r.y:void 0)}function eI(n){return n.translate===0&&n.scale===1}function HF(n){return eI(n.x)&&eI(n.y)}function nI(n,t){return n.min===t.min&&n.max===t.max}function RZ(n,t){return nI(n.x,t.x)&&nI(n.y,t.y)}function rI(n,t){return Math.round(n.min)===Math.round(t.min)&&Math.round(n.max)===Math.round(t.max)}function $F(n,t){return rI(n.x,t.x)&&rI(n.y,t.y)}function iI(n){return _r(n.x)/_r(n.y)}function sI(n,t){return n.translate===t.translate&&n.scale===t.scale&&n.originPoint===t.originPoint}function Ls(n){return[n("x"),n("y")]}function IZ(n,t,e){let r="";const i=n.x.translate/t.x,s=n.y.translate/t.y,o=e?.z||0;if((i||s||o)&&(r=`translate3d(${i}px, ${s}px, ${o}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),e){const{transformPerspective:h,rotate:d,rotateX:p,rotateY:g,skewX:v,skewY:T}=e;h&&(r=`perspective(${h}px) ${r}`),d&&(r+=`rotate(${d}deg) `),p&&(r+=`rotateX(${p}deg) `),g&&(r+=`rotateY(${g}deg) `),v&&(r+=`skewX(${v}deg) `),T&&(r+=`skewY(${T}deg) `)}const l=n.x.scale*t.x,u=n.y.scale*t.y;return(l!==1||u!==1)&&(r+=`scale(${l}, ${u})`),r||"none"}const qF=["TopLeft","TopRight","BottomLeft","BottomRight"],PZ=qF.length,oI=n=>typeof n=="string"?parseFloat(n):n,aI=n=>typeof n=="number"||St.test(n);function NZ(n,t,e,r,i,s){i?(n.opacity=ze(0,e.opacity??1,LZ(r)),n.opacityExit=ze(t.opacity??1,0,VZ(r))):s&&(n.opacity=ze(t.opacity??1,e.opacity??1,r));for(let o=0;o<PZ;o++){const l=`border${qF[o]}Radius`;let u=lI(t,l),h=lI(e,l);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||aI(u)===aI(h)?(n[l]=Math.max(ze(oI(u),oI(h),r),0),(Qs.test(h)||Qs.test(u))&&(n[l]+="%")):n[l]=h}(t.rotate||e.rotate)&&(n.rotate=ze(t.rotate||0,e.rotate||0,r))}function lI(n,t){return n[t]!==void 0?n[t]:n.borderRadius}const LZ=WF(0,.5,V3),VZ=WF(.5,.95,Mi);function WF(n,t,e){return r=>r<n?0:r>t?1:e(Wp(n,t,r))}function jZ(n,t,e){const r=sr(n)?n:Yh(n);return r.start(OC("",r,t,e)),r.animation}function Xp(n,t,e,r={passive:!0}){return n.addEventListener(t,e,r),()=>n.removeEventListener(t,e)}const FZ=(n,t)=>n.depth-t.depth;class BZ{constructor(){this.children=[],this.isDirty=!1}add(t){gC(this.children,t),this.isDirty=!0}remove(t){vv(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(FZ),this.isDirty=!1,this.children.forEach(t)}}function UZ(n,t){const e=br.now(),r=({timestamp:i})=>{const s=i-e;s>=t&&(xl(r),n(s-t))};return De.setup(r,!0),()=>xl(r)}function N0(n){return sr(n)?n.get():n}class zZ{constructor(){this.members=[]}add(t){gC(this.members,t);for(let e=this.members.length-1;e>=0;e--){const r=this.members[e];if(r===t||r===this.lead||r===this.prevLead)continue;const i=r.instance;i&&i.isConnected===!1&&r.isPresent!==!1&&!r.snapshot&&vv(this.members,r)}t.scheduleRender()}remove(t){if(vv(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(t){const e=this.members.findIndex(i=>t===i);if(e===0)return!1;let r;for(let i=e;i>=0;i--){const s=this.members[i],o=s.instance;if(s.isPresent!==!1&&(!o||o.isConnected!==!1)){r=s;break}}return r?(this.promote(r),!0):!1}promote(t,e){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender();const i=r.options.layoutDependency,s=t.options.layoutDependency;if(!(i!==void 0&&s!==void 0&&i===s)){const u=r.instance;u&&u.isConnected===!1&&!r.snapshot||(t.resumeFrom=r,e&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0))}const{crossfade:l}=t.options;l===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:e,resumingFrom:r}=t;e.onExitComplete&&e.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const L0={hasAnimatedSinceResize:!0,hasEverUpdated:!1},aw=["","X","Y","Z"],HZ=1e3;let $Z=0;function lw(n,t,e,r){const{latestValues:i}=t;i[n]&&(e[n]=i[n],t.setStaticValue(n,0),r&&(r[n]=0))}function GF(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:t}=n.options;if(!t)return;const e=dF(t);if(window.MotionHasOptimisedAnimation(e,"transform")){const{layout:i,layoutId:s}=n.options;window.MotionCancelOptimisedAnimation(e,"transform",De,!(i||s))}const{parent:r}=n;r&&!r.hasCheckedOptimisedAppear&&GF(r)}function YF({attachResizeListener:n,defaultParent:t,measureScroll:e,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(o={},l=t?.()){this.id=$Z++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(GZ),this.nodes.forEach(QZ),this.nodes.forEach(JZ),this.nodes.forEach(YZ)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new BZ)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new vC),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=VC(o)&&!WJ(o),this.instance=o;const{layoutId:l,layout:u,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(u||l)&&(this.isLayoutDirty=!0),n){let d,p=0;const g=()=>this.root.updateBlockedByResize=!1;De.read(()=>{p=window.innerWidth}),n(o,()=>{const v=window.innerWidth;v!==p&&(p=v,this.root.updateBlockedByResize=!0,d&&d(),d=UZ(g,250),L0.hasAnimatedSinceResize&&(L0.hasAnimatedSinceResize=!1,this.nodes.forEach(hI)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||u)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:p,hasRelativeLayoutChanged:g,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const T=this.options.transition||h.getDefaultTransition()||rtt,{onLayoutAnimationStart:S,onLayoutAnimationComplete:w}=h.getProps(),E=!this.targetLayout||!$F(this.targetLayout,v),D=!p&&g;if(this.options.layoutRoot||this.resumeFrom||D||p&&(E||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const P={...DC(T,"layout"),onPlay:S,onComplete:w};(h.shouldReduceMotion||this.options.layoutRoot)&&(P.delay=0,P.type=!1),this.startAnimation(P),this.setAnimationOrigin(d,D)}else p||hI(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),xl(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ZZ),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&GF(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const p=this.path[d];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(cI);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(uI);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(XZ),this.nodes.forEach(qZ),this.nodes.forEach(WZ)):this.nodes.forEach(uI),this.clearAllSnapshots();const l=br.now();Gn.delta=eo(0,1e3/60,l-Gn.timestamp),Gn.timestamp=l,Gn.isProcessing=!0,ZS.update.process(Gn),ZS.preRender.process(Gn),ZS.render.process(Gn),Gn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,NC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(KZ),this.sharedNodes.forEach(ttt)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,De.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){De.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!_r(this.snapshot.measuredBox.x)&&!_r(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=En(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const u=r(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:e(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!HF(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,d=h!==this.prevTransformTemplateValue;o&&this.instance&&(l||Cc(this.latestValues)||d)&&(i(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),itt(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return En();const l=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(stt))){const{scroll:h}=this.root;h&&(Eh(l.x,h.offset.x),Eh(l.y,h.offset.y))}return l}removeElementScroll(o){const l=En();if(Yi(l,o),this.scroll?.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:d,options:p}=h;h!==this.root&&d&&p.layoutScroll&&(d.wasRoot&&Yi(l,o),Eh(l.x,d.offset.x),Eh(l.y,d.offset.y))}return l}applyTransform(o,l=!1){const u=En();Yi(u,o);for(let h=0;h<this.path.length;h++){const d=this.path[h];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Ch(u,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Cc(d.latestValues)&&Ch(u,d.latestValues)}return Cc(this.latestValues)&&Ch(u,this.latestValues),u}removeTransform(o){const l=En();Yi(l,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Cc(h.latestValues))continue;iE(h.latestValues)&&h.updateSnapshot();const d=En(),p=h.measurePageBox();Yi(d,p),tI(l,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return Cc(this.latestValues)&&tI(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Gn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:p}=this.options;if(!this.layout||!(d||p))return;this.resolvedRelativeTargetAt=Gn.timestamp;const g=this.getClosestProjectingParent();g&&this.linkedParentVersion!==g.layoutVersion&&!g.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(g&&g.layout?this.createRelativeTarget(g,this.layout.layoutBox,g.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=En(),this.targetWithTransforms=En()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),kZ(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Yi(this.target,this.layout.layoutBox),OF(this.target,this.targetDelta)):Yi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?this.createRelativeTarget(g,this.target,g.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||iE(this.parent.latestValues)||DF(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,l,u){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=En(),this.relativeTargetOrigin=En(),xv(this.relativeTargetOrigin,l,u),Yi(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Gn.timestamp&&(u=!1),u)return;const{layout:h,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||d))return;Yi(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,g=this.treeScale.y;rZ(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=En());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Y2(this.prevProjectionDelta.x,this.projectionDelta.x),Y2(this.prevProjectionDelta.y,this.projectionDelta.y)),yp(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==g||!sI(this.projectionDelta.x,this.prevProjectionDelta.x)||!sI(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=xh(),this.projectionDelta=xh(),this.projectionDeltaWithTransform=xh()}setAnimationOrigin(o,l=!1){const u=this.snapshot,h=u?u.latestValues:{},d={...this.latestValues},p=xh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const g=En(),v=u?u.source:void 0,T=this.layout?this.layout.source:void 0,S=v!==T,w=this.getStack(),E=!w||w.members.length<=1,D=!!(S&&!E&&this.options.crossfade===!0&&!this.path.some(ntt));this.animationProgress=0;let P;this.mixTargetDelta=V=>{const N=V/1e3;fI(p.x,o.x,N),fI(p.y,o.y,N),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(xv(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),ett(this.relativeTarget,this.relativeTargetOrigin,g,N),P&&RZ(this.relativeTarget,P)&&(this.isProjectionDirty=!1),P||(P=En()),Yi(P,this.relativeTarget)),S&&(this.animationValues=d,NZ(d,h,this.latestValues,N,D,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(xl(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=De.update(()=>{L0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Yh(0)),this.motionValue.jump(0,!1),this.currentAnimation=jZ(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(HZ),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:h,latestValues:d}=o;if(!(!l||!u||!h)){if(this!==o&&this.layout&&h&&KF(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||En();const p=_r(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const g=_r(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+g}Yi(l,u),Ch(l,d),yp(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new zZ),this.sharedNodes.get(o).add(l);const h=l.options.initialPromotionConfig;l.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const h={};u.z&&lw("z",o,h,this.animationValues);for(let d=0;d<aw.length;d++)lw(`rotate${aw[d]}`,o,h,this.animationValues),lw(`skew${aw[d]}`,o,h,this.animationValues);o.render();for(const d in h)o.setStaticValue(d,h[d]),this.animationValues&&(this.animationValues[d]=h[d]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const u=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=N0(l?.pointerEvents)||"",o.transform=u?u(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=N0(l?.pointerEvents)||""),this.hasProjected&&!Cc(this.latestValues)&&(o.transform=u?u({},""):"none",this.hasProjected=!1);return}o.visibility="";const d=h.animationValues||h.latestValues;this.applyTransformsToTarget();let p=IZ(this.projectionDeltaWithTransform,this.treeScale,d);u&&(p=u(d,p)),o.transform=p;const{x:g,y:v}=this.projectionDelta;o.transformOrigin=`${g.origin*100}% ${v.origin*100}% 0`,h.animationValues?o.opacity=h===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:o.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const T in oE){if(d[T]===void 0)continue;const{correct:S,applyTo:w,isCSSVariable:E}=oE[T],D=p==="none"?d[T]:S(d[T],h);if(w){const P=w.length;for(let V=0;V<P;V++)o[w[V]]=D}else E?this.options.visualElement.renderState.vars[T]=D:o[T]=D}this.options.layoutId&&(o.pointerEvents=h===this?N0(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(cI),this.root.sharedNodes.clear()}}}function qZ(n){n.updateLayout()}function WZ(n){const t=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&t&&n.hasListeners("didUpdate")){const{layoutBox:e,measuredBox:r}=n.layout,{animationType:i}=n.options,s=t.source!==n.layout.source;i==="size"?Ls(d=>{const p=s?t.measuredBox[d]:t.layoutBox[d],g=_r(p);p.min=e[d].min,p.max=p.min+g}):KF(i,t.layoutBox,e)&&Ls(d=>{const p=s?t.measuredBox[d]:t.layoutBox[d],g=_r(e[d]);p.max=p.min+g,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[d].max=n.relativeTarget[d].min+g)});const o=xh();yp(o,e,t.layoutBox);const l=xh();s?yp(l,n.applyTransform(r,!0),t.measuredBox):yp(l,e,t.layoutBox);const u=!HF(o);let h=!1;if(!n.resumeFrom){const d=n.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:p,layout:g}=d;if(p&&g){const v=En();xv(v,t.layoutBox,p.layoutBox);const T=En();xv(T,e,g.layoutBox),$F(v,T)||(h=!0),d.options.layoutRoot&&(n.relativeTarget=T,n.relativeTargetOrigin=v,n.relativeParent=d)}}}n.notifyListeners("didUpdate",{layout:e,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:h})}else if(n.isLead()){const{onExitComplete:e}=n.options;e&&e()}n.options.transition=void 0}function GZ(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function YZ(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function KZ(n){n.clearSnapshot()}function cI(n){n.clearMeasurements()}function uI(n){n.isLayoutDirty=!1}function XZ(n){const{visualElement:t}=n.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),n.resetTransform()}function hI(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function QZ(n){n.resolveTargetDelta()}function JZ(n){n.calcProjection()}function ZZ(n){n.resetSkewAndRotation()}function ttt(n){n.removeLeadSnapshot()}function fI(n,t,e){n.translate=ze(t.translate,0,e),n.scale=ze(t.scale,1,e),n.origin=t.origin,n.originPoint=t.originPoint}function dI(n,t,e,r){n.min=ze(t.min,e.min,r),n.max=ze(t.max,e.max,r)}function ett(n,t,e,r){dI(n.x,t.x,e.x,r),dI(n.y,t.y,e.y,r)}function ntt(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const rtt={duration:.45,ease:[.4,0,.1,1]},pI=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),mI=pI("applewebkit/")&&!pI("chrome/")?Math.round:Mi;function gI(n){n.min=mI(n.min),n.max=mI(n.max)}function itt(n){gI(n.x),gI(n.y)}function KF(n,t,e){return n==="position"||n==="preserve-aspect"&&!AZ(iI(t),iI(e),.2)}function stt(n){return n!==n.root&&n.scroll?.wasRoot}const ott=YF({attachResizeListener:(n,t)=>Xp(n,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),cw={current:void 0},XF=YF({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!cw.current){const n=new ott({});n.mount(window),n.setOptions({layoutScroll:!0}),cw.current=n}return cw.current},resetTransform:(n,t)=>{n.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),zC=L.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function yI(n,t){if(typeof n=="function")return n(t);n!=null&&(n.current=t)}function att(...n){return t=>{let e=!1;const r=n.map(i=>{const s=yI(i,t);return!e&&typeof s=="function"&&(e=!0),s});if(e)return()=>{for(let i=0;i<r.length;i++){const s=r[i];typeof s=="function"?s():yI(n[i],null)}}}}function ltt(...n){return L.useCallback(att(...n),n)}class ctt extends L.Component{getSnapshotBeforeUpdate(t){const e=this.props.childRef.current;if(e&&t.isPresent&&!this.props.isPresent&&this.props.pop!==!1){const r=e.offsetParent,i=nE(r)&&r.offsetWidth||0,s=nE(r)&&r.offsetHeight||0,o=this.props.sizeRef.current;o.height=e.offsetHeight||0,o.width=e.offsetWidth||0,o.top=e.offsetTop,o.left=e.offsetLeft,o.right=i-o.width-o.left,o.bottom=s-o.height-o.top}return null}componentDidUpdate(){}render(){return this.props.children}}function utt({children:n,isPresent:t,anchorX:e,anchorY:r,root:i,pop:s}){const o=L.useId(),l=L.useRef(null),u=L.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:h}=L.useContext(zC),d=n.props?.ref??n?.ref,p=ltt(l,d);return L.useInsertionEffect(()=>{const{width:g,height:v,top:T,left:S,right:w,bottom:E}=u.current;if(t||s===!1||!l.current||!g||!v)return;const D=e==="left"?`left: ${S}`:`right: ${w}`,P=r==="bottom"?`bottom: ${E}`:`top: ${T}`;l.current.dataset.motionPopId=o;const V=document.createElement("style");h&&(V.nonce=h);const N=i??document.head;return N.appendChild(V),V.sheet&&V.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${v}px !important;
            ${D}px !important;
            ${P}px !important;
          }
        `),()=>{N.contains(V)&&N.removeChild(V)}},[t]),B.jsx(ctt,{isPresent:t,childRef:l,sizeRef:u,pop:s,children:s===!1?n:L.cloneElement(n,{ref:p})})}const htt=({children:n,initial:t,isPresent:e,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:o,anchorX:l,anchorY:u,root:h})=>{const d=mC(ftt),p=L.useId();let g=!0,v=L.useMemo(()=>(g=!1,{id:p,initial:t,isPresent:e,custom:i,onExitComplete:T=>{d.set(T,!0);for(const S of d.values())if(!S)return;r&&r()},register:T=>(d.set(T,!1),()=>d.delete(T))}),[e,d,r]);return s&&g&&(v={...v}),L.useMemo(()=>{d.forEach((T,S)=>d.set(S,!1))},[e]),L.useEffect(()=>{!e&&!d.size&&r&&r()},[e]),n=B.jsx(utt,{pop:o==="popLayout",isPresent:e,anchorX:l,anchorY:u,root:h,children:n}),B.jsx(n_.Provider,{value:v,children:n})};function ftt(){return new Map}function QF(n=!0){const t=L.useContext(n_);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:r,register:i}=t,s=L.useId();L.useEffect(()=>{if(n)return i(s)},[n]);const o=L.useCallback(()=>n&&r&&r(s),[s,r,n]);return!e&&r?[!1,o]:[!0]}const Oy=n=>n.key||"";function vI(n){const t=[];return L.Children.forEach(n,e=>{L.isValidElement(e)&&t.push(e)}),t}const V0=({children:n,custom:t,initial:e=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:o=!1,anchorX:l="left",anchorY:u="top",root:h})=>{const[d,p]=QF(o),g=L.useMemo(()=>vI(n),[n]),v=o&&!d?[]:g.map(Oy),T=L.useRef(!0),S=L.useRef(g),w=mC(()=>new Map),E=L.useRef(new Set),[D,P]=L.useState(g),[V,N]=L.useState(g);E3(()=>{T.current=!1,S.current=g;for(let k=0;k<V.length;k++){const R=Oy(V[k]);v.includes(R)?(w.delete(R),E.current.delete(R)):w.get(R)!==!0&&w.set(R,!1)}},[V,v.length,v.join("-")]);const q=[];if(g!==D){let k=[...g];for(let R=0;R<V.length;R++){const F=V[R],U=Oy(F);v.includes(U)||(k.splice(R,0,F),q.push(F))}return s==="wait"&&q.length&&(k=q),N(vI(k)),P(g),null}const{forceRender:M}=L.useContext(pC);return B.jsx(B.Fragment,{children:V.map(k=>{const R=Oy(k),F=o&&!d?!1:g===V||v.includes(R),U=()=>{if(E.current.has(R))return;if(E.current.add(R),w.has(R))w.set(R,!0);else return;let H=!0;w.forEach(j=>{j||(H=!1)}),H&&(M?.(),N(S.current),o&&p?.(),r&&r())};return B.jsx(htt,{isPresent:F,initial:!T.current||e?void 0:!1,custom:t,presenceAffectsLayout:i,mode:s,root:h,onExitComplete:F?void 0:U,anchorX:l,anchorY:u,children:k},R)})})},JF=L.createContext({strict:!1}),bI={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let _I=!1;function dtt(){if(_I)return;const n={};for(const t in bI)n[t]={isEnabled:e=>bI[t].some(r=>!!e[r])};AF(n),_I=!0}function ZF(){return dtt(),ZJ()}function ptt(n){const t=ZF();for(const e in n)t[e]={...t[e],...n[e]};AF(t)}const mtt=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","propagate","ignoreStrict","viewport"]);function Ev(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||mtt.has(n)}let tB=n=>!Ev(n);function gtt(n){typeof n=="function"&&(tB=t=>t.startsWith("on")?!Ev(t):n(t))}try{gtt(require("@emotion/is-prop-valid").default)}catch{}function ytt(n,t,e){const r={};for(const i in n)i==="values"&&typeof n.values=="object"||(tB(i)||e===!0&&Ev(i)||!t&&!Ev(i)||n.draggable&&i.startsWith("onDrag"))&&(r[i]=n[i]);return r}const s_=L.createContext({});function vtt(n,t){if(i_(n)){const{initial:e,animate:r}=n;return{initial:e===!1||Kp(e)?e:void 0,animate:Kp(r)?r:void 0}}return n.inherit!==!1?t:{}}function btt(n){const{initial:t,animate:e}=vtt(n,L.useContext(s_));return L.useMemo(()=>({initial:t,animate:e}),[TI(t),TI(e)])}function TI(n){return Array.isArray(n)?n.join(" "):n}const HC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function eB(n,t,e){for(const r in t)!sr(t[r])&&!PF(r,e)&&(n[r]=t[r])}function _tt({transformTemplate:n},t){return L.useMemo(()=>{const e=HC();return BC(e,t,n),Object.assign({},e.vars,e.style)},[t])}function Ttt(n,t){const e=n.style||{},r={};return eB(r,e,n),Object.assign(r,_tt(n,t)),r}function Stt(n,t){const e={},r=Ttt(n,t);return n.drag&&n.dragListener!==!1&&(e.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(e.tabIndex=0),e.style=r,e}const nB=()=>({...HC(),attrs:{}});function wtt(n,t,e,r){const i=L.useMemo(()=>{const s=nB();return NF(s,t,VF(r),n.transformTemplate,n.style),{...s.attrs,style:{...s.style}}},[t]);if(n.style){const s={};eB(s,n.style,n),i.style={...s,...i.style}}return i}const xtt=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function $C(n){return typeof n!="string"||n.includes("-")?!1:!!(xtt.indexOf(n)>-1||/[A-Z]/u.test(n))}function Ett(n,t,e,{latestValues:r},i,s=!1,o){const u=(o??$C(n)?wtt:Stt)(t,r,i,n),h=ytt(t,typeof n=="string",s),d=n!==L.Fragment?{...h,...u,ref:e}:{},{children:p}=t,g=L.useMemo(()=>sr(p)?p.get():p,[p]);return L.createElement(n,{...d,children:g})}function Ctt({scrapeMotionValuesFromProps:n,createRenderState:t},e,r,i){return{latestValues:Att(e,r,i,n),renderState:t()}}function Att(n,t,e,r){const i={},s=r(n,{});for(const g in s)i[g]=N0(s[g]);let{initial:o,animate:l}=n;const u=i_(n),h=EF(n);t&&h&&!u&&n.inherit!==!1&&(o===void 0&&(o=t.initial),l===void 0&&(l=t.animate));let d=e?e.initial===!1:!1;d=d||o===!1;const p=d?l:o;if(p&&typeof p!="boolean"&&!r_(p)){const g=Array.isArray(p)?p:[p];for(let v=0;v<g.length;v++){const T=RC(n,g[v]);if(T){const{transitionEnd:S,transition:w,...E}=T;for(const D in E){let P=E[D];if(Array.isArray(P)){const V=d?P.length-1:0;P=P[V]}P!==null&&(i[D]=P)}for(const D in S)i[D]=S[D]}}}return i}const rB=n=>(t,e)=>{const r=L.useContext(s_),i=L.useContext(n_),s=()=>Ctt(n,t,r,i);return e?s():mC(s)},ktt=rB({scrapeMotionValuesFromProps:UC,createRenderState:HC}),Mtt=rB({scrapeMotionValuesFromProps:jF,createRenderState:nB}),Dtt=Symbol.for("motionComponentSymbol");function Ott(n,t,e){const r=L.useRef(e);L.useInsertionEffect(()=>{r.current=e});const i=L.useRef(null);return L.useCallback(s=>{s&&n.onMount?.(s),t&&(s?t.mount(s):t.unmount());const o=r.current;if(typeof o=="function")if(s){const l=o(s);typeof l=="function"&&(i.current=l)}else i.current?(i.current(),i.current=null):o(s);else o&&(o.current=s)},[t])}const iB=L.createContext({});function gh(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function Rtt(n,t,e,r,i,s){const{visualElement:o}=L.useContext(s_),l=L.useContext(JF),u=L.useContext(n_),h=L.useContext(zC),d=h.reducedMotion,p=h.skipAnimations,g=L.useRef(null),v=L.useRef(!1);r=r||l.renderer,!g.current&&r&&(g.current=r(n,{visualState:t,parent:o,props:e,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:d,skipAnimations:p,isSVG:s}),v.current&&g.current&&(g.current.manuallyAnimateOnMount=!0));const T=g.current,S=L.useContext(iB);T&&!T.projection&&i&&(T.type==="html"||T.type==="svg")&&Itt(g.current,e,i,S);const w=L.useRef(!1);L.useInsertionEffect(()=>{T&&w.current&&T.update(e,u)});const E=e[fF],D=L.useRef(!!E&&!window.MotionHandoffIsComplete?.(E)&&window.MotionHasOptimisedAnimation?.(E));return E3(()=>{v.current=!0,T&&(w.current=!0,window.MotionIsMounted=!0,T.updateFeatures(),T.scheduleRenderMicrotask(),D.current&&T.animationState&&T.animationState.animateChanges())}),L.useEffect(()=>{T&&(!D.current&&T.animationState&&T.animationState.animateChanges(),D.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(E)}),D.current=!1),T.enteringChildren=void 0)}),T}function Itt(n,t,e,r){const{layoutId:i,layout:s,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:h,layoutCrossfade:d}=t;n.projection=new e(n.latestValues,t["data-framer-portal-id"]?void 0:sB(n.parent)),n.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!o||l&&gh(l),visualElement:n,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,crossfade:d,layoutScroll:u,layoutRoot:h})}function sB(n){if(n)return n.options.allowProjection!==!1?n.projection:sB(n.parent)}function uw(n,{forwardMotionProps:t=!1,type:e}={},r,i){r&&ptt(r);const s=e?e==="svg":$C(n),o=s?Mtt:ktt;function l(h,d){let p;const g={...L.useContext(zC),...h,layoutId:Ptt(h)},{isStatic:v}=g,T=btt(h),S=o(h,v);if(!v&&x3){Ntt();const w=Ltt(g);p=w.MeasureLayout,T.visualElement=Rtt(n,S,g,i,w.ProjectionNode,s)}return B.jsxs(s_.Provider,{value:T,children:[p&&T.visualElement?B.jsx(p,{visualElement:T.visualElement,...g}):null,Ett(n,h,Ott(S,T.visualElement,d),S,v,t,s)]})}l.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const u=L.forwardRef(l);return u[Dtt]=n,u}function Ptt({layoutId:n}){const t=L.useContext(pC).id;return t&&n!==void 0?t+"-"+n:n}function Ntt(n,t){L.useContext(JF).strict}function Ltt(n){const t=ZF(),{drag:e,layout:r}=t;if(!e&&!r)return{};const i={...e,...r};return{MeasureLayout:e?.isEnabled(n)||r?.isEnabled(n)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function Vtt(n,t){if(typeof Proxy>"u")return uw;const e=new Map,r=(s,o)=>uw(s,o,n,t),i=(s,o)=>r(s,o);return new Proxy(i,{get:(s,o)=>o==="create"?r:(e.has(o)||e.set(o,uw(o,void 0,n,t)),e.get(o))})}const jtt=(n,t)=>t.isSVG??$C(n)?new gZ(t):new uZ(t,{allowProjection:n!==L.Fragment});class Ftt extends Fl{constructor(t){super(t),t.animationState||(t.animationState=TZ(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();r_(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:e}=this.node.prevProps||{};t!==e&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let Btt=0;class Utt extends Fl{constructor(){super(...arguments),this.id=Btt++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:e}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const i=this.node.animationState.setActive("exit",!t);e&&!t&&i.then(()=>{e(this.id)})}mount(){const{register:t,onExitComplete:e}=this.node.presenceContext||{};e&&e(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const ztt={animation:{Feature:Ftt},exit:{Feature:Utt}};function Lm(n){return{point:{x:n.pageX,y:n.pageY}}}const Htt=n=>t=>LC(t)&&n(t,Lm(t));function vp(n,t,e,r){return Xp(n,t,Htt(e),r)}const oB=({current:n})=>n?n.ownerDocument.defaultView:null,SI=(n,t)=>Math.abs(n-t);function $tt(n,t){const e=SI(n.x,t.x),r=SI(n.y,t.y);return Math.sqrt(e**2+r**2)}const wI=new Set(["auto","scroll"]);class aB{constructor(t,e,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:s=!1,distanceThreshold:o=3,element:l}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=v=>{this.handleScroll(v.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=fw(this.lastMoveEventInfo,this.history),T=this.startEvent!==null,S=$tt(v.offset,{x:0,y:0})>=this.distanceThreshold;if(!T&&!S)return;const{point:w}=v,{timestamp:E}=Gn;this.history.push({...w,timestamp:E});const{onStart:D,onMove:P}=this.handlers;T||(D&&D(this.lastMoveEvent,v),this.startEvent=this.lastMoveEvent),P&&P(this.lastMoveEvent,v)},this.handlePointerMove=(v,T)=>{this.lastMoveEvent=v,this.lastMoveEventInfo=hw(T,this.transformPagePoint),De.update(this.updatePoint,!0)},this.handlePointerUp=(v,T)=>{this.end();const{onEnd:S,onSessionEnd:w,resumeAnimation:E}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const D=fw(v.type==="pointercancel"?this.lastMoveEventInfo:hw(T,this.transformPagePoint),this.history);this.startEvent&&S&&S(v,D),w&&w(v,D)},!LC(t))return;this.dragSnapToOrigin=s,this.handlers=e,this.transformPagePoint=r,this.distanceThreshold=o,this.contextWindow=i||window;const u=Lm(t),h=hw(u,this.transformPagePoint),{point:d}=h,{timestamp:p}=Gn;this.history=[{...d,timestamp:p}];const{onSessionStart:g}=e;g&&g(t,fw(h,this.history)),this.removeListeners=Im(vp(this.contextWindow,"pointermove",this.handlePointerMove),vp(this.contextWindow,"pointerup",this.handlePointerUp),vp(this.contextWindow,"pointercancel",this.handlePointerUp)),l&&this.startScrollTracking(l)}startScrollTracking(t){let e=t.parentElement;for(;e;){const r=getComputedStyle(e);(wI.has(r.overflowX)||wI.has(r.overflowY))&&this.scrollPositions.set(e,{x:e.scrollLeft,y:e.scrollTop}),e=e.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0}),window.addEventListener("scroll",this.onWindowScroll),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const e=this.scrollPositions.get(t);if(!e)return;const r=t===window,i=r?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},s={x:i.x-e.x,y:i.y-e.y};s.x===0&&s.y===0||(r?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=s.x,this.lastMoveEventInfo.point.y+=s.y):this.history.length>0&&(this.history[0].x-=s.x,this.history[0].y-=s.y),this.scrollPositions.set(t,i),De.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),xl(this.updatePoint)}}function hw(n,t){return t?{point:t(n.point)}:n}function xI(n,t){return{x:n.x-t.x,y:n.y-t.y}}function fw({point:n},t){return{point:n,delta:xI(n,lB(t)),offset:xI(n,qtt(t)),velocity:Wtt(t,.1)}}function qtt(n){return n[0]}function lB(n){return n[n.length-1]}function Wtt(n,t){if(n.length<2)return{x:0,y:0};let e=n.length-1,r=null;const i=lB(n);for(;e>=0&&(r=n[e],!(i.timestamp-r.timestamp>as(t)));)e--;if(!r)return{x:0,y:0};r===n[0]&&n.length>2&&i.timestamp-r.timestamp>as(t)*2&&(r=n[1]);const s=ki(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const o={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Gtt(n,{min:t,max:e},r){return t!==void 0&&n<t?n=r?ze(t,n,r.min):Math.max(n,t):e!==void 0&&n>e&&(n=r?ze(e,n,r.max):Math.min(n,e)),n}function EI(n,t,e){return{min:t!==void 0?n.min+t:void 0,max:e!==void 0?n.max+e-(n.max-n.min):void 0}}function Ytt(n,{top:t,left:e,bottom:r,right:i}){return{x:EI(n.x,e,i),y:EI(n.y,t,r)}}function CI(n,t){let e=t.min-n.min,r=t.max-n.max;return t.max-t.min<n.max-n.min&&([e,r]=[r,e]),{min:e,max:r}}function Ktt(n,t){return{x:CI(n.x,t.x),y:CI(n.y,t.y)}}function Xtt(n,t){let e=.5;const r=_r(n),i=_r(t);return i>r?e=Wp(t.min,t.max-r,n.min):r>i&&(e=Wp(n.min,n.max-i,t.min)),eo(0,1,e)}function Qtt(n,t){const e={};return t.min!==void 0&&(e.min=t.min-n.min),t.max!==void 0&&(e.max=t.max-n.min),e}const aE=.35;function Jtt(n=aE){return n===!1?n=0:n===!0&&(n=aE),{x:AI(n,"left","right"),y:AI(n,"top","bottom")}}function AI(n,t,e){return{min:kI(n,t),max:kI(n,e)}}function kI(n,t){return typeof n=="number"?n:n[t]||0}const Ztt=new WeakMap;class tet{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=En(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:e=!1,distanceThreshold:r}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const s=p=>{e&&this.snapToCursor(Lm(p).point),this.stopAnimation()},o=(p,g)=>{const{drag:v,dragPropagation:T,onDragStart:S}=this.getProps();if(v&&!T&&(this.openDragLock&&this.openDragLock(),this.openDragLock=MJ(v),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ls(E=>{let D=this.getAxisMotionValue(E).get()||0;if(Qs.test(D)){const{projection:P}=this.visualElement;if(P&&P.layout){const V=P.layout.layoutBox[E];V&&(D=_r(V)*(parseFloat(D)/100))}}this.originPoint[E]=D}),S&&De.update(()=>S(p,g),!1,!0),Jx(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},l=(p,g)=>{this.latestPointerEvent=p,this.latestPanInfo=g;const{dragPropagation:v,dragDirectionLock:T,onDirectionLock:S,onDrag:w}=this.getProps();if(!v&&!this.openDragLock)return;const{offset:E}=g;if(T&&this.currentDirection===null){this.currentDirection=net(E),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",g.point,E),this.updateAxis("y",g.point,E),this.visualElement.render(),w&&De.update(()=>w(p,g),!1,!0)},u=(p,g)=>{this.latestPointerEvent=p,this.latestPanInfo=g,this.stop(p,g),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>{const{dragSnapToOrigin:p}=this.getProps();(p||this.constraints)&&this.startAnimation({x:0,y:0})},{dragSnapToOrigin:d}=this.getProps();this.panSession=new aB(t,{onSessionStart:s,onStart:o,onMove:l,onSessionEnd:u,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:r,contextWindow:oB(this.visualElement),element:this.visualElement.current})}stop(t,e){const r=t||this.latestPointerEvent,i=e||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!i||!r)return;const{velocity:o}=i;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&De.postRender(()=>l(r,i))}cancel(){this.isDragging=!1;const{projection:t,animationState:e}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),e&&e.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(t,e,r){const{drag:i}=this.getProps();if(!r||!Ry(t,i,this.currentDirection))return;const s=this.getAxisMotionValue(t);let o=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(o=Gtt(o,this.constraints[t],this.elastic[t])),s.set(o)}resolveConstraints(){const{dragConstraints:t,dragElastic:e}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;t&&gh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=Ytt(r.layoutBox,t):this.constraints=!1,this.elastic=Jtt(e),i!==this.constraints&&!gh(t)&&r&&this.constraints&&!this.hasMutatedConstraints&&Ls(s=>{this.constraints!==!1&&this.getAxisMotionValue(s)&&(this.constraints[s]=Qtt(r.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:e}=this.getProps();if(!t||!gh(t))return!1;const r=t.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=iZ(r,i.root,this.visualElement.getTransformPagePoint());let o=Ktt(i.layout.layoutBox,s);if(e){const l=e(eZ(o));this.hasMutatedConstraints=!!l,l&&(o=MF(l))}return o}startAnimation(t){const{drag:e,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},h=Ls(d=>{if(!Ry(d,e,this.currentDirection))return;let p=u&&u[d]||{};o&&(p={min:0,max:0});const g=i?200:1e6,v=i?40:1e7,T={type:"inertia",velocity:r?t[d]:0,bounceStiffness:g,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...s,...p};return this.startAxisValueAnimation(d,T)});return Promise.all(h).then(l)}startAxisValueAnimation(t,e){const r=this.getAxisMotionValue(t);return Jx(this.visualElement,t),r.start(OC(t,r,0,e,this.visualElement,!1))}stopAnimation(){Ls(t=>this.getAxisMotionValue(t).stop())}getAxisMotionValue(t){const e=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),i=r[e];return i||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Ls(e=>{const{drag:r}=this.getProps();if(!Ry(e,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(e);if(i&&i.layout){const{min:o,max:l}=i.layout.layoutBox[e],u=s.get()||0;s.set(t[e]-ze(o,l,.5)+u)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:e}=this.getProps(),{projection:r}=this.visualElement;if(!gh(e)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Ls(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();i[o]=Xtt({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.constraints=!1,this.resolveConstraints(),Ls(o=>{if(!Ry(o,t,null))return;const l=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];l.set(ze(u,h,i[o]))}),this.visualElement.render()}addListeners(){if(!this.visualElement.current)return;Ztt.set(this.visualElement,this);const t=this.visualElement.current,e=vp(t,"pointerdown",h=>{const{drag:d,dragListener:p=!0}=this.getProps(),g=h.target,v=g!==t&&NJ(g);d&&p&&!v&&this.start(h)});let r;const i=()=>{const{dragConstraints:h}=this.getProps();gh(h)&&h.current&&(this.constraints=this.resolveRefConstraints(),r||(r=eet(t,h.current,()=>this.scalePositionWithinConstraints())))},{projection:s}=this.visualElement,o=s.addEventListener("measure",i);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),De.read(i);const l=Xp(window,"resize",()=>this.scalePositionWithinConstraints()),u=s.addEventListener("didUpdate",(({delta:h,hasLayoutChanged:d})=>{this.isDragging&&d&&(Ls(p=>{const g=this.getAxisMotionValue(p);g&&(this.originPoint[p]+=h[p].translate,g.set(g.get()+h[p].translate))}),this.visualElement.render())}));return()=>{l(),e(),o(),u&&u(),r&&r()}}getProps(){const t=this.visualElement.getProps(),{drag:e=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:o=aE,dragMomentum:l=!0}=t;return{...t,drag:e,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:o,dragMomentum:l}}}function MI(n){let t=!0;return()=>{if(t){t=!1;return}n()}}function eet(n,t,e){const r=L2(n,MI(e)),i=L2(t,MI(e));return()=>{r(),i()}}function Ry(n,t,e){return(t===!0||t===n)&&(e===null||e===n)}function net(n,t=10){let e=null;return Math.abs(n.y)>t?e="y":Math.abs(n.x)>t&&(e="x"),e}class ret extends Fl{constructor(t){super(t),this.removeGroupControls=Mi,this.removeListeners=Mi,this.controls=new tet(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Mi}update(){const{dragControls:t}=this.node.getProps(),{dragControls:e}=this.node.prevProps||{};t!==e&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const dw=n=>(t,e)=>{n&&De.update(()=>n(t,e),!1,!0)};class iet extends Fl{constructor(){super(...arguments),this.removePointerDownListener=Mi}onPointerDown(t){this.session=new aB(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:oB(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:e,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:dw(t),onStart:dw(e),onMove:dw(r),onEnd:(s,o)=>{delete this.session,i&&De.postRender(()=>i(s,o))}}}mount(){this.removePointerDownListener=vp(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let pw=!1;class set extends L.Component{componentDidMount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=t;s&&(e.group&&e.group.add(s),r&&r.register&&i&&r.register(s),pw&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),L0.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:e,visualElement:r,drag:i,isPresent:s}=this.props,{projection:o}=r;return o&&(o.isPresent=s,t.layoutDependency!==e&&o.setOptions({...o.options,layoutDependency:e}),pw=!0,i||t.layoutDependency!==e||e===void 0||t.isPresent!==s?o.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?o.promote():o.relegate()||De.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),NC.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:e,switchLayoutGroup:r}=this.props,{projection:i}=t;pw=!0,i&&(i.scheduleCheckAfterUnmount(),e&&e.group&&e.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function cB(n){const[t,e]=QF(),r=L.useContext(pC);return B.jsx(set,{...n,layoutGroup:r,switchLayoutGroup:L.useContext(iB),isPresent:t,safeToRemove:e})}const oet={pan:{Feature:iet},drag:{Feature:ret,ProjectionNode:XF,MeasureLayout:cB}};function DI(n,t,e){const{props:r}=n;n.animationState&&r.whileHover&&n.animationState.setActive("whileHover",e==="Start");const i="onHover"+e,s=r[i];s&&De.postRender(()=>s(t,Lm(t)))}class aet extends Fl{mount(){const{current:t}=this.node;t&&(this.unmount=OJ(t,(e,r)=>(DI(this.node,r,"Start"),i=>DI(this.node,i,"End"))))}unmount(){}}class cet extends Fl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Im(Xp(this.node.current,"focus",()=>this.onFocus()),Xp(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function OI(n,t,e){const{props:r}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&r.whileTap&&n.animationState.setActive("whileTap",e==="Start");const i="onTap"+(e==="End"?"":e),s=r[i];s&&De.postRender(()=>s(t,Lm(t)))}class uet extends Fl{mount(){const{current:t}=this.node;if(!t)return;const{globalTapTarget:e,propagate:r}=this.node.props;this.unmount=VJ(t,(i,s)=>(OI(this.node,s,"Start"),(o,{success:l})=>OI(this.node,o,l?"End":"Cancel")),{useGlobalTarget:e,stopPropagation:r?.tap===!1})}unmount(){}}const lE=new WeakMap,mw=new WeakMap,het=n=>{const t=lE.get(n.target);t&&t(n)},fet=n=>{n.forEach(het)};function det({root:n,...t}){const e=n||document;mw.has(e)||mw.set(e,{});const r=mw.get(e),i=JSON.stringify(t);return r[i]||(r[i]=new IntersectionObserver(fet,{root:n,...t})),r[i]}function pet(n,t,e){const r=det(t);return lE.set(n,e),r.observe(n),()=>{lE.delete(n),r.unobserve(n)}}const met={some:0,all:1};class get extends Fl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:e,margin:r,amount:i="some",once:s}=t,o={root:e?e.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:met[i]},l=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:d,onViewportLeave:p}=this.node.getProps(),g=h?d:p;g&&g(u)};return pet(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:e}=this.node;["amount","margin","root"].some(yet(t,e))&&this.startObserver()}unmount(){}}function yet({viewport:n={}},{viewport:t={}}={}){return e=>n[e]!==t[e]}const vet={inView:{Feature:get},tap:{Feature:uet},focus:{Feature:cet},hover:{Feature:aet}},bet={layout:{ProjectionNode:XF,MeasureLayout:cB}},_et={...ztt,...vet,...oet,...bet},Cn=Vtt(_et,jtt);function Tet(){const{user:n,loading:t,signInWithGoogle:e,signInWithEmail:r,signUp:i}=Rm(),s=ym(),[o,l]=L.useState(!1),[u,h]=L.useState(""),[d,p]=L.useState(""),[g,v]=L.useState(""),[T,S]=L.useState(""),[w,E]=L.useState(!1);L.useEffect(()=>{!t&&n&&s("/dashboard",{replace:!0})},[n,t,s]);const D=async()=>{S(""),E(!0);try{await e(),s("/dashboard",{replace:!0})}catch(V){S(V.message||"Google sign-in failed. Please try again.")}finally{E(!1)}},P=async V=>{V.preventDefault(),S(""),E(!0);try{o?await i(d,g,u):await r(d,g),s("/dashboard",{replace:!0})}catch(N){S(N.message||"Authentication failed. Please try again.")}finally{E(!1)}};return t?B.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-100 via-pink-50 to-rose-100",children:B.jsx("div",{className:"animate-pulse font-['Pacifico'] text-3xl text-pink-400",children:"DearMe "})}):B.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-100 via-pink-50 to-rose-100 px-4",children:B.jsxs(Cn.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"w-full max-w-md bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl shadow-pink-200/40 p-8",children:[B.jsx("h1",{className:"font-['Pacifico'] text-4xl text-pink-400 text-center mb-2",children:"DearMe "}),B.jsx("p",{className:"font-['Poppins'] text-sm text-pink-300 text-center mb-8",children:"Your safe, beautiful diary"}),T&&B.jsx(Cn.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 p-3 rounded-xl bg-red-50 border border-red-200 text-red-600 text-sm font-['Poppins'] text-center",children:T}),B.jsxs("button",{type:"button",onClick:D,disabled:w,className:"w-full flex items-center justify-center gap-3 py-3 px-4 rounded-xl border border-pink-200 bg-white hover:bg-pink-50 transition-colors font-['Poppins'] text-sm text-gray-700 mb-6 disabled:opacity-50 disabled:cursor-not-allowed",children:[B.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[B.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 0 1-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z",fill:"#4285F4"}),B.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),B.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),B.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Sign in with Google"]}),B.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[B.jsx("div",{className:"flex-1 h-px bg-pink-200"}),B.jsx("span",{className:"font-['Poppins'] text-xs text-pink-300",children:"or"}),B.jsx("div",{className:"flex-1 h-px bg-pink-200"})]}),B.jsxs("form",{onSubmit:P,className:"space-y-4",children:[o&&B.jsx(Cn.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:B.jsx("input",{type:"text",placeholder:"Your name",value:u,onChange:V=>h(V.target.value),className:"w-full px-4 py-3 rounded-xl border border-pink-200 bg-white/70 font-['Poppins'] text-sm text-gray-700 placeholder-pink-300 focus:outline-none focus:ring-2 focus:ring-pink-300 focus:border-transparent transition-all"})}),B.jsx("input",{type:"email",placeholder:"Email",value:d,onChange:V=>p(V.target.value),required:!0,className:"w-full px-4 py-3 rounded-xl border border-pink-200 bg-white/70 font-['Poppins'] text-sm text-gray-700 placeholder-pink-300 focus:outline-none focus:ring-2 focus:ring-pink-300 focus:border-transparent transition-all"}),B.jsx("input",{type:"password",placeholder:"Password",value:g,onChange:V=>v(V.target.value),required:!0,className:"w-full px-4 py-3 rounded-xl border border-pink-200 bg-white/70 font-['Poppins'] text-sm text-gray-700 placeholder-pink-300 focus:outline-none focus:ring-2 focus:ring-pink-300 focus:border-transparent transition-all"}),B.jsx("button",{type:"submit",disabled:w,className:"w-full py-3 rounded-xl bg-pink-400 hover:bg-pink-500 text-white font-['Poppins'] text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:w?"Please wait...":o?"Create Account":"Sign In"})]}),B.jsxs("p",{className:"mt-6 text-center font-['Poppins'] text-sm text-gray-500",children:[o?"Already have an account?":"Don't have an account?"," ",B.jsx("button",{type:"button",onClick:()=>{l(!o),S("")},className:"text-pink-400 hover:text-pink-500 font-medium transition-colors",children:o?"Sign In":"Sign Up"})]})]})})}const uB=6048e5,wet=864e5,RI=Symbol.for("constructDateFrom");function ds(n,t){return typeof n=="function"?n(t):n&&typeof n=="object"&&RI in n?n[RI](t):n instanceof Date?new n.constructor(t):new Date(t)}function Er(n,t){return ds(t||n,n)}function qC(n,t,e){const r=Er(n,e?.in);if(isNaN(t))return ds(n,NaN);if(!t)return r;const i=r.getDate(),s=ds(n,r.getTime());s.setMonth(r.getMonth()+t+1,0);const o=s.getDate();return i>=o?s:(r.setFullYear(s.getFullYear(),s.getMonth(),i),r)}let xet={};function Vm(){return xet}function Kh(n,t){const e=Vm(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??e.weekStartsOn??e.locale?.options?.weekStartsOn??0,i=Er(n,t?.in),s=i.getDay(),o=(s<r?7:0)+s-r;return i.setDate(i.getDate()-o),i.setHours(0,0,0,0),i}function Cv(n,t){return Kh(n,{...t,weekStartsOn:1})}function hB(n,t){const e=Er(n,t?.in),r=e.getFullYear(),i=ds(e,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const s=Cv(i),o=ds(e,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const l=Cv(o);return e.getTime()>=s.getTime()?r+1:e.getTime()>=l.getTime()?r:r-1}function II(n){const t=Er(n),e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),+n-+e}function o_(n,...t){const e=ds.bind(null,t.find(r=>typeof r=="object"));return t.map(e)}function Xh(n,t){const e=Er(n,t?.in);return e.setHours(0,0,0,0),e}function fB(n,t,e){const[r,i]=o_(e?.in,n,t),s=Xh(r),o=Xh(i),l=+s-II(s),u=+o-II(o);return Math.round((l-u)/wet)}function Eet(n,t){const e=hB(n,t),r=ds(n,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),Cv(r)}function Cet(n,t,e){return qC(n,t*12,e)}function PI(n,t,e){const[r,i]=o_(e?.in,n,t);return+Xh(r)==+Xh(i)}function Aet(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function ket(n){return!(!Aet(n)&&typeof n!="number"||isNaN(+Er(n)))}function dB(n,t){const e=Er(n,t?.in),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function Met(n,t){const[e,r]=o_(n,t.start,t.end);return{start:e,end:r}}function Det(n,t){const{start:e,end:r}=Met(t?.in,n);let i=+e>+r;const s=i?+e:+r,o=i?r:e;o.setHours(0,0,0,0);let l=1;const u=[];for(;+o<=s;)u.push(ds(e,o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return i?u.reverse():u}function pB(n,t){const e=Er(n,t?.in);return e.setDate(1),e.setHours(0,0,0,0),e}function Oet(n,t){const e=Er(n,t?.in);return e.setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e}function Ret(n,t){const e=Vm(),r=e.weekStartsOn??e.locale?.options?.weekStartsOn??0,i=Er(n,t?.in),s=i.getDay(),o=(s<r?-7:0)+6-(s-r);return i.setDate(i.getDate()+o),i.setHours(23,59,59,999),i}const Iet={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Pet=(n,t,e)=>{let r;const i=Iet[n];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),e?.addSuffix?e.comparison&&e.comparison>0?"in "+r:r+" ago":r};function gw(n){return(t={})=>{const e=t.width?String(t.width):n.defaultWidth;return n.formats[e]||n.formats[n.defaultWidth]}}const Net={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Let={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Vet={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},jet={date:gw({formats:Net,defaultWidth:"full"}),time:gw({formats:Let,defaultWidth:"full"}),dateTime:gw({formats:Vet,defaultWidth:"full"})},Fet={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Bet=(n,t,e,r)=>Fet[n];function Fd(n){return(t,e)=>{const r=e?.context?String(e.context):"standalone";let i;if(r==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,l=e?.width?String(e.width):o;i=n.formattingValues[l]||n.formattingValues[o]}else{const o=n.defaultWidth,l=e?.width?String(e.width):n.defaultWidth;i=n.values[l]||n.values[o]}const s=n.argumentCallback?n.argumentCallback(t):t;return i[s]}}const Uet={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},zet={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Het={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},$et={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},qet={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Wet={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Get=(n,t)=>{const e=Number(n),r=e%100;if(r>20||r<10)switch(r%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},Yet={ordinalNumber:Get,era:Fd({values:Uet,defaultWidth:"wide"}),quarter:Fd({values:zet,defaultWidth:"wide",argumentCallback:n=>n-1}),month:Fd({values:Het,defaultWidth:"wide"}),day:Fd({values:$et,defaultWidth:"wide"}),dayPeriod:Fd({values:qet,defaultWidth:"wide",formattingValues:Wet,defaultFormattingWidth:"wide"})};function Bd(n){return(t,e={})=>{const r=e.width,i=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],s=t.match(i);if(!s)return null;const o=s[0],l=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],u=Array.isArray(l)?Xet(l,p=>p.test(o)):Ket(l,p=>p.test(o));let h;h=n.valueCallback?n.valueCallback(u):u,h=e.valueCallback?e.valueCallback(h):h;const d=t.slice(o.length);return{value:h,rest:d}}}function Ket(n,t){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&t(n[e]))return e}function Xet(n,t){for(let e=0;e<n.length;e++)if(t(n[e]))return e}function Qet(n){return(t,e={})=>{const r=t.match(n.matchPattern);if(!r)return null;const i=r[0],s=t.match(n.parsePattern);if(!s)return null;let o=n.valueCallback?n.valueCallback(s[0]):s[0];o=e.valueCallback?e.valueCallback(o):o;const l=t.slice(i.length);return{value:o,rest:l}}}const Jet=/^(\d+)(th|st|nd|rd)?/i,Zet=/\d+/i,tnt={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ent={any:[/^b/i,/^(a|c)/i]},nnt={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},rnt={any:[/1/i,/2/i,/3/i,/4/i]},int={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},snt={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ont={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ant={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},lnt={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},cnt={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},unt={ordinalNumber:Qet({matchPattern:Jet,parsePattern:Zet,valueCallback:n=>parseInt(n,10)}),era:Bd({matchPatterns:tnt,defaultMatchWidth:"wide",parsePatterns:ent,defaultParseWidth:"any"}),quarter:Bd({matchPatterns:nnt,defaultMatchWidth:"wide",parsePatterns:rnt,defaultParseWidth:"any",valueCallback:n=>n+1}),month:Bd({matchPatterns:int,defaultMatchWidth:"wide",parsePatterns:snt,defaultParseWidth:"any"}),day:Bd({matchPatterns:ont,defaultMatchWidth:"wide",parsePatterns:ant,defaultParseWidth:"any"}),dayPeriod:Bd({matchPatterns:lnt,defaultMatchWidth:"any",parsePatterns:cnt,defaultParseWidth:"any"})},hnt={code:"en-US",formatDistance:Pet,formatLong:jet,formatRelative:Bet,localize:Yet,match:unt,options:{weekStartsOn:0,firstWeekContainsDate:1}};function fnt(n,t){const e=Er(n,t?.in);return fB(e,Oet(e))+1}function dnt(n,t){const e=Er(n,t?.in),r=+Cv(e)-+Eet(e);return Math.round(r/uB)+1}function mB(n,t){const e=Er(n,t?.in),r=e.getFullYear(),i=Vm(),s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,o=ds(t?.in||n,0);o.setFullYear(r+1,0,s),o.setHours(0,0,0,0);const l=Kh(o,t),u=ds(t?.in||n,0);u.setFullYear(r,0,s),u.setHours(0,0,0,0);const h=Kh(u,t);return+e>=+l?r+1:+e>=+h?r:r-1}function pnt(n,t){const e=Vm(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??e.firstWeekContainsDate??e.locale?.options?.firstWeekContainsDate??1,i=mB(n,t),s=ds(t?.in||n,0);return s.setFullYear(i,0,r),s.setHours(0,0,0,0),Kh(s,t)}function mnt(n,t){const e=Er(n,t?.in),r=+Kh(e,t)-+pnt(e,t);return Math.round(r/uB)+1}function ye(n,t){const e=n<0?"-":"",r=Math.abs(n).toString().padStart(t,"0");return e+r}const Ba={y(n,t){const e=n.getFullYear(),r=e>0?e:1-e;return ye(t==="yy"?r%100:r,t.length)},M(n,t){const e=n.getMonth();return t==="M"?String(e+1):ye(e+1,2)},d(n,t){return ye(n.getDate(),t.length)},a(n,t){const e=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];default:return e==="am"?"a.m.":"p.m."}},h(n,t){return ye(n.getHours()%12||12,t.length)},H(n,t){return ye(n.getHours(),t.length)},m(n,t){return ye(n.getMinutes(),t.length)},s(n,t){return ye(n.getSeconds(),t.length)},S(n,t){const e=t.length,r=n.getMilliseconds(),i=Math.trunc(r*Math.pow(10,e-3));return ye(i,t.length)}},ah={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},NI={G:function(n,t,e){const r=n.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return e.era(r,{width:"abbreviated"});case"GGGGG":return e.era(r,{width:"narrow"});default:return e.era(r,{width:"wide"})}},y:function(n,t,e){if(t==="yo"){const r=n.getFullYear(),i=r>0?r:1-r;return e.ordinalNumber(i,{unit:"year"})}return Ba.y(n,t)},Y:function(n,t,e,r){const i=mB(n,r),s=i>0?i:1-i;if(t==="YY"){const o=s%100;return ye(o,2)}return t==="Yo"?e.ordinalNumber(s,{unit:"year"}):ye(s,t.length)},R:function(n,t){const e=hB(n);return ye(e,t.length)},u:function(n,t){const e=n.getFullYear();return ye(e,t.length)},Q:function(n,t,e){const r=Math.ceil((n.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return ye(r,2);case"Qo":return e.ordinalNumber(r,{unit:"quarter"});case"QQQ":return e.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(r,{width:"narrow",context:"formatting"});default:return e.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,t,e){const r=Math.ceil((n.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return ye(r,2);case"qo":return e.ordinalNumber(r,{unit:"quarter"});case"qqq":return e.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(r,{width:"narrow",context:"standalone"});default:return e.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,t,e){const r=n.getMonth();switch(t){case"M":case"MM":return Ba.M(n,t);case"Mo":return e.ordinalNumber(r+1,{unit:"month"});case"MMM":return e.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(r,{width:"narrow",context:"formatting"});default:return e.month(r,{width:"wide",context:"formatting"})}},L:function(n,t,e){const r=n.getMonth();switch(t){case"L":return String(r+1);case"LL":return ye(r+1,2);case"Lo":return e.ordinalNumber(r+1,{unit:"month"});case"LLL":return e.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(r,{width:"narrow",context:"standalone"});default:return e.month(r,{width:"wide",context:"standalone"})}},w:function(n,t,e,r){const i=mnt(n,r);return t==="wo"?e.ordinalNumber(i,{unit:"week"}):ye(i,t.length)},I:function(n,t,e){const r=dnt(n);return t==="Io"?e.ordinalNumber(r,{unit:"week"}):ye(r,t.length)},d:function(n,t,e){return t==="do"?e.ordinalNumber(n.getDate(),{unit:"date"}):Ba.d(n,t)},D:function(n,t,e){const r=fnt(n);return t==="Do"?e.ordinalNumber(r,{unit:"dayOfYear"}):ye(r,t.length)},E:function(n,t,e){const r=n.getDay();switch(t){case"E":case"EE":case"EEE":return e.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(r,{width:"short",context:"formatting"});default:return e.day(r,{width:"wide",context:"formatting"})}},e:function(n,t,e,r){const i=n.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return ye(s,2);case"eo":return e.ordinalNumber(s,{unit:"day"});case"eee":return e.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(i,{width:"short",context:"formatting"});default:return e.day(i,{width:"wide",context:"formatting"})}},c:function(n,t,e,r){const i=n.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return ye(s,t.length);case"co":return e.ordinalNumber(s,{unit:"day"});case"ccc":return e.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(i,{width:"narrow",context:"standalone"});case"cccccc":return e.day(i,{width:"short",context:"standalone"});default:return e.day(i,{width:"wide",context:"standalone"})}},i:function(n,t,e){const r=n.getDay(),i=r===0?7:r;switch(t){case"i":return String(i);case"ii":return ye(i,t.length);case"io":return e.ordinalNumber(i,{unit:"day"});case"iii":return e.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(r,{width:"short",context:"formatting"});default:return e.day(r,{width:"wide",context:"formatting"})}},a:function(n,t,e){const i=n.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return e.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(i,{width:"narrow",context:"formatting"});default:return e.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(n,t,e){const r=n.getHours();let i;switch(r===12?i=ah.noon:r===0?i=ah.midnight:i=r/12>=1?"pm":"am",t){case"b":case"bb":return e.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(i,{width:"narrow",context:"formatting"});default:return e.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(n,t,e){const r=n.getHours();let i;switch(r>=17?i=ah.evening:r>=12?i=ah.afternoon:r>=4?i=ah.morning:i=ah.night,t){case"B":case"BB":case"BBB":return e.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(i,{width:"narrow",context:"formatting"});default:return e.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(n,t,e){if(t==="ho"){let r=n.getHours()%12;return r===0&&(r=12),e.ordinalNumber(r,{unit:"hour"})}return Ba.h(n,t)},H:function(n,t,e){return t==="Ho"?e.ordinalNumber(n.getHours(),{unit:"hour"}):Ba.H(n,t)},K:function(n,t,e){const r=n.getHours()%12;return t==="Ko"?e.ordinalNumber(r,{unit:"hour"}):ye(r,t.length)},k:function(n,t,e){let r=n.getHours();return r===0&&(r=24),t==="ko"?e.ordinalNumber(r,{unit:"hour"}):ye(r,t.length)},m:function(n,t,e){return t==="mo"?e.ordinalNumber(n.getMinutes(),{unit:"minute"}):Ba.m(n,t)},s:function(n,t,e){return t==="so"?e.ordinalNumber(n.getSeconds(),{unit:"second"}):Ba.s(n,t)},S:function(n,t){return Ba.S(n,t)},X:function(n,t,e){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return VI(r);case"XXXX":case"XX":return Ac(r);default:return Ac(r,":")}},x:function(n,t,e){const r=n.getTimezoneOffset();switch(t){case"x":return VI(r);case"xxxx":case"xx":return Ac(r);default:return Ac(r,":")}},O:function(n,t,e){const r=n.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+LI(r,":");default:return"GMT"+Ac(r,":")}},z:function(n,t,e){const r=n.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+LI(r,":");default:return"GMT"+Ac(r,":")}},t:function(n,t,e){const r=Math.trunc(+n/1e3);return ye(r,t.length)},T:function(n,t,e){return ye(+n,t.length)}};function LI(n,t=""){const e=n>0?"-":"+",r=Math.abs(n),i=Math.trunc(r/60),s=r%60;return s===0?e+String(i):e+String(i)+t+ye(s,2)}function VI(n,t){return n%60===0?(n>0?"-":"+")+ye(Math.abs(n)/60,2):Ac(n,t)}function Ac(n,t=""){const e=n>0?"-":"+",r=Math.abs(n),i=ye(Math.trunc(r/60),2),s=ye(r%60,2);return e+i+t+s}const jI=(n,t)=>{switch(n){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},gB=(n,t)=>{switch(n){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},gnt=(n,t)=>{const e=n.match(/(P+)(p+)?/)||[],r=e[1],i=e[2];if(!i)return jI(n,t);let s;switch(r){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",jI(r,t)).replace("{{time}}",gB(i,t))},ynt={p:gB,P:gnt},vnt=/^D+$/,bnt=/^Y+$/,_nt=["D","DD","YY","YYYY"];function Tnt(n){return vnt.test(n)}function Snt(n){return bnt.test(n)}function wnt(n,t,e){const r=xnt(n,t,e);if(console.warn(r),_nt.includes(n))throw new RangeError(r)}function xnt(n,t,e){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${t}\`) for formatting ${r} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Ent=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Cnt=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ant=/^'([^]*?)'?$/,knt=/''/g,Mnt=/[a-zA-Z]/;function Qp(n,t,e){const r=Vm(),i=r.locale??hnt,s=r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,l=Er(n,e?.in);if(!ket(l))throw new RangeError("Invalid time value");let u=t.match(Cnt).map(d=>{const p=d[0];if(p==="p"||p==="P"){const g=ynt[p];return g(d,i.formatLong)}return d}).join("").match(Ent).map(d=>{if(d==="''")return{isToken:!1,value:"'"};const p=d[0];if(p==="'")return{isToken:!1,value:Dnt(d)};if(NI[p])return{isToken:!0,value:d};if(p.match(Mnt))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:d}});i.localize.preprocessor&&(u=i.localize.preprocessor(l,u));const h={firstWeekContainsDate:s,weekStartsOn:o,locale:i};return u.map(d=>{if(!d.isToken)return d.value;const p=d.value;(Snt(p)||Tnt(p))&&wnt(p,t,String(n));const g=NI[p[0]];return g(l,p,i.localize,h)}).join("")}function Dnt(n){const t=n.match(Ant);return t?t[1].replace(knt,"'"):n}function Ont(n,t,e){const[r,i]=o_(e?.in,n,t);return r.getFullYear()===i.getFullYear()&&r.getMonth()===i.getMonth()}function Rnt(n,t,e){return qC(n,-1,e)}function FI(n,t,e){return Cet(n,-1,e)}function Int(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function Pnt(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function Nnt(n,t,e){return t&&Pnt(n.prototype,t),n}function Lnt(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function cE(){return cE=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},cE.apply(this,arguments)}function Vnt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&hE(n,t)}function uE(n){return uE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},uE(n)}function hE(n,t){return hE=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},hE(n,t)}function yB(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function jnt(n,t){return t&&(typeof t=="object"||typeof t=="function")?t:yB(n)}function yw(n,t){return Fnt(n)||Bnt(n,t)||Unt()}function Fnt(n){if(Array.isArray(n))return n}function Bnt(n,t){if(Symbol.iterator in Object(n)||Object.prototype.toString.call(n)==="[object Arguments]"){var e=[],r=!0,i=!1,s=void 0;try{for(var o=n[Symbol.iterator](),l;!(r=(l=o.next()).done)&&(e.push(l.value),!(t&&e.length===t));r=!0);}catch(u){i=!0,s=u}finally{try{!r&&o.return!=null&&o.return()}finally{if(i)throw s}}return e}}function Unt(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function znt(n,t){return t={exports:{}},n(t,t.exports),t.exports}var Hnt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",$nt=Hnt;function vB(){}function bB(){}bB.resetWarningCache=vB;var qnt=function(){function n(r,i,s,o,l,u){if(u!==$nt){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}n.isRequired=n;function t(){return n}var e={array:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:t,element:n,elementType:n,instanceOf:t,node:n,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:bB,resetWarningCache:vB};return e.PropTypes=e,e},se=znt(function(n){n.exports=qnt()});function Wnt(n,t){if(n.length!==t.length)return!1;for(var e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function Gnt(n,t){t===void 0&&(t=Wnt);var e,r=[],i,s=!1;function o(){for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];return s&&e===this&&t(l,r)||(i=n.apply(this,l),s=!0,e=this,r=l),i}return o}var BI=1440*60*1e3,Tc=7,Ynt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Knt=["","Mon","","Wed","","Fri",""];function j0(n,t){var e=new Date(n);return e.setDate(e.getDate()+t),e}function Xnt(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())}function vw(n){return n instanceof Date?n:new Date(n)}function Qnt(n){return j0(new Date,-200)}function bw(n){for(var t=[],e=0;e<n;e+=1)t.push(e);return t}var Ns=10,Iy=4,Sc="react-calendar-heatmap-",WC=(function(n){Vnt(t,n);function t(){var e,r;Int(this,t);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return r=jnt(this,(e=uE(t)).call.apply(e,[this].concat(s))),Lnt(yB(r),"getValueCache",Gnt(function(l){return l.values.reduce(function(u,h){var d=vw(h.date),p=Math.floor((d-r.getStartDateWithEmptyDays())/BI);return u[p]={value:h,className:r.props.classForValue(h),title:r.props.titleForValue?r.props.titleForValue(h):null,tooltipDataAttrs:r.getTooltipDataAttrsForValue(h)},u},{})})),r}return Nnt(t,[{key:"getDateDifferenceInDays",value:function(){var r=this.props,i=r.startDate,s=r.numDays;if(s)return console.warn("numDays is a deprecated prop. It will be removed in the next release. Consider using the startDate prop instead."),s;var o=this.getEndDate()-vw(i);return Math.ceil(o/BI)}},{key:"getSquareSizeWithGutter",value:function(){return Ns+this.props.gutterSize}},{key:"getMonthLabelSize",value:function(){return this.props.showMonthLabels?this.props.horizontal?Ns+Iy:2*(Ns+Iy):0}},{key:"getWeekdayLabelSize",value:function(){return this.props.showWeekdayLabels?this.props.horizontal?30:Ns*1.5:0}},{key:"getStartDate",value:function(){return j0(this.getEndDate(),-this.getDateDifferenceInDays()+1)}},{key:"getEndDate",value:function(){return Xnt(vw(this.props.endDate))}},{key:"getStartDateWithEmptyDays",value:function(){return j0(this.getStartDate(),-this.getNumEmptyDaysAtStart())}},{key:"getNumEmptyDaysAtStart",value:function(){return this.getStartDate().getDay()}},{key:"getNumEmptyDaysAtEnd",value:function(){return Tc-1-this.getEndDate().getDay()}},{key:"getWeekCount",value:function(){var r=this.getDateDifferenceInDays()+this.getNumEmptyDaysAtStart()+this.getNumEmptyDaysAtEnd();return Math.ceil(r/Tc)}},{key:"getWeekWidth",value:function(){return Tc*this.getSquareSizeWithGutter()}},{key:"getWidth",value:function(){return this.getWeekCount()*this.getSquareSizeWithGutter()-(this.props.gutterSize-this.getWeekdayLabelSize())}},{key:"getHeight",value:function(){return this.getWeekWidth()+(this.getMonthLabelSize()-this.props.gutterSize)+this.getWeekdayLabelSize()}},{key:"getValueForIndex",value:function(r){return this.valueCache[r]?this.valueCache[r].value:null}},{key:"getClassNameForIndex",value:function(r){return this.valueCache[r]?this.valueCache[r].className:this.props.classForValue(null)}},{key:"getTitleForIndex",value:function(r){return this.valueCache[r]?this.valueCache[r].title:this.props.titleForValue?this.props.titleForValue(null):null}},{key:"getTooltipDataAttrsForIndex",value:function(r){return this.valueCache[r]?this.valueCache[r].tooltipDataAttrs:this.getTooltipDataAttrsForValue({date:null,count:null})}},{key:"getTooltipDataAttrsForValue",value:function(r){var i=this.props.tooltipDataAttrs;return typeof i=="function"?i(r):i}},{key:"getTransformForWeek",value:function(r){return this.props.horizontal?"translate(".concat(r*this.getSquareSizeWithGutter(),", 0)"):"translate(0, ".concat(r*this.getSquareSizeWithGutter(),")")}},{key:"getTransformForWeekdayLabels",value:function(){return this.props.horizontal?"translate(".concat(Ns,", ").concat(this.getMonthLabelSize(),")"):null}},{key:"getTransformForMonthLabels",value:function(){return this.props.horizontal?"translate(".concat(this.getWeekdayLabelSize(),", 0)"):"translate(".concat(this.getWeekWidth()+Iy,", ").concat(this.getWeekdayLabelSize(),")")}},{key:"getTransformForAllWeeks",value:function(){return this.props.horizontal?"translate(".concat(this.getWeekdayLabelSize(),", ").concat(this.getMonthLabelSize(),")"):"translate(0, ".concat(this.getWeekdayLabelSize(),")")}},{key:"getViewBox",value:function(){return this.props.horizontal?"0 0 ".concat(this.getWidth()," ").concat(this.getHeight()):"0 0 ".concat(this.getHeight()," ").concat(this.getWidth())}},{key:"getSquareCoordinates",value:function(r){return this.props.horizontal?[0,r*this.getSquareSizeWithGutter()]:[r*this.getSquareSizeWithGutter(),0]}},{key:"getWeekdayLabelCoordinates",value:function(r){return this.props.horizontal?[0,(r+1)*Ns+r*this.props.gutterSize]:[r*Ns+r*this.props.gutterSize,Ns]}},{key:"getMonthLabelCoordinates",value:function(r){if(this.props.horizontal)return[r*this.getSquareSizeWithGutter(),this.getMonthLabelSize()-Iy];var i=-2;return[0,(r+1)*this.getSquareSizeWithGutter()+i]}},{key:"handleClick",value:function(r){this.props.onClick&&this.props.onClick(r)}},{key:"handleMouseOver",value:function(r,i){this.props.onMouseOver&&this.props.onMouseOver(r,i)}},{key:"handleMouseLeave",value:function(r,i){this.props.onMouseLeave&&this.props.onMouseLeave(r,i)}},{key:"renderSquare",value:function(r,i){var s=this,o=i<this.getNumEmptyDaysAtStart()||i>=this.getNumEmptyDaysAtStart()+this.getDateDifferenceInDays();if(o&&!this.props.showOutOfRangeDays)return null;var l=this.getSquareCoordinates(r),u=yw(l,2),h=u[0],d=u[1],p=this.getValueForIndex(i),g=In.createElement("rect",cE({key:i,width:Ns,height:Ns,x:h,y:d,className:this.getClassNameForIndex(i),onClick:function(){return s.handleClick(p)},onMouseOver:function(S){return s.handleMouseOver(S,p)},onMouseLeave:function(S){return s.handleMouseLeave(S,p)}},this.getTooltipDataAttrsForIndex(i)),In.createElement("title",null,this.getTitleForIndex(i))),v=this.props.transformDayElement;return v?v(g,p,i):g}},{key:"renderWeek",value:function(r){var i=this;return In.createElement("g",{key:r,transform:this.getTransformForWeek(r),className:"".concat(Sc,"week")},bw(Tc).map(function(s){return i.renderSquare(s,r*Tc+s)}))}},{key:"renderAllWeeks",value:function(){var r=this;return bw(this.getWeekCount()).map(function(i){return r.renderWeek(i)})}},{key:"renderMonthLabels",value:function(){var r=this;if(!this.props.showMonthLabels)return null;var i=bw(this.getWeekCount()-1);return i.map(function(s){var o=j0(r.getStartDateWithEmptyDays(),(s+1)*Tc),l=r.getMonthLabelCoordinates(s),u=yw(l,2),h=u[0],d=u[1];return o.getDate()>=1&&o.getDate()<=Tc?In.createElement("text",{key:s,x:h,y:d,className:"".concat(Sc,"month-label")},r.props.monthLabels[o.getMonth()]):null})}},{key:"renderWeekdayLabels",value:function(){var r=this;return this.props.showWeekdayLabels?this.props.weekdayLabels.map(function(i,s){var o=r.getWeekdayLabelCoordinates(s),l=yw(o,2),u=l[0],h=l[1],d="".concat(r.props.horizontal?"":"".concat(Sc,"small-text")," ").concat(Sc,"weekday-label");return s&1?In.createElement("text",{key:"".concat(u).concat(h),x:u,y:h,className:d},i):null}):null}},{key:"render",value:function(){return this.valueCache=this.getValueCache(this.props),In.createElement("svg",{className:"react-calendar-heatmap",viewBox:this.getViewBox()},In.createElement("g",{transform:this.getTransformForMonthLabels(),className:"".concat(Sc,"month-labels")},this.renderMonthLabels()),In.createElement("g",{transform:this.getTransformForAllWeeks(),className:"".concat(Sc,"all-weeks")},this.renderAllWeeks()),In.createElement("g",{transform:this.getTransformForWeekdayLabels(),className:"".concat(Sc,"weekday-labels")},this.renderWeekdayLabels()))}}]),t})(In.Component);WC.propTypes={values:se.arrayOf(se.shape({date:se.oneOfType([se.string,se.number,se.instanceOf(Date)]).isRequired}).isRequired).isRequired,numDays:se.number,startDate:se.oneOfType([se.string,se.number,se.instanceOf(Date)]),endDate:se.oneOfType([se.string,se.number,se.instanceOf(Date)]),gutterSize:se.number,horizontal:se.bool,showMonthLabels:se.bool,showWeekdayLabels:se.bool,showOutOfRangeDays:se.bool,tooltipDataAttrs:se.oneOfType([se.object,se.func]),titleForValue:se.func,classForValue:se.func,monthLabels:se.arrayOf(se.string),weekdayLabels:se.arrayOf(se.string),onClick:se.func,onMouseOver:se.func,onMouseLeave:se.func,transformDayElement:se.func};WC.defaultProps={numDays:null,startDate:Qnt(),endDate:new Date,gutterSize:1,horizontal:!0,showMonthLabels:!0,showWeekdayLabels:!1,showOutOfRangeDays:!1,tooltipDataAttrs:null,titleForValue:null,classForValue:function(t){return t?"color-filled":"color-empty"},monthLabels:Ynt,weekdayLabels:Knt,onClick:null,onMouseOver:null,onMouseLeave:null,transformDayElement:null};const UI=["#FFE4E1","#E8F5E9","#FFF3E0","#E3F2FD","#F3E5F5","#FFF9C4","#E0F7FA","#FCE4EC"];function Jnt(n,t){if(!n||n.length===0)return null;let e=n;n.length>1&&t&&(e=n.filter(s=>s.id!==t));const r=Math.floor(Math.random()*e.length),i=Math.floor(Math.random()*UI.length);return{...e[r],backgroundColor:UI[i]}}const Znt=[{id:"q1",text:"You survived today. That's enough ",author:"Unknown",category:"self-care"},{id:"q2",text:"Healing is not linear ",author:"Unknown",category:"self-care"},{id:"q3",text:"Little steps count.",author:"Unknown",category:"motivation"},{id:"q4",text:"Be gentle with yourself. You're doing the best you can ",author:"Unknown",category:"self-care"},{id:"q5",text:"You are allowed to take up space in this world ",author:"Unknown",category:"motivation"},{id:"q6",text:"Rest is productive too ",author:"Unknown",category:"productivity"},{id:"q7",text:"Your feelings are valid, always ",author:"Unknown",category:"self-care"},{id:"q8",text:"You don't have to be perfect to be worthy of love ",author:"Unknown",category:"love"},{id:"q9",text:"Progress, not perfection ",author:"Unknown",category:"motivation"},{id:"q10",text:"The sun will rise and we will try again ",author:"Unknown",category:"general"},{id:"q11",text:"You are enough, just as you are ",author:"Unknown",category:"self-care"},{id:"q12",text:"One day at a time, one breath at a time ",author:"Unknown",category:"general"},{id:"q13",text:"Your story isn't over yet ",author:"Unknown",category:"motivation"},{id:"q14",text:"It's okay to not have all the answers right now ",author:"Unknown",category:"general"},{id:"q15",text:"You are someone's reason to smile ",author:"Unknown",category:"love"},{id:"q16",text:"Small progress is still progress ",author:"Unknown",category:"productivity"},{id:"q17",text:"Let yourself bloom at your own pace ",author:"Unknown",category:"self-care"},{id:"q18",text:"You carry so much love in your heart. Give some to yourself ",author:"Unknown",category:"love"},{id:"q19",text:"Done is better than perfect ",author:"Unknown",category:"productivity"},{id:"q20",text:"Breathe. You're going to be okay ",author:"Unknown",category:"general"},{id:"q21",text:"Every day is a fresh start ",author:"Unknown",category:"motivation"},{id:"q22",text:"You deserve the love you keep giving to others ",author:"Unknown",category:"love"},{id:"q23",text:"Celebrate the tiny victories today ",author:"Unknown",category:"productivity"},{id:"q24",text:"Soft days are still good days ",author:"Unknown",category:"general"}],fE=["happy","sad","productive","romantic","anxious","calm","neutral"],Av={happy:"",sad:"",productive:"",romantic:"",anxious:"",calm:"",neutral:""},kc=10,zI=200,_B=5*1024*1024,TB=["image/jpeg","image/png","image/gif","image/webp"],trt={happy:{bg:"bg-yellow-100",border:"border-yellow-400",hover:"hover:bg-yellow-50"},sad:{bg:"bg-blue-100",border:"border-blue-400",hover:"hover:bg-blue-50"},productive:{bg:"bg-green-100",border:"border-green-400",hover:"hover:bg-green-50"},romantic:{bg:"bg-pink-100",border:"border-pink-400",hover:"hover:bg-pink-50"},anxious:{bg:"bg-orange-100",border:"border-orange-400",hover:"hover:bg-orange-50"},calm:{bg:"bg-teal-100",border:"border-teal-400",hover:"hover:bg-teal-50"},neutral:{bg:"bg-gray-100",border:"border-gray-400",hover:"hover:bg-gray-50"}};function SB({value:n,onChange:t}){return B.jsx("div",{className:"flex flex-wrap gap-3",role:"group","aria-label":"Select your mood",children:fE.map(e=>{const r=n===e,i=trt[e];return B.jsxs("button",{type:"button",onClick:()=>t(e),"aria-label":`${e} mood`,"aria-pressed":r,className:`flex flex-col items-center gap-1 px-4 py-3 rounded-2xl border-2 transition-all cursor-pointer font-['Poppins'] text-sm capitalize ${r?`${i.bg} ${i.border} shadow-md scale-105`:`bg-white border-transparent ${i.hover} hover:shadow-sm`}`,children:[B.jsx("span",{className:"text-2xl",role:"img","aria-hidden":"true",children:Av[e]}),B.jsx("span",{className:r?"font-medium":"text-gray-500",children:e})]},e)})})}function ert(){const n=new Date().getHours();return n<12?{text:"Good Morning",emoji:""}:n<18?{text:"Good Afternoon",emoji:""}:{text:"Good Evening",emoji:""}}function nrt(n){return n?(n.toDate?n.toDate():new Date(n)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function rrt(n){if(!n)return"";if(typeof n=="string")return n.slice(0,100);try{const t=[],e=i=>{i.text&&t.push(i.text),i.content&&i.content.forEach(e)};e(n);const r=t.join(" ");return r.length>100?r.slice(0,100)+"":r}catch{return""}}function Ud({className:n=""}){return B.jsx("div",{className:`animate-pulse rounded-2xl bg-pink-100/50 ${n}`,children:B.jsxs("div",{className:"p-5 space-y-3",children:[B.jsx("div",{className:"h-4 bg-pink-200/60 rounded w-3/4"}),B.jsx("div",{className:"h-3 bg-pink-200/40 rounded w-full"}),B.jsx("div",{className:"h-3 bg-pink-200/40 rounded w-1/2"})]})})}const irt={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},lh={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.45,ease:"easeOut"}}},srt={happy:"#fde047",sad:"#93c5fd",productive:"#86efac",romantic:"#f9a8d4",anxious:"#fdba74",calm:"#5eead4",neutral:"#d1d5db"};function ort(){const{user:n}=Rm(),t=ym(),[e,r]=L.useState(null),[i,s]=L.useState([]),[o,l]=L.useState([]),[u,h]=L.useState(!0),[d,p]=L.useState(null),g=L.useMemo(()=>ert(),[]),v=L.useMemo(()=>Jnt(Znt),[]);L.useEffect(()=>{if(!n)return;let S=!1;async function w(){try{const E=await e_(Ho(ni,"users",n.uid));!S&&E.exists()&&r(E.data());const D=Nx(mv(ni,"entries"),Lh("userId","==",n.uid),Lx("date","desc"),ZY(5)),P=await Vx(D);S||s(P.docs.map(M=>({id:M.id,...M.data()})));const V=FI(new Date,1),N=Nx(mv(ni,"entries"),Lh("userId","==",n.uid),Lh("date",">=",ue.fromDate(V)),Lx("date","asc")),q=await Vx(N);S||l(q.docs.map(M=>{const k=M.data(),R=k.date.toDate();return{date:Qp(R,"yyyy-MM-dd"),count:1,mood:k.mood}}))}catch(E){console.error("Dashboard fetch error:",E)}finally{S||h(!1)}}return w(),()=>{S=!0}},[n]);const T=e?.name||n?.displayName||"Friend";return u?B.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-8 space-y-6",children:[B.jsx("div",{className:"animate-pulse h-10 bg-pink-200/40 rounded w-2/3"}),B.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[B.jsx(Ud,{className:"h-28"}),B.jsx(Ud,{className:"h-28"})]}),B.jsx(Ud,{className:"h-32"}),B.jsx(Ud,{className:"h-24"}),B.jsx(Ud,{className:"h-24"})]}):B.jsxs(Cn.div,{className:"max-w-3xl mx-auto px-4 py-8 space-y-8",variants:irt,initial:"hidden",animate:"visible",children:[B.jsxs(Cn.h1,{variants:lh,className:"font-['Pacifico'] text-3xl sm:text-4xl text-[var(--color-text,#4A2040)]",children:[g.text,", ",T," ",g.emoji]}),B.jsxs(Cn.div,{variants:lh,className:"flex flex-wrap items-center gap-4",children:[B.jsxs("div",{className:"flex items-center gap-2 bg-white/80 backdrop-blur rounded-2xl px-5 py-3 shadow-sm border border-pink-100",children:[B.jsx("span",{className:"text-2xl",children:""}),B.jsxs("span",{className:"font-['Poppins'] text-lg font-semibold text-[var(--color-text,#4A2040)]",children:[e?.streak??0," day streak"]})]}),B.jsx("button",{onClick:()=>t("/editor"),className:"ml-auto bg-gradient-to-r from-pink-400 to-rose-400 hover:from-pink-500 hover:to-rose-500 text-white font-['Poppins'] font-medium px-6 py-3 rounded-2xl shadow-md hover:shadow-lg transition-all cursor-pointer",children:" Write Today's Entry"})]}),B.jsxs(Cn.div,{variants:lh,className:"bg-white/80 backdrop-blur rounded-2xl p-5 shadow-sm border border-pink-100",children:[B.jsx("h2",{className:"font-['Caveat'] text-xl text-[var(--color-text,#4A2040)] mb-3",children:"Your Year in Entries "}),B.jsx("div",{className:"overflow-x-auto",children:B.jsx(WC,{startDate:FI(new Date),endDate:new Date,values:o,classForValue:S=>S?"color-filled":"color-empty",titleForValue:S=>{if(!S)return"No entry";const w=Av[S.mood]||"";return`${S.date}  ${S.mood} ${w}`},transformDayElement:(S,w)=>!w||!w.mood?S:In.cloneElement(S,{...S.props,style:{...S.props.style,fill:srt[w.mood]||"#d1d5db"}}),showWeekdayLabels:!0})})]}),v&&B.jsxs(Cn.div,{variants:lh,className:"rounded-2xl p-6 shadow-sm",style:{backgroundColor:v.backgroundColor},children:[B.jsxs("p",{className:"font-['Caveat'] text-xl sm:text-2xl text-gray-800 leading-relaxed",children:['"',v.text,'"']}),B.jsxs("p",{className:"font-['Poppins'] text-sm text-gray-600 mt-2",children:[" ",v.author]})]}),B.jsxs(Cn.div,{variants:lh,className:"bg-white/80 backdrop-blur rounded-2xl p-5 shadow-sm border border-pink-100",children:[B.jsx("h2",{className:"font-['Caveat'] text-xl text-[var(--color-text,#4A2040)] mb-3",children:"How are you feeling right now?"}),B.jsx(SB,{value:d,onChange:p})]}),B.jsxs(Cn.section,{variants:lh,children:[B.jsx("h2",{className:"font-['Caveat'] text-2xl text-[var(--color-text,#4A2040)] mb-4",children:"Recent Entries "}),i.length===0?B.jsx("p",{className:"font-['Poppins'] text-gray-400 text-sm",children:"No entries yet. Start writing your first diary entry!"}):B.jsx("div",{className:"space-y-3",children:i.map(S=>B.jsx(c1,{to:`/editor/${S.id}`,className:"block bg-white/80 backdrop-blur rounded-2xl p-4 shadow-sm border border-pink-100 hover:shadow-md hover:scale-[1.01] transition-all",children:B.jsxs("div",{className:"flex items-start justify-between gap-3",children:[B.jsxs("div",{className:"min-w-0 flex-1",children:[B.jsx("h3",{className:"font-['Poppins'] font-medium text-[var(--color-text,#4A2040)] truncate",children:S.title||"Untitled"}),B.jsx("p",{className:"font-['Poppins'] text-sm text-gray-500 mt-1 line-clamp-2",children:rrt(S.content)}),B.jsx("span",{className:"font-['Poppins'] text-xs text-gray-400 mt-2 inline-block",children:nrt(S.date)})]}),S.mood&&B.jsx("span",{className:"text-2xl flex-shrink-0",title:S.mood,children:Av[S.mood]||""})]})},S.id))})]})]})}var _w={exports:{}},Tw={};var HI;function art(){if(HI)return Tw;HI=1;var n=mm();function t(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var e=typeof Object.is=="function"?Object.is:t,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function l(p,g){var v=g(),T=r({inst:{value:v,getSnapshot:g}}),S=T[0].inst,w=T[1];return s(function(){S.value=v,S.getSnapshot=g,u(S)&&w({inst:S})},[p,v,g]),i(function(){return u(S)&&w({inst:S}),p(function(){u(S)&&w({inst:S})})},[p]),o(v),v}function u(p){var g=p.getSnapshot;p=p.value;try{var v=g();return!e(p,v)}catch{return!0}}function h(p,g){return g()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return Tw.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:d,Tw}var $I;function wB(){return $I||($I=1,_w.exports=art()),_w.exports}var xB=wB();function Wn(n){this.content=n}Wn.prototype={constructor:Wn,find:function(n){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===n)return t;return-1},get:function(n){var t=this.find(n);return t==-1?void 0:this.content[t+1]},update:function(n,t,e){var r=e&&e!=n?this.remove(e):this,i=r.find(n),s=r.content.slice();return i==-1?s.push(e||n,t):(s[i+1]=t,e&&(s[i]=e)),new Wn(s)},remove:function(n){var t=this.find(n);if(t==-1)return this;var e=this.content.slice();return e.splice(t,2),new Wn(e)},addToStart:function(n,t){return new Wn([n,t].concat(this.remove(n).content))},addToEnd:function(n,t){var e=this.remove(n).content.slice();return e.push(n,t),new Wn(e)},addBefore:function(n,t,e){var r=this.remove(t),i=r.content.slice(),s=r.find(n);return i.splice(s==-1?i.length:s,0,t,e),new Wn(i)},forEach:function(n){for(var t=0;t<this.content.length;t+=2)n(this.content[t],this.content[t+1])},prepend:function(n){return n=Wn.from(n),n.size?new Wn(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Wn.from(n),n.size?new Wn(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var t=this;n=Wn.from(n);for(var e=0;e<n.content.length;e+=2)t=t.remove(n.content[e]);return t},toObject:function(){var n={};return this.forEach(function(t,e){n[t]=e}),n},get size(){return this.content.length>>1}};Wn.from=function(n){if(n instanceof Wn)return n;var t=[];if(n)for(var e in n)t.push(e,n[e]);return new Wn(t)};function EB(n,t,e){for(let r=0;;r++){if(r==n.childCount||r==t.childCount)return n.childCount==t.childCount?null:e;let i=n.child(r),s=t.child(r);if(i==s){e+=i.nodeSize;continue}if(!i.sameMarkup(s))return e;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)e++;return e}if(i.content.size||s.content.size){let o=EB(i.content,s.content,e+1);if(o!=null)return o}e+=i.nodeSize}}function CB(n,t,e,r){for(let i=n.childCount,s=t.childCount;;){if(i==0||s==0)return i==s?null:{a:e,b:r};let o=n.child(--i),l=t.child(--s),u=o.nodeSize;if(o==l){e-=u,r-=u;continue}if(!o.sameMarkup(l))return{a:e,b:r};if(o.isText&&o.text!=l.text){let h=0,d=Math.min(o.text.length,l.text.length);for(;h<d&&o.text[o.text.length-h-1]==l.text[l.text.length-h-1];)h++,e--,r--;return{a:e,b:r}}if(o.content.size||l.content.size){let h=CB(o.content,l.content,e-1,r-1);if(h)return h}e-=u,r-=u}}class ut{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,i=0,s){for(let o=0,l=0;l<e;o++){let u=this.content[o],h=l+u.nodeSize;if(h>t&&r(u,i+l,s||null,o)!==!1&&u.content.size){let d=l+1;u.nodesBetween(Math.max(0,t-d),Math.min(u.content.size,e-d),r,i+d)}l=h}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,i){let s="",o=!0;return this.nodesBetween(t,e,(l,u)=>{let h=l.isText?l.text.slice(Math.max(t,u)-u,e-u):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&h||l.isTextblock)&&r&&(o?o=!1:s+=r),s+=h},0),s}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,i=this.content.slice(),s=0;for(e.isText&&e.sameMarkup(r)&&(i[i.length-1]=e.withText(e.text+r.text),s=1);s<t.content.length;s++)i.push(t.content[s]);return new ut(i,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let r=[],i=0;if(e>t)for(let s=0,o=0;o<e;s++){let l=this.content[s],u=o+l.nodeSize;u>t&&((o<t||u>e)&&(l.isText?l=l.cut(Math.max(0,t-o),Math.min(l.text.length,e-o)):l=l.cut(Math.max(0,t-o-1),Math.min(l.content.size,e-o-1))),r.push(l),i+=l.nodeSize),o=u}return new ut(r,i)}cutByIndex(t,e){return t==e?ut.empty:t==0&&e==this.content.length?this:new ut(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let i=this.content.slice(),s=this.size+e.nodeSize-r.nodeSize;return i[t]=e,new ut(i,s)}addToStart(t){return new ut([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new ut(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let i=this.content[e];t(i,r,e),r+=i.nodeSize}}findDiffStart(t,e=0){return EB(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return CB(this,t,e,r)}findIndex(t){if(t==0)return Py(0,t);if(t==this.size)return Py(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let e=0,r=0;;e++){let i=this.child(e),s=r+i.nodeSize;if(s>=t)return s==t?Py(e+1,s):Py(e,r);r=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return ut.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new ut(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return ut.empty;let e,r=0;for(let i=0;i<t.length;i++){let s=t[i];r+=s.nodeSize,i&&s.isText&&t[i-1].sameMarkup(s)?(e||(e=t.slice(0,i)),e[e.length-1]=s.withText(e[e.length-1].text+s.text)):e&&e.push(s)}return new ut(e||t,r)}static from(t){if(!t)return ut.empty;if(t instanceof ut)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new ut([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}ut.empty=new ut([],0);const Sw={index:0,offset:0};function Py(n,t){return Sw.index=n,Sw.offset=t,Sw}function kv(n,t){if(n===t)return!0;if(!(n&&typeof n=="object")||!(t&&typeof t=="object"))return!1;let e=Array.isArray(n);if(Array.isArray(t)!=e)return!1;if(e){if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if(!kv(n[r],t[r]))return!1}else{for(let r in n)if(!(r in t)||!kv(n[r],t[r]))return!1;for(let r in t)if(!(r in n))return!1}return!0}let Ae=class dE{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,r=!1;for(let i=0;i<t.length;i++){let s=t[i];if(this.eq(s))return t;if(this.type.excludes(s.type))e||(e=t.slice(0,i));else{if(s.type.excludes(this.type))return t;!r&&s.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),r=!0),e&&e.push(s)}}return e||(e=t.slice()),r||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&kv(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let r=t.marks[e.type];if(!r)throw new RangeError(`There is no mark type ${e.type} in this schema`);let i=r.create(e.attrs);return r.checkAttrs(i.attrs),i}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].eq(e[r]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return dE.none;if(t instanceof dE)return[t];let e=t.slice();return e.sort((r,i)=>r.type.rank-i.type.rank),e}};Ae.none=[];class Mv extends Error{}class vt{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=kB(this.content,t+this.openStart,e);return r&&new vt(r,this.openStart,this.openEnd)}removeBetween(t,e){return new vt(AB(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return vt.empty;let r=e.openStart||0,i=e.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new vt(ut.fromJSON(t,e.content),r,i)}static maxOpen(t,e=!0){let r=0,i=0;for(let s=t.firstChild;s&&!s.isLeaf&&(e||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=t.lastChild;s&&!s.isLeaf&&(e||!s.type.spec.isolating);s=s.lastChild)i++;return new vt(t,r,i)}}vt.empty=new vt(ut.empty,0,0);function AB(n,t,e){let{index:r,offset:i}=n.findIndex(t),s=n.maybeChild(r),{index:o,offset:l}=n.findIndex(e);if(i==t||s.isText){if(l!=e&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,t).append(n.cut(e))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(AB(s.content,t-i-1,e-i-1)))}function kB(n,t,e,r){let{index:i,offset:s}=n.findIndex(t),o=n.maybeChild(i);if(s==t||o.isText)return r&&!r.canReplace(i,i,e)?null:n.cut(0,t).append(e).append(n.cut(t));let l=kB(o.content,t-s-1,e,o);return l&&n.replaceChild(i,o.copy(l))}function lrt(n,t,e){if(e.openStart>n.depth)throw new Mv("Inserted content deeper than insertion position");if(n.depth-e.openStart!=t.depth-e.openEnd)throw new Mv("Inconsistent open depths");return MB(n,t,e,0)}function MB(n,t,e,r){let i=n.index(r),s=n.node(r);if(i==t.index(r)&&r<n.depth-e.openStart){let o=MB(n,t,e,r+1);return s.copy(s.content.replaceChild(i,o))}else if(e.content.size)if(!e.openStart&&!e.openEnd&&n.depth==r&&t.depth==r){let o=n.parent,l=o.content;return Gc(o,l.cut(0,n.parentOffset).append(e.content).append(l.cut(t.parentOffset)))}else{let{start:o,end:l}=crt(e,n);return Gc(s,OB(n,o,l,t,r))}else return Gc(s,Dv(n,t,r))}function DB(n,t){if(!t.type.compatibleContent(n.type))throw new Mv("Cannot join "+t.type.name+" onto "+n.type.name)}function pE(n,t,e){let r=n.node(e);return DB(r,t.node(e)),r}function Wc(n,t){let e=t.length-1;e>=0&&n.isText&&n.sameMarkup(t[e])?t[e]=n.withText(t[e].text+n.text):t.push(n)}function bp(n,t,e,r){let i=(t||n).node(e),s=0,o=t?t.index(e):i.childCount;n&&(s=n.index(e),n.depth>e?s++:n.textOffset&&(Wc(n.nodeAfter,r),s++));for(let l=s;l<o;l++)Wc(i.child(l),r);t&&t.depth==e&&t.textOffset&&Wc(t.nodeBefore,r)}function Gc(n,t){return n.type.checkContent(t),n.copy(t)}function OB(n,t,e,r,i){let s=n.depth>i&&pE(n,t,i+1),o=r.depth>i&&pE(e,r,i+1),l=[];return bp(null,n,i,l),s&&o&&t.index(i)==e.index(i)?(DB(s,o),Wc(Gc(s,OB(n,t,e,r,i+1)),l)):(s&&Wc(Gc(s,Dv(n,t,i+1)),l),bp(t,e,i,l),o&&Wc(Gc(o,Dv(e,r,i+1)),l)),bp(r,null,i,l),new ut(l)}function Dv(n,t,e){let r=[];if(bp(null,n,e,r),n.depth>e){let i=pE(n,t,e+1);Wc(Gc(i,Dv(n,t,e+1)),r)}return bp(t,null,e,r),new ut(r)}function crt(n,t){let e=t.depth-n.openStart,i=t.node(e).copy(n.content);for(let s=e-1;s>=0;s--)i=t.node(s).copy(ut.from(i));return{start:i.resolveNoCache(n.openStart+e),end:i.resolveNoCache(i.content.size-n.openEnd-e)}}class Jp{constructor(t,e,r){this.pos=t,this.path=e,this.parentOffset=r,this.depth=e.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=t.child(e);return r?t.child(e).cut(r):i}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):t==0?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let r=this.path[e*3],i=e==0?0:this.path[e*3-1]+1;for(let s=0;s<t;s++)i+=r.child(s).nodeSize;return i}marks(){let t=this.parent,e=this.index();if(t.content.size==0)return Ae.none;if(this.textOffset)return t.child(e).marks;let r=t.maybeChild(e-1),i=t.maybeChild(e);if(!r){let l=r;r=i,i=l}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let r=e.marks,i=t.parent.maybeChild(t.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!e||e(this.node(r))))return new Ov(this,t,r);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let r=[],i=0,s=e;for(let o=t;;){let{index:l,offset:u}=o.content.findIndex(s),h=s-u;if(r.push(o,l,i+u),!h||(o=o.child(l),o.isText))break;s=h-1,i+=u+1}return new Jp(e,r,s)}static resolveCached(t,e){let r=qI.get(t);if(r)for(let s=0;s<r.elts.length;s++){let o=r.elts[s];if(o.pos==e)return o}else qI.set(t,r=new urt);let i=r.elts[r.i]=Jp.resolve(t,e);return r.i=(r.i+1)%hrt,i}}class urt{constructor(){this.elts=[],this.i=0}}const hrt=12,qI=new WeakMap;class Ov{constructor(t,e,r){this.$from=t,this.$to=e,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const frt=Object.create(null);class cs{constructor(t,e,r,i=Ae.none){this.type=t,this.attrs=e,this.marks=i,this.content=r||ut.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,r,i=0){this.content.nodesBetween(t,e,r,i,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,r,i){return this.content.textBetween(t,e,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,r){return this.type==t&&kv(this.attrs,e||t.defaultAttrs||frt)&&Ae.sameSet(this.marks,r||Ae.none)}copy(t=null){return t==this.content?this:new cs(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new cs(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return t==0&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,r=!1){if(t==e)return vt.empty;let i=this.resolve(t),s=this.resolve(e),o=r?0:i.sharedDepth(e),l=i.start(o),h=i.node(o).content.cut(i.pos-l,s.pos-l);return new vt(h,i.depth-o,s.depth-o)}replace(t,e,r){return lrt(this.resolve(t),this.resolve(e),r)}nodeAt(t){for(let e=this;;){let{index:r,offset:i}=e.content.findIndex(t);if(e=e.maybeChild(r),!e)return null;if(i==t||e.isText)return e;t-=i+1}}childAfter(t){let{index:e,offset:r}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:r}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:e,offset:r}=this.content.findIndex(t);if(r<t)return{node:this.content.child(e),index:e,offset:r};let i=this.content.child(e-1);return{node:i,index:e-1,offset:r-i.nodeSize}}resolve(t){return Jp.resolveCached(this,t)}resolveNoCache(t){return Jp.resolve(this,t)}rangeHasMark(t,e,r){let i=!1;return e>t&&this.nodesBetween(t,e,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),RB(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,r=ut.empty,i=0,s=r.childCount){let o=this.contentMatchAt(t).matchFragment(r,i,s),l=o&&o.matchFragment(this.content,e);if(!l||!l.validEnd)return!1;for(let u=i;u<s;u++)if(!this.type.allowsMarks(r.child(u).marks))return!1;return!0}canReplaceWith(t,e,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(t).matchType(r),o=s&&s.matchFragment(this.content,e);return o?o.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=Ae.none;for(let e=0;e<this.marks.length;e++){let r=this.marks[e];r.type.checkAttrs(r.attrs),t=r.addToSet(t)}if(!Ae.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(e=>e.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let r;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=e.marks.map(t.markFromJSON)}if(e.type=="text"){if(typeof e.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(e.text,r)}let i=ut.fromJSON(t,e.content),s=t.nodeType(e.type).create(e.attrs,i,r);return s.type.checkAttrs(s.attrs),s}}cs.prototype.text=void 0;class Rv extends cs{constructor(t,e,r,i){if(super(t,e,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):RB(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new Rv(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new Rv(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return t==0&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function RB(n,t){for(let e=n.length-1;e>=0;e--)t=n[e].type.name+"("+t+")";return t}class au{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let r=new drt(t,e);if(r.next==null)return au.empty;let i=IB(r);r.next&&r.err("Unexpected trailing text");let s=_rt(brt(i));return Trt(s,r),s}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,r=t.childCount){let i=this;for(let s=e;i&&s<r;s++)i=i.matchType(t.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!(e.isText||e.hasRequiredAttrs()))return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let r=0;r<t.next.length;r++)if(this.next[e].type==t.next[r].type)return!0;return!1}fillBefore(t,e=!1,r=0){let i=[this];function s(o,l){let u=o.matchFragment(t,r);if(u&&(!e||u.validEnd))return ut.from(l.map(h=>h.createAndFill()));for(let h=0;h<o.next.length;h++){let{type:d,next:p}=o.next[h];if(!(d.isText||d.hasRequiredAttrs())&&i.indexOf(p)==-1){i.push(p);let g=s(p,l.concat(d));if(g)return g}}return null}return s(this,[])}findWrapping(t){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==t)return this.wrapCache[r+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(t)){let o=[];for(let l=i;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:u}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in e)&&(!i.type||u.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),e[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function e(r){t.push(r);for(let i=0;i<r.next.length;i++)t.indexOf(r.next[i].next)==-1&&e(r.next[i].next)}return e(this),t.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+t.indexOf(r.next[o].next);return s}).join(`
`)}}au.empty=new au(!0);class drt{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function IB(n){let t=[];do t.push(prt(n));while(n.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function prt(n){let t=[];do t.push(mrt(n));while(n.next&&n.next!=")"&&n.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function mrt(n){let t=vrt(n);for(;;)if(n.eat("+"))t={type:"plus",expr:t};else if(n.eat("*"))t={type:"star",expr:t};else if(n.eat("?"))t={type:"opt",expr:t};else if(n.eat("{"))t=grt(n,t);else break;return t}function WI(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let t=Number(n.next);return n.pos++,t}function grt(n,t){let e=WI(n),r=e;return n.eat(",")&&(n.next!="}"?r=WI(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:e,max:r,expr:t}}function yrt(n,t){let e=n.nodeTypes,r=e[t];if(r)return[r];let i=[];for(let s in e){let o=e[s];o.isInGroup(t)&&i.push(o)}return i.length==0&&n.err("No node type or group '"+t+"' found"),i}function vrt(n){if(n.eat("(")){let t=IB(n);return n.eat(")")||n.err("Missing closing paren"),t}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let t=yrt(n,n.next).map(e=>(n.inline==null?n.inline=e.isInline:n.inline!=e.isInline&&n.err("Mixing inline and block content"),{type:"name",value:e}));return n.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function brt(n){let t=[[]];return i(s(n,0),e()),t;function e(){return t.push([])-1}function r(o,l,u){let h={term:u,to:l};return t[o].push(h),h}function i(o,l){o.forEach(u=>u.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((u,h)=>u.concat(s(h,l)),[]);if(o.type=="seq")for(let u=0;;u++){let h=s(o.exprs[u],l);if(u==o.exprs.length-1)return h;i(h,l=e())}else if(o.type=="star"){let u=e();return r(l,u),i(s(o.expr,u),u),[r(u)]}else if(o.type=="plus"){let u=e();return i(s(o.expr,l),u),i(s(o.expr,u),u),[r(u)]}else{if(o.type=="opt")return[r(l)].concat(s(o.expr,l));if(o.type=="range"){let u=l;for(let h=0;h<o.min;h++){let d=e();i(s(o.expr,u),d),u=d}if(o.max==-1)i(s(o.expr,u),u);else for(let h=o.min;h<o.max;h++){let d=e();r(u,d),i(s(o.expr,u),d),u=d}return[r(u)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function PB(n,t){return t-n}function GI(n,t){let e=[];return r(t),e.sort(PB);function r(i){let s=n[i];if(s.length==1&&!s[0].term)return r(s[0].to);e.push(i);for(let o=0;o<s.length;o++){let{term:l,to:u}=s[o];!l&&e.indexOf(u)==-1&&r(u)}}}function _rt(n){let t=Object.create(null);return e(GI(n,0));function e(r){let i=[];r.forEach(o=>{n[o].forEach(({term:l,to:u})=>{if(!l)return;let h;for(let d=0;d<i.length;d++)i[d][0]==l&&(h=i[d][1]);GI(n,u).forEach(d=>{h||i.push([l,h=[]]),h.indexOf(d)==-1&&h.push(d)})})});let s=t[r.join(",")]=new au(r.indexOf(n.length-1)>-1);for(let o=0;o<i.length;o++){let l=i[o][1].sort(PB);s.next.push({type:i[o][0],next:t[l.join(",")]||e(l)})}return s}}function Trt(n,t){for(let e=0,r=[n];e<r.length;e++){let i=r[e],s=!i.validEnd,o=[];for(let l=0;l<i.next.length;l++){let{type:u,next:h}=i.next[l];o.push(u.name),s&&!(u.isText||u.hasRequiredAttrs())&&(s=!1),r.indexOf(h)==-1&&r.push(h)}s&&t.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function NB(n){let t=Object.create(null);for(let e in n){let r=n[e];if(!r.hasDefault)return null;t[e]=r.default}return t}function LB(n,t){let e=Object.create(null);for(let r in n){let i=t&&t[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}e[r]=i}return e}function VB(n,t,e,r){for(let i in t)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${e} of type ${i}`);for(let i in n){let s=n[i];s.validate&&s.validate(t[i])}}function jB(n,t){let e=Object.create(null);if(t)for(let r in t)e[r]=new wrt(n,r,t[r]);return e}let YI=class FB{constructor(t,e,r){this.name=t,this.schema=e,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=jB(t,r.attrs),this.defaultAttrs=NB(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==au.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:LB(this.attrs,t)}create(t=null,e,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new cs(this,this.computeAttrs(t),ut.from(e),Ae.setFrom(r))}createChecked(t=null,e,r){return e=ut.from(e),this.checkContent(e),new cs(this,this.computeAttrs(t),e,Ae.setFrom(r))}createAndFill(t=null,e,r){if(t=this.computeAttrs(t),e=ut.from(e),e.size){let o=this.contentMatch.fillBefore(e);if(!o)return null;e=o.append(e)}let i=this.contentMatch.matchFragment(e),s=i&&i.fillBefore(ut.empty,!0);return s?new cs(this,t,e.append(s),Ae.setFrom(r)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){VB(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let e;for(let r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?e&&e.push(t[r]):e||(e=t.slice(0,r));return e?e.length?e:Ae.none:t}static compile(t,e){let r=Object.create(null);t.forEach((s,o)=>r[s]=new FB(s,e,o));let i=e.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function Srt(n,t,e){let r=e.split("|");return i=>{let s=i===null?"null":typeof i;if(r.indexOf(s)<0)throw new RangeError(`Expected value of type ${r} for attribute ${t} on type ${n}, got ${s}`)}}class wrt{constructor(t,e,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?Srt(t,e,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class a_{constructor(t,e,r,i){this.name=t,this.rank=e,this.schema=r,this.spec=i,this.attrs=jB(t,i.attrs),this.excluded=null;let s=NB(this.attrs);this.instance=s?new Ae(this,s):null}create(t=null){return!t&&this.instance?this.instance:new Ae(this,LB(this.attrs,t))}static compile(t,e){let r=Object.create(null),i=0;return t.forEach((s,o)=>r[s]=new a_(s,i++,e,o)),r}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}checkAttrs(t){VB(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class BB{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let e=this.spec={};for(let i in t)e[i]=t[i];e.nodes=Wn.from(t.nodes),e.marks=Wn.from(t.marks||{}),this.nodes=YI.compile(this.spec.nodes,this),this.marks=a_.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",l=s.spec.marks;if(s.contentMatch=r[o]||(r[o]=au.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=l=="_"?null:l?KI(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:KI(this,o.split(" "))}this.nodeFromJSON=i=>cs.fromJSON(this,i),this.markFromJSON=i=>Ae.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,r,i){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof YI){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(e,r,i)}text(t,e){let r=this.nodes.text;return new Rv(r,r.defaultAttrs,t,Ae.setFrom(e))}mark(t,e){return typeof t=="string"&&(t=this.marks[t]),t.create(e)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function KI(n,t){let e=[];for(let r=0;r<t.length;r++){let i=t[r],s=n.marks[i],o=s;if(s)e.push(s);else for(let l in n.marks){let u=n.marks[l];(i=="_"||u.spec.group&&u.spec.group.split(" ").indexOf(i)>-1)&&e.push(o=u)}if(!o)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return e}function xrt(n){return n.tag!=null}function Ert(n){return n.style!=null}class dl{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[];let r=this.matchedStyles=[];e.forEach(i=>{if(xrt(i))this.tags.push(i);else if(Ert(i)){let s=/[^=]*/.exec(i.style)[0];r.indexOf(s)<0&&r.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=t.nodes[i.node];return s.contentMatch.matchType(s)})}parse(t,e={}){let r=new QI(this,e,!1);return r.addAll(t,Ae.none,e.from,e.to),r.finish()}parseSlice(t,e={}){let r=new QI(this,e,!0);return r.addAll(t,Ae.none,e.from,e.to),vt.maxOpen(r.finish())}matchTag(t,e,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(krt(t,s.tag)&&(s.namespace===void 0||t.namespaceURI==s.namespace)&&(!s.context||e.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(t);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(t,e,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(t)!=0||o.context&&!r.matchesContext(o.context)||l.length>t.length&&(l.charCodeAt(t.length)!=61||l.slice(t.length+1)!=e))){if(o.getAttrs){let u=o.getAttrs(e);if(u===!1)continue;o.attrs=u||void 0}return o}}}static schemaRules(t){let e=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<e.length;o++){let l=e[o];if((l.priority==null?50:l.priority)<s)break}e.splice(o,0,i)}for(let i in t.marks){let s=t.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=JI(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in t.nodes){let s=t.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=JI(o)),o.node||o.ignore||o.mark||(o.node=i)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new dl(t,dl.schemaRules(t)))}}const UB={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Crt={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},zB={ol:!0,ul:!0},Zp=1,mE=2,_p=4;function XI(n,t,e){return t!=null?(t?Zp:0)|(t==="full"?mE:0):n&&n.whitespace=="pre"?Zp|mE:e&~_p}class Ny{constructor(t,e,r,i,s,o){this.type=t,this.attrs=e,this.marks=r,this.solid=i,this.options=o,this.content=[],this.activeMarks=Ae.none,this.match=s||(o&_p?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(ut.from(t));if(e)this.match=this.type.contentMatch.matchFragment(e);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(t.type))?(this.match=r,i):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&Zp)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let e=ut.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(ut.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!UB.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class QI{constructor(t,e,r){this.parser=t,this.options=e,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=e.topNode,s,o=XI(null,e.preserveWhitespace,0)|(r?_p:0);i?s=new Ny(i.type,i.attrs,Ae.none,!0,e.topMatch||i.type.contentMatch,o):r?s=new Ny(null,null,Ae.none,!0,null,o):s=new Ny(t.schema.topNodeType,null,Ae.none,!0,null,o),this.nodes=[s],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,e){t.nodeType==3?this.addTextNode(t,e):t.nodeType==1&&this.addElement(t,e)}addTextNode(t,e){let r=t.nodeValue,i=this.top,s=i.options&mE?"full":this.localPreserveWS||(i.options&Zp)>0,{schema:o}=this.parser;if(s==="full"||i.inlineContext(t)||/[^ \t\r\n\u000c]/.test(r)){if(s)if(s==="full")r=r.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(o.linebreakReplacement.create())){let l=r.split(/\r?\n|\r/);for(let u=0;u<l.length;u++)u&&this.insertNode(o.linebreakReplacement.create(),e,!0),l[u]&&this.insertNode(o.text(l[u]),e,!/\S/.test(l[u]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let l=i.content[i.content.length-1],u=t.previousSibling;(!l||u&&u.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(r=r.slice(1))}r&&this.insertNode(o.text(r),e,!/\S/.test(r)),this.findInText(t)}else this.findInside(t)}addElement(t,e,r){let i=this.localPreserveWS,s=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let o=t.nodeName.toLowerCase(),l;zB.hasOwnProperty(o)&&this.parser.normalizeLists&&Art(t);let u=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(l=this.parser.matchTag(t,this,r));t:if(u?u.ignore:Crt.hasOwnProperty(o))this.findInside(t),this.ignoreFallback(t,e);else if(!u||u.skip||u.closeParent){u&&u.closeParent?this.open=Math.max(0,this.open-1):u&&u.skip.nodeType&&(t=u.skip);let h,d=this.needsBlock;if(UB.hasOwnProperty(o))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),h=!0,s.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,e);break t}let p=u&&u.skip?e:this.readStyles(t,e);p&&this.addAll(t,p),h&&this.sync(s),this.needsBlock=d}else{let h=this.readStyles(t,e);h&&this.addElementByRule(t,u,h,u.consuming===!1?l:void 0)}this.localPreserveWS=i}leafFallback(t,e){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),e)}ignoreFallback(t,e){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),e,!0)}readStyles(t,e){let r=t.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],o=r.getPropertyValue(s);if(o)for(let l=void 0;;){let u=this.parser.matchStyle(s,o,this,l);if(!u)break;if(u.ignore)return null;if(u.clearMark?e=e.filter(h=>!u.clearMark(h)):e=e.concat(this.parser.schema.marks[u.mark].create(u.attrs)),u.consuming===!1)l=u;else break}}return e}addElementByRule(t,e,r,i){let s,o;if(e.node)if(o=this.parser.schema.nodes[e.node],o.isLeaf)this.insertNode(o.create(e.attrs),r,t.nodeName=="BR")||this.leafFallback(t,r);else{let u=this.enter(o,e.attrs||null,r,e.preserveWhitespace);u&&(s=!0,r=u)}else{let u=this.parser.schema.marks[e.mark];r=r.concat(u.create(e.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(t);else if(i)this.addElement(t,r,i);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(u=>this.insertNode(u,r,!1));else{let u=t;typeof e.contentElement=="string"?u=t.querySelector(e.contentElement):typeof e.contentElement=="function"?u=e.contentElement(t):e.contentElement&&(u=e.contentElement),this.findAround(t,u,!0),this.addAll(u,r),this.findAround(t,u,!1)}s&&this.sync(l)&&this.open--}addAll(t,e,r,i){let s=r||0;for(let o=r?t.childNodes[r]:t.firstChild,l=i==null?null:t.childNodes[i];o!=l;o=o.nextSibling,++s)this.findAtPoint(t,s),this.addDOM(o,e);this.findAtPoint(t,s)}findPlace(t,e,r){let i,s;for(let o=this.open,l=0;o>=0;o--){let u=this.nodes[o],h=u.findWrapping(t);if(h&&(!i||i.length>h.length+l)&&(i=h,s=u,!h.length))break;if(u.solid){if(r)break;l+=2}}if(!i)return null;this.sync(s);for(let o=0;o<i.length;o++)e=this.enterInner(i[o],null,e,!1);return e}insertNode(t,e,r){if(t.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(e=this.enterInner(s,null,e))}let i=this.findPlace(t,e,r);if(i){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(t.type));let o=Ae.none;for(let l of i.concat(t.marks))(s.type?s.type.allowsMarkType(l.type):ZI(l.type,t.type))&&(o=l.addToSet(o));return s.content.push(t.mark(o)),!0}return!1}enter(t,e,r,i){let s=this.findPlace(t.create(e),r,!1);return s&&(s=this.enterInner(t,e,r,!0,i)),s}enterInner(t,e,r,i=!1,s){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(t);let l=XI(t,s,o.options);o.options&_p&&o.content.length==0&&(l|=_p);let u=Ae.none;return r=r.filter(h=>(o.type?o.type.allowsMarkType(h.type):ZI(h.type,t))?(u=h.addToSet(u),!1):!0),this.nodes.push(new Ny(t,e,u,i,null,l)),this.open++,r}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let e=this.open;e>=0;e--){if(this.nodes[e]==t)return this.open=e,!0;this.localPreserveWS&&(this.nodes[e].options|=Zp)}return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let r=this.nodes[e].content;for(let i=r.length-1;i>=0;i--)t+=r[i].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==e&&(this.find[r].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].pos==null&&t.nodeType==1&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,r){if(t!=e&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&e.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(l,u)=>{for(;l>=0;l--){let h=e[l];if(h==""){if(l==e.length-1||l==0)continue;for(;u>=s;u--)if(o(l-1,u))return!0;return!1}else{let d=u>0||u==0&&i?this.nodes[u].type:r&&u>=s?r.node(u-s).type:null;if(!d||d.name!=h&&!d.isInGroup(h))return!1;u--}}return!0};return o(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let r=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let e in this.parser.schema.nodes){let r=this.parser.schema.nodes[e];if(r.isTextblock&&r.defaultAttrs)return r}}}function Art(n){for(let t=n.firstChild,e=null;t;t=t.nextSibling){let r=t.nodeType==1?t.nodeName.toLowerCase():null;r&&zB.hasOwnProperty(r)&&e?(e.appendChild(t),t=e):r=="li"?e=t:r&&(e=null)}}function krt(n,t){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,t)}function JI(n){let t={};for(let e in n)t[e]=n[e];return t}function ZI(n,t){let e=t.schema.nodes;for(let r in e){let i=e[r];if(!i.allowsMarkType(n))continue;let s=[],o=l=>{s.push(l);for(let u=0;u<l.edgeCount;u++){let{type:h,next:d}=l.edge(u);if(h==t||s.indexOf(d)<0&&o(d))return!0}};if(o(i.contentMatch))return!0}}class yu{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},r){r||(r=ww(e).createDocumentFragment());let i=r,s=[];return t.forEach(o=>{if(s.length||o.marks.length){let l=0,u=0;for(;l<s.length&&u<o.marks.length;){let h=o.marks[u];if(!this.marks[h.type.name]){u++;continue}if(!h.eq(s[l][0])||h.type.spec.spanning===!1)break;l++,u++}for(;l<s.length;)i=s.pop()[1];for(;u<o.marks.length;){let h=o.marks[u++],d=this.serializeMark(h,o.isInline,e);d&&(s.push([h,i]),i.appendChild(d.dom),i=d.contentDOM||d.dom)}}i.appendChild(this.serializeNodeInner(o,e))}),r}serializeNodeInner(t,e){let{dom:r,contentDOM:i}=F0(ww(e),this.nodes[t.type.name](t),null,t.attrs);if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,i)}return r}serializeNode(t,e={}){let r=this.serializeNodeInner(t,e);for(let i=t.marks.length-1;i>=0;i--){let s=this.serializeMark(t.marks[i],t.isInline,e);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(t,e,r={}){let i=this.marks[t.type.name];return i&&F0(ww(r),i(t,e),null,t.attrs)}static renderSpec(t,e,r=null,i){return F0(t,e,r,i)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new yu(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=tP(t.nodes);return e.text||(e.text=r=>r.text),e}static marksFromSchema(t){return tP(t.marks)}}function tP(n){let t={};for(let e in n){let r=n[e].spec.toDOM;r&&(t[e]=r)}return t}function ww(n){return n.document||window.document}const eP=new WeakMap;function Mrt(n){let t=eP.get(n);return t===void 0&&eP.set(n,t=Drt(n)),t}function Drt(n){let t=null;function e(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")t||(t=[]),t.push(r);else for(let i=0;i<r.length;i++)e(r[i]);else for(let i in r)e(r[i])}return e(n),t}function F0(n,t,e,r){if(typeof t=="string")return{dom:n.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(s=Mrt(r))&&s.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(e=i.slice(0,o),i=i.slice(o+1));let l,u=e?n.createElementNS(e,i):n.createElement(i),h=t[1],d=1;if(h&&typeof h=="object"&&h.nodeType==null&&!Array.isArray(h)){d=2;for(let p in h)if(h[p]!=null){let g=p.indexOf(" ");g>0?u.setAttributeNS(p.slice(0,g),p.slice(g+1),h[p]):p=="style"&&u.style?u.style.cssText=h[p]:u.setAttribute(p,h[p])}}for(let p=d;p<t.length;p++){let g=t[p];if(g===0){if(p<t.length-1||p>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:u,contentDOM:u}}else{let{dom:v,contentDOM:T}=F0(n,g,e,r);if(u.appendChild(v),T){if(l)throw new RangeError("Multiple content holes");l=T}}}return{dom:u,contentDOM:l}}const HB=65535,$B=Math.pow(2,16);function Ort(n,t){return n+t*$B}function nP(n){return n&HB}function Rrt(n){return(n-(n&HB))/$B}const qB=1,WB=2,B0=4,GB=8;class gE{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(this.delInfo&GB)>0}get deletedBefore(){return(this.delInfo&(qB|B0))>0}get deletedAfter(){return(this.delInfo&(WB|B0))>0}get deletedAcross(){return(this.delInfo&B0)>0}}class Zr{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&Zr.empty)return Zr.empty}recover(t){let e=0,r=nP(t);if(!this.inverted)for(let i=0;i<r;i++)e+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+e+Rrt(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let u=this.ranges[l]-(this.inverted?i:0);if(u>t)break;let h=this.ranges[l+s],d=this.ranges[l+o],p=u+h;if(t<=p){let g=h?t==u?-1:t==p?1:e:e,v=u+i+(g<0?0:d);if(r)return v;let T=t==(e<0?u:p)?null:Ort(l/3,t-u),S=t==u?WB:t==p?qB:B0;return(e<0?t!=u:t!=p)&&(S|=GB),new gE(v,S,T)}i+=d-h}return r?t+i:new gE(t+i,0,null)}touches(t,e){let r=0,i=nP(e),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let u=this.ranges[l]-(this.inverted?r:0);if(u>t)break;let h=this.ranges[l+s],d=u+h;if(t<=d&&l==i*3)return!0;r+=this.ranges[l+o]-h}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],l=o-(this.inverted?s:0),u=o+(this.inverted?0:s),h=this.ranges[i+e],d=this.ranges[i+r];t(l,l+h,u,u+d),s+=d-h}}invert(){return new Zr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?Zr.empty:new Zr(t<0?[0,-t,0]:[0,0,t])}}Zr.empty=new Zr([]);class tm{constructor(t,e,r=0,i=t?t.length:0){this.mirror=e,this.from=r,this.to=i,this._maps=t||[],this.ownData=!(t||e)}get maps(){return this._maps}slice(t=0,e=this.maps.length){return new tm(this._maps,this.mirror,t,e)}appendMap(t,e){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),e!=null&&this.setMirror(this._maps.length-1,e)}appendMapping(t){for(let e=0,r=this._maps.length;e<t._maps.length;e++){let i=t.getMirror(e);this.appendMap(t._maps[e],i!=null&&i<e?r+i:void 0)}}getMirror(t){if(this.mirror){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,r=this._maps.length+t._maps.length;e>=0;e--){let i=t.getMirror(e);this.appendMap(t._maps[e].invert(),i!=null&&i>e?r-i-1:void 0)}}invert(){let t=new tm;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let r=this.from;r<this.to;r++)t=this._maps[r].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this._maps[s],l=o.mapResult(t,e);if(l.recover!=null){let u=this.getMirror(s);if(u!=null&&u>s&&u<this.to){s=u,t=this._maps[u].recover(l.recover);continue}}i|=l.delInfo,t=l.pos}return r?t:new gE(t,i,null)}}const xw=Object.create(null);class cr{getMap(){return Zr.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=xw[e.stepType];if(!r)throw new RangeError(`No step type ${e.stepType} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in xw)throw new RangeError("Duplicate use of step JSON ID "+t);return xw[t]=e,e.prototype.jsonID=t,e}}class Tn{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new Tn(t,null)}static fail(t){return new Tn(null,t)}static fromReplace(t,e,r,i){try{return Tn.ok(t.replace(e,r,i))}catch(s){if(s instanceof Mv)return Tn.fail(s.message);throw s}}}function GC(n,t,e){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(GC(s.content,t,s))),s.isInline&&(s=t(s,e,i)),r.push(s)}return ut.fromArray(r)}class sl extends cr{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new vt(GC(e.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),e.openStart,e.openEnd);return Tn.fromReplace(t,this.from,this.to,s)}invert(){return new ns(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new sl(e.pos,r.pos,this.mark)}merge(t){return t instanceof sl&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new sl(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new sl(e.from,e.to,t.markFromJSON(e.mark))}}cr.jsonID("addMark",sl);class ns extends cr{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new vt(GC(e.content,i=>i.mark(this.mark.removeFromSet(i.marks)),t),e.openStart,e.openEnd);return Tn.fromReplace(t,this.from,this.to,r)}invert(){return new sl(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new ns(e.pos,r.pos,this.mark)}merge(t){return t instanceof ns&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new ns(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ns(e.from,e.to,t.markFromJSON(e.mark))}}cr.jsonID("removeMark",ns);class ol extends cr{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return Tn.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return Tn.fromReplace(t,this.pos,this.pos+1,new vt(ut.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let r=this.mark.addToSet(e.marks);if(r.length==e.marks.length){for(let i=0;i<e.marks.length;i++)if(!e.marks[i].isInSet(r))return new ol(this.pos,e.marks[i]);return new ol(this.pos,this.mark)}}return new lu(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new ol(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ol(e.pos,t.markFromJSON(e.mark))}}cr.jsonID("addNodeMark",ol);class lu extends cr{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return Tn.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return Tn.fromReplace(t,this.pos,this.pos+1,new vt(ut.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return!e||!this.mark.isInSet(e.marks)?this:new ol(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new lu(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new lu(e.pos,t.markFromJSON(e.mark))}}cr.jsonID("removeNodeMark",lu);class Ln extends cr{constructor(t,e,r,i=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=i}apply(t){return this.structure&&yE(t,this.from,this.to)?Tn.fail("Structure replace would overwrite content"):Tn.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Zr([this.from,this.to-this.from,this.slice.size])}invert(t){return new Ln(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new Ln(e.pos,Math.max(e.pos,r.pos),this.slice,this.structure)}merge(t){if(!(t instanceof Ln)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let e=this.slice.size+t.slice.size==0?vt.empty:new vt(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Ln(this.from,this.to+(t.to-t.from),e,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let e=this.slice.size+t.slice.size==0?vt.empty:new vt(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Ln(t.from,this.to,e,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ln(e.from,e.to,vt.fromJSON(t,e.slice),!!e.structure)}}cr.jsonID("replace",Ln);class Vn extends cr{constructor(t,e,r,i,s,o,l=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=l}apply(t){if(this.structure&&(yE(t,this.from,this.gapFrom)||yE(t,this.gapTo,this.to)))return Tn.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return Tn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?Tn.fromReplace(t,this.from,this.to,r):Tn.fail("Content does not fit in gap")}getMap(){return new Zr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new Vn(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),i=this.from==this.gapFrom?e.pos:t.map(this.gapFrom,-1),s=this.to==this.gapTo?r.pos:t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||i<e.pos||s>r.pos?null:new Vn(e.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Vn(e.from,e.to,e.gapFrom,e.gapTo,vt.fromJSON(t,e.slice),e.insert,!!e.structure)}}cr.jsonID("replaceAround",Vn);function yE(n,t,e){let r=n.resolve(t),i=e-t,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function Irt(n,t,e,r){let i=[],s=[],o,l;n.doc.nodesBetween(t,e,(u,h,d)=>{if(!u.isInline)return;let p=u.marks;if(!r.isInSet(p)&&d.type.allowsMarkType(r.type)){let g=Math.max(h,t),v=Math.min(h+u.nodeSize,e),T=r.addToSet(p);for(let S=0;S<p.length;S++)p[S].isInSet(T)||(o&&o.to==g&&o.mark.eq(p[S])?o.to=v:i.push(o=new ns(g,v,p[S])));l&&l.to==g?l.to=v:s.push(l=new sl(g,v,r))}}),i.forEach(u=>n.step(u)),s.forEach(u=>n.step(u))}function Prt(n,t,e,r){let i=[],s=0;n.doc.nodesBetween(t,e,(o,l)=>{if(!o.isInline)return;s++;let u=null;if(r instanceof a_){let h=o.marks,d;for(;d=r.isInSet(h);)(u||(u=[])).push(d),h=d.removeFromSet(h)}else r?r.isInSet(o.marks)&&(u=[r]):u=o.marks;if(u&&u.length){let h=Math.min(l+o.nodeSize,e);for(let d=0;d<u.length;d++){let p=u[d],g;for(let v=0;v<i.length;v++){let T=i[v];T.step==s-1&&p.eq(i[v].style)&&(g=T)}g?(g.to=h,g.step=s):i.push({style:p,from:Math.max(l,t),to:h,step:s})}}}),i.forEach(o=>n.step(new ns(o.from,o.to,o.style)))}function YC(n,t,e,r=e.contentMatch,i=!0){let s=n.doc.nodeAt(t),o=[],l=t+1;for(let u=0;u<s.childCount;u++){let h=s.child(u),d=l+h.nodeSize,p=r.matchType(h.type);if(!p)o.push(new Ln(l,d,vt.empty));else{r=p;for(let g=0;g<h.marks.length;g++)e.allowsMarkType(h.marks[g].type)||n.step(new ns(l,d,h.marks[g]));if(i&&h.isText&&e.whitespace!="pre"){let g,v=/\r?\n|\r/g,T;for(;g=v.exec(h.text);)T||(T=new vt(ut.from(e.schema.text(" ",e.allowedMarks(h.marks))),0,0)),o.push(new Ln(l+g.index,l+g.index+g[0].length,T))}}l=d}if(!r.validEnd){let u=r.fillBefore(ut.empty,!0);n.replace(l,l,new vt(u,0,0))}for(let u=o.length-1;u>=0;u--)n.step(o[u])}function Nrt(n,t,e){return(t==0||n.canReplace(t,n.childCount))&&(e==n.childCount||n.canReplace(0,e))}function _f(n){let e=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth,i=0,s=0;;--r){let o=n.$from.node(r),l=n.$from.index(r)+i,u=n.$to.indexAfter(r)-s;if(r<n.depth&&o.canReplace(l,u,e))return r;if(r==0||o.type.spec.isolating||!Nrt(o,l,u))break;l&&(i=1),u<o.childCount&&(s=1)}return null}function Lrt(n,t,e){let{$from:r,$to:i,depth:s}=t,o=r.before(s+1),l=i.after(s+1),u=o,h=l,d=ut.empty,p=0;for(let T=s,S=!1;T>e;T--)S||r.index(T)>0?(S=!0,d=ut.from(r.node(T).copy(d)),p++):u--;let g=ut.empty,v=0;for(let T=s,S=!1;T>e;T--)S||i.after(T+1)<i.end(T)?(S=!0,g=ut.from(i.node(T).copy(g)),v++):h++;n.step(new Vn(u,h,o,l,new vt(d.append(g),p,v),d.size-p,!0))}function KC(n,t,e=null,r=n){let i=Vrt(n,t),s=i&&jrt(r,t);return s?i.map(rP).concat({type:t,attrs:e}).concat(s.map(rP)):null}function rP(n){return{type:n,attrs:null}}function Vrt(n,t){let{parent:e,startIndex:r,endIndex:i}=n,s=e.contentMatchAt(r).findWrapping(t);if(!s)return null;let o=s.length?s[0]:t;return e.canReplaceWith(r,i,o)?s:null}function jrt(n,t){let{parent:e,startIndex:r,endIndex:i}=n,s=e.child(r),o=t.contentMatch.findWrapping(s.type);if(!o)return null;let u=(o.length?o[o.length-1]:t).contentMatch;for(let h=r;u&&h<i;h++)u=u.matchType(e.child(h).type);return!u||!u.validEnd?null:o}function Frt(n,t,e){let r=ut.empty;for(let o=e.length-1;o>=0;o--){if(r.size){let l=e[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=ut.from(e[o].type.create(e[o].attrs,r))}let i=t.start,s=t.end;n.step(new Vn(i,s,i,s,new vt(r,0,0),e.length,!0))}function Brt(n,t,e,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(t,e,(o,l)=>{let u=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(r,u)&&Urt(n.doc,n.mapping.slice(s).map(l),r)){let h=null;if(r.schema.linebreakReplacement){let v=r.whitespace=="pre",T=!!r.contentMatch.matchType(r.schema.linebreakReplacement);v&&!T?h=!1:!v&&T&&(h=!0)}h===!1&&KB(n,o,l,s),YC(n,n.mapping.slice(s).map(l,1),r,void 0,h===null);let d=n.mapping.slice(s),p=d.map(l,1),g=d.map(l+o.nodeSize,1);return n.step(new Vn(p,g,p+1,g-1,new vt(ut.from(r.create(u,null,o.marks)),0,0),1,!0)),h===!0&&YB(n,o,l,s),!1}})}function YB(n,t,e,r){t.forEach((i,s)=>{if(i.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(i.text);){let u=n.mapping.slice(r).map(e+1+s+o.index);n.replaceWith(u,u+1,t.type.schema.linebreakReplacement.create())}}})}function KB(n,t,e,r){t.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(e+1+s);n.replaceWith(o,o+1,t.type.schema.text(`
`))}})}function Urt(n,t,e){let r=n.resolve(t),i=r.index();return r.parent.canReplaceWith(i,i+1,e)}function zrt(n,t,e,r,i){let s=n.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");e||(e=s.type);let o=e.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(t,t+s.nodeSize,o);if(!e.validContent(s.content))throw new RangeError("Invalid content for node type "+e.name);n.step(new Vn(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new vt(ut.from(o),0,0),1,!0))}function $o(n,t,e=1,r){let i=n.resolve(t),s=i.depth-e,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let h=i.depth-1,d=e-2;h>s;h--,d--){let p=i.node(h),g=i.index(h);if(p.type.spec.isolating)return!1;let v=p.content.cutByIndex(g,p.childCount),T=r&&r[d+1];T&&(v=v.replaceChild(0,T.type.create(T.attrs)));let S=r&&r[d]||p;if(!p.canReplace(g+1,p.childCount)||!S.type.validContent(v))return!1}let l=i.indexAfter(s),u=r&&r[0];return i.node(s).canReplaceWith(l,l,u?u.type:i.node(s+1).type)}function Hrt(n,t,e=1,r){let i=n.doc.resolve(t),s=ut.empty,o=ut.empty;for(let l=i.depth,u=i.depth-e,h=e-1;l>u;l--,h--){s=ut.from(i.node(l).copy(s));let d=r&&r[h];o=ut.from(d?d.type.create(d.attrs,o):i.node(l).copy(o))}n.step(new Ln(t,t,new vt(s.append(o),e,e),!0))}function Bl(n,t){let e=n.resolve(t),r=e.index();return XB(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(r,r+1)}function $rt(n,t){t.content.size||n.type.compatibleContent(t.type);let e=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<t.childCount;i++){let s=t.child(i),o=s.type==r?n.type.schema.nodes.text:s.type;if(e=e.matchType(o),!e||!n.type.allowsMarks(s.marks))return!1}return e.validEnd}function XB(n,t){return!!(n&&t&&!n.isLeaf&&$rt(n,t))}function l_(n,t,e=-1){let r=n.resolve(t);for(let i=r.depth;;i--){let s,o,l=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):e>0?(s=r.node(i+1),l++,o=r.node(i).maybeChild(l)):(s=r.node(i).maybeChild(l-1),o=r.node(i+1)),s&&!s.isTextblock&&XB(s,o)&&r.node(i).canReplace(l,l+1))return t;if(i==0)break;t=e<0?r.before(i):r.after(i)}}function qrt(n,t,e){let r=null,{linebreakReplacement:i}=n.doc.type.schema,s=n.doc.resolve(t-e),o=s.node().type;if(i&&o.inlineContent){let d=o.whitespace=="pre",p=!!o.contentMatch.matchType(i);d&&!p?r=!1:!d&&p&&(r=!0)}let l=n.steps.length;if(r===!1){let d=n.doc.resolve(t+e);KB(n,d.node(),d.before(),l)}o.inlineContent&&YC(n,t+e-1,o,s.node().contentMatchAt(s.index()),r==null);let u=n.mapping.slice(l),h=u.map(t-e);if(n.step(new Ln(h,u.map(t+e,-1),vt.empty,!0)),r===!0){let d=n.doc.resolve(h);YB(n,d.node(),d.before(),n.steps.length)}return n}function Wrt(n,t,e){let r=n.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),e))return t;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,e))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,e))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function QB(n,t,e){let r=n.resolve(t);if(!e.content.size)return t;let i=e.content;for(let s=0;s<e.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(e.openStart==0&&e.size?2:1);s++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,u=r.index(o)+(l>0?1:0),h=r.node(o),d=!1;if(s==1)d=h.canReplace(u,u,i);else{let p=h.contentMatchAt(u).findWrapping(i.firstChild.type);d=p&&h.canReplaceWith(u,u,p[0])}if(d)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function c_(n,t,e=t,r=vt.empty){if(t==e&&!r.size)return null;let i=n.resolve(t),s=n.resolve(e);return JB(i,s,r)?new Ln(t,e,r):new Grt(i,s,r).fit()}function JB(n,t,e){return!e.openStart&&!e.openEnd&&n.start()==t.start()&&n.parent.canReplace(n.index(),t.index(),e.content)}class Grt{constructor(t,e,r){this.$from=t,this.$to=e,this.unplaced=r,this.frontier=[],this.placed=ut.empty;for(let i=0;i<=t.depth;i++){let s=t.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(t.indexAfter(i))})}for(let i=t.depth;i>0;i--)this.placed=ut.from(t.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let h=this.findFittable();h?this.placeNodes(h):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(t<0?this.$to:r.doc.resolve(t));if(!i)return null;let s=this.placed,o=r.depth,l=i.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let u=new vt(s,o,l);return t>-1?new Vn(r.pos,t,this.$to.pos,this.$to.end(),u,e):u.size||r.pos!=this.$to.pos?new Ln(r.pos,i.pos,u):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<t;r++){let s=e.firstChild;if(e.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){t=r;break}e=s.content}for(let e=1;e<=2;e++)for(let r=e==1?t:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=Ew(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:u,match:h}=this.frontier[l],d,p=null;if(e==1&&(o?h.matchType(o.type)||(p=h.fillBefore(ut.from(o),!1)):s&&u.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:l,parent:s,inject:p};if(e==2&&o&&(d=h.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:s,wrap:d};if(s&&h.matchType(s.type))break}}}openMore(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=Ew(t,e);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new vt(t,e+1,Math.max(r,i.size+e>=t.size-r?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=Ew(t,e);if(i.childCount<=1&&e>0){let s=t.size-e<=e+i.size;this.unplaced=new vt(ep(t,e-1,1),e-1,s?e-1:r)}else this.unplaced=new vt(ep(t,e,1),e,r)}placeNodes({sliceDepth:t,frontierDepth:e,parent:r,inject:i,wrap:s}){for(;this.depth>e;)this.closeFrontierNode();if(s)for(let S=0;S<s.length;S++)this.openFrontierNode(s[S]);let o=this.unplaced,l=r?r.content:o.content,u=o.openStart-t,h=0,d=[],{match:p,type:g}=this.frontier[e];if(i){for(let S=0;S<i.childCount;S++)d.push(i.child(S));p=p.matchFragment(i)}let v=l.size+t-(o.content.size-o.openEnd);for(;h<l.childCount;){let S=l.child(h),w=p.matchType(S.type);if(!w)break;h++,(h>1||u==0||S.content.size)&&(p=w,d.push(ZB(S.mark(g.allowedMarks(S.marks)),h==1?u:0,h==l.childCount?v:-1)))}let T=h==l.childCount;T||(v=-1),this.placed=np(this.placed,e,ut.from(d)),this.frontier[e].match=p,T&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let S=0,w=l;S<v;S++){let E=w.lastChild;this.frontier.push({type:E.type,match:E.contentMatchAt(E.childCount)}),w=E.content}this.unplaced=T?t==0?vt.empty:new vt(ep(o.content,t-1,1),t-1,v<0?o.openEnd:t-1):new vt(ep(o.content,t,h),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],e;if(!t.type.isTextblock||!Cw(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:r,type:i}=this.frontier[e],s=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),o=Cw(t,e,i,r,s);if(o){for(let l=e-1;l>=0;l--){let{match:u,type:h}=this.frontier[l],d=Cw(t,l,h,u,!0);if(!d||d.childCount)continue t}return{depth:e,fit:o,move:s?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=np(this.placed,e.depth,e.fit)),t=e.move;for(let r=e.depth+1;r<=t.depth;r++){let i=t.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,t.index(r));this.openFrontierNode(i.type,i.attrs,s)}return t}openFrontierNode(t,e=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=np(this.placed,this.depth,ut.from(t.create(e,r))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(ut.empty,!0);e.childCount&&(this.placed=np(this.placed,this.frontier.length,e))}}function ep(n,t,e){return t==0?n.cutByIndex(e,n.childCount):n.replaceChild(0,n.firstChild.copy(ep(n.firstChild.content,t-1,e)))}function np(n,t,e){return t==0?n.append(e):n.replaceChild(n.childCount-1,n.lastChild.copy(np(n.lastChild.content,t-1,e)))}function Ew(n,t){for(let e=0;e<t;e++)n=n.firstChild.content;return n}function ZB(n,t,e){if(t<=0)return n;let r=n.content;return t>1&&(r=r.replaceChild(0,ZB(r.firstChild,t-1,r.childCount==1?e-1:0))),t>0&&(r=n.type.contentMatch.fillBefore(r).append(r),e<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(ut.empty,!0)))),n.copy(r)}function Cw(n,t,e,r,i){let s=n.node(t),o=i?n.indexAfter(t):n.index(t);if(o==s.childCount&&!e.compatibleContent(s.type))return null;let l=r.fillBefore(s.content,!0,o);return l&&!Yrt(e,s.content,o)?l:null}function Yrt(n,t,e){for(let r=e;r<t.childCount;r++)if(!n.allowsMarks(t.child(r).marks))return!0;return!1}function Krt(n){return n.spec.defining||n.spec.definingForContent}function Xrt(n,t,e,r){if(!r.size)return n.deleteRange(t,e);let i=n.doc.resolve(t),s=n.doc.resolve(e);if(JB(i,s,r))return n.step(new Ln(t,e,r));let o=e4(i,s);o[o.length-1]==0&&o.pop();let l=-(i.depth+1);o.unshift(l);for(let g=i.depth,v=i.pos-1;g>0;g--,v--){let T=i.node(g).type.spec;if(T.defining||T.definingAsContext||T.isolating)break;o.indexOf(g)>-1?l=g:i.before(g)==v&&o.splice(1,0,-g)}let u=o.indexOf(l),h=[],d=r.openStart;for(let g=r.content,v=0;;v++){let T=g.firstChild;if(h.push(T),v==r.openStart)break;g=T.content}for(let g=d-1;g>=0;g--){let v=h[g],T=Krt(v.type);if(T&&!v.sameMarkup(i.node(Math.abs(l)-1)))d=g;else if(T||!v.type.isTextblock)break}for(let g=r.openStart;g>=0;g--){let v=(g+d+1)%(r.openStart+1),T=h[v];if(T)for(let S=0;S<o.length;S++){let w=o[(S+u)%o.length],E=!0;w<0&&(E=!1,w=-w);let D=i.node(w-1),P=i.index(w-1);if(D.canReplaceWith(P,P,T.type,T.marks))return n.replace(i.before(w),E?s.after(w):e,new vt(t4(r.content,0,r.openStart,v),v,r.openEnd))}}let p=n.steps.length;for(let g=o.length-1;g>=0&&(n.replace(t,e,r),!(n.steps.length>p));g--){let v=o[g];v<0||(t=i.before(v),e=s.after(v))}}function t4(n,t,e,r,i){if(t<e){let s=n.firstChild;n=n.replaceChild(0,s.copy(t4(s.content,t+1,e,r,s)))}if(t>r){let s=i.contentMatchAt(0),o=s.fillBefore(n).append(n);n=o.append(s.matchFragment(o).fillBefore(ut.empty,!0))}return n}function Qrt(n,t,e,r){if(!r.isInline&&t==e&&n.doc.resolve(t).parent.content.size){let i=Wrt(n.doc,t,r.type);i!=null&&(t=e=i)}n.replaceRange(t,e,new vt(ut.from(r),0,0))}function Jrt(n,t,e){let r=n.doc.resolve(t),i=n.doc.resolve(e),s=e4(r,i);for(let o=0;o<s.length;o++){let l=s[o],u=o==s.length-1;if(u&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),i.end(l));if(l>0&&(u||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return n.delete(r.before(l),i.after(l))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(t-r.start(o)==r.depth-o&&e>r.end(o)&&i.end(o)-e!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return n.delete(r.before(o),e);n.delete(t,e)}function e4(n,t){let e=[],r=Math.min(n.depth,t.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||t.end(i)>t.pos+(t.depth-i)||n.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(s==t.start(i)||i==n.depth&&i==t.depth&&n.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==s-1)&&e.push(i)}return e}class Fh extends cr{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return Tn.fail("No node at attribute step's position");let r=Object.create(null);for(let s in e.attrs)r[s]=e.attrs[s];r[this.attr]=this.value;let i=e.type.create(r,null,e.marks);return Tn.fromReplace(t,this.pos,this.pos+1,new vt(ut.from(i),0,e.isLeaf?0:1))}getMap(){return Zr.empty}invert(t){return new Fh(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Fh(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.pos!="number"||typeof e.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Fh(e.pos,e.attr,e.value)}}cr.jsonID("attr",Fh);class em extends cr{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let i in t.attrs)e[i]=t.attrs[i];e[this.attr]=this.value;let r=t.type.create(e,t.content,t.marks);return Tn.ok(r)}getMap(){return Zr.empty}invert(t){return new em(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new em(e.attr,e.value)}}cr.jsonID("docAttr",em);let Qh=class extends Error{};Qh=function n(t){let e=Error.call(this,t);return e.__proto__=n.prototype,e};Qh.prototype=Object.create(Error.prototype);Qh.prototype.constructor=Qh;Qh.prototype.name="TransformError";class n4{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new tm}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new Qh(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}changedRange(){let t=1e9,e=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let i=this.mapping.maps[r];r&&(t=i.map(t,1),e=i.map(e,-1)),i.forEach((s,o,l,u)=>{t=Math.min(t,l),e=Math.max(e,u)})}return t==1e9?null:{from:t,to:e}}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,r=vt.empty){let i=c_(this.doc,t,e,r);return i&&this.step(i),this}replaceWith(t,e,r){return this.replace(t,e,new vt(ut.from(r),0,0))}delete(t,e){return this.replace(t,e,vt.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,r){return Xrt(this,t,e,r),this}replaceRangeWith(t,e,r){return Qrt(this,t,e,r),this}deleteRange(t,e){return Jrt(this,t,e),this}lift(t,e){return Lrt(this,t,e),this}join(t,e=1){return qrt(this,t,e),this}wrap(t,e){return Frt(this,t,e),this}setBlockType(t,e=t,r,i=null){return Brt(this,t,e,r,i),this}setNodeMarkup(t,e,r=null,i){return zrt(this,t,e,r,i),this}setNodeAttribute(t,e,r){return this.step(new Fh(t,e,r)),this}setDocAttribute(t,e){return this.step(new em(t,e)),this}addNodeMark(t,e){return this.step(new ol(t,e)),this}removeNodeMark(t,e){let r=this.doc.nodeAt(t);if(!r)throw new RangeError("No node at position "+t);if(e instanceof Ae)e.isInSet(r.marks)&&this.step(new lu(t,e));else{let i=r.marks,s,o=[];for(;s=e.isInSet(i);)o.push(new lu(t,s)),i=s.removeFromSet(i);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(t,e=1,r){return Hrt(this,t,e,r),this}addMark(t,e,r){return Irt(this,t,e,r),this}removeMark(t,e,r){return Prt(this,t,e,r),this}clearIncompatible(t,e,r){return YC(this,t,e,r),this}}const Aw=Object.create(null);class Wt{constructor(t,e,r){this.$anchor=t,this.$head=e,this.ranges=r||[new Zrt(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=vt.empty){let r=e.content.lastChild,i=null;for(let l=0;l<e.openEnd;l++)i=r,r=r.lastChild;let s=t.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:u,$to:h}=o[l],d=t.mapping.slice(s);t.replaceRange(d.map(u.pos),d.map(h.pos),l?vt.empty:e),l==0&&oP(t,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(t,e){let r=t.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:l}=i[s],u=t.mapping.slice(r),h=u.map(o.pos),d=u.map(l.pos);s?t.deleteRange(h,d):(t.replaceRangeWith(h,d,e),oP(t,r,e.isInline?-1:1))}}static findFrom(t,e,r=!1){let i=t.parent.inlineContent?new jt(t):yh(t.node(0),t.parent,t.pos,t.index(),e,r);if(i)return i;for(let s=t.depth-1;s>=0;s--){let o=e<0?yh(t.node(0),t.node(s),t.before(s+1),t.index(s),e,r):yh(t.node(0),t.node(s),t.after(s+1),t.index(s)+1,e,r);if(o)return o}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new ii(t.node(0))}static atStart(t){return yh(t,t,0,0,1)||new ii(t)}static atEnd(t){return yh(t,t,t.content.size,t.childCount,-1)||new ii(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Aw[e.type];if(!r)throw new RangeError(`No selection type ${e.type} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in Aw)throw new RangeError("Duplicate use of selection JSON ID "+t);return Aw[t]=e,e.prototype.jsonID=t,e}getBookmark(){return jt.between(this.$anchor,this.$head).getBookmark()}}Wt.prototype.visible=!0;class Zrt{constructor(t,e){this.$from=t,this.$to=e}}let iP=!1;function sP(n){!iP&&!n.parent.inlineContent&&(iP=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class jt extends Wt{constructor(t,e=t){sP(t),sP(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let r=t.resolve(e.map(this.head));if(!r.parent.inlineContent)return Wt.near(r);let i=t.resolve(e.map(this.anchor));return new jt(i.parent.inlineContent?i:r,r)}replace(t,e=vt.empty){if(super.replace(t,e),e==vt.empty){let r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}}eq(t){return t instanceof jt&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new u_(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if(typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new jt(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,r=e){let i=t.resolve(e);return new this(i,r==e?i:t.resolve(r))}static between(t,e,r){let i=t.pos-e.pos;if((!r||i)&&(r=i>=0?1:-1),!e.parent.inlineContent){let s=Wt.findFrom(e,r,!0)||Wt.findFrom(e,-r,!0);if(s)e=s.$head;else return Wt.near(e,r)}return t.parent.inlineContent||(i==0?t=e:(t=(Wt.findFrom(t,-r,!0)||Wt.findFrom(t,r,!0)).$anchor,t.pos<e.pos!=i<0&&(t=e))),new jt(t,e)}}Wt.jsonID("text",jt);class u_{constructor(t,e){this.anchor=t,this.head=e}map(t){return new u_(t.map(this.anchor),t.map(this.head))}resolve(t){return jt.between(t.resolve(this.anchor),t.resolve(this.head))}}class Dt extends Wt{constructor(t){let e=t.nodeAfter,r=t.node(0).resolve(t.pos+e.nodeSize);super(t,r),this.node=e}map(t,e){let{deleted:r,pos:i}=e.mapResult(this.anchor),s=t.resolve(i);return r?Wt.near(s):new Dt(s)}content(){return new vt(ut.from(this.node),0,0)}eq(t){return t instanceof Dt&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new XC(this.anchor)}static fromJSON(t,e){if(typeof e.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Dt(t.resolve(e.anchor))}static create(t,e){return new Dt(t.resolve(e))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}Dt.prototype.visible=!1;Wt.jsonID("node",Dt);class XC{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:r}=t.mapResult(this.anchor);return e?new u_(r,r):new XC(r)}resolve(t){let e=t.resolve(this.anchor),r=e.nodeAfter;return r&&Dt.isSelectable(r)?new Dt(e):Wt.near(e)}}class ii extends Wt{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=vt.empty){if(e==vt.empty){t.delete(0,t.doc.content.size);let r=Wt.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new ii(t)}map(t){return new ii(t)}eq(t){return t instanceof ii}getBookmark(){return tit}}Wt.jsonID("all",ii);const tit={map(){return this},resolve(n){return new ii(n)}};function yh(n,t,e,r,i,s=!1){if(t.inlineContent)return jt.create(n,e);for(let o=r-(i>0?0:1);i>0?o<t.childCount:o>=0;o+=i){let l=t.child(o);if(l.isAtom){if(!s&&Dt.isSelectable(l))return Dt.create(n,e-(i<0?l.nodeSize:0))}else{let u=yh(n,l,e+i,i<0?l.childCount:0,i,s);if(u)return u}e+=l.nodeSize*i}return null}function oP(n,t,e){let r=n.steps.length-1;if(r<t)return;let i=n.steps[r];if(!(i instanceof Ln||i instanceof Vn))return;let s=n.mapping.maps[r],o;s.forEach((l,u,h,d)=>{o==null&&(o=d)}),n.setSelection(Wt.near(n.doc.resolve(o),e))}const aP=1,Ly=2,lP=4;class eit extends n4{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|aP)&~Ly,this.storedMarks=null,this}get selectionSet(){return(this.updated&aP)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=Ly,this}ensureMarks(t){return Ae.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Ly)>0}addStep(t,e){super.addStep(t,e),this.updated=this.updated&~Ly,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let r=this.selection;return e&&(t=t.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Ae.none))),r.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,r){let i=this.doc.type.schema;if(e==null)return t?this.replaceSelectionWith(i.text(t),!0):this.deleteSelection();{if(r==null&&(r=e),!t)return this.deleteRange(e,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(e);s=r==e?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(e,r,i.text(t,s)),!this.selection.empty&&this.selection.to==e+t.length&&this.setSelection(Wt.near(this.selection.$to)),this}}setMeta(t,e){return this.meta[typeof t=="string"?t:t.key]=e,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=lP,this}get scrolledIntoView(){return(this.updated&lP)>0}}function cP(n,t){return!t||!n?n:n.bind(t)}class rp{constructor(t,e,r){this.name=t,this.init=cP(e.init,r),this.apply=cP(e.apply,r)}}const nit=[new rp("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new rp("selection",{init(n,t){return n.selection||Wt.atStart(t.doc)},apply(n){return n.selection}}),new rp("storedMarks",{init(n){return n.storedMarks||null},apply(n,t,e,r){return r.selection.$cursor?n.storedMarks:null}}),new rp("scrollToSelection",{init(){return 0},apply(n,t){return n.scrolledIntoView?t+1:t}})];class kw{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=nit.slice(),e&&e.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new rp(r.key,r.spec.state,r))})}}class Ah{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=e){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],r=this.applyInner(t),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let u=i?i[o].n:0,h=i?i[o].state:this,d=u<e.length&&l.spec.appendTransaction.call(l,u?e.slice(u):e,h,r);if(d&&r.filterTransaction(d,o)){if(d.setMeta("appendedTransaction",t),!i){i=[];for(let p=0;p<this.config.plugins.length;p++)i.push(p<o?{state:r,n:e.length}:{state:this,n:0})}e.push(d),r=r.applyInner(d),s=!0}i&&(i[o]={state:r,n:e.length})}}if(!s)return{state:r,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new Ah(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];e[s.name]=s.apply(t,this[s.name],this,e)}return e}get tr(){return new eit(this)}static create(t){let e=new kw(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new Ah(e);for(let i=0;i<e.fields.length;i++)r[e.fields[i].name]=e.fields[i].init(t,r);return r}reconfigure(t){let e=new kw(this.schema,t.plugins),r=e.fields,i=new Ah(e);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(t,i)}return i}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(r=>r.toJSON())),t&&typeof t=="object")for(let r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=t[r],s=i.spec.state;s&&s.toJSON&&(e[r]=s.toJSON.call(i,this[i.key]))}return e}static fromJSON(t,e,r){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let i=new kw(t.schema,t.plugins),s=new Ah(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=cs.fromJSON(t.schema,e.doc);else if(o.name=="selection")s.selection=Wt.fromJSON(s.doc,e.selection);else if(o.name=="storedMarks")e.storedMarks&&(s.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(r)for(let l in r){let u=r[l],h=u.spec.state;if(u.key==o.name&&h&&h.fromJSON&&Object.prototype.hasOwnProperty.call(e,l)){s[o.name]=h.fromJSON.call(u,t,e[l],s);return}}s[o.name]=o.init(t,s)}}),s}}function r4(n,t,e){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(t):r=="handleDOMEvents"&&(i=r4(i,t,{})),e[r]=i}return e}class $e{constructor(t){this.spec=t,this.props={},t.props&&r4(t.props,this,this.props),this.key=t.key?t.key.key:i4("plugin")}getState(t){return t[this.key]}}const Mw=Object.create(null);function i4(n){return n in Mw?n+"$"+ ++Mw[n]:(Mw[n]=0,n+"$")}class Mn{constructor(t="key"){this.key=i4(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const QC=(n,t)=>n.selection.empty?!1:(t&&t(n.tr.deleteSelection().scrollIntoView()),!0);function s4(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("backward",n):e.parentOffset>0)?null:e}const o4=(n,t,e)=>{let r=s4(n,e);if(!r)return!1;let i=JC(r);if(!i){let o=r.blockRange(),l=o&&_f(o);return l==null?!1:(t&&t(n.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(m4(n,i,t,-1))return!0;if(r.parent.content.size==0&&(Jh(s,"end")||Dt.isSelectable(s)))for(let o=r.depth;;o--){let l=c_(n.doc,r.before(o),r.after(o),vt.empty);if(l&&l.slice.size<l.to-l.from){if(t){let u=n.tr.step(l);u.setSelection(Jh(s,"end")?Wt.findFrom(u.doc.resolve(u.mapping.map(i.pos,-1)),-1):Dt.create(u.doc,i.pos-s.nodeSize)),t(u.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return s.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},rit=(n,t,e)=>{let r=s4(n,e);if(!r)return!1;let i=JC(r);return i?a4(n,i,t):!1},iit=(n,t,e)=>{let r=c4(n,e);if(!r)return!1;let i=ZC(r);return i?a4(n,i,t):!1};function a4(n,t,e){let r=t.nodeBefore,i=r,s=t.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let d=i.lastChild;if(!d)return!1;i=d}let o=t.nodeAfter,l=o,u=t.pos+1;for(;!l.isTextblock;u++){if(l.type.spec.isolating)return!1;let d=l.firstChild;if(!d)return!1;l=d}let h=c_(n.doc,s,u,vt.empty);if(!h||h.from!=s||h instanceof Ln&&h.slice.size>=u-s)return!1;if(e){let d=n.tr.step(h);d.setSelection(jt.create(d.doc,s)),e(d.scrollIntoView())}return!0}function Jh(n,t,e=!1){for(let r=n;r;r=t=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(e&&r.childCount!=1)return!1}return!1}const l4=(n,t,e)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):r.parentOffset>0)return!1;s=JC(r)}let o=s&&s.nodeBefore;return!o||!Dt.isSelectable(o)?!1:(t&&t(n.tr.setSelection(Dt.create(n.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function JC(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}function c4(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("forward",n):e.parentOffset<e.parent.content.size)?null:e}const u4=(n,t,e)=>{let r=c4(n,e);if(!r)return!1;let i=ZC(r);if(!i)return!1;let s=i.nodeAfter;if(m4(n,i,t,1))return!0;if(r.parent.content.size==0&&(Jh(s,"start")||Dt.isSelectable(s))){let o=c_(n.doc,r.before(),r.after(),vt.empty);if(o&&o.slice.size<o.to-o.from){if(t){let l=n.tr.step(o);l.setSelection(Jh(s,"start")?Wt.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):Dt.create(l.doc,l.mapping.map(i.pos))),t(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},h4=(n,t,e)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;s=ZC(r)}let o=s&&s.nodeAfter;return!o||!Dt.isSelectable(o)?!1:(t&&t(n.tr.setSelection(Dt.create(n.doc,s.pos)).scrollIntoView()),!0)};function ZC(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const sit=(n,t)=>{let e=n.selection,r=e instanceof Dt,i;if(r){if(e.node.isTextblock||!Bl(n.doc,e.from))return!1;i=e.from}else if(i=l_(n.doc,e.from,-1),i==null)return!1;if(t){let s=n.tr.join(i);r&&s.setSelection(Dt.create(s.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),t(s.scrollIntoView())}return!0},oit=(n,t)=>{let e=n.selection,r;if(e instanceof Dt){if(e.node.isTextblock||!Bl(n.doc,e.to))return!1;r=e.to}else if(r=l_(n.doc,e.to,1),r==null)return!1;return t&&t(n.tr.join(r).scrollIntoView()),!0},ait=(n,t)=>{let{$from:e,$to:r}=n.selection,i=e.blockRange(r),s=i&&_f(i);return s==null?!1:(t&&t(n.tr.lift(i,s).scrollIntoView()),!0)},f4=(n,t)=>{let{$head:e,$anchor:r}=n.selection;return!e.parent.type.spec.code||!e.sameParent(r)?!1:(t&&t(n.tr.insertText(`
`).scrollIntoView()),!0)};function tA(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const lit=(n,t)=>{let{$head:e,$anchor:r}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(r))return!1;let i=e.node(-1),s=e.indexAfter(-1),o=tA(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(t){let l=e.after(),u=n.tr.replaceWith(l,l,o.createAndFill());u.setSelection(Wt.near(u.doc.resolve(l),1)),t(u.scrollIntoView())}return!0},d4=(n,t)=>{let e=n.selection,{$from:r,$to:i}=e;if(e instanceof ii||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=tA(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=n.tr.insert(o,s.createAndFill());l.setSelection(jt.create(l.doc,o+1)),t(l.scrollIntoView())}return!0},p4=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let s=e.before();if($o(n.doc,s))return t&&t(n.tr.split(s).scrollIntoView()),!0}let r=e.blockRange(),i=r&&_f(r);return i==null?!1:(t&&t(n.tr.lift(r,i).scrollIntoView()),!0)};function cit(n){return(t,e)=>{let{$from:r,$to:i}=t.selection;if(t.selection instanceof Dt&&t.selection.node.isBlock)return!r.parentOffset||!$o(t.doc,r.pos)?!1:(e&&e(t.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let s=[],o,l,u=!1,h=!1;for(let v=r.depth;;v--)if(r.node(v).isBlock){u=r.end(v)==r.pos+(r.depth-v),h=r.start(v)==r.pos-(r.depth-v),l=tA(r.node(v-1).contentMatchAt(r.indexAfter(v-1))),s.unshift(u&&l?{type:l}:null),o=v;break}else{if(v==1)return!1;s.unshift(null)}let d=t.tr;(t.selection instanceof jt||t.selection instanceof ii)&&d.deleteSelection();let p=d.mapping.map(r.pos),g=$o(d.doc,p,s.length,s);if(g||(s[0]=l?{type:l}:null,g=$o(d.doc,p,s.length,s)),!g)return!1;if(d.split(p,s.length,s),!u&&h&&r.node(o).type!=l){let v=d.mapping.map(r.before(o)),T=d.doc.resolve(v);l&&r.node(o-1).canReplaceWith(T.index(),T.index()+1,l)&&d.setNodeMarkup(d.mapping.map(r.before(o)),l)}return e&&e(d.scrollIntoView()),!0}}const uit=cit(),hit=(n,t)=>{let{$from:e,to:r}=n.selection,i,s=e.sharedDepth(r);return s==0?!1:(i=e.before(s),t&&t(n.tr.setSelection(Dt.create(n.doc,i))),!0)};function fit(n,t,e){let r=t.nodeBefore,i=t.nodeAfter,s=t.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&t.parent.canReplace(s-1,s)?(e&&e(n.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(s,s+1)||!(i.isTextblock||Bl(n.doc,t.pos))?!1:(e&&e(n.tr.join(t.pos).scrollIntoView()),!0)}function m4(n,t,e,r){let i=t.nodeBefore,s=t.nodeAfter,o,l,u=i.type.spec.isolating||s.type.spec.isolating;if(!u&&fit(n,t,e))return!0;let h=!u&&t.parent.canReplace(t.index(),t.index()+1);if(h&&(o=(l=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&l.matchType(o[0]||s.type).validEnd){if(e){let v=t.pos+s.nodeSize,T=ut.empty;for(let E=o.length-1;E>=0;E--)T=ut.from(o[E].create(null,T));T=ut.from(i.copy(T));let S=n.tr.step(new Vn(t.pos-1,v,t.pos,v,new vt(T,1,0),o.length,!0)),w=S.doc.resolve(v+2*o.length);w.nodeAfter&&w.nodeAfter.type==i.type&&Bl(S.doc,w.pos)&&S.join(w.pos),e(S.scrollIntoView())}return!0}let d=s.type.spec.isolating||r>0&&u?null:Wt.findFrom(t,1),p=d&&d.$from.blockRange(d.$to),g=p&&_f(p);if(g!=null&&g>=t.depth)return e&&e(n.tr.lift(p,g).scrollIntoView()),!0;if(h&&Jh(s,"start",!0)&&Jh(i,"end")){let v=i,T=[];for(;T.push(v),!v.isTextblock;)v=v.lastChild;let S=s,w=1;for(;!S.isTextblock;S=S.firstChild)w++;if(v.canReplace(v.childCount,v.childCount,S.content)){if(e){let E=ut.empty;for(let P=T.length-1;P>=0;P--)E=ut.from(T[P].copy(E));let D=n.tr.step(new Vn(t.pos-T.length,t.pos+s.nodeSize,t.pos+w,t.pos+s.nodeSize-w,new vt(E,T.length,0),0,!0));e(D.scrollIntoView())}return!0}}return!1}function g4(n){return function(t,e){let r=t.selection,i=n<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(e&&e(t.tr.setSelection(jt.create(t.doc,n<0?i.start(s):i.end(s)))),!0):!1}}const dit=g4(-1),pit=g4(1);function mit(n,t=null){return function(e,r){let{$from:i,$to:s}=e.selection,o=i.blockRange(s),l=o&&KC(o,n,t);return l?(r&&r(e.tr.wrap(o,l).scrollIntoView()),!0):!1}}function uP(n,t=null){return function(e,r){let i=!1;for(let s=0;s<e.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:l}}=e.selection.ranges[s];e.doc.nodesBetween(o,l,(u,h)=>{if(i)return!1;if(!(!u.isTextblock||u.hasMarkup(n,t)))if(u.type==n)i=!0;else{let d=e.doc.resolve(h),p=d.index();i=d.parent.canReplaceWith(p,p+1,n)}})}if(!i)return!1;if(r){let s=e.tr;for(let o=0;o<e.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:u}}=e.selection.ranges[o];s.setBlockType(l,u,n,t)}r(s.scrollIntoView())}return!0}}function eA(...n){return function(t,e,r){for(let i=0;i<n.length;i++)if(n[i](t,e,r))return!0;return!1}}eA(QC,o4,l4);eA(QC,u4,h4);eA(f4,d4,p4,uit);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function git(n,t=null){return function(e,r){let{$from:i,$to:s}=e.selection,o=i.blockRange(s);if(!o)return!1;let l=r?e.tr:null;return yit(l,o,n,t)?(r&&r(l.scrollIntoView()),!0):!1}}function yit(n,t,e,r=null){let i=!1,s=t,o=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(e)&&t.startIndex==0){if(t.$from.index(t.depth-1)==0)return!1;let u=o.resolve(t.start-2);s=new Ov(u,u,t.depth),t.endIndex<t.parent.childCount&&(t=new Ov(t.$from,o.resolve(t.$to.end(t.depth)),t.depth)),i=!0}let l=KC(s,e,r,t);return l?(n&&vit(n,t,l,i,e),!0):!1}function vit(n,t,e,r,i){let s=ut.empty;for(let d=e.length-1;d>=0;d--)s=ut.from(e[d].type.create(e[d].attrs,s));n.step(new Vn(t.start-(r?2:0),t.end,t.start,t.end,new vt(s,0,0),e.length,!0));let o=0;for(let d=0;d<e.length;d++)e[d].type==i&&(o=d+1);let l=e.length-o,u=t.start+e.length-(r?2:0),h=t.parent;for(let d=t.startIndex,p=t.endIndex,g=!0;d<p;d++,g=!1)!g&&$o(n.doc,u,l)&&(n.split(u,l),u+=2*l),u+=h.child(d).nodeSize;return n}function bit(n){return function(t,e){let{$from:r,$to:i}=t.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==n);return s?e?r.node(s.depth-1).type==n?_it(t,e,n,s):Tit(t,e,s):!0:!1}}function _it(n,t,e,r){let i=n.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new Vn(s-1,o,s,o,new vt(ut.from(e.create(null,r.parent.copy())),1,0),1,!0)),r=new Ov(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const l=_f(r);if(l==null)return!1;i.lift(r,l);let u=i.doc.resolve(i.mapping.map(s,-1)-1);return Bl(i.doc,u.pos)&&u.nodeBefore.type==u.nodeAfter.type&&i.join(u.pos),t(i.scrollIntoView()),!0}function Tit(n,t,e){let r=n.tr,i=e.parent;for(let v=e.end,T=e.endIndex-1,S=e.startIndex;T>S;T--)v-=i.child(T).nodeSize,r.delete(v-1,v+1);let s=r.doc.resolve(e.start),o=s.nodeAfter;if(r.mapping.map(e.end)!=e.start+s.nodeAfter.nodeSize)return!1;let l=e.startIndex==0,u=e.endIndex==i.childCount,h=s.node(-1),d=s.index(-1);if(!h.canReplace(d+(l?0:1),d+1,o.content.append(u?ut.empty:ut.from(i))))return!1;let p=s.pos,g=p+o.nodeSize;return r.step(new Vn(p-(l?1:0),g+(u?1:0),p+1,g-1,new vt((l?ut.empty:ut.from(i.copy(ut.empty))).append(u?ut.empty:ut.from(i.copy(ut.empty))),l?0:1,u?0:1),l?0:1)),t(r.scrollIntoView()),!0}function Sit(n){return function(t,e){let{$from:r,$to:i}=t.selection,s=r.blockRange(i,h=>h.childCount>0&&h.firstChild.type==n);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,u=l.child(o-1);if(u.type!=n)return!1;if(e){let h=u.lastChild&&u.lastChild.type==l.type,d=ut.from(h?n.create():null),p=new vt(ut.from(n.create(null,ut.from(l.type.create(null,d)))),h?3:1,0),g=s.start,v=s.end;e(t.tr.step(new Vn(g-(h?3:1),v,g,v,p,1,!0)).scrollIntoView())}return!0}}const Kn=function(n){for(var t=0;;t++)if(n=n.previousSibling,!n)return t},Zh=function(n){let t=n.assignedSlot||n.parentNode;return t&&t.nodeType==11?t.host:t};let vE=null;const Oo=function(n,t,e){let r=vE||(vE=document.createRange());return r.setEnd(n,e??n.nodeValue.length),r.setStart(n,t||0),r},wit=function(){vE=null},cu=function(n,t,e,r){return e&&(hP(n,t,e,r,-1)||hP(n,t,e,r,1))},xit=/^(img|br|input|textarea|hr)$/i;function hP(n,t,e,r,i){for(var s;;){if(n==e&&t==r)return!0;if(t==(i<0?0:Ci(n))){let o=n.parentNode;if(!o||o.nodeType!=1||jm(n)||xit.test(n.nodeName)||n.contentEditable=="false")return!1;t=Kn(n)+(i<0?0:1),n=o}else if(n.nodeType==1){let o=n.childNodes[t+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((s=o.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)t+=i;else return!1;else n=o,t=i<0?Ci(n):0}else return!1}}function Ci(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Eit(n,t){for(;;){if(n.nodeType==3&&t)return n;if(n.nodeType==1&&t>0){if(n.contentEditable=="false")return null;n=n.childNodes[t-1],t=Ci(n)}else if(n.parentNode&&!jm(n))t=Kn(n),n=n.parentNode;else return null}}function Cit(n,t){for(;;){if(n.nodeType==3&&t<n.nodeValue.length)return n;if(n.nodeType==1&&t<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[t],t=0}else if(n.parentNode&&!jm(n))t=Kn(n)+1,n=n.parentNode;else return null}}function Ait(n,t,e){for(let r=t==0,i=t==Ci(n);r||i;){if(n==e)return!0;let s=Kn(n);if(n=n.parentNode,!n)return!1;r=r&&s==0,i=i&&s==Ci(n)}}function jm(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const h_=function(n){return n.focusNode&&cu(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Mc(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function kit(n){let t=n.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function Mit(n,t,e){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(t,e);if(r)return{node:r.offsetNode,offset:Math.min(Ci(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(t,e);if(r)return{node:r.startContainer,offset:Math.min(Ci(r.startContainer),r.startOffset)}}}const no=typeof navigator<"u"?navigator:null,fP=typeof document<"u"?document:null,Ul=no&&no.userAgent||"",bE=/Edge\/(\d+)/.exec(Ul),y4=/MSIE \d/.exec(Ul),_E=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ul),jr=!!(y4||_E||bE),pl=y4?document.documentMode:_E?+_E[1]:bE?+bE[1]:0,Di=!jr&&/gecko\/(\d+)/i.test(Ul);Di&&+(/Firefox\/(\d+)/.exec(Ul)||[0,0])[1];const TE=!jr&&/Chrome\/(\d+)/.exec(Ul),Jn=!!TE,v4=TE?+TE[1]:0,lr=!jr&&!!no&&/Apple Computer/.test(no.vendor),tf=lr&&(/Mobile\/\w+/.test(Ul)||!!no&&no.maxTouchPoints>2),Ei=tf||(no?/Mac/.test(no.platform):!1),b4=no?/Win/.test(no.platform):!1,jo=/Android \d/.test(Ul),Fm=!!fP&&"webkitFontSmoothing"in fP.documentElement.style,Dit=Fm?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Oit(n){let t=n.defaultView&&n.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Co(n,t){return typeof n=="number"?n:n[t]}function Rit(n){let t=n.getBoundingClientRect(),e=t.width/n.offsetWidth||1,r=t.height/n.offsetHeight||1;return{left:t.left,right:t.left+n.clientWidth*e,top:t.top,bottom:t.top+n.clientHeight*r}}function dP(n,t,e){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,s=n.dom.ownerDocument;for(let o=e||n.dom;o;){if(o.nodeType!=1){o=Zh(o);continue}let l=o,u=l==s.body,h=u?Oit(s):Rit(l),d=0,p=0;if(t.top<h.top+Co(r,"top")?p=-(h.top-t.top+Co(i,"top")):t.bottom>h.bottom-Co(r,"bottom")&&(p=t.bottom-t.top>h.bottom-h.top?t.top+Co(i,"top")-h.top:t.bottom-h.bottom+Co(i,"bottom")),t.left<h.left+Co(r,"left")?d=-(h.left-t.left+Co(i,"left")):t.right>h.right-Co(r,"right")&&(d=t.right-h.right+Co(i,"right")),d||p)if(u)s.defaultView.scrollBy(d,p);else{let v=l.scrollLeft,T=l.scrollTop;p&&(l.scrollTop+=p),d&&(l.scrollLeft+=d);let S=l.scrollLeft-v,w=l.scrollTop-T;t={left:t.left-S,top:t.top-w,right:t.right-S,bottom:t.bottom-w}}let g=u?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(g))break;o=g=="absolute"?o.offsetParent:Zh(o)}}function Iit(n){let t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top),r,i;for(let s=(t.left+t.right)/2,o=e+1;o<Math.min(innerHeight,t.bottom);o+=5){let l=n.root.elementFromPoint(s,o);if(!l||l==n.dom||!n.dom.contains(l))continue;let u=l.getBoundingClientRect();if(u.top>=e-20){r=l,i=u.top;break}}return{refDOM:r,refTop:i,stack:_4(n.dom)}}function _4(n){let t=[],e=n.ownerDocument;for(let r=n;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=e);r=Zh(r));return t}function Pit({refDOM:n,refTop:t,stack:e}){let r=n?n.getBoundingClientRect().top:0;T4(e,r==0?0:r-t)}function T4(n,t){for(let e=0;e<n.length;e++){let{dom:r,top:i,left:s}=n[e];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=s&&(r.scrollLeft=s)}}let ch=null;function Nit(n){if(n.setActive)return n.setActive();if(ch)return n.focus(ch);let t=_4(n);n.focus(ch==null?{get preventScroll(){return ch={preventScroll:!0},!0}}:void 0),ch||(ch=!1,T4(t,0))}function S4(n,t){let e,r=2e8,i,s=0,o=t.top,l=t.top,u,h;for(let d=n.firstChild,p=0;d;d=d.nextSibling,p++){let g;if(d.nodeType==1)g=d.getClientRects();else if(d.nodeType==3)g=Oo(d).getClientRects();else continue;for(let v=0;v<g.length;v++){let T=g[v];if(T.top<=o&&T.bottom>=l){o=Math.max(T.bottom,o),l=Math.min(T.top,l);let S=T.left>t.left?T.left-t.left:T.right<t.left?t.left-T.right:0;if(S<r){e=d,r=S,i=S&&e.nodeType==3?{left:T.right<t.left?T.right:T.left,top:t.top}:t,d.nodeType==1&&S&&(s=p+(t.left>=(T.left+T.right)/2?1:0));continue}}else T.top>t.top&&!u&&T.left<=t.left&&T.right>=t.left&&(u=d,h={left:Math.max(T.left,Math.min(T.right,t.left)),top:T.top});!e&&(t.left>=T.right&&t.top>=T.top||t.left>=T.left&&t.top>=T.bottom)&&(s=p+1)}}return!e&&u&&(e=u,i=h,r=0),e&&e.nodeType==3?Lit(e,i):!e||r&&e.nodeType==1?{node:n,offset:s}:S4(e,i)}function Lit(n,t){let e=n.nodeValue.length,r=document.createRange(),i;for(let s=0;s<e;s++){r.setEnd(n,s+1),r.setStart(n,s);let o=Wa(r,1);if(o.top!=o.bottom&&nA(t,o)){i={node:n,offset:s+(t.left>=(o.left+o.right)/2?1:0)};break}}return r.detach(),i||{node:n,offset:0}}function nA(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function Vit(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}function jit(n,t,e){let{node:r,offset:i}=S4(t,e),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&e.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,i,s)}function Fit(n,t,e,r){let i=-1;for(let s=t,o=!1;s!=n.dom;){let l=n.docView.nearestDesc(s,!0),u;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((u=l.dom.getBoundingClientRect()).width||u.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!o&&u.left>r.left||u.top>r.top?i=l.posBefore:(!o&&u.right<r.left||u.bottom<r.top)&&(i=l.posAfter),o=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?r.top<(u.top+u.bottom)/2:r.left<(u.left+u.right)/2)?l.posBefore:l.posAfter;s=l.dom.parentNode}return i>-1?i:n.docView.posFromDOM(t,e,-1)}function w4(n,t,e){let r=n.childNodes.length;if(r&&e.top<e.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-e.top)/(e.bottom-e.top))-2)),s=i;;){let o=n.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let u=0;u<l.length;u++){let h=l[u];if(nA(t,h))return w4(o,t,h)}}if((s=(s+1)%r)==i)break}return n}function Bit(n,t){let e=n.dom.ownerDocument,r,i=0,s=Mit(e,t.left,t.top);s&&({node:r,offset:i}=s);let o=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top),l;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let h=n.dom.getBoundingClientRect();if(!nA(t,h)||(o=w4(n.dom,t,h),!o))return null}if(lr)for(let h=o;r&&h;h=Zh(h))h.draggable&&(r=void 0);if(o=Vit(o,t),r){if(Di&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let d=r.childNodes[i],p;d.nodeName=="IMG"&&(p=d.getBoundingClientRect()).right<=t.left&&p.bottom>t.top&&i++}let h;Fm&&i&&r.nodeType==1&&(h=r.childNodes[i-1]).nodeType==1&&h.contentEditable=="false"&&h.getBoundingClientRect().top>=t.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&t.top>r.lastChild.getBoundingClientRect().bottom?l=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=Fit(n,r,i,t))}l==null&&(l=jit(n,o,t));let u=n.docView.nearestDesc(o,!0);return{pos:l,inside:u?u.posAtStart-u.border:-1}}function pP(n){return n.top<n.bottom||n.left<n.right}function Wa(n,t){let e=n.getClientRects();if(e.length){let r=e[t<0?0:e.length-1];if(pP(r))return r}return Array.prototype.find.call(e,pP)||n.getBoundingClientRect()}const Uit=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function x4(n,t,e){let{node:r,offset:i,atom:s}=n.docView.domFromPos(t,e<0?-1:1),o=Fm||Di;if(r.nodeType==3)if(o&&(Uit.test(r.nodeValue)||(e<0?!i:i==r.nodeValue.length))){let u=Wa(Oo(r,i,i),e);if(Di&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let h=Wa(Oo(r,i-1,i-1),-1);if(h.top==u.top){let d=Wa(Oo(r,i,i+1),-1);if(d.top!=u.top)return zd(d,d.left<h.left)}}return u}else{let u=i,h=i,d=e<0?1:-1;return e<0&&!i?(h++,d=-1):e>=0&&i==r.nodeValue.length?(u--,d=1):e<0?u--:h++,zd(Wa(Oo(r,u,h),d),d<0)}if(!n.state.doc.resolve(t-(s||0)).parent.inlineContent){if(s==null&&i&&(e<0||i==Ci(r))){let u=r.childNodes[i-1];if(u.nodeType==1)return Dw(u.getBoundingClientRect(),!1)}if(s==null&&i<Ci(r)){let u=r.childNodes[i];if(u.nodeType==1)return Dw(u.getBoundingClientRect(),!0)}return Dw(r.getBoundingClientRect(),e>=0)}if(s==null&&i&&(e<0||i==Ci(r))){let u=r.childNodes[i-1],h=u.nodeType==3?Oo(u,Ci(u)-(o?0:1)):u.nodeType==1&&(u.nodeName!="BR"||!u.nextSibling)?u:null;if(h)return zd(Wa(h,1),!1)}if(s==null&&i<Ci(r)){let u=r.childNodes[i];for(;u.pmViewDesc&&u.pmViewDesc.ignoreForCoords;)u=u.nextSibling;let h=u?u.nodeType==3?Oo(u,0,o?0:1):u.nodeType==1?u:null:null;if(h)return zd(Wa(h,-1),!0)}return zd(Wa(r.nodeType==3?Oo(r):r,-e),e>=0)}function zd(n,t){if(n.width==0)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function Dw(n,t){if(n.height==0)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function E4(n,t,e){let r=n.state,i=n.root.activeElement;r!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{r!=t&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function zit(n,t,e){let r=t.selection,i=e=="up"?r.$from:r.$to;return E4(n,t,()=>{let{node:s}=n.docView.domFromPos(i.pos,e=="up"?-1:1);for(;;){let l=n.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=x4(n,i.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let u;if(l.nodeType==1)u=l.getClientRects();else if(l.nodeType==3)u=Oo(l,0,l.nodeValue.length).getClientRects();else continue;for(let h=0;h<u.length;h++){let d=u[h];if(d.bottom>d.top+1&&(e=="up"?o.top-d.top>(d.bottom-o.top)*2:d.bottom-o.bottom>(o.bottom-d.top)*2))return!1}}return!0})}const Hit=/[\u0590-\u08ac]/;function $it(n,t,e){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,l=n.domSelection();return l?!Hit.test(r.parent.textContent)||!l.modify?e=="left"||e=="backward"?s:o:E4(n,t,()=>{let{focusNode:u,focusOffset:h,anchorNode:d,anchorOffset:p}=n.domSelectionRange(),g=l.caretBidiLevel;l.modify("move",e,"character");let v=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:T,focusOffset:S}=n.domSelectionRange(),w=T&&!v.contains(T.nodeType==1?T:T.parentNode)||u==T&&h==S;try{l.collapse(d,p),u&&(u!=d||h!=p)&&l.extend&&l.extend(u,h)}catch{}return g!=null&&(l.caretBidiLevel=g),w}):r.pos==r.start()||r.pos==r.end()}let mP=null,gP=null,yP=!1;function qit(n,t,e){return mP==t&&gP==e?yP:(mP=t,gP=e,yP=e=="up"||e=="down"?zit(n,t,e):$it(n,t,e))}const Oi=0,vP=1,Vc=2,ro=3;class Bm{constructor(t,e,r,i){this.parent=t,this.children=e,this.dom=r,this.contentDOM=i,this.dirty=Oi,r.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,r){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,r=this.posAtStart;;e++){let i=this.children[e];if(i==t)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,r){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(r<0){let s,o;if(t==this.contentDOM)s=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(t==this.contentDOM)s=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(t==this.dom&&this.contentDOM)i=e>Kn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(e==0)for(let s=t;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&e==t.childNodes.length)for(let s=t;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let r=!0,i=t;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!e||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(t.nodeType==1?t:t.parentNode):o==t))r=!1;else return s}}getDesc(t){let e=t.pmViewDesc;for(let r=e;r;r=r.parent)if(r==this)return e}posFromDOM(t,e,r){for(let i=t;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(t,e,r)}return-1}descAt(t){for(let e=0,r=0;e<this.children.length;e++){let i=this.children[e],s=r+i.size;if(r==t&&s!=r){for(;!i.border&&i.children.length;)for(let o=0;o<i.children.length;o++){let l=i.children[o];if(l.size){i=l;break}}return i}if(t<s)return i.descAt(t-r-i.border);r=s}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.size;if(l>t||o instanceof A4){i=t-s;break}s=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,e);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof C4&&s.side>=0;r--);if(e<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&e&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,e):{node:this.contentDOM,offset:s?Kn(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,e):{node:this.contentDOM,offset:s?Kn(s.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,r=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,l=0;;l++){let u=this.children[l],h=o+u.size;if(i==-1&&t<=h){let d=o+u.border;if(t>=d&&e<=h-u.border&&u.node&&u.contentDOM&&this.contentDOM.contains(u.contentDOM))return u.parseRange(t,e,d);t=o;for(let p=l;p>0;p--){let g=this.children[p-1];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(1)){i=Kn(g.dom)+1;break}t-=g.size}i==-1&&(i=0)}if(i>-1&&(h>e||l==this.children.length-1)){e=h;for(let d=l+1;d<this.children.length;d++){let p=this.children[d];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){s=Kn(p.dom);break}e+=p.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=h}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:s}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return e.size==0||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:r}=this.domFromPos(t,0);if(e.nodeType!=1||r==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[r]}setSelection(t,e,r,i=!1){let s=Math.min(t,e),o=Math.max(t,e);for(let v=0,T=0;v<this.children.length;v++){let S=this.children[v],w=T+S.size;if(s>T&&o<w)return S.setSelection(t-T-S.border,e-T-S.border,r,i);T=w}let l=this.domFromPos(t,t?-1:1),u=e==t?l:this.domFromPos(e,e?-1:1),h=r.root.getSelection(),d=r.domSelectionRange(),p=!1;if((Di||lr)&&t==e){let{node:v,offset:T}=l;if(v.nodeType==3){if(p=!!(T&&v.nodeValue[T-1]==`
`),p&&T==v.nodeValue.length)for(let S=v,w;S;S=S.parentNode){if(w=S.nextSibling){w.nodeName=="BR"&&(l=u={node:w.parentNode,offset:Kn(w)+1});break}let E=S.pmViewDesc;if(E&&E.node&&E.node.isBlock)break}}else{let S=v.childNodes[T-1];p=S&&(S.nodeName=="BR"||S.contentEditable=="false")}}if(Di&&d.focusNode&&d.focusNode!=u.node&&d.focusNode.nodeType==1){let v=d.focusNode.childNodes[d.focusOffset];v&&v.contentEditable=="false"&&(i=!0)}if(!(i||p&&lr)&&cu(l.node,l.offset,d.anchorNode,d.anchorOffset)&&cu(u.node,u.offset,d.focusNode,d.focusOffset))return;let g=!1;if((h.extend||t==e)&&!(p&&Di)){h.collapse(l.node,l.offset);try{t!=e&&h.extend(u.node,u.offset),g=!0}catch{}}if(!g){if(t>e){let T=l;l=u,u=T}let v=document.createRange();v.setEnd(u.node,u.offset),v.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(v)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?t<=o&&e>=r:t<o&&e>r){let l=r+s.border,u=o-s.border;if(t>=l&&e<=u){this.dirty=t==r||e==o?Vc:vP,t==l&&e==u&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=ro:s.markDirty(t-l,e-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Vc:ro}r=o}this.dirty=Vc}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let r=t==1?Vc:vP;e.dirty<r&&(e.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(t){return!1}}class C4 extends Bm{constructor(t,e,r,i){let s,o=e.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!e.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(t,[],o,null),this.widget=e,this.widget=e,s=this}matchesWidget(t){return this.dirty==Oi&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return e?e(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class Wit extends Bm{constructor(t,e,r,i){super(t,[],e,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class uu extends Bm{constructor(t,e,r,i,s){super(t,[],r,i),this.mark=e,this.spec=s}static create(t,e,r,i){let s=i.nodeViews[e.type.name],o=s&&s(e,i,r);return(!o||!o.dom)&&(o=yu.renderSpec(document,e.type.spec.toDOM(e,r),null,e.attrs)),new uu(t,e,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&ro||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=ro&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),this.dirty!=Oi){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Oi}}slice(t,e,r){let i=uu.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;e<o&&(s=wE(s,e,o,r)),t>0&&(s=wE(s,0,t,r));for(let l=0;l<s.length;l++)s[l].parent=i;return i.children=s,i}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class ml extends Bm{constructor(t,e,r,i,s,o,l,u,h){super(t,[],s,o),this.node=e,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(t,e,r,i,s,o){let l=s.nodeViews[e.type.name],u,h=l&&l(e,s,()=>{if(!u)return o;if(u.parent)return u.parent.posBeforeChild(u)},r,i),d=h&&h.dom,p=h&&h.contentDOM;if(e.isText){if(!d)d=document.createTextNode(e.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:p}=yu.renderSpec(document,e.type.spec.toDOM(e),null,e.attrs));!p&&!e.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),e.type.spec.draggable&&(d.draggable=!0));let g=d;return d=D4(d,r,e),h?u=new Git(t,e,r,i,d,p||null,g,h,s,o+1):e.isText?new f_(t,e,r,i,d,g,s):new ml(t,e,r,i,d,p||null,g,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let e=this.children.length-1;e>=0;e--){let r=this.children[e];if(this.dom.contains(r.dom.parentNode)){t.contentElement=r.dom.parentNode;break}}t.contentElement||(t.getContent=()=>ut.empty)}return t}matchesNode(t,e,r){return this.dirty==Oi&&t.eq(this.node)&&Iv(e,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let r=this.node.inlineContent,i=e,s=t.composing?this.localCompositionInfo(t,e):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,u=new Kit(this,o&&o.node,t);Jit(this.node,this.innerDeco,(h,d,p)=>{h.spec.marks?u.syncToMarks(h.spec.marks,r,t,d):h.type.side>=0&&!p&&u.syncToMarks(d==this.node.childCount?Ae.none:this.node.child(d).marks,r,t,d),u.placeWidget(h,t,i)},(h,d,p,g)=>{u.syncToMarks(h.marks,r,t,g);let v;u.findNodeMatch(h,d,p,g)||l&&t.state.selection.from>i&&t.state.selection.to<i+h.nodeSize&&(v=u.findIndexWithChild(s.node))>-1&&u.updateNodeAt(h,d,p,v,t)||u.updateNextNode(h,d,p,t,g,i)||u.addNode(h,d,p,t,i),i+=h.nodeSize}),u.syncToMarks([],r,t,0),this.node.isTextblock&&u.addTextblockHacks(),u.destroyRest(),(u.changed||this.dirty==Vc)&&(o&&this.protectLocalComposition(t,o),k4(this.contentDOM,this.children,t),tf&&Zit(this.dom))}localCompositionInfo(t,e){let{from:r,to:i}=t.state.selection;if(!(t.state.selection instanceof jt)||r<e||i>e+this.node.content.size)return null;let s=t.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,l=tst(this.node.content,o,r-e,i-e);return l<0?null:{node:s,pos:l,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:r,text:i}){if(this.getDesc(e))return;let s=e;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new Wit(this,s,e,i);t.input.compositionNodes.push(o),this.children=wE(this.children,r,r+i.length,t,o)}update(t,e,r,i){return this.dirty==ro||!t.sameMarkup(this.node)?!1:(this.updateInner(t,e,r,i),!0)}updateInner(t,e,r,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Oi}updateOuterDeco(t){if(Iv(t,this.outerDeco))return;let e=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=M4(this.dom,this.nodeDOM,SE(this.outerDeco,this.node,e),SE(t,this.node,e)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function bP(n,t,e,r,i){D4(r,t,n);let s=new ml(void 0,n,t,e,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class f_ extends ml{constructor(t,e,r,i,s,o,l){super(t,e,r,i,s,null,o,l,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,r,i){return this.dirty==ro||this.dirty!=Oi&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(e),(this.dirty!=Oi||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=Oi,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,r){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,r)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,e,r){let i=this.node.cut(t,e),s=document.createTextNode(i.text);return new f_(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(t==0||e==this.nodeDOM.nodeValue.length)&&(this.dirty=ro)}get domAtom(){return!1}isText(t){return this.node.text==t}}class A4 extends Bm{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==Oi&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Git extends ml{constructor(t,e,r,i,s,o,l,u,h,d){super(t,e,r,i,s,o,l,h,d),this.spec=u}update(t,e,r,i){if(this.dirty==ro)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let s=this.spec.update(t,e,r);return s&&this.updateInner(t,e,r,i),s}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,e,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,r,i){this.spec.setSelection?this.spec.setSelection(t,e,r.root):super.setSelection(t,e,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function k4(n,t,e){let r=n.firstChild,i=!1;for(let s=0;s<t.length;s++){let o=t[s],l=o.dom;if(l.parentNode==n){for(;l!=r;)r=_P(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(l,r);if(o instanceof uu){let u=r?r.previousSibling:n.lastChild;k4(o.contentDOM,o.children,e),r=u?u.nextSibling:n.firstChild}}for(;r;)r=_P(r),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const Tp=function(n){n&&(this.nodeName=n)};Tp.prototype=Object.create(null);const jc=[new Tp];function SE(n,t,e){if(n.length==0)return jc;let r=e?jc[0]:new Tp,i=[r];for(let s=0;s<n.length;s++){let o=n[s].type.attrs;if(o){o.nodeName&&i.push(r=new Tp(o.nodeName));for(let l in o){let u=o[l];u!=null&&(e&&i.length==1&&i.push(r=new Tp(t.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+u:l=="style"?r.style=(r.style?r.style+";":"")+u:l!="nodeName"&&(r[l]=u))}}}return i}function M4(n,t,e,r){if(e==jc&&r==jc)return t;let i=t;for(let s=0;s<r.length;s++){let o=r[s],l=e[s];if(s){let u;l&&l.nodeName==o.nodeName&&i!=n&&(u=i.parentNode)&&u.nodeName.toLowerCase()==o.nodeName||(u=document.createElement(o.nodeName),u.pmIsDeco=!0,u.appendChild(i),l=jc[0]),i=u}Yit(i,l||jc[0],o)}return i}function Yit(n,t,e){for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&!(r in e)&&n.removeAttribute(r);for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&e[r]!=t[r]&&n.setAttribute(r,e[r]);if(t.class!=e.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&n.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&n.classList.add(i[s]);n.classList.length==0&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(t.style);)n.style.removeProperty(i[1])}e.style&&(n.style.cssText+=e.style)}}function D4(n,t,e){return M4(n,n,jc,SE(t,e,n.nodeType!=1))}function Iv(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function _P(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class Kit{constructor(t,e,r){this.lock=e,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=Xit(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let r=t;r<e;r++)this.top.children[r].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,r,i){let s=0,o=this.stack.length>>1,l=Math.min(o,t.length);for(;s<l&&(s==o-1?this.top:this.stack[s+1<<1]).matchesMark(t[s])&&t[s].type.spec.spanning!==!1;)s++;for(;s<o;)this.destroyRest(),this.top.dirty=Oi,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);let u=-1,h=this.top.children.length;i<this.preMatch.index&&(h=Math.min(this.index+3,h));for(let d=this.index;d<h;d++){let p=this.top.children[d];if(p.matchesMark(t[o])&&!this.isLocked(p.dom)){u=d;break}}if(u>-1)u>this.index&&(this.changed=!0,this.destroyBetween(this.index,u)),this.top=this.top.children[this.index];else{let d=uu.create(this.top,t[o],e,r);this.top.children.splice(this.index,0,d),this.top=d,this.changed=!0}this.index=0,o++}}findNodeMatch(t,e,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(t,e,r))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,u=Math.min(this.top.children.length,l+5);l<u;l++){let h=this.top.children[l];if(h.matchesNode(t,e,r)&&!this.preMatch.matched.has(h)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(t,e,r,i,s){let o=this.top.children[i];return o.dirty==ro&&o.dom==o.contentDOM&&(o.dirty=Vc),o.update(t,e,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let r=t.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}t=e}}updateNextNode(t,e,r,i,s,o){for(let l=this.index;l<this.top.children.length;l++){let u=this.top.children[l];if(u instanceof ml){let h=this.preMatch.matched.get(u);if(h!=null&&h!=s)return!1;let d=u.dom,p,g=this.isLocked(d)&&!(t.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==t.text&&u.dirty!=ro&&Iv(e,u.outerDeco));if(!g&&u.update(t,e,r,i))return this.destroyBetween(this.index,l),u.dom!=d&&(this.changed=!0),this.index++,!0;if(!g&&(p=this.recreateWrapper(u,t,e,r,i,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=p,p.contentDOM&&(p.dirty=Vc,p.updateChildren(i,o+1),p.dirty=Oi),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,e,r,i,s,o){if(t.dirty||e.isAtom||!t.children.length||!t.node.content.eq(e.content)||!Iv(r,t.outerDeco)||!i.eq(t.innerDeco))return null;let l=ml.create(this.top,e,r,i,s,o);if(l.contentDOM){l.children=t.children,t.children=[];for(let u of l.children)u.parent=l}return t.destroy(),l}addNode(t,e,r,i,s){let o=ml.create(this.top,t,e,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(t,e,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(t)&&(t==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new C4(this.top,t,e,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof uu;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof f_)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((lr||Jn)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let r=document.createElement(t);t=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),t=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new A4(this.top,[],r,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function Xit(n,t){let e=t,r=e.children.length,i=n.childCount,s=new Map,o=[];t:for(;i>0;){let l;for(;;)if(r){let h=e.children[r-1];if(h instanceof uu)e=h,r=h.children.length;else{l=h,r--;break}}else{if(e==t)break t;r=e.parent.children.indexOf(e),e=e.parent}let u=l.node;if(u){if(u!=n.child(i-1))break;--i,s.set(l,i),o.push(l)}}return{index:i,matched:s,matches:o.reverse()}}function Qit(n,t){return n.type.side-t.type.side}function Jit(n,t,e,r){let i=t.locals(n),s=0;if(i.length==0){for(let h=0;h<n.childCount;h++){let d=n.child(h);r(d,i,t.forChild(s,d),h),s+=d.nodeSize}return}let o=0,l=[],u=null;for(let h=0;;){let d,p;for(;o<i.length&&i[o].to==s;){let w=i[o++];w.widget&&(d?(p||(p=[d])).push(w):d=w)}if(d)if(p){p.sort(Qit);for(let w=0;w<p.length;w++)e(p[w],h,!!u)}else e(d,h,!!u);let g,v;if(u)v=-1,g=u,u=null;else if(h<n.childCount)v=h,g=n.child(h++);else break;for(let w=0;w<l.length;w++)l[w].to<=s&&l.splice(w--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)l.push(i[o++]);let T=s+g.nodeSize;if(g.isText){let w=T;o<i.length&&i[o].from<w&&(w=i[o].from);for(let E=0;E<l.length;E++)l[E].to<w&&(w=l[E].to);w<T&&(u=g.cut(w-s),g=g.cut(0,w-s),T=w,v=-1)}else for(;o<i.length&&i[o].to<T;)o++;let S=g.isInline&&!g.isLeaf?l.filter(w=>!w.inline):l.slice();r(g,S,t.forChild(s,g),v),s=T}}function Zit(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=t}}function tst(n,t,e,r){for(let i=0,s=0;i<n.childCount&&s<=r;){let o=n.child(i++),l=s;if(s+=o.nodeSize,!o.isText)continue;let u=o.text;for(;i<n.childCount;){let h=n.child(i++);if(s+=h.nodeSize,!h.isText)break;u+=h.text}if(s>=e){if(s>=r&&u.slice(r-t.length-l,r-l)==t)return r-t.length;let h=l<r?u.lastIndexOf(t,r-l-1):-1;if(h>=0&&h+t.length+l>=e)return l+h;if(e==r&&u.length>=r+t.length-l&&u.slice(r-l,r-l+t.length)==t)return r}}return-1}function wE(n,t,e,r,i){let s=[];for(let o=0,l=0;o<n.length;o++){let u=n[o],h=l,d=l+=u.size;h>=e||d<=t?s.push(u):(h<t&&s.push(u.slice(0,t-h,r)),i&&(s.push(i),i=void 0),d>e&&s.push(u.slice(e-h,u.size,r)))}return s}function rA(n,t=null){let e=n.domSelectionRange(),r=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),s=i&&i.size==0,o=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(o<0)return null;let l=r.resolve(o),u,h;if(h_(e)){for(u=o;i&&!i.node;)i=i.parent;let p=i.node;if(i&&p.isAtom&&Dt.isSelectable(p)&&i.parent&&!(p.isInline&&Ait(e.focusNode,e.focusOffset,i.dom))){let g=i.posBefore;h=new Dt(o==g?l:r.resolve(g))}}else{if(e instanceof n.dom.ownerDocument.defaultView.Selection&&e.rangeCount>1){let p=o,g=o;for(let v=0;v<e.rangeCount;v++){let T=e.getRangeAt(v);p=Math.min(p,n.docView.posFromDOM(T.startContainer,T.startOffset,1)),g=Math.max(g,n.docView.posFromDOM(T.endContainer,T.endOffset,-1))}if(p<0)return null;[u,o]=g==n.state.selection.anchor?[g,p]:[p,g],l=r.resolve(o)}else u=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(u<0)return null}let d=r.resolve(u);if(!h){let p=t=="pointer"||n.state.selection.head<l.pos&&!s?1:-1;h=iA(n,d,l,p)}return h}function O4(n){return n.editable?n.hasFocus():I4(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function qo(n,t=!1){let e=n.state.selection;if(R4(n,e),!!O4(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Jn){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&cu(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)nst(n);else{let{anchor:r,head:i}=e,s,o;TP&&!(e instanceof jt)&&(e.$from.parent.inlineContent||(s=SP(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(o=SP(n,e.to))),n.docView.setSelection(r,i,n,t),TP&&(s&&wP(s),o&&wP(o)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&est(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const TP=lr||Jn&&v4<63;function SP(n,t){let{node:e,offset:r}=n.docView.domFromPos(t,0),i=r<e.childNodes.length?e.childNodes[r]:null,s=r?e.childNodes[r-1]:null;if(lr&&i&&i.contentEditable=="false")return Ow(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Ow(i);if(s)return Ow(s)}}function Ow(n){return n.contentEditable="true",lr&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function wP(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function est(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelectionRange(),r=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=r||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!O4(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function nst(n){let t=n.domSelection();if(!t)return;let e=n.cursorWrapper.dom,r=e.nodeName=="IMG";r?t.collapse(e.parentNode,Kn(e)+1):t.collapse(e,0),!r&&!n.state.selection.visible&&jr&&pl<=11&&(e.disabled=!0,e.disabled=!1)}function R4(n,t){if(t instanceof Dt){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(xP(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else xP(n)}function xP(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function iA(n,t,e,r){return n.someProp("createSelectionBetween",i=>i(n,t,e))||jt.between(t,e,r)}function EP(n){return n.editable&&!n.hasFocus()?!1:I4(n)}function I4(n){let t=n.domSelectionRange();if(!t.anchorNode)return!1;try{return n.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function rst(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelectionRange();return cu(t.node,t.offset,e.anchorNode,e.anchorOffset)}function xE(n,t){let{$anchor:e,$head:r}=n.selection,i=t>0?e.max(r):e.min(r),s=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return s&&Wt.findFrom(s,t)}function Ga(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function CP(n,t,e){let r=n.state.selection;if(r instanceof jt)if(e.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=n.state.doc.resolve(i.pos+s.nodeSize*(t<0?-1:1));return Ga(n,new jt(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(t>0?"forward":"backward")){let i=xE(n.state,t);return i&&i instanceof Dt?Ga(n,i):!1}else if(!(Ei&&e.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let l=t<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=n.docView.descAt(l))&&!o.contentDOM?Dt.isSelectable(s)?Ga(n,new Dt(t<0?n.state.doc.resolve(i.pos-s.nodeSize):i)):Fm?Ga(n,new jt(n.state.doc.resolve(t<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof Dt&&r.node.isInline)return Ga(n,new jt(t>0?r.$to:r.$from));{let i=xE(n.state,t);return i?Ga(n,i):!1}}}function Pv(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Sp(n,t){let e=n.pmViewDesc;return e&&e.size==0&&(t<0||n.nextSibling||n.nodeName!="BR")}function uh(n,t){return t<0?ist(n):sst(n)}function ist(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i,s,o=!1;for(Di&&e.nodeType==1&&r<Pv(e)&&Sp(e.childNodes[r],-1)&&(o=!0);;)if(r>0){if(e.nodeType!=1)break;{let l=e.childNodes[r-1];if(Sp(l,-1))i=e,s=--r;else if(l.nodeType==3)e=l,r=e.nodeValue.length;else break}}else{if(P4(e))break;{let l=e.previousSibling;for(;l&&Sp(l,-1);)i=e.parentNode,s=Kn(l),l=l.previousSibling;if(l)e=l,r=Pv(e);else{if(e=e.parentNode,e==n.dom)break;r=0}}}o?EE(n,e,r):i&&EE(n,i,s)}function sst(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i=Pv(e),s,o;for(;;)if(r<i){if(e.nodeType!=1)break;let l=e.childNodes[r];if(Sp(l,1))s=e,o=++r;else break}else{if(P4(e))break;{let l=e.nextSibling;for(;l&&Sp(l,1);)s=l.parentNode,o=Kn(l)+1,l=l.nextSibling;if(l)e=l,r=0,i=Pv(e);else{if(e=e.parentNode,e==n.dom)break;r=i=0}}}s&&EE(n,s,o)}function P4(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function ost(n,t){for(;n&&t==n.childNodes.length&&!jm(n);)t=Kn(n)+1,n=n.parentNode;for(;n&&t<n.childNodes.length;){let e=n.childNodes[t];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;n=e,t=0}}function ast(n,t){for(;n&&!t&&!jm(n);)t=Kn(n),n=n.parentNode;for(;n&&t;){let e=n.childNodes[t-1];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;n=e,t=n.childNodes.length}}function EE(n,t,e){if(t.nodeType!=3){let s,o;(o=ost(t,e))?(t=o,e=0):(s=ast(t,e))&&(t=s,e=s.nodeValue.length)}let r=n.domSelection();if(!r)return;if(h_(r)){let s=document.createRange();s.setEnd(t,e),s.setStart(t,e),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(t,e);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&qo(n)},50)}function AP(n,t){let e=n.state.doc.resolve(t);if(!(Jn||b4)&&e.parent.inlineContent){let i=n.coordsAtPos(t);if(t>e.start()){let s=n.coordsAtPos(t-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(t<e.end()){let s=n.coordsAtPos(t+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function kP(n,t,e){let r=n.state.selection;if(r instanceof jt&&!r.empty||e.indexOf("s")>-1||Ei&&e.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let o=xE(n.state,t);if(o&&o instanceof Dt)return Ga(n,o)}if(!i.parent.inlineContent){let o=t<0?i:s,l=r instanceof ii?Wt.near(o,t):Wt.findFrom(o,t);return l?Ga(n,l):!1}return!1}function MP(n,t){if(!(n.state.selection instanceof jt))return!0;let{$head:e,$anchor:r,empty:i}=n.state.selection;if(!e.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(s&&!s.isText){let o=n.state.tr;return t<0?o.delete(e.pos-s.nodeSize,e.pos):o.delete(e.pos,e.pos+s.nodeSize),n.dispatch(o),!0}return!1}function DP(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function lst(n){if(!lr||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelectionRange();if(t&&t.nodeType==1&&e==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let r=t.firstChild;DP(n,r,"true"),setTimeout(()=>DP(n,r,"false"),20)}return!1}function cst(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}function ust(n,t){let e=t.keyCode,r=cst(t);if(e==8||Ei&&e==72&&r=="c")return MP(n,-1)||uh(n,-1);if(e==46&&!t.shiftKey||Ei&&e==68&&r=="c")return MP(n,1)||uh(n,1);if(e==13||e==27)return!0;if(e==37||Ei&&e==66&&r=="c"){let i=e==37?AP(n,n.state.selection.from)=="ltr"?-1:1:-1;return CP(n,i,r)||uh(n,i)}else if(e==39||Ei&&e==70&&r=="c"){let i=e==39?AP(n,n.state.selection.from)=="ltr"?1:-1:1;return CP(n,i,r)||uh(n,i)}else{if(e==38||Ei&&e==80&&r=="c")return kP(n,-1,r)||uh(n,-1);if(e==40||Ei&&e==78&&r=="c")return lst(n)||kP(n,1,r)||uh(n,1);if(r==(Ei?"m":"c")&&(e==66||e==73||e==89||e==90))return!0}return!1}function sA(n,t){n.someProp("transformCopied",v=>{t=v(t,n)});let e=[],{content:r,openStart:i,openEnd:s}=t;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let v=r.firstChild;e.push(v.type.name,v.attrs!=v.type.defaultAttrs?v.attrs:null),r=v.content}let o=n.someProp("clipboardSerializer")||yu.fromSchema(n.state.schema),l=B4(),u=l.createElement("div");u.appendChild(o.serializeFragment(r,{document:l}));let h=u.firstChild,d,p=0;for(;h&&h.nodeType==1&&(d=F4[h.nodeName.toLowerCase()]);){for(let v=d.length-1;v>=0;v--){let T=l.createElement(d[v]);for(;u.firstChild;)T.appendChild(u.firstChild);u.appendChild(T),p++}h=u.firstChild}h&&h.nodeType==1&&h.setAttribute("data-pm-slice",`${i} ${s}${p?` -${p}`:""} ${JSON.stringify(e)}`);let g=n.someProp("clipboardTextSerializer",v=>v(t,n))||t.content.textBetween(0,t.content.size,`

`);return{dom:u,text:g,slice:t}}function N4(n,t,e,r,i){let s=i.parent.type.spec.code,o,l;if(!e&&!t)return null;let u=!!t&&(r||s||!e);if(u){if(n.someProp("transformPastedText",g=>{t=g(t,s||r,n)}),s)return l=new vt(ut.from(n.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0),n.someProp("transformPasted",g=>{l=g(l,n,!0)}),l;let p=n.someProp("clipboardTextParser",g=>g(t,i,r,n));if(p)l=p;else{let g=i.marks(),{schema:v}=n.state,T=yu.fromSchema(v);o=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(S=>{let w=o.appendChild(document.createElement("p"));S&&w.appendChild(T.serializeNode(v.text(S,g)))})}}else n.someProp("transformPastedHTML",p=>{e=p(e,n)}),o=pst(e),Fm&&mst(o);let h=o&&o.querySelector("[data-pm-slice]"),d=h&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(h.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let p=+d[3];p>0;p--){let g=o.firstChild;for(;g&&g.nodeType!=1;)g=g.nextSibling;if(!g)break;o=g}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||dl.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(u||d),context:i,ruleFromNode(g){return g.nodeName=="BR"&&!g.nextSibling&&g.parentNode&&!hst.test(g.parentNode.nodeName)?{ignore:!0}:null}})),d)l=gst(OP(l,+d[1],+d[2]),d[4]);else if(l=vt.maxOpen(fst(l.content,i),!0),l.openStart||l.openEnd){let p=0,g=0;for(let v=l.content.firstChild;p<l.openStart&&!v.type.spec.isolating;p++,v=v.firstChild);for(let v=l.content.lastChild;g<l.openEnd&&!v.type.spec.isolating;g++,v=v.lastChild);l=OP(l,p,g)}return n.someProp("transformPasted",p=>{l=p(l,n,u)}),l}const hst=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function fst(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let i=t.node(e).contentMatchAt(t.index(e)),s,o=[];if(n.forEach(l=>{if(!o)return;let u=i.findWrapping(l.type),h;if(!u)return o=null;if(h=o.length&&s.length&&V4(u,s,l,o[o.length-1],0))o[o.length-1]=h;else{o.length&&(o[o.length-1]=j4(o[o.length-1],s.length));let d=L4(l,u);o.push(d),i=i.matchType(d.type),s=u}}),o)return ut.from(o)}return n}function L4(n,t,e=0){for(let r=t.length-1;r>=e;r--)n=t[r].create(null,ut.from(n));return n}function V4(n,t,e,r,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let s=V4(n,t,e,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?e.type:n[i+1]))return r.copy(r.content.append(ut.from(L4(e,n,i+1))))}}function j4(n,t){if(t==0)return n;let e=n.content.replaceChild(n.childCount-1,j4(n.lastChild,t-1)),r=n.contentMatchAt(n.childCount).fillBefore(ut.empty,!0);return n.copy(e.append(r))}function CE(n,t,e,r,i,s){let o=t<0?n.firstChild:n.lastChild,l=o.content;return n.childCount>1&&(s=0),i<r-1&&(l=CE(l,t,e,r,i+1,s)),i>=e&&(l=t<0?o.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(ut.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,o.copy(l))}function OP(n,t,e){return t<n.openStart&&(n=new vt(CE(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new vt(CE(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const F4={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let RP=null;function B4(){return RP||(RP=document.implementation.createHTMLDocument("title"))}let Rw=null;function dst(n){let t=window.trustedTypes;return t?(Rw||(Rw=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e})),Rw.createHTML(n)):n}function pst(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let e=B4().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&F4[r[1].toLowerCase()])&&(n=i.map(s=>"<"+s+">").join("")+n+i.map(s=>"</"+s+">").reverse().join("")),e.innerHTML=dst(n),i)for(let s=0;s<i.length;s++)e=e.querySelector(i[s])||e;return e}function mst(n){let t=n.querySelectorAll(Jn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let r=t[e];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function gst(n,t){if(!n.size)return n;let e=n.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch{return n}let{content:i,openStart:s,openEnd:o}=n;for(let l=r.length-2;l>=0;l-=2){let u=e.nodes[r[l]];if(!u||u.hasRequiredAttrs())break;i=ut.from(u.create(r[l+1],i)),s++,o++}return new vt(i,s,o)}const Sr={},wr={},yst={touchstart:!0,touchmove:!0};class vst{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function bst(n){for(let t in Sr){let e=Sr[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>{Tst(n,r)&&!oA(n,r)&&(n.editable||!(r.type in wr))&&e(n,r)},yst[t]?{passive:!0}:void 0)}lr&&n.dom.addEventListener("input",()=>null),AE(n)}function al(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function _st(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function AE(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>oA(n,r))})}function oA(n,t){return n.someProp("handleDOMEvents",e=>{let r=e[t.type];return r?r(n,t)||t.defaultPrevented:!1})}function Tst(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||e.nodeType==11||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function Sst(n,t){!oA(n,t)&&Sr[t.type]&&(n.editable||!(t.type in wr))&&Sr[t.type](n,t)}wr.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=e.keyCode==16||e.shiftKey,!z4(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!(jo&&Jn&&e.keyCode==13)))if(e.keyCode!=229&&n.domObserver.forceFlush(),tf&&e.keyCode==13&&!e.ctrlKey&&!e.altKey&&!e.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,Mc(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,e))||ust(n,e)?e.preventDefault():al(n,"key")};wr.keyup=(n,t)=>{t.keyCode==16&&(n.input.shiftKey=!1)};wr.keypress=(n,t)=>{let e=t;if(z4(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||Ei&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e))){e.preventDefault();return}let r=n.state.selection;if(!(r instanceof jt)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(e.charCode),s=()=>n.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i,s))&&n.dispatch(s()),e.preventDefault()}};function d_(n){return{left:n.clientX,top:n.clientY}}function wst(n,t){let e=t.x-n.clientX,r=t.y-n.clientY;return e*e+r*r<100}function aA(n,t,e,r,i){if(r==-1)return!1;let s=n.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(n.someProp(t,l=>o>s.depth?l(n,e,s.nodeAfter,s.before(o),i,!0):l(n,e,s.node(o),s.before(o),i,!1)))return!0;return!1}function Bh(n,t,e){if(n.focused||n.focus(),n.state.selection.eq(t))return;let r=n.state.tr.setSelection(t);r.setMeta("pointer",!0),n.dispatch(r)}function xst(n,t){if(t==-1)return!1;let e=n.state.doc.resolve(t),r=e.nodeAfter;return r&&r.isAtom&&Dt.isSelectable(r)?(Bh(n,new Dt(e)),!0):!1}function Est(n,t){if(t==-1)return!1;let e=n.state.selection,r,i;e instanceof Dt&&(r=e.node);let s=n.state.doc.resolve(t);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(Dt.isSelectable(l)){r&&e.$from.depth>0&&o>=e.$from.depth&&s.before(e.$from.depth+1)==e.$from.pos?i=s.before(e.$from.depth):i=s.before(o);break}}return i!=null?(Bh(n,Dt.create(n.state.doc,i)),!0):!1}function Cst(n,t,e,r,i){return aA(n,"handleClickOn",t,e,r)||n.someProp("handleClick",s=>s(n,t,r))||(i?Est(n,e):xst(n,e))}function Ast(n,t,e,r){return aA(n,"handleDoubleClickOn",t,e,r)||n.someProp("handleDoubleClick",i=>i(n,t,r))}function kst(n,t,e,r){return aA(n,"handleTripleClickOn",t,e,r)||n.someProp("handleTripleClick",i=>i(n,t,r))||Mst(n,e,r)}function Mst(n,t,e){if(e.button!=0)return!1;let r=n.state.doc;if(t==-1)return r.inlineContent?(Bh(n,jt.create(r,0,r.content.size)),!0):!1;let i=r.resolve(t);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(o.inlineContent)Bh(n,jt.create(r,l+1,l+1+o.content.size));else if(Dt.isSelectable(o))Bh(n,Dt.create(r,l));else continue;return!0}}function lA(n){return Nv(n)}const U4=Ei?"metaKey":"ctrlKey";Sr.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let r=lA(n),i=Date.now(),s="singleClick";i-n.input.lastClick.time<500&&wst(e,n.input.lastClick)&&!e[U4]&&n.input.lastClick.button==e.button&&(n.input.lastClick.type=="singleClick"?s="doubleClick":n.input.lastClick.type=="doubleClick"&&(s="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:s,button:e.button};let o=n.posAtCoords(d_(e));o&&(s=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new Dst(n,o,e,!!r)):(s=="doubleClick"?Ast:kst)(n,o.pos,o.inside,e)?e.preventDefault():al(n,"pointer"))};class Dst{constructor(t,e,r,i){this.view=t,this.pos=e,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!r[U4],this.allowDefault=r.shiftKey;let s,o;if(e.inside>-1)s=t.state.doc.nodeAt(e.inside),o=e.inside;else{let d=t.state.doc.resolve(e.pos);s=d.parent,o=d.depth?d.before():0}const l=i?null:r.target,u=l?t.docView.nearestDesc(l,!0):null;this.target=u&&u.nodeDOM.nodeType==1?u.nodeDOM:null;let{selection:h}=t.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||h instanceof Dt&&h.from<=o&&h.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Di&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),al(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>qo(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(d_(t))),this.updateAllowDefault(t),this.allowDefault||!e?al(this.view,"pointer"):Cst(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||lr&&this.mightDrag&&!this.mightDrag.node.isAtom||Jn&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(Bh(this.view,Wt.near(this.view.state.doc.resolve(e.pos))),t.preventDefault()):al(this.view,"pointer")}move(t){this.updateAllowDefault(t),al(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}Sr.touchstart=n=>{n.input.lastTouch=Date.now(),lA(n),al(n,"pointer")};Sr.touchmove=n=>{n.input.lastTouch=Date.now(),al(n,"pointer")};Sr.contextmenu=n=>lA(n);function z4(n,t){return n.composing?!0:lr&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const Ost=jo?5e3:-1;wr.compositionstart=wr.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$to;if(t.selection instanceof jt&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||Jn&&b4&&Rst(n)))n.markCursor=n.state.storedMarks||e.marks(),Nv(n,!0),n.markCursor=null;else if(Nv(n,!t.selection.empty),Di&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){let l=n.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else i=o,s=-1}}n.input.composing=!0}H4(n,Ost)};function Rst(n){let{focusNode:t,focusOffset:e}=n.domSelectionRange();if(!t||t.nodeType!=1||e>=t.childNodes.length)return!1;let r=t.childNodes[e];return r.nodeType==1&&r.contentEditable=="false"}wr.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.badSafariComposition?n.domObserver.forceFlush():n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,H4(n,20))};function H4(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>Nv(n),t))}function $4(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=Pst());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function Ist(n){let t=n.domSelectionRange();if(!t.focusNode)return null;let e=Eit(t.focusNode,t.focusOffset),r=Cit(t.focusNode,t.focusOffset);if(e&&r&&e!=r){let i=r.pmViewDesc,s=n.domObserver.lastChangedTextNode;if(e==s||r==s)return s;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=e.pmViewDesc;if(!(!o||!o.isText(e.nodeValue)))return r}}return e||r}function Pst(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Nv(n,t=!1){if(!(jo&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),$4(n),t||n.docView&&n.docView.dirty){let e=rA(n),r=n.state.selection;return e&&!e.eq(r)?n.dispatch(n.state.tr.setSelection(e)):(n.markCursor||t)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function Nst(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}const nm=jr&&pl<15||tf&&Dit<604;Sr.copy=wr.cut=(n,t)=>{let e=t,r=n.state.selection,i=e.type=="cut";if(r.empty)return;let s=nm?null:e.clipboardData,o=r.content(),{dom:l,text:u}=sA(n,o);s?(e.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",u)):Nst(n,l),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Lst(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function Vst(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),e?rm(n,r.value,null,i,t):rm(n,r.textContent,r.innerHTML,i,t)},50)}function rm(n,t,e,r,i){let s=N4(n,t,e,r,n.state.selection.$from);if(n.someProp("handlePaste",u=>u(n,i,s||vt.empty)))return!0;if(!s)return!1;let o=Lst(s),l=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(s);return n.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function q4(n){let t=n.getData("text/plain")||n.getData("Text");if(t)return t;let e=n.getData("text/uri-list");return e?e.replace(/\r?\n/g," "):""}wr.paste=(n,t)=>{let e=t;if(n.composing&&!jo)return;let r=nm?null:e.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&rm(n,q4(r),r.getData("text/html"),i,e)?e.preventDefault():Vst(n,e)};class W4{constructor(t,e,r){this.slice=t,this.move=e,this.node=r}}const jst=Ei?"altKey":"ctrlKey";function G4(n,t){let e=n.someProp("dragCopies",r=>!r(t));return e??!t[jst]}Sr.dragstart=(n,t)=>{let e=t,r=n.input.mouseDown;if(r&&r.done(),!e.dataTransfer)return;let i=n.state.selection,s=i.empty?null:n.posAtCoords(d_(e)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof Dt?i.to-1:i.to))){if(r&&r.mightDrag)o=Dt.create(n.state.doc,r.mightDrag.pos);else if(e.target&&e.target.nodeType==1){let p=n.docView.nearestDesc(e.target,!0);p&&p.node.type.spec.draggable&&p!=n.docView&&(o=Dt.create(n.state.doc,p.posBefore))}}let l=(o||n.state.selection).content(),{dom:u,text:h,slice:d}=sA(n,l);(!e.dataTransfer.files.length||!Jn||v4>120)&&e.dataTransfer.clearData(),e.dataTransfer.setData(nm?"Text":"text/html",u.innerHTML),e.dataTransfer.effectAllowed="copyMove",nm||e.dataTransfer.setData("text/plain",h),n.dragging=new W4(d,G4(n,e),o)};Sr.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)};wr.dragover=wr.dragenter=(n,t)=>t.preventDefault();wr.drop=(n,t)=>{try{Fst(n,t,n.dragging)}finally{n.dragging=null}};function Fst(n,t,e){if(!t.dataTransfer)return;let r=n.posAtCoords(d_(t));if(!r)return;let i=n.state.doc.resolve(r.pos),s=e&&e.slice;s?n.someProp("transformPasted",v=>{s=v(s,n,!1)}):s=N4(n,q4(t.dataTransfer),nm?null:t.dataTransfer.getData("text/html"),!1,i);let o=!!(e&&G4(n,t));if(n.someProp("handleDrop",v=>v(n,t,s||vt.empty,o))){t.preventDefault();return}if(!s)return;t.preventDefault();let l=s?QB(n.state.doc,i.pos,s):i.pos;l==null&&(l=i.pos);let u=n.state.tr;if(o){let{node:v}=e;v?v.replace(u):u.deleteSelection()}let h=u.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,p=u.doc;if(d?u.replaceRangeWith(h,h,s.content.firstChild):u.replaceRange(h,h,s),u.doc.eq(p))return;let g=u.doc.resolve(h);if(d&&Dt.isSelectable(s.content.firstChild)&&g.nodeAfter&&g.nodeAfter.sameMarkup(s.content.firstChild))u.setSelection(new Dt(g));else{let v=u.mapping.map(l);u.mapping.maps[u.mapping.maps.length-1].forEach((T,S,w,E)=>v=E),u.setSelection(iA(n,g,u.doc.resolve(v)))}n.focus(),n.dispatch(u.setMeta("uiEvent","drop"))}Sr.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&qo(n)},20))};Sr.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Sr.beforeinput=(n,t)=>{if(Jn&&jo&&t.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",s=>s(n,Mc(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in wr)Sr[n]=wr[n];function im(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class Lv{constructor(t,e){this.toDOM=t,this.spec=e||Yc,this.side=this.spec.side||0}map(t,e,r,i){let{pos:s,deleted:o}=t.mapResult(e.from+i,this.side<0?-1:1);return o?null:new Tr(s-r,s-r,this)}valid(){return!0}eq(t){return this==t||t instanceof Lv&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&im(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class gl{constructor(t,e){this.attrs=t,this.spec=e||Yc}map(t,e,r,i){let s=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-r,o=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new Tr(s,o,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof gl&&im(this.attrs,t.attrs)&&im(this.spec,t.spec)}static is(t){return t.type instanceof gl}destroy(){}}class cA{constructor(t,e){this.attrs=t,this.spec=e||Yc}map(t,e,r,i){let s=t.mapResult(e.from+i,1);if(s.deleted)return null;let o=t.mapResult(e.to+i,-1);return o.deleted||o.pos<=s.pos?null:new Tr(s.pos-r,o.pos-r,this)}valid(t,e){let{index:r,offset:i}=t.content.findIndex(e.from),s;return i==e.from&&!(s=t.child(r)).isText&&i+s.nodeSize==e.to}eq(t){return this==t||t instanceof cA&&im(this.attrs,t.attrs)&&im(this.spec,t.spec)}destroy(){}}class Tr{constructor(t,e,r){this.from=t,this.to=e,this.type=r}copy(t,e){return new Tr(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,r){return this.type.map(t,this,e,r)}static widget(t,e,r){return new Tr(t,t,new Lv(e,r))}static inline(t,e,r,i){return new Tr(t,e,new gl(r,i))}static node(t,e,r,i){return new Tr(t,e,new cA(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof gl}get widget(){return this.type instanceof Lv}}const vh=[],Yc={};class Ue{constructor(t,e){this.local=t.length?t:vh,this.children=e.length?e:vh}static create(t,e){return e.length?Vv(e,t,0,Yc):rr}find(t,e,r){let i=[];return this.findInner(t??0,e??1e9,i,0,r),i}findInner(t,e,r,i,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=e&&l.to>=t&&(!s||s(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<e&&this.children[o+1]>t){let l=this.children[o]+1;this.children[o+2].findInner(t-l,e-l,r,i+l,s)}}map(t,e,r){return this==rr||t.maps.length==0?this:this.mapInner(t,e,0,0,r||Yc)}mapInner(t,e,r,i,s){let o;for(let l=0;l<this.local.length;l++){let u=this.local[l].map(t,r,i);u&&u.type.valid(e,u)?(o||(o=[])).push(u):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?Bst(this.children,o||[],t,e,r,i,s):o?new Ue(o.sort(Kc),vh):rr}add(t,e){return e.length?this==rr?Ue.create(t,e):this.addInner(t,e,0):this}addInner(t,e,r){let i,s=0;t.forEach((l,u)=>{let h=u+r,d;if(d=K4(e,l,h)){for(i||(i=this.children.slice());s<i.length&&i[s]<u;)s+=3;i[s]==u?i[s+2]=i[s+2].addInner(l,d,h+1):i.splice(s,0,u,u+l.nodeSize,Vv(d,l,h+1,Yc)),s+=3}});let o=Y4(s?X4(e):e,-r);for(let l=0;l<o.length;l++)o[l].type.valid(t,o[l])||o.splice(l--,1);return new Ue(o.length?this.local.concat(o).sort(Kc):this.local,i||this.children)}remove(t){return t.length==0||this==rr?this:this.removeInner(t,0)}removeInner(t,e){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,l=r[s]+e,u=r[s+1]+e;for(let d=0,p;d<t.length;d++)(p=t[d])&&p.from>l&&p.to<u&&(t[d]=null,(o||(o=[])).push(p));if(!o)continue;r==this.children&&(r=this.children.slice());let h=r[s+2].removeInner(o,l+1);h!=rr?r[s+2]=h:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<t.length;s++)if(o=t[s])for(let l=0;l<i.length;l++)i[l].eq(o,e)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Ue(i,r):rr}forChild(t,e){if(this==rr)return this;if(e.isLeaf)return Ue.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=t){this.children[l]==t&&(r=this.children[l+2]);break}let s=t+1,o=s+e.content.size;for(let l=0;l<this.local.length;l++){let u=this.local[l];if(u.from<o&&u.to>s&&u.type instanceof gl){let h=Math.max(s,u.from)-s,d=Math.min(o,u.to)-s;h<d&&(i||(i=[])).push(u.copy(h,d))}}if(i){let l=new Ue(i.sort(Kc),vh);return r?new tl([l,r]):l}return r||rr}eq(t){if(this==t)return!0;if(!(t instanceof Ue)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return uA(this.localsInner(t))}localsInner(t){if(this==rr)return vh;if(t.inlineContent||!this.local.some(gl.is))return this.local;let e=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof gl||e.push(this.local[r]);return e}forEachSet(t){t(this)}}Ue.empty=new Ue([],[]);Ue.removeOverlap=uA;const rr=Ue.empty;class tl{constructor(t){this.members=t}map(t,e){const r=this.members.map(i=>i.map(t,e,Yc));return tl.from(r)}forChild(t,e){if(e.isLeaf)return Ue.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(t,e);s!=rr&&(s instanceof tl?r=r.concat(s.members):r.push(s))}return tl.from(r)}eq(t){if(!(t instanceof tl)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(t);if(s.length)if(!e)e=s;else{r&&(e=e.slice(),r=!1);for(let o=0;o<s.length;o++)e.push(s[o])}}return e?uA(r?e:e.sort(Kc)):vh}static from(t){switch(t.length){case 0:return rr;case 1:return t[0];default:return new tl(t.every(e=>e instanceof Ue)?t:t.reduce((e,r)=>e.concat(r instanceof Ue?r:r.members),[]))}}forEachSet(t){for(let e=0;e<this.members.length;e++)this.members[e].forEachSet(t)}}function Bst(n,t,e,r,i,s,o){let l=n.slice();for(let h=0,d=s;h<e.maps.length;h++){let p=0;e.maps[h].forEach((g,v,T,S)=>{let w=S-T-(v-g);for(let E=0;E<l.length;E+=3){let D=l[E+1];if(D<0||g>D+d-p)continue;let P=l[E]+d-p;v>=P?l[E+1]=g<=P?-2:-1:g>=d&&w&&(l[E]+=w,l[E+1]+=w)}p+=w}),d=e.maps[h].map(d,-1)}let u=!1;for(let h=0;h<l.length;h+=3)if(l[h+1]<0){if(l[h+1]==-2){u=!0,l[h+1]=-1;continue}let d=e.map(n[h]+s),p=d-i;if(p<0||p>=r.content.size){u=!0;continue}let g=e.map(n[h+1]+s,-1),v=g-i,{index:T,offset:S}=r.content.findIndex(p),w=r.maybeChild(T);if(w&&S==p&&S+w.nodeSize==v){let E=l[h+2].mapInner(e,w,d+1,n[h]+s+1,o);E!=rr?(l[h]=p,l[h+1]=v,l[h+2]=E):(l[h+1]=-2,u=!0)}else u=!0}if(u){let h=Ust(l,n,t,e,i,s,o),d=Vv(h,r,0,o);t=d.local;for(let p=0;p<l.length;p+=3)l[p+1]<0&&(l.splice(p,3),p-=3);for(let p=0,g=0;p<d.children.length;p+=3){let v=d.children[p];for(;g<l.length&&l[g]<v;)g+=3;l.splice(g,0,d.children[p],d.children[p+1],d.children[p+2])}}return new Ue(t.sort(Kc),l)}function Y4(n,t){if(!t||!n.length)return n;let e=[];for(let r=0;r<n.length;r++){let i=n[r];e.push(new Tr(i.from+t,i.to+t,i.type))}return e}function Ust(n,t,e,r,i,s,o){function l(u,h){for(let d=0;d<u.local.length;d++){let p=u.local[d].map(r,i,h);p?e.push(p):o.onRemove&&o.onRemove(u.local[d].spec)}for(let d=0;d<u.children.length;d+=3)l(u.children[d+2],u.children[d]+h+1)}for(let u=0;u<n.length;u+=3)n[u+1]==-1&&l(n[u+2],t[u]+s+1);return e}function K4(n,t,e){if(t.isLeaf)return null;let r=e+t.nodeSize,i=null;for(let s=0,o;s<n.length;s++)(o=n[s])&&o.from>e&&o.to<r&&((i||(i=[])).push(o),n[s]=null);return i}function X4(n){let t=[];for(let e=0;e<n.length;e++)n[e]!=null&&t.push(n[e]);return t}function Vv(n,t,e,r){let i=[],s=!1;t.forEach((l,u)=>{let h=K4(n,l,u+e);if(h){s=!0;let d=Vv(h,l,e+u+1,r);d!=rr&&i.push(u,u+l.nodeSize,d)}});let o=Y4(s?X4(n):n,-e).sort(Kc);for(let l=0;l<o.length;l++)o[l].type.valid(t,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||i.length?new Ue(o,i):rr}function Kc(n,t){return n.from-t.from||n.to-t.to}function uA(n){let t=n;for(let e=0;e<t.length-1;e++){let r=t[e];if(r.from!=r.to)for(let i=e+1;i<t.length;i++){let s=t[i];if(s.from==r.from){s.to!=r.to&&(t==n&&(t=n.slice()),t[i]=s.copy(s.from,r.to),IP(t,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(t==n&&(t=n.slice()),t[e]=r.copy(r.from,s.from),IP(t,i,r.copy(s.from,r.to)));break}}}return t}function IP(n,t,e){for(;t<n.length&&Kc(e,n[t])>0;)t++;n.splice(t,0,e)}function Iw(n){let t=[];return n.someProp("decorations",e=>{let r=e(n.state);r&&r!=rr&&t.push(r)}),n.cursorWrapper&&t.push(Ue.create(n.state.doc,[n.cursorWrapper.deco])),tl.from(t)}const zst={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Hst=jr&&pl<=11;class $st{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class qst{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new $st,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);jr&&pl<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():lr&&t.composing&&r.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(t.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),Hst&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,zst)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(EP(this.view)){if(this.suppressingSelectionUpdates)return qo(this.view);if(jr&&pl<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&cu(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e=new Set,r;for(let s=t.focusNode;s;s=Zh(s))e.add(s);for(let s=t.anchorNode;s;s=Zh(s))if(e.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.pendingRecords();e.length&&(this.queue=[]);let r=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&EP(t)&&!this.ignoreSelectionChange(r),s=-1,o=-1,l=!1,u=[];if(t.editable)for(let d=0;d<e.length;d++){let p=this.registerMutation(e[d],u);p&&(s=s<0?p.from:Math.min(p.from,s),o=o<0?p.to:Math.max(p.to,o),p.typeOver&&(l=!0))}if(u.some(d=>d.nodeName=="BR")&&(t.input.lastKeyCode==8||t.input.lastKeyCode==46)){for(let d of u)if(d.nodeName=="BR"&&d.parentNode){let p=d.nextSibling;p&&p.nodeType==1&&p.contentEditable=="false"&&d.parentNode.removeChild(d)}}else if(Di&&u.length){let d=u.filter(p=>p.nodeName=="BR");if(d.length==2){let[p,g]=d;p.parentNode&&p.parentNode.parentNode==g.parentNode?g.remove():p.remove()}else{let{focusNode:p}=this.currentSelection;for(let g of d){let v=g.parentNode;v&&v.nodeName=="LI"&&(!p||Yst(t,p)!=v)&&g.remove()}}}let h=null;s<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&h_(r)&&(h=rA(t))&&h.eq(Wt.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,qo(t),this.currentSelection.set(r),t.scrollToSelection()):(s>-1||i)&&(s>-1&&(t.docView.markDirty(s,o),Wst(t)),t.input.badSafariComposition&&(t.input.badSafariComposition=!1,Kst(t,u)),this.handleDOMChange(s,o,l,u),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||qo(t),this.currentSelection.set(r))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let r=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(r==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if(t.type=="childList"){for(let d=0;d<t.addedNodes.length;d++){let p=t.addedNodes[d];e.push(p),p.nodeType==3&&(this.lastChangedTextNode=p)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};let i=t.previousSibling,s=t.nextSibling;if(jr&&pl<=11&&t.addedNodes.length)for(let d=0;d<t.addedNodes.length;d++){let{previousSibling:p,nextSibling:g}=t.addedNodes[d];(!p||Array.prototype.indexOf.call(t.addedNodes,p)<0)&&(i=p),(!g||Array.prototype.indexOf.call(t.addedNodes,g)<0)&&(s=g)}let o=i&&i.parentNode==t.target?Kn(i)+1:0,l=r.localPosFromDOM(t.target,o,-1),u=s&&s.parentNode==t.target?Kn(s):t.target.childNodes.length,h=r.localPosFromDOM(t.target,u,1);return{from:l,to:h}}else return t.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=t.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let PP=new WeakMap,NP=!1;function Wst(n){if(!PP.has(n)&&(PP.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Di,NP)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),NP=!0}}function LP(n,t){let e=t.startContainer,r=t.startOffset,i=t.endContainer,s=t.endOffset,o=n.domAtPos(n.state.selection.anchor);return cu(o.node,o.offset,i,s)&&([e,r,i,s]=[i,s,e,r]),{anchorNode:e,anchorOffset:r,focusNode:i,focusOffset:s}}function Gst(n,t){if(t.getComposedRanges){let i=t.getComposedRanges(n.root)[0];if(i)return LP(n,i)}let e;function r(i){i.preventDefault(),i.stopImmediatePropagation(),e=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),e?LP(n,e):null}function Yst(n,t){for(let e=t.parentNode;e&&e!=n.dom;e=e.parentNode){let r=n.docView.nearestDesc(e,!0);if(r&&r.node.isBlock)return e}return null}function Kst(n,t){var e;let{focusNode:r,focusOffset:i}=n.domSelectionRange();for(let s of t)if(((e=s.parentNode)===null||e===void 0?void 0:e.nodeName)=="TR"){let o=s.nextSibling;for(;o&&o.nodeName!="TD"&&o.nodeName!="TH";)o=o.nextSibling;if(o){let l=o;for(;;){let u=l.firstChild;if(!u||u.nodeType!=1||u.contentEditable=="false"||/^(BR|IMG)$/.test(u.nodeName))break;l=u}l.insertBefore(s,l.firstChild),r==s&&n.domSelection().collapse(s,i)}else s.parentNode.removeChild(s)}}function Xst(n,t,e){let{node:r,fromOffset:i,toOffset:s,from:o,to:l}=n.docView.parseRange(t,e),u=n.domSelectionRange(),h,d=u.anchorNode;if(d&&n.dom.contains(d.nodeType==1?d:d.parentNode)&&(h=[{node:d,offset:u.anchorOffset}],h_(u)||h.push({node:u.focusNode,offset:u.focusOffset})),Jn&&n.input.lastKeyCode===8)for(let w=s;w>i;w--){let E=r.childNodes[w-1],D=E.pmViewDesc;if(E.nodeName=="BR"&&!D){s=w;break}if(!D||D.size)break}let p=n.state.doc,g=n.someProp("domParser")||dl.fromSchema(n.state.schema),v=p.resolve(o),T=null,S=g.parse(r,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:i,to:s,preserveWhitespace:v.parent.type.whitespace=="pre"?"full":!0,findPositions:h,ruleFromNode:Qst,context:v});if(h&&h[0].pos!=null){let w=h[0].pos,E=h[1]&&h[1].pos;E==null&&(E=w),T={anchor:w+o,head:E+o}}return{doc:S,sel:T,from:o,to:l}}function Qst(n){let t=n.pmViewDesc;if(t)return t.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(lr&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(n.parentNode.lastChild==n||lr&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Jst=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Zst(n,t,e,r,i){let s=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,t<0){let M=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,k=rA(n,M);if(k&&!n.state.selection.eq(k)){if(Jn&&jo&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",F=>F(n,Mc(13,"Enter"))))return;let R=n.state.tr.setSelection(k);M=="pointer"?R.setMeta("pointer",!0):M=="key"&&R.scrollIntoView(),s&&R.setMeta("composition",s),n.dispatch(R)}return}let o=n.state.doc.resolve(t),l=o.sharedDepth(e);t=o.before(l+1),e=n.state.doc.resolve(e).after(l+1);let u=n.state.selection,h=Xst(n,t,e),d=n.state.doc,p=d.slice(h.from,h.to),g,v;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(g=n.state.selection.to,v="end"):(g=n.state.selection.from,v="start"),n.input.lastKeyCode=null;let T=not(p.content,h.doc.content,h.from,g,v);if(T&&n.input.domChangeCount++,(tf&&n.input.lastIOSEnter>Date.now()-225||jo)&&i.some(M=>M.nodeType==1&&!Jst.test(M.nodeName))&&(!T||T.endA>=T.endB)&&n.someProp("handleKeyDown",M=>M(n,Mc(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!T)if(r&&u instanceof jt&&!u.empty&&u.$head.sameParent(u.$anchor)&&!n.composing&&!(h.sel&&h.sel.anchor!=h.sel.head))T={start:u.from,endA:u.to,endB:u.to};else{if(h.sel){let M=VP(n,n.state.doc,h.sel);if(M&&!M.eq(n.state.selection)){let k=n.state.tr.setSelection(M);s&&k.setMeta("composition",s),n.dispatch(k)}}return}n.state.selection.from<n.state.selection.to&&T.start==T.endB&&n.state.selection instanceof jt&&(T.start>n.state.selection.from&&T.start<=n.state.selection.from+2&&n.state.selection.from>=h.from?T.start=n.state.selection.from:T.endA<n.state.selection.to&&T.endA>=n.state.selection.to-2&&n.state.selection.to<=h.to&&(T.endB+=n.state.selection.to-T.endA,T.endA=n.state.selection.to)),jr&&pl<=11&&T.endB==T.start+1&&T.endA==T.start&&T.start>h.from&&h.doc.textBetween(T.start-h.from-1,T.start-h.from+1)==" "&&(T.start--,T.endA--,T.endB--);let S=h.doc.resolveNoCache(T.start-h.from),w=h.doc.resolveNoCache(T.endB-h.from),E=d.resolve(T.start),D=S.sameParent(w)&&S.parent.inlineContent&&E.end()>=T.endA;if((tf&&n.input.lastIOSEnter>Date.now()-225&&(!D||i.some(M=>M.nodeName=="DIV"||M.nodeName=="P"))||!D&&S.pos<h.doc.content.size&&(!S.sameParent(w)||!S.parent.inlineContent)&&S.pos<w.pos&&!/\S/.test(h.doc.textBetween(S.pos,w.pos,"","")))&&n.someProp("handleKeyDown",M=>M(n,Mc(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>T.start&&eot(d,T.start,T.endA,S,w)&&n.someProp("handleKeyDown",M=>M(n,Mc(8,"Backspace")))){jo&&Jn&&n.domObserver.suppressSelectionUpdates();return}Jn&&T.endB==T.start&&(n.input.lastChromeDelete=Date.now()),jo&&!D&&S.start()!=w.start()&&w.parentOffset==0&&S.depth==w.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==T.endA&&(T.endB-=2,w=h.doc.resolveNoCache(T.endB-h.from),setTimeout(()=>{n.someProp("handleKeyDown",function(M){return M(n,Mc(13,"Enter"))})},20));let P=T.start,V=T.endA,N=M=>{let k=M||n.state.tr.replace(P,V,h.doc.slice(T.start-h.from,T.endB-h.from));if(h.sel){let R=VP(n,k.doc,h.sel);R&&!(Jn&&n.composing&&R.empty&&(T.start!=T.endB||n.input.lastChromeDelete<Date.now()-100)&&(R.head==P||R.head==k.mapping.map(V)-1)||jr&&R.empty&&R.head==P)&&k.setSelection(R)}return s&&k.setMeta("composition",s),k.scrollIntoView()},q;if(D)if(S.pos==w.pos){jr&&pl<=11&&S.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>qo(n),20));let M=N(n.state.tr.delete(P,V)),k=d.resolve(T.start).marksAcross(d.resolve(T.endA));k&&M.ensureMarks(k),n.dispatch(M)}else if(T.endA==T.endB&&(q=tot(S.parent.content.cut(S.parentOffset,w.parentOffset),E.parent.content.cut(E.parentOffset,T.endA-E.start())))){let M=N(n.state.tr);q.type=="add"?M.addMark(P,V,q.mark):M.removeMark(P,V,q.mark),n.dispatch(M)}else if(S.parent.child(S.index()).isText&&S.index()==w.index()-(w.textOffset?0:1)){let M=S.parent.textBetween(S.parentOffset,w.parentOffset),k=()=>N(n.state.tr.insertText(M,P,V));n.someProp("handleTextInput",R=>R(n,P,V,M,k))||n.dispatch(k())}else n.dispatch(N());else n.dispatch(N())}function VP(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:iA(n,t.resolve(e.anchor),t.resolve(e.head))}function tot(n,t){let e=n.firstChild.marks,r=t.firstChild.marks,i=e,s=r,o,l,u;for(let d=0;d<r.length;d++)i=r[d].removeFromSet(i);for(let d=0;d<e.length;d++)s=e[d].removeFromSet(s);if(i.length==1&&s.length==0)l=i[0],o="add",u=d=>d.mark(l.addToSet(d.marks));else if(i.length==0&&s.length==1)l=s[0],o="remove",u=d=>d.mark(l.removeFromSet(d.marks));else return null;let h=[];for(let d=0;d<t.childCount;d++)h.push(u(t.child(d)));if(ut.from(h).eq(n))return{mark:l,type:o}}function eot(n,t,e,r,i){if(e-t<=i.pos-r.pos||Pw(r,!0,!1)<i.pos)return!1;let s=n.resolve(t);if(!r.parent.isTextblock){let l=s.nodeAfter;return l!=null&&e==t+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=n.resolve(Pw(s,!0,!0));return!o.parent.isTextblock||o.pos>e||Pw(o,!0,!1)<e?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Pw(n,t,e){let r=n.depth,i=t?n.end():n.pos;for(;r>0&&(t||n.indexAfter(r)==n.node(r).childCount);)r--,i++,t=!1;if(e){let s=n.node(r).maybeChild(n.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function not(n,t,e,r,i){let s=n.findDiffStart(t,e);if(s==null)return null;let{a:o,b:l}=n.findDiffEnd(t,e+n.size,e+t.size);if(i=="end"){let u=Math.max(0,s-Math.min(o,l));r-=o+u-s}if(o<s&&n.size<t.size){let u=r<=s&&r>=o?s-r:0;s-=u,s&&s<t.size&&jP(t.textBetween(s-1,s+1))&&(s+=u?1:-1),l=s+(l-o),o=s}else if(l<s){let u=r<=s&&r>=l?s-r:0;s-=u,s&&s<n.size&&jP(n.textBetween(s-1,s+1))&&(s+=u?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function jP(n){if(n.length!=2)return!1;let t=n.charCodeAt(0),e=n.charCodeAt(1);return t>=56320&&t<=57343&&e>=55296&&e<=56319}class Q4{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new vst,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(HP),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=UP(this),BP(this),this.nodeViews=zP(this),this.docView=bP(this.state.doc,FP(this),Iw(this),this.dom,this),this.domObserver=new qst(this,(r,i,s,o)=>Zst(this,r,i,s,o)),this.domObserver.start(),bst(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&AE(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(HP),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let r in this._props)e[r]=this._props[r];e.state=this.state;for(let r in t)e[r]=t[r];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){var r;let i=this.state,s=!1,o=!1;t.storedMarks&&this.composing&&($4(this),o=!0),this.state=t;let l=i.plugins!=t.plugins||this._props.plugins!=e.plugins;if(l||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let v=zP(this);iot(v,this.nodeViews)&&(this.nodeViews=v,s=!0)}(l||e.handleDOMEvents!=this._props.handleDOMEvents)&&AE(this),this.editable=UP(this),BP(this);let u=Iw(this),h=FP(this),d=i.plugins!=t.plugins&&!i.doc.eq(t.doc)?"reset":t.scrollToSelection>i.scrollToSelection?"to selection":"preserve",p=s||!this.docView.matchesNode(t.doc,h,u);(p||!t.selection.eq(i.selection))&&(o=!0);let g=d=="preserve"&&o&&this.dom.style.overflowAnchor==null&&Iit(this);if(o){this.domObserver.stop();let v=p&&(jr||Jn)&&!this.composing&&!i.selection.empty&&!t.selection.empty&&rot(i.selection,t.selection);if(p){let T=Jn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Ist(this)),(s||!this.docView.update(t.doc,h,u,this))&&(this.docView.updateOuterDeco(h),this.docView.destroy(),this.docView=bP(t.doc,h,u,this.dom,this)),T&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&rst(this))?qo(this,v):(R4(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,i),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():g&&Pit(g)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))){if(!this.someProp("handleScrollToSelection",e=>e(this)))if(this.state.selection instanceof Dt){let e=this.docView.domAfterPos(this.state.selection.from);e.nodeType==1&&dP(this,e.getBoundingClientRect(),t)}else dP(this,this.coordsAtPos(this.state.selection.head,1),t)}}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let r=this.directPlugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let r=this.state.plugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let e=0;e<this.pluginViews.length;e++){let r=this.pluginViews[e];r.update&&r.update(this,t)}}updateDraggedNode(t,e){let r=t.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let s=r.from+(this.state.doc.content.size-e.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(i=s)}this.dragging=new W4(t.slice,t.move,i<0?void 0:Dt.create(this.state.doc,i))}someProp(t,e){let r=this._props&&this._props[t],i;if(r!=null&&(i=e?e(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[t];if(l!=null&&(i=e?e(l):l))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[t];if(l!=null&&(i=e?e(l):l))return i}}hasFocus(){if(jr){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&Nit(this.dom),qo(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let e=this.dom.parentNode;e;e=e.parentNode)if(e.nodeType==9||e.nodeType==11&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return t||document}updateRoot(){this._root=null}posAtCoords(t){return Bit(this,t)}coordsAtPos(t,e=1){return x4(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,r=-1){let i=this.docView.posFromDOM(t,e,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return qit(this,e||this.state,t)}pasteHTML(t,e){return rm(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return rm(this,t,null,!0,e||new ClipboardEvent("paste"))}serializeForClipboard(t){return sA(this,t)}destroy(){this.docView&&(_st(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Iw(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,wit())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return Sst(this,t)}domSelectionRange(){let t=this.domSelection();return t?lr&&this.root.nodeType===11&&kit(this.dom.ownerDocument)==this.dom&&Gst(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}Q4.prototype.dispatch=function(n){let t=this._props.dispatchTransaction;t?t.call(this,n):this.updateState(this.state.apply(n))};function FP(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),n.someProp("attributes",e=>{if(typeof e=="function"&&(e=e(n.state)),e)for(let r in e)r=="class"?t.class+=" "+e[r]:r=="style"?t.style=(t.style?t.style+";":"")+e[r]:!t[r]&&r!="contenteditable"&&r!="nodeName"&&(t[r]=String(e[r]))}),t.translate||(t.translate="no"),[Tr.node(0,n.state.doc.content.size,t)]}function BP(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:Tr.widget(n.state.selection.from,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function UP(n){return!n.someProp("editable",t=>t(n.state)===!1)}function rot(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}function zP(n){let t=Object.create(null);function e(r){for(let i in r)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=r[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function iot(n,t){let e=0,r=0;for(let i in n){if(n[i]!=t[i])return!0;e++}for(let i in t)r++;return e!=r}function HP(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var El={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},jv={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},sot=typeof navigator<"u"&&/Mac/.test(navigator.platform),oot=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Xn=0;Xn<10;Xn++)El[48+Xn]=El[96+Xn]=String(Xn);for(var Xn=1;Xn<=24;Xn++)El[Xn+111]="F"+Xn;for(var Xn=65;Xn<=90;Xn++)El[Xn]=String.fromCharCode(Xn+32),jv[Xn]=String.fromCharCode(Xn);for(var Nw in El)jv.hasOwnProperty(Nw)||(jv[Nw]=El[Nw]);function aot(n){var t=sot&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||oot&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",e=!t&&n.key||(n.shiftKey?jv:El)[n.keyCode]||n.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}const lot=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),cot=typeof navigator<"u"&&/Win/.test(navigator.platform);function uot(n){let t=n.split(/-(?!$)/),e=t[t.length-1];e=="Space"&&(e=" ");let r,i,s,o;for(let l=0;l<t.length-1;l++){let u=t[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))s=!0;else if(/^mod$/i.test(u))lot?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+u)}return r&&(e="Alt-"+e),i&&(e="Ctrl-"+e),o&&(e="Meta-"+e),s&&(e="Shift-"+e),e}function hot(n){let t=Object.create(null);for(let e in n)t[uot(e)]=n[e];return t}function Lw(n,t,e=!0){return t.altKey&&(n="Alt-"+n),t.ctrlKey&&(n="Ctrl-"+n),t.metaKey&&(n="Meta-"+n),e&&t.shiftKey&&(n="Shift-"+n),n}function fot(n){return new $e({props:{handleKeyDown:J4(n)}})}function J4(n){let t=hot(n);return function(e,r){let i=aot(r),s,o=t[Lw(i,r)];if(o&&o(e.state,e.dispatch,e))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=t[Lw(i,r,!1)];if(l&&l(e.state,e.dispatch,e))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(cot&&r.ctrlKey&&r.altKey)&&(s=El[r.keyCode])&&s!=i){let l=t[Lw(s,r)];if(l&&l(e.state,e.dispatch,e))return!0}}return!1}}var dot=Object.defineProperty,hA=(n,t)=>{for(var e in t)dot(n,e,{get:t[e],enumerable:!0})};function p_(n){const{state:t,transaction:e}=n;let{selection:r}=e,{doc:i}=e,{storedMarks:s}=e;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=e.selection,i=e.doc,s=e.storedMarks,e}}}var m_=class{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:t,state:e}=this,{view:r}=t,{tr:i}=e,s=this.buildProps(i);return Object.fromEntries(Object.entries(n).map(([o,l])=>[o,(...h)=>{const d=l(...h)(s);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,t=!0){const{rawCommands:e,editor:r,state:i}=this,{view:s}=r,o=[],l=!!n,u=n||i.tr,h=()=>(!l&&t&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(u),o.every(p=>p===!0)),d={...Object.fromEntries(Object.entries(e).map(([p,g])=>[p,(...T)=>{const S=this.buildProps(u,t),w=g(...T)(S);return o.push(w),d}])),run:h};return d}createCan(n){const{rawCommands:t,state:e}=this,r=!1,i=n||e.tr,s=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(t).map(([l,u])=>[l,(...h)=>u(...h)({...s,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(n,t=!0){const{rawCommands:e,editor:r,state:i}=this,{view:s}=r,o={tr:n,editor:r,view:s,state:p_({state:i,transaction:n}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(n,t),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(e).map(([l,u])=>[l,(...h)=>u(...h)(o)]))}};return o}},Z4={};hA(Z4,{blur:()=>pot,clearContent:()=>mot,clearNodes:()=>got,command:()=>yot,createParagraphNear:()=>vot,cut:()=>bot,deleteCurrentNode:()=>_ot,deleteNode:()=>Tot,deleteRange:()=>Sot,deleteSelection:()=>wot,enter:()=>xot,exitCode:()=>Eot,extendMarkRange:()=>Cot,first:()=>Aot,focus:()=>Mot,forEach:()=>Dot,insertContent:()=>Oot,insertContentAt:()=>Pot,joinBackward:()=>Vot,joinDown:()=>Lot,joinForward:()=>jot,joinItemBackward:()=>Fot,joinItemForward:()=>Bot,joinTextblockBackward:()=>Uot,joinTextblockForward:()=>zot,joinUp:()=>Not,keyboardShortcut:()=>$ot,lift:()=>qot,liftEmptyBlock:()=>Wot,liftListItem:()=>Got,newlineInCode:()=>Yot,resetAttributes:()=>Kot,scrollIntoView:()=>Xot,selectAll:()=>Qot,selectNodeBackward:()=>Jot,selectNodeForward:()=>Zot,selectParentNode:()=>tat,selectTextblockEnd:()=>eat,selectTextblockStart:()=>nat,setContent:()=>rat,setMark:()=>wat,setMeta:()=>xat,setNode:()=>Eat,setNodeSelection:()=>Cat,setTextDirection:()=>Aat,setTextSelection:()=>kat,sinkListItem:()=>Mat,splitBlock:()=>Dat,splitListItem:()=>Oat,toggleList:()=>Rat,toggleMark:()=>Iat,toggleNode:()=>Pat,toggleWrap:()=>Nat,undoInputRule:()=>Lat,unsetAllMarks:()=>Vat,unsetMark:()=>jat,unsetTextDirection:()=>Fat,updateAttributes:()=>Bat,wrapIn:()=>Uat,wrapInList:()=>zat});var pot=()=>({editor:n,view:t})=>(requestAnimationFrame(()=>{var e;n.isDestroyed||(t.dom.blur(),(e=window?.getSelection())==null||e.removeAllRanges())}),!0),mot=(n=!0)=>({commands:t})=>t.setContent("",{emitUpdate:n}),got=()=>({state:n,tr:t,dispatch:e})=>{const{selection:r}=t,{ranges:i}=r;return e&&i.forEach(({$from:s,$to:o})=>{n.doc.nodesBetween(s.pos,o.pos,(l,u)=>{if(l.type.isText)return;const{doc:h,mapping:d}=t,p=h.resolve(d.map(u)),g=h.resolve(d.map(u+l.nodeSize)),v=p.blockRange(g);if(!v)return;const T=_f(v);if(l.type.isTextblock){const{defaultType:S}=p.parent.contentMatchAt(p.index());t.setNodeMarkup(v.start,S)}(T||T===0)&&t.lift(v,T)})}),!0},yot=n=>t=>n(t),vot=()=>({state:n,dispatch:t})=>d4(n,t),bot=(n,t)=>({editor:e,tr:r})=>{const{state:i}=e,s=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(t);return r.insert(o,s.content),r.setSelection(new jt(r.doc.resolve(Math.max(o-1,0)))),!0},_ot=()=>({tr:n,dispatch:t})=>{const{selection:e}=n,r=e.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===r.type){if(t){const l=i.before(s),u=i.after(s);n.delete(l,u).scrollIntoView()}return!0}return!1};function Sn(n,t){if(typeof n=="string"){if(!t.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return t.nodes[n]}return n}var Tot=n=>({tr:t,state:e,dispatch:r})=>{const i=Sn(n,e.schema),s=t.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const u=s.before(o),h=s.after(o);t.delete(u,h).scrollIntoView()}return!0}return!1},Sot=n=>({tr:t,dispatch:e})=>{const{from:r,to:i}=n;return e&&t.delete(r,i),!0},wot=()=>({state:n,dispatch:t})=>QC(n,t),xot=()=>({commands:n})=>n.keyboardShortcut("Enter"),Eot=()=>({state:n,dispatch:t})=>lit(n,t);function fA(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function Fv(n,t,e={strict:!0}){const r=Object.keys(t);return r.length?r.every(i=>e.strict?t[i]===n[i]:fA(t[i])?t[i].test(n[i]):t[i]===n[i]):!0}function t5(n,t,e={}){return n.find(r=>r.type===t&&Fv(Object.fromEntries(Object.keys(e).map(i=>[i,r.attrs[i]])),e))}function $P(n,t,e={}){return!!t5(n,t,e)}function dA(n,t,e){var r;if(!n||!t)return;let i=n.parent.childAfter(n.parentOffset);if((!i.node||!i.node.marks.some(d=>d.type===t))&&(i=n.parent.childBefore(n.parentOffset)),!i.node||!i.node.marks.some(d=>d.type===t)||(e=e||((r=i.node.marks[0])==null?void 0:r.attrs),!t5([...i.node.marks],t,e)))return;let o=i.index,l=n.start()+i.offset,u=o+1,h=l+i.node.nodeSize;for(;o>0&&$P([...n.parent.child(o-1).marks],t,e);)o-=1,l-=n.parent.child(o).nodeSize;for(;u<n.parent.childCount&&$P([...n.parent.child(u).marks],t,e);)h+=n.parent.child(u).nodeSize,u+=1;return{from:l,to:h}}function na(n,t){if(typeof n=="string"){if(!t.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return t.marks[n]}return n}var Cot=(n,t={})=>({tr:e,state:r,dispatch:i})=>{const s=na(n,r.schema),{doc:o,selection:l}=e,{$from:u,from:h,to:d}=l;if(i){const p=dA(u,s,t);if(p&&p.from<=h&&p.to>=d){const g=jt.create(o,p.from,p.to);e.setSelection(g)}}return!0},Aot=n=>t=>{const e=typeof n=="function"?n(t):n;for(let r=0;r<e.length;r+=1)if(e[r](t))return!0;return!1};function e5(n){return n instanceof jt}function Fc(n=0,t=0,e=0){return Math.min(Math.max(n,t),e)}function n5(n,t=null){if(!t)return null;const e=Wt.atStart(n),r=Wt.atEnd(n);if(t==="start"||t===!0)return e;if(t==="end")return r;const i=e.from,s=r.to;return t==="all"?jt.create(n,Fc(0,i,s),Fc(n.content.size,i,s)):jt.create(n,Fc(t,i,s),Fc(t,i,s))}function qP(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Bv(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function kot(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var Mot=(n=null,t={})=>({editor:e,view:r,tr:i,dispatch:s})=>{t={scrollIntoView:!0,...t};const o=()=>{(Bv()||qP())&&r.dom.focus(),kot()&&!Bv()&&!qP()&&r.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{e.isDestroyed||(r.focus(),t?.scrollIntoView&&e.commands.scrollIntoView())})};try{if(r.hasFocus()&&n===null||n===!1)return!0}catch{return!1}if(s&&n===null&&!e5(e.state.selection))return o(),!0;const l=n5(i.doc,n)||e.state.selection,u=e.state.selection.eq(l);return s&&(u||i.setSelection(l),u&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},Dot=(n,t)=>e=>n.every((r,i)=>t(r,{...e,index:i})),Oot=(n,t)=>({tr:e,commands:r})=>r.insertContentAt({from:e.selection.from,to:e.selection.to},n,t),r5=n=>{const t=n.childNodes;for(let e=t.length-1;e>=0;e-=1){const r=t[e];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&r5(r)}return n};function Vy(n){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t=`<body>${n}</body>`,e=new window.DOMParser().parseFromString(t,"text/html").body;return r5(e)}function sm(n,t,e){if(n instanceof cs||n instanceof ut)return n;e={slice:!0,parseOptions:{},...e};const r=typeof n=="object"&&n!==null,i=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return ut.fromArray(n.map(l=>t.nodeFromJSON(l)));const o=t.nodeFromJSON(n);return e.errorOnInvalidContent&&o.check(),o}catch(s){if(e.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",s),sm("",t,e)}if(i){if(e.errorOnInvalidContent){let o=!1,l="";const u=new BB({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:h=>(o=!0,l=typeof h=="string"?h:h.outerHTML,null)}]}})});if(e.slice?dl.fromSchema(u).parseSlice(Vy(n),e.parseOptions):dl.fromSchema(u).parse(Vy(n),e.parseOptions),e.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const s=dl.fromSchema(t);return e.slice?s.parseSlice(Vy(n),e.parseOptions).content:s.parse(Vy(n),e.parseOptions)}return sm("",t,e)}function Rot(n,t,e){const r=n.steps.length-1;if(r<t)return;const i=n.steps[r];if(!(i instanceof Ln||i instanceof Vn))return;const s=n.mapping.maps[r];let o=0;s.forEach((l,u,h,d)=>{o===0&&(o=d)}),n.setSelection(Wt.near(n.doc.resolve(o),e))}var Iot=n=>!("type"in n),Pot=(n,t,e)=>({tr:r,dispatch:i,editor:s})=>{var o;if(i){e={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...e};let l;const u=w=>{s.emit("contentError",{editor:s,error:w,disableCollaboration:()=>{"collaboration"in s.storage&&typeof s.storage.collaboration=="object"&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},h={preserveWhitespace:"full",...e.parseOptions};if(!e.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{sm(t,s.schema,{parseOptions:h,errorOnInvalidContent:!0})}catch(w){u(w)}try{l=sm(t,s.schema,{parseOptions:h,errorOnInvalidContent:(o=e.errorOnInvalidContent)!=null?o:s.options.enableContentCheck})}catch(w){return u(w),!1}let{from:d,to:p}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},g=!0,v=!0;if((Iot(l)?l:[l]).forEach(w=>{w.check(),g=g?w.isText&&w.marks.length===0:!1,v=v?w.isBlock:!1}),d===p&&v){const{parent:w}=r.doc.resolve(d);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(d-=1,p+=1)}let S;if(g){if(Array.isArray(t))S=t.map(w=>w.text||"").join("");else if(t instanceof ut){let w="";t.forEach(E=>{E.text&&(w+=E.text)}),S=w}else typeof t=="object"&&t&&t.text?S=t.text:S=t;r.insertText(S,d,p)}else{S=l;const w=r.doc.resolve(d),E=w.node(),D=w.parentOffset===0,P=E.isText||E.isTextblock,V=E.content.size>0;D&&P&&V&&(d=Math.max(0,d-1)),r.replaceWith(d,p,S)}e.updateSelection&&Rot(r,r.steps.length-1,-1),e.applyInputRules&&r.setMeta("applyInputRules",{from:d,text:S}),e.applyPasteRules&&r.setMeta("applyPasteRules",{from:d,text:S})}return!0},Not=()=>({state:n,dispatch:t})=>sit(n,t),Lot=()=>({state:n,dispatch:t})=>oit(n,t),Vot=()=>({state:n,dispatch:t})=>o4(n,t),jot=()=>({state:n,dispatch:t})=>u4(n,t),Fot=()=>({state:n,dispatch:t,tr:e})=>{try{const r=l_(n.doc,n.selection.$from.pos,-1);return r==null?!1:(e.join(r,2),t&&t(e),!0)}catch{return!1}},Bot=()=>({state:n,dispatch:t,tr:e})=>{try{const r=l_(n.doc,n.selection.$from.pos,1);return r==null?!1:(e.join(r,2),t&&t(e),!0)}catch{return!1}},Uot=()=>({state:n,dispatch:t})=>rit(n,t),zot=()=>({state:n,dispatch:t})=>iit(n,t);function i5(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Hot(n){const t=n.split(/-(?!$)/);let e=t[t.length-1];e==="Space"&&(e=" ");let r,i,s,o;for(let l=0;l<t.length-1;l+=1){const u=t[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))s=!0;else if(/^mod$/i.test(u))Bv()||i5()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${u}`)}return r&&(e=`Alt-${e}`),i&&(e=`Ctrl-${e}`),o&&(e=`Meta-${e}`),s&&(e=`Shift-${e}`),e}var $ot=n=>({editor:t,view:e,tr:r,dispatch:i})=>{const s=Hot(n).split(/-(?!$)/),o=s.find(h=>!["Alt","Ctrl","Meta","Shift"].includes(h)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),u=t.captureTransaction(()=>{e.someProp("handleKeyDown",h=>h(e,l))});return u?.steps.forEach(h=>{const d=h.map(r.mapping);d&&i&&r.maybeStep(d)}),!0};function Cl(n,t,e={}){const{from:r,to:i,empty:s}=n.selection,o=t?Sn(t,n.schema):null,l=[];n.doc.nodesBetween(r,i,(p,g)=>{if(p.isText)return;const v=Math.max(r,g),T=Math.min(i,g+p.nodeSize);l.push({node:p,from:v,to:T})});const u=i-r,h=l.filter(p=>o?o.name===p.node.type.name:!0).filter(p=>Fv(p.node.attrs,e,{strict:!1}));return s?!!h.length:h.reduce((p,g)=>p+g.to-g.from,0)>=u}var qot=(n,t={})=>({state:e,dispatch:r})=>{const i=Sn(n,e.schema);return Cl(e,i,t)?ait(e,r):!1},Wot=()=>({state:n,dispatch:t})=>p4(n,t),Got=n=>({state:t,dispatch:e})=>{const r=Sn(n,t.schema);return bit(r)(t,e)},Yot=()=>({state:n,dispatch:t})=>f4(n,t);function g_(n,t){return t.nodes[n]?"node":t.marks[n]?"mark":null}function WP(n,t){const e=typeof t=="string"?[t]:t;return Object.keys(n).reduce((r,i)=>(e.includes(i)||(r[i]=n[i]),r),{})}var Kot=(n,t)=>({tr:e,state:r,dispatch:i})=>{let s=null,o=null;const l=g_(typeof n=="string"?n:n.name,r.schema);if(!l)return!1;l==="node"&&(s=Sn(n,r.schema)),l==="mark"&&(o=na(n,r.schema));let u=!1;return e.selection.ranges.forEach(h=>{r.doc.nodesBetween(h.$from.pos,h.$to.pos,(d,p)=>{s&&s===d.type&&(u=!0,i&&e.setNodeMarkup(p,void 0,WP(d.attrs,t))),o&&d.marks.length&&d.marks.forEach(g=>{o===g.type&&(u=!0,i&&e.addMark(p,p+d.nodeSize,o.create(WP(g.attrs,t))))})})}),u},Xot=()=>({tr:n,dispatch:t})=>(t&&n.scrollIntoView(),!0),Qot=()=>({tr:n,dispatch:t})=>{if(t){const e=new ii(n.doc);n.setSelection(e)}return!0},Jot=()=>({state:n,dispatch:t})=>l4(n,t),Zot=()=>({state:n,dispatch:t})=>h4(n,t),tat=()=>({state:n,dispatch:t})=>hit(n,t),eat=()=>({state:n,dispatch:t})=>pit(n,t),nat=()=>({state:n,dispatch:t})=>dit(n,t);function kE(n,t,e={},r={}){return sm(n,t,{slice:!1,parseOptions:e,errorOnInvalidContent:r.errorOnInvalidContent})}var rat=(n,{errorOnInvalidContent:t,emitUpdate:e=!0,parseOptions:r={}}={})=>({editor:i,tr:s,dispatch:o,commands:l})=>{const{doc:u}=s;if(r.preserveWhitespace!=="full"){const h=kE(n,i.schema,r,{errorOnInvalidContent:t??i.options.enableContentCheck});return o&&s.replaceWith(0,u.content.size,h).setMeta("preventUpdate",!e),!0}return o&&s.setMeta("preventUpdate",!e),l.insertContentAt({from:0,to:u.content.size},n,{parseOptions:r,errorOnInvalidContent:t??i.options.enableContentCheck})};function s5(n,t){const e=na(t,n.schema),{from:r,to:i,empty:s}=n.selection,o=[];s?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,u=>{o.push(...u.marks)});const l=o.find(u=>u.type.name===e.name);return l?{...l.attrs}:{}}function o5(n,t){const e=new n4(n);return t.forEach(r=>{r.steps.forEach(i=>{e.step(i)})}),e}function iat(n){for(let t=0;t<n.edgeCount;t+=1){const{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}function sat(n,t,e){const r=[];return n.nodesBetween(t.from,t.to,(i,s)=>{e(i)&&r.push({node:i,pos:s})}),r}function oat(n,t){for(let e=n.depth;e>0;e-=1){const r=n.node(e);if(t(r))return{pos:e>0?n.before(e):0,start:n.start(e),depth:e,node:r}}}function y_(n){return t=>oat(t.$from,n)}function Et(n,t,e){return n.config[t]===void 0&&n.parent?Et(n.parent,t,e):typeof n.config[t]=="function"?n.config[t].bind({...e,parent:n.parent?Et(n.parent,t,e):null}):n.config[t]}function pA(n){return n.map(t=>{const e={name:t.name,options:t.options,storage:t.storage},r=Et(t,"addExtensions",e);return r?[t,...pA(r())]:t}).flat(10)}function mA(n,t){const e=yu.fromSchema(t).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(e),i.innerHTML}function a5(n){return typeof n=="function"}function ge(n,t=void 0,...e){return a5(n)?t?n.bind(t)(...e):n(...e):n}function aat(n={}){return Object.keys(n).length===0&&n.constructor===Object}function ef(n){const t=n.filter(i=>i.type==="extension"),e=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:t,nodeExtensions:e,markExtensions:r}}function l5(n){const t=[],{nodeExtensions:e,markExtensions:r}=ef(n),i=[...e,...r],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1},o=e.filter(h=>h.name!=="text").map(h=>h.name),l=r.map(h=>h.name),u=[...o,...l];return n.forEach(h=>{const d={name:h.name,options:h.options,storage:h.storage,extensions:i},p=Et(h,"addGlobalAttributes",d);if(!p)return;p().forEach(v=>{let T;Array.isArray(v.types)?T=v.types:v.types==="*"?T=u:v.types==="nodes"?T=o:v.types==="marks"?T=l:T=[],T.forEach(S=>{Object.entries(v.attributes).forEach(([w,E])=>{t.push({type:S,name:w,attribute:{...s,...E}})})})})}),i.forEach(h=>{const d={name:h.name,options:h.options,storage:h.storage},p=Et(h,"addAttributes",d);if(!p)return;const g=p();Object.entries(g).forEach(([v,T])=>{const S={...s,...T};typeof S?.default=="function"&&(S.default=S.default()),S?.isRequired&&S?.default===void 0&&delete S.default,t.push({type:h.name,name:v,attribute:S})})}),t}function Je(...n){return n.filter(t=>!!t).reduce((t,e)=>{const r={...t};return Object.entries(e).forEach(([i,s])=>{if(!r[i]){r[i]=s;return}if(i==="class"){const l=s?String(s).split(" "):[],u=r[i]?r[i].split(" "):[],h=l.filter(d=>!u.includes(d));r[i]=[...u,...h].join(" ")}else if(i==="style"){const l=s?s.split(";").map(d=>d.trim()).filter(Boolean):[],u=r[i]?r[i].split(";").map(d=>d.trim()).filter(Boolean):[],h=new Map;u.forEach(d=>{const[p,g]=d.split(":").map(v=>v.trim());h.set(p,g)}),l.forEach(d=>{const[p,g]=d.split(":").map(v=>v.trim());h.set(p,g)}),r[i]=Array.from(h.entries()).map(([d,p])=>`${d}: ${p}`).join("; ")}else r[i]=s}),r},{})}function om(n,t){return t.filter(e=>e.type===n.type.name).filter(e=>e.attribute.rendered).map(e=>e.attribute.renderHTML?e.attribute.renderHTML(n.attrs)||{}:{[e.name]:n.attrs[e.name]}).reduce((e,r)=>Je(e,r),{})}function lat(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function GP(n,t){return"style"in n?n:{...n,getAttrs:e=>{const r=n.getAttrs?n.getAttrs(e):n.attrs;if(r===!1)return!1;const i=t.reduce((s,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(e):lat(e.getAttribute(o.name));return l==null?s:{...s,[o.name]:l}},{});return{...r,...i}}}}function YP(n){return Object.fromEntries(Object.entries(n).filter(([t,e])=>t==="attrs"&&aat(e)?!1:e!=null))}function KP(n){var t,e;const r={};return!((t=n?.attribute)!=null&&t.isRequired)&&"default"in(n?.attribute||{})&&(r.default=n.attribute.default),((e=n?.attribute)==null?void 0:e.validate)!==void 0&&(r.validate=n.attribute.validate),[n.name,r]}function cat(n,t){var e;const r=l5(n),{nodeExtensions:i,markExtensions:s}=ef(n),o=(e=i.find(h=>Et(h,"topNode")))==null?void 0:e.name,l=Object.fromEntries(i.map(h=>{const d=r.filter(E=>E.type===h.name),p={name:h.name,options:h.options,storage:h.storage,editor:t},g=n.reduce((E,D)=>{const P=Et(D,"extendNodeSchema",p);return{...E,...P?P(h):{}}},{}),v=YP({...g,content:ge(Et(h,"content",p)),marks:ge(Et(h,"marks",p)),group:ge(Et(h,"group",p)),inline:ge(Et(h,"inline",p)),atom:ge(Et(h,"atom",p)),selectable:ge(Et(h,"selectable",p)),draggable:ge(Et(h,"draggable",p)),code:ge(Et(h,"code",p)),whitespace:ge(Et(h,"whitespace",p)),linebreakReplacement:ge(Et(h,"linebreakReplacement",p)),defining:ge(Et(h,"defining",p)),isolating:ge(Et(h,"isolating",p)),attrs:Object.fromEntries(d.map(KP))}),T=ge(Et(h,"parseHTML",p));T&&(v.parseDOM=T.map(E=>GP(E,d)));const S=Et(h,"renderHTML",p);S&&(v.toDOM=E=>S({node:E,HTMLAttributes:om(E,d)}));const w=Et(h,"renderText",p);return w&&(v.toText=w),[h.name,v]})),u=Object.fromEntries(s.map(h=>{const d=r.filter(w=>w.type===h.name),p={name:h.name,options:h.options,storage:h.storage,editor:t},g=n.reduce((w,E)=>{const D=Et(E,"extendMarkSchema",p);return{...w,...D?D(h):{}}},{}),v=YP({...g,inclusive:ge(Et(h,"inclusive",p)),excludes:ge(Et(h,"excludes",p)),group:ge(Et(h,"group",p)),spanning:ge(Et(h,"spanning",p)),code:ge(Et(h,"code",p)),attrs:Object.fromEntries(d.map(KP))}),T=ge(Et(h,"parseHTML",p));T&&(v.parseDOM=T.map(w=>GP(w,d)));const S=Et(h,"renderHTML",p);return S&&(v.toDOM=w=>S({mark:w,HTMLAttributes:om(w,d)})),[h.name,v]}));return new BB({topNode:o,nodes:l,marks:u})}function uat(n){const t=n.filter((e,r)=>n.indexOf(e)!==r);return Array.from(new Set(t))}function wp(n){return n.sort((e,r)=>{const i=Et(e,"priority")||100,s=Et(r,"priority")||100;return i>s?-1:i<s?1:0})}function c5(n){const t=wp(pA(n)),e=uat(t.map(r=>r.name));return e.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${e.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),t}function u5(n,t,e){const{from:r,to:i}=t,{blockSeparator:s=`

`,textSerializers:o={}}=e||{};let l="";return n.nodesBetween(r,i,(u,h,d,p)=>{var g;u.isBlock&&h>r&&(l+=s);const v=o?.[u.type.name];if(v)return d&&(l+=v({node:u,pos:h,parent:d,index:p,range:t})),!1;u.isText&&(l+=(g=u?.text)==null?void 0:g.slice(Math.max(r,h)-h,i-h))}),l}function hat(n,t){const e={from:0,to:n.content.size};return u5(n,e,t)}function h5(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,t])=>t.spec.toText).map(([t,e])=>[t,e.spec.toText]))}function fat(n,t){const e=Sn(t,n.schema),{from:r,to:i}=n.selection,s=[];n.doc.nodesBetween(r,i,l=>{s.push(l)});const o=s.reverse().find(l=>l.type.name===e.name);return o?{...o.attrs}:{}}function f5(n,t){const e=g_(typeof t=="string"?t:t.name,n.schema);return e==="node"?fat(n,t):e==="mark"?s5(n,t):{}}function dat(n,t=JSON.stringify){const e={};return n.filter(r=>{const i=t(r);return Object.prototype.hasOwnProperty.call(e,i)?!1:e[i]=!0})}function pat(n){const t=dat(n);return t.length===1?t:t.filter((e,r)=>!t.filter((s,o)=>o!==r).some(s=>e.oldRange.from>=s.oldRange.from&&e.oldRange.to<=s.oldRange.to&&e.newRange.from>=s.newRange.from&&e.newRange.to<=s.newRange.to))}function d5(n){const{mapping:t,steps:e}=n,r=[];return t.maps.forEach((i,s)=>{const o=[];if(i.ranges.length)i.forEach((l,u)=>{o.push({from:l,to:u})});else{const{from:l,to:u}=e[s];if(l===void 0||u===void 0)return;o.push({from:l,to:u})}o.forEach(({from:l,to:u})=>{const h=t.slice(s).map(l,-1),d=t.slice(s).map(u),p=t.invert().map(h,-1),g=t.invert().map(d);r.push({oldRange:{from:p,to:g},newRange:{from:h,to:d}})})}),pat(r)}function gA(n,t,e){const r=[];return n===t?e.resolve(n).marks().forEach(i=>{const s=e.resolve(n),o=dA(s,i.type);o&&r.push({mark:i,...o})}):e.nodesBetween(n,t,(i,s)=>{!i||i?.nodeSize===void 0||r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}var mat=(n,t,e,r=20)=>{const i=n.doc.resolve(e);let s=r,o=null;for(;s>0&&o===null;){const l=i.node(s);l?.type.name===t?o=l:s-=1}return[o,s]};function Hd(n,t){return t.nodes[n]||t.marks[n]||null}function U0(n,t,e){return Object.fromEntries(Object.entries(e).filter(([r])=>{const i=n.find(s=>s.type===t&&s.name===r);return i?i.attribute.keepOnSplit:!1}))}var gat=(n,t=500)=>{let e="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-t),r,(i,s,o,l)=>{var u,h;const d=((h=(u=i.type.spec).toText)==null?void 0:h.call(u,{node:i,pos:s,parent:o,index:l}))||i.textContent||"%leaf%";e+=i.isAtom&&!i.isText?d:d.slice(0,Math.max(0,r-s))}),e};function ME(n,t,e={}){const{empty:r,ranges:i}=n.selection,s=t?na(t,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(p=>s?s.name===p.type.name:!0).find(p=>Fv(p.attrs,e,{strict:!1}));let o=0;const l=[];if(i.forEach(({$from:p,$to:g})=>{const v=p.pos,T=g.pos;n.doc.nodesBetween(v,T,(S,w)=>{if(s&&S.inlineContent&&!S.type.allowsMarkType(s))return!1;if(!S.isText&&!S.marks.length)return;const E=Math.max(v,w),D=Math.min(T,w+S.nodeSize),P=D-E;o+=P,l.push(...S.marks.map(V=>({mark:V,from:E,to:D})))})}),o===0)return!1;const u=l.filter(p=>s?s.name===p.mark.type.name:!0).filter(p=>Fv(p.mark.attrs,e,{strict:!1})).reduce((p,g)=>p+g.to-g.from,0),h=l.filter(p=>s?p.mark.type!==s&&p.mark.type.excludes(s):!0).reduce((p,g)=>p+g.to-g.from,0);return(u>0?u+h:u)>=o}function yat(n,t,e={}){if(!t)return Cl(n,null,e)||ME(n,null,e);const r=g_(t,n.schema);return r==="node"?Cl(n,t,e):r==="mark"?ME(n,t,e):!1}var vat=(n,t)=>{const{$from:e,$to:r,$anchor:i}=n.selection;if(t){const s=y_(l=>l.type.name===t)(n.selection);if(!s)return!1;const o=n.doc.resolve(s.pos+1);return i.pos+1===o.end()}return!(r.parentOffset<r.parent.nodeSize-2||e.pos!==r.pos)},bat=n=>{const{$from:t,$to:e}=n.selection;return!(t.parentOffset>0||t.pos!==e.pos)};function XP(n,t){return Array.isArray(t)?t.some(e=>(typeof e=="string"?e:e.name)===n.name):t}function QP(n,t){const{nodeExtensions:e}=ef(t),r=e.find(o=>o.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},s=ge(Et(r,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function v_(n,{checkChildren:t=!0,ignoreWhitespace:e=!1}={}){var r;if(e){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!=null?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(t){let i=!0;return n.content.forEach(s=>{i!==!1&&(v_(s,{ignoreWhitespace:e,checkChildren:t})||(i=!1))}),i}return!1}function p5(n){return n instanceof Dt}var m5=class g5{constructor(t){this.position=t}static fromJSON(t){return new g5(t.position)}toJSON(){return{position:this.position}}};function _at(n,t){const e=t.mapping.mapResult(n.position);return{position:new m5(e.pos),mapResult:e}}function Tat(n){return new m5(n)}function Sat(n,t,e){var r;const{selection:i}=t;let s=null;if(e5(i)&&(s=i.$cursor),s){const l=(r=n.storedMarks)!=null?r:s.marks();return s.parent.type.allowsMarkType(e)&&(!!e.isInSet(l)||!l.some(h=>h.type.excludes(e)))}const{ranges:o}=i;return o.some(({$from:l,$to:u})=>{let h=l.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(e):!1;return n.doc.nodesBetween(l.pos,u.pos,(d,p,g)=>{if(h)return!1;if(d.isInline){const v=!g||g.type.allowsMarkType(e),T=!!e.isInSet(d.marks)||!d.marks.some(S=>S.type.excludes(e));h=v&&T}return!h}),h})}var wat=(n,t={})=>({tr:e,state:r,dispatch:i})=>{const{selection:s}=e,{empty:o,ranges:l}=s,u=na(n,r.schema);if(i)if(o){const h=s5(r,u);e.addStoredMark(u.create({...h,...t}))}else l.forEach(h=>{const d=h.$from.pos,p=h.$to.pos;r.doc.nodesBetween(d,p,(g,v)=>{const T=Math.max(v,d),S=Math.min(v+g.nodeSize,p);g.marks.find(E=>E.type===u)?g.marks.forEach(E=>{u===E.type&&e.addMark(T,S,u.create({...E.attrs,...t}))}):e.addMark(T,S,u.create(t))})});return Sat(r,e,u)},xat=(n,t)=>({tr:e})=>(e.setMeta(n,t),!0),Eat=(n,t={})=>({state:e,dispatch:r,chain:i})=>{const s=Sn(n,e.schema);let o;return e.selection.$anchor.sameParent(e.selection.$head)&&(o=e.selection.$anchor.parent.attrs),s.isTextblock?i().command(({commands:l})=>uP(s,{...o,...t})(e)?!0:l.clearNodes()).command(({state:l})=>uP(s,{...o,...t})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Cat=n=>({tr:t,dispatch:e})=>{if(e){const{doc:r}=t,i=Fc(n,0,r.content.size),s=Dt.create(r,i);t.setSelection(s)}return!0},Aat=(n,t)=>({tr:e,state:r,dispatch:i})=>{const{selection:s}=r;let o,l;return typeof t=="number"?(o=t,l=t):t&&"from"in t&&"to"in t?(o=t.from,l=t.to):(o=s.from,l=s.to),i&&e.doc.nodesBetween(o,l,(u,h)=>{u.isText||e.setNodeMarkup(h,void 0,{...u.attrs,dir:n})}),!0},kat=n=>({tr:t,dispatch:e})=>{if(e){const{doc:r}=t,{from:i,to:s}=typeof n=="number"?{from:n,to:n}:n,o=jt.atStart(r).from,l=jt.atEnd(r).to,u=Fc(i,o,l),h=Fc(s,o,l),d=jt.create(r,u,h);t.setSelection(d)}return!0},Mat=n=>({state:t,dispatch:e})=>{const r=Sn(n,t.schema);return Sit(r)(t,e)};function JP(n,t){const e=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(e){const r=e.filter(i=>t?.includes(i.type.name));n.tr.ensureMarks(r)}}var Dat=({keepMarks:n=!0}={})=>({tr:t,state:e,dispatch:r,editor:i})=>{const{selection:s,doc:o}=t,{$from:l,$to:u}=s,h=i.extensionManager.attributes,d=U0(h,l.node().type.name,l.node().attrs);if(s instanceof Dt&&s.node.isBlock)return!l.parentOffset||!$o(o,l.pos)?!1:(r&&(n&&JP(e,i.extensionManager.splittableMarks),t.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const p=u.parentOffset===u.parent.content.size,g=l.depth===0?void 0:iat(l.node(-1).contentMatchAt(l.indexAfter(-1)));let v=p&&g?[{type:g,attrs:d}]:void 0,T=$o(t.doc,t.mapping.map(l.pos),1,v);if(!v&&!T&&$o(t.doc,t.mapping.map(l.pos),1,g?[{type:g}]:void 0)&&(T=!0,v=g?[{type:g,attrs:d}]:void 0),r){if(T&&(s instanceof jt&&t.deleteSelection(),t.split(t.mapping.map(l.pos),1,v),g&&!p&&!l.parentOffset&&l.parent.type!==g)){const S=t.mapping.map(l.before()),w=t.doc.resolve(S);l.node(-1).canReplaceWith(w.index(),w.index()+1,g)&&t.setNodeMarkup(t.mapping.map(l.before()),g)}n&&JP(e,i.extensionManager.splittableMarks),t.scrollIntoView()}return T},Oat=(n,t={})=>({tr:e,state:r,dispatch:i,editor:s})=>{var o;const l=Sn(n,r.schema),{$from:u,$to:h}=r.selection,d=r.selection.node;if(d&&d.isBlock||u.depth<2||!u.sameParent(h))return!1;const p=u.node(-1);if(p.type!==l)return!1;const g=s.extensionManager.attributes;if(u.parent.content.size===0&&u.node(-1).childCount===u.indexAfter(-1)){if(u.depth===2||u.node(-3).type!==l||u.index(-2)!==u.node(-2).childCount-1)return!1;if(i){let E=ut.empty;const D=u.index(-1)?1:u.index(-2)?2:3;for(let k=u.depth-D;k>=u.depth-3;k-=1)E=ut.from(u.node(k).copy(E));const P=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,V={...U0(g,u.node().type.name,u.node().attrs),...t},N=((o=l.contentMatch.defaultType)==null?void 0:o.createAndFill(V))||void 0;E=E.append(ut.from(l.createAndFill(null,N)||void 0));const q=u.before(u.depth-(D-1));e.replace(q,u.after(-P),new vt(E,4-D,0));let M=-1;e.doc.nodesBetween(q,e.doc.content.size,(k,R)=>{if(M>-1)return!1;k.isTextblock&&k.content.size===0&&(M=R+1)}),M>-1&&e.setSelection(jt.near(e.doc.resolve(M))),e.scrollIntoView()}return!0}const v=h.pos===u.end()?p.contentMatchAt(0).defaultType:null,T={...U0(g,p.type.name,p.attrs),...t},S={...U0(g,u.node().type.name,u.node().attrs),...t};e.delete(u.pos,h.pos);const w=v?[{type:l,attrs:T},{type:v,attrs:S}]:[{type:l,attrs:T}];if(!$o(e.doc,u.pos,2))return!1;if(i){const{selection:E,storedMarks:D}=r,{splittableMarks:P}=s.extensionManager,V=D||E.$to.parentOffset&&E.$from.marks();if(e.split(u.pos,2,w).scrollIntoView(),!V||!i)return!0;const N=V.filter(q=>P.includes(q.type.name));e.ensureMarks(N)}return!0},Vw=(n,t)=>{const e=y_(o=>o.type===t)(n.selection);if(!e)return!0;const r=n.doc.resolve(Math.max(0,e.pos-1)).before(e.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return e.node.type===i?.type&&Bl(n.doc,e.pos)&&n.join(e.pos),!0},jw=(n,t)=>{const e=y_(o=>o.type===t)(n.selection);if(!e)return!0;const r=n.doc.resolve(e.start).after(e.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return e.node.type===i?.type&&Bl(n.doc,r)&&n.join(r),!0},Rat=(n,t,e,r={})=>({editor:i,tr:s,state:o,dispatch:l,chain:u,commands:h,can:d})=>{const{extensions:p,splittableMarks:g}=i.extensionManager,v=Sn(n,o.schema),T=Sn(t,o.schema),{selection:S,storedMarks:w}=o,{$from:E,$to:D}=S,P=E.blockRange(D),V=w||S.$to.parentOffset&&S.$from.marks();if(!P)return!1;const N=y_(q=>QP(q.type.name,p))(S);if(P.depth>=1&&N&&P.depth-N.depth<=1){if(N.node.type===v)return h.liftListItem(T);if(QP(N.node.type.name,p)&&v.validContent(N.node.content)&&l)return u().command(()=>(s.setNodeMarkup(N.pos,v),!0)).command(()=>Vw(s,v)).command(()=>jw(s,v)).run()}return!e||!V||!l?u().command(()=>d().wrapInList(v,r)?!0:h.clearNodes()).wrapInList(v,r).command(()=>Vw(s,v)).command(()=>jw(s,v)).run():u().command(()=>{const q=d().wrapInList(v,r),M=V.filter(k=>g.includes(k.type.name));return s.ensureMarks(M),q?!0:h.clearNodes()}).wrapInList(v,r).command(()=>Vw(s,v)).command(()=>jw(s,v)).run()},Iat=(n,t={},e={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=e,o=na(n,r.schema);return ME(r,o,t)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,t)},Pat=(n,t,e={})=>({state:r,commands:i})=>{const s=Sn(n,r.schema),o=Sn(t,r.schema),l=Cl(r,s,e);let u;return r.selection.$anchor.sameParent(r.selection.$head)&&(u=r.selection.$anchor.parent.attrs),l?i.setNode(o,u):i.setNode(s,{...u,...e})},Nat=(n,t={})=>({state:e,commands:r})=>{const i=Sn(n,e.schema);return Cl(e,i,t)?r.lift(i):r.wrapIn(i,t)},Lat=()=>({state:n,dispatch:t})=>{const e=n.plugins;for(let r=0;r<e.length;r+=1){const i=e[r];let s;if(i.spec.isInputRules&&(s=i.getState(n))){if(t){const o=n.tr,l=s.transform;for(let u=l.steps.length-1;u>=0;u-=1)o.step(l.steps[u].invert(l.docs[u]));if(s.text){const u=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,n.schema.text(s.text,u))}else o.delete(s.from,s.to)}return!0}}return!1},Vat=()=>({tr:n,dispatch:t})=>{const{selection:e}=n,{empty:r,ranges:i}=e;return r||t&&i.forEach(s=>{n.removeMark(s.$from.pos,s.$to.pos)}),!0},jat=(n,t={})=>({tr:e,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=t,{selection:l}=e,u=na(n,r.schema),{$from:h,empty:d,ranges:p}=l;if(!i)return!0;if(d&&o){let{from:g,to:v}=l;const T=(s=h.marks().find(w=>w.type===u))==null?void 0:s.attrs,S=dA(h,u,T);S&&(g=S.from,v=S.to),e.removeMark(g,v,u)}else p.forEach(g=>{e.removeMark(g.$from.pos,g.$to.pos,u)});return e.removeStoredMark(u),!0},Fat=n=>({tr:t,state:e,dispatch:r})=>{const{selection:i}=e;let s,o;return typeof n=="number"?(s=n,o=n):n&&"from"in n&&"to"in n?(s=n.from,o=n.to):(s=i.from,o=i.to),r&&t.doc.nodesBetween(s,o,(l,u)=>{if(l.isText)return;const h={...l.attrs};delete h.dir,t.setNodeMarkup(u,void 0,h)}),!0},Bat=(n,t={})=>({tr:e,state:r,dispatch:i})=>{let s=null,o=null;const l=g_(typeof n=="string"?n:n.name,r.schema);if(!l)return!1;l==="node"&&(s=Sn(n,r.schema)),l==="mark"&&(o=na(n,r.schema));let u=!1;return e.selection.ranges.forEach(h=>{const d=h.$from.pos,p=h.$to.pos;let g,v,T,S;e.selection.empty?r.doc.nodesBetween(d,p,(w,E)=>{s&&s===w.type&&(u=!0,T=Math.max(E,d),S=Math.min(E+w.nodeSize,p),g=E,v=w)}):r.doc.nodesBetween(d,p,(w,E)=>{E<d&&s&&s===w.type&&(u=!0,T=Math.max(E,d),S=Math.min(E+w.nodeSize,p),g=E,v=w),E>=d&&E<=p&&(s&&s===w.type&&(u=!0,i&&e.setNodeMarkup(E,void 0,{...w.attrs,...t})),o&&w.marks.length&&w.marks.forEach(D=>{if(o===D.type&&(u=!0,i)){const P=Math.max(E,d),V=Math.min(E+w.nodeSize,p);e.addMark(P,V,o.create({...D.attrs,...t}))}}))}),v&&(g!==void 0&&i&&e.setNodeMarkup(g,void 0,{...v.attrs,...t}),o&&v.marks.length&&v.marks.forEach(w=>{o===w.type&&i&&e.addMark(T,S,o.create({...w.attrs,...t}))}))}),u},Uat=(n,t={})=>({state:e,dispatch:r})=>{const i=Sn(n,e.schema);return mit(i,t)(e,r)},zat=(n,t={})=>({state:e,dispatch:r})=>{const i=Sn(n,e.schema);return git(i,t)(e,r)},Hat=class{constructor(){this.callbacks={}}on(n,t){return this.callbacks[n]||(this.callbacks[n]=[]),this.callbacks[n].push(t),this}emit(n,...t){const e=this.callbacks[n];return e&&e.forEach(r=>r.apply(this,t)),this}off(n,t){const e=this.callbacks[n];return e&&(t?this.callbacks[n]=e.filter(r=>r!==t):delete this.callbacks[n]),this}once(n,t){const e=(...r)=>{this.off(n,e),t.apply(this,r)};return this.on(n,e)}removeAllListeners(){this.callbacks={}}},b_=class{constructor(n){var t;this.find=n.find,this.handler=n.handler,this.undoable=(t=n.undoable)!=null?t:!0}},$at=(n,t)=>{if(fA(t))return t.exec(n);const e=t(n);if(!e)return null;const r=[e.text];return r.index=e.index,r.input=n,r.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(e.replaceWith)),r};function jy(n){var t;const{editor:e,from:r,to:i,text:s,rules:o,plugin:l}=n,{view:u}=e;if(u.composing)return!1;const h=u.state.doc.resolve(r);if(h.parent.type.spec.code||(t=h.nodeBefore||h.nodeAfter)!=null&&t.marks.find(g=>g.type.spec.code))return!1;let d=!1;const p=gat(h)+s;return o.forEach(g=>{if(d)return;const v=$at(p,g.find);if(!v)return;const T=u.state.tr,S=p_({state:u.state,transaction:T}),w={from:r-(v[0].length-s.length),to:i},{commands:E,chain:D,can:P}=new m_({editor:e,state:S});g.handler({state:S,range:w,match:v,commands:E,chain:D,can:P})===null||!T.steps.length||(g.undoable&&T.setMeta(l,{transform:T,from:r,to:i,text:s}),u.dispatch(T),d=!0)}),d}function qat(n){const{editor:t,rules:e}=n,r=new $e({state:{init(){return null},apply(i,s,o){const l=i.getMeta(r);if(l)return l;const u=i.getMeta("applyInputRules");return u&&setTimeout(()=>{let{text:d}=u;typeof d=="string"?d=d:d=mA(ut.from(d),o.schema);const{from:p}=u,g=p+d.length;jy({editor:t,from:p,to:g,text:d,rules:e,plugin:r})}),i.selectionSet||i.docChanged?null:s}},props:{handleTextInput(i,s,o,l){return jy({editor:t,from:s,to:o,text:l,rules:e,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&jy({editor:t,from:s.pos,to:s.pos,text:"",rules:e,plugin:r})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?jy({editor:t,from:o.pos,to:o.pos,text:`
`,rules:e,plugin:r}):!1}},isInputRules:!0});return r}function Wat(n){return Object.prototype.toString.call(n).slice(8,-1)}function Fy(n){return Wat(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function y5(n,t){const e={...n};return Fy(n)&&Fy(t)&&Object.keys(t).forEach(r=>{Fy(t[r])&&Fy(n[r])?e[r]=y5(n[r],t[r]):e[r]=t[r]}),e}var yA=class{constructor(n={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...n},this.name=this.config.name}get options(){return{...ge(Et(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...ge(Et(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(n={}){const t=this.extend({...this.config,addOptions:()=>y5(this.options,n)});return t.name=this.name,t.parent=this.parent,t}extend(n={}){const t=new this.constructor({...this.config,...n});return t.parent=this,this.child=t,t.name="name"in n?n.name:t.parent.name,t}},ra=class v5 extends yA{constructor(){super(...arguments),this.type="mark"}static create(t={}){const e=typeof t=="function"?t():t;return new v5(e)}static handleExit({editor:t,mark:e}){const{tr:r}=t.state,i=t.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(h=>h?.type.name===e.name))return!1;const u=o.find(h=>h?.type.name===e.name);return u&&r.removeStoredMark(u),r.insertText(" ",i.pos),t.view.dispatch(r),!0}return!1}configure(t){return super.configure(t)}extend(t){const e=typeof t=="function"?t():t;return super.extend(e)}};function Gat(n){return typeof n=="number"}var Yat=class{constructor(n){this.find=n.find,this.handler=n.handler}},Kat=(n,t,e)=>{if(fA(t))return[...n.matchAll(t)];const r=t(n,e);return r?r.map(i=>{const s=[i.text];return s.index=i.index,s.input=n,s.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(i.replaceWith)),s}):[]};function Xat(n){const{editor:t,state:e,from:r,to:i,rule:s,pasteEvent:o,dropEvent:l}=n,{commands:u,chain:h,can:d}=new m_({editor:t,state:e}),p=[];return e.doc.nodesBetween(r,i,(v,T)=>{var S,w,E,D,P;if((w=(S=v.type)==null?void 0:S.spec)!=null&&w.code||!(v.isText||v.isTextblock||v.isInline))return;const V=(P=(D=(E=v.content)==null?void 0:E.size)!=null?D:v.nodeSize)!=null?P:0,N=Math.max(r,T),q=Math.min(i,T+V);if(N>=q)return;const M=v.isText?v.text||"":v.textBetween(N-T,q-T,void 0,"");Kat(M,s.find,o).forEach(R=>{if(R.index===void 0)return;const F=N+R.index+1,U=F+R[0].length,H={from:e.tr.mapping.map(F),to:e.tr.mapping.map(U)},j=s.handler({state:e,range:H,match:R,commands:u,chain:h,can:d,pasteEvent:o,dropEvent:l});p.push(j)})}),p.every(v=>v!==null)}var By=null,Qat=n=>{var t;const e=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=e.clipboardData)==null||t.setData("text/html",n),e};function Jat(n){const{editor:t,rules:e}=n;let r=null,i=!1,s=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const u=({state:d,from:p,to:g,rule:v,pasteEvt:T})=>{const S=d.tr,w=p_({state:d,transaction:S});if(!(!Xat({editor:t,state:w,from:Math.max(p-1,0),to:g.b-1,rule:v,pasteEvent:T,dropEvent:l})||!S.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,S}};return e.map(d=>new $e({view(p){const g=T=>{var S;r=(S=p.dom.parentElement)!=null&&S.contains(T.target)?p.dom.parentElement:null,r&&(By=t)},v=()=>{By&&(By=null)};return window.addEventListener("dragstart",g),window.addEventListener("dragend",v),{destroy(){window.removeEventListener("dragstart",g),window.removeEventListener("dragend",v)}}},props:{handleDOMEvents:{drop:(p,g)=>{if(s=r===p.dom.parentElement,l=g,!s){const v=By;v?.isEditable&&setTimeout(()=>{const T=v.state.selection;T&&v.commands.deleteRange({from:T.from,to:T.to})},10)}return!1},paste:(p,g)=>{var v;const T=(v=g.clipboardData)==null?void 0:v.getData("text/html");return o=g,i=!!T?.includes("data-pm-slice"),!1}}},appendTransaction:(p,g,v)=>{const T=p[0],S=T.getMeta("uiEvent")==="paste"&&!i,w=T.getMeta("uiEvent")==="drop"&&!s,E=T.getMeta("applyPasteRules"),D=!!E;if(!S&&!w&&!D)return;if(D){let{text:N}=E;typeof N=="string"?N=N:N=mA(ut.from(N),v.schema);const{from:q}=E,M=q+N.length,k=Qat(N);return u({rule:d,state:v,from:q,to:{b:M},pasteEvt:k})}const P=g.doc.content.findDiffStart(v.doc.content),V=g.doc.content.findDiffEnd(v.doc.content);if(!(!Gat(P)||!V||P===V.b))return u({rule:d,state:v,from:P,to:V,pasteEvt:o})}}))}var __=class{constructor(n,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=n,this.extensions=c5(n),this.schema=cat(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((n,t)=>{const e={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:Hd(t.name,this.schema)},r=Et(t,"addCommands",e);return r?{...n,...r()}:n},{})}get plugins(){const{editor:n}=this;return wp([...this.extensions].reverse()).flatMap(r=>{const i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:n,type:Hd(r.name,this.schema)},s=[],o=Et(r,"addKeyboardShortcuts",i);let l={};if(r.type==="mark"&&Et(r,"exitable",i)&&(l.ArrowRight=()=>ra.handleExit({editor:n,mark:r})),o){const g=Object.fromEntries(Object.entries(o()).map(([v,T])=>[v,()=>T({editor:n})]));l={...l,...g}}const u=fot(l);s.push(u);const h=Et(r,"addInputRules",i);if(XP(r,n.options.enableInputRules)&&h){const g=h();if(g&&g.length){const v=qat({editor:n,rules:g}),T=Array.isArray(v)?v:[v];s.push(...T)}}const d=Et(r,"addPasteRules",i);if(XP(r,n.options.enablePasteRules)&&d){const g=d();if(g&&g.length){const v=Jat({editor:n,rules:g});s.push(...v)}}const p=Et(r,"addProseMirrorPlugins",i);if(p){const g=p();s.push(...g)}return s})}get attributes(){return l5(this.extensions)}get nodeViews(){const{editor:n}=this,{nodeExtensions:t}=ef(this.extensions);return Object.fromEntries(t.filter(e=>!!Et(e,"addNodeView")).map(e=>{const r=this.attributes.filter(u=>u.type===e.name),i={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:n,type:Sn(e.name,this.schema)},s=Et(e,"addNodeView",i);if(!s)return[];const o=s();if(!o)return[];const l=(u,h,d,p,g)=>{const v=om(u,r);return o({node:u,view:h,getPos:d,decorations:p,innerDecorations:g,editor:n,extension:e,HTMLAttributes:v})};return[e.name,l]}))}dispatchTransaction(n){const{editor:t}=this;return wp([...this.extensions].reverse()).reduceRight((r,i)=>{const s={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:t,type:Hd(i.name,this.schema)},o=Et(i,"dispatchTransaction",s);return o?l=>{o.call(s,{transaction:l,next:r})}:r},n)}transformPastedHTML(n){const{editor:t}=this;return wp([...this.extensions]).reduce((r,i)=>{const s={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:t,type:Hd(i.name,this.schema)},o=Et(i,"transformPastedHTML",s);return o?(l,u)=>{const h=r(l,u);return o.call(s,h)}:r},n||(r=>r))}get markViews(){const{editor:n}=this,{markExtensions:t}=ef(this.extensions);return Object.fromEntries(t.filter(e=>!!Et(e,"addMarkView")).map(e=>{const r=this.attributes.filter(l=>l.type===e.name),i={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:n,type:na(e.name,this.schema)},s=Et(e,"addMarkView",i);if(!s)return[];const o=(l,u,h)=>{const d=om(l,r);return s()({mark:l,view:u,inline:h,editor:n,extension:e,HTMLAttributes:d,updateAttributes:p=>{flt(l,n,p)}})};return[e.name,o]}))}setupExtensions(){const n=this.extensions;this.editor.extensionStorage=Object.fromEntries(n.map(t=>[t.name,t.storage])),n.forEach(t=>{var e;const r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:Hd(t.name,this.schema)};t.type==="mark"&&((e=ge(Et(t,"keepOnSplit",r)))==null||e)&&this.splittableMarks.push(t.name);const i=Et(t,"onBeforeCreate",r),s=Et(t,"onCreate",r),o=Et(t,"onUpdate",r),l=Et(t,"onSelectionUpdate",r),u=Et(t,"onTransaction",r),h=Et(t,"onFocus",r),d=Et(t,"onBlur",r),p=Et(t,"onDestroy",r);i&&this.editor.on("beforeCreate",i),s&&this.editor.on("create",s),o&&this.editor.on("update",o),l&&this.editor.on("selectionUpdate",l),u&&this.editor.on("transaction",u),h&&this.editor.on("focus",h),d&&this.editor.on("blur",d),p&&this.editor.on("destroy",p)})}};__.resolve=c5;__.sort=wp;__.flatten=pA;var Zat={};hA(Zat,{ClipboardTextSerializer:()=>_5,Commands:()=>T5,Delete:()=>S5,Drop:()=>w5,Editable:()=>x5,FocusEvents:()=>C5,Keymap:()=>A5,Paste:()=>k5,Tabindex:()=>M5,TextDirection:()=>D5,focusEventsPluginKey:()=>E5});var ke=class b5 extends yA{constructor(){super(...arguments),this.type="extension"}static create(t={}){const e=typeof t=="function"?t():t;return new b5(e)}configure(t){return super.configure(t)}extend(t){const e=typeof t=="function"?t():t;return super.extend(e)}},_5=ke.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new $e({key:new Mn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:t,schema:e}=n,{doc:r,selection:i}=t,{ranges:s}=i,o=Math.min(...s.map(d=>d.$from.pos)),l=Math.max(...s.map(d=>d.$to.pos)),u=h5(e);return u5(r,{from:o,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:u})}}})]}}),T5=ke.create({name:"commands",addCommands(){return{...Z4}}}),S5=ke.create({name:"delete",onUpdate({transaction:n,appendedTransactions:t}){var e,r,i;const s=()=>{var o,l,u,h;if((h=(u=(l=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:l.filterTransaction)==null?void 0:u.call(l,n))!=null?h:n.getMeta("y-sync$"))return;const d=o5(n.before,[n,...t]);d5(d).forEach(v=>{d.mapping.mapResult(v.oldRange.from).deletedAfter&&d.mapping.mapResult(v.oldRange.to).deletedBefore&&d.before.nodesBetween(v.oldRange.from,v.oldRange.to,(T,S)=>{const w=S+T.nodeSize-2,E=v.oldRange.from<=S&&w<=v.oldRange.to;this.editor.emit("delete",{type:"node",node:T,from:S,to:w,newFrom:d.mapping.map(S),newTo:d.mapping.map(w),deletedRange:v.oldRange,newRange:v.newRange,partial:!E,editor:this.editor,transaction:n,combinedTransform:d})})});const g=d.mapping;d.steps.forEach((v,T)=>{var S,w;if(v instanceof ns){const E=g.slice(T).map(v.from,-1),D=g.slice(T).map(v.to),P=g.invert().map(E,-1),V=g.invert().map(D),N=(S=d.doc.nodeAt(E-1))==null?void 0:S.marks.some(M=>M.eq(v.mark)),q=(w=d.doc.nodeAt(D))==null?void 0:w.marks.some(M=>M.eq(v.mark));this.editor.emit("delete",{type:"mark",mark:v.mark,from:v.from,to:v.to,deletedRange:{from:P,to:V},newRange:{from:E,to:D},partial:!!(q||N),editor:this.editor,transaction:n,combinedTransform:d})}})};(i=(r=(e=this.editor.options.coreExtensionOptions)==null?void 0:e.delete)==null?void 0:r.async)==null||i?setTimeout(s,0):s()}}),w5=ke.create({name:"drop",addProseMirrorPlugins(){return[new $e({key:new Mn("tiptapDrop"),props:{handleDrop:(n,t,e,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:e,moved:r})}}})]}}),x5=ke.create({name:"editable",addProseMirrorPlugins(){return[new $e({key:new Mn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),E5=new Mn("focusEvents"),C5=ke.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new $e({key:E5,props:{handleDOMEvents:{focus:(t,e)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:e}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,e)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:e}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),A5=ke.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:u,doc:h}=l,{empty:d,$anchor:p}=u,{pos:g,parent:v}=p,T=p.parent.isTextblock&&g>0?l.doc.resolve(g-1):p,S=T.parent.type.spec.isolating,w=p.pos-p.parentOffset,E=S&&T.parent.childCount===1?w===p.pos:Wt.atStart(h).from===g;return!d||!v.type.isTextblock||v.textContent.length||!E||E&&p.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},s={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Bv()||i5()?s:i},addProseMirrorPlugins(){return[new $e({key:new Mn("clearDocument"),appendTransaction:(n,t,e)=>{if(n.some(S=>S.getMeta("composition")))return;const r=n.some(S=>S.docChanged)&&!t.doc.eq(e.doc),i=n.some(S=>S.getMeta("preventClearDocument"));if(!r||i)return;const{empty:s,from:o,to:l}=t.selection,u=Wt.atStart(t.doc).from,h=Wt.atEnd(t.doc).to;if(s||!(o===u&&l===h)||!v_(e.doc))return;const g=e.tr,v=p_({state:e,transaction:g}),{commands:T}=new m_({editor:this.editor,state:v});if(T.clearNodes(),!!g.steps.length)return g}})]}}),k5=ke.create({name:"paste",addProseMirrorPlugins(){return[new $e({key:new Mn("tiptapPaste"),props:{handlePaste:(n,t,e)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:e})}}})]}}),M5=ke.create({name:"tabindex",addProseMirrorPlugins(){return[new $e({key:new Mn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),D5=ke.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:n}=ef(this.extensions);return[{types:n.filter(t=>t.name!=="text").map(t=>t.name),attributes:{dir:{default:this.options.direction,parseHTML:t=>{const e=t.getAttribute("dir");return e&&(e==="ltr"||e==="rtl"||e==="auto")?e:this.options.direction},renderHTML:t=>t.dir?{dir:t.dir}:{}}}}]},addProseMirrorPlugins(){return[new $e({key:new Mn("textDirection"),props:{attributes:()=>{const n=this.options.direction;return n?{dir:n}:{}}}})]}}),tlt=class ip{constructor(t,e,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=t,this.editor=e,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let e=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}e=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:e,to:r},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),e=this.resolvedPos.doc.resolve(t);return new ip(e,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new ip(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new ip(t,this.editor)}get children(){const t=[];return this.node.content.forEach((e,r)=>{const i=e.isBlock&&!e.isTextblock,s=e.isAtom&&!e.isText,o=e.isInline,l=this.pos+r+(s?0:1);if(l<0||l>this.resolvedPos.doc.nodeSize-2)return;const u=this.resolvedPos.doc.resolve(l);if(!i&&!o&&u.depth<=this.depth)return;const h=new ip(u,this.editor,i,i||o?e:null);i&&(h.actualDepth=this.depth+1),t.push(h)}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,e={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===t)if(Object.keys(e).length>0){const s=i.node.attrs,o=Object.keys(e);for(let l=0;l<o.length;l+=1){const u=o[l];if(s[u]!==e[u])break}}else r=i;i=i.parent}return r}querySelector(t,e={}){return this.querySelectorAll(t,e,!0)[0]||null}querySelectorAll(t,e={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const s=Object.keys(e);return this.children.forEach(o=>{r&&i.length>0||(o.node.type.name===t&&s.every(u=>e[u]===o.node.attrs[u])&&i.push(o),!(r&&i.length>0)&&(i=i.concat(o.querySelectorAll(t,e,r))))}),i}setAttribute(t){const{tr:e}=this.editor.state;e.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(e)}},elt=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function nlt(n,t,e){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return t&&i.setAttribute("nonce",t),i.setAttribute("data-tiptap-style",""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}var rlt=class extends Hat{constructor(n={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:_at,createMappablePosition:Tat},this.setOptions(n),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:i,moved:s})=>this.options.onDrop(r,i,s)),this.on("paste",({event:r,slice:i})=>this.options.onPaste(r,i)),this.on("delete",this.options.onDelete);const t=this.createDoc(),e=n5(t,this.options.autofocus);this.editorState=Ah.create({doc:t,schema:this.schema,selection:e||void 0}),this.options.element&&this.mount(this.options.element)}mount(n){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(n),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const n=this.editorView.dom;n?.editor&&delete n.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(n){console.warn("Failed to remove CSS element:",n)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=nlt(elt,this.options.injectNonce))}setOptions(n={}){this.options={...this.options,...n},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(n,t=!0){this.setOptions({editable:n}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:n=>{this.editorState=n},dispatch:n=>{this.dispatchTransaction(n)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(n,t)=>{if(this.editorView)return this.editorView[t];if(t==="state")return this.editorState;if(t in n)return Reflect.get(n,t);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(n,t){const e=a5(t)?t(n,[...this.state.plugins]):[...this.state.plugins,n],r=this.state.reconfigure({plugins:e});return this.view.updateState(r),r}unregisterPlugin(n){if(this.isDestroyed)return;const t=this.state.plugins;let e=t;if([].concat(n).forEach(i=>{const s=typeof i=="string"?`${i}$`:i.key;e=e.filter(o=>!o.key.startsWith(s))}),t.length===e.length)return;const r=this.state.reconfigure({plugins:e});return this.view.updateState(r),r}createExtensionManager(){var n,t;const r=[...this.options.enableCoreExtensions?[x5,_5.configure({blockSeparator:(t=(n=this.options.coreExtensionOptions)==null?void 0:n.clipboardTextSerializer)==null?void 0:t.blockSeparator}),T5,C5,A5,M5,w5,k5,S5,D5.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new __(r,this)}createCommandManager(){this.commandManager=new m_({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let n;try{n=kE(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>e.name!=="collaboration"),this.createExtensionManager()}}),n=kE(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return n}createView(n){const{editorProps:t,enableExtensionDispatchTransaction:e}=this.options,r=t.dispatchTransaction||this.dispatchTransaction.bind(this),i=e?this.extensionManager.dispatchTransaction(r):r,s=t.transformPastedHTML,o=this.extensionManager.transformPastedHTML(s);this.editorView=new Q4(n,{...t,attributes:{role:"textbox",...t?.attributes},dispatchTransaction:i,transformPastedHTML:o,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const l=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(l),this.prependClass(),this.injectCSS();const u=this.view.dom;u.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(n){this.isCapturingTransaction=!0,n(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(n){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=n;return}n.steps.forEach(h=>{var d;return(d=this.capturedTransaction)==null?void 0:d.step(h)});return}const{state:t,transactions:e}=this.state.applyTransaction(n),r=!this.state.selection.eq(t.selection),i=e.includes(n),s=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:n,nextState:t}),!i)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:n,appendedTransactions:e.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:n});const o=e.findLast(h=>h.getMeta("focus")||h.getMeta("blur")),l=o?.getMeta("focus"),u=o?.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:o}),u&&this.emit("blur",{editor:this,event:u.event,transaction:o}),!(n.getMeta("preventUpdate")||!e.some(h=>h.docChanged)||s.doc.eq(t.doc))&&this.emit("update",{editor:this,transaction:n,appendedTransactions:e.slice(1)})}getAttributes(n){return f5(this.state,n)}isActive(n,t){const e=typeof n=="string"?n:null,r=typeof n=="string"?t:n;return yat(this.state,e,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return mA(this.state.doc.content,this.schema)}getText(n){const{blockSeparator:t=`

`,textSerializers:e={}}=n||{};return hat(this.state.doc,{blockSeparator:t,textSerializers:{...h5(this.schema),...e}})}get isEmpty(){return v_(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var n,t;return(t=(n=this.editorView)==null?void 0:n.isDestroyed)!=null?t:!0}$node(n,t){var e;return((e=this.$doc)==null?void 0:e.querySelector(n,t))||null}$nodes(n,t){var e;return((e=this.$doc)==null?void 0:e.querySelectorAll(n,t))||null}$pos(n){const t=this.state.doc.resolve(n);return new tlt(t,this)}get $doc(){return this.$pos(0)}};function hu(n){return new b_({find:n.find,handler:({state:t,range:e,match:r})=>{const i=ge(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=t,o=r[r.length-1],l=r[0];if(o){const u=l.search(/\S/),h=e.from+l.indexOf(o),d=h+o.length;if(gA(e.from,e.to,t.doc).filter(v=>v.mark.type.excluded.find(S=>S===n.type&&S!==v.mark.type)).filter(v=>v.to>h).length)return null;d<e.to&&s.delete(d,e.to),h>e.from&&s.delete(e.from+u,h);const g=e.from+u+o.length;s.addMark(e.from+u,g,n.type.create(i||{})),s.removeStoredMark(n.type)}},undoable:n.undoable})}function ilt(n){return new b_({find:n.find,handler:({state:t,range:e,match:r})=>{const i=ge(n.getAttributes,void 0,r)||{},{tr:s}=t,o=e.from;let l=e.to;const u=n.type.create(i);if(r[1]){const h=r[0].lastIndexOf(r[1]);let d=o+h;d>l?d=l:l=d+r[1].length;const p=r[0][r[0].length-1];s.insertText(p,o+r[0].length-1),s.replaceWith(d,l,u)}else if(r[0]){const h=n.type.isInline?o:o-1;s.insert(h,n.type.create(i)).delete(s.mapping.map(o),s.mapping.map(l))}s.scrollIntoView()},undoable:n.undoable})}function DE(n){return new b_({find:n.find,handler:({state:t,range:e,match:r})=>{const i=t.doc.resolve(e.from),s=ge(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;t.tr.delete(e.from,e.to).setBlockType(e.from,e.from,n.type,s)},undoable:n.undoable})}function nf(n){return new b_({find:n.find,handler:({state:t,range:e,match:r,chain:i})=>{const s=ge(n.getAttributes,void 0,r)||{},o=t.tr.delete(e.from,e.to),u=o.doc.resolve(e.from).blockRange(),h=u&&KC(u,n.type,s);if(!h)return null;if(o.wrap(u,h),n.keepMarks&&n.editor){const{selection:p,storedMarks:g}=t,{splittableMarks:v}=n.editor.extensionManager,T=g||p.$to.parentOffset&&p.$from.marks();if(T){const S=T.filter(w=>v.includes(w.type.name));o.ensureMarks(S)}}if(n.keepAttributes){const p=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(p,s).run()}const d=o.doc.resolve(e.from-1).nodeBefore;d&&d.type===n.type&&Bl(o.doc,e.from-1)&&(!n.joinPredicate||n.joinPredicate(r,d))&&o.join(e.from-1)},undoable:n.undoable})}function slt(n,t){const{selection:e}=n,{$from:r}=e;if(e instanceof Dt){const s=r.index();return r.parent.canReplaceWith(s,s+1,t)}let i=r.depth;for(;i>=0;){const s=r.index(i);if(r.node(i).contentMatchAt(s).matchType(t))return!0;i-=1}return!1}var olt={};hA(olt,{createAtomBlockMarkdownSpec:()=>alt,createBlockMarkdownSpec:()=>llt,createInlineMarkdownSpec:()=>hlt,parseAttributes:()=>vA,parseIndentedBlocks:()=>OE,renderNestedMarkdownContent:()=>_A,serializeAttributes:()=>bA});function vA(n){if(!n?.trim())return{};const t={},e=[],r=n.replace(/["']([^"']*)["']/g,h=>(e.push(h),`__QUOTED_${e.length-1}__`)),i=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const h=i.map(d=>d.trim().slice(1));t.class=h.join(" ")}const s=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);s&&(t.id=s[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(o)).forEach(([,h,d])=>{var p;const g=parseInt(((p=d.match(/__QUOTED_(\d+)__/))==null?void 0:p[1])||"0",10),v=e[g];v&&(t[h]=v.slice(1,-1))});const u=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return u&&u.split(/\s+/).filter(Boolean).forEach(d=>{d.match(/^[a-zA-Z][\w-]*$/)&&(t[d]=!0)}),t}function bA(n){if(!n||Object.keys(n).length===0)return"";const t=[];return n.class&&String(n.class).split(/\s+/).filter(Boolean).forEach(r=>t.push(`.${r}`)),n.id&&t.push(`#${n.id}`),Object.entries(n).forEach(([e,r])=>{e==="class"||e==="id"||(r===!0?t.push(e):r!==!1&&r!=null&&t.push(`${e}="${String(r)}"`))}),t.join(" ")}function alt(n){const{nodeName:t,name:e,parseAttributes:r=vA,serializeAttributes:i=bA,defaultAttributes:s={},requiredAttributes:o=[],allowedAttributes:l}=n,u=e||t,h=d=>{if(!l)return d;const p={};return l.forEach(g=>{g in d&&(p[g]=d[g])}),p};return{parseMarkdown:(d,p)=>{const g={...s,...d.attributes};return p.createNode(t,g,[])},markdownTokenizer:{name:t,level:"block",start(d){var p;const g=new RegExp(`^:::${u}(?:\\s|$)`,"m"),v=(p=d.match(g))==null?void 0:p.index;return v!==void 0?v:-1},tokenize(d,p,g){const v=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),T=d.match(v);if(!T)return;const S=T[1]||"",w=r(S);if(!o.find(D=>!(D in w)))return{type:t,raw:T[0],attributes:w}}},renderMarkdown:d=>{const p=h(d.attrs||{}),g=i(p),v=g?` {${g}}`:"";return`:::${u}${v} :::`}}}function llt(n){const{nodeName:t,name:e,getContent:r,parseAttributes:i=vA,serializeAttributes:s=bA,defaultAttributes:o={},content:l="block",allowedAttributes:u}=n,h=e||t,d=p=>{if(!u)return p;const g={};return u.forEach(v=>{v in p&&(g[v]=p[v])}),g};return{parseMarkdown:(p,g)=>{let v;if(r){const S=r(p);v=typeof S=="string"?[{type:"text",text:S}]:S}else l==="block"?v=g.parseChildren(p.tokens||[]):v=g.parseInline(p.tokens||[]);const T={...o,...p.attributes};return g.createNode(t,T,v)},markdownTokenizer:{name:t,level:"block",start(p){var g;const v=new RegExp(`^:::${h}`,"m"),T=(g=p.match(v))==null?void 0:g.index;return T!==void 0?T:-1},tokenize(p,g,v){var T;const S=new RegExp(`^:::${h}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),w=p.match(S);if(!w)return;const[E,D=""]=w,P=i(D);let V=1;const N=E.length;let q="";const M=/^:::([\w-]*)(\s.*)?/gm,k=p.slice(N);for(M.lastIndex=0;;){const R=M.exec(k);if(R===null)break;const F=R.index,U=R[1];if(!((T=R[2])!=null&&T.endsWith(":::"))){if(U)V+=1;else if(V-=1,V===0){const H=k.slice(0,F);q=H.trim();const j=p.slice(0,N+F+R[0].length);let yt=[];if(q)if(l==="block")for(yt=v.blockTokens(H),yt.forEach(xt=>{xt.text&&(!xt.tokens||xt.tokens.length===0)&&(xt.tokens=v.inlineTokens(xt.text))});yt.length>0;){const xt=yt[yt.length-1];if(xt.type==="paragraph"&&(!xt.text||xt.text.trim()===""))yt.pop();else break}else yt=v.inlineTokens(q);return{type:t,raw:j,attributes:P,content:q,tokens:yt}}}}}},renderMarkdown:(p,g)=>{const v=d(p.attrs||{}),T=s(v),S=T?` {${T}}`:"",w=g.renderChildren(p.content||[],`

`);return`:::${h}${S}

${w}

:::`}}}function clt(n){if(!n.trim())return{};const t={},e=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=e.exec(n);for(;r!==null;){const[,i,s,o]=r;t[i]=s||o,r=e.exec(n)}return t}function ult(n){return Object.entries(n).filter(([,t])=>t!=null).map(([t,e])=>`${t}="${e}"`).join(" ")}function hlt(n){const{nodeName:t,name:e,getContent:r,parseAttributes:i=clt,serializeAttributes:s=ult,defaultAttributes:o={},selfClosing:l=!1,allowedAttributes:u}=n,h=e||t,d=g=>{if(!u)return g;const v={};return u.forEach(T=>{const S=typeof T=="string"?T:T.name,w=typeof T=="string"?void 0:T.skipIfDefault;if(S in g){const E=g[S];if(w!==void 0&&E===w)return;v[S]=E}}),v},p=h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(g,v)=>{const T={...o,...g.attributes};if(l)return v.createNode(t,T);const S=r?r(g):g.content||"";return S?v.createNode(t,T,[v.createTextNode(S)]):v.createNode(t,T,[])},markdownTokenizer:{name:t,level:"inline",start(g){const v=l?new RegExp(`\\[${p}\\s*[^\\]]*\\]`):new RegExp(`\\[${p}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${p}\\]`),T=g.match(v),S=T?.index;return S!==void 0?S:-1},tokenize(g,v,T){const S=l?new RegExp(`^\\[${p}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${p}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${p}\\]`),w=g.match(S);if(!w)return;let E="",D="";if(l){const[,V]=w;D=V}else{const[,V,N]=w;D=V,E=N||""}const P=i(D.trim());return{type:t,raw:w[0],content:E.trim(),attributes:P}}},renderMarkdown:g=>{let v="";r?v=r(g):g.content&&g.content.length>0&&(v=g.content.filter(E=>E.type==="text").map(E=>E.text).join(""));const T=d(g.attrs||{}),S=s(T),w=S?` ${S}`:"";return l?`[${h}${w}]`:`[${h}${w}]${v}[/${h}]`}}}function OE(n,t,e){var r,i,s,o;const l=n.split(`
`),u=[];let h="",d=0;const p=t.baseIndentSize||2;for(;d<l.length;){const g=l[d],v=g.match(t.itemPattern);if(!v){if(u.length>0)break;if(g.trim()===""){d+=1,h=`${h}${g}
`;continue}else return}const T=t.extractItemData(v),{indentLevel:S,mainContent:w}=T;h=`${h}${g}
`;const E=[w];for(d+=1;d<l.length;){const N=l[d];if(N.trim()===""){const M=l.slice(d+1).findIndex(F=>F.trim()!=="");if(M===-1)break;if((((i=(r=l[d+1+M].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:i.length)||0)>S){E.push(N),h=`${h}${N}
`,d+=1;continue}else break}if((((o=(s=N.match(/^(\s*)/))==null?void 0:s[1])==null?void 0:o.length)||0)>S)E.push(N),h=`${h}${N}
`,d+=1;else break}let D;const P=E.slice(1);if(P.length>0){const N=P.map(q=>q.slice(S+p)).join(`
`);N.trim()&&(t.customNestedParser?D=t.customNestedParser(N):D=e.blockTokens(N))}const V=t.createToken(T,D);u.push(V)}if(u.length!==0)return{items:u,raw:h}}function _A(n,t,e,r){if(!n||!Array.isArray(n.content))return"";const i=typeof e=="function"?e(r):e,[s,...o]=n.content,l=t.renderChildren([s]),u=[`${i}${l}`];return o&&o.length>0&&o.forEach(h=>{const d=t.renderChildren([h]);if(d){const p=d.split(`
`).map(g=>g?t.indent(g):"").join(`
`);u.push(p)}}),u.join(`
`)}function flt(n,t,e={}){const{state:r}=t,{doc:i,tr:s}=r,o=n;i.descendants((l,u)=>{const h=s.mapping.map(u),d=s.mapping.map(u)+l.nodeSize;let p=null;if(l.marks.forEach(v=>{if(v!==o)return!1;p=v}),!p)return;let g=!1;if(Object.keys(e).forEach(v=>{e[v]!==p.attrs[v]&&(g=!0)}),g){const v=n.type.create({...n.attrs,...e});s.removeMark(h,d,n.type),s.addMark(h,d,v)}}),s.docChanged&&t.view.dispatch(s)}var ai=class O5 extends yA{constructor(){super(...arguments),this.type="node"}static create(t={}){const e=typeof t=="function"?t():t;return new O5(e)}configure(t){return super.configure(t)}extend(t){const e=typeof t=="function"?t():t;return super.extend(e)}};function Al(n){return new Yat({find:n.find,handler:({state:t,range:e,match:r,pasteEvent:i})=>{const s=ge(n.getAttributes,void 0,r,i);if(s===!1||s===null)return null;const{tr:o}=t,l=r[r.length-1],u=r[0];let h=e.to;if(l){const d=u.search(/\S/),p=e.from+u.indexOf(l),g=p+l.length;if(gA(e.from,e.to,t.doc).filter(T=>T.mark.type.excluded.find(w=>w===n.type&&w!==T.mark.type)).filter(T=>T.to>p).length)return null;g<e.to&&o.delete(g,e.to),p>e.from&&o.delete(e.from+d,p),h=e.from+d+l.length,o.addMark(e.from+d,h,n.type.create(s||{})),o.removeStoredMark(n.type)}}})}const{getOwnPropertyNames:dlt,getOwnPropertySymbols:plt}=Object,{hasOwnProperty:mlt}=Object.prototype;function Fw(n,t){return function(r,i,s){return n(r,i,s)&&t(r,i,s)}}function Uy(n){return function(e,r,i){if(!e||!r||typeof e!="object"||typeof r!="object")return n(e,r,i);const{cache:s}=i,o=s.get(e),l=s.get(r);if(o&&l)return o===r&&l===e;s.set(e,r),s.set(r,e);const u=n(e,r,i);return s.delete(e),s.delete(r),u}}function glt(n){return n?.[Symbol.toStringTag]}function ZP(n){return dlt(n).concat(plt(n))}const ylt=Object.hasOwn||((n,t)=>mlt.call(n,t));function vu(n,t){return n===t||!n&&!t&&n!==n&&t!==t}const vlt="__v",blt="__o",_lt="_owner",{getOwnPropertyDescriptor:tN,keys:eN}=Object;function Tlt(n,t){return n.byteLength===t.byteLength&&Uv(new Uint8Array(n),new Uint8Array(t))}function Slt(n,t,e){let r=n.length;if(t.length!==r)return!1;for(;r-- >0;)if(!e.equals(n[r],t[r],r,r,n,t,e))return!1;return!0}function wlt(n,t){return n.byteLength===t.byteLength&&Uv(new Uint8Array(n.buffer,n.byteOffset,n.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function xlt(n,t){return vu(n.getTime(),t.getTime())}function Elt(n,t){return n.name===t.name&&n.message===t.message&&n.cause===t.cause&&n.stack===t.stack}function Clt(n,t){return n===t}function nN(n,t,e){const r=n.size;if(r!==t.size)return!1;if(!r)return!0;const i=new Array(r),s=n.entries();let o,l,u=0;for(;(o=s.next())&&!o.done;){const h=t.entries();let d=!1,p=0;for(;(l=h.next())&&!l.done;){if(i[p]){p++;continue}const g=o.value,v=l.value;if(e.equals(g[0],v[0],u,p,n,t,e)&&e.equals(g[1],v[1],g[0],v[0],n,t,e)){d=i[p]=!0;break}p++}if(!d)return!1;u++}return!0}const Alt=vu;function klt(n,t,e){const r=eN(n);let i=r.length;if(eN(t).length!==i)return!1;for(;i-- >0;)if(!R5(n,t,e,r[i]))return!1;return!0}function $d(n,t,e){const r=ZP(n);let i=r.length;if(ZP(t).length!==i)return!1;let s,o,l;for(;i-- >0;)if(s=r[i],!R5(n,t,e,s)||(o=tN(n,s),l=tN(t,s),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function Mlt(n,t){return vu(n.valueOf(),t.valueOf())}function Dlt(n,t){return n.source===t.source&&n.flags===t.flags}function rN(n,t,e){const r=n.size;if(r!==t.size)return!1;if(!r)return!0;const i=new Array(r),s=n.values();let o,l;for(;(o=s.next())&&!o.done;){const u=t.values();let h=!1,d=0;for(;(l=u.next())&&!l.done;){if(!i[d]&&e.equals(o.value,l.value,o.value,l.value,n,t,e)){h=i[d]=!0;break}d++}if(!h)return!1}return!0}function Uv(n,t){let e=n.byteLength;if(t.byteLength!==e||n.byteOffset!==t.byteOffset)return!1;for(;e-- >0;)if(n[e]!==t[e])return!1;return!0}function Olt(n,t){return n.hostname===t.hostname&&n.pathname===t.pathname&&n.protocol===t.protocol&&n.port===t.port&&n.hash===t.hash&&n.username===t.username&&n.password===t.password}function R5(n,t,e,r){return(r===_lt||r===blt||r===vlt)&&(n.$$typeof||t.$$typeof)?!0:ylt(t,r)&&e.equals(n[r],t[r],r,r,n,t,e)}const Rlt="[object ArrayBuffer]",Ilt="[object Arguments]",Plt="[object Boolean]",Nlt="[object DataView]",Llt="[object Date]",Vlt="[object Error]",jlt="[object Map]",Flt="[object Number]",Blt="[object Object]",Ult="[object RegExp]",zlt="[object Set]",Hlt="[object String]",$lt={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},qlt="[object URL]",Wlt=Object.prototype.toString;function Glt({areArrayBuffersEqual:n,areArraysEqual:t,areDataViewsEqual:e,areDatesEqual:r,areErrorsEqual:i,areFunctionsEqual:s,areMapsEqual:o,areNumbersEqual:l,areObjectsEqual:u,arePrimitiveWrappersEqual:h,areRegExpsEqual:d,areSetsEqual:p,areTypedArraysEqual:g,areUrlsEqual:v,unknownTagComparators:T}){return function(w,E,D){if(w===E)return!0;if(w==null||E==null)return!1;const P=typeof w;if(P!==typeof E)return!1;if(P!=="object")return P==="number"?l(w,E,D):P==="function"?s(w,E,D):!1;const V=w.constructor;if(V!==E.constructor)return!1;if(V===Object)return u(w,E,D);if(Array.isArray(w))return t(w,E,D);if(V===Date)return r(w,E,D);if(V===RegExp)return d(w,E,D);if(V===Map)return o(w,E,D);if(V===Set)return p(w,E,D);const N=Wlt.call(w);if(N===Llt)return r(w,E,D);if(N===Ult)return d(w,E,D);if(N===jlt)return o(w,E,D);if(N===zlt)return p(w,E,D);if(N===Blt)return typeof w.then!="function"&&typeof E.then!="function"&&u(w,E,D);if(N===qlt)return v(w,E,D);if(N===Vlt)return i(w,E,D);if(N===Ilt)return u(w,E,D);if($lt[N])return g(w,E,D);if(N===Rlt)return n(w,E,D);if(N===Nlt)return e(w,E,D);if(N===Plt||N===Flt||N===Hlt)return h(w,E,D);if(T){let q=T[N];if(!q){const M=glt(w);M&&(q=T[M])}if(q)return q(w,E,D)}return!1}}function Ylt({circular:n,createCustomConfig:t,strict:e}){let r={areArrayBuffersEqual:Tlt,areArraysEqual:e?$d:Slt,areDataViewsEqual:wlt,areDatesEqual:xlt,areErrorsEqual:Elt,areFunctionsEqual:Clt,areMapsEqual:e?Fw(nN,$d):nN,areNumbersEqual:Alt,areObjectsEqual:e?$d:klt,arePrimitiveWrappersEqual:Mlt,areRegExpsEqual:Dlt,areSetsEqual:e?Fw(rN,$d):rN,areTypedArraysEqual:e?Fw(Uv,$d):Uv,areUrlsEqual:Olt,unknownTagComparators:void 0};if(t&&(r=Object.assign({},r,t(r))),n){const i=Uy(r.areArraysEqual),s=Uy(r.areMapsEqual),o=Uy(r.areObjectsEqual),l=Uy(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:l})}return r}function Klt(n){return function(t,e,r,i,s,o,l){return n(t,e,l)}}function Xlt({circular:n,comparator:t,createState:e,equals:r,strict:i}){if(e)return function(l,u){const{cache:h=n?new WeakMap:void 0,meta:d}=e();return t(l,u,{cache:h,equals:r,meta:d,strict:i})};if(n)return function(l,u){return t(l,u,{cache:new WeakMap,equals:r,meta:void 0,strict:i})};const s={cache:void 0,equals:r,meta:void 0,strict:i};return function(l,u){return t(l,u,s)}}const Qlt=zl();zl({strict:!0});zl({circular:!0});zl({circular:!0,strict:!0});zl({createInternalComparator:()=>vu});zl({strict:!0,createInternalComparator:()=>vu});zl({circular:!0,createInternalComparator:()=>vu});zl({circular:!0,createInternalComparator:()=>vu,strict:!0});function zl(n={}){const{circular:t=!1,createInternalComparator:e,createState:r,strict:i=!1}=n,s=Ylt(n),o=Glt(s),l=e?e(o):Klt(o);return Xlt({circular:t,comparator:o,createState:r,equals:l,strict:i})}var Bw={exports:{}},Uw={};var iN;function Jlt(){if(iN)return Uw;iN=1;var n=mm(),t=wB();function e(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var r=typeof Object.is=="function"?Object.is:e,i=t.useSyncExternalStore,s=n.useRef,o=n.useEffect,l=n.useMemo,u=n.useDebugValue;return Uw.useSyncExternalStoreWithSelector=function(h,d,p,g,v){var T=s(null);if(T.current===null){var S={hasValue:!1,value:null};T.current=S}else S=T.current;T=l(function(){function E(q){if(!D){if(D=!0,P=q,q=g(q),v!==void 0&&S.hasValue){var M=S.value;if(v(M,q))return V=M}return V=q}if(M=V,r(P,q))return M;var k=g(q);return v!==void 0&&v(M,k)?(P=q,M):(P=q,V=k)}var D=!1,P,V,N=p===void 0?null:p;return[function(){return E(d())},N===null?void 0:function(){return E(N())}]},[d,p,g,v]);var w=i(h,T[0],T[1]);return o(function(){S.hasValue=!0,S.value=w},[w]),u(w),w},Uw}var sN;function Zlt(){return sN||(sN=1,Bw.exports=Jlt()),Bw.exports}var tct=Zlt(),ect=(...n)=>t=>{n.forEach(e=>{typeof e=="function"?e(t):e&&(e.current=t)})},nct=({contentComponent:n})=>{const t=xB.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot);return B.jsx(B.Fragment,{children:Object.values(t)})};function rct(){const n=new Set;let t={};return{subscribe(e){return n.add(e),()=>{n.delete(e)}},getSnapshot(){return t},getServerSnapshot(){return t},setRenderer(e,r){t={...t,[e]:F9.createPortal(r.reactElement,r.element,e)},n.forEach(i=>i())},removeRenderer(e){const r={...t};delete r[e],t=r,n.forEach(i=>i())}}}var ict=class extends In.Component{constructor(n){var t;super(n),this.editorContentRef=In.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((t=n.editor)!=null&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var n;const t=this.props.editor;if(t&&!t.isDestroyed&&((n=t.view.dom)!=null&&n.parentNode)){if(t.contentComponent)return;const e=this.editorContentRef.current;e.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:e}),t.contentComponent=rct(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var n;const t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!((n=t.view.dom)!=null&&n.parentNode))return;const e=document.createElement("div");e.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:e})}catch{}}}render(){const{editor:n,innerRef:t,...e}=this.props;return B.jsxs(B.Fragment,{children:[B.jsx("div",{ref:ect(t,this.editorContentRef),...e}),n?.contentComponent&&B.jsx(nct,{contentComponent:n.contentComponent})]})}},sct=L.forwardRef((n,t)=>{const e=In.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return In.createElement(ict,{key:e,innerRef:t,...n})}),I5=In.memo(sct),oct=typeof window<"u"?L.useLayoutEffect:L.useEffect,act=class{constructor(n){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=n,this.lastSnapshot={editor:n,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(n){return this.subscribers.add(n),()=>{this.subscribers.delete(n)}}watch(n){if(this.editor=n,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},e=this.editor;return e.on("transaction",t),()=>{e.off("transaction",t)}}}};function lct(n){var t;const[e]=L.useState(()=>new act(n.editor)),r=tct.useSyncExternalStoreWithSelector(e.subscribe,e.getSnapshot,e.getServerSnapshot,n.selector,(t=n.equalityFn)!=null?t:Qlt);return oct(()=>e.watch(n.editor),[n.editor,e]),L.useDebugValue(r),r}var cct=!1,RE=typeof window>"u",uct=RE||!!(typeof window<"u"&&window.next),hct=class P5{constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?RE||uct?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const t={...this.options.current,onBeforeCreate:(...r)=>{var i,s;return(s=(i=this.options.current).onBeforeCreate)==null?void 0:s.call(i,...r)},onBlur:(...r)=>{var i,s;return(s=(i=this.options.current).onBlur)==null?void 0:s.call(i,...r)},onCreate:(...r)=>{var i,s;return(s=(i=this.options.current).onCreate)==null?void 0:s.call(i,...r)},onDestroy:(...r)=>{var i,s;return(s=(i=this.options.current).onDestroy)==null?void 0:s.call(i,...r)},onFocus:(...r)=>{var i,s;return(s=(i=this.options.current).onFocus)==null?void 0:s.call(i,...r)},onSelectionUpdate:(...r)=>{var i,s;return(s=(i=this.options.current).onSelectionUpdate)==null?void 0:s.call(i,...r)},onTransaction:(...r)=>{var i,s;return(s=(i=this.options.current).onTransaction)==null?void 0:s.call(i,...r)},onUpdate:(...r)=>{var i,s;return(s=(i=this.options.current).onUpdate)==null?void 0:s.call(i,...r)},onContentError:(...r)=>{var i,s;return(s=(i=this.options.current).onContentError)==null?void 0:s.call(i,...r)},onDrop:(...r)=>{var i,s;return(s=(i=this.options.current).onDrop)==null?void 0:s.call(i,...r)},onPaste:(...r)=>{var i,s;return(s=(i=this.options.current).onPaste)==null?void 0:s.call(i,...r)},onDelete:(...r)=>{var i,s;return(s=(i=this.options.current).onDelete)==null?void 0:s.call(i,...r)}};return new rlt(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}static compareOptions(t,e){return Object.keys(t).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&t.extensions&&e.extensions?t.extensions.length!==e.extensions.length?!1:t.extensions.every((i,s)=>{var o;return i===((o=e.extensions)==null?void 0:o[s])}):t[r]===e[r])}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&t.length===0?P5.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=t;return}if(this.previousDeps.length===t.length&&this.previousDeps.every((r,i)=>r===t[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,e=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===t){e&&e.setOptions(this.options.current);return}e&&!e.isDestroyed&&(e.destroy(),this.instanceId===t&&this.setEditor(null))},1)}};function fct(n={},t=[]){const e=L.useRef(n);e.current=n;const[r]=L.useState(()=>new hct(e)),i=xB.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return L.useDebugValue(i),L.useEffect(r.onRender(t)),lct({editor:i,selector:({transactionNumber:s})=>n.shouldRerenderOnTransaction===!1||n.shouldRerenderOnTransaction===void 0?null:n.immediatelyRender&&s===0?0:s+1}),i}var N5=L.createContext({editor:null});N5.Consumer;var dct=L.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),pct=()=>L.useContext(dct);In.forwardRef((n,t)=>{const{onDragStart:e}=pct(),r=n.as||"div";return B.jsx(r,{...n,ref:t,"data-node-view-wrapper":"",onDragStart:e,style:{whiteSpace:"normal",...n.style}})});In.createContext({markViewContentRef:()=>{}});var TA=L.createContext({get editor(){throw new Error("useTiptap must be used within a <Tiptap> provider")}});TA.displayName="TiptapContext";var mct=()=>L.useContext(TA);function L5({editor:n,instance:t,children:e}){const r=n??t;if(!r)throw new Error("Tiptap: An editor instance is required. Pass a non-null `editor` prop.");const i=L.useMemo(()=>({editor:r}),[r]),s=L.useMemo(()=>({editor:r}),[r]);return B.jsx(N5.Provider,{value:s,children:B.jsx(TA.Provider,{value:i,children:e})})}L5.displayName="Tiptap";function V5({...n}){const{editor:t}=mct();return B.jsx(I5,{editor:t,...n})}V5.displayName="Tiptap.Content";Object.assign(L5,{Content:V5});var zv=(n,t)=>{if(n==="slot")return 0;if(n instanceof Function)return n(t);const{children:e,...r}=t??{};if(n==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[n,r,e]},gct=/^\s*>\s$/,yct=ai.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return zv("blockquote",{...Je(this.options.HTMLAttributes,n),children:zv("slot",{})})},parseMarkdown:(n,t)=>t.createNode("blockquote",void 0,t.parseChildren(n.tokens||[])),renderMarkdown:(n,t)=>{if(!n.content)return"";const e=">",r=[];return n.content.forEach(i=>{const l=t.renderChildren([i]).split(`
`).map(u=>u.trim()===""?e:`${e} ${u}`);r.push(l.join(`
`))}),r.join(`
${e}
`)},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[nf({find:gct,type:this.type})]}}),vct=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,bct=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,_ct=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Tct=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Sct=ra.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return zv("strong",{...Je(this.options.HTMLAttributes,n),children:zv("slot",{})})},markdownTokenName:"strong",parseMarkdown:(n,t)=>t.applyMark("bold",t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>`**${t.renderChildren(n)}**`,addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[hu({find:vct,type:this.type}),hu({find:_ct,type:this.type})]},addPasteRules(){return[Al({find:bct,type:this.type}),Al({find:Tct,type:this.type})]}}),wct=/(^|[^`])`([^`]+)`(?!`)$/,xct=/(^|[^`])`([^`]+)`(?!`)/g,Ect=ra.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",Je(this.options.HTMLAttributes,n),0]},markdownTokenName:"codespan",parseMarkdown:(n,t)=>t.applyMark("code",[{type:"text",text:n.text||""}]),renderMarkdown:(n,t)=>n.content?`\`${t.renderChildren(n.content)}\``:"",addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[hu({find:wct,type:this.type})]},addPasteRules(){return[Al({find:xct,type:this.type})]}}),zw=4,Cct=/^```([a-z]+)?[\s\n]$/,Act=/^~~~([a-z]+)?[\s\n]$/,kct=ai.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:zw,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var t;const{languageClassPrefix:e}=this.options;if(!e)return null;const s=[...((t=n.firstElementChild)==null?void 0:t.classList)||[]].filter(o=>o.startsWith(e)).map(o=>o.replace(e,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:t}){return["pre",Je(this.options.HTMLAttributes,t),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(n,t)=>{var e;return((e=n.raw)==null?void 0:e.startsWith("```"))===!1&&n.codeBlockStyle!=="indented"?[]:t.createNode("codeBlock",{language:n.lang||null},n.text?[t.createTextNode(n.text)]:[])},renderMarkdown:(n,t)=>{var e;let r="";const i=((e=n.attrs)==null?void 0:e.language)||"";return n.content?r=[`\`\`\`${i}`,t.renderChildren(n.content),"```"].join(`
`):r=`\`\`\`${i}

\`\`\``,r},addCommands(){return{setCodeBlock:n=>({commands:t})=>t.setNode(this.name,n),toggleCodeBlock:n=>({commands:t})=>t.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:t}=this.editor.state.selection,e=t.pos===1;return!n||t.parent.type.name!==this.name?!1:e||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:n})=>{var t;if(!this.options.enableTabIndentation)return!1;const e=(t=this.options.tabSize)!=null?t:zw,{state:r}=n,{selection:i}=r,{$from:s,empty:o}=i;if(s.parent.type!==this.type)return!1;const l=" ".repeat(e);return o?n.commands.insertContent(l):n.commands.command(({tr:u})=>{const{from:h,to:d}=i,v=r.doc.textBetween(h,d,`
`,`
`).split(`
`).map(T=>l+T).join(`
`);return u.replaceWith(h,d,r.schema.text(v)),!0})},"Shift-Tab":({editor:n})=>{var t;if(!this.options.enableTabIndentation)return!1;const e=(t=this.options.tabSize)!=null?t:zw,{state:r}=n,{selection:i}=r,{$from:s,empty:o}=i;return s.parent.type!==this.type?!1:o?n.commands.command(({tr:l})=>{var u;const{pos:h}=s,d=s.start(),p=s.end(),v=r.doc.textBetween(d,p,`
`,`
`).split(`
`);let T=0,S=0;const w=h-d;for(let q=0;q<v.length;q+=1){if(S+v[q].length>=w){T=q;break}S+=v[q].length+1}const D=((u=v[T].match(/^ */))==null?void 0:u[0])||"",P=Math.min(D.length,e);if(P===0)return!0;let V=d;for(let q=0;q<T;q+=1)V+=v[q].length+1;return l.delete(V,V+P),h-V<=P&&l.setSelection(jt.create(l.doc,V)),!0}):n.commands.command(({tr:l})=>{const{from:u,to:h}=i,g=r.doc.textBetween(u,h,`
`,`
`).split(`
`).map(v=>{var T;const S=((T=v.match(/^ */))==null?void 0:T[0])||"",w=Math.min(S.length,e);return v.slice(w)}).join(`
`);return l.replaceWith(u,h,r.schema.text(g)),!0})},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=n,{selection:e}=t,{$from:r,empty:i}=e;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!s||!o?!1:n.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=n,{selection:e,doc:r}=t,{$from:i,empty:s}=e;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const l=i.after();return l===void 0?!1:r.nodeAt(l)?n.commands.command(({tr:h})=>(h.setSelection(Wt.near(r.resolve(l))),!0)):n.commands.exitCode()}}},addInputRules(){return[DE({find:Cct,type:this.type,getAttributes:n=>({language:n[1]})}),DE({find:Act,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new $e({key:new Mn("codeBlockVSCodeHandler"),props:{handlePaste:(n,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const e=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=i?.mode;if(!e||!s)return!1;const{tr:o,schema:l}=n.state,u=l.text(e.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:s},u)),o.selection.$from.parent.type!==this.type&&o.setSelection(jt.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),Mct=ai.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`

`):""}),Dct=ai.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",Je(this.options.HTMLAttributes,n)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:n,chain:t,state:e,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:s}=e;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=r.extensionManager,u=s||i.$to.parentOffset&&i.$from.marks();return t().insertContent({type:this.name}).command(({tr:h,dispatch:d})=>{if(d&&u&&o){const p=u.filter(g=>l.includes(g.type.name));h.ensureMarks(p)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Oct=ai.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:t}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,Je(this.options.HTMLAttributes,t),0]},parseMarkdown:(n,t)=>t.createNode("heading",{level:n.depth||1},t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>{var e;const r=(e=n.attrs)!=null&&e.level?parseInt(n.attrs.level,10):1,i="#".repeat(r);return n.content?`${i} ${t.renderChildren(n.content)}`:""},addCommands(){return{setHeading:n=>({commands:t})=>this.options.levels.includes(n.level)?t.setNode(this.name,n):!1,toggleHeading:n=>({commands:t})=>this.options.levels.includes(n.level)?t.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,t)=>({...n,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(n=>DE({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}}),Rct=ai.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",Je(this.options.HTMLAttributes,n)]},markdownTokenName:"hr",parseMarkdown:(n,t)=>t.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:n,state:t})=>{if(!slt(t,t.schema.nodes[this.name]))return!1;const{selection:e}=t,{$to:r}=e,i=n();return p5(e)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:s,tr:o,dispatch:l})=>{if(l){const{$to:u}=o.selection,h=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?o.setSelection(jt.create(o.doc,u.pos+1)):u.nodeAfter.isBlock?o.setSelection(Dt.create(o.doc,u.pos)):o.setSelection(jt.create(o.doc,u.pos));else{const d=s.schema.nodes[this.options.nextNodeType]||u.parent.type.contentMatch.defaultType,p=d?.create();p&&(o.insert(h,p),o.setSelection(jt.create(o.doc,h+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[ilt({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),Ict=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Pct=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Nct=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Lct=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Vct=ra.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(n,t)=>t.applyMark("italic",t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>`*${t.renderChildren(n)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[hu({find:Ict,type:this.type}),hu({find:Nct,type:this.type})]},addPasteRules(){return[Al({find:Pct,type:this.type}),Al({find:Lct,type:this.type})]}});const jct="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",Fct="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",IE="numeric",PE="ascii",NE="alpha",xp="asciinumeric",sp="alphanumeric",LE="domain",j5="emoji",Bct="scheme",Uct="slashscheme",Hw="whitespace";function zct(n,t){return n in t||(t[n]=[]),t[n]}function Bc(n,t,e){t[IE]&&(t[xp]=!0,t[sp]=!0),t[PE]&&(t[xp]=!0,t[NE]=!0),t[xp]&&(t[sp]=!0),t[NE]&&(t[sp]=!0),t[sp]&&(t[LE]=!0),t[j5]&&(t[LE]=!0);for(const r in t){const i=zct(r,e);i.indexOf(n)<0&&i.push(n)}}function Hct(n,t){const e={};for(const r in t)t[r].indexOf(n)>=0&&(e[r]=!0);return e}function Lr(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}Lr.groups={};Lr.prototype={accepts(){return!!this.t},go(n){const t=this,e=t.j[n];if(e)return e;for(let r=0;r<t.jr.length;r++){const i=t.jr[r][0],s=t.jr[r][1];if(s&&i.test(n))return s}return t.jd},has(n,t=!1){return t?n in this.j:!!this.go(n)},ta(n,t,e,r){for(let i=0;i<n.length;i++)this.tt(n[i],t,e,r)},tr(n,t,e,r){r=r||Lr.groups;let i;return t&&t.j?i=t:(i=new Lr(t),e&&r&&Bc(t,e,r)),this.jr.push([n,i]),i},ts(n,t,e,r){let i=this;const s=n.length;if(!s)return i;for(let o=0;o<s-1;o++)i=i.tt(n[o]);return i.tt(n[s-1],t,e,r)},tt(n,t,e,r){r=r||Lr.groups;const i=this;if(t&&t.j)return i.j[n]=t,t;const s=t;let o,l=i.go(n);if(l?(o=new Lr,Object.assign(o.j,l.j),o.jr.push.apply(o.jr,l.jr),o.jd=l.jd,o.t=l.t):o=new Lr,s){if(r)if(o.t&&typeof o.t=="string"){const u=Object.assign(Hct(o.t,r),e);Bc(s,u,r)}else e&&Bc(s,e,r);o.t=s}return i.j[n]=o,o}};const qt=(n,t,e,r,i)=>n.ta(t,e,r,i),Ge=(n,t,e,r,i)=>n.tr(t,e,r,i),oN=(n,t,e,r,i)=>n.ts(t,e,r,i),ft=(n,t,e,r,i)=>n.tt(t,e,r,i),Mo="WORD",VE="UWORD",F5="ASCIINUMERICAL",B5="ALPHANUMERICAL",am="LOCALHOST",jE="TLD",FE="UTLD",z0="SCHEME",bh="SLASH_SCHEME",SA="NUM",BE="WS",wA="NL",Ep="OPENBRACE",Cp="CLOSEBRACE",Hv="OPENBRACKET",$v="CLOSEBRACKET",qv="OPENPAREN",Wv="CLOSEPAREN",Gv="OPENANGLEBRACKET",Yv="CLOSEANGLEBRACKET",Kv="FULLWIDTHLEFTPAREN",Xv="FULLWIDTHRIGHTPAREN",Qv="LEFTCORNERBRACKET",Jv="RIGHTCORNERBRACKET",Zv="LEFTWHITECORNERBRACKET",tb="RIGHTWHITECORNERBRACKET",eb="FULLWIDTHLESSTHAN",nb="FULLWIDTHGREATERTHAN",rb="AMPERSAND",ib="APOSTROPHE",sb="ASTERISK",Ya="AT",ob="BACKSLASH",ab="BACKTICK",lb="CARET",el="COLON",xA="COMMA",cb="DOLLAR",Vs="DOT",ub="EQUALS",EA="EXCLAMATION",xi="HYPHEN",Ap="PERCENT",hb="PIPE",fb="PLUS",db="POUND",kp="QUERY",CA="QUOTE",U5="FULLWIDTHMIDDLEDOT",AA="SEMI",js="SLASH",Mp="TILDE",pb="UNDERSCORE",z5="EMOJI",mb="SYM";var H5=Object.freeze({__proto__:null,ALPHANUMERICAL:B5,AMPERSAND:rb,APOSTROPHE:ib,ASCIINUMERICAL:F5,ASTERISK:sb,AT:Ya,BACKSLASH:ob,BACKTICK:ab,CARET:lb,CLOSEANGLEBRACKET:Yv,CLOSEBRACE:Cp,CLOSEBRACKET:$v,CLOSEPAREN:Wv,COLON:el,COMMA:xA,DOLLAR:cb,DOT:Vs,EMOJI:z5,EQUALS:ub,EXCLAMATION:EA,FULLWIDTHGREATERTHAN:nb,FULLWIDTHLEFTPAREN:Kv,FULLWIDTHLESSTHAN:eb,FULLWIDTHMIDDLEDOT:U5,FULLWIDTHRIGHTPAREN:Xv,HYPHEN:xi,LEFTCORNERBRACKET:Qv,LEFTWHITECORNERBRACKET:Zv,LOCALHOST:am,NL:wA,NUM:SA,OPENANGLEBRACKET:Gv,OPENBRACE:Ep,OPENBRACKET:Hv,OPENPAREN:qv,PERCENT:Ap,PIPE:hb,PLUS:fb,POUND:db,QUERY:kp,QUOTE:CA,RIGHTCORNERBRACKET:Jv,RIGHTWHITECORNERBRACKET:tb,SCHEME:z0,SEMI:AA,SLASH:js,SLASH_SCHEME:bh,SYM:mb,TILDE:Mp,TLD:jE,UNDERSCORE:pb,UTLD:FE,UWORD:VE,WORD:Mo,WS:BE});const Ao=/[a-z]/,qd=new RegExp("\\p{L}","u"),$w=new RegExp("\\p{Emoji}","u"),ko=/\d/,qw=/\s/,aN="\r",Ww=`
`,$ct="",qct="",Gw="";let zy=null,Hy=null;function Wct(n=[]){const t={};Lr.groups=t;const e=new Lr;zy==null&&(zy=lN(jct)),Hy==null&&(Hy=lN(Fct)),ft(e,"'",ib),ft(e,"{",Ep),ft(e,"}",Cp),ft(e,"[",Hv),ft(e,"]",$v),ft(e,"(",qv),ft(e,")",Wv),ft(e,"<",Gv),ft(e,">",Yv),ft(e,"",Kv),ft(e,"",Xv),ft(e,"",Qv),ft(e,"",Jv),ft(e,"",Zv),ft(e,"",tb),ft(e,"",eb),ft(e,"",nb),ft(e,"&",rb),ft(e,"*",sb),ft(e,"@",Ya),ft(e,"`",ab),ft(e,"^",lb),ft(e,":",el),ft(e,",",xA),ft(e,"$",cb),ft(e,".",Vs),ft(e,"=",ub),ft(e,"!",EA),ft(e,"-",xi),ft(e,"%",Ap),ft(e,"|",hb),ft(e,"+",fb),ft(e,"#",db),ft(e,"?",kp),ft(e,'"',CA),ft(e,"/",js),ft(e,";",AA),ft(e,"~",Mp),ft(e,"_",pb),ft(e,"\\",ob),ft(e,"",U5);const r=Ge(e,ko,SA,{[IE]:!0});Ge(r,ko,r);const i=Ge(r,Ao,F5,{[xp]:!0}),s=Ge(r,qd,B5,{[sp]:!0}),o=Ge(e,Ao,Mo,{[PE]:!0});Ge(o,ko,i),Ge(o,Ao,o),Ge(i,ko,i),Ge(i,Ao,i);const l=Ge(e,qd,VE,{[NE]:!0});Ge(l,Ao),Ge(l,ko,s),Ge(l,qd,l),Ge(s,ko,s),Ge(s,Ao),Ge(s,qd,s);const u=ft(e,Ww,wA,{[Hw]:!0}),h=ft(e,aN,BE,{[Hw]:!0}),d=Ge(e,qw,BE,{[Hw]:!0});ft(e,Gw,d),ft(h,Ww,u),ft(h,Gw,d),Ge(h,qw,d),ft(d,aN),ft(d,Ww),Ge(d,qw,d),ft(d,Gw,d);const p=Ge(e,$w,z5,{[j5]:!0});ft(p,"#"),Ge(p,$w,p),ft(p,$ct,p);const g=ft(p,qct);ft(g,"#"),Ge(g,$w,p);const v=[[Ao,o],[ko,i]],T=[[Ao,null],[qd,l],[ko,s]];for(let S=0;S<zy.length;S++)Ua(e,zy[S],jE,Mo,v);for(let S=0;S<Hy.length;S++)Ua(e,Hy[S],FE,VE,T);Bc(jE,{tld:!0,ascii:!0},t),Bc(FE,{utld:!0,alpha:!0},t),Ua(e,"file",z0,Mo,v),Ua(e,"mailto",z0,Mo,v),Ua(e,"http",bh,Mo,v),Ua(e,"https",bh,Mo,v),Ua(e,"ftp",bh,Mo,v),Ua(e,"ftps",bh,Mo,v),Bc(z0,{scheme:!0,ascii:!0},t),Bc(bh,{slashscheme:!0,ascii:!0},t),n=n.sort((S,w)=>S[0]>w[0]?1:-1);for(let S=0;S<n.length;S++){const w=n[S][0],D=n[S][1]?{[Bct]:!0}:{[Uct]:!0};w.indexOf("-")>=0?D[LE]=!0:Ao.test(w)?ko.test(w)?D[xp]=!0:D[PE]=!0:D[IE]=!0,oN(e,w,w,D)}return oN(e,"localhost",am,{ascii:!0}),e.jd=new Lr(mb),{start:e,tokens:Object.assign({groups:t},H5)}}function $5(n,t){const e=Gct(t.replace(/[A-Z]/g,l=>l.toLowerCase())),r=e.length,i=[];let s=0,o=0;for(;o<r;){let l=n,u=null,h=0,d=null,p=-1,g=-1;for(;o<r&&(u=l.go(e[o]));)l=u,l.accepts()?(p=0,g=0,d=l):p>=0&&(p+=e[o].length,g++),h+=e[o].length,s+=e[o].length,o++;s-=p,o-=g,h-=p,i.push({t:d.t,v:t.slice(s-h,s),s:s-h,e:s})}return i}function Gct(n){const t=[],e=n.length;let r=0;for(;r<e;){let i=n.charCodeAt(r),s,o=i<55296||i>56319||r+1===e||(s=n.charCodeAt(r+1))<56320||s>57343?n[r]:n.slice(r,r+2);t.push(o),r+=o.length}return t}function Ua(n,t,e,r,i){let s;const o=t.length;for(let l=0;l<o-1;l++){const u=t[l];n.j[u]?s=n.j[u]:(s=new Lr(r),s.jr=i.slice(),n.j[u]=s),n=s}return s=new Lr(e),s.jr=i.slice(),n.j[t[o-1]]=s,s}function lN(n){const t=[],e=[];let r=0,i="0123456789";for(;r<n.length;){let s=0;for(;i.indexOf(n[r+s])>=0;)s++;if(s>0){t.push(e.join(""));for(let o=parseInt(n.substring(r,r+s),10);o>0;o--)e.pop();r+=s}else e.push(n[r]),r++}return t}const lm={defaultProtocol:"http",events:null,format:cN,formatHref:cN,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function kA(n,t=null){let e=Object.assign({},lm);n&&(e=Object.assign(e,n instanceof kA?n.o:n));const r=e.ignoreTags,i=[];for(let s=0;s<r.length;s++)i.push(r[s].toUpperCase());this.o=e,t&&(this.defaultRender=t),this.ignoreTags=i}kA.prototype={o:lm,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,t,e){const r=t!=null;let i=this.o[n];return i&&(typeof i=="object"?(i=e.t in i?i[e.t]:lm[n],typeof i=="function"&&r&&(i=i(t,e))):typeof i=="function"&&r&&(i=i(t,e.t,e)),i)},getObj(n,t,e){let r=this.o[n];return typeof r=="function"&&t!=null&&(r=r(t,e.t,e)),r},render(n){const t=n.render(this);return(this.get("render",null,n)||this.defaultRender)(t,n.t,n)}};function cN(n){return n}function q5(n,t){this.t="token",this.v=n,this.tk=t}q5.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const t=this.toString(),e=n.get("truncate",t,this),r=n.get("format",t,this);return e&&r.length>e?r.substring(0,e)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=lm.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const t=this,e=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",e,this),i=n.get("tagName",e,t),s=this.toFormattedString(n),o={},l=n.get("className",e,t),u=n.get("target",e,t),h=n.get("rel",e,t),d=n.getObj("attributes",e,t),p=n.getObj("events",e,t);return o.href=r,l&&(o.class=l),u&&(o.target=u),h&&(o.rel=h),d&&Object.assign(o,d),{tagName:i,attributes:o,content:s,eventListeners:p}}};function T_(n,t){class e extends q5{constructor(i,s){super(i,s),this.t=n}}for(const r in t)e.prototype[r]=t[r];return e.t=n,e}const uN=T_("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),hN=T_("text"),Yct=T_("nl"),$y=T_("url",{isLink:!0,toHref(n=lm.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==am&&n[1].t===el}}),Si=n=>new Lr(n);function Kct({groups:n}){const t=n.domain.concat([rb,sb,Ya,ob,ab,lb,cb,ub,xi,SA,Ap,hb,fb,db,js,mb,Mp,pb]),e=[ib,el,xA,Vs,EA,Ap,kp,CA,AA,Gv,Yv,Ep,Cp,$v,Hv,qv,Wv,Kv,Xv,Qv,Jv,Zv,tb,eb,nb],r=[rb,ib,sb,ob,ab,lb,cb,ub,xi,Ep,Cp,Ap,hb,fb,db,kp,js,mb,Mp,pb],i=Si(),s=ft(i,Mp);qt(s,r,s),qt(s,n.domain,s);const o=Si(),l=Si(),u=Si();qt(i,n.domain,o),qt(i,n.scheme,l),qt(i,n.slashscheme,u),qt(o,r,s),qt(o,n.domain,o);const h=ft(o,Ya);ft(s,Ya,h),ft(l,Ya,h),ft(u,Ya,h);const d=ft(s,Vs);qt(d,r,s),qt(d,n.domain,s);const p=Si();qt(h,n.domain,p),qt(p,n.domain,p);const g=ft(p,Vs);qt(g,n.domain,p);const v=Si(uN);qt(g,n.tld,v),qt(g,n.utld,v),ft(h,am,v);const T=ft(p,xi);ft(T,xi,T),qt(T,n.domain,p),qt(v,n.domain,p),ft(v,Vs,g),ft(v,xi,T);const S=ft(v,el);qt(S,n.numeric,uN);const w=ft(o,xi),E=ft(o,Vs);ft(w,xi,w),qt(w,n.domain,o),qt(E,r,s),qt(E,n.domain,o);const D=Si($y);qt(E,n.tld,D),qt(E,n.utld,D),qt(D,n.domain,o),qt(D,r,s),ft(D,Vs,E),ft(D,xi,w),ft(D,Ya,h);const P=ft(D,el),V=Si($y);qt(P,n.numeric,V);const N=Si($y),q=Si();qt(N,t,N),qt(N,e,q),qt(q,t,N),qt(q,e,q),ft(D,js,N),ft(V,js,N);const M=ft(l,el),k=ft(u,el),R=ft(k,js),F=ft(R,js);qt(l,n.domain,o),ft(l,Vs,E),ft(l,xi,w),qt(u,n.domain,o),ft(u,Vs,E),ft(u,xi,w),qt(M,n.domain,N),ft(M,js,N),ft(M,kp,N),qt(F,n.domain,N),qt(F,t,N),ft(F,js,N);const U=[[Ep,Cp],[Hv,$v],[qv,Wv],[Gv,Yv],[Kv,Xv],[Qv,Jv],[Zv,tb],[eb,nb]];for(let H=0;H<U.length;H++){const[j,yt]=U[H],xt=ft(N,j);ft(q,j,xt),ft(xt,yt,N);const J=Si($y);qt(xt,t,J);const st=Si();qt(xt,e),qt(J,t,J),qt(J,e,st),qt(st,t,J),qt(st,e,st),ft(J,yt,N),ft(st,yt,N)}return ft(i,am,D),ft(i,wA,Yct),{start:i,tokens:H5}}function Xct(n,t,e){let r=e.length,i=0,s=[],o=[];for(;i<r;){let l=n,u=null,h=null,d=0,p=null,g=-1;for(;i<r&&!(u=l.go(e[i].t));)o.push(e[i++]);for(;i<r&&(h=u||l.go(e[i].t));)u=null,l=h,l.accepts()?(g=0,p=l):g>=0&&g++,i++,d++;if(g<0)i-=d,i<r&&(o.push(e[i]),i++);else{o.length>0&&(s.push(Yw(hN,t,o)),o=[]),i-=g,d-=g;const v=p.t,T=e.slice(i-d,i);s.push(Yw(v,t,T))}}return o.length>0&&s.push(Yw(hN,t,o)),s}function Yw(n,t,e){const r=e[0].s,i=e[e.length-1].e,s=t.slice(r,i);return new n(s,e)}const Qct=typeof console<"u"&&console&&console.warn||(()=>{}),Jct="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Pe={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Zct(){return Lr.groups={},Pe.scanner=null,Pe.parser=null,Pe.tokenQueue=[],Pe.pluginQueue=[],Pe.customSchemes=[],Pe.initialized=!1,Pe}function fN(n,t=!1){if(Pe.initialized&&Qct(`linkifyjs: already initialized - will not register custom scheme "${n}" ${Jct}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Pe.customSchemes.push([n,t])}function tut(){Pe.scanner=Wct(Pe.customSchemes);for(let n=0;n<Pe.tokenQueue.length;n++)Pe.tokenQueue[n][1]({scanner:Pe.scanner});Pe.parser=Kct(Pe.scanner.tokens);for(let n=0;n<Pe.pluginQueue.length;n++)Pe.pluginQueue[n][1]({scanner:Pe.scanner,parser:Pe.parser});return Pe.initialized=!0,Pe}function MA(n){return Pe.initialized||tut(),Xct(Pe.parser.start,n,$5(Pe.scanner.start,n))}MA.scan=$5;function W5(n,t=null,e=null){if(t&&typeof t=="object"){if(e)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);e=t,t=null}const r=new kA(e),i=MA(n),s=[];for(let o=0;o<i.length;o++){const l=i[o];l.isLink&&(!t||l.t===t)&&r.check(l)&&s.push(l.toFormattedObject(r))}return s}var DA="[\0- -\u2029]",eut=new RegExp(DA),nut=new RegExp(`${DA}$`),rut=new RegExp(DA,"g");function iut(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function sut(n){return new $e({key:new Mn("autolink"),appendTransaction:(t,e,r)=>{const i=t.some(h=>h.docChanged)&&!e.doc.eq(r.doc),s=t.some(h=>h.getMeta("preventAutolink"));if(!i||s)return;const{tr:o}=r,l=o5(e.doc,[...t]);if(d5(l).forEach(({newRange:h})=>{const d=sat(r.doc,h,v=>v.isTextblock);let p,g;if(d.length>1)p=d[0],g=r.doc.textBetween(p.pos,p.pos+p.node.nodeSize,void 0," ");else if(d.length){const v=r.doc.textBetween(h.from,h.to," "," ");if(!nut.test(v))return;p=d[0],g=r.doc.textBetween(p.pos,h.to,void 0," ")}if(p&&g){const v=g.split(eut).filter(Boolean);if(v.length<=0)return!1;const T=v[v.length-1],S=p.pos+g.lastIndexOf(T);if(!T)return!1;const w=MA(T).map(E=>E.toObject(n.defaultProtocol));if(!iut(w))return!1;w.filter(E=>E.isLink).map(E=>({...E,from:S+E.start+1,to:S+E.end+1})).filter(E=>r.schema.marks.code?!r.doc.rangeHasMark(E.from,E.to,r.schema.marks.code):!0).filter(E=>n.validate(E.value)).filter(E=>n.shouldAutoLink(E.value)).forEach(E=>{gA(E.from,E.to,r.doc).some(D=>D.mark.type===n.type)||o.addMark(E.from,E.to,n.type.create({href:E.href}))})}}),!!o.steps.length)return o}})}function out(n){return new $e({key:new Mn("handleClickLink"),props:{handleClick:(t,e,r)=>{var i,s;if(r.button!==0||!t.editable)return!1;let o=null;if(r.target instanceof HTMLAnchorElement)o=r.target;else{const u=r.target;if(!u)return!1;const h=n.editor.view.dom;o=u.closest("a"),o&&!h.contains(o)&&(o=null)}if(!o)return!1;let l=!1;if(n.enableClickSelection&&(l=n.editor.commands.extendMarkRange(n.type.name)),n.openOnClick){const u=f5(t.state,n.type.name),h=(i=o.href)!=null?i:u.href,d=(s=o.target)!=null?s:u.target;h&&(window.open(h,d),l=!0)}return l}}})}function aut(n){return new $e({key:new Mn("handlePasteLink"),props:{handlePaste:(t,e,r)=>{const{shouldAutoLink:i}=n,{state:s}=t,{selection:o}=s,{empty:l}=o;if(l)return!1;let u="";r.content.forEach(d=>{u+=d.textContent});const h=W5(u,{defaultProtocol:n.defaultProtocol}).find(d=>d.isLink&&d.value===u);return!u||!h||i!==void 0&&!i(h.value)?!1:n.editor.commands.setMark(n.type,{href:h.href})}}})}function wc(n,t){const e=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(r=>{const i=typeof r=="string"?r:r.scheme;i&&e.push(i)}),!n||n.replace(rut,"").match(new RegExp(`^(?:(?:${e.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var lut=ra.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(n=>{if(typeof n=="string"){fN(n);return}fN(n.scheme,n.optionalSlashes)})},onDestroy(){Zct()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(n,t)=>!!wc(n,t.protocols),validate:n=>!!n,shouldAutoLink:n=>{const t=/^[a-z][a-z0-9+.-]*:\/\//i.test(n),e=/^[a-z][a-z0-9+.-]*:/i.test(n);if(t||e&&!n.includes("@"))return!0;const i=(n.includes("@")?n.split("@").pop():n).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(n){return n.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:n=>{const t=n.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:e=>!!wc(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:n}){return this.options.isAllowedUri(n.href,{defaultValidate:t=>!!wc(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Je(this.options.HTMLAttributes,n),0]:["a",Je(this.options.HTMLAttributes,{...n,href:""}),0]},markdownTokenName:"link",parseMarkdown:(n,t)=>t.applyMark("link",t.parseInline(n.tokens||[]),{href:n.href,title:n.title||null}),renderMarkdown:(n,t)=>{var e,r,i,s;const o=(r=(e=n.attrs)==null?void 0:e.href)!=null?r:"",l=(s=(i=n.attrs)==null?void 0:i.title)!=null?s:"",u=t.renderChildren(n);return l?`[${u}](${o} "${l}")`:`[${u}](${o})`},addCommands(){return{setLink:n=>({chain:t})=>{const{href:e}=n;return this.options.isAllowedUri(e,{defaultValidate:r=>!!wc(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,n).setMeta("preventAutolink",!0).run():!1},toggleLink:n=>({chain:t})=>{const{href:e}=n||{};return e&&!this.options.isAllowedUri(e,{defaultValidate:r=>!!wc(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Al({find:n=>{const t=[];if(n){const{protocols:e,defaultProtocol:r}=this.options,i=W5(n).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:o=>!!wc(o,e),protocols:e,defaultProtocol:r}));i.length&&i.forEach(s=>{this.options.shouldAutoLink(s.value)&&t.push({text:s.value,data:{href:s.href},index:s.start})})}return t},type:this.type,getAttributes:n=>{var t;return{href:(t=n.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){const n=[],{protocols:t,defaultProtocol:e}=this.options;return this.options.autolink&&n.push(sut({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:i=>!!wc(i,t),protocols:t,defaultProtocol:e}),shouldAutoLink:this.options.shouldAutoLink})),n.push(out({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&n.push(aut({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),n}}),cut=Object.defineProperty,uut=(n,t)=>{for(var e in t)cut(n,e,{get:t[e],enumerable:!0})},hut="listItem",dN="textStyle",pN=/^\s*([-+*])\s$/,G5=ai.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",Je(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,t)=>n.type!=="list"||n.ordered?[]:{type:"bulletList",content:n.items?t.parseChildren(n.items):[]},renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:n,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(hut,this.editor.getAttributes(dN)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=nf({find:pN,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=nf({find:pN,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(dN),editor:this.editor})),[n]}}),Y5=ai.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",Je(this.options.HTMLAttributes,n),0]},markdownTokenName:"list_item",parseMarkdown:(n,t)=>{if(n.type!=="list_item")return[];let e=[];if(n.tokens&&n.tokens.length>0)if(n.tokens.some(i=>i.type==="paragraph"))e=t.parseChildren(n.tokens);else{const i=n.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(e=[{type:"paragraph",content:t.parseInline(i.tokens)}],n.tokens.length>1){const o=n.tokens.slice(1),l=t.parseChildren(o);e.push(...l)}}else e=t.parseChildren(n.tokens)}return e.length===0&&(e=[{type:"paragraph",content:[]}]),{type:"listItem",content:e}},renderMarkdown:(n,t,e)=>_A(n,t,r=>{var i,s;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((s=(i=r.meta)==null?void 0:i.parentAttrs)==null?void 0:s.start)||1)+r.index}. `:"- "},e),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),fut={};uut(fut,{findListItemPos:()=>Um,getNextListDepth:()=>OA,handleBackspace:()=>UE,handleDelete:()=>zE,hasListBefore:()=>K5,hasListItemAfter:()=>dut,hasListItemBefore:()=>X5,listItemHasSubList:()=>Q5,nextListIsDeeper:()=>J5,nextListIsHigher:()=>Z5});var Um=(n,t)=>{const{$from:e}=t.selection,r=Sn(n,t.schema);let i=null,s=e.depth,o=e.pos,l=null;for(;s>0&&l===null;)i=e.node(s),i.type===r?l=s:(s-=1,o-=1);return l===null?null:{$pos:t.doc.resolve(o),depth:l}},OA=(n,t)=>{const e=Um(n,t);if(!e)return!1;const[,r]=mat(t,n,e.$pos.pos+4);return r},K5=(n,t,e)=>{const{$anchor:r}=n.selection,i=Math.max(0,r.pos-2),s=n.doc.resolve(i).node();return!(!s||!e.includes(s.type.name))},X5=(n,t)=>{var e;const{$anchor:r}=t.selection,i=t.doc.resolve(r.pos-2);return!(i.index()===0||((e=i.nodeBefore)==null?void 0:e.type.name)!==n)},Q5=(n,t,e)=>{if(!e)return!1;const r=Sn(n,t.schema);let i=!1;return e.descendants(s=>{s.type===r&&(i=!0)}),i},UE=(n,t,e)=>{if(n.commands.undoInputRule())return!0;if(n.state.selection.from!==n.state.selection.to)return!1;if(!Cl(n.state,t)&&K5(n.state,t,e)){const{$anchor:l}=n.state.selection,u=n.state.doc.resolve(l.before()-1),h=[];u.node().descendants((g,v)=>{g.type.name===t&&h.push({node:g,pos:v})});const d=h.at(-1);if(!d)return!1;const p=n.state.doc.resolve(u.start()+d.pos+1);return n.chain().cut({from:l.start()-1,to:l.end()+1},p.end()).joinForward().run()}if(!Cl(n.state,t)||!bat(n.state))return!1;const r=Um(t,n.state);if(!r)return!1;const s=n.state.doc.resolve(r.$pos.pos-2).node(r.depth),o=Q5(t,n.state,s);return X5(t,n.state)&&!o?n.commands.joinItemBackward():n.chain().liftListItem(t).run()},J5=(n,t)=>{const e=OA(n,t),r=Um(n,t);return!r||!e?!1:e>r.depth},Z5=(n,t)=>{const e=OA(n,t),r=Um(n,t);return!r||!e?!1:e<r.depth},zE=(n,t)=>{if(!Cl(n.state,t)||!vat(n.state,t))return!1;const{selection:e}=n.state,{$from:r,$to:i}=e;return!e.empty&&r.sameParent(i)?!1:J5(t,n.state)?n.chain().focus(n.state.selection.from+4).lift(t).joinBackward().run():Z5(t,n.state)?n.chain().joinForward().joinBackward().run():n.commands.joinItemForward()},dut=(n,t)=>{var e;const{$anchor:r}=t.selection,i=t.doc.resolve(r.pos-r.parentOffset-2);return!(i.index()===i.parent.childCount-1||((e=i.nodeAfter)==null?void 0:e.type.name)!==n)},tU=ke.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e})=>{n.state.schema.nodes[e]!==void 0&&zE(n,e)&&(t=!0)}),t},"Mod-Delete":({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e})=>{n.state.schema.nodes[e]!==void 0&&zE(n,e)&&(t=!0)}),t},Backspace:({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e,wrapperNames:r})=>{n.state.schema.nodes[e]!==void 0&&UE(n,e,r)&&(t=!0)}),t},"Mod-Backspace":({editor:n})=>{let t=!1;return this.options.listTypes.forEach(({itemName:e,wrapperNames:r})=>{n.state.schema.nodes[e]!==void 0&&UE(n,e,r)&&(t=!0)}),t}}}}),mN=/^(\s*)(\d+)\.\s+(.*)$/,put=/^\s/;function mut(n){const t=[];let e=0,r=0;for(;e<n.length;){const i=n[e],s=i.match(mN);if(!s)break;const[,o,l,u]=s,h=o.length;let d=u,p=e+1;const g=[i];for(;p<n.length;){const v=n[p];if(v.match(mN))break;if(v.trim()==="")g.push(v),d+=`
`,p+=1;else if(v.match(put))g.push(v),d+=`
${v.slice(h+2)}`,p+=1;else break}t.push({indent:h,number:parseInt(l,10),content:d.trim(),raw:g.join(`
`)}),r=p,e=p}return[t,r]}function eU(n,t,e){var r;const i=[];let s=0;for(;s<n.length;){const o=n[s];if(o.indent===t){const l=o.content.split(`
`),u=((r=l[0])==null?void 0:r.trim())||"",h=[];u&&h.push({type:"paragraph",raw:u,tokens:e.inlineTokens(u)});const d=l.slice(1).join(`
`).trim();if(d){const v=e.blockTokens(d);h.push(...v)}let p=s+1;const g=[];for(;p<n.length&&n[p].indent>t;)g.push(n[p]),p+=1;if(g.length>0){const v=Math.min(...g.map(S=>S.indent)),T=eU(g,v,e);h.push({type:"list",ordered:!0,start:g[0].number,items:T,raw:g.map(S=>S.raw).join(`
`)})}i.push({type:"list_item",raw:o.raw,tokens:h}),s=p}else s+=1}return i}function gut(n,t){return n.map(e=>{if(e.type!=="list_item")return t.parseChildren([e])[0];const r=[];return e.tokens&&e.tokens.length>0&&e.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")r.push(...t.parseChildren([i]));else if(i.type==="text"&&i.tokens){const s=t.parseChildren([i]);r.push({type:"paragraph",content:s})}else{const s=t.parseChildren([i]);s.length>0&&r.push(...s)}}),{type:"listItem",content:r}})}var yut="listItem",gN="textStyle",yN=/^(\d+)\.\s$/,nU=ai.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:t,...e}=n;return t===1?["ol",Je(this.options.HTMLAttributes,e),0]:["ol",Je(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,t)=>{if(n.type!=="list"||!n.ordered)return[];const e=n.start||1,r=n.items?gut(n.items,t):[];return e!==1?{type:"orderedList",attrs:{start:e},content:r}:{type:"orderedList",content:r}},renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:n=>{const t=n.match(/^(\s*)(\d+)\.\s+/),e=t?.index;return e!==void 0?e:-1},tokenize:(n,t,e)=>{var r;const i=n.split(`
`),[s,o]=mut(i);if(s.length===0)return;const l=eU(s,0,e);return l.length===0?void 0:{type:"list",ordered:!0,start:((r=s[0])==null?void 0:r.number)||1,items:l,raw:i.slice(0,o).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(yut,this.editor.getAttributes(gN)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=nf({find:yN,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=nf({find:yN,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(gN)}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1],editor:this.editor})),[n]}}),vut=/^\s*(\[([( |x])?\])\s$/,but=ai.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:n=>{const t=n.getAttribute("data-checked");return t===""||t==="true"},renderHTML:n=>({"data-checked":n.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:n,HTMLAttributes:t}){return["li",Je(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:n.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(n,t)=>{const e=[];if(n.tokens&&n.tokens.length>0?e.push(t.createNode("paragraph",{},t.parseInline(n.tokens))):n.text?e.push(t.createNode("paragraph",{},[t.createNode("text",{text:n.text})])):e.push(t.createNode("paragraph",{},[])),n.nestedTokens&&n.nestedTokens.length>0){const r=t.parseChildren(n.nestedTokens);e.push(...r)}return t.createNode("taskItem",{checked:n.checked||!1},e)},renderMarkdown:(n,t)=>{var e;const i=`- [${(e=n.attrs)!=null&&e.checked?"x":" "}] `;return _A(n,t,i)},addKeyboardShortcuts(){const n={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...n,Tab:()=>this.editor.commands.sinkListItem(this.name)}:n},addNodeView(){return({node:n,HTMLAttributes:t,getPos:e,editor:r})=>{const i=document.createElement("li"),s=document.createElement("label"),o=document.createElement("span"),l=document.createElement("input"),u=document.createElement("div"),h=p=>{var g,v;l.ariaLabel=((v=(g=this.options.a11y)==null?void 0:g.checkboxLabel)==null?void 0:v.call(g,p,l.checked))||`Task item checkbox for ${p.textContent||"empty task item"}`};h(n),s.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",p=>p.preventDefault()),l.addEventListener("change",p=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:g}=p.target;r.isEditable&&typeof e=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:v})=>{const T=e();if(typeof T!="number")return!1;const S=v.doc.nodeAt(T);return v.setNodeMarkup(T,void 0,{...S?.attrs,checked:g}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(n,g)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([p,g])=>{i.setAttribute(p,g)}),i.dataset.checked=n.attrs.checked,l.checked=n.attrs.checked,s.append(l,o),i.append(s,u),Object.entries(t).forEach(([p,g])=>{i.setAttribute(p,g)});let d=new Set(Object.keys(t));return{dom:i,contentDOM:u,update:p=>{if(p.type!==this.type)return!1;i.dataset.checked=p.attrs.checked,l.checked=p.attrs.checked,h(p);const g=r.extensionManager.attributes,v=om(p,g),T=new Set(Object.keys(v)),S=this.options.HTMLAttributes;return d.forEach(w=>{T.has(w)||(w in S?i.setAttribute(w,S[w]):i.removeAttribute(w))}),Object.entries(v).forEach(([w,E])=>{E==null?w in S?i.setAttribute(w,S[w]):i.removeAttribute(w):i.setAttribute(w,E)}),d=T,!0}}}},addInputRules(){return[nf({find:vut,type:this.type,getAttributes:n=>({checked:n[n.length-1]==="x"})})]}}),_ut=ai.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:n}){return["ul",Je(this.options.HTMLAttributes,n,{"data-type":this.name}),0]},parseMarkdown:(n,t)=>t.createNode("taskList",{},t.parseChildren(n.items||[])),renderMarkdown:(n,t)=>n.content?t.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(n){var t;const e=(t=n.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:t.index;return e!==void 0?e:-1},tokenize(n,t,e){const r=s=>{const o=OE(s,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:l=>({indentLevel:l[1].length,mainContent:l[4],checked:l[3].toLowerCase()==="x"}),createToken:(l,u)=>({type:"taskItem",raw:"",mainContent:l.mainContent,indentLevel:l.indentLevel,checked:l.checked,text:l.mainContent,tokens:e.inlineTokens(l.mainContent),nestedTokens:u}),customNestedParser:r},e);return o?[{type:"taskList",raw:o.raw,items:o.items}]:e.blockTokens(s)},i=OE(n,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:s=>({indentLevel:s[1].length,mainContent:s[4],checked:s[3].toLowerCase()==="x"}),createToken:(s,o)=>({type:"taskItem",raw:"",mainContent:s.mainContent,indentLevel:s.indentLevel,checked:s.checked,text:s.mainContent,tokens:e.inlineTokens(s.mainContent),nestedTokens:o}),customNestedParser:r},e);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});ke.create({name:"listKit",addExtensions(){const n=[];return this.options.bulletList!==!1&&n.push(G5.configure(this.options.bulletList)),this.options.listItem!==!1&&n.push(Y5.configure(this.options.listItem)),this.options.listKeymap!==!1&&n.push(tU.configure(this.options.listKeymap)),this.options.orderedList!==!1&&n.push(nU.configure(this.options.orderedList)),this.options.taskItem!==!1&&n.push(but.configure(this.options.taskItem)),this.options.taskList!==!1&&n.push(_ut.configure(this.options.taskList)),n}});var vN="&nbsp;",Tut="",Sut=ai.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",Je(this.options.HTMLAttributes,n),0]},parseMarkdown:(n,t)=>{const e=n.tokens||[];if(e.length===1&&e[0].type==="image")return t.parseChildren([e[0]]);const r=t.parseInline(e);return r.length===1&&r[0].type==="text"&&(r[0].text===vN||r[0].text===Tut)?t.createNode("paragraph",void 0,[]):t.createNode("paragraph",void 0,r)},renderMarkdown:(n,t)=>{if(!n)return"";const e=Array.isArray(n.content)?n.content:[];return e.length===0?vN:t.renderChildren(e)},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),wut=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,xut=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Eut=ra.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",Je(this.options.HTMLAttributes,n),0]},markdownTokenName:"del",parseMarkdown:(n,t)=>t.applyMark("strike",t.parseInline(n.tokens||[])),renderMarkdown:(n,t)=>`~~${t.renderChildren(n)}~~`,addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[hu({find:wut,type:this.type})]},addPasteRules(){return[Al({find:xut,type:this.type})]}}),Cut=ai.create({name:"text",group:"inline",parseMarkdown:n=>({type:"text",text:n.text||""}),renderMarkdown:n=>n.text||""}),Aut=ra.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",Je(this.options.HTMLAttributes,n),0]},parseMarkdown(n,t){return t.applyMark(this.name||"underline",t.parseInline(n.tokens||[]))},renderMarkdown(n,t){return`++${t.renderChildren(n)}++`},markdownTokenizer:{name:"underline",level:"inline",start(n){return n.indexOf("++")},tokenize(n,t,e){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(n);if(!i)return;const s=i[2].trim();return{type:"underline",raw:i[0],text:s,tokens:e.inlineTokens(s)}}},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function kut(n={}){return new $e({view(t){return new Mut(t,n)}})}class Mut{constructor(t,e){var r;this.editorView=t,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=e.width)!==null&&r!==void 0?r:1,this.color=e.color===!1?void 0:e.color||"black",this.class=e.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=o=>{this[i](o)};return t.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:t,handler:e})=>this.editorView.dom.removeEventListener(t,e))}update(t,e){this.cursorPos!=null&&e.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,t==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let t=this.editorView.state.doc.resolve(this.cursorPos),e=!t.parent.inlineContent,r,i=this.editorView.dom,s=i.getBoundingClientRect(),o=s.width/i.offsetWidth,l=s.height/i.offsetHeight;if(e){let p=t.nodeBefore,g=t.nodeAfter;if(p||g){let v=this.editorView.nodeDOM(this.cursorPos-(p?p.nodeSize:0));if(v){let T=v.getBoundingClientRect(),S=p?T.bottom:T.top;p&&g&&(S=(S+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*l;r={left:T.left,right:T.right,top:S-w,bottom:S+w}}}}if(!r){let p=this.editorView.coordsAtPos(this.cursorPos),g=this.width/2*o;r={left:p.left-g,right:p.left+g,top:p.top,bottom:p.bottom}}let u=this.editorView.dom.offsetParent;this.element||(this.element=u.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",e),this.element.classList.toggle("prosemirror-dropcursor-inline",!e);let h,d;if(!u||u==document.body&&getComputedStyle(u).position=="static")h=-pageXOffset,d=-pageYOffset;else{let p=u.getBoundingClientRect(),g=p.width/u.offsetWidth,v=p.height/u.offsetHeight;h=p.left-u.scrollLeft*g,d=p.top-u.scrollTop*v}this.element.style.left=(r.left-h)/o+"px",this.element.style.top=(r.top-d)/l+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(t){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),t)}dragover(t){if(!this.editorView.editable)return;let e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),r=e&&e.inside>=0&&this.editorView.state.doc.nodeAt(e.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,e,t):i;if(e&&!s){let o=e.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=QB(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(t){this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}class Ke extends Wt{constructor(t){super(t,t)}map(t,e){let r=t.resolve(e.map(this.head));return Ke.valid(r)?new Ke(r):Wt.near(r)}content(){return vt.empty}eq(t){return t instanceof Ke&&t.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Ke(t.resolve(e.pos))}getBookmark(){return new RA(this.anchor)}static valid(t){let e=t.parent;if(e.isTextblock||!Dut(t)||!Out(t))return!1;let r=e.type.spec.allowGapCursor;if(r!=null)return r;let i=e.contentMatchAt(t.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(t,e,r=!1){t:for(;;){if(!r&&Ke.valid(t))return t;let i=t.pos,s=null;for(let o=t.depth;;o--){let l=t.node(o);if(e>0?t.indexAfter(o)<l.childCount:t.index(o)>0){s=l.child(e>0?t.indexAfter(o):t.index(o)-1);break}else if(o==0)return null;i+=e;let u=t.doc.resolve(i);if(Ke.valid(u))return u}for(;;){let o=e>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!Dt.isSelectable(s)){t=t.doc.resolve(i+s.nodeSize*e),r=!1;continue t}break}s=o,i+=e;let l=t.doc.resolve(i);if(Ke.valid(l))return l}return null}}}Ke.prototype.visible=!1;Ke.findFrom=Ke.findGapCursorFrom;Wt.jsonID("gapcursor",Ke);class RA{constructor(t){this.pos=t}map(t){return new RA(t.map(this.pos))}resolve(t){let e=t.resolve(this.pos);return Ke.valid(e)?new Ke(e):Wt.near(e)}}function rU(n){return n.isAtom||n.spec.isolating||n.spec.createGapCursor}function Dut(n){for(let t=n.depth;t>=0;t--){let e=n.index(t),r=n.node(t);if(e==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(e-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||rU(i.type))return!0;if(i.inlineContent)return!1}}return!0}function Out(n){for(let t=n.depth;t>=0;t--){let e=n.indexAfter(t),r=n.node(t);if(e==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(e);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||rU(i.type))return!0;if(i.inlineContent)return!1}}return!0}function Rut(){return new $e({props:{decorations:Lut,createSelectionBetween(n,t,e){return t.pos==e.pos&&Ke.valid(e)?new Ke(e):null},handleClick:Put,handleKeyDown:Iut,handleDOMEvents:{beforeinput:Nut}}})}const Iut=J4({ArrowLeft:qy("horiz",-1),ArrowRight:qy("horiz",1),ArrowUp:qy("vert",-1),ArrowDown:qy("vert",1)});function qy(n,t){const e=n=="vert"?t>0?"down":"up":t>0?"right":"left";return function(r,i,s){let o=r.selection,l=t>0?o.$to:o.$from,u=o.empty;if(o instanceof jt){if(!s.endOfTextblock(e)||l.depth==0)return!1;u=!1,l=r.doc.resolve(t>0?l.after():l.before())}let h=Ke.findGapCursorFrom(l,t,u);return h?(i&&i(r.tr.setSelection(new Ke(h))),!0):!1}}function Put(n,t,e){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(t);if(!Ke.valid(r))return!1;let i=n.posAtCoords({left:e.clientX,top:e.clientY});return i&&i.inside>-1&&Dt.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new Ke(r))),!0)}function Nut(n,t){if(t.inputType!="insertCompositionText"||!(n.state.selection instanceof Ke))return!1;let{$from:e}=n.state.selection,r=e.parent.contentMatchAt(e.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=ut.empty;for(let o=r.length-1;o>=0;o--)i=ut.from(r[o].createAndFill(null,i));let s=n.state.tr.replace(e.pos,e.pos,new vt(i,0,0));return s.setSelection(jt.near(s.doc.resolve(e.pos+1))),n.dispatch(s),!1}function Lut(n){if(!(n.selection instanceof Ke))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",Ue.create(n.doc,[Tr.widget(n.selection.head,t,{key:"gapcursor"})])}var gb=200,jn=function(){};jn.prototype.append=function(t){return t.length?(t=jn.from(t),!this.length&&t||t.length<gb&&this.leafAppend(t)||this.length<gb&&t.leafPrepend(this)||this.appendInner(t)):this};jn.prototype.prepend=function(t){return t.length?jn.from(t).append(this):this};jn.prototype.appendInner=function(t){return new Vut(this,t)};jn.prototype.slice=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=this.length),t>=e?jn.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))};jn.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)};jn.prototype.forEach=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=this.length),e<=r?this.forEachInner(t,e,r,0):this.forEachInvertedInner(t,e,r,0)};jn.prototype.map=function(t,e,r){e===void 0&&(e=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(t(s,o))},e,r),i};jn.from=function(t){return t instanceof jn?t:t&&t.length?new iU(t):jn.empty};var iU=(function(n){function t(r){n.call(this),this.values=r}n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t;var e={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new t(this.values.slice(i,s))},t.prototype.getInner=function(i){return this.values[i]},t.prototype.forEachInner=function(i,s,o,l){for(var u=s;u<o;u++)if(i(this.values[u],l+u)===!1)return!1},t.prototype.forEachInvertedInner=function(i,s,o,l){for(var u=s-1;u>=o;u--)if(i(this.values[u],l+u)===!1)return!1},t.prototype.leafAppend=function(i){if(this.length+i.length<=gb)return new t(this.values.concat(i.flatten()))},t.prototype.leafPrepend=function(i){if(this.length+i.length<=gb)return new t(i.flatten().concat(this.values))},e.length.get=function(){return this.values.length},e.depth.get=function(){return 0},Object.defineProperties(t.prototype,e),t})(jn);jn.empty=new iU([]);var Vut=(function(n){function t(e,r){n.call(this),this.left=e,this.right=r,this.length=e.length+r.length,this.depth=Math.max(e.depth,r.depth)+1}return n&&(t.__proto__=n),t.prototype=Object.create(n&&n.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},t.prototype.forEachInner=function(r,i,s,o){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},t.prototype.forEachInvertedInner=function(r,i,s,o){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(r,Math.min(i,l),s,o)===!1)return!1},t.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},t.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new t(this.left,i)},t.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new t(i,this.right)},t.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new t(this.left,new t(this.right,r)):new t(this,r)},t})(jn);const jut=500;class Zi{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;e&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=t.tr,l,u,h=[],d=[];return this.items.forEach((p,g)=>{if(!p.step){i||(i=this.remapping(r,g+1),s=i.maps.length),s--,d.push(p);return}if(i){d.push(new Fs(p.map));let v=p.step.map(i.slice(s)),T;v&&o.maybeStep(v).doc&&(T=o.mapping.maps[o.mapping.maps.length-1],h.push(new Fs(T,void 0,void 0,h.length+d.length))),s--,T&&i.appendMap(T,s)}else o.maybeStep(p.step);if(p.selection)return l=i?p.selection.map(i.slice(s)):p.selection,u=new Zi(this.items.slice(0,r).append(d.reverse().concat(h)),this.eventCount-1),!1},this.items.length,0),{remaining:u,transform:o,selection:l}}addTransform(t,e,r,i){let s=[],o=this.eventCount,l=this.items,u=!i&&l.length?l.get(l.length-1):null;for(let d=0;d<t.steps.length;d++){let p=t.steps[d].invert(t.docs[d]),g=new Fs(t.mapping.maps[d],p,e),v;(v=u&&u.merge(g))&&(g=v,d?s.pop():l=l.slice(0,l.length-1)),s.push(g),e&&(o++,e=void 0),i||(u=g)}let h=o-r.depth;return h>But&&(l=Fut(l,h),o-=h),new Zi(l.append(s),o)}remapping(t,e){let r=new tm;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=t?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},t,e),r}addMaps(t){return this.eventCount==0?this:new Zi(this.items.append(t.map(e=>new Fs(e))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-e),s=t.mapping,o=t.steps.length,l=this.eventCount;this.items.forEach(g=>{g.selection&&l--},i);let u=e;this.items.forEach(g=>{let v=s.getMirror(--u);if(v==null)return;o=Math.min(o,v);let T=s.maps[v];if(g.step){let S=t.steps[v].invert(t.docs[v]),w=g.selection&&g.selection.map(s.slice(u+1,v));w&&l++,r.push(new Fs(T,S,w))}else r.push(new Fs(T))},i);let h=[];for(let g=e;g<o;g++)h.push(new Fs(s.maps[g]));let d=this.items.slice(0,i).append(h).append(r),p=new Zi(d,l);return p.emptyItemCount()>jut&&(p=p.compress(this.items.length-r.length)),p}emptyItemCount(){let t=0;return this.items.forEach(e=>{e.step||t++}),t}compress(t=this.items.length){let e=this.remapping(0,t),r=e.maps.length,i=[],s=0;return this.items.forEach((o,l)=>{if(l>=t)i.push(o),o.selection&&s++;else if(o.step){let u=o.step.map(e.slice(r)),h=u&&u.getMap();if(r--,h&&e.appendMap(h,r),u){let d=o.selection&&o.selection.map(e.slice(r));d&&s++;let p=new Fs(h.invert(),u,d),g,v=i.length-1;(g=i.length&&i[v].merge(p))?i[v]=g:i.push(p)}}else o.map&&r--},this.items.length,0),new Zi(jn.from(i.reverse()),s)}}Zi.empty=new Zi(jn.empty,0);function Fut(n,t){let e;return n.forEach((r,i)=>{if(r.selection&&t--==0)return e=i,!1}),n.slice(e)}class Fs{constructor(t,e,r,i){this.map=t,this.step=e,this.selection=r,this.mirrorOffset=i}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new Fs(e.getMap().invert(),e,this.selection)}}}class Ka{constructor(t,e,r,i,s){this.done=t,this.undone=e,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const But=20;function Uut(n,t,e,r){let i=e.getMeta(Xc),s;if(i)return i.historyState;e.getMeta($ut)&&(n=new Ka(n.done,n.undone,null,0,-1));let o=e.getMeta("appendedTransaction");if(e.steps.length==0)return n;if(o&&o.getMeta(Xc))return o.getMeta(Xc).redo?new Ka(n.done.addTransform(e,void 0,r,H0(t)),n.undone,bN(e.mapping.maps),n.prevTime,n.prevComposition):new Ka(n.done,n.undone.addTransform(e,void 0,r,H0(t)),null,n.prevTime,n.prevComposition);if(e.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=e.getMeta("composition"),u=n.prevTime==0||!o&&n.prevComposition!=l&&(n.prevTime<(e.time||0)-r.newGroupDelay||!zut(e,n.prevRanges)),h=o?Kw(n.prevRanges,e.mapping):bN(e.mapping.maps);return new Ka(n.done.addTransform(e,u?t.selection.getBookmark():void 0,r,H0(t)),Zi.empty,h,e.time,l??n.prevComposition)}else return(s=e.getMeta("rebased"))?new Ka(n.done.rebased(e,s),n.undone.rebased(e,s),Kw(n.prevRanges,e.mapping),n.prevTime,n.prevComposition):new Ka(n.done.addMaps(e.mapping.maps),n.undone.addMaps(e.mapping.maps),Kw(n.prevRanges,e.mapping),n.prevTime,n.prevComposition)}function zut(n,t){if(!t)return!1;if(!n.docChanged)return!0;let e=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<t.length;s+=2)r<=t[s+1]&&i>=t[s]&&(e=!0)}),e}function bN(n){let t=[];for(let e=n.length-1;e>=0&&t.length==0;e--)n[e].forEach((r,i,s,o)=>t.push(s,o));return t}function Kw(n,t){if(!n)return null;let e=[];for(let r=0;r<n.length;r+=2){let i=t.map(n[r],1),s=t.map(n[r+1],-1);i<=s&&e.push(i,s)}return e}function Hut(n,t,e){let r=H0(t),i=Xc.get(t).spec.config,s=(e?n.undone:n.done).popEvent(t,r);if(!s)return null;let o=s.selection.resolve(s.transform.doc),l=(e?n.done:n.undone).addTransform(s.transform,t.selection.getBookmark(),i,r),u=new Ka(e?l:s.remaining,e?s.remaining:l,null,0,-1);return s.transform.setSelection(o).setMeta(Xc,{redo:e,historyState:u})}let Xw=!1,_N=null;function H0(n){let t=n.plugins;if(_N!=t){Xw=!1,_N=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){Xw=!0;break}}return Xw}const Xc=new Mn("history"),$ut=new Mn("closeHistory");function qut(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new $e({key:Xc,state:{init(){return new Ka(Zi.empty,Zi.empty,null,0,-1)},apply(t,e,r){return Uut(e,r,t,n)}},config:n,props:{handleDOMEvents:{beforeinput(t,e){let r=e.inputType,i=r=="historyUndo"?oU:r=="historyRedo"?aU:null;return!i||!t.editable?!1:(e.preventDefault(),i(t.state,t.dispatch))}}}})}function sU(n,t){return(e,r)=>{let i=Xc.getState(e);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let s=Hut(i,e,n);s&&r(t?s.scrollIntoView():s)}return!0}}const oU=sU(!1,!0),aU=sU(!0,!0);ke.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:n=>n.length,wordCounter:n=>n.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=n=>{const t=n?.node||this.editor.state.doc;if((n?.mode||this.options.mode)==="textSize"){const r=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(r)}return t.nodeSize},this.storage.words=n=>{const t=n?.node||this.editor.state.doc,e=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(e)}},addProseMirrorPlugins(){let n=!1;return[new $e({key:new Mn("characterCount"),appendTransaction:(t,e,r)=>{if(n)return;const i=this.options.limit;if(i==null||i===0){n=!0;return}const s=this.storage.characters({node:r.doc});if(s>i){const o=s-i,l=0,u=o;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const h=r.tr.deleteRange(l,u);return n=!0,h}n=!0},filterTransaction:(t,e)=>{const r=this.options.limit;if(!t.docChanged||r===0||r===null||r===void 0)return!0;const i=this.storage.characters({node:e.doc}),s=this.storage.characters({node:t.doc});if(s<=r||i>r&&s>r&&s<=i)return!0;if(i>r&&s>r&&s>i||!t.getMeta("paste"))return!1;const l=t.selection.$head.pos,u=s-r,h=l-u,d=l;return t.deleteRange(h,d),!(this.storage.characters({node:t.doc})>r)}})]}});var Wut=ke.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[kut(this.options)]}});ke.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new $e({key:new Mn("focus"),props:{decorations:({doc:n,selection:t})=>{const{isEditable:e,isFocused:r}=this.editor,{anchor:i}=t,s=[];if(!e||!r)return Ue.create(n,[]);let o=0;this.options.mode==="deepest"&&n.descendants((u,h)=>{if(u.isText)return;if(!(i>=h&&i<=h+u.nodeSize-1))return!1;o+=1});let l=0;return n.descendants((u,h)=>{if(u.isText||!(i>=h&&i<=h+u.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&o-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";s.push(Tr.node(h,h+u.nodeSize,{class:this.options.className}))}),Ue.create(n,s)}}})]}});var Gut=ke.create({name:"gapCursor",addProseMirrorPlugins(){return[Rut()]},extendNodeSchema(n){var t;const e={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(t=ge(Et(n,"allowGapCursor",e)))!=null?t:null}}}),TN="placeholder";function Yut(n){return n.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}ke.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:TN,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const n=this.options.dataAttribute?`data-${Yut(this.options.dataAttribute)}`:`data-${TN}`;return[new $e({key:new Mn("placeholder"),props:{decorations:({doc:t,selection:e})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=e,s=[];if(!r)return null;const o=this.editor.isEmpty;return t.descendants((l,u)=>{const h=i>=u&&i<=u+l.nodeSize,d=!l.isLeaf&&v_(l);if((h||!this.options.showOnlyCurrent)&&d){const p=[this.options.emptyNodeClass];o&&p.push(this.options.emptyEditorClass);const g=Tr.node(u,u+l.nodeSize,{class:p.join(" "),[n]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:l,pos:u,hasAnchor:h}):this.options.placeholder});s.push(g)}return this.options.includeChildren}),Ue.create(t,s)}}})]}});ke.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:n,options:t}=this;return[new $e({key:new Mn("selection"),props:{decorations(e){return e.selection.empty||n.isFocused||!n.isEditable||p5(e.selection)||n.view.dragging?null:Ue.create(e.doc,[Tr.inline(e.selection.from,e.selection.to,{class:t.className})])}}})]}});function SN({types:n,node:t}){return t&&Array.isArray(n)&&n.includes(t.type)||t?.type===n}var Kut=ke.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var n;const t=new Mn(this.name),e=this.options.node||((n=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:n.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(e).includes(i.name));return[new $e({key:t,appendTransaction:(i,s,o)=>{const{doc:l,tr:u,schema:h}=o,d=t.getState(o),p=l.content.size,g=h.nodes[e];if(d)return u.insert(p,g.create())},state:{init:(i,s)=>{const o=s.tr.doc.lastChild;return!SN({node:o,types:r})},apply:(i,s)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return s;const o=i.doc.lastChild;return!SN({node:o,types:r})}}})]}}),Xut=ke.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:t})=>oU(n,t),redo:()=>({state:n,dispatch:t})=>aU(n,t)}},addProseMirrorPlugins(){return[qut(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Qut=ke.create({name:"starterKit",addExtensions(){var n,t,e,r;const i=[];return this.options.bold!==!1&&i.push(Sct.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(yct.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(G5.configure(this.options.bulletList)),this.options.code!==!1&&i.push(Ect.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(kct.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(Mct.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(Wut.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(Gut.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(Dct.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(Oct.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(Xut.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(Rct.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(Vct.configure(this.options.italic)),this.options.listItem!==!1&&i.push(Y5.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(tU.configure((n=this.options)==null?void 0:n.listKeymap)),this.options.link!==!1&&i.push(lut.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&i.push(nU.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(Sut.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(Eut.configure(this.options.strike)),this.options.text!==!1&&i.push(Cut.configure(this.options.text)),this.options.underline!==!1&&i.push(Aut.configure((e=this.options)==null?void 0:e.underline)),this.options.trailingNode!==!1&&i.push(Kut.configure((r=this.options)==null?void 0:r.trailingNode)),i}}),Jut=Qut,Zut=20,lU=(n,t=0)=>{const e=[];return!n.children.length||t>Zut||Array.from(n.children).forEach(r=>{r.tagName==="SPAN"?e.push(r):r.children.length&&e.push(...lU(r,t+1))}),e},tht=n=>{if(!n.children.length)return;const t=lU(n);t&&t.forEach(e=>{var r,i;const s=e.getAttribute("style"),o=(i=(r=e.parentElement)==null?void 0:r.closest("span"))==null?void 0:i.getAttribute("style");e.setAttribute("style",`${o};${s}`)})},cU=ra.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:n=>n.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&tht(n),{}):!1}]},renderHTML({HTMLAttributes:n}){return["span",Je(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleTextStyle:n=>({commands:t})=>t.toggleMark(this.name,n),removeEmptyTextStyle:()=>({tr:n})=>{const{selection:t}=n;return n.doc.nodesBetween(t.from,t.to,(e,r)=>{if(e.isTextblock)return!0;e.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(s=>!!s))||n.removeMark(r,r+e.nodeSize,this.type)}),!0}}}}),eht=ke.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:n=>{var t;const e=n.getAttribute("style");if(e){const r=e.split(";").map(i=>i.trim()).filter(Boolean);for(let i=r.length-1;i>=0;i-=1){const s=r[i].split(":");if(s.length>=2){const o=s[0].trim().toLowerCase(),l=s.slice(1).join(":").trim();if(o==="background-color")return l.replace(/['"]+/g,"")}}}return(t=n.style.backgroundColor)==null?void 0:t.replace(/['"]+/g,"")},renderHTML:n=>n.backgroundColor?{style:`background-color: ${n.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:n=>({chain:t})=>t().setMark("textStyle",{backgroundColor:n}).run(),unsetBackgroundColor:()=>({chain:n})=>n().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),uU=ke.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:n=>{var t;const e=n.getAttribute("style");if(e){const r=e.split(";").map(i=>i.trim()).filter(Boolean);for(let i=r.length-1;i>=0;i-=1){const s=r[i].split(":");if(s.length>=2){const o=s[0].trim().toLowerCase(),l=s.slice(1).join(":").trim();if(o==="color")return l.replace(/['"]+/g,"")}}}return(t=n.style.color)==null?void 0:t.replace(/['"]+/g,"")},renderHTML:n=>n.color?{style:`color: ${n.color}`}:{}}}}]},addCommands(){return{setColor:n=>({chain:t})=>t().setMark("textStyle",{color:n}).run(),unsetColor:()=>({chain:n})=>n().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),hU=ke.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:n=>n.style.fontFamily,renderHTML:n=>n.fontFamily?{style:`font-family: ${n.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:n=>({chain:t})=>t().setMark("textStyle",{fontFamily:n}).run(),unsetFontFamily:()=>({chain:n})=>n().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),fU=ke.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:n=>n.style.fontSize,renderHTML:n=>n.fontSize?{style:`font-size: ${n.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:n=>({chain:t})=>t().setMark("textStyle",{fontSize:n}).run(),unsetFontSize:()=>({chain:n})=>n().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),nht=ke.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:n=>n.style.lineHeight,renderHTML:n=>n.lineHeight?{style:`line-height: ${n.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:n=>({chain:t})=>t().setMark("textStyle",{lineHeight:n}).run(),unsetLineHeight:()=>({chain:n})=>n().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});ke.create({name:"textStyleKit",addExtensions(){const n=[];return this.options.backgroundColor!==!1&&n.push(eht.configure(this.options.backgroundColor)),this.options.color!==!1&&n.push(uU.configure(this.options.color)),this.options.fontFamily!==!1&&n.push(hU.configure(this.options.fontFamily)),this.options.fontSize!==!1&&n.push(fU.configure(this.options.fontSize)),this.options.lineHeight!==!1&&n.push(nht.configure(this.options.lineHeight)),this.options.textStyle!==!1&&n.push(cU.configure(this.options.textStyle)),n}});var rht=uU,iht=hU,sht=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,oht=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,aht=ra.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",Je(this.options.HTMLAttributes,n),0]},renderMarkdown:(n,t)=>`==${t.renderChildren(n)}==`,parseMarkdown:(n,t)=>t.applyMark("highlight",t.parseInline(n.tokens||[])),markdownTokenizer:{name:"highlight",level:"inline",start:n=>n.indexOf("=="),tokenize(n,t,e){const i=/^(==)([^=]+)(==)/.exec(n);if(i){const s=i[2].trim(),o=e.inlineTokens(s);return{type:"highlight",raw:i[0],text:s,tokens:o}}}},addCommands(){return{setHighlight:n=>({commands:t})=>t.setMark(this.name,n),toggleHighlight:n=>({commands:t})=>t.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[hu({find:sht,type:this.type})]},addPasteRules(){return[Al({find:oht,type:this.type})]}}),lht=aht;function cht(n,t,e){if(n===null)return{newStreak:1};const r=Xh(n),i=Xh(t),s=fB(i,r);return s===0?{newStreak:e}:s===1?{newStreak:e+1}:{newStreak:1}}function dU(n){return typeof n!="string"||n.trim().length===0?{valid:!1,error:"Title is required"}:n.trim().length>zI?{valid:!1,error:`Title must be ${zI} characters or less`}:{valid:!0}}function uht(n){return fE.includes(n)?{valid:!0}:{valid:!1,error:`Mood must be one of: ${fE.join(", ")}`}}function hht(n){if(!Array.isArray(n))return{valid:!1,error:"Images must be an array"};if(n.length>kc)return{valid:!1,error:`Maximum ${kc} images allowed`};for(let t=0;t<n.length;t++)if(typeof n[t]!="string"||n[t].trim().length===0)return{valid:!1,error:`Image at index ${t} must be a non-empty string`};return{valid:!0}}function pU(n){return!(n instanceof Date)||isNaN(n.getTime())?{valid:!1,error:"Date must be a valid Date object"}:n>new Date?{valid:!1,error:"Entry date cannot be in the future"}:{valid:!0}}function fht(n){const t=[],e=dU(n?.title);e.valid||t.push(e.error);const r=uht(n?.mood);r.valid||t.push(r.error);const i=hht(n?.images??[]);i.valid||t.push(i.error);const s=pU(n?.date);return s.valid||t.push(s.error),t.length>0?{valid:!1,errors:t}:{valid:!0}}async function dht(n,t,e){const r=fht(t);if(!r.valid)throw new Error(r.errors.join(", "));const i=ue.now(),s={userId:n,date:ue.fromDate(t.date),title:t.title.trim(),content:t.content,mood:t.mood,images:t.images??[],drawingURL:t.drawingURL??null,theme:t.theme,updatedAt:i};let o;return await sK(ni,async l=>{if(e){const u=Ho(ni,"entries",e),h=await l.get(u);if(!h.exists())throw new Error("Entry not found");if(h.data().userId!==n)throw new Error("Permission denied");l.update(u,s),o=e}else{const u=Ho(mv(ni,"entries"));l.set(u,{...s,createdAt:i}),o=u.id;const h=Ho(ni,"users",n),d=await l.get(h);if(!d.exists())throw new Error("User not found");const p=d.data(),g=p.lastEntryDate?.toDate()??null,v=p.streak??0,T=p.longestStreak??0,{newStreak:S}=cht(g,t.date,v);l.update(h,{streak:S,longestStreak:Math.max(T,S),lastEntryDate:ue.fromDate(t.date)})}}),o}async function pht(n,t,e){const r=pB(new Date(t,e)),i=dB(new Date(t,e)),s=ue.fromDate(r),o=ue.fromDate(i),l=mv(ni,"entries"),u=Nx(l,Lh("userId","==",n),Lh("date",">=",s),Lh("date","<=",o),Lx("date","asc"));return(await Vx(u)).docs.map(d=>{const p=d.data();return{entryId:d.id,date:p.date.toDate(),title:p.title,mood:p.mood}})}async function mU(n,t){const e=Ho(ni,"entries",n),r=await e_(e);if(!r.exists())throw new Error("Entry not found");const i=r.data();if(i.userId!==t)throw new Error("Permission denied");return{entryId:r.id,...i}}async function mht(n,t,e){if(!e)throw new Error("No file provided");if(e.size>_B)throw new Error("Image must be under 5MB");if(!TB.includes(e.type))throw new Error("Please upload a JPEG, PNG, GIF, or WebP image");const r=`images/${n}/${t}/${e.name}`,i=T3(S3,r),s=await b3(i,e);return await _3(s.ref)}async function ght(n,t,e){const i=await(await fetch(e)).blob(),s=`drawings/${n}/${t}.png`,o=T3(S3,s),l=await b3(o,i);return await _3(l.ref)}const yht=[{label:"Poppins",value:"Poppins"},{label:"Caveat",value:"Caveat"},{label:"Pacifico",value:"Pacifico"}],vht=[{label:"S",value:"14px"},{label:"M",value:"18px"},{label:"L",value:"24px"}],bht=["#4A2040","#1E3A5F","#744210","#22543D","#2D3748","#FF69B4","#63B3ED","#ECC94B","#48BB78","#A0AEC0","#E53E3E","#805AD5","#DD6B20","#319795","#718096"],_ht=["#FFE4E1","#E6E6FA","#FEFCBF","#F0FFF4","#EBF8FF","#FFF0F5","#FED7E2","#FEEBC8","#C6F6D5","#BEE3F8"];function Tht({editor:n}){if(!n)return null;const t=L.useCallback(s=>{n.chain().focus().setFontFamily(s).run()},[n]),e=L.useCallback(s=>{n.chain().focus().setFontSize(s).run()},[n]),r=L.useCallback(s=>{n.chain().focus().setColor(s).run()},[n]),i=L.useCallback(s=>{n.chain().focus().toggleHighlight({color:s}).run()},[n]);return B.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-3 bg-pink-50/80 rounded-2xl border border-pink-100 mb-4",children:[B.jsxs("div",{className:"flex items-center gap-1",children:[B.jsx("label",{className:"sr-only",htmlFor:"font-family-select",children:"Font family"}),B.jsx("select",{id:"font-family-select",onChange:s=>t(s.target.value),className:"px-2 py-1.5 rounded-lg bg-white border border-pink-200 text-sm font-['Poppins'] text-gray-700 cursor-pointer focus:outline-none focus:ring-2 focus:ring-pink-300","aria-label":"Font family",children:yht.map(s=>B.jsx("option",{value:s.value,style:{fontFamily:s.value},children:s.label},s.value))})]}),B.jsx("div",{className:"w-px h-6 bg-pink-200","aria-hidden":"true"}),B.jsx("div",{className:"flex items-center gap-1",role:"group","aria-label":"Font size",children:vht.map(s=>B.jsx("button",{type:"button",onClick:()=>e(s.value),className:"px-2.5 py-1 rounded-lg text-sm font-['Poppins'] bg-white border border-pink-200 hover:bg-pink-100 transition-colors text-gray-700","aria-label":`Font size ${s.label}`,children:s.label},s.value))}),B.jsx("div",{className:"w-px h-6 bg-pink-200","aria-hidden":"true"}),B.jsxs("div",{className:"flex items-center gap-1",role:"group","aria-label":"Text formatting",children:[B.jsx("button",{type:"button",onClick:()=>n.chain().focus().toggleBold().run(),className:`px-2.5 py-1 rounded-lg text-sm font-bold border transition-colors ${n.isActive("bold")?"bg-pink-200 border-pink-300 text-pink-800":"bg-white border-pink-200 hover:bg-pink-100 text-gray-700"}`,"aria-label":"Bold","aria-pressed":n.isActive("bold"),children:"B"}),B.jsx("button",{type:"button",onClick:()=>n.chain().focus().toggleItalic().run(),className:`px-2.5 py-1 rounded-lg text-sm italic border transition-colors ${n.isActive("italic")?"bg-pink-200 border-pink-300 text-pink-800":"bg-white border-pink-200 hover:bg-pink-100 text-gray-700"}`,"aria-label":"Italic","aria-pressed":n.isActive("italic"),children:"I"}),B.jsx("button",{type:"button",onClick:()=>n.chain().focus().toggleStrike().run(),className:`px-2.5 py-1 rounded-lg text-sm line-through border transition-colors ${n.isActive("strike")?"bg-pink-200 border-pink-300 text-pink-800":"bg-white border-pink-200 hover:bg-pink-100 text-gray-700"}`,"aria-label":"Strikethrough","aria-pressed":n.isActive("strike"),children:"S"})]}),B.jsx("div",{className:"w-px h-6 bg-pink-200","aria-hidden":"true"}),B.jsxs("div",{className:"flex items-center gap-1",children:[B.jsx("span",{className:"text-xs font-['Poppins'] text-gray-500 mr-1",children:"Text"}),B.jsx("div",{className:"flex flex-wrap gap-1",role:"group","aria-label":"Text color",children:bht.map(s=>B.jsx("button",{type:"button",onClick:()=>r(s),className:"w-5 h-5 rounded-full border border-gray-200 hover:scale-125 transition-transform cursor-pointer",style:{backgroundColor:s},"aria-label":`Text color ${s}`},s))})]}),B.jsx("div",{className:"w-px h-6 bg-pink-200","aria-hidden":"true"}),B.jsxs("div",{className:"flex items-center gap-1",children:[B.jsx("span",{className:"text-xs font-['Poppins'] text-gray-500 mr-1",children:"Highlight"}),B.jsx("div",{className:"flex flex-wrap gap-1",role:"group","aria-label":"Highlight color",children:_ht.map(s=>B.jsx("button",{type:"button",onClick:()=>i(s),className:"w-5 h-5 rounded-full border border-gray-200 hover:scale-125 transition-transform cursor-pointer",style:{backgroundColor:s},"aria-label":`Highlight color ${s}`},s))})]})]})}function W(n,t,e){return(t=(function(r){var i=(function(s,o){if(typeof s!="object"||!s)return s;var l=s[Symbol.toPrimitive];if(l!==void 0){var u=l.call(s,o);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(s)})(r,"string");return typeof i=="symbol"?i:i+""})(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}class wN{constructor(){W(this,"browserShadowBlurConstant",1),W(this,"DPI",96),W(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),W(this,"perfLimitSizeTotal",2097152),W(this,"maxCacheSideLimit",4096),W(this,"minCacheSideLimit",256),W(this,"disableStyleCopyPaste",!1),W(this,"enableGLFiltering",!0),W(this,"textureSize",4096),W(this,"forceGLPutImageData",!1),W(this,"cachesBoundsOfCurve",!1),W(this,"fontPaths",{}),W(this,"NUM_FRACTION_DIGITS",4)}}const ve=new class extends wN{constructor(n){super(),this.configure(n)}configure(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,n)}addFonts(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths={...this.fontPaths,...n}}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>{delete this.fontPaths[n]})}clearFonts(){this.fontPaths={}}restoreDefaults(n){const t=new wN,e=n?.reduce((r,i)=>(r[i]=t[i],r),{})||t;this.configure(e)}},kl=function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return console[n]("fabric",...e)};class $s extends Error{constructor(t,e){super(`fabric: ${t}`,e)}}class Sht extends $s{constructor(t){super(`${t} 'options.signal' is in 'aborted' state`)}}class wht{}class xht extends wht{testPrecision(t,e){const r=`precision ${e} float;
void main(){}`,i=t.createShader(t.FRAGMENT_SHADER);return!!i&&(t.shaderSource(i,r),t.compileShader(i),!!t.getShaderParameter(i,t.COMPILE_STATUS))}queryWebGL(t){const e=t.getContext("webgl");e&&(this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(r=>this.testPrecision(e,r)),e.getExtension("WEBGL_lose_context").loseContext(),kl("log",`WebGL: max texture size ${this.maxTextureSize}`))}isSupported(t){return!!this.maxTextureSize&&this.maxTextureSize>=t}}const Eht={};let xN;const io=()=>xN||(xN={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new xht,dispose(){},copyPasteData:Eht}),Tf=()=>io().document,S_=()=>io().window,gU=()=>{var n;return Math.max((n=ve.devicePixelRatio)!==null&&n!==void 0?n:S_().devicePixelRatio,1)},Dp=new class{constructor(){W(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(n){let{fontFamily:t,fontStyle:e,fontWeight:r}=n;t=t.toLowerCase();const i=this.charWidthsCache;i.has(t)||i.set(t,new Map);const s=i.get(t),o=`${e.toLowerCase()}_${(r+"").toLowerCase()}`;return s.has(o)||s.set(o,new Map),s.get(o)}clearFontCache(n){n?this.charWidthsCache.delete((n||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(n){const{perfLimitSizeTotal:t}=ve,e=Math.sqrt(t*n);return[Math.floor(e),Math.floor(t/e)]}},HE="7.2.0";function $0(){}const zm=Math.PI/2,Cht=Math.PI/4,rf=2*Math.PI,IA=Math.PI/180,xr=Object.freeze([1,0,0,1,0,0]),PA=16,za=.4477152502,Gt="center",fe="left",Fr="top",$E="bottom",on="right",Br="none",NA=/\r?\n/,yU="moving",w_="scaling",vU="rotating",LA="rotate",bU="skewing",cm="resizing",Aht="modifyPoly",kht="modifyPath",yb="changed",x_="scale",Ur="scaleX",Ii="scaleY",Sf="skewX",wf="skewY",Fn="fill",si="stroke",vb="modified",Dc="ltr",Ro="rtl",qE="normal",hh="json",Qw="svg",_t=new class{constructor(){this[hh]=new Map,this[Qw]=new Map}has(n){return this[hh].has(n)}getClass(n){const t=this[hh].get(n);if(!t)throw new $s(`No class registered for ${n}`);return t}setClass(n,t){t?this[hh].set(t,n):(this[hh].set(n.type,n),this[hh].set(n.type.toLowerCase(),n))}getSVGClass(n){return this[Qw].get(n)}setSVGClass(n,t){this[Qw].set(t??n.type.toLowerCase(),n)}},bb=new class extends Array{remove(n){const t=this.indexOf(n);t>-1&&this.splice(t,1)}cancelAll(){const n=this.splice(0);return n.forEach(t=>t.abort()),n}cancelByCanvas(n){if(!n)return[];const t=this.filter(e=>{var r;return e.target===n||typeof e.target=="object"&&((r=e.target)===null||r===void 0?void 0:r.canvas)===n});return t.forEach(e=>e.abort()),t}cancelByTarget(n){if(!n)return[];const t=this.filter(e=>e.target===n);return t.forEach(e=>e.abort()),t}};class Mht{constructor(){W(this,"__eventListeners",{})}on(t,e){if(this.__eventListeners||(this.__eventListeners={}),typeof t=="object")return Object.entries(t).forEach(r=>{let[i,s]=r;this.on(i,s)}),()=>this.off(t);if(e){const r=t;return this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(e),()=>this.off(r,e)}return()=>!1}once(t,e){if(typeof t=="object"){const r=[];return Object.entries(t).forEach(i=>{let[s,o]=i;r.push(this.once(s,o))}),()=>r.forEach(i=>i())}if(e){const r=this.on(t,function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];e.call(this,...s),r()});return r}return()=>!1}_removeEventListener(t,e){if(this.__eventListeners[t])if(e){const r=this.__eventListeners[t],i=r.indexOf(e);i>-1&&r.splice(i,1)}else this.__eventListeners[t]=[]}off(t,e){if(this.__eventListeners)if(t===void 0)for(const r in this.__eventListeners)this._removeEventListener(r);else typeof t=="object"?Object.entries(t).forEach(r=>{let[i,s]=r;this._removeEventListener(i,s)}):this._removeEventListener(t,e)}fire(t,e){var r;if(!this.__eventListeners)return;const i=(r=this.__eventListeners[t])===null||r===void 0?void 0:r.concat();if(i)for(let s=0;s<i.length;s++)i[s].call(this,e||{})}}const _h=(n,t)=>{const e=n.indexOf(t);return e!==-1&&n.splice(e,1),n},Zo=n=>{if(n===0)return 1;switch(Math.abs(n)/zm){case 1:case 3:return 0;case 2:return-1}return Math.cos(n)},ta=n=>{if(n===0)return 0;const t=n/zm,e=Math.sign(n);switch(t){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(n)};class tt{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}add(t){return new tt(this.x+t.x,this.y+t.y)}addEquals(t){return this.x+=t.x,this.y+=t.y,this}scalarAdd(t){return new tt(this.x+t,this.y+t)}scalarAddEquals(t){return this.x+=t,this.y+=t,this}subtract(t){return new tt(this.x-t.x,this.y-t.y)}subtractEquals(t){return this.x-=t.x,this.y-=t.y,this}scalarSubtract(t){return new tt(this.x-t,this.y-t)}scalarSubtractEquals(t){return this.x-=t,this.y-=t,this}multiply(t){return new tt(this.x*t.x,this.y*t.y)}scalarMultiply(t){return new tt(this.x*t,this.y*t)}scalarMultiplyEquals(t){return this.x*=t,this.y*=t,this}divide(t){return new tt(this.x/t.x,this.y/t.y)}scalarDivide(t){return new tt(this.x/t,this.y/t)}scalarDivideEquals(t){return this.x/=t,this.y/=t,this}eq(t){return this.x===t.x&&this.y===t.y}lt(t){return this.x<t.x&&this.y<t.y}lte(t){return this.x<=t.x&&this.y<=t.y}gt(t){return this.x>t.x&&this.y>t.y}gte(t){return this.x>=t.x&&this.y>=t.y}lerp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return e=Math.max(Math.min(1,e),0),new tt(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)}distanceFrom(t){const e=this.x-t.x,r=this.y-t.y;return Math.sqrt(e*e+r*r)}midPointFrom(t){return this.lerp(t)}min(t){return new tt(Math.min(this.x,t.x),Math.min(this.y,t.y))}max(t){return new tt(Math.max(this.x,t.x),Math.max(this.y,t.y))}toString(){return`${this.x},${this.y}`}setXY(t,e){return this.x=t,this.y=e,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setFromPoint(t){return this.x=t.x,this.y=t.y,this}swap(t){const e=this.x,r=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=r}clone(){return new tt(this.x,this.y)}rotate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:VA;const r=ta(t),i=Zo(t),s=this.subtract(e);return new tt(s.x*i-s.y*r,s.x*r+s.y*i).add(e)}transform(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new tt(t[0]*this.x+t[2]*this.y+(e?0:t[4]),t[1]*this.x+t[3]*this.y+(e?0:t[5]))}}const VA=new tt(0,0),q0=n=>!!n&&Array.isArray(n._objects);function _U(n){class t extends n{constructor(){super(...arguments),W(this,"_objects",[])}_onObjectAdded(r){}_onObjectRemoved(r){}_onStackOrderChanged(r){}add(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];const o=this._objects.push(...i);return i.forEach(l=>this._onObjectAdded(l)),o}insertAt(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return this._objects.splice(r,0,...s),s.forEach(l=>this._onObjectAdded(l)),this._objects.length}remove(){const r=this._objects,i=[];for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return o.forEach(u=>{const h=r.indexOf(u);h!==-1&&(r.splice(h,1),i.push(u),this._onObjectRemoved(u))}),i}forEachObject(r){this.getObjects().forEach((i,s,o)=>r(i,s,o))}getObjects(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return i.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...i))}item(r){return this._objects[r]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(r,i){return!!this._objects.includes(r)||!!i&&this._objects.some(s=>s instanceof t&&s.contains(r,!0))}complexity(){return this._objects.reduce((r,i)=>r+=i.complexity?i.complexity():0,0)}sendObjectToBack(r){return!(!r||r===this._objects[0])&&(_h(this._objects,r),this._objects.unshift(r),this._onStackOrderChanged(r),!0)}bringObjectToFront(r){return!(!r||r===this._objects[this._objects.length-1])&&(_h(this._objects,r),this._objects.push(r),this._onStackOrderChanged(r),!0)}sendObjectBackwards(r,i){if(!r)return!1;const s=this._objects.indexOf(r);if(s!==0){const o=this.findNewLowerIndex(r,s,i);return _h(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0}return!1}bringObjectForward(r,i){if(!r)return!1;const s=this._objects.indexOf(r);if(s!==this._objects.length-1){const o=this.findNewUpperIndex(r,s,i);return _h(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0}return!1}moveObjectTo(r,i){return r!==this._objects[i]&&(_h(this._objects,r),this._objects.splice(i,0,r),this._onStackOrderChanged(r),!0)}findNewLowerIndex(r,i,s){let o;if(s){o=i;for(let l=i-1;l>=0;--l)if(r.isOverlapping(this._objects[l])){o=l;break}}else o=i-1;return o}findNewUpperIndex(r,i,s){let o;if(s){o=i;for(let l=i+1;l<this._objects.length;++l)if(r.isOverlapping(this._objects[l])){o=l;break}}else o=i+1;return o}collectObjects(r){let{left:i,top:s,width:o,height:l}=r,{includeIntersecting:u=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=[],d=new tt(i,s),p=d.add(new tt(o,l));for(let g=this._objects.length-1;g>=0;g--){const v=this._objects[g];v.selectable&&v.visible&&(u&&v.intersectsWithRect(d,p)||v.isContainedWithinRect(d,p)||u&&v.containsPoint(d)||u&&v.containsPoint(p))&&h.push(v)}return h}}return t}class TU extends Mht{_setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const e in t)this.set(e,t[e])}_setObject(t){for(const e in t)this._set(e,t[e])}set(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this}_set(t,e){this[t]=e}toggle(t){const e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this}get(t){return this[t]}}function W0(n){return S_().requestAnimationFrame(n)}function Dht(n){return S_().cancelAnimationFrame(n)}let Oht=0;const Ml=()=>Oht++,ea=()=>{const n=Tf().createElement("canvas");if(!n||n.getContext===void 0)throw new $s("Failed to create `canvas` element");return n},Rht=()=>Tf().createElement("img"),Pi=n=>{const t=ea();return t.width=n.width,t.height=n.height,t},SU=(n,t,e)=>n.toDataURL(`image/${t}`,e),wU=(n,t,e)=>new Promise((r,i)=>{n.toBlob(r,`image/${t}`,e)}),an=n=>n*IA,Dl=n=>n/IA,Iht=n=>n.every((t,e)=>t===xr[e]),Nr=(n,t,e)=>new tt(n).transform(t,e),rs=n=>{const t=1/(n[0]*n[3]-n[1]*n[2]),e=[t*n[3],-t*n[1],-t*n[2],t*n[0],0,0],{x:r,y:i}=new tt(n[4],n[5]).transform(e,!0);return e[4]=-r,e[5]=-i,e},Zn=(n,t,e)=>[n[0]*t[0]+n[2]*t[1],n[1]*t[0]+n[3]*t[1],n[0]*t[2]+n[2]*t[3],n[1]*t[2]+n[3]*t[3],e?0:n[0]*t[4]+n[2]*t[5]+n[4],e?0:n[1]*t[4]+n[3]*t[5]+n[5]],jA=(n,t)=>n.reduceRight((e,r)=>r&&e?Zn(r,e,t):r||e,void 0)||xr.concat(),xU=n=>{let[t,e]=n;return Math.atan2(e,t)},_b=n=>{const t=xU(n),e=Math.pow(n[0],2)+Math.pow(n[1],2),r=Math.sqrt(e),i=(n[0]*n[3]-n[2]*n[1])/r,s=Math.atan2(n[0]*n[2]+n[1]*n[3],e);return{angle:Dl(t),scaleX:r,scaleY:i,skewX:Dl(s),skewY:0,translateX:n[4]||0,translateY:n[5]||0}},Hm=function(n){return[1,0,0,1,n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function xf(){let{angle:n=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:t=0,y:e=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=an(n),i=Zo(r),s=ta(r);return[i,s,-s,i,t?t-(i*t-s*e):0,e?e-(s*t+i*e):0]}const FA=function(n){return[n,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,0,0]},EU=n=>Math.tan(an(n)),CU=n=>[1,0,EU(n),1,0,0],AU=n=>[1,EU(n),0,1,0,0],E_=n=>{let{scaleX:t=1,scaleY:e=1,flipX:r=!1,flipY:i=!1,skewX:s=0,skewY:o=0}=n,l=FA(r?-t:t,i?-e:e);return s&&(l=Zn(l,CU(s),!0)),o&&(l=Zn(l,AU(o),!0)),l},Pht=n=>{const{translateX:t=0,translateY:e=0,angle:r=0}=n;let i=Hm(t,e);r&&(i=Zn(i,xf({angle:r})));const s=E_(n);return Iht(s)||(i=Zn(i,s)),i},G0=function(n){let{signal:t,crossOrigin:e=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,i){if(t&&t.aborted)return i(new Sht("loadImage"));const s=Rht();let o;t&&(o=function(u){s.src="",i(u)},t.addEventListener("abort",o,{once:!0}));const l=function(){s.onload=s.onerror=null,o&&t?.removeEventListener("abort",o),r(s)};n?(s.onload=l,s.onerror=function(){o&&t?.removeEventListener("abort",o),i(new $s(`Error loading ${s.src}`))},e&&(s.crossOrigin=e),s.src=n):l()})},um=function(n){let{signal:t,reviver:e=$0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((r,i)=>{const s=[];t&&t.addEventListener("abort",i,{once:!0}),Promise.all(n.map(o=>_t.getClass(o.type).fromObject(o,{signal:t}).then(l=>(e(o,l),s.push(l),l)))).then(r).catch(o=>{s.forEach(l=>{l.dispose&&l.dispose()}),i(o)}).finally(()=>{t&&t.removeEventListener("abort",i)})})},C_=function(n){let{signal:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((e,r)=>{const i=[];t&&t.addEventListener("abort",r,{once:!0});const s=Object.values(n).map(l=>l&&l.type&&_t.has(l.type)?um([l],{signal:t}).then(u=>{let[h]=u;return i.push(h),h}):l),o=Object.keys(n);Promise.all(s).then(l=>l.reduce((u,h,d)=>(u[o[d]]=h,u),{})).then(e).catch(l=>{i.forEach(u=>{u.dispose&&u.dispose()}),r(l)}).finally(()=>{t&&t.removeEventListener("abort",r)})})},Ef=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((t,e)=>(e in n&&(t[e]=n[e]),t),{})},BA=(n,t)=>Object.keys(n).reduce((e,r)=>(t(n[r],r,n)&&(e[r]=n[r]),e),{}),Me=(n,t)=>parseFloat(Number(n).toFixed(t)),hm=n=>"matrix("+n.map(t=>Me(t,ve.NUM_FRACTION_DIGITS)).join(" ")+")",Ai=n=>!!n&&n.toLive!==void 0,EN=n=>!!n&&typeof n.toObject=="function",CN=n=>!!n&&n.offsetX!==void 0&&"source"in n,Oc=n=>!!n&&"multiSelectionStacking"in n;function kU(n){const t=n&&ts(n);let e=0,r=0;if(!n||!t)return{left:e,top:r};let i=n;const s=t.documentElement,o=t.body||{scrollLeft:0,scrollTop:0};for(;i&&(i.parentNode||i.host)&&(i=i.parentNode||i.host,i===t?(e=o.scrollLeft||s.scrollLeft||0,r=o.scrollTop||s.scrollTop||0):(e+=i.scrollLeft||0,r+=i.scrollTop||0),i.nodeType!==1||i.style.position!=="fixed"););return{left:e,top:r}}const ts=n=>n.ownerDocument||null,MU=n=>{var t;return((t=n.ownerDocument)===null||t===void 0?void 0:t.defaultView)||null},DU=function(n,t,e){let{width:r,height:i}=e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;n.width=r,n.height=i,s>1&&(n.setAttribute("width",(r*s).toString()),n.setAttribute("height",(i*s).toString()),t.scale(s,s))},WE=(n,t)=>{let{width:e,height:r}=t;e&&(n.style.width=typeof e=="number"?`${e}px`:e),r&&(n.style.height=typeof r=="number"?`${r}px`:r)};function AN(n){return n.onselectstart!==void 0&&(n.onselectstart=()=>!1),n.style.userSelect=Br,n}class OU{constructor(t){W(this,"_originalCanvasStyle",void 0),W(this,"lower",void 0);const e=this.createLowerCanvas(t);this.lower={el:e,ctx:e.getContext("2d")}}createLowerCanvas(t){const e=(r=t)&&r.getContext!==void 0?t:t&&Tf().getElementById(t)||ea();var r;if(e.hasAttribute("data-fabric"))throw new $s("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=e.style.cssText,e.setAttribute("data-fabric","main"),e.classList.add("lower-canvas"),e}cleanupDOM(t){let{width:e,height:r}=t;const{el:i}=this.lower;i.classList.remove("lower-canvas"),i.removeAttribute("data-fabric"),i.setAttribute("width",`${e}`),i.setAttribute("height",`${r}`),i.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(t,e){const{el:r,ctx:i}=this.lower;DU(r,i,t,e)}setCSSDimensions(t){WE(this.lower.el,t)}calcOffset(){return(function(t){var e;const r=t&&ts(t),i={left:0,top:0};if(!r)return i;const s=((e=MU(t))===null||e===void 0?void 0:e.getComputedStyle(t,null))||{};i.left+=parseInt(s.borderLeftWidth,10)||0,i.top+=parseInt(s.borderTopWidth,10)||0,i.left+=parseInt(s.paddingLeft,10)||0,i.top+=parseInt(s.paddingTop,10)||0;let o={left:0,top:0};const l=r.documentElement;t.getBoundingClientRect!==void 0&&(o=t.getBoundingClientRect());const u=kU(t);return{left:o.left+u.left-(l.clientLeft||0)+i.left,top:o.top+u.top-(l.clientTop||0)+i.top}})(this.lower.el)}dispose(){io().dispose(this.lower.el),delete this.lower}}const Nht={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...xr],patternQuality:"best"},ne=n=>n.toString().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let Wd;const UA=n=>{if(Wd||Wd||(Wd="Intl"in S_()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),Wd){const t=Wd.segment(n);return Array.from(t).map(e=>{let{segment:r}=e;return r})}return Lht(n)},Lht=n=>{const t=[];for(let e,r=0;r<n.length;r++)(e=Vht(n,r))!==!1&&t.push(e);return t},Vht=(n,t)=>{const e=n.charCodeAt(t);if(isNaN(e))return"";if(e<55296||e>57343)return n.charAt(t);if(55296<=e&&e<=56319){if(n.length<=t+1)throw"High surrogate without following low surrogate";const i=n.charCodeAt(t+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return n.charAt(t)+n.charAt(t+1)}if(t===0)throw"Low surrogate without preceding high surrogate";const r=n.charCodeAt(t-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1};class $m extends _U(TU){get lowerCanvasEl(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.el}get contextContainer(){var t;return(t=this.elements.lower)===null||t===void 0?void 0:t.ctx}static getDefaults(){return $m.ownDefaults}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(e),this.initElements(t),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(t){this.elements=new OU(t)}add(){const t=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}insertAt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];const s=super.insertAt(t,...r);return r.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){const t=super.remove(...arguments);return t.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),t}_onObjectAdded(t){t.canvas&&t.canvas!==this&&(kl("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),t.canvas.remove(t)),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t){t._set("canvas",void 0),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?gU():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}_setDimensionsImpl(t){let{cssOnly:e=!1,backstoreOnly:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!e){const i={width:this.width,height:this.height,...t};this.elements.setDimensions(i,this.getRetinaScaling()),this.hasLostContext=!0,this.width=i.width,this.height=i.height}r||this.elements.setCSSDimensions(t),this.calcOffset()}setDimensions(t,e){this._setDimensionsImpl(t,e),e&&e.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(t){this.viewportTransform=t,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(t,e){const r=t,i=[...this.viewportTransform],s=Nr(t,rs(i));i[0]=e,i[3]=e;const o=Nr(s,i);i[4]+=r.x-o.x,i[5]+=r.y-o.y,this.setViewportTransform(i)}setZoom(t){this.zoomToPoint(new tt(0,0),t)}absolutePan(t){const e=[...this.viewportTransform];return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)}relativePan(t){return this.absolutePan(new tt(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(t){t.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=W0(()=>this.renderAndReset()))}calcViewportBoundaries(){const t=this.width,e=this.height,r=rs(this.viewportTransform),i=Nr({x:0,y:0},r),s=Nr({x:t,y:e},r),o=i.min(s),l=i.max(s);return this.vptCoords={tl:o,tr:new tt(l.x,o.y),bl:new tt(o.x,l.y),br:l}}cancelRequestedRender(){this.nextRenderHandle&&(Dht(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(t){}renderCanvas(t,e){if(this.destroyed)return;const r=this.viewportTransform,i=this.clipPath;this.calcViewportBoundaries(),this.clearContext(t),t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.patternQuality=this.patternQuality,this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(t,e),t.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(t),i&&(i._set("canvas",this),i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t,i)),this._renderOverlay(t),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(t),this.fire("after:render",{ctx:t}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(t,e){const r=this.viewportTransform;t.save(),t.transform(...r),t.globalCompositeOperation="destination-in",e.transform(t),t.scale(1/e.zoomX,1/e.zoomY),t.drawImage(e._cacheCanvas,-e.cacheTranslationX,-e.cacheTranslationY),t.restore()}_renderObjects(t,e){for(let r=0,i=e.length;r<i;++r)e[r]&&e[r].render(t)}_renderBackgroundOrOverlay(t,e){const r=this[`${e}Color`],i=this[`${e}Image`],s=this.viewportTransform,o=this[`${e}Vpt`];if(!r&&!i)return;const l=Ai(r);if(r){if(t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=l?r.toLive(t):r,o&&t.transform(...s),l){t.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);const u=r.gradientTransform||r.patternTransform;u&&t.transform(...u)}t.fill(),t.restore()}if(i){t.save();const{skipOffscreen:u}=this;this.skipOffscreen=o,o&&t.transform(...s),i.render(t),this.skipOffscreen=u,t.restore()}}_renderBackground(t){this._renderBackgroundOrOverlay(t,"background")}_renderOverlay(t){this._renderBackgroundOrOverlay(t,"overlay")}getCenterPoint(){return new tt(this.width/2,this.height/2)}centerObjectH(t){return this._centerObject(t,new tt(this.getCenterPoint().x,t.getCenterPoint().y))}centerObjectV(t){return this._centerObject(t,new tt(t.getCenterPoint().x,this.getCenterPoint().y))}centerObject(t){return this._centerObject(t,this.getCenterPoint())}viewportCenterObject(t){return this._centerObject(t,this.getVpCenter())}viewportCenterObjectH(t){return this._centerObject(t,new tt(this.getVpCenter().x,t.getCenterPoint().y))}viewportCenterObjectV(t){return this._centerObject(t,new tt(t.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Nr(this.getCenterPoint(),rs(this.viewportTransform))}_centerObject(t,e){t.setXY(e,Gt,Gt),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(t){return this.toDatalessObject(t)}toObject(t){return this._toObjectMethod("toObject",t)}toJSON(){return this.toObject()}toDatalessObject(t){return this._toObjectMethod("toDatalessObject",t)}_toObjectMethod(t,e){const r=this.clipPath,i=r&&!r.excludeFromExport?this._toObject(r,t,e):null;return{version:HE,...Ef(this,e),objects:this._objects.filter(s=>!s.excludeFromExport).map(s=>this._toObject(s,t,e)),...this.__serializeBgOverlay(t,e),...i?{clipPath:i}:null}}_toObject(t,e,r){let i;this.includeDefaultValues||(i=t.includeDefaultValues,t.includeDefaultValues=!1);const s=t[e](r);return this.includeDefaultValues||(t.includeDefaultValues=!!i),s}__serializeBgOverlay(t,e){const r={},i=this.backgroundImage,s=this.overlayImage,o=this.backgroundColor,l=this.overlayColor;return Ai(o)?o.excludeFromExport||(r.background=o.toObject(e)):o&&(r.background=o),Ai(l)?l.excludeFromExport||(r.overlay=l.toObject(e)):l&&(r.overlay=l),i&&!i.excludeFromExport&&(r.backgroundImage=this._toObject(i,t,e)),s&&!s.excludeFromExport&&(r.overlayImage=this._toObject(s,t,e)),r}toSVG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;t.reviver=e;const r=[];var i;return this._setSVGPreamble(r,t),this._setSVGHeader(r,t),this.clipPath&&r.push(`<g clip-path="url(#${ne((i=this.clipPath.clipPathId)!==null&&i!==void 0?i:"")})" >
`),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",e),this._setSVGObjects(r,e),this.clipPath&&r.push(`</g>
`),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",e),r.push("</svg>"),r.join("")}_setSVGPreamble(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(t,e){const r=e.width||`${this.width}`,i=e.height||`${this.height}`,s=ve.NUM_FRACTION_DIGITS,o=e.viewBox;let l;if(o)l=`viewBox="${o.x} ${o.y} ${o.width} ${o.height}" `;else if(this.svgViewportTransformation){const u=this.viewportTransform;l=`viewBox="${Me(-u[4]/u[0],s)} ${Me(-u[5]/u[3],s)} ${Me(this.width/u[0],s)} ${Me(this.height/u[3],s)}" `}else l=`viewBox="0 0 ${this.width} ${this.height}" `;t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',i,'" ',l,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",HE,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),`</defs>
`)}createSVGClipPathMarkup(t){const e=this.clipPath;return e?(e.clipPathId=`CLIPPATH_${Ml()}`,`<clipPath id="${e.clipPathId}" >
${e.toClipPathSVG(t.reviver)}</clipPath>
`):""}createSVGRefElementsMarkup(){return["background","overlay"].map(t=>{const e=this[`${t}Color`];if(Ai(e)){const r=this[`${t}Vpt`],i=this.viewportTransform,s={isType:()=>!1,width:this.width/(r?i[0]:1),height:this.height/(r?i[3]:1)};return e.toSVG(s,{additionalTransform:r?hm(i):""})}}).join("")}createSVGFontFacesMarkup(){const t=[],e={},r=ve.fontPaths;this._objects.forEach(function s(o){t.push(o),q0(o)&&o._objects.forEach(s)}),t.forEach(s=>{if(!(o=s)||typeof o._renderText!="function")return;var o;const{styles:l,fontFamily:u}=s;!e[u]&&r[u]&&(e[u]=!0,l&&Object.values(l).forEach(h=>{Object.values(h).forEach(d=>{let{fontFamily:p=""}=d;!e[p]&&r[p]&&(e[p]=!0)})}))});const i=Object.keys(e).map(s=>`		@font-face {
			font-family: '${s}';
			src: url('${r[s]}');
		}
`).join("");return i?`	<style type="text/css"><![CDATA[
${i}]]></style>
`:""}_setSVGObjects(t,e){this.forEachObject(r=>{r.excludeFromExport||this._setSVGObject(t,r,e)})}_setSVGObject(t,e,r){t.push(e.toSVG(r))}_setSVGBgOverlayImage(t,e,r){const i=this[e];i&&!i.excludeFromExport&&i.toSVG&&t.push(i.toSVG(r))}_setSVGBgOverlayColor(t,e){const r=this[`${e}Color`];if(r)if(Ai(r)){const i=r.repeat||"",s=this.width,o=this.height,l=this[`${e}Vpt`]?hm(rs(this.viewportTransform)):"";t.push(`<rect transform="${l} translate(${s/2},${o/2})" x="${r.offsetX-s/2}" y="${r.offsetY-o/2}" width="${i!=="repeat-y"&&i!=="no-repeat"||!CN(r)?s:r.source.width}" height="${i!=="repeat-x"&&i!=="no-repeat"||!CN(r)?o:r.source.height}" fill="url(#SVGID_${r.id})"></rect>
`)}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',`></rect>
`)}loadFromJSON(t,e){let{signal:r}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!t)return Promise.reject(new $s("`json` is undefined"));const{objects:i=[],...s}=typeof t=="string"?JSON.parse(t):t,{backgroundImage:o,background:l,overlayImage:u,overlay:h,clipPath:d}=s,p=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([um(i,{reviver:e,signal:r}),C_({backgroundImage:o,backgroundColor:l,overlayImage:u,overlayColor:h,clipPath:d},{signal:r})]).then(g=>{let[v,T]=g;return this.clear(),this.add(...v),this.set(s),this.set(T),this.renderOnAddRemove=p,this})}clone(t){const e=this.toObject(t);return this.cloneWithoutData().loadFromJSON(e)}cloneWithoutData(){const t=Pi(this);return new this.constructor(t)}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:r=1,multiplier:i=1,enableRetinaScaling:s=!1}=t,o=i*(s?this.getRetinaScaling():1);return SU(this.toCanvasElement(o,t),e,r)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:e="png",quality:r=1,multiplier:i=1,enableRetinaScaling:s=!1}=t,o=i*(s?this.getRetinaScaling():1);return wU(this.toCanvasElement(o,t),e,r)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:e,height:r,left:i,top:s,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const l=(e||this.width)*t,u=(r||this.height)*t,h=this.getZoom(),d=this.width,p=this.height,g=this.skipControlsDrawing,v=h*t,T=this.viewportTransform,S=[v,0,0,v,(T[4]-(i||0))*t,(T[5]-(s||0))*t],w=this.enableRetinaScaling,E=Pi({width:l,height:u}),D=o?this._objects.filter(P=>o(P)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=S,this.width=l,this.height=u,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(E.getContext("2d"),D),this.viewportTransform=T,this.width=d,this.height=p,this.calcViewportBoundaries(),this.enableRetinaScaling=w,this.skipControlsDrawing=g,E}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),bb.cancelByCanvas(this),this.disposed=!0,new Promise((t,e)=>{const r=()=>{this.destroy(),t(!0)};r.kill=e,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?t(!1):this.nextRenderHandle?this.__cleanupTask=r:r()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(t=>t.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return`#<Canvas (${this.complexity()}): { objects: ${this._objects.length} }>`}}W($m,"ownDefaults",Nht);const jht=["touchstart","touchmove","touchend"],Fht=n=>{const t=kU(n.target),e=(function(r){const i=r.changedTouches;return i&&i[0]?i[0]:r})(n);return new tt(e.clientX+t.left,e.clientY+t.top)},GE=n=>jht.includes(n.type)||n.pointerType==="touch",kN=n=>{n.preventDefault(),n.stopPropagation()},Wo=n=>{let t=0,e=0,r=0,i=0;for(let s=0,o=n.length;s<o;s++){const{x:l,y:u}=n[s];(l>r||!s)&&(r=l),(l<t||!s)&&(t=l),(u>i||!s)&&(i=u),(u<e||!s)&&(e=u)}return{left:t,top:e,width:r-t,height:i-e}},Bht=(n,t)=>Tb(n,Zn(t,n.calcOwnMatrix())),Tb=(n,t)=>{const{translateX:e,translateY:r,scaleX:i,scaleY:s,...o}=_b(t),l=new tt(e,r);n.flipX=!1,n.flipY=!1,Object.assign(n,o),n.set({scaleX:i,scaleY:s}),n.setPositionByOrigin(l,Gt,Gt)},Uht=n=>{n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0)},RU=n=>({scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}),zA=(n,t,e)=>{const r=n/2,i=t/2,s=[new tt(-r,-i),new tt(r,-i),new tt(-r,i),new tt(r,i)].map(l=>l.transform(e)),o=Wo(s);return new tt(o.width,o.height)},A_=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xr;return Zn(rs(arguments.length>1&&arguments[1]!==void 0?arguments[1]:xr),n)},sf=function(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xr,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xr;return n.transform(A_(t,e))},zht=function(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:xr,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xr;return n.transform(A_(t,e),!0)},Hht=(n,t,e)=>{const r=A_(t,e);return Tb(n,Zn(r,n.calcOwnMatrix())),r},$ht={left:-.5,top:-.5,center:0,bottom:.5,right:.5},mr=n=>typeof n=="string"?$ht[n]:n-.5,qht=new tt(1,0),IU=new tt,PU=(n,t)=>n.rotate(t),Sb=(n,t)=>new tt(t).subtract(n),YE=n=>n.distanceFrom(IU),KE=(n,t)=>Math.atan2(Op(n,t),Wht(n,t)),NU=n=>KE(qht,n),HA=n=>n.eq(IU)?n:n.scalarDivide(YE(n)),LU=function(n){let t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return HA(new tt(-n.y,n.x).scalarMultiply(t?1:-1))},Op=(n,t)=>n.x*t.y-n.y*t.x,Wht=(n,t)=>n.x*t.x+n.y*t.y,MN=(n,t,e)=>{if(n.eq(t)||n.eq(e))return!0;const r=Op(t,e),i=Op(t,n),s=Op(e,n);return r>=0?i>=0&&s<=0:!(i<=0&&s>=0)},wb="not-allowed";function VU(n){return mr(n.originX)===mr(Gt)&&mr(n.originY)===mr(Gt)}function DN(n){return .5-mr(n)}const us=(n,t)=>n[t],jU=(n,t,e,r)=>({e:n,transform:t,pointer:new tt(e,r)});function FU(n,t,e){const r=e,i=sf(n.getCenterPoint(),n.canvas.viewportTransform,void 0),s=NU(Sb(i,r))+rf;return Math.round(s%rf/Cht)}function $A(n,t,e,r,i){var s;let{target:o,corner:l}=n;const u=o.controls[l],h=((s=o.canvas)===null||s===void 0?void 0:s.getZoom())||1,d=o.padding/h,p=(function(g,v,T,S){const w=g.getRelativeCenterPoint(),E=T!==void 0&&S!==void 0?g.translateToGivenOrigin(w,Gt,Gt,T,S):new tt(g.left,g.top);return(g.angle?v.rotate(-an(g.angle),w):v).subtract(E)})(o,new tt(r,i),t,e);return p.x>=d&&(p.x-=d),p.x<=-d&&(p.x+=d),p.y>=d&&(p.y-=d),p.y<=d&&(p.y+=d),p.x-=u.offsetX,p.y-=u.offsetY,p}const xb=n=>n.replace(/\s+/g," "),ON={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Jw=(n,t,e)=>(e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+6*(t-n)*e:e<.5?t:e<2/3?n+(t-n)*(2/3-e)*6:n),RN=(n,t,e,r)=>{n/=255,t/=255,e/=255;const i=Math.max(n,t,e),s=Math.min(n,t,e);let o,l;const u=(i+s)/2;if(i===s)o=l=0;else{const h=i-s;switch(l=u>.5?h/(2-i-s):h/(i+s),i){case n:o=(t-e)/h+(t<e?6:0);break;case t:o=(e-n)/h+2;break;case e:o=(n-t)/h+4}o/=6}return[Math.round(360*o),Math.round(100*l),Math.round(100*u),r]},IN=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(n)/(n.endsWith("%")?100:1)},Wy=n=>Math.min(Math.round(n),255).toString(16).toUpperCase().padStart(2,"0"),PN=n=>{let[t,e,r,i=1]=n;const s=Math.round(.3*t+.59*e+.11*r);return[s,s,s,i]};class xe{constructor(t){if(W(this,"isUnrecognised",!1),t)if(t instanceof xe)this.setSource([...t._source]);else if(Array.isArray(t)){const[e,r,i,s=1]=t;this.setSource([e,r,i,s])}else this.setSource(this._tryParsingColor(t));else this.setSource([0,0,0,1])}_tryParsingColor(t){return(t=t.toLowerCase())in ON&&(t=ON[t]),t==="transparent"?[255,255,255,0]:xe.sourceFromHex(t)||xe.sourceFromRgb(t)||xe.sourceFromHsl(t)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(t){this._source=t}toRgb(){const[t,e,r]=this.getSource();return`rgb(${t},${e},${r})`}toRgba(){return`rgba(${this.getSource().join(",")})`}toHsl(){const[t,e,r]=RN(...this.getSource());return`hsl(${t},${e}%,${r}%)`}toHsla(){const[t,e,r,i]=RN(...this.getSource());return`hsla(${t},${e}%,${r}%,${i})`}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[t,e,r,i]=this.getSource();return`${Wy(t)}${Wy(e)}${Wy(r)}${Wy(Math.round(255*i))}`}getAlpha(){return this.getSource()[3]}setAlpha(t){return this._source[3]=t,this}toGrayscale(){return this.setSource(PN(this.getSource())),this}toBlackWhite(t){const[e,,,r]=PN(this.getSource()),i=e<(t||127)?0:255;return this.setSource([i,i,i,r]),this}overlayWith(t){t instanceof xe||(t=new xe(t));const e=this.getSource(),r=t.getSource(),[i,s,o]=e.map((l,u)=>Math.round(.5*l+.5*r[u]));return this.setSource([i,s,o,e[3]]),this}static fromRgb(t){return xe.fromRgba(t)}static fromRgba(t){return new xe(xe.sourceFromRgb(t))}static sourceFromRgb(t){const e=xb(t).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(e){const[r,i,s]=e.slice(1,4).map(o=>{const l=parseFloat(o);return o.endsWith("%")?Math.round(2.55*l):l});return[r,i,s,IN(e[4])]}}static fromHsl(t){return xe.fromHsla(t)}static fromHsla(t){return new xe(xe.sourceFromHsl(t))}static sourceFromHsl(t){const e=xb(t).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!e)return;const r=(xe.parseAngletoDegrees(e[1])%360+360)%360/360,i=parseFloat(e[2])/100,s=parseFloat(e[3])/100;let o,l,u;if(i===0)o=l=u=s;else{const h=s<=.5?s*(i+1):s+i-s*i,d=2*s-h;o=Jw(d,h,r+1/3),l=Jw(d,h,r),u=Jw(d,h,r-1/3)}return[Math.round(255*o),Math.round(255*l),Math.round(255*u),IN(e[4])]}static fromHex(t){return new xe(xe.sourceFromHex(t))}static sourceFromHex(t){if(t.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const e=t.slice(t.indexOf("#")+1);let r;r=e.length<=4?e.split("").map(u=>u+u):e.match(/.{2}/g);const[i,s,o,l=255]=r.map(u=>parseInt(u,16));return[i,s,o,l/255]}}static parseAngletoDegrees(t){const e=t.toLowerCase(),r=parseFloat(e);return e.includes("rad")?Dl(r):e.includes("turn")?360*r:r}}const Uh=function(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:PA;const e=/\D{0,2}$/.exec(n),r=parseFloat(n),i=ve.DPI;switch(e?.[0]){case"mm":return r*i/25.4;case"cm":return r*i/2.54;case"in":return r*i;case"pt":return r*i/72;case"pc":return r*i/72*12;case"em":return r*t;default:return r}},Ght=n=>{const[t,e]=n.trim().split(" "),[r,i]=(s=t)&&s!==Br?[s.slice(1,4),s.slice(5,8)]:s===Br?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:e||"meet",alignX:r,alignY:i}},fm=function(n,t){let e,r,i=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(t)if(t.toLive)e=`url(#SVGID_${ne(t.id)})`;else{const s=new xe(t),o=s.getAlpha();e=s.toRgb(),o!==1&&(r=o.toString())}else e="none";return i?`${n}: ${e}; ${r?`${n}-opacity: ${r}; `:""}`:`${n}="${e}" ${r?`${n}-opacity="${r}" `:""}`};class BU{getSvgStyles(t){const e=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):Br,s=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",l=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",h=this.opacity!==void 0?this.opacity:"1",d=this.visible?"":" visibility: hidden;",p=t?"":this.getSvgFilter(),g=fm(Fn,this.fill);return[fm(si,this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",l,"; ","stroke-miterlimit: ",u,"; ",g,"fill-rule: ",e,"; ","opacity: ",h,";",p,d].map(v=>ne(v)).join("")}getSvgFilter(){return this.shadow?`filter: url(#SVGID_${ne(this.shadow.id)});`:""}getSvgCommons(){return[this.id?`id="${ne(String(this.id))}" `:"",this.clipPath?`clip-path="url(#${this.clipPath.clipPathId})" `:""].join("")}getSvgTransform(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=t?this.calcTransformMatrix():this.calcOwnMatrix();return`${`transform="${hm(r)}`}${e}" `}_toSVG(t){return[""]}toSVG(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})}toClipPathSVG(t){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})}_createBaseClipPathSVGMarkup(t){let{reviver:e,additionalTransform:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),s=t.indexOf("COMMON_PARTS");return t[s]=i,e?e(t.join("")):t.join("")}_createBaseSVGMarkup(t){let{noStyle:e,reviver:r,withShadow:i,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=e?"":`style="${this.getSvgStyles()}" `,l=i?`style="${this.getSvgFilter()}" `:"",u=this.clipPath,h=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",d=u&&u.absolutePositioned,p=this.stroke,g=this.fill,v=this.shadow,T=[],S=t.indexOf("COMMON_PARTS");let w;u&&(u.clipPathId=`CLIPPATH_${Ml()}`,w=`<clipPath id="${u.clipPathId}" >
${u.toClipPathSVG(r)}</clipPath>
`),d&&T.push("<g ",l,this.getSvgCommons(),` >
`),T.push("<g ",this.getSvgTransform(!1),d?"":l+this.getSvgCommons(),` >
`);const E=[o,h,e?"":this.addPaintOrder()," ",s?`transform="${s}" `:""].join("");return t[S]=E,Ai(g)&&T.push(g.toSVG(this)),Ai(p)&&T.push(p.toSVG(this)),v&&T.push(v.toSVG(this)),u&&T.push(w),T.push(t.join("")),T.push(`</g>
`),d&&T.push(`</g>
`),r?r(T.join("")):T.join("")}addPaintOrder(){return this.paintFirst!==Fn?` paint-order="${ne(this.paintFirst)}" `:""}}function k_(n){return new RegExp("^("+n.join("|")+")\\b","i")}const fu="textDecorationThickness",UU=["fontSize","fontWeight","fontFamily","fontStyle"],zU=["underline","overline","linethrough"],HU=[...UU,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],$U=[...HU,...zU,"textBackgroundColor","direction",fu],Yht=[...UU,...zU,si,"strokeWidth",Fn,"deltaY","textBackgroundColor",fu],Kht={_reNewline:NA,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:qE,fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:fe,fontStyle:qE,lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:fe,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:Dc,CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[fu]:66.667},qs="justify",Eb="justify-left",Rp="justify-right",Ip="justify-center",du=String.raw`[-+]?(?:\d*\.\d+|\d+\.?)(?:[eE][-+]?\d+)?`,Xht=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+du+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+du+"))?\\s+(.*)"),Qht={cx:fe,x:fe,r:"radius",cy:Fr,y:Fr,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":fu},Zw="font-size",tx="clip-path";k_(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);k_(["symbol","image","marker","pattern","view","svg"]);const NN=k_(["symbol","g","a","svg","clipPath","defs"]),LN="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",VN=new RegExp("(?:\\s|^)"+LN+LN+"("+du+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Js{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof t=="string"?Js.parseShadow(t):t;Object.assign(this,Js.ownDefaults,e),this.id=Ml()}static parseShadow(t){const e=t.trim(),[,r=0,i=0,s=0]=(VN.exec(e)||[]).map(o=>parseFloat(o)||0);return{color:(e.replace(VN,"")||"rgb(0,0,0)").trim(),offsetX:r,offsetY:i,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(t){const e=PU(new tt(this.offsetX,this.offsetY),an(-t.angle)),r=ve.NUM_FRACTION_DIGITS,i=new xe(this.color);let s=40,o=40;return t.width&&t.height&&(s=100*Me((Math.abs(e.x)+this.blur)/t.width,r)+20,o=100*Me((Math.abs(e.y)+this.blur)/t.height,r)+20),t.flipX&&(e.x*=-1),t.flipY&&(e.y*=-1),`<filter id="SVGID_${ne(this.id)}" y="-${o}%" height="${100+2*o}%" x="-${s}%" width="${100+2*s}%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="${Me(this.blur?this.blur/2:0,r)}"></feGaussianBlur>
	<feOffset dx="${Me(e.x,r)}" dy="${Me(e.y,r)}" result="oBlur" ></feOffset>
	<feFlood flood-color="${i.toRgb()}" flood-opacity="${i.getAlpha()}"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`}toObject(){const t={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},e=Js.ownDefaults;return this.includeDefaultValues?t:BA(t,(r,i)=>r!==e[i])}static async fromObject(t){return new this(t)}}W(Js,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),W(Js,"type","shadow"),_t.setClass(Js,"shadow");const of=(n,t,e)=>Math.max(n,Math.min(t,e)),Jht=[Fr,fe,Ur,Ii,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Sf,wf],ia=[Fn,si,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],Zht={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Gt,originY:Gt,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Fn,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},tft=(n,t,e,r)=>-e*Math.cos(n/r*zm)+e+t,eft=()=>!1;class qA{constructor(t){let{startValue:e,byValue:r,duration:i=500,delay:s=0,easing:o=tft,onStart:l=$0,onChange:u=$0,onComplete:h=$0,abort:d=eft,target:p}=t;W(this,"_state","pending"),W(this,"durationProgress",0),W(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=i,this.delay=s,this.easing=o,this._onStart=l,this._onChange=u,this._onComplete=h,this._abort=d,this.target=p,this.startValue=e,this.byValue=r,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const t=e=>{this._state==="pending"&&(this.startTime=e||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>W0(t),this.delay):W0(t)}tick(t){const e=(t||+new Date)-this.startTime,r=Math.min(e,this.duration);this.durationProgress=r/this.duration;const{value:i,valueProgress:s}=this.calculate(r);this.value=Object.freeze(i),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):e>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),W0(this.tick)))}register(){bb.push(this)}unregister(){bb.remove(this)}abort(){this._state="aborted",this.unregister()}}class nft extends qA{constructor(t){let{startValue:e=0,endValue:r=100,...i}=t;super({...i,startValue:e,byValue:r-e})}calculate(t){const e=this.easing(t,this.startValue,this.byValue,this.duration);return{value:e,valueProgress:Math.abs((e-this.startValue)/this.byValue)}}}class rft extends qA{constructor(t){let{startValue:e=[0],endValue:r=[100],...i}=t;super({...i,startValue:e,byValue:r.map((s,o)=>s-e[o])})}calculate(t){const e=this.startValue.map((r,i)=>this.easing(t,r,this.byValue[i],this.duration,i));return{value:e,valueProgress:Math.abs((e[0]-this.startValue[0])/this.byValue[0])}}}const ift=(n,t,e,r)=>t+e*(1-Math.cos(n/r*zm)),ex=n=>n&&((t,e,r)=>n(new xe(t).toRgba(),e,r));class sft extends qA{constructor(t){let{startValue:e,endValue:r,easing:i=ift,onChange:s,onComplete:o,abort:l,...u}=t;const h=new xe(e).getSource(),d=new xe(r).getSource();super({...u,startValue:h,byValue:d.map((p,g)=>p-h[g]),easing:i,onChange:ex(s),onComplete:ex(o),abort:ex(l)})}calculate(t){const[e,r,i,s]=this.startValue.map((l,u)=>this.easing(t,l,this.byValue[u],this.duration,u)),o=[...[e,r,i].map(Math.round),of(0,s,1)];return{value:o,valueProgress:o.map((l,u)=>this.byValue[u]!==0?Math.abs((l-this.startValue[u])/this.byValue[u]):0).find(l=>l!==0)||0}}}function qU(n){const t=(e=>Array.isArray(e.startValue)||Array.isArray(e.endValue))(n)?new rft(n):new nft(n);return t.start(),t}function oft(n){const t=new sft(n);return t.start(),t}class Be{constructor(t){this.status=t,this.points=[]}includes(t){return this.points.some(e=>e.eq(t))}append(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.points=this.points.concat(e.filter(i=>!this.includes(i))),this}static isPointContained(t,e,r){let i=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(e.eq(r))return t.eq(e);if(e.x===r.x)return t.x===e.x&&(i||t.y>=Math.min(e.y,r.y)&&t.y<=Math.max(e.y,r.y));if(e.y===r.y)return t.y===e.y&&(i||t.x>=Math.min(e.x,r.x)&&t.x<=Math.max(e.x,r.x));{const s=Sb(e,r),o=Sb(e,t).divide(s);return i?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(t,e){const r=new tt(t).setX(Math.min(t.x-1,...e.map(s=>s.x)));let i=0;for(let s=0;s<e.length;s++){const o=this.intersectSegmentSegment(e[s],e[(s+1)%e.length],t,r);if(o.includes(t))return!0;i+=+(o.status==="Intersection")}return i%2==1}static intersectLineLine(t,e,r,i){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const l=e.x-t.x,u=e.y-t.y,h=i.x-r.x,d=i.y-r.y,p=t.x-r.x,g=t.y-r.y,v=h*g-d*p,T=l*g-u*p,S=d*l-h*u;if(S!==0){const w=v/S,E=T/S;return(s||0<=w&&w<=1)&&(o||0<=E&&E<=1)?new Be("Intersection").append(new tt(t.x+w*l,t.y+w*u)):new Be}if(v===0||T===0){const w=s||o||Be.isPointContained(t,r,i)||Be.isPointContained(e,r,i)||Be.isPointContained(r,t,e)||Be.isPointContained(i,t,e);return new Be(w?"Coincident":void 0)}return new Be("Parallel")}static intersectSegmentLine(t,e,r,i){return Be.intersectLineLine(t,e,r,i,!1,!0)}static intersectSegmentSegment(t,e,r,i){return Be.intersectLineLine(t,e,r,i,!1,!1)}static intersectLinePolygon(t,e,r){let i=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const s=new Be,o=r.length;for(let l,u,h,d=0;d<o;d++){if(l=r[d],u=r[(d+1)%o],h=Be.intersectLineLine(t,e,l,u,i,!1),h.status==="Coincident")return h;s.append(...h.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(t,e,r){return Be.intersectLinePolygon(t,e,r,!1)}static intersectPolygonPolygon(t,e){const r=new Be,i=t.length,s=[];for(let o=0;o<i;o++){const l=t[o],u=t[(o+1)%i],h=Be.intersectSegmentPolygon(l,u,e);h.status==="Coincident"?(s.push(h),r.append(l,u)):r.append(...h.points)}return s.length>0&&s.length===t.length?new Be("Coincident"):(r.points.length>0&&(r.status="Intersection"),r)}static intersectPolygonRectangle(t,e,r){const i=e.min(r),s=e.max(r),o=new tt(s.x,i.y),l=new tt(i.x,s.y);return Be.intersectPolygonPolygon(t,[i,o,s,l])}}class aft extends TU{getX(){return this.getXY().x}setX(t){this.setXY(this.getXY().setX(t))}getY(){return this.getXY().y}setY(t){this.setXY(this.getXY().setY(t))}getRelativeX(){return this.left}setRelativeX(t){this.left=t}getRelativeY(){return this.top}setRelativeY(t){this.top=t}getXY(){const t=this.getRelativeXY();return this.group?Nr(t,this.group.calcTransformMatrix()):t}setXY(t,e,r){this.group&&(t=Nr(t,rs(this.group.calcTransformMatrix()))),this.setRelativeXY(t,e,r)}getRelativeXY(){return new tt(this.left,this.top)}setRelativeXY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(t,e,r)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:t,tr:e,br:r,bl:i}=this.aCoords||(this.aCoords=this.calcACoords()),s=[t,e,r,i];if(this.group){const o=this.group.calcTransformMatrix();return s.map(l=>Nr(l,o))}return s}intersectsWithRect(t,e){return Be.intersectPolygonRectangle(this.getCoords(),t,e).status==="Intersection"}intersectsWithObject(t){const e=Be.intersectPolygonPolygon(this.getCoords(),t.getCoords());return e.status==="Intersection"||e.status==="Coincident"||t.isContainedWithinObject(this)||this.isContainedWithinObject(t)}isContainedWithinObject(t){return this.getCoords().every(e=>t.containsPoint(e))}isContainedWithinRect(t,e){const{left:r,top:i,width:s,height:o}=this.getBoundingRect();return r>=t.x&&r+s<=e.x&&i>=t.y&&i+o<=e.y}isOverlapping(t){return this.intersectsWithObject(t)||this.isContainedWithinObject(t)||t.isContainedWithinObject(this)}containsPoint(t){return Be.isPointInPolygon(t,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return!!this.getCoords().some(r=>r.x<=e.x&&r.x>=t.x&&r.y<=e.y&&r.y>=t.y)||!!this.intersectsWithRect(t,e)||this.containsPoint(t.midPointFrom(e))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:t,br:e}=this.canvas.vptCoords;return this.intersectsWithRect(t,e)?!0:this.getCoords().every(r=>(r.x>=e.x||r.x<=t.x)&&(r.y>=e.y||r.y<=t.y))&&this.containsPoint(t.midPointFrom(e))}getBoundingRect(){return Wo(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(t){this._set(Ur,t),this._set(Ii,t),this.setCoords()}scaleToWidth(t){const e=this.getBoundingRect().width/this.getScaledWidth();return this.scale(t/this.width/e)}scaleToHeight(t){const e=this.getBoundingRect().height/this.getScaledHeight();return this.scale(t/this.height/e)}getCanvasRetinaScaling(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.getRetinaScaling())||1}getTotalAngle(){return this.group?Dl(xU(this.calcTransformMatrix())):this.angle}getViewportTransform(){var t;return((t=this.canvas)===null||t===void 0?void 0:t.viewportTransform)||xr.concat()}calcACoords(){const t=xf({angle:this.angle}),{x:e,y:r}=this.getRelativeCenterPoint(),i=Hm(e,r),s=Zn(i,t),o=this._getTransformedDimensions(),l=o.x/2,u=o.y/2;return{tl:Nr({x:-l,y:-u},s),tr:Nr({x:l,y:-u},s),bl:Nr({x:-l,y:u},s),br:Nr({x:l,y:u},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=[];return!t&&this.group&&(e=this.group.transformMatrixKey(t)),e.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,mr(this.originX),mr(this.originY)),e}calcTransformMatrix(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],e=this.calcOwnMatrix();if(t||!this.group)return e;const r=this.transformMatrixKey(t),i=this.matrixCache;return i&&i.key.every((s,o)=>s===r[o])?i.value:(this.group&&(e=Zn(this.group.calcTransformMatrix(!1),e)),this.matrixCache={key:r,value:e},e)}calcOwnMatrix(){const t=this.transformMatrixKey(!0),e=this.ownMatrixCache;if(e&&e.key.every((o,l)=>o===t[l]))return e.value;const r=this.getRelativeCenterPoint(),i={angle:this.angle,translateX:r.x,translateY:r.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=Pht(i);return this.ownMatrixCache={key:t,value:s},s}_getNonTransformedDimensions(){return new tt(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(t){return this._getTransformedDimensions(t).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth,...t},r=e.strokeWidth;let i=r,s=0;this.strokeUniform&&(i=0,s=r);const o=e.width+i,l=e.height+i;let u;return u=e.skewX===0&&e.skewY===0?new tt(o*e.scaleX,l*e.scaleY):zA(o,l,E_(e)),u.scalarAdd(s)}translateToGivenOrigin(t,e,r,i,s){let o=t.x,l=t.y;const u=mr(i)-mr(e),h=mr(s)-mr(r);if(u||h){const d=this._getTransformedDimensions();o+=u*d.x,l+=h*d.y}return new tt(o,l)}translateToCenterPoint(t,e,r){if(e===Gt&&r===Gt)return t;const i=this.translateToGivenOrigin(t,e,r,Gt,Gt);return this.angle?i.rotate(an(this.angle),t):i}translateToOriginPoint(t,e,r){const i=this.translateToGivenOrigin(t,Gt,Gt,e,r);return this.angle?i.rotate(an(this.angle),t):i}getCenterPoint(){const t=this.getRelativeCenterPoint();return this.group?Nr(t,this.group.calcTransformMatrix()):t}getRelativeCenterPoint(){return this.translateToCenterPoint(new tt(this.left,this.top),this.originX,this.originY)}getPointByOrigin(t,e){return this.getPositionByOrigin(t,e)}getPositionByOrigin(t,e){return this.translateToOriginPoint(this.getRelativeCenterPoint(),t,e)}setPositionByOrigin(t,e,r){const i=this.translateToCenterPoint(t,e,r),s=this.translateToOriginPoint(i,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.getPositionByOrigin(fe,Fr)}positionByLeftTop(t){return this.setPositionByOrigin(t,fe,Fr)}}let Do=class Y0 extends aft{static getDefaults(){return Y0.ownDefaults}get type(){const t=this.constructor.type;return t==="FabricObject"?"object":t.toLowerCase()}set type(t){kl("warn","Setting type has no effect",t)}constructor(t){super(),W(this,"_cacheContext",null),Object.assign(this,Y0.ownDefaults),this.setOptions(t)}_createCacheCanvas(){this._cacheCanvas=ea(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(t){const e=t.width,r=t.height,i=ve.maxCacheSideLimit,s=ve.minCacheSideLimit;if(e<=i&&r<=i&&e*r<=ve.perfLimitSizeTotal)return e<s&&(t.width=s),r<s&&(t.height=s),t;const o=e/r,[l,u]=Dp.limitDimsByArea(o),h=of(s,l,i),d=of(s,u,i);return e>h&&(t.zoomX/=e/h,t.width=h,t.capped=!0),r>d&&(t.zoomY/=r/d,t.height=d,t.capped=!0),t}_getCacheCanvasDimensions(){const t=this.getTotalObjectScaling(),e=this._getTransformedDimensions({skewX:0,skewY:0}),r=e.x*t.x/this.scaleX,i=e.y*t.y/this.scaleY;return{width:Math.ceil(r+2),height:Math.ceil(i+2),zoomX:t.x,zoomY:t.y,x:r,y:i}}_updateCacheCanvas(){const t=this._cacheCanvas,e=this._cacheContext,{width:r,height:i,zoomX:s,zoomY:o,x:l,y:u}=this._limitCacheSize(this._getCacheCanvasDimensions()),h=r!==t.width||i!==t.height,d=this.zoomX!==s||this.zoomY!==o;if(!t||!e)return!1;if(h||d){r!==t.width||i!==t.height?(t.width=r,t.height=i):(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height));const p=l/2,g=u/2;return this.cacheTranslationX=Math.round(t.width/2-p)+p,this.cacheTranslationY=Math.round(t.height/2-g)+g,e.translate(this.cacheTranslationX,this.cacheTranslationY),e.scale(s,o),this.zoomX=s,this.zoomY=o,!0}return!1}setOptions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(t)}transform(t){const e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,r=this.calcTransformMatrix(!e);t.transform(r[0],r[1],r[2],r[3],r[4],r[5])}getObjectScaling(){if(!this.group)return new tt(Math.abs(this.scaleX),Math.abs(this.scaleY));const t=_b(this.calcTransformMatrix());return new tt(Math.abs(t.scaleX),Math.abs(t.scaleY))}getTotalObjectScaling(){const t=this.getObjectScaling();if(this.canvas){const e=this.canvas.getZoom(),r=this.getCanvasRetinaScaling();return t.scalarMultiply(e*r)}return t}getObjectOpacity(){let t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t}_constrainScale(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t===0?1e-4:t}_set(t,e){t!==Ur&&t!==Ii||(e=this._constrainScale(e)),t===Ur&&e<0?(this.flipX=!this.flipX,e*=-1):t==="scaleY"&&e<0?(this.flipY=!this.flipY,e*=-1):t!=="shadow"||!e||e instanceof Js||(e=new Js(e));const r=this[t]!==e;return this[t]=e,r&&this.constructor.cacheProperties.includes(t)&&(this.dirty=!0),this.parent&&(this.dirty||r&&this.constructor.stateProperties.includes(t))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.drawObject(t,!1,{}),this.dirty=!1),t.restore())}drawSelectionBackground(t){}renderCache(t){if(t=t||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:e,zoomY:r,cacheTranslationX:i,cacheTranslationY:s}=this,{width:o,height:l}=this._cacheCanvas;this.drawObject(this._cacheContext,t.forClipping,{zoomX:e,zoomY:r,cacheTranslationX:i,cacheTranslationY:s,width:o,height:l,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return!!this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return!!this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===si&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(t,e,r){t.save(),e.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",t.setTransform(1,0,0,1,0,0),t.drawImage(r,0,0),t.restore()}drawObject(t,e,r){const i=this.fill,s=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this.fire("before:render",{ctx:t}),this._render(t),this._drawClipPath(t,this.clipPath,r),this.fill=i,this.stroke=s}createClipPathLayer(t,e){const r=Pi(e),i=r.getContext("2d");if(i.translate(e.cacheTranslationX,e.cacheTranslationY),i.scale(e.zoomX,e.zoomY),t._cacheCanvas=r,e.parentClipPaths.forEach(s=>{s.transform(i)}),e.parentClipPaths.push(t),t.absolutePositioned){const s=rs(this.calcTransformMatrix());i.transform(s[0],s[1],s[2],s[3],s[4],s[5])}return t.transform(i),t.drawObject(i,!0,e),r}_drawClipPath(t,e,r){if(!e)return;e._transformDone=!0;const i=this.createClipPathLayer(e,r);this.drawClipPathOnCache(t,e,i)}drawCacheOnCanvas(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const e=this._cacheCanvas,r=this._cacheContext;return!(!e||!r||t||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(e&&r&&!t&&(r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,e.width,e.height),r.restore()),!0)}_renderBackground(t){if(!this.backgroundColor)return;const e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}_setOpacity(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity}_setStrokeStyles(t,e){const r=e.stroke;r&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,Ai(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(t,r):(t.strokeStyle=r.toLive(t),this._applyPatternGradientTransform(t,r)):t.strokeStyle=e.stroke)}_setFillStyles(t,e){let{fill:r}=e;r&&(Ai(r)?(t.fillStyle=r.toLive(t),this._applyPatternGradientTransform(t,r)):t.fillStyle=r)}_setClippingProperties(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"}_setLineDash(t,e){e&&e.length!==0&&t.setLineDash(e)}_setShadow(t){if(!this.shadow)return;const e=this.shadow,r=this.canvas,i=this.getCanvasRetinaScaling(),[s,,,o]=r?.viewportTransform||xr,l=s*i,u=o*i,h=e.nonScaling?new tt(1,1):this.getObjectScaling();t.shadowColor=e.color,t.shadowBlur=e.blur*ve.browserShadowBlurConstant*(l+u)*(h.x+h.y)/4,t.shadowOffsetX=e.offsetX*l*h.x,t.shadowOffsetY=e.offsetY*u*h.y}_removeShadow(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)}_applyPatternGradientTransform(t,e){if(!Ai(e))return{offsetX:0,offsetY:0};const r=e.gradientTransform||e.patternTransform,i=-this.width/2+e.offsetX||0,s=-this.height/2+e.offsetY||0;return e.gradientUnits==="percentage"?t.transform(this.width,0,0,this.height,i,s):t.transform(1,0,0,1,i,s),r&&t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:i,offsetY:s}}_renderPaintInOrder(t){this.paintFirst===si?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))}_render(t){}_renderFill(t){this.fill&&(t.save(),this._setFillStyles(t,this),this.fillRule==="evenodd"?t.fill("evenodd"):t.fill(),t.restore())}_renderStroke(t){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform){const e=this.getObjectScaling();t.scale(1/e.x,1/e.y)}this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}}_applyPatternForTransformedGradient(t,e){var r;const i=this._limitCacheSize(this._getCacheCanvasDimensions()),s=this.getCanvasRetinaScaling(),o=i.x/this.scaleX/s,l=i.y/this.scaleY/s,u=Pi({width:Math.ceil(o),height:Math.ceil(l)}),h=u.getContext("2d");h&&(h.beginPath(),h.moveTo(0,0),h.lineTo(o,0),h.lineTo(o,l),h.lineTo(0,l),h.closePath(),h.translate(o/2,l/2),h.scale(i.zoomX/this.scaleX/s,i.zoomY/this.scaleY/s),this._applyPatternGradientTransform(h,e),h.fillStyle=e.toLive(t),h.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(s*this.scaleX/i.zoomX,s*this.scaleY/i.zoomY),t.strokeStyle=(r=h.createPattern(u,"no-repeat"))!==null&&r!==void 0?r:"")}_findCenterFromElement(){return new tt(this.left+this.width/2,this.top+this.height/2)}clone(t){const e=this.toObject(t);return this.constructor.fromObject(e)}cloneAsImage(t){const e=this.toCanvasElement(t);return new(_t.getClass("image"))(e)}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=RU(this),r=this.group,i=this.shadow,s=Math.abs,o=t.enableRetinaScaling?gU():1,l=(t.multiplier||1)*o,u=t.canvasProvider||(D=>new $m(D,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,t.withoutTransform&&Uht(this),t.withoutShadow&&(this.shadow=null),t.viewportTransform&&Hht(this,this.getViewportTransform()),this.setCoords();const h=ea(),d=this.getBoundingRect(),p=this.shadow,g=new tt;if(p){const D=p.blur,P=p.nonScaling?new tt(1,1):this.getObjectScaling();g.x=2*Math.round(s(p.offsetX)+D)*s(P.x),g.y=2*Math.round(s(p.offsetY)+D)*s(P.y)}const v=d.width+g.x,T=d.height+g.y;h.width=Math.ceil(v),h.height=Math.ceil(T);const S=u(h);t.format==="jpeg"&&(S.backgroundColor="#fff"),this.setPositionByOrigin(new tt(S.width/2,S.height/2),Gt,Gt);const w=this.canvas;S._objects=[this],this.set("canvas",S),this.setCoords();const E=S.toCanvasElement(l||1,t);return this.set("canvas",w),this.shadow=i,r&&(this.group=r),this.set(e),this.setCoords(),S._objects=[],S.destroy(),E}toDataURL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return SU(this.toCanvasElement(t),t.format||"png",t.quality||1)}toBlob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return wU(this.toCanvasElement(t),t.format||"png",t.quality||1)}isType(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.includes(this.constructor.type)||e.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(t){const{centeredRotation:e,originX:r,originY:i}=this;if(e){const{x:s,y:o}=this.getRelativeCenterPoint();this.originX=Gt,this.originY=Gt,this.left=s,this.top=o}if(this.set("angle",t),e){const{x:s,y:o}=this.getPositionByOrigin(r,i);this.left=s,this.top=o,this.originX=r,this.originY=i}}setOnGroup(){}_setupCompositeOperation(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}dispose(){bb.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&io().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(t,e){return Object.entries(t).reduce((r,i)=>{let[s,o]=i;return r[s]=this._animate(s,o,e),r},{})}_animate(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=t.split("."),s=this.constructor.colorProperties.includes(i[i.length-1]),{abort:o,startValue:l,onChange:u,onComplete:h}=r,d={...r,target:this,startValue:l??i.reduce((p,g)=>p[g],this),endValue:e,abort:o?.bind(this),onChange:(p,g,v)=>{i.reduce((T,S,w)=>(w===i.length-1&&(T[S]=p),T[S]),this),u&&u(p,g,v)},onComplete:(p,g,v)=>{this.setCoords(),h&&h(p,g,v)}};return s?oft(d):qU(d)}isDescendantOf(t){const{parent:e,group:r}=this;return e===t||r===t||!!e&&e.isDescendantOf(t)||!!r&&r!==e&&r.isDescendantOf(t)}getAncestors(){const t=[];let e=this;do e=e.parent,e&&t.push(e);while(e);return t}findCommonAncestors(t){if(this===t)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const e=this.getAncestors(),r=t.getAncestors();if(e.length===0&&r.length>0&&this===r[r.length-1])return{fork:[],otherFork:[t,...r.slice(0,r.length-1)],common:[this]};for(let i,s=0;s<e.length;s++){if(i=e[s],i===t)return{fork:[this,...e.slice(0,s)],otherFork:[],common:e.slice(s)};for(let o=0;o<r.length;o++){if(this===r[o])return{fork:[],otherFork:[t,...r.slice(0,o)],common:[this,...e]};if(i===r[o])return{fork:[this,...e.slice(0,s)],otherFork:[t,...r.slice(0,o)],common:e.slice(s)}}}return{fork:[this,...e],otherFork:[t,...r],common:[]}}hasCommonAncestors(t){const e=this.findCommonAncestors(t);return e&&!!e.common.length}isInFrontOf(t){if(this===t)return;const e=this.findCommonAncestors(t);if(e.fork.includes(t))return!0;if(e.otherFork.includes(this))return!1;const r=e.common[0]||this.canvas;if(!r)return;const i=e.fork.pop(),s=e.otherFork.pop(),o=r._objects.indexOf(i),l=r._objects.indexOf(s);return o>-1&&o>l}toObject(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Y0.customProperties,this.constructor.customProperties||[]);let e;const r=ve.NUM_FRACTION_DIGITS,{clipPath:i,fill:s,stroke:o,shadow:l,strokeDashArray:u,left:h,top:d,originX:p,originY:g,width:v,height:T,strokeWidth:S,strokeLineCap:w,strokeDashOffset:E,strokeLineJoin:D,strokeUniform:P,strokeMiterLimit:V,scaleX:N,scaleY:q,angle:M,flipX:k,flipY:R,opacity:F,visible:U,backgroundColor:H,fillRule:j,paintFirst:yt,globalCompositeOperation:xt,skewX:J,skewY:st}=this;i&&!i.excludeFromExport&&(e=i.toObject(t.concat("inverted","absolutePositioned")));const ht=Vt=>Me(Vt,r),Ct={...Ef(this,t),type:this.constructor.type,version:HE,originX:p,originY:g,left:ht(h),top:ht(d),width:ht(v),height:ht(T),fill:EN(s)?s.toObject():s,stroke:EN(o)?o.toObject():o,strokeWidth:ht(S),strokeDashArray:u&&u.concat(),strokeLineCap:w,strokeDashOffset:E,strokeLineJoin:D,strokeUniform:P,strokeMiterLimit:ht(V),scaleX:ht(N),scaleY:ht(q),angle:ht(M),flipX:k,flipY:R,opacity:ht(F),shadow:l&&l.toObject(),visible:U,backgroundColor:H,fillRule:j,paintFirst:yt,globalCompositeOperation:xt,skewX:ht(J),skewY:ht(st),...e?{clipPath:e}:null};return this.includeDefaultValues?Ct:this._removeDefaultValues(Ct)}toDatalessObject(t){return this.toObject(t)}_removeDefaultValues(t){const e=this.constructor.getDefaults(),r=Object.keys(e).length>0?e:Object.getPrototypeOf(this);return BA(t,(i,s)=>{if(s===fe||s===Fr||s==="type")return!0;const o=r[s];return i!==o&&!(Array.isArray(i)&&Array.isArray(o)&&i.length===0&&o.length===0)})}toString(){return`#<${this.constructor.type}>`}static _fromObject(t){let{type:e,...r}=t,{extraParam:i,...s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return C_(r,s).then(o=>i?(delete o[i],new this(r[i],o)):new this(o))}static fromObject(t,e){return this._fromObject(t,e)}};W(Do,"stateProperties",Jht),W(Do,"cacheProperties",ia),W(Do,"ownDefaults",Zht),W(Do,"type","FabricObject"),W(Do,"colorProperties",[Fn,si,"backgroundColor"]),W(Do,"customProperties",[]),_t.setClass(Do),_t.setClass(Do,"object");const WU=(n,t)=>{var e;const{transform:{target:r}}=t;(e=r.canvas)===null||e===void 0||e.fire(`object:${n}`,{...t,target:r}),r.fire(n,t)},Cf=(n,t,e)=>(r,i,s,o)=>{const l=t(r,i,s,o);return l&&WU(n,{...jU(r,i,s,o),...e}),l};function Af(n){return(t,e,r,i)=>{const{target:s,originX:o,originY:l}=e,u=s.getPositionByOrigin(o,l),h=n(t,e,r,i);return s.setPositionByOrigin(u,e.originX,e.originY),h}}const lft=(n,t,e,r)=>(i,s,o,l)=>{const u=$A(s,s.originX,s.originY,o,l)[e],h=mr(s[t]);if(h===0||h>0&&u<0||h<0&&u>0){const{target:d}=s,p=d.strokeWidth/(d.strokeUniform?d[r]:1),g=VU(s)?2:1,v=d[n],T=Math.abs(u*g/d[r])-p;return d.set(n,Math.max(T,1)),v!==d[n]}return!1},cft=lft("width","originX","x","scaleX"),jN=Cf(cm,Af(cft));function uft(n,t,e,r,i){n.save();const{stroke:s,xSize:o,ySize:l,opName:u}=this.commonRenderProps(n,t,e,i,r);let h=o;o>l?n.scale(1,l/o):l>o&&(h=l,n.scale(o/l,1)),n.beginPath(),n.arc(0,0,h/2,0,rf,!1),n[u](),s&&n.stroke(),n.restore()}function hft(n,t,e,r,i){n.save();const{stroke:s,xSize:o,ySize:l,opName:u}=this.commonRenderProps(n,t,e,i,r),h=o/2,d=l/2;n[`${u}Rect`](-h,-d,o,l),s&&n.strokeRect(-h,-d,o,l),n.restore()}class Qi{constructor(t){W(this,"visible",!0),W(this,"actionName",x_),W(this,"angle",0),W(this,"x",0),W(this,"y",0),W(this,"offsetX",0),W(this,"offsetY",0),W(this,"sizeX",0),W(this,"sizeY",0),W(this,"touchSizeX",0),W(this,"touchSizeY",0),W(this,"cursorStyle","crosshair"),W(this,"withConnection",!1),Object.assign(this,t)}getTransformAnchorPoint(){var t;return(t=this.transformAnchorPoint)!==null&&t!==void 0?t:new tt(.5-this.x,.5-this.y)}shouldActivate(t,e,r,i){var s;let{tl:o,tr:l,br:u,bl:h}=i;return((s=e.canvas)===null||s===void 0?void 0:s.getActiveObject())===e&&e.isControlVisible(t)&&Be.isPointInPolygon(r,[o,l,u,h])}getActionHandler(t,e,r){return this.actionHandler}getMouseDownHandler(t,e,r){return this.mouseDownHandler}getMouseUpHandler(t,e,r){return this.mouseUpHandler}cursorStyleHandler(t,e,r,i){return e.cursorStyle}getActionName(t,e,r){return e.actionName}getVisibility(t,e){var r,i;return(r=(i=t._controlsVisibility)===null||i===void 0?void 0:i[e])!==null&&r!==void 0?r:this.visible}setVisibility(t,e,r){this.visible=t}positionHandler(t,e,r,i){return new tt(this.x*t.x+this.offsetX,this.y*t.y+this.offsetY).transform(e)}calcCornerCoords(t,e,r,i,s,o){const l=jA([Hm(r,i),xf({angle:t}),FA((s?this.touchSizeX:this.sizeX)||e,(s?this.touchSizeY:this.sizeY)||e)]);return{tl:new tt(-.5,-.5).transform(l),tr:new tt(.5,-.5).transform(l),br:new tt(.5,.5).transform(l),bl:new tt(-.5,.5).transform(l)}}commonRenderProps(t,e,r,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const{cornerSize:o,cornerColor:l,transparentCorners:u,cornerStrokeColor:h}=s,d=o||i.cornerSize,p=this.sizeX||d,g=this.sizeY||d,v=u!==void 0?u:i.transparentCorners,T=v?si:Fn,S=h||i.cornerStrokeColor,w=!v&&!!S;return t.fillStyle=l||i.cornerColor||"",t.strokeStyle=S||"",t.translate(e,r),t.rotate(an(i.getTotalAngle())),{stroke:w,xSize:p,ySize:g,transparentCorners:v,opName:T}}render(t,e,r,i,s){((i=i||{}).cornerStyle||s.cornerStyle)==="circle"?uft.call(this,t,e,r,i,s):hft.call(this,t,e,r,i,s)}}const fft=(n,t,e)=>e.lockRotation?wb:t.cursorStyle,dft=Cf(vU,Af((n,t,e,r)=>{let{target:i,ex:s,ey:o,theta:l,originX:u,originY:h}=t;const d=i.getPositionByOrigin(u,h);if(us(i,"lockRotation"))return!1;const p=Math.atan2(o-d.y,s-d.x),g=Math.atan2(r-d.y,e-d.x);let v=Dl(g-p+l);if(i.snapAngle&&i.snapAngle>0){const S=i.snapAngle,w=i.snapThreshold||S,E=Math.ceil(v/S)*S,D=Math.floor(v/S)*S;Math.abs(v-D)<w?v=D:Math.abs(v-E)<w&&(v=E)}v<0&&(v=360+v),v%=360;const T=i.angle!==v;return i.angle=v,T}));function GU(n,t){const e=t.canvas,r=n[e.uniScaleKey];return e.uniformScaling&&!r||!e.uniformScaling&&r}function YU(n,t,e){const r=us(n,"lockScalingX"),i=us(n,"lockScalingY");if(r&&i||!t&&(r||i)&&e||r&&t==="x"||i&&t==="y")return!0;const{width:s,height:o,strokeWidth:l}=n;return s===0&&l===0&&t!=="y"||o===0&&l===0&&t!=="x"}const pft=["e","se","s","sw","w","nw","n","ne","e"],op=(n,t,e,r)=>{const i=GU(n,e);if(YU(e,t.x!==0&&t.y===0?"x":t.x===0&&t.y!==0?"y":"",i))return wb;const s=FU(e,0,r);return`${pft[s]}-resize`};function WA(n,t,e,r){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const s=t.target,o=i.by,l=GU(n,s);let u,h,d,p,g,v;if(YU(s,o,l))return!1;if(t.gestureScale)h=t.scaleX*t.gestureScale,d=t.scaleY*t.gestureScale;else{if(u=$A(t,t.originX,t.originY,e,r),g=o!=="y"?Math.sign(u.x||t.signX||1):1,v=o!=="x"?Math.sign(u.y||t.signY||1):1,t.signX||(t.signX=g),t.signY||(t.signY=v),us(s,"lockScalingFlip")&&(t.signX!==g||t.signY!==v))return!1;if(p=s._getTransformedDimensions(),l&&!o){const w=Math.abs(u.x)+Math.abs(u.y),{original:E}=t,D=w/(Math.abs(p.x*E.scaleX/s.scaleX)+Math.abs(p.y*E.scaleY/s.scaleY));h=E.scaleX*D,d=E.scaleY*D}else h=Math.abs(u.x*s.scaleX/p.x),d=Math.abs(u.y*s.scaleY/p.y);VU(t)&&(h*=2,d*=2),t.signX!==g&&o!=="y"&&(t.originX=DN(t.originX),h*=-1,t.signX=g),t.signY!==v&&o!=="x"&&(t.originY=DN(t.originY),d*=-1,t.signY=v)}const T=s.scaleX,S=s.scaleY;return o?(o==="x"&&s.set(Ur,h),o==="y"&&s.set(Ii,d)):(!us(s,"lockScalingX")&&s.set(Ur,h),!us(s,"lockScalingY")&&s.set(Ii,d)),T!==s.scaleX||S!==s.scaleY}const Gy=Cf(w_,Af((n,t,e,r)=>WA(n,t,e,r))),mft=Cf(w_,Af((n,t,e,r)=>WA(n,t,e,r,{by:"x"}))),gft=Cf(w_,Af((n,t,e,r)=>WA(n,t,e,r,{by:"y"}))),nx={x:{counterAxis:"y",scale:Ur,skew:Sf,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Ii,skew:wf,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},yft=["ns","nesw","ew","nwse"],vft=(n,t,e,r)=>{if(t.x!==0&&us(e,"lockSkewingY")||t.y!==0&&us(e,"lockSkewingX"))return wb;const i=FU(e,0,r)%4;return`${yft[i]}-resize`};function KU(n,t,e,r,i){const{target:s}=e,{counterAxis:o,origin:l,lockSkewing:u,skew:h,flip:d}=nx[n];if(us(s,u))return!1;const{origin:p,flip:g}=nx[o],v=mr(e[p])*(s[g]?-1:1),T=-Math.sign(v)*(s[d]?-1:1),S=.5*-((s[h]===0&&$A(e,Gt,Gt,r,i)[n]>0||s[h]>0?1:-1)*T)+.5;return Cf(bU,Af((E,D,P,V)=>(function(N,q,M){let{target:k,ex:R,ey:F,skewingSide:U,...H}=q;const{skew:j}=nx[N],yt=M.subtract(new tt(R,F)).divide(new tt(k.scaleX,k.scaleY))[N],xt=k[j],J=H[j],st=Math.tan(an(J)),ht=N==="y"?k._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:k._getTransformedDimensions({scaleX:1,scaleY:1}).y,Ct=2*yt*U/Math.max(ht,1)+st,Vt=Dl(Math.atan(Ct));k.set(j,Vt);const $=xt!==k[j];if($&&N==="y"){const{skewX:ot,scaleX:dt}=k,mt=k._getTransformedDimensions({skewY:xt}),Ot=k._getTransformedDimensions(),It=ot!==0?mt.x/Ot.x:1;It!==1&&k.set(Ur,It*dt)}return $})(n,D,new tt(P,V))))(t,{...e,[l]:S,skewingSide:T},r,i)}const bft=(n,t,e,r)=>KU("x",n,t,e,r),_ft=(n,t,e,r)=>KU("y",n,t,e,r);function M_(n,t){return n[t.canvas.altActionKey]}const Yy=(n,t,e)=>{const r=M_(n,e);return t.x===0?r?Sf:Ii:t.y===0?r?wf:Ur:""},kh=(n,t,e,r)=>M_(n,e)?vft(0,t,e,r):op(n,t,e,r),FN=(n,t,e,r)=>M_(n,t.target)?_ft(n,t,e,r):mft(n,t,e,r),BN=(n,t,e,r)=>M_(n,t.target)?bft(n,t,e,r):gft(n,t,e,r),XU=()=>({ml:new Qi({x:-.5,y:0,cursorStyleHandler:kh,actionHandler:FN,getActionName:Yy}),mr:new Qi({x:.5,y:0,cursorStyleHandler:kh,actionHandler:FN,getActionName:Yy}),mb:new Qi({x:0,y:.5,cursorStyleHandler:kh,actionHandler:BN,getActionName:Yy}),mt:new Qi({x:0,y:-.5,cursorStyleHandler:kh,actionHandler:BN,getActionName:Yy}),tl:new Qi({x:-.5,y:-.5,cursorStyleHandler:op,actionHandler:Gy}),tr:new Qi({x:.5,y:-.5,cursorStyleHandler:op,actionHandler:Gy}),bl:new Qi({x:-.5,y:.5,cursorStyleHandler:op,actionHandler:Gy}),br:new Qi({x:.5,y:.5,cursorStyleHandler:op,actionHandler:Gy}),mtr:new Qi({x:0,y:-.5,actionHandler:dft,cursorStyleHandler:fft,offsetY:-40,withConnection:!0,actionName:LA})}),Tft=()=>({mr:new Qi({x:.5,y:0,actionHandler:jN,cursorStyleHandler:kh,actionName:cm}),ml:new Qi({x:-.5,y:0,actionHandler:jN,cursorStyleHandler:kh,actionName:cm})}),Sft=()=>({...XU(),...Tft()});class dm extends Do{static getDefaults(){return{...super.getDefaults(),...dm.ownDefaults}}constructor(t){super(),Object.assign(this,this.constructor.createControls(),dm.ownDefaults),this.setOptions(t)}static createControls(){return{controls:XU()}}_updateCacheCanvas(){const t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){const e=t._currentTransform,r=e.target,i=e.action;if(this===r&&i&&i.startsWith(x_))return!1}return super._updateCacheCanvas()}getActiveControl(){const t=this.__corner;return t?{key:t,control:this.controls[t],coord:this.oCoords[t]}:void 0}findControl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const r=Object.entries(this.oCoords);for(let i=r.length-1;i>=0;i--){const[s,o]=r[i],l=this.controls[s];if(l.shouldActivate(s,this,t,e?o.touchCorner:o.corner))return this.__corner=s,{key:s,control:l,coord:this.oCoords[s]}}}calcOCoords(){const t=this.getViewportTransform(),e=this.getCenterPoint(),r=Hm(e.x,e.y),i=xf({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=Zn(r,i),o=Zn(t,s),l=Zn(o,[1/t[0],0,0,1/t[3],0,0]),u=this.group?_b(this.calcTransformMatrix()):void 0;u&&(u.scaleX=Math.abs(u.scaleX),u.scaleY=Math.abs(u.scaleY));const h=this._calculateCurrentDimensions(u),d={};return this.forEachControl((p,g)=>{const v=p.positionHandler(h,l,this,p);d[g]=Object.assign(v,this._calcCornerCoords(p,v))}),d}_calcCornerCoords(t,e){const r=this.getTotalAngle();return{corner:t.calcCornerCoords(r,this.cornerSize,e.x,e.y,!1,this),touchCorner:t.calcCornerCoords(r,this.touchCornerSize,e.x,e.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(t){for(const e in this.controls)t(this.controls[e],e,this)}drawSelectionBackground(t){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;t.save();const e=this.getRelativeCenterPoint(),r=this._calculateCurrentDimensions(),i=this.getViewportTransform();t.translate(e.x,e.y),t.scale(1/i[0],1/i[3]),t.rotate(an(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-r.x/2,-r.y/2,r.x,r.y),t.restore()}strokeBorders(t,e){t.strokeRect(-e.x/2,-e.y/2,e.x,e.y)}_drawBorders(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i={hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray,...r};t.save(),t.strokeStyle=i.borderColor,this._setLineDash(t,i.borderDashArray),this.strokeBorders(t,e),i.hasControls&&this.drawControlsConnectingLines(t,e),t.restore()}_renderControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:r,hasControls:i}=this,s={hasBorders:r,hasControls:i,...e},o=this.getViewportTransform(),l=s.hasBorders,u=s.hasControls,h=Zn(o,this.calcTransformMatrix()),d=_b(h);t.save(),t.translate(d.translateX,d.translateY),t.lineWidth=this.borderScaleFactor,this.group===this.parent&&(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(d.angle-=180),t.rotate(an(this.group?d.angle:this.angle)),l&&this.drawBorders(t,d,e),u&&this.drawControls(t,e),t.restore()}drawBorders(t,e,r){let i;if(r&&r.forActiveSelection||this.group){const s=zA(this.width,this.height,E_(e)),o=this.isStrokeAccountedForInDimensions()?VA:(this.strokeUniform?new tt().scalarAdd(this.canvas?this.canvas.getZoom():1):new tt(e.scaleX,e.scaleY)).scalarMultiply(this.strokeWidth);i=s.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else i=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(t,i,r)}drawControlsConnectingLines(t,e){let r=!1;t.beginPath(),this.forEachControl((i,s)=>{i.withConnection&&i.getVisibility(this,s)&&(r=!0,t.moveTo(i.x*e.x,i.y*e.y),t.lineTo(i.x*e.x+i.offsetX,i.y*e.y+i.offsetY))}),r&&t.stroke()}drawControls(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t.save();const r=this.getCanvasRetinaScaling(),{cornerStrokeColor:i,cornerDashArray:s,cornerColor:o}=this,l={cornerStrokeColor:i,cornerDashArray:s,cornerColor:o,...e};t.setTransform(r,0,0,r,0,0),t.strokeStyle=t.fillStyle=l.cornerColor,this.transparentCorners||(t.strokeStyle=l.cornerStrokeColor),this._setLineDash(t,l.cornerDashArray),this.forEachControl((u,h)=>{if(u.getVisibility(this,h)){const d=this.oCoords[h];u.render(t,d.x,d.y,l,this)}}),t.restore()}isControlVisible(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)}setControlVisible(t,e){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e}setControlsVisibility(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(t).forEach(e=>{let[r,i]=e;return this.setControlVisible(r,i)})}clearContextTop(t){if(!this.canvas)return;const e=this.canvas.contextTop;if(!e)return;const r=this.canvas.viewportTransform;e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(e);const i=this.width+4,s=this.height+4;return e.clearRect(-i/2,-s/2,i,s),t||e.restore(),e}onDeselect(t){return!1}onSelect(t){return!1}shouldStartDragging(t){return!1}onDragStart(t){return!1}canDrop(t){return!1}renderDragSourceEffect(t){}renderDropTargetEffect(t){}}function QU(n,t){return t.forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(r=>{r!=="constructor"&&Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(e.prototype,r)||Object.create(null))})}),n}W(dm,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class or extends dm{}QU(or,[BU]),_t.setClass(or),_t.setClass(or,"object");const wft=(n,t,e,r)=>{const i=2*(r=Math.round(r))+1,{data:s}=n.getImageData(t-r,e-r,i,i);for(let o=3;o<s.length;o+=4)if(s[o]>0)return!1;return!0};class JU{constructor(t){this.options=t,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new tt(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new tt(1/this.options.scaleX,1/this.options.scaleY):new tt(1,1)}createSideVector(t,e){const r=Sb(t,e);return this.options.strokeUniform?r.multiply(this.scale):r}projectOrthogonally(t,e,r){return this.applySkew(t.add(this.calcOrthogonalProjection(t,e,r)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(t){const e=new tt(t);return e.y+=e.x*Math.tan(an(this.options.skewY)),e.x+=e.y*Math.tan(an(this.options.skewX)),e}scaleUnitVector(t,e){return t.multiply(this.strokeUniformScalar).scalarMultiply(e)}}const xft=new tt;class zh extends JU{static getOrthogonalRotationFactor(t,e){const r=e?KE(t,e):NU(t);return Math.abs(r)<zm?-1:1}constructor(t,e,r,i){super(i),W(this,"AB",void 0),W(this,"AC",void 0),W(this,"alpha",void 0),W(this,"bisector",void 0),this.A=new tt(t),this.B=new tt(e),this.C=new tt(r),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=KE(this.AB,this.AC),this.bisector=HA(PU(this.AB.eq(xft)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const i=this.createSideVector(t,e),s=LU(i),o=zh.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,r*o)}projectBevel(){const t=[];return(this.alpha%rf===0?[this.B]:[this.B,this.C]).forEach(e=>{t.push(this.projectOrthogonally(this.A,e)),t.push(this.projectOrthogonally(this.A,e,-this.strokeProjectionMagnitude))}),t}projectMiter(){const t=[],e=Math.abs(this.alpha),r=1/Math.sin(e/2),i=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*r),s=this.options.strokeUniform?YE(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return YE(i)/this.strokeProjectionMagnitude<=s&&t.push(this.applySkew(this.A.add(i))),t.push(...this.projectBevel()),t}projectRoundNoSkew(t,e){const r=[],i=new tt(zh.getOrthogonalRotationFactor(this.bisector),zh.getOrthogonalRotationFactor(new tt(this.bisector.y,this.bisector.x)));return[new tt(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i),new tt(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i)].forEach(s=>{MN(s,t,e)&&r.push(this.A.add(s))}),r}projectRoundWithSkew(t,e){const r=[],{skewX:i,skewY:s,scaleX:o,scaleY:l,strokeUniform:u}=this.options,h=new tt(Math.tan(an(i)),Math.tan(an(s))),d=this.strokeProjectionMagnitude,p=u?d/l/Math.sqrt(1/l**2+1/o**2*h.y**2):d/Math.sqrt(1+h.y**2),g=new tt(Math.sqrt(Math.max(d**2-p**2,0)),p),v=u?d/Math.sqrt(1+h.x**2*(1/l)**2/(1/o+1/o*h.x*h.y)**2):d/Math.sqrt(1+h.x**2/(1+h.x*h.y)**2),T=new tt(v,Math.sqrt(Math.max(d**2-v**2,0)));return[T,T.scalarMultiply(-1),g,g.scalarMultiply(-1)].map(S=>this.applySkew(u?S.multiply(this.strokeUniformScalar):S)).forEach(S=>{MN(S,t,e)&&r.push(this.applySkew(this.A).add(S))}),r}projectRound(){const t=[];t.push(...this.projectBevel());const e=this.alpha%rf===0,r=this.applySkew(this.A),i=t[e?0:2].subtract(r),s=t[e?1:0].subtract(r),o=e?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),l=Op(i,o)>0,u=l?i:s,h=l?s:i;return this.isSkewed()?t.push(...this.projectRoundWithSkew(u,h)):t.push(...this.projectRoundNoSkew(u,h)),t}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(t=>({originPoint:this.A,projectedPoint:t,angle:this.alpha,bisector:this.bisector}))}}class UN extends JU{constructor(t,e,r){super(r),this.A=new tt(t),this.T=new tt(e)}calcOrthogonalProjection(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const i=this.createSideVector(t,e);return this.scaleUnitVector(LU(i),r)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const t=[];if(!this.isSkewed()&&this.A.eq(this.T)){const e=new tt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.applySkew(this.A.add(e)),this.applySkew(this.A.subtract(e)))}else t.push(...new zh(this.A,this.T,this.T,this.options).projectRound());return t}projectSquare(){const t=[];if(this.A.eq(this.T)){const e=new tt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);t.push(this.A.add(e),this.A.subtract(e))}else{const e=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),r=this.scaleUnitVector(HA(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),i=this.A.add(r);t.push(i.add(e),i.subtract(e))}return t.map(e=>this.applySkew(e))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(t=>({originPoint:this.A,projectedPoint:t}))}}const Eft=function(n,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const r=[];if(n.length===0)return r;const i=n.reduce((s,o)=>(s[s.length-1].eq(o)||s.push(new tt(o)),s),[new tt(n[0])]);if(i.length===1)e=!0;else if(!e){const s=i[0],o=((l,u)=>{for(let h=l.length-1;h>=0;h--)if(u(l[h],h,l))return h;return-1})(i,l=>!l.eq(s));i.splice(o+1)}return i.forEach((s,o,l)=>{let u,h;o===0?(h=l[1],u=e?s:l[l.length-1]):o===l.length-1?(u=l[o-1],h=e?s:l[0]):(u=l[o-1],h=l[o+1]),e&&l.length===1?r.push(...new UN(s,s,t).project()):!e||o!==0&&o!==l.length-1?r.push(...new zh(s,u,h,t).project()):r.push(...new UN(s,o===0?h:u,t).project())}),r},GA=n=>{const t={};return Object.keys(n).forEach(e=>{t[e]={},Object.keys(n[e]).forEach(r=>{t[e][r]={...n[e][r]}})}),t},YA=function(n,t){let e=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return n.fill!==t.fill||n.stroke!==t.stroke||n.strokeWidth!==t.strokeWidth||n.fontSize!==t.fontSize||n.fontFamily!==t.fontFamily||n.fontWeight!==t.fontWeight||n.fontStyle!==t.fontStyle||n.textDecorationThickness!==t.textDecorationThickness||n.textBackgroundColor!==t.textBackgroundColor||n.deltaY!==t.deltaY||e&&(n.overline!==t.overline||n.underline!==t.underline||n.linethrough!==t.linethrough)},Cft=(n,t)=>{const e=t.split(`
`),r=[];let i=-1,s={};n=GA(n);for(let o=0;o<e.length;o++){const l=UA(e[o]);if(n[o])for(let u=0;u<l.length;u++){i++;const h=n[o][u];h&&Object.keys(h).length>0&&(YA(s,h,!0)?r.push({start:i,end:i+1,style:h}):r[r.length-1].end++),s=h||{}}else i+=l.length,s={}}return r},Aft=(n,t)=>{if(!Array.isArray(n))return GA(n);const e=t.split(NA),r={};let i=-1,s=0;for(let o=0;o<e.length;o++){const l=UA(e[o]);for(let u=0;u<l.length;u++)i++,n[s]&&n[s].start<=i&&i<n[s].end&&(r[o]=r[o]||{},r[o][u]={...n[s].style},i===n[s].end-1&&s++)}return r},Hl=["display","transform",Fn,"fill-opacity","fill-rule","opacity",si,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function zN(n,t){const e=n.nodeName,r=n.getAttribute("class"),i=n.getAttribute("id"),s="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+e,"i"),t=t.replace(o,""),i&&t.length&&(o=new RegExp("#"+i+s,"i"),t=t.replace(o,"")),r&&t.length){const l=r.split(" ");for(let u=l.length;u--;)o=new RegExp("\\."+l[u]+s,"i"),t=t.replace(o,"")}return t.length===0}function kft(n,t){let e=!0;const r=zN(n,t.pop());return r&&t.length&&(e=(function(i,s){let o,l=!0;for(;i.parentElement&&i.parentElement.nodeType===1&&s.length;)l&&(o=s.pop()),l=zN(i=i.parentElement,o);return s.length===0})(n,t)),r&&e&&t.length===0}function Mft(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e={};for(const r in t)kft(n,r.split(" "))&&(e={...e,...t[r]});return e}const Dft=n=>{var t;return(t=Qht[n])!==null&&t!==void 0?t:n},Oft=new RegExp(`(${du})`,"gi"),gr=`(${du})`,Rft=String.raw`(skewX)\(${gr}\)`,Ift=String.raw`(skewY)\(${gr}\)`,Pft=String.raw`(rotate)\(${gr}(?: ${gr} ${gr})?\)`,Nft=String.raw`(scale)\(${gr}(?: ${gr})?\)`,Lft=String.raw`(translate)\(${gr}(?: ${gr})?\)`,KA=`(?:${String.raw`(matrix)\(${gr} ${gr} ${gr} ${gr} ${gr} ${gr}\)`}|${Lft}|${Pft}|${Nft}|${Rft}|${Ift})`,Vft=`(?:${KA}*)`,jft=String.raw`^\s*(?:${Vft}?)\s*$`,Fft=new RegExp(jft),Bft=new RegExp(KA),Uft=new RegExp(KA,"g");function XE(n){const t=[];if(!(n=(e=>xb(e.replace(Oft," $1 ").replace(/,/gi," ")))(n).replace(/\s*([()])\s*/gi,"$1"))||n&&!Fft.test(n))return[...xr];for(const e of n.matchAll(Uft)){const r=Bft.exec(e[0]);if(!r)continue;let i=xr;const s=r.filter(T=>!!T),[,o,...l]=s,[u,h,d,p,g,v]=l.map(T=>parseFloat(T));switch(o){case"translate":i=Hm(u,h);break;case LA:i=xf({angle:u},{x:h,y:d});break;case x_:i=FA(u,h);break;case Sf:i=CU(u);break;case wf:i=AU(u);break;case"matrix":i=[u,h,d,p,g,v]}t.push(i)}return jA(t)}function zft(n,t,e,r){const i=Array.isArray(t);let s,o=t;if(n!==Fn&&n!==si||t!==Br){if(n==="strokeUniform")return t==="non-scaling-stroke";if(n==="strokeDashArray")o=t===Br?null:t.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(n==="transformMatrix")o=e&&e.transformMatrix?Zn(e.transformMatrix,XE(t)):XE(t);else if(n==="visible")o=t!==Br&&t!=="hidden",e&&e.visible===!1&&(o=!1);else if(n==="opacity")o=parseFloat(t),e&&e.opacity!==void 0&&(o*=e.opacity);else if(n==="textAnchor")o=t==="start"?fe:t==="end"?on:Gt;else if(n==="charSpacing"||n===fu)s=Uh(t,r)/r*1e3;else if(n==="paintFirst"){const l=t.indexOf(Fn),u=t.indexOf(si);o=Fn,(l>-1&&u>-1&&u<l||l===-1&&u>-1)&&(o=si)}else{if(n==="href"||n==="xlink:href"||n==="font"||n==="id")return t;if(n==="imageSmoothing")return t==="optimizeQuality";s=i?t.map(Uh):Uh(t,r)}}else o="";return!i&&isNaN(s)?o:s}function Hft(n,t){n.replace(/;\s*$/,"").split(";").forEach(e=>{if(!e)return;const[r,i]=e.split(":");t[r.trim().toLowerCase()]=i.trim()})}function $ft(n){const t={},e=n.getAttribute("style");return e&&(typeof e=="string"?Hft(e,t):(function(r,i){Object.entries(r).forEach(s=>{let[o,l]=s;l!==void 0&&(i[o.toLowerCase()]=l)})})(e,t)),t}const qft={stroke:"strokeOpacity",fill:"fillOpacity"};function sa(n,t,e){if(!n)return{};let r,i={},s=PA;n.parentNode&&NN.test(n.parentNode.nodeName)&&(i=sa(n.parentElement,t,e),i.fontSize&&(r=s=Uh(i.fontSize)));const o={...t.reduce((h,d)=>{const p=n.getAttribute(d);return p&&(h[d]=p),h},{}),...Mft(n,e),...$ft(n)};o[tx]&&n.setAttribute(tx,o[tx]),o[Zw]&&(r=Uh(o[Zw],s),o[Zw]=`${r}`);const l={};for(const h in o){const d=Dft(h),p=zft(d,o[h],i,r);l[d]=p}l&&l.font&&(function(h,d){const p=h.match(Xht);if(!p)return;const g=p[1],v=p[3],T=p[4],S=p[5],w=p[6];g&&(d.fontStyle=g),v&&(d.fontWeight=isNaN(parseFloat(v))?v:parseFloat(v)),T&&(d.fontSize=Uh(T)),w&&(d.fontFamily=w),S&&(d.lineHeight=S===qE?1:S)})(l.font,l);const u={...i,...l};return NN.test(n.nodeName)?u:(function(h){const d=or.getDefaults();return Object.entries(qft).forEach(p=>{let[g,v]=p;if(h[v]===void 0||h[g]==="")return;if(h[g]===void 0){if(!d[g])return;h[g]=d[g]}if(h[g].indexOf("url(")===0)return;const T=new xe(h[g]);h[g]=T.setAlpha(Me(T.getAlpha()*h[v],2)).toRgba()}),h})(u)}const ZU=["rx","ry"];class Us extends or{static getDefaults(){return{...super.getDefaults(),...Us.ownDefaults}}constructor(t){super(),Object.assign(this,Us.ownDefaults),this.setOptions(t),this._initRxRy()}_initRxRy(){const{rx:t,ry:e}=this;t&&!e?this.ry=t:e&&!t&&(this.rx=e)}_render(t){const{width:e,height:r}=this,i=-e/2,s=-r/2,o=this.rx?Math.min(this.rx,e/2):0,l=this.ry?Math.min(this.ry,r/2):0,u=o!==0||l!==0;t.beginPath(),t.moveTo(i+o,s),t.lineTo(i+e-o,s),u&&t.bezierCurveTo(i+e-za*o,s,i+e,s+za*l,i+e,s+l),t.lineTo(i+e,s+r-l),u&&t.bezierCurveTo(i+e,s+r-za*l,i+e-za*o,s+r,i+e-o,s+r),t.lineTo(i+o,s+r),u&&t.bezierCurveTo(i+za*o,s+r,i,s+r-za*l,i,s+r-l),t.lineTo(i,s+l),u&&t.bezierCurveTo(i,s+za*l,i+za*o,s,i+o,s),t.closePath(),this._renderPaintInOrder(t)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...ZU,...t])}_toSVG(){const{width:t,height:e,rx:r,ry:i}=this;return["<rect ","COMMON_PARTS",`x="${-t/2}" y="${-e/2}" rx="${ne(r)}" ry="${ne(i)}" width="${ne(t)}" height="${ne(e)}" />
`]}static async fromElement(t,e,r){const{left:i=0,top:s=0,width:o=0,height:l=0,visible:u=!0,...h}=sa(t,this.ATTRIBUTE_NAMES,r);return new this({...e,...h,left:i,top:s,width:o,height:l,visible:!!(u&&o&&l)})}}W(Us,"type","Rect"),W(Us,"cacheProperties",[...ia,...ZU]),W(Us,"ownDefaults",{rx:0,ry:0}),W(Us,"ATTRIBUTE_NAMES",[...Hl,"x","y","rx","ry","width","height"]),_t.setClass(Us),_t.setSVGClass(Us);const Fo="initialization",Cb="added",XA="removed",Ab="imperative",tz=(n,t)=>{const{strokeUniform:e,strokeWidth:r,width:i,height:s,group:o}=t,l=o&&o!==n?A_(o.calcTransformMatrix(),n.calcTransformMatrix()):null,u=l?t.getRelativeCenterPoint().transform(l):t.getRelativeCenterPoint(),h=!t.isStrokeAccountedForInDimensions(),d=e&&h?zht(new tt(r,r),void 0,n.calcTransformMatrix()):VA,p=!e&&h?r:0,g=zA(i+p,s+p,jA([l,t.calcOwnMatrix()],!0)).add(d).scalarDivide(2);return[u.subtract(g),u.add(g)]};class D_{calcLayoutResult(t,e){if(this.shouldPerformLayout(t))return this.calcBoundingBox(e,t)}shouldPerformLayout(t){let{type:e,prevStrategy:r,strategy:i}=t;return e===Fo||e===Ab||!!r&&i!==r}shouldLayoutClipPath(t){let{type:e,target:{clipPath:r}}=t;return e!==Fo&&r&&!r.absolutePositioned}getInitialSize(t,e){return e.size}calcBoundingBox(t,e){const{type:r,target:i}=e;if(r===Ab&&e.overrides)return e.overrides;if(t.length===0)return;const{left:s,top:o,width:l,height:u}=Wo(t.map(p=>tz(i,p)).reduce((p,g)=>p.concat(g),[])),h=new tt(l,u),d=new tt(s,o).add(h.scalarDivide(2));if(r===Fo){const p=this.getInitialSize(e,{size:h,center:d});return{center:d,relativeCorrection:new tt(0,0),size:p}}return{center:d.transform(i.calcOwnMatrix()),size:h}}}W(D_,"type","strategy");class QE extends D_{shouldPerformLayout(t){return!0}}W(QE,"type","fit-content"),_t.setClass(QE);const ez="layoutManager";class pm{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new QE;W(this,"strategy",void 0),this.strategy=t,this._subscriptions=new Map}performLayout(t){const e={bubbles:!0,strategy:this.strategy,...t,prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}};this.onBeforeLayout(e);const r=this.getLayoutResult(e);r&&this.commitLayout(e,r),this.onAfterLayout(e,r),this._prevLayoutStrategy=e.strategy}attachHandlers(t,e){const{target:r}=e;return[vb,yU,cm,vU,w_,bU,yb,Aht,kht].map(i=>t.on(i,s=>this.performLayout(i===vb?{type:"object_modified",trigger:i,e:s,target:r}:{type:"object_modifying",trigger:i,e:s,target:r})))}subscribe(t,e){this.unsubscribe(t,e);const r=this.attachHandlers(t,e);this._subscriptions.set(t,r)}unsubscribe(t,e){(this._subscriptions.get(t)||[]).forEach(r=>r()),this._subscriptions.delete(t)}unsubscribeTargets(t){t.targets.forEach(e=>this.unsubscribe(e,t))}subscribeTargets(t){t.targets.forEach(e=>this.subscribe(e,t))}onBeforeLayout(t){const{target:e,type:r}=t,{canvas:i}=e;if(r===Fo||r===Cb?this.subscribeTargets(t):r===XA&&this.unsubscribeTargets(t),e.fire("layout:before",{context:t}),i&&i.fire("object:layout:before",{target:e,context:t}),r===Ab&&t.deep){const{strategy:s,...o}=t;e.forEachObject(l=>l.layoutManager&&l.layoutManager.performLayout({...o,bubbles:!1,target:l}))}}getLayoutResult(t){const{target:e,strategy:r,type:i}=t,s=r.calcLayoutResult(t,e.getObjects());if(!s)return;const o=i===Fo?new tt:e.getRelativeCenterPoint(),{center:l,correction:u=new tt,relativeCorrection:h=new tt}=s,d=o.subtract(l).add(u).transform(i===Fo?xr:rs(e.calcOwnMatrix()),!0).add(h);return{result:s,prevCenter:o,nextCenter:l,offset:d}}commitLayout(t,e){const{target:r}=t,{result:{size:i},nextCenter:s}=e;var o,l;r.set({width:i.x,height:i.y}),this.layoutObjects(t,e),t.type===Fo?r.set({left:(o=t.x)!==null&&o!==void 0?o:s.x+i.x*mr(r.originX),top:(l=t.y)!==null&&l!==void 0?l:s.y+i.y*mr(r.originY)}):(r.setPositionByOrigin(s,Gt,Gt),r.setCoords(),r.set("dirty",!0))}layoutObjects(t,e){const{target:r}=t;r.forEachObject(i=>{i.group===r&&this.layoutObject(t,e,i)}),t.strategy.shouldLayoutClipPath(t)&&this.layoutObject(t,e,r.clipPath)}layoutObject(t,e,r){let{offset:i}=e;r.set({left:r.left+i.x,top:r.top+i.y})}onAfterLayout(t,e){const{target:r,strategy:i,bubbles:s,prevStrategy:o,...l}=t,{canvas:u}=r;r.fire("layout:after",{context:t,result:e}),u&&u.fire("object:layout:after",{context:t,result:e,target:r});const h=r.parent;s&&h!=null&&h.layoutManager&&((l.path||(l.path=[])).push(r),h.layoutManager.performLayout({...l,target:h})),r.set("dirty",!0)}dispose(){const{_subscriptions:t}=this;t.forEach(e=>e.forEach(r=>r())),t.clear()}toObject(){return{type:ez,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}_t.setClass(pm,ez);class Wft extends pm{performLayout(){}}class Qc extends _U(or){static getDefaults(){return{...super.getDefaults(),...Qc.ownDefaults}}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),W(this,"_activeObjects",[]),W(this,"__objectSelectionTracker",void 0),W(this,"__objectSelectionDisposer",void 0),Object.assign(this,Qc.ownDefaults),this.setOptions(e),this.groupInit(t,e)}groupInit(t,e){var r;this._objects=[...t],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(i=>{this.enterGroup(i,!1)}),this.layoutManager=(r=e.layoutManager)!==null&&r!==void 0?r:new pm,this.layoutManager.performLayout({type:Fo,target:this,targets:[...t],x:e.left,y:e.top})}canEnterGroup(t){return t===this||this.isDescendantOf(t)?(kl("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(t)===-1||(kl("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(t){return t.filter((e,r,i)=>this.canEnterGroup(e)&&i.indexOf(e)===r)}add(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const i=this._filterObjectsBeforeEnteringGroup(e),s=super.add(...i);return this._onAfterObjectsChange(Cb,i),s}insertAt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];const s=this._filterObjectsBeforeEnteringGroup(r),o=super.insertAt(t,...s);return this._onAfterObjectsChange(Cb,s),o}remove(){const t=super.remove(...arguments);return this._onAfterObjectsChange(XA,t),t}_onObjectAdded(t){this.enterGroup(t,!0),this.fire("object:added",{target:t}),t.fire("added",{target:this})}_onObjectRemoved(t,e){this.exitGroup(t,e),this.fire("object:removed",{target:t}),t.fire("removed",{target:this})}_onAfterObjectsChange(t,e){this.layoutManager.performLayout({type:t,targets:e,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(t,e){const r=this[t];return super._set(t,e),t==="canvas"&&r!==e&&(this._objects||[]).forEach(i=>{i._set(t,e)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(t,e){let{target:r}=e;const i=this._activeObjects;if(t)i.push(r),this._set("dirty",!0);else if(i.length>0){const s=i.indexOf(r);s>-1&&(i.splice(s,1),this._set("dirty",!0))}}_watchObject(t,e){t&&this._watchObject(!1,e),t?(e.on("selected",this.__objectSelectionTracker),e.on("deselected",this.__objectSelectionDisposer)):(e.off("selected",this.__objectSelectionTracker),e.off("deselected",this.__objectSelectionDisposer))}enterGroup(t,e){t.group&&t.group.remove(t),t._set("parent",this),this._enterGroup(t,e)}_enterGroup(t,e){e&&Tb(t,Zn(rs(this.calcTransformMatrix()),t.calcTransformMatrix())),this._shouldSetNestedCoords()&&t.setCoords(),t._set("group",this),t._set("canvas",this.canvas),this._watchObject(!0,t);const r=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();r&&(r===t||t.isDescendantOf(r))&&this._activeObjects.push(t)}exitGroup(t,e){this._exitGroup(t,e),t._set("parent",void 0),t._set("canvas",void 0)}_exitGroup(t,e){t._set("group",void 0),e||(Tb(t,Zn(this.calcTransformMatrix(),t.calcTransformMatrix())),t.setCoords()),this._watchObject(!1,t);const r=this._activeObjects.length>0?this._activeObjects.indexOf(t):-1;r>-1&&this._activeObjects.splice(r,1)}shouldCache(){const t=or.prototype.shouldCache.call(this);if(t){for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return this.ownCaching=!1,!1}return t}willDrawShadow(){if(super.willDrawShadow())return!0;for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(t,e,r){this._renderBackground(t);for(let s=0;s<this._objects.length;s++){var i;const o=this._objects[s];(i=this.canvas)!==null&&i!==void 0&&i.preserveObjectStacking&&o.group!==this?(t.save(),t.transform(...rs(this.calcTransformMatrix())),o.render(t),t.restore()):o.group===this&&o.render(t)}this._drawClipPath(t,this.clipPath,r)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(t=>t.setCoords())}triggerLayout(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout({target:this,type:Ab,...t})}render(t){this._transformDone=!0,super.render(t),this._transformDone=!1}__serializeObjects(t,e){const r=this.includeDefaultValues;return this._objects.filter(function(i){return!i.excludeFromExport}).map(function(i){const s=i.includeDefaultValues;i.includeDefaultValues=r;const o=i[t||"toObject"](e);return i.includeDefaultValues=s,o})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.layoutManager.toObject();return{...super.toObject(["subTargetCheck","interactive",...t]),...e.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:e}:{},objects:this.__serializeObjects("toObject",t)}}toString(){return`#<Group: (${this.complexity()})>`}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(t=>{this._watchObject(!1,t),t.dispose()}),super.dispose()}_createSVGBgRect(t){if(!this.backgroundColor)return"";const e=Us.prototype._toSVG.call(this),r=e.indexOf("COMMON_PARTS");e[r]='for="group" ';const i=e.join("");return t?t(i):i}_toSVG(t){const e=["<g ","COMMON_PARTS",` >
`],r=this._createSVGBgRect(t);r&&e.push("		",r);for(let i=0;i<this._objects.length;i++)e.push("		",this._objects[i].toSVG(t));return e.push(`</g>
`),e}getSvgStyles(){const t=this.opacity!==void 0&&this.opacity!==1?`opacity: ${ne(this.opacity)};`:"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")}toClipPathSVG(t){const e=[],r=this._createSVGBgRect(t);r&&e.push("	",r);for(let i=0;i<this._objects.length;i++)e.push("	",this._objects[i].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}static fromObject(t,e){let{type:r,objects:i=[],layoutManager:s,...o}=t;return Promise.all([um(i,e),C_(o,e)]).then(l=>{let[u,h]=l;const d=new this(u,{...o,...h,layoutManager:new Wft});if(s){const p=_t.getClass(s.type),g=_t.getClass(s.strategy);d.layoutManager=new p(new g)}else d.layoutManager=new pm;return d.layoutManager.subscribeTargets({type:Fo,target:d,targets:d.getObjects()}),d.setCoords(),d})}}W(Qc,"type","Group"),W(Qc,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),_t.setClass(Qc);const Gft=(n,t)=>Math.min(t.width/n.width,t.height/n.height),Yft=(n,t)=>Math.max(t.width/n.width,t.height/n.height),JE="\\s*,?\\s*",Gd=`${JE}(${du})`,Kft=`${Gd}${Gd}${Gd}${JE}([01])${JE}([01])${Gd}${Gd}`,Xft={m:"l",M:"L"},Qft=(n,t,e,r,i,s,o,l,u,h,d)=>{const p=Zo(n),g=ta(n),v=Zo(t),T=ta(t),S=e*i*v-r*s*T+o,w=r*i*v+e*s*T+l;return["C",h+u*(-e*i*g-r*s*p),d+u*(-r*i*g+e*s*p),S+u*(e*i*T+r*s*v),w+u*(r*i*T-e*s*v),S,w]},HN=(n,t,e,r)=>{const i=Math.atan2(t,n),s=Math.atan2(r,e);return s>=i?s-i:2*Math.PI-(i-s)};function $N(n,t,e,r,i,s,o,l){let u;if(ve.cachesBoundsOfCurve&&(u=[...arguments].join(),Dp.boundsOfCurveCache[u]))return Dp.boundsOfCurveCache[u];const h=Math.sqrt,d=Math.abs,p=[],g=[[0,0],[0,0]];let v=6*n-12*e+6*i,T=-3*n+9*e-9*i+3*o,S=3*e-3*n;for(let V=0;V<2;++V){if(V>0&&(v=6*t-12*r+6*s,T=-3*t+9*r-9*s+3*l,S=3*r-3*t),d(T)<1e-12){if(d(v)<1e-12)continue;const R=-S/v;0<R&&R<1&&p.push(R);continue}const N=v*v-4*S*T;if(N<0)continue;const q=h(N),M=(-v+q)/(2*T);0<M&&M<1&&p.push(M);const k=(-v-q)/(2*T);0<k&&k<1&&p.push(k)}let w=p.length;const E=w,D=nz(n,t,e,r,i,s,o,l);for(;w--;){const{x:V,y:N}=D(p[w]);g[0][w]=V,g[1][w]=N}g[0][E]=n,g[1][E]=t,g[0][E+1]=o,g[1][E+1]=l;const P=[new tt(Math.min(...g[0]),Math.min(...g[1])),new tt(Math.max(...g[0]),Math.max(...g[1]))];return ve.cachesBoundsOfCurve&&(Dp.boundsOfCurveCache[u]=P),P}const Jft=(n,t,e)=>{let[r,i,s,o,l,u,h,d]=e;const p=((g,v,T,S,w,E,D)=>{if(T===0||S===0)return[];let P=0,V=0,N=0;const q=Math.PI,M=D*IA,k=ta(M),R=Zo(M),F=.5*(-R*g-k*v),U=.5*(-R*v+k*g),H=T**2,j=S**2,yt=U**2,xt=F**2,J=H*j-H*yt-j*xt;let st=Math.abs(T),ht=Math.abs(S);if(J<0){const Mt=Math.sqrt(1-J/(H*j));st*=Mt,ht*=Mt}else N=(w===E?-1:1)*Math.sqrt(J/(H*yt+j*xt));const Ct=N*st*U/ht,Vt=-N*ht*F/st,$=R*Ct-k*Vt+.5*g,ot=k*Ct+R*Vt+.5*v;let dt=HN(1,0,(F-Ct)/st,(U-Vt)/ht),mt=HN((F-Ct)/st,(U-Vt)/ht,(-F-Ct)/st,(-U-Vt)/ht);E===0&&mt>0?mt-=2*q:E===1&&mt<0&&(mt+=2*q);const Ot=Math.ceil(Math.abs(mt/q*2)),It=[],Ut=mt/Ot,Fe=8/3*Math.sin(Ut/4)*Math.sin(Ut/4)/Math.sin(Ut/2);let he=dt+Ut;for(let Mt=0;Mt<Ot;Mt++)It[Mt]=Qft(dt,he,R,k,st,ht,$,ot,Fe,P,V),P=It[Mt][5],V=It[Mt][6],dt=he,he+=Ut;return It})(h-n,d-t,i,s,l,u,o);for(let g=0,v=p.length;g<v;g++)p[g][1]+=n,p[g][2]+=t,p[g][3]+=n,p[g][4]+=t,p[g][5]+=n,p[g][6]+=t;return p},Zft=n=>{let t=0,e=0,r=0,i=0;const s=[];let o,l=0,u=0;for(const h of n){const d=[...h];let p;switch(d[0]){case"l":d[1]+=t,d[2]+=e;case"L":t=d[1],e=d[2],p=["L",t,e];break;case"h":d[1]+=t;case"H":t=d[1],p=["L",t,e];break;case"v":d[1]+=e;case"V":e=d[1],p=["L",t,e];break;case"m":d[1]+=t,d[2]+=e;case"M":t=d[1],e=d[2],r=d[1],i=d[2],p=["M",t,e];break;case"c":d[1]+=t,d[2]+=e,d[3]+=t,d[4]+=e,d[5]+=t,d[6]+=e;case"C":l=d[3],u=d[4],t=d[5],e=d[6],p=["C",d[1],d[2],l,u,t,e];break;case"s":d[1]+=t,d[2]+=e,d[3]+=t,d[4]+=e;case"S":o==="C"?(l=2*t-l,u=2*e-u):(l=t,u=e),t=d[3],e=d[4],p=["C",l,u,d[1],d[2],t,e],l=p[3],u=p[4];break;case"q":d[1]+=t,d[2]+=e,d[3]+=t,d[4]+=e;case"Q":l=d[1],u=d[2],t=d[3],e=d[4],p=["Q",l,u,t,e];break;case"t":d[1]+=t,d[2]+=e;case"T":o==="Q"?(l=2*t-l,u=2*e-u):(l=t,u=e),t=d[1],e=d[2],p=["Q",l,u,t,e];break;case"a":d[6]+=t,d[7]+=e;case"A":Jft(t,e,d).forEach(g=>s.push(g)),t=d[6],e=d[7];break;case"z":case"Z":t=r,e=i,p=["Z"]}p?(s.push(p),o=p[0]):o=""}return s},kb=(n,t,e,r)=>Math.sqrt((e-n)**2+(r-t)**2),nz=(n,t,e,r,i,s,o,l)=>u=>{const h=u**3,d=(v=>3*v**2*(1-v))(u),p=(v=>3*v*(1-v)**2)(u),g=(v=>(1-v)**3)(u);return new tt(o*h+i*d+e*p+n*g,l*h+s*d+r*p+t*g)},rz=n=>n**2,iz=n=>2*n*(1-n),sz=n=>(1-n)**2,tdt=(n,t,e,r,i,s,o,l)=>u=>{const h=rz(u),d=iz(u),p=sz(u),g=3*(p*(e-n)+d*(i-e)+h*(o-i)),v=3*(p*(r-t)+d*(s-r)+h*(l-s));return Math.atan2(v,g)},edt=(n,t,e,r,i,s)=>o=>{const l=rz(o),u=iz(o),h=sz(o);return new tt(i*l+e*u+n*h,s*l+r*u+t*h)},ndt=(n,t,e,r,i,s)=>o=>{const l=1-o,u=2*(l*(e-n)+o*(i-e)),h=2*(l*(r-t)+o*(s-r));return Math.atan2(h,u)},qN=(n,t,e)=>{let r=new tt(t,e),i=0;for(let s=1;s<=100;s+=1){const o=n(s/100);i+=kb(r.x,r.y,o.x,o.y),r=o}return i},rdt=(n,t)=>{let e,r=0,i=0,s={x:n.x,y:n.y},o={...s},l=.01,u=0;const h=n.iterator,d=n.angleFinder;for(;i<t&&l>1e-4;)o=h(r),u=r,e=kb(s.x,s.y,o.x,o.y),e+i>t?(r-=l,l/=2):(s=o,r+=l,i+=e);return{...o,angle:d(u)}},oz=n=>{let t,e,r=0,i=0,s=0,o=0,l=0;const u=[];for(const h of n){const d={x:i,y:s,command:h[0],length:0};switch(h[0]){case"M":e=d,e.x=o=i=h[1],e.y=l=s=h[2];break;case"L":e=d,e.length=kb(i,s,h[1],h[2]),i=h[1],s=h[2];break;case"C":t=nz(i,s,h[1],h[2],h[3],h[4],h[5],h[6]),e=d,e.iterator=t,e.angleFinder=tdt(i,s,h[1],h[2],h[3],h[4],h[5],h[6]),e.length=qN(t,i,s),i=h[5],s=h[6];break;case"Q":t=edt(i,s,h[1],h[2],h[3],h[4]),e=d,e.iterator=t,e.angleFinder=ndt(i,s,h[1],h[2],h[3],h[4]),e.length=qN(t,i,s),i=h[3],s=h[4];break;case"Z":e=d,e.destX=o,e.destY=l,e.length=kb(i,s,o,l),i=o,s=l}r+=e.length,u.push(e)}return u.push({length:r,x:i,y:s}),u},idt=function(n,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:oz(n),r=0;for(;t-e[r].length>0&&r<e.length-2;)t-=e[r].length,r++;const i=e[r],s=t/i.length,o=n[r];switch(i.command){case"M":return{x:i.x,y:i.y,angle:0};case"Z":return{...new tt(i.x,i.y).lerp(new tt(i.destX,i.destY),s),angle:Math.atan2(i.destY-i.y,i.destX-i.x)};case"L":return{...new tt(i.x,i.y).lerp(new tt(o[1],o[2]),s),angle:Math.atan2(o[2]-i.y,o[1]-i.x)};case"C":case"Q":return rdt(i,t)}},sdt=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),WN=new RegExp(Kft,"g"),odt=new RegExp(du,"gi"),adt={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},ldt=n=>{var t;const e=[],r=(t=n.match(sdt))!==null&&t!==void 0?t:[];for(const i of r){const s=i[0];if(s==="z"||s==="Z"){e.push([s]);continue}const o=adt[s.toLowerCase()];let l=[];if(s==="a"||s==="A"){WN.lastIndex=0;for(let u=null;u=WN.exec(i);)l.push(...u.slice(1))}else l=i.match(odt)||[];for(let u=0;u<l.length;u+=o){const h=new Array(o),d=Xft[s];h[0]=u>0&&d?d:s;for(let p=0;p<o;p++)h[p+1]=parseFloat(l[u+p]);e.push(h)}}return e},cdt=function(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=new tt(n[0]),r=new tt(n[1]),i=1,s=0;const o=[],l=n.length,u=l>2;let h;for(u&&(i=n[2].x<r.x?-1:n[2].x===r.x?0:1,s=n[2].y<r.y?-1:n[2].y===r.y?0:1),o.push(["M",e.x-i*t,e.y-s*t]),h=1;h<l;h++){if(!e.eq(r)){const d=e.midPointFrom(r);o.push(["Q",e.x,e.y,d.x,d.y])}e=n[h],h+1<n.length&&(r=n[h+1])}return u&&(i=e.x>n[h-2].x?1:e.x===n[h-2].x?0:-1,s=e.y>n[h-2].y?1:e.y===n[h-2].y?0:-1),o.push(["L",e.x+i*t,e.y+s*t]),o},az=(n,t)=>n.map(e=>e.map((r,i)=>i===0||t===void 0?r:Me(r,t)).join(" ")).join(" ");function ZE(n,t){const e=n.style;e&&Object.entries(t).forEach(r=>{let[i,s]=r;return e.setProperty(i,s)})}class udt extends OU{constructor(t){let{allowTouchScrolling:e=!1,containerClass:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t),W(this,"upper",void 0),W(this,"container",void 0);const{el:i}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(i,{allowTouchScrolling:e}),this.applyCanvasStyle(s,{allowTouchScrolling:e,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(r),i.parentNode&&i.parentNode.replaceChild(o,i),o.append(i,s),this.container=o}createUpperCanvas(){const{el:t}=this.lower,e=ea();return e.className=t.className,e.classList.remove("lower-canvas"),e.classList.add("upper-canvas"),e.setAttribute("data-fabric","top"),e.style.cssText=t.style.cssText,e.setAttribute("draggable","true"),e}createContainerElement(){const t=Tf().createElement("div");return t.setAttribute("data-fabric","wrapper"),ZE(t,{position:"relative"}),AN(t),t}applyCanvasStyle(t,e){const{styles:r,allowTouchScrolling:i}=e;ZE(t,{...r,"touch-action":i?"manipulation":Br}),AN(t)}setDimensions(t,e){super.setDimensions(t,e);const{el:r,ctx:i}=this.upper;DU(r,i,t,e)}setCSSDimensions(t){super.setCSSDimensions(t),WE(this.upper.el,t),WE(this.container,t)}cleanupDOM(t){const e=this.container,{el:r}=this.lower,{el:i}=this.upper;super.cleanupDOM(t),e.removeChild(i),e.removeChild(r),e.parentNode&&e.parentNode.replaceChild(r,e)}dispose(){super.dispose(),io().dispose(this.upper.el),delete this.upper,delete this.container}}const hdt=(n,t,e,r)=>{const{target:i,offsetX:s,offsetY:o}=t,l=e-s,u=r-o,h=!us(i,"lockMovementX")&&i.left!==l,d=!us(i,"lockMovementY")&&i.top!==u;return h&&i.set(fe,l),d&&i.set(Fr,u),(h||d)&&WU(yU,jU(n,t,e,r)),h||d};class O_ extends $m{constructor(){super(...arguments),W(this,"_hoveredTargets",[]),W(this,"_currentTransform",null),W(this,"_groupSelector",null),W(this,"contextTopDirty",!1)}static getDefaults(){return{...super.getDefaults(),...O_.ownDefaults}}get upperCanvasEl(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.el}get contextTop(){var t;return(t=this.elements.upper)===null||t===void 0?void 0:t.ctx}get wrapperEl(){return this.elements.container}initElements(t){this.elements=new udt(t,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(t){this._objectsToRender=void 0,super._onObjectAdded(t)}_onObjectRemoved(t){this._objectsToRender=void 0,t===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[t]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[t]}),t.fire("deselected",{target:t})),t===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(t)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const t=this._activeObject;return!this.preserveObjectStacking&&t?this._objects.filter(e=>!e.group&&e!==t).concat(t):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()}renderTop(){const t=this.contextTop;this.clearContext(t),this.renderTopLayer(t),this.fire("after:render",{ctx:t})}setTargetFindTolerance(t){t=Math.round(t),this.targetFindTolerance=t;const e=this.getRetinaScaling(),r=Math.ceil((2*t+1)*e);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=r,this.pixelFindContext.scale(e,e)}isTargetTransparent(t,e,r){const i=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-e+i,-r+i),s.transform(...this.viewportTransform);const o=t.selectionBackgroundColor;t.selectionBackgroundColor="",t.render(s),t.selectionBackgroundColor=o,s.restore();const l=Math.round(i*this.getRetinaScaling());return wft(s,l,l,l)}_isSelectionKeyPressed(t){const e=this.selectionKey;return!!e&&(Array.isArray(e)?!!e.find(r=>!!r&&t[r]===!0):t[e])}_shouldClearSelection(t,e){const r=this.getActiveObjects(),i=this._activeObject;return!!(!e||e&&i&&r.length>1&&r.indexOf(e)===-1&&i!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&i&&i!==e)}_shouldCenterTransform(t,e,r){if(!t)return;let i;return e===x_||e===Ur||e===Ii||e===cm?i=this.centeredScaling||t.centeredScaling:e===LA&&(i=this.centeredRotation||t.centeredRotation),i?!r:r}_getOriginFromCorner(t,e){const r=e?t.controls[e].getTransformAnchorPoint():{x:t.originX,y:t.originY};return e&&(["ml","tl","bl"].includes(e)?r.x=on:["mr","tr","br"].includes(e)&&(r.x=fe),["tl","mt","tr"].includes(e)?r.y=$E:["bl","mb","br"].includes(e)&&(r.y=Fr)),r}_setupCurrentTransform(t,e,r){var i;const s=e.group?sf(this.getScenePoint(t),void 0,e.group.calcTransformMatrix()):this.getScenePoint(t),{key:o="",control:l}=e.getActiveControl()||{},u=r&&l?(i=l.getActionHandler(t,e,l))===null||i===void 0?void 0:i.bind(l):hdt,h=((k,R,F,U)=>{if(!R||!k)return"drag";const H=U.controls[R];return H.getActionName(F,H,U)})(r,o,t,e),d=t[this.centeredKey],p=this._shouldCenterTransform(e,h,d)?{x:Gt,y:Gt}:this._getOriginFromCorner(e,o),{scaleX:g,scaleY:v,skewX:T,skewY:S,left:w,top:E,angle:D,width:P,height:V,cropX:N,cropY:q}=e,M={target:e,action:h,actionHandler:u,actionPerformed:!1,corner:o,scaleX:g,scaleY:v,skewX:T,skewY:S,offsetX:s.x-w,offsetY:s.y-E,originX:p.x,originY:p.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:an(D),width:P,height:V,shiftKey:t.shiftKey,altKey:d,original:{...RU(e),originX:p.x,originY:p.y,cropX:N,cropY:q}};this._currentTransform=M,this.fire("before:transform",{e:t,transform:M})}setCursor(t){this.upperCanvasEl.style.cursor=t}_drawSelection(t){const{x:e,y:r,deltaX:i,deltaY:s}=this._groupSelector,o=new tt(e,r).transform(this.viewportTransform),l=new tt(e+i,r+s).transform(this.viewportTransform),u=this.selectionLineWidth/2;let h=Math.min(o.x,l.x),d=Math.min(o.y,l.y),p=Math.max(o.x,l.x),g=Math.max(o.y,l.y);this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(h,d,p-h,g-d)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,h+=u,d+=u,p-=u,g-=u,or.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(h,d,p-h,g-d))}findTarget(t){if(this._targetInfo)return this._targetInfo;if(this.skipTargetFind)return{subTargets:[],currentSubTargets:[]};const e=this.getScenePoint(t),r=this._activeObject,i=this.getActiveObjects(),s=this.searchPossibleTargets(this._objects,e),{subTargets:o,container:l,target:u}=s,h={...s,currentSubTargets:o,currentContainer:l,currentTarget:u};if(!r)return h;const d={...this.searchPossibleTargets([r],e),currentSubTargets:o,currentContainer:l,currentTarget:u};return r.findControl(this.getViewportPoint(t),GE(t))?{...d,target:r}:d.target&&(i.length>1||!this.preserveObjectStacking||this.preserveObjectStacking&&t[this.altSelectionKey])?d:h}_pointIsInObjectSelectionArea(t,e){let r=t.getCoords();const i=this.getZoom(),s=t.padding/i;if(s){const[o,l,u,h]=r,d=Math.atan2(l.y-o.y,l.x-o.x),p=Zo(d)*s,g=ta(d)*s,v=p+g,T=p-g;r=[new tt(o.x-T,o.y-v),new tt(l.x+v,l.y-T),new tt(u.x+T,u.y+v),new tt(h.x-v,h.y+T)]}return Be.isPointInPolygon(e,r)}_checkTarget(t,e){if(t&&t.visible&&t.evented&&this._pointIsInObjectSelectionArea(t,e)){if(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing)return!0;{const r=e.transform(this.viewportTransform);if(!this.isTargetTransparent(t,r.x,r.y))return!0}}return!1}_searchPossibleTargets(t,e,r){let i=t.length;for(;i--;){const s=t[i];if(this._checkTarget(s,e)){if(q0(s)&&s.subTargetCheck){const{target:o}=this._searchPossibleTargets(s._objects,e,r);o&&r.push(o)}return{target:s,subTargets:r}}}return{subTargets:[]}}searchPossibleTargets(t,e){const r=this._searchPossibleTargets(t,e,[]);r.container=r.target;const{container:i,subTargets:s}=r;if(i&&q0(i)&&i.interactive&&s[0]){for(let o=s.length-1;o>0;o--){const l=s[o];if(!q0(l)||!l.interactive)return r.target=l,r}return r.target=s[0],r}return r}getViewportPoint(t){return this._viewportPoint?this._viewportPoint:this._getPointerImpl(t,!0)}getScenePoint(t){return this._scenePoint?this._scenePoint:this._getPointerImpl(t)}_getPointerImpl(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=this.upperCanvasEl,i=r.getBoundingClientRect();let s=Fht(t),o=i.width||0,l=i.height||0;o&&l||(Fr in i&&$E in i&&(l=Math.abs(i.top-i.bottom)),on in i&&fe in i&&(o=Math.abs(i.right-i.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,e||(s=sf(s,void 0,this.viewportTransform));const u=this.getRetinaScaling();u!==1&&(s.x/=u,s.y/=u);const h=o===0||l===0?new tt(1,1):new tt(r.width/o,r.height/l);return s.multiply(h)}_setDimensionsImpl(t,e){this._resetTransformEventData(),super._setDimensionsImpl(t,e),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=ea(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const t=this._activeObject;return Oc(t)?t.getObjects():t?[t]:[]}_fireSelectionEvents(t,e){let r=!1,i=!1;const s=this.getActiveObjects(),o=[],l=[];t.forEach(u=>{s.includes(u)||(r=!0,u.fire("deselected",{e,target:u}),l.push(u))}),s.forEach(u=>{t.includes(u)||(r=!0,u.fire("selected",{e,target:u}),o.push(u))}),t.length>0&&s.length>0?(i=!0,r&&this.fire("selection:updated",{e,selected:o,deselected:l})):s.length>0?(i=!0,this.fire("selection:created",{e,selected:o})):t.length>0&&(i=!0,this.fire("selection:cleared",{e,deselected:l})),i&&(this._objectsToRender=void 0)}setActiveObject(t,e){const r=this.getActiveObjects(),i=this._setActiveObject(t,e);return this._fireSelectionEvents(r,e),i}_setActiveObject(t,e){const r=this._activeObject;return r!==t&&!(!this._discardActiveObject(e,t)&&this._activeObject)&&!t.onSelect({e})&&(this._activeObject=t,Oc(t)&&r!==t&&t.set("canvas",this),t.setCoords(),!0)}_discardActiveObject(t,e){const r=this._activeObject;return!!r&&!r.onDeselect({e:t,object:e})&&(this._currentTransform&&this._currentTransform.target===r&&this.endCurrentTransform(t),Oc(r)&&r===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(t){const e=this.getActiveObjects(),r=this.getActiveObject();e.length&&this.fire("before:selection:cleared",{e:t,deselected:[r]});const i=this._discardActiveObject(t);return this._fireSelectionEvents(e,t),i}endCurrentTransform(t){const e=this._currentTransform;this._finalizeCurrentTransform(t),e&&e.target&&(e.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(t){const e=this._currentTransform,r=e.target,i={e:t,target:r,transform:e,action:e.action};r._scaling&&(r._scaling=!1),r.setCoords(),e.actionPerformed&&(this.fire("object:modified",i),r.fire(vb,i))}setViewportTransform(t){super.setViewportTransform(t);const e=this._activeObject;e&&e.setCoords()}destroy(){const t=this._activeObject;Oc(t)&&(t.removeAll(),t.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(t){const e=this._activeObject;e&&e._renderControls(t)}_toObject(t,e,r){const i=this._realizeGroupTransformOnObject(t),s=super._toObject(t,e,r);return t.set(i),s}_realizeGroupTransformOnObject(t){const{group:e}=t;if(e&&Oc(e)&&this._activeObject===e){const r=Ef(t,["angle","flipX","flipY",fe,Ur,Ii,Sf,wf,Fr]);return Bht(t,e.calcOwnMatrix()),r}return{}}_setSVGObject(t,e,r){const i=this._realizeGroupTransformOnObject(e);super._setSVGObject(t,e,r),e.set(i)}}W(O_,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!0,fireRightClick:!0,fireMiddleClick:!0,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!0});class fdt{constructor(t){W(this,"targets",[]),W(this,"__disposer",void 0);const e=()=>{const{hiddenTextarea:i}=t.getActiveObject()||{};i&&i.focus()},r=t.upperCanvasEl;r.addEventListener("click",e),this.__disposer=()=>r.removeEventListener("click",e)}exitTextEditing(){this.target=void 0,this.targets.forEach(t=>{t.isEditing&&t.exitEditing()})}add(t){this.targets.push(t)}remove(t){this.unregister(t),_h(this.targets,t)}register(t){this.target=t}unregister(t){t===this.target&&(this.target=void 0)}onMouseMove(t){var e;!((e=this.target)===null||e===void 0)&&e.isEditing&&this.target.updateSelectionOnMouseMove(t)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const Qr={passive:!1},xc=(n,t)=>({viewportPoint:n.getViewportPoint(t),scenePoint:n.getScenePoint(t)}),Ha=function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return n.addEventListener(...e)},wi=function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return n.removeEventListener(...e)},ddt={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class t1 extends O_{constructor(t){super(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),W(this,"_isClick",void 0),W(this,"textEditingManager",new fdt(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(e=>{this[e]=this[e].bind(this)}),this.addOrRemove(Ha)}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(t){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=this.upperCanvasEl,i=this._getEventPrefix();t(MU(r),"resize",this._onResize),t(r,i+"down",this._onMouseDown),t(r,`${i}move`,this._onMouseMove,Qr),t(r,`${i}out`,this._onMouseOut),t(r,`${i}enter`,this._onMouseEnter),t(r,"wheel",this._onMouseWheel,{passive:!1}),t(r,"contextmenu",this._onContextMenu),e||(t(r,"click",this._onClick),t(r,"dblclick",this._onClick)),t(r,"dragstart",this._onDragStart),t(r,"dragend",this._onDragEnd),t(r,"dragover",this._onDragOver),t(r,"dragenter",this._onDragEnter),t(r,"dragleave",this._onDragLeave),t(r,"drop",this._onDrop),this.enablePointerEvents||t(r,"touchstart",this._onTouchStart,Qr)}removeListeners(){this.addOrRemove(wi);const t=this._getEventPrefix(),e=ts(this.upperCanvasEl);wi(e,`${t}up`,this._onMouseUp),wi(e,"touchend",this._onTouchEnd,Qr),wi(e,`${t}move`,this._onMouseMove,Qr),wi(e,"touchmove",this._onMouseMove,Qr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()}_onMouseOut(t){const e=this._hoveredTarget,r={e:t,...xc(this,t)};this.fire("mouse:out",{...r,target:e}),this._hoveredTarget=void 0,e&&e.fire("mouseout",{...r}),this._hoveredTargets.forEach(i=>{this.fire("mouse:out",{...r,target:i}),i&&i.fire("mouseout",{...r})}),this._hoveredTargets=[]}_onMouseEnter(t){const{target:e}=this.findTarget(t);this._currentTransform||e||(this.fire("mouse:over",{e:t,...xc(this,t)}),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(t){this._isClick=!1;const e=this.getActiveObject();if(e&&e.onDragStart(t)){this._dragSource=e;const r={e:t,target:e};return this.fire("dragstart",r),e.fire("dragstart",r),void Ha(this.upperCanvasEl,"drag",this._onDragProgress)}kN(t)}_renderDragEffects(t,e,r){let i=!1;const s=this._dropTarget;s&&s!==e&&s!==r&&(s.clearContextTop(),i=!0),e?.clearContextTop(),r!==e&&r?.clearContextTop();const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),e&&(o.save(),e.transform(o),e.renderDragSourceEffect(t),o.restore(),i=!0),r&&(o.save(),r.transform(o),r.renderDropTargetEffect(t),o.restore(),i=!0),o.restore(),i&&(this.contextTopDirty=!0)}_onDragEnd(t){const{currentSubTargets:e}=this.findTarget(t),r=!!t.dataTransfer&&t.dataTransfer.dropEffect!==Br,i=r?this._activeObject:void 0,s={e:t,target:this._dragSource,subTargets:e,dragSource:this._dragSource,didDrop:r,dropTarget:i};wi(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(t)}_onDragProgress(t){const e={e:t,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",e),this._dragSource&&this._dragSource.fire("drag",e)}_onDragOver(t){const e="dragover",{currentContainer:r,currentSubTargets:i}=this.findTarget(t),s=this._dragSource,o={e:t,target:r,subTargets:i,dragSource:s,canDrop:!1,dropTarget:void 0};let l;this.fire(e,o),this._fireEnterLeaveEvents(t,r,o),r&&(r.canDrop(t)&&(l=r),r.fire(e,o));for(let u=0;u<i.length;u++){const h=i[u];h.canDrop(t)&&(l=h),h.fire(e,o)}this._renderDragEffects(t,s,l),this._dropTarget=l}_onDragEnter(t){const{currentContainer:e,currentSubTargets:r}=this.findTarget(t),i={e:t,target:e,subTargets:r,dragSource:this._dragSource};this.fire("dragenter",i),this._fireEnterLeaveEvents(t,e,i)}_onDragLeave(t){const{currentSubTargets:e}=this.findTarget(t),r={e:t,target:this._draggedoverTarget,subTargets:e,dragSource:this._dragSource};this.fire("dragleave",r),this._fireEnterLeaveEvents(t,void 0,r),this._renderDragEffects(t,this._dragSource),this._dropTarget=void 0,this._hoveredTargets=[]}_onDrop(t){const{currentContainer:e,currentSubTargets:r}=this.findTarget(t),i=this._basicEventHandler("drop:before",{e:t,target:e,subTargets:r,dragSource:this._dragSource,...xc(this,t)});i.didDrop=!1,i.dropTarget=void 0,this._basicEventHandler("drop",i),this.fire("drop:after",i)}_onContextMenu(t){const{target:e,subTargets:r}=this.findTarget(t),i=this._basicEventHandler("contextmenu:before",{e:t,target:e,subTargets:r});return this.stopContextMenu&&kN(t),this._basicEventHandler("contextmenu",i),!1}_onClick(t){const e=t.detail;e>3||e<2||(this._cacheTransformEventData(t),e==2&&t.type==="dblclick"&&this._handleEvent(t,"dblclick"),e==3&&this._handleEvent(t,"tripleclick"),this._resetTransformEventData())}fireEventFromPointerEvent(t,e,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this._cacheTransformEventData(t);const{target:s,subTargets:o}=this.findTarget(t),l={e:t,target:s,subTargets:o,...xc(this,t),transform:this._currentTransform,...i};this.fire(e,l),s&&s.fire(r,l);for(let u=0;u<o.length;u++)o[u]!==s&&o[u].fire(r,l);this._resetTransformEventData()}getPointerId(t){const e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1}_isMainEvent(t){return t.isPrimary===!0||t.isPrimary!==!1&&(t.type==="touchend"&&t.touches.length===0||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(t){this._cacheTransformEventData(t);let e=!this.allowTouchScrolling;const r=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t);const{target:i}=this.findTarget(t);(this.isDrawingMode||r&&i===r)&&(e=!0),e&&t.preventDefault();const s=this.upperCanvasEl,o=this._getEventPrefix(),l=ts(s);Ha(l,"touchend",this._onTouchEnd,Qr),e&&Ha(l,"touchmove",this._onMouseMove,Qr),wi(s,`${o}down`,this._onMouseDown),this._resetTransformEventData()}_onMouseDown(t){this._cacheTransformEventData(t),this.__onMouseDown(t);const e=this.upperCanvasEl,r=this._getEventPrefix();wi(e,`${r}move`,this._onMouseMove,Qr);const i=ts(e);Ha(i,`${r}up`,this._onMouseUp),Ha(i,`${r}move`,this._onMouseMove,Qr),this._resetTransformEventData()}_onTouchEnd(t){if(t.touches.length>0)return;this._cacheTransformEventData(t),this.__onMouseUp(t),this._resetTransformEventData(),delete this.mainTouchId;const e=this._getEventPrefix(),r=ts(this.upperCanvasEl);wi(r,"touchend",this._onTouchEnd,Qr),wi(r,"touchmove",this._onMouseMove,Qr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{Ha(this.upperCanvasEl,`${e}down`,this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(t){this._cacheTransformEventData(t),this.__onMouseUp(t);const e=this.upperCanvasEl,r=this._getEventPrefix();if(this._isMainEvent(t)){const i=ts(this.upperCanvasEl);wi(i,`${r}up`,this._onMouseUp),wi(i,`${r}move`,this._onMouseMove,Qr),Ha(e,`${r}move`,this._onMouseMove,Qr)}this._resetTransformEventData()}_onMouseMove(t){this._cacheTransformEventData(t);const e=this.getActiveObject();!this.allowTouchScrolling&&(!e||!e.shouldStartDragging(t))&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t),this._resetTransformEventData()}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(t){const e=this.getActiveObject();return!!e!=!!t||e&&t&&e!==t}__onMouseUp(t){var e;this._handleEvent(t,"up:before");const r=this._currentTransform,i=this._isClick,{target:s}=this.findTarget(t),{button:o}=t;if(o)return void((this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(t,"up"));if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);if(!this._isMainEvent(t))return;let l,u,h=!1;if(r&&(this._finalizeCurrentTransform(t),h=r.actionPerformed),!i){const d=s===this._activeObject;this.handleSelection(t),h||(h=this._shouldRender(s)||!d&&s===this._activeObject)}if(s){const d=s.findControl(this.getViewportPoint(t),GE(t)),{key:p,control:g}=d||{};if(u=p,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,t),h=!0;else if(g){const v=g.getMouseUpHandler(t,s,g);v&&(l=this.getScenePoint(t),v.call(g,t,r,l.x,l.y))}s.isMoving=!1}if(r&&(r.target!==s||r.corner!==u)){const d=r.target&&r.target.controls[r.corner],p=d&&d.getMouseUpHandler(t,r.target,d);l=l||this.getScenePoint(t),p&&p.call(d,t,r,l.x,l.y)}this._setCursorFromEvent(t,s),this._handleEvent(t,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),h?this.requestRenderAll():i||(e=this._activeObject)!==null&&e!==void 0&&e.isEditing||this.renderTop()}_basicEventHandler(t,e){const{target:r,subTargets:i=[]}=e;this.fire(t,e),r&&r.fire(t,e);for(let s=0;s<i.length;s++)i[s]!==r&&i[s].fire(t,e);return e}_handleEvent(t,e,r){const{target:i,subTargets:s}=this.findTarget(t),o={e:t,target:i,subTargets:s,...xc(this,t),transform:this._currentTransform,...e==="down:before"||e==="down"?r:{}};e!=="up:before"&&e!=="up"||(o.isClick=this._isClick),this.fire(`mouse:${e}`,o),i&&i.fire(`mouse${e}`,o);for(let l=0;l<s.length;l++)s[l]!==i&&s[l].fire(`mouse${e}`,o)}_onMouseDownInDrawingMode(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(t),this.requestRenderAll());const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(t){if(this._isCurrentlyDrawing){const e=this.getScenePoint(t);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")}_onMouseUpInDrawingMode(t){const e=this.getScenePoint(t);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e:t,pointer:e}):this._isCurrentlyDrawing=!1,this._handleEvent(t,"up")}__onMouseDown(t){this._isClick=!0,this._handleEvent(t,"down:before");let{target:e}=this.findTarget(t),r=!!e&&e===this._activeObject;const{button:i}=t;if(i)return void((this.fireMiddleClick&&i===1||this.fireRightClick&&i===2)&&this._handleEvent(t,"down",{alreadySelected:r}));if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._isMainEvent(t)||this._currentTransform)return;let s=this._shouldRender(e),o=!1;if(this.handleMultiSelection(t,e)?(e=this._activeObject,o=!0,s=!0):this._shouldClearSelection(t,e)&&this.discardActiveObject(t),this.selection&&(!e||!e.selectable&&!e.isEditing&&e!==this._activeObject)){const l=this.getScenePoint(t);this._groupSelector={x:l.x,y:l.y,deltaY:0,deltaX:0}}if(r=!!e&&e===this._activeObject,e){e.selectable&&e.activeOn==="down"&&this.setActiveObject(e,t);const l=e.findControl(this.getViewportPoint(t),GE(t));if(e===this._activeObject&&(l||!o)){this._setupCurrentTransform(t,e,r);const u=l?l.control:void 0,h=this.getScenePoint(t),d=u&&u.getMouseDownHandler(t,e,u);d&&d.call(u,t,this._currentTransform,h.x,h.y)}}s&&(this._objectsToRender=void 0),this._handleEvent(t,"down",{alreadySelected:r}),s&&this.requestRenderAll()}_resetTransformEventData(){this._targetInfo=this._viewportPoint=this._scenePoint=void 0}_cacheTransformEventData(t){this._resetTransformEventData(),this._viewportPoint=this.getViewportPoint(t),this._scenePoint=sf(this._viewportPoint,void 0,this.viewportTransform),this._targetInfo=this.findTarget(t),this._currentTransform&&(this._targetInfo.target=this._currentTransform.target)}__onMouseMove(t){if(this._isClick=!1,this._handleEvent(t,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);if(!this._isMainEvent(t))return;const e=this._groupSelector;if(e){const r=this.getScenePoint(t);e.deltaX=r.x-e.x,e.deltaY=r.y-e.y,this.renderTop()}else if(this._currentTransform)this._transformObject(t);else{const{target:r}=this.findTarget(t);this._setCursorFromEvent(t,r),this._fireOverOutEvents(t,r)}this.textEditingManager.onMouseMove(t),this._handleEvent(t,"move")}_fireOverOutEvents(t,e){const{_hoveredTarget:r,_hoveredTargets:i}=this,{subTargets:s}=this.findTarget(t),o=Math.max(i.length,s.length);this.fireSyntheticInOutEvents("mouse",{e:t,target:e,oldTarget:r,fireCanvas:!0});for(let l=0;l<o;l++)s[l]===e||i[l]&&i[l]===r||this.fireSyntheticInOutEvents("mouse",{e:t,target:s[l],oldTarget:i[l]});this._hoveredTarget=e,this._hoveredTargets=s}_fireEnterLeaveEvents(t,e,r){const i=this._draggedoverTarget,s=this._hoveredTargets,{subTargets:o}=this.findTarget(t),l=Math.max(s.length,o.length);this.fireSyntheticInOutEvents("drag",{...r,target:e,oldTarget:i,fireCanvas:!0});for(let u=0;u<l;u++)this.fireSyntheticInOutEvents("drag",{...r,target:o[u],oldTarget:s[u]});this._draggedoverTarget=e}fireSyntheticInOutEvents(t,e){let{target:r,oldTarget:i,fireCanvas:s,e:o,...l}=e;const{targetIn:u,targetOut:h,canvasIn:d,canvasOut:p}=ddt[t],g=i!==r;if(i&&g){const v={...l,e:o,target:i,nextTarget:r,...xc(this,o)};s&&this.fire(p,v),i.fire(h,v)}if(r&&g){const v={...l,e:o,target:r,previousTarget:i,...xc(this,o)};s&&this.fire(d,v),r.fire(u,v)}}_transformObject(t){const e=this.getScenePoint(t),r=this._currentTransform,i=r.target,s=i.group?sf(e,void 0,i.group.calcTransformMatrix()):e;r.shiftKey=t.shiftKey,r.altKey=!!this.centeredKey&&t[this.centeredKey],this._performTransformAction(t,r,s),r.actionPerformed&&this.requestRenderAll()}_performTransformAction(t,e,r){const{action:i,actionHandler:s,target:o}=e,l=!!s&&s(t,e,r.x,r.y);l&&o.setCoords(),i==="drag"&&l&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||l}_setCursorFromEvent(t,e){if(!e)return void this.setCursor(this.defaultCursor);let r=e.hoverCursor||this.hoverCursor;const i=Oc(this._activeObject)?this._activeObject:null,s=(!i||e.group!==i)&&e.findControl(this.getViewportPoint(t));if(s){const{control:o,coord:l}=s;this.setCursor(o.cursorStyleHandler(t,o,e,l))}else{if(e.subTargetCheck){const{subTargets:o}=this.findTarget(t);o.concat().reverse().forEach(l=>{r=l.hoverCursor||r})}this.setCursor(r)}}handleMultiSelection(t,e){const r=this._activeObject,i=Oc(r);if(r&&this._isSelectionKeyPressed(t)&&this.selection&&e&&e.selectable&&(r!==e||i)&&(i||!e.isDescendantOf(r)&&!r.isDescendantOf(e))&&!e.onSelect({e:t})&&!r.getActiveControl()){if(i){const s=r.getObjects();let o=[];if(e===r){const l=this.getScenePoint(t);let u=this.searchPossibleTargets(s,l);if(u.target?(e=u.target,o=u.subTargets):(u=this.searchPossibleTargets(this._objects,l),e=u.target,o=u.subTargets),!e||!e.selectable)return!1}e.group===r?(r.remove(e),this._hoveredTarget=e,this._hoveredTargets=o,r.size()===1&&this._setActiveObject(r.item(0),t)):(r.multiSelectAdd(e),this._hoveredTarget=r,this._hoveredTargets=o),this._fireSelectionEvents(s,t)}else{r.isEditing&&r.exitEditing();const s=new(_t.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(r,e),this._hoveredTarget=s,this._setActiveObject(s,t),this._fireSelectionEvents([r],t)}return!0}return!1}handleSelection(t){if(!this.selection||!this._groupSelector)return!1;const{x:e,y:r,deltaX:i,deltaY:s}=this._groupSelector,o=new tt(e,r),l=o.add(new tt(i,s)),u=o.min(l),h=o.max(l).subtract(u),d=this.collectObjects({left:u.x,top:u.y,width:h.x,height:h.y},{includeIntersecting:!this.selectionFullyContained}),p=o.eq(l)?d[0]?[d[0]]:[]:d.length>1?d.filter(g=>!g.onSelect({e:t})).reverse():d;if(p.length===1)this.setActiveObject(p[0],t);else if(p.length>1){const g=_t.getClass("ActiveSelection");this.setActiveObject(new g(p,{canvas:this}),t)}return this._groupSelector=null,!0}toCanvasElement(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0;const{upper:r}=this.elements;r.ctx=void 0;const i=super.toCanvasElement(t,e);return r.ctx=r.el.getContext("2d"),i}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const lz={x1:0,y1:0,x2:0,y2:0},pdt={...lz,r1:0,r2:0},Mh=(n,t)=>isNaN(n)&&typeof t=="number"?t:n;function cz(n){return n&&/%$/.test(n)&&Number.isFinite(parseFloat(n))}function uz(n,t){const e=typeof n=="number"?n:typeof n=="string"?parseFloat(n)/(cz(n)?100:1):NaN;return of(0,Mh(e,t),1)}const mdt=/\s*;\s*/,gdt=/\s*:\s*/;function ydt(n,t){let e,r;const i=n.getAttribute("style");if(i){const o=i.split(mdt);o[o.length-1]===""&&o.pop();for(let l=o.length;l--;){const[u,h]=o[l].split(gdt).map(d=>d.trim());u==="stop-color"?e=h:u==="stop-opacity"&&(r=h)}}e=e||n.getAttribute("stop-color")||"rgb(0,0,0)",r=Mh(parseFloat(r||n.getAttribute("stop-opacity")||""),1);const s=new xe(e);return s.setAlpha(s.getAlpha()*r*t),{offset:uz(n.getAttribute("offset"),0),color:s.toRgba()}}function vdt(n,t){const e=[],r=n.getElementsByTagName("stop"),i=uz(t,1);for(let s=r.length;s--;)e.push(ydt(r[s],i));return e}function hz(n){return n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?"linear":"radial"}function fz(n){return n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Ki(n,t){return n.getAttribute(t)}function bdt(n,t){return(function(e,r){let i,{width:s,height:o,gradientUnits:l}=r;return Object.entries(e).reduce((u,h)=>{let[d,p]=h;if(p==="Infinity")i=1;else if(p==="-Infinity")i=0;else{const g=typeof p=="string";i=g?parseFloat(p):p,g&&cz(p)&&(i*=.01,l==="pixels"&&(d!=="x1"&&d!=="x2"&&d!=="r2"||(i*=s),d!=="y1"&&d!=="y2"||(i*=o)))}return u[d]=i,u},{})})(hz(n)==="linear"?(function(e){return{x1:Ki(e,"x1")||0,y1:Ki(e,"y1")||0,x2:Ki(e,"x2")||"100%",y2:Ki(e,"y2")||0}})(n):(function(e){return{x1:Ki(e,"fx")||Ki(e,"cx")||"50%",y1:Ki(e,"fy")||Ki(e,"cy")||"50%",r1:0,x2:Ki(e,"cx")||"50%",y2:Ki(e,"cy")||"50%",r2:Ki(e,"r")||"50%"}})(n),{...t,gradientUnits:fz(n)})}class Ky{constructor(t){const{type:e="linear",gradientUnits:r="pixels",coords:i={},colorStops:s=[],offsetX:o=0,offsetY:l=0,gradientTransform:u,id:h}=t||{};Object.assign(this,{type:e,gradientUnits:r,coords:{...e==="radial"?pdt:lz,...i},colorStops:s,offsetX:o,offsetY:l,gradientTransform:u,id:h?`${h}_${Ml()}`:Ml()})}addColorStop(t){for(const e in t)this.colorStops.push({offset:parseFloat(e),color:t[e]});return this}toObject(t){return{...Ef(this,t),type:this.type,coords:{...this.coords},colorStops:this.colorStops.map(e=>({...e})),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0}}toSVG(t){let{additionalTransform:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=[],i=this.gradientTransform?this.gradientTransform.concat():xr.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(g=>({...g})).sort((g,v)=>g.offset-v.offset);let l=-this.offsetX,u=-this.offsetY;var h;s==="objectBoundingBox"?(l/=t.width,u/=t.height):(l+=t.width/2,u+=t.height/2),(h=t)&&typeof h._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(l-=t.pathOffset.x,u-=t.pathOffset.y),i[4]-=l,i[5]-=u;const d=[`id="SVGID_${ne(String(this.id))}"`,`gradientUnits="${s}"`,`gradientTransform="${e?e+" ":""}${hm(i)}"`,""].join(" "),p=g=>parseFloat(String(g));if(this.type==="linear"){const{x1:g,y1:v,x2:T,y2:S}=this.coords,w=p(g),E=p(v),D=p(T),P=p(S);r.push("<linearGradient ",d,' x1="',w,'" y1="',E,'" x2="',D,'" y2="',P,`">
`)}else if(this.type==="radial"){const{x1:g,y1:v,x2:T,y2:S,r1:w,r2:E}=this.coords,D=p(g),P=p(v),V=p(T),N=p(S),q=p(w),M=p(E),k=q>M;r.push("<radialGradient ",d,' cx="',k?D:V,'" cy="',k?P:N,'" r="',k?q:M,'" fx="',k?V:D,'" fy="',k?N:P,`">
`),k&&(o.reverse(),o.forEach(F=>{F.offset=1-F.offset}));const R=Math.min(q,M);if(R>0){const F=R/Math.max(q,M);o.forEach(U=>{U.offset+=F*(1-U.offset)})}}return o.forEach(g=>{let{color:v,offset:T}=g;r.push(`<stop offset="${100*T}%" style="stop-color:${v};"/>
`)}),r.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),r.join("")}toLive(t){const{x1:e,y1:r,x2:i,y2:s,r1:o,r2:l}=this.coords,u=this.type==="linear"?t.createLinearGradient(e,r,i,s):t.createRadialGradient(e,r,o,i,s,l);return this.colorStops.forEach(h=>{let{color:d,offset:p}=h;u.addColorStop(p,d)}),u}static async fromObject(t){const{colorStops:e,gradientTransform:r}=t;return new this({...t,colorStops:e?e.map(i=>({...i})):void 0,gradientTransform:r?[...r]:void 0})}static fromElement(t,e,r){const i=fz(t),s=e._findCenterFromElement();return new this({id:t.getAttribute("id")||void 0,type:hz(t),coords:bdt(t,{width:r.viewBoxWidth||r.width,height:r.viewBoxHeight||r.height}),colorStops:vdt(t,r.opacity),gradientUnits:i,gradientTransform:XE(t.getAttribute("gradientTransform")||""),...i==="pixels"?{offsetX:e.width/2-s.x,offsetY:e.height/2-s.y}:{offsetX:0,offsetY:0}})}}W(Ky,"type","Gradient"),_t.setClass(Ky,"gradient"),_t.setClass(Ky,"linear"),_t.setClass(Ky,"radial");class rx{get type(){return"pattern"}set type(t){kl("warn","Setting type has no effect",t)}constructor(t){W(this,"repeat","repeat"),W(this,"offsetX",0),W(this,"offsetY",0),W(this,"crossOrigin",""),this.id=Ml(),Object.assign(this,t)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(t){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?t.createPattern(this.source,this.repeat):null}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:e,crossOrigin:r}=this;return{...Ef(this,t),type:"pattern",source:this.sourceToString(),repeat:e,crossOrigin:r,offsetX:Me(this.offsetX,ve.NUM_FRACTION_DIGITS),offsetY:Me(this.offsetY,ve.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null}}toSVG(t){let{width:e,height:r}=t;const{source:i,repeat:s,id:o}=this,l=Mh(this.offsetX/e,0),u=Mh(this.offsetY/r,0),h=s==="repeat-y"||s==="no-repeat"?1+Math.abs(l||0):Mh(i.width/e,0),d=s==="repeat-x"||s==="no-repeat"?1+Math.abs(u||0):Mh(i.height/r,0);return[`<pattern id="SVGID_${ne(o)}" x="${l}" y="${u}" width="${h}" height="${d}">`,`<image x="0" y="0" width="${i.width}" height="${i.height}" xlink:href="${ne(this.sourceToString())}"></image>`,"</pattern>",""].join(`
`)}static async fromObject(t,e){let{type:r,source:i,patternTransform:s,...o}=t;const l=await G0(i,{...e,crossOrigin:o.crossOrigin});return new this({...o,patternTransform:s&&s.slice(0),source:l})}}W(rx,"type","Pattern"),_t.setClass(rx),_t.setClass(rx,"pattern");class _dt{constructor(t){W(this,"color","rgb(0, 0, 0)"),W(this,"width",1),W(this,"shadow",null),W(this,"strokeLineCap","round"),W(this,"strokeLineJoin","round"),W(this,"strokeMiterLimit",10),W(this,"strokeDashArray",null),W(this,"limitedToCanvasSize",!1),this.canvas=t}_setBrushStyles(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])}_saveAndTransform(t){const e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])}needsFullRender(){return new xe(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;const t=this.canvas,e=this.shadow,r=t.contextTop,i=t.getZoom()*t.getRetinaScaling();r.shadowColor=e.color,r.shadowBlur=e.blur*i,r.shadowOffsetX=e.offsetX*i,r.shadowOffsetY=e.offsetY*i}_resetShadow(){const t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}_isOutSideCanvas(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}}class nl extends or{constructor(t){let{path:e,left:r,top:i,...s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,nl.ownDefaults),this.setOptions(s),this._setPath(t||[],!0),typeof r=="number"&&this.set(fe,r),typeof i=="number"&&this.set(Fr,i)}_setPath(t,e){this.path=Zft(Array.isArray(t)?t:ldt(t)),this.setBoundingBox(e)}_findCenterFromElement(){const t=this._calcBoundsFromPath();return new tt(t.left+t.width/2,t.top+t.height/2)}_renderPathCommands(t){const e=-this.pathOffset.x,r=-this.pathOffset.y;t.beginPath();for(const i of this.path)switch(i[0]){case"L":t.lineTo(i[1]+e,i[2]+r);break;case"M":t.moveTo(i[1]+e,i[2]+r);break;case"C":t.bezierCurveTo(i[1]+e,i[2]+r,i[3]+e,i[4]+r,i[5]+e,i[6]+r);break;case"Q":t.quadraticCurveTo(i[1]+e,i[2]+r,i[3]+e,i[4]+r);break;case"Z":t.closePath()}}_render(t){this._renderPathCommands(t),this._renderPaintInOrder(t)}toString(){return`#<Path (${this.complexity()}): { "top": ${this.top}, "left": ${this.left} }>`}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject(t),path:this.path.map(e=>e.slice())}}toDatalessObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=this.toObject(t);return this.sourcePath&&(delete e.path,e.sourcePath=this.sourcePath),e}_toSVG(){return["<path ","COMMON_PARTS",`d="${az(this.path,ve.NUM_FRACTION_DIGITS)}" stroke-linecap="round" />
`]}_getOffsetTransform(){const t=ve.NUM_FRACTION_DIGITS;return` translate(${Me(-this.pathOffset.x,t)}, ${Me(-this.pathOffset.y,t)})`}toClipPathSVG(t){const e=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}toSVG(t){const e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{width:e,height:r,pathOffset:i}=this._calcDimensions();this.set({width:e,height:r,pathOffset:i}),t&&this.setPositionByOrigin(i,Gt,Gt)}_calcBoundsFromPath(){const t=[];let e=0,r=0,i=0,s=0;for(const o of this.path)switch(o[0]){case"L":i=o[1],s=o[2],t.push({x:e,y:r},{x:i,y:s});break;case"M":i=o[1],s=o[2],e=i,r=s;break;case"C":t.push(...$N(i,s,o[1],o[2],o[3],o[4],o[5],o[6])),i=o[5],s=o[6];break;case"Q":t.push(...$N(i,s,o[1],o[2],o[1],o[2],o[3],o[4])),i=o[3],s=o[4];break;case"Z":i=e,s=r}return Wo(t)}_calcDimensions(){const t=this._calcBoundsFromPath();return{...t,pathOffset:new tt(t.left+t.width/2,t.top+t.height/2)}}static fromObject(t){return this._fromObject(t,{extraParam:"path"})}static async fromElement(t,e,r){const{d:i,...s}=sa(t,this.ATTRIBUTE_NAMES,r);return new this(i,{...s,...e,left:void 0,top:void 0})}}W(nl,"type","Path"),W(nl,"cacheProperties",[...ia,"path","fillRule"]),W(nl,"ATTRIBUTE_NAMES",[...Hl,"d"]),_t.setClass(nl),_t.setSVGClass(nl);class Mb extends _dt{constructor(t){super(t),W(this,"decimate",.4),W(this,"drawStraightLine",!1),W(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(t,e,r){const i=e.midPointFrom(r);return t.quadraticCurveTo(e.x,e.y,i.x,i.y),i}onMouseDown(t,e){let{e:r}=e;this.canvas._isMainEvent(r)&&(this.drawStraightLine=!!this.straightLineKey&&r[this.straightLineKey],this._prepareForDrawing(t),this._addPoint(t),this._render())}onMouseMove(t,e){let{e:r}=e;if(this.canvas._isMainEvent(r)&&(this.drawStraightLine=!!this.straightLineKey&&r[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(t))&&this._addPoint(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{const i=this._points,s=i.length,o=this.canvas.contextTop;this._saveAndTransform(o),this.oldEnd&&(o.beginPath(),o.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=Mb.drawSegment(o,i[s-2],i[s-1]),o.stroke(),o.restore()}}onMouseUp(t){let{e}=t;return!this.canvas._isMainEvent(e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(t){this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)}_addPoint(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,e=this._points[0],r=this._points[1];if(this._saveAndTransform(t),t.beginPath(),this._points.length===2&&e.x===r.x&&e.y===r.y){const i=this.width/1e3;e.x-=i,r.x+=i}t.moveTo(e.x,e.y);for(let i=1;i<this._points.length;i++)Mb.drawSegment(t,e,r),e=this._points[i],r=this._points[i+1];t.lineTo(e.x,e.y),t.stroke(),t.restore()}convertPointsToSVGPath(t){const e=this.width/1e3;return cdt(t,e)}createPath(t){const e=new nl(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new Js(this.shadow)),e}decimatePoints(t,e){if(t.length<=2)return t;let r,i=t[0];const s=this.canvas.getZoom(),o=Math.pow(e/s,2),l=t.length-1,u=[i];for(let h=1;h<l-1;h++)r=Math.pow(i.x-t[h].x,2)+Math.pow(i.y-t[h].y,2),r>=o&&(i=t[h],u.push(i));return u.push(t[l]),u}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));const t=this.convertPointsToSVGPath(this._points);if((function(r){return az(r)==="M 0 0 Q 0 0 0 0 L 0 0"})(t))return void this.canvas.requestRenderAll();const e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.requestRenderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}}const dz=["radius","startAngle","endAngle","counterClockwise"];class Io extends or{static getDefaults(){return{...super.getDefaults(),...Io.ownDefaults}}constructor(t){super(),Object.assign(this,Io.ownDefaults),this.setOptions(t)}_set(t,e){return super._set(t,e),t==="radius"&&this.setRadius(e),this}_render(t){t.beginPath(),t.arc(0,0,this.radius,an(this.startAngle),an(this.endAngle),this.counterClockwise),this._renderPaintInOrder(t)}getRadiusX(){return this.get("radius")*this.get(Ur)}getRadiusY(){return this.get("radius")*this.get(Ii)}setRadius(t){this.radius=t,this.set({width:2*t,height:2*t})}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...dz,...t])}_toSVG(){const{radius:t,startAngle:e,endAngle:r}=this,i=(r-e)%360;if(i===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',`${ne(t)}`,`" />
`];{const s=an(e),o=an(r),l=Zo(s)*t,u=ta(s)*t,h=Zo(o)*t,d=ta(o)*t;return[`<path d="M ${l} ${u} A ${t} ${t} 0 ${i>180?1:0} ${this.counterClockwise?0:1} ${h} ${d}" `,"COMMON_PARTS",` />
`]}}static async fromElement(t,e,r){const{left:i=0,top:s=0,radius:o=0,...l}=sa(t,this.ATTRIBUTE_NAMES,r);return new this({...l,radius:o,left:i-o,top:s-o})}static fromObject(t){return super._fromObject(t)}}W(Io,"type","Circle"),W(Io,"cacheProperties",[...ia,...dz]),W(Io,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),W(Io,"ATTRIBUTE_NAMES",["cx","cy","r",...Hl]),_t.setClass(Io),_t.setSVGClass(Io);const e1=["x1","x2","y1","y2"];class Rc extends or{constructor(){let[t,e,r,i]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Rc.ownDefaults),this.setOptions(s),this.x1=t,this.x2=r,this.y1=e,this.y2=i,this._setWidthHeight();const{left:o,top:l}=s;typeof o=="number"&&this.set(fe,o),typeof l=="number"&&this.set(Fr,l)}_setWidthHeight(){const{x1:t,y1:e,x2:r,y2:i}=this;this.width=Math.abs(r-t),this.height=Math.abs(i-e);const{left:s,top:o,width:l,height:u}=Wo([{x:t,y:e},{x:r,y:i}]),h=new tt(s+l/2,o+u/2);this.setPositionByOrigin(h,Gt,Gt)}_set(t,e){return super._set(t,e),e1.includes(t)&&this._setWidthHeight(),this}_render(t){t.beginPath();const e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;const r=t.strokeStyle;var i;Ai(this.stroke)?t.strokeStyle=this.stroke.toLive(t):t.strokeStyle=(i=this.stroke)!==null&&i!==void 0?i:t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=r}_findCenterFromElement(){return new tt((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject(t),...this.calcLinePoints()}}_getNonTransformedDimensions(){const t=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(t.y-=this.strokeWidth),this.height===0&&(t.x-=this.strokeWidth)),t}calcLinePoints(){const{x1:t,x2:e,y1:r,y2:i,width:s,height:o}=this,l=t<=e?-.5:.5,u=r<=i?-.5:.5;return{x1:l*s,x2:l*-s,y1:u*o,y2:u*-o}}_toSVG(){const{x1:t,x2:e,y1:r,y2:i}=this.calcLinePoints();return["<line ","COMMON_PARTS",`x1="${t}" y1="${r}" x2="${e}" y2="${i}" />
`]}static async fromElement(t,e,r){const{x1:i=0,y1:s=0,x2:o=0,y2:l=0,...u}=sa(t,this.ATTRIBUTE_NAMES,r);return new this([i,s,o,l],u)}static fromObject(t){let{x1:e,y1:r,x2:i,y2:s,...o}=t;return this._fromObject({...o,points:[e,r,i,s]},{extraParam:"points"})}}W(Rc,"type","Line"),W(Rc,"cacheProperties",[...ia,...e1]),W(Rc,"ATTRIBUTE_NAMES",Hl.concat(e1)),_t.setClass(Rc),_t.setSVGClass(Rc);class Uc extends or{static getDefaults(){return{...super.getDefaults(),...Uc.ownDefaults}}constructor(t){super(),Object.assign(this,Uc.ownDefaults),this.setOptions(t)}_render(t){const e=this.width/2,r=this.height/2;t.beginPath(),t.moveTo(-e,r),t.lineTo(0,-r),t.lineTo(e,r),t.closePath(),this._renderPaintInOrder(t)}_toSVG(){const t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',`${-t} ${e},0 ${-e},${t} ${e}`,'" />']}}W(Uc,"type","Triangle"),W(Uc,"ownDefaults",{width:100,height:100}),_t.setClass(Uc),_t.setSVGClass(Uc);const pz=["rx","ry"];class Po extends or{static getDefaults(){return{...super.getDefaults(),...Po.ownDefaults}}constructor(t){super(),Object.assign(this,Po.ownDefaults),this.setOptions(t)}_set(t,e){switch(super._set(t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this}getRx(){return this.get("rx")*this.get(Ur)}getRy(){return this.get("ry")*this.get(Ii)}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...pz,...t])}_toSVG(){return["<ellipse ","COMMON_PARTS",`cx="0" cy="0" rx="${ne(this.rx)}" ry="${ne(this.ry)}" />
`]}_render(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,rf,!1),t.restore(),this._renderPaintInOrder(t)}static async fromElement(t,e,r){const i=sa(t,this.ATTRIBUTE_NAMES,r);return i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,new this(i)}}W(Po,"type","Ellipse"),W(Po,"cacheProperties",[...ia,...pz]),W(Po,"ownDefaults",{rx:0,ry:0}),W(Po,"ATTRIBUTE_NAMES",[...Hl,"cx","cy","rx","ry"]),_t.setClass(Po),_t.setSVGClass(Po);const mz={exactBoundingBox:!1};class Ji extends or{static getDefaults(){return{...super.getDefaults(),...Ji.ownDefaults}}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),W(this,"strokeDiff",void 0),Object.assign(this,Ji.ownDefaults),this.setOptions(e),this.points=t;const{left:r,top:i}=e;this.initialized=!0,this.setBoundingBox(!0),typeof r=="number"&&this.set(fe,r),typeof i=="number"&&this.set(Fr,i)}isOpen(){return!0}_projectStrokeOnPoints(t){return Eft(this.points,t,this.isOpen())}_calcDimensions(t){t={scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth,...t||{}};const e=this.exactBoundingBox?this._projectStrokeOnPoints(t).map(h=>h.projectedPoint):this.points;if(e.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new tt,strokeOffset:new tt,strokeDiff:new tt};const r=Wo(e),i=E_({...t,scaleX:1,scaleY:1}),s=Wo(this.points.map(h=>Nr(h,i,!0))),o=new tt(this.scaleX,this.scaleY);let l=r.left+r.width/2,u=r.top+r.height/2;return this.exactBoundingBox&&(l-=u*Math.tan(an(this.skewX)),u-=l*Math.tan(an(this.skewY))),{...r,pathOffset:new tt(l,u),strokeOffset:new tt(s.left,s.top).subtract(new tt(r.left,r.top)).multiply(o),strokeDiff:new tt(r.width,r.height).subtract(new tt(s.width,s.height)).multiply(o)}}_findCenterFromElement(){const t=Wo(this.points);return new tt(t.left+t.width/2,t.top+t.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(t){const{left:e,top:r,width:i,height:s,pathOffset:o,strokeOffset:l,strokeDiff:u}=this._calcDimensions();this.set({width:i,height:s,pathOffset:o,strokeOffset:l,strokeDiff:u}),t&&this.setPositionByOrigin(new tt(e+i/2,r+s/2),Gt,Gt)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new tt(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(t).some(l=>this.strokeUniform||this.constructor.layoutProperties.includes(l))){var e,r;const{width:l,height:u}=this._calcDimensions(t);o=new tt((e=t.width)!==null&&e!==void 0?e:l,(r=t.height)!==null&&r!==void 0?r:u)}else{var i,s;o=new tt((i=t.width)!==null&&i!==void 0?i:this.width,(s=t.height)!==null&&s!==void 0?s:this.height)}return o.multiply(new tt(t.scaleX||this.scaleX,t.scaleY||this.scaleY))}return super._getTransformedDimensions(t)}_set(t,e){const r=this.initialized&&this[t]!==e,i=super._set(t,e);return this.exactBoundingBox&&r&&((t===Ur||t===Ii)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(t))&&this.setDimensions(),i}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject(t),points:this.points.map(e=>{let{x:r,y:i}=e;return{x:r,y:i}})}}_toSVG(){const t=this.pathOffset.x,e=this.pathOffset.y,r=ve.NUM_FRACTION_DIGITS,i=this.points.map(s=>{let{x:o,y:l}=s;return`${Me(o-t,r)},${Me(l-e,r)}`}).join(" ");return[`<${ne(this.constructor.type).toLowerCase()} `,"COMMON_PARTS",`points="${i}" />
`]}_render(t){const e=this.points.length,r=this.pathOffset.x,i=this.pathOffset.y;if(e&&!isNaN(this.points[e-1].y)){t.beginPath(),t.moveTo(this.points[0].x-r,this.points[0].y-i);for(let s=0;s<e;s++){const o=this.points[s];t.lineTo(o.x-r,o.y-i)}!this.isOpen()&&t.closePath(),this._renderPaintInOrder(t)}}complexity(){return this.points.length}static async fromElement(t,e,r){const i=(function(u){if(!u)return[];const h=u.replace(/,/g," ").trim().split(/\s+/),d=[];for(let p=0;p<h.length;p+=2)d.push({x:parseFloat(h[p]),y:parseFloat(h[p+1])});return d})(t.getAttribute("points")),{left:s,top:o,...l}=sa(t,this.ATTRIBUTE_NAMES,r);return new this(i,{...l,...e})}static fromObject(t){return this._fromObject(t,{extraParam:"points"})}}W(Ji,"ownDefaults",mz),W(Ji,"type","Polyline"),W(Ji,"layoutProperties",[Sf,wf,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),W(Ji,"cacheProperties",[...ia,"points"]),W(Ji,"ATTRIBUTE_NAMES",[...Hl]),_t.setClass(Ji),_t.setSVGClass(Ji);class Xy extends Ji{isOpen(){return!1}}W(Xy,"ownDefaults",mz),W(Xy,"type","Polygon"),_t.setClass(Xy),_t.setSVGClass(Xy);class gz extends or{isEmptyStyles(t){if(!this.styles||t!==void 0&&!this.styles[t])return!0;const e=t===void 0?this.styles:{line:this.styles[t]};for(const r in e)for(const i in e[r])for(const s in e[r][i])return!1;return!0}styleHas(t,e){if(!this.styles||e!==void 0&&!this.styles[e])return!1;const r=e===void 0?this.styles:{0:this.styles[e]};for(const i in r)for(const s in r[i])if(r[i][s][t]!==void 0)return!0;return!1}cleanStyle(t){if(!this.styles)return!1;const e=this.styles;let r,i,s=0,o=!0,l=0;for(const u in e){r=0;for(const h in e[u]){const d=e[u][h]||{};s++,d[t]!==void 0?(i?d[t]!==i&&(o=!1):i=d[t],d[t]===this[t]&&delete d[t]):o=!1,Object.keys(d).length!==0?r++:delete e[u][h]}r===0&&delete e[u]}for(let u=0;u<this._textLines.length;u++)l+=this._textLines[u].length;o&&s===l&&(this[t]=i,this.removeStyle(t))}removeStyle(t){if(!this.styles)return;const e=this.styles;let r,i,s;for(i in e){for(s in r=e[i],r)delete r[s][t],Object.keys(r[s]).length===0&&delete r[s];Object.keys(r).length===0&&delete e[i]}}_extendStyles(t,e){const{lineIndex:r,charIndex:i}=this.get2DCursorLocation(t);this._getLineStyle(r)||this._setLineStyle(r);const s=BA({...this._getStyleDeclaration(r,i),...e},o=>o!==void 0);this._setStyleDeclaration(r,i,s)}getSelectionStyles(t,e,r){const i=[];for(let s=t;s<(e||t);s++)i.push(this.getStyleAtPosition(s,r));return i}getStyleAtPosition(t,e){const{lineIndex:r,charIndex:i}=this.get2DCursorLocation(t);return e?this.getCompleteStyleDeclaration(r,i):this._getStyleDeclaration(r,i)}setSelectionStyles(t,e,r){for(let i=e;i<(r||e);i++)this._extendStyles(i,t);this._forceClearCache=!0}_getStyleDeclaration(t,e){var r;const i=this.styles&&this.styles[t];return i&&(r=i[e])!==null&&r!==void 0?r:{}}getCompleteStyleDeclaration(t,e){return{...Ef(this,this.constructor._styleProperties),...this._getStyleDeclaration(t,e)}}_setStyleDeclaration(t,e,r){this.styles[t][e]=r}_deleteStyleDeclaration(t,e){delete this.styles[t][e]}_getLineStyle(t){return!!this.styles[t]}_setLineStyle(t){this.styles[t]={}}_deleteLineStyle(t){delete this.styles[t]}}W(gz,"_styleProperties",Yht);const Tdt=/  +/g,Sdt=/"/g;function ix(n,t,e,r,i){return`		${(function(s,o){let{left:l,top:u,width:h,height:d}=o,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ve.NUM_FRACTION_DIGITS;const g=fm(Fn,s,!1),[v,T,S,w]=[l,u,h,d].map(E=>Me(E,p));return`<rect ${g} x="${v}" y="${T}" width="${S}" height="${w}"></rect>`})(n,{left:t,top:e,width:r,height:i})}
`}let sx;class pr extends gz{static getDefaults(){return{...super.getDefaults(),...pr.ownDefaults}}constructor(t,e){super(),W(this,"__charBounds",[]),Object.assign(this,pr.ownDefaults),this.setOptions(e),this.styles||(this.styles={}),this.text=t,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const t=this.path;t&&(t.segmentsInfo=oz(t.path))}_splitText(){const t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(qs)&&this.enlargeSpaces()}enlargeSpaces(){let t,e,r,i,s,o,l;for(let u=0,h=this._textLines.length;u<h;u++)if((this.textAlign===qs||u!==h-1&&!this.isEndOfWrapping(u))&&(i=0,s=this._textLines[u],e=this.getLineWidth(u),e<this.width&&(l=this.textLines[u].match(this._reSpacesAndTabs)))){r=l.length,t=(this.width-e)/r;for(let d=0;d<=s.length;d++)o=this.__charBounds[u][d],this._reSpaceAndTab.test(s[d])?(o.width+=t,o.kernedWidth+=t,o.left+=i,i+=t):o.left+=i}}isEndOfWrapping(t){return t===this._textLines.length-1}missingNewlineOffset(t){return 1}get2DCursorLocation(t,e){const r=e?this._unwrappedTextLines:this._textLines;let i;for(i=0;i<r.length;i++){if(t<=r[i].length)return{lineIndex:i,charIndex:t};t-=r[i].length+this.missingNewlineOffset(i,e)}return{lineIndex:i-1,charIndex:r[i-1].length<t?r[i-1].length:t}}toString(){return`#<Text (${this.complexity()}): { "text": "${this.text}", "fontFamily": "${this.fontFamily}" }>`}_getCacheCanvasDimensions(){const t=super._getCacheCanvasDimensions(),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t}_render(t){const e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")}_renderText(t){this.paintFirst===si?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))}_setTextStyles(t,e,r){if(t.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Gt:t.textBaseline="middle";break;case"ascender":t.textBaseline=Fr;break;case"descender":t.textBaseline=$E}t.font=this._getFontDeclaration(e,r)}calcTextWidth(){let t=this.getLineWidth(0);for(let e=1,r=this._textLines.length;e<r;e++){const i=this.getLineWidth(e);i>t&&(t=i)}return t}_renderTextLine(t,e,r,i,s,o){this._renderChars(t,e,r,i,s,o)}_renderTextLinesBackground(t){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const e=t.fillStyle,r=this._getLeftOffset();let i=this._getTopOffset();for(let s=0,o=this._textLines.length;s<o;s++){const l=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){i+=l;continue}const u=this._textLines[s].length,h=this._getLineLeftOffset(s);let d,p,g=0,v=0,T=this.getValueOfPropertyAt(s,0,"textBackgroundColor");const S=this.getHeightOfLineImpl(s);for(let w=0;w<u;w++){const E=this.__charBounds[s][w];p=this.getValueOfPropertyAt(s,w,"textBackgroundColor"),this.path?(t.save(),t.translate(E.renderLeft,E.renderTop),t.rotate(E.angle),t.fillStyle=p,p&&t.fillRect(-E.width/2,-S*(1-this._fontSizeFraction),E.width,S),t.restore()):p!==T?(d=r+h+v,this.direction===Ro&&(d=this.width-d-g),t.fillStyle=T,T&&t.fillRect(d,i,g,S),v=E.left,g=E.width,T=p):g+=E.kernedWidth}p&&!this.path&&(d=r+h+v,this.direction===Ro&&(d=this.width-d-g),t.fillStyle=p,t.fillRect(d,i,g,S)),i+=l}t.fillStyle=e,this._removeShadow(t)}_measureChar(t,e,r,i){const s=Dp.getFontCache(e),o=this._getFontDeclaration(e),l=r?r+t:t,u=r&&o===this._getFontDeclaration(i),h=e.fontSize/this.CACHE_FONT_SIZE;let d,p,g,v;if(r&&s.has(r)&&(g=s.get(r)),s.has(t)&&(v=d=s.get(t)),u&&s.has(l)&&(p=s.get(l),v=p-g),d===void 0||g===void 0||p===void 0){const T=(function(){return sx||(sx=Pi({width:0,height:0}).getContext("2d")),sx})();this._setTextStyles(T,e,!0),d===void 0&&(v=d=T.measureText(t).width,s.set(t,d)),g===void 0&&u&&r&&(g=T.measureText(r).width,s.set(r,g)),u&&p===void 0&&(p=T.measureText(l).width,s.set(l,p),v=p-g)}return{width:d*h,kernedWidth:v*h}}getHeightOfChar(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")}measureLine(t){const e=this._measureLine(t);return this.charSpacing!==0&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e}_measureLine(t){let e,r,i=0;const s=this.pathSide===on,o=this.path,l=this._textLines[t],u=l.length,h=new Array(u);this.__charBounds[t]=h;for(let d=0;d<u;d++){const p=l[d];r=this._getGraphemeBox(p,t,d,e),h[d]=r,i+=r.kernedWidth,e=p}if(h[u]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let d=0;const p=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case fe:d=s?p-i:0;break;case Gt:d=(p-i)/2;break;case on:d=s?0:p-i}d+=this.pathStartOffset*(s?-1:1);for(let g=s?u-1:0;s?g>=0:g<u;s?g--:g++)r=h[g],d>p?d%=p:d<0&&(d+=p),this._setGraphemeOnPath(d,r),d+=r.kernedWidth}return{width:i,numOfSpaces:0}}_setGraphemeOnPath(t,e){const r=t+e.kernedWidth/2,i=this.path,s=idt(i.path,r,i.segmentsInfo);e.renderLeft=s.x-i.pathOffset.x,e.renderTop=s.y-i.pathOffset.y,e.angle=s.angle+(this.pathSide===on?Math.PI:0)}_getGraphemeBox(t,e,r,i,s){const o=this.getCompleteStyleDeclaration(e,r),l=i?this.getCompleteStyleDeclaration(e,r-1):{},u=this._measureChar(t,o,i,l);let h,d=u.kernedWidth,p=u.width;this.charSpacing!==0&&(h=this._getWidthOfCharSpacing(),p+=h,d+=h);const g={width:p,left:0,height:o.fontSize,kernedWidth:d,deltaY:o.deltaY};if(r>0&&!s){const v=this.__charBounds[e][r-1];g.left=v.left+v.width+u.kernedWidth-u.width}return g}getHeightOfLineImpl(t){const e=this.__lineHeights;if(e[t])return e[t];let r=this.getHeightOfChar(t,0);for(let i=1,s=this._textLines[t].length;i<s;i++)r=Math.max(this.getHeightOfChar(t,i),r);return e[t]=r*this._fontSizeMult}getHeightOfLine(t){return this.getHeightOfLineImpl(t)*this.lineHeight}calcTextHeight(){let t=0;for(let e=0,r=this._textLines.length;e<r;e++)t+=e===r-1?this.getHeightOfLineImpl(e):this.getHeightOfLine(e);return t}_getLeftOffset(){return this.direction===Dc?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(t,e){t.save();let r=0;const i=this._getLeftOffset(),s=this._getTopOffset();for(let o=0,l=this._textLines.length;o<l;o++)this._renderTextLine(e,t,this._textLines[o],i+this._getLineLeftOffset(o),s+r+this.getHeightOfLineImpl(o),o),r+=this.getHeightOfLine(o);t.restore()}_renderTextFill(t){(this.fill||this.styleHas(Fn))&&this._renderTextCommon(t,"fillText")}_renderTextStroke(t){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())}_renderChars(t,e,r,i,s,o){const l=this.textAlign.includes(qs),u=this.path,h=!l&&this.charSpacing===0&&this.isEmptyStyles(o)&&!u,d=this.direction===Dc,p=this.direction===Dc?1:-1,g=e.direction;let v,T,S,w,E,D="",P=0;if(e.save(),g!==this.direction&&(e.canvas.setAttribute("dir",d?Dc:Ro),e.direction=d?Dc:Ro,e.textAlign=d?fe:on),s-=this.getHeightOfLineImpl(o)*this._fontSizeFraction,h)return this._renderChar(t,e,o,0,r.join(""),i,s),void e.restore();for(let V=0,N=r.length-1;V<=N;V++)w=V===N||this.charSpacing||u,D+=r[V],S=this.__charBounds[o][V],P===0?(i+=p*(S.kernedWidth-S.width),P+=S.width):P+=S.kernedWidth,l&&!w&&this._reSpaceAndTab.test(r[V])&&(w=!0),w||(v=v||this.getCompleteStyleDeclaration(o,V),T=this.getCompleteStyleDeclaration(o,V+1),w=YA(v,T,!1)),w&&(u?(e.save(),e.translate(S.renderLeft,S.renderTop),e.rotate(S.angle),this._renderChar(t,e,o,V,D,-P/2,0),e.restore()):(E=i,this._renderChar(t,e,o,V,D,E,s)),D="",v=T,i+=p*P,P=0);e.restore()}_applyPatternGradientTransformText(t){const e=this.width+this.strokeWidth,r=this.height+this.strokeWidth,i=Pi({width:e,height:r}),s=i.getContext("2d");return i.width=e,i.height=r,s.beginPath(),s.moveTo(0,0),s.lineTo(e,0),s.lineTo(e,r),s.lineTo(0,r),s.closePath(),s.translate(e/2,r/2),s.fillStyle=t.toLive(s),this._applyPatternGradientTransform(s,t),s.fill(),s.createPattern(i,"no-repeat")}handleFiller(t,e,r){let i,s;return Ai(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(i=-this.width/2,s=-this.height/2,t.translate(i,s),t[e]=this._applyPatternGradientTransformText(r),{offsetX:i,offsetY:s}):(t[e]=r.toLive(t),this._applyPatternGradientTransform(t,r)):(t[e]=r,{offsetX:0,offsetY:0})}_setStrokeStyles(t,e){let{stroke:r,strokeWidth:i}=e;return t.lineWidth=i,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",r)}_setFillStyles(t,e){let{fill:r}=e;return this.handleFiller(t,"fillStyle",r)}_renderChar(t,e,r,i,s,o,l){const u=this._getStyleDeclaration(r,i),h=this.getCompleteStyleDeclaration(r,i),d=t==="fillText"&&h.fill,p=t==="strokeText"&&h.stroke&&h.strokeWidth;if(p||d){if(e.save(),e.font=this._getFontDeclaration(h),u.textBackgroundColor&&this._removeShadow(e),u.deltaY&&(l+=u.deltaY),d){const g=this._setFillStyles(e,h);e.fillText(s,o-g.offsetX,l-g.offsetY)}if(p){const g=this._setStrokeStyles(e,h);e.strokeText(s,o-g.offsetX,l-g.offsetY)}e.restore()}}setSuperscript(t,e){this._setScript(t,e,this.superscript)}setSubscript(t,e){this._setScript(t,e,this.subscript)}_setScript(t,e,r){const i=this.get2DCursorLocation(t,!0),s=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),o=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),l={fontSize:s*r.size,deltaY:o+s*r.baseline};this.setSelectionStyles(l,t,e)}_getLineLeftOffset(t){const e=this.getLineWidth(t),r=this.width-e,i=this.textAlign,s=this.direction,o=this.isEndOfWrapping(t);let l=0;return i===qs||i===Ip&&!o||i===Rp&&!o||i===Eb&&!o?0:(i===Gt&&(l=r/2),i===on&&(l=r),i===Ip&&(l=r/2),i===Rp&&(l=r),s===Ro&&(i===on||i===Rp?l=0:i===fe||i===Eb?l=-r:i!==Gt&&i!==Ip||(l=-r/2)),l)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(t){if(this.__lineWidths[t]!==void 0)return this.__lineWidths[t];const{width:e}=this.measureLine(t);return this.__lineWidths[t]=e,e}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(t,e,r){var i;return(i=this._getStyleDeclaration(t,e)[r])!==null&&i!==void 0?i:this[r]}_renderTextDecoration(t,e){if(!this[e]&&!this.styleHas(e))return;let r=this._getTopOffset();const i=this._getLeftOffset(),s=this.path,o=this._getWidthOfCharSpacing(),l=e==="linethrough"?.5:e==="overline"?1:0,u=this.offsets[e];for(let h=0,d=this._textLines.length;h<d;h++){const p=this.getHeightOfLine(h);if(!this[e]&&!this.styleHas(e,h)){r+=p;continue}const g=this._textLines[h],v=p/this.lineHeight,T=this._getLineLeftOffset(h);let S=0,w=0,E=this.getValueOfPropertyAt(h,0,e),D=this.getValueOfPropertyAt(h,0,Fn),P=this.getValueOfPropertyAt(h,0,fu),V=E,N=D,q=P;const M=r+v*(1-this._fontSizeFraction);let k=this.getHeightOfChar(h,0),R=this.getValueOfPropertyAt(h,0,"deltaY");for(let H=0,j=g.length;H<j;H++){const yt=this.__charBounds[h][H];V=this.getValueOfPropertyAt(h,H,e),N=this.getValueOfPropertyAt(h,H,Fn),q=this.getValueOfPropertyAt(h,H,fu);const xt=this.getHeightOfChar(h,H),J=this.getValueOfPropertyAt(h,H,"deltaY");if(s&&V&&N){const st=this.fontSize*q/1e3;t.save(),t.fillStyle=D,t.translate(yt.renderLeft,yt.renderTop),t.rotate(yt.angle),t.fillRect(-yt.kernedWidth/2,u*xt+J-l*st,yt.kernedWidth,st),t.restore()}else if((V!==E||N!==D||xt!==k||q!==P||J!==R)&&w>0){const st=this.fontSize*P/1e3;let ht=i+T+S;this.direction===Ro&&(ht=this.width-ht-w),E&&D&&P&&(t.fillStyle=D,t.fillRect(ht,M+u*k+R-l*st,w,st)),S=yt.left,w=yt.width,E=V,P=q,D=N,k=xt,R=J}else w+=yt.kernedWidth}let F=i+T+S;this.direction===Ro&&(F=this.width-F-w),t.fillStyle=N;const U=this.fontSize*q/1e3;V&&N&&q&&t.fillRect(F,M+u*k+R-l*U,w-o,U),r+=p}this._removeShadow(t)}_getFontDeclaration(){let{fontFamily:t=this.fontFamily,fontStyle:e=this.fontStyle,fontWeight:r=this.fontWeight,fontSize:i=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;const o=t.includes("'")||t.includes('"')||t.includes(",")||pr.genericFonts.includes(t.toLowerCase())?t:`"${t}"`;return[e,r,`${s?this.CACHE_FONT_SIZE:i}px`,o].join(" ")}render(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(t)))}graphemeSplit(t){return UA(t)}_splitTextIntoLines(t){const e=t.split(this._reNewline),r=new Array(e.length),i=[`
`];let s=[];for(let o=0;o<e.length;o++)r[o]=this.graphemeSplit(e[o]),s=s.concat(r[o],i);return s.pop(),{_unwrappedLines:r,lines:e,graphemeText:s,graphemeLines:r}}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return{...super.toObject([...$U,...t]),styles:Cft(this.styles,this.text),...this.path?{path:this.path.toObject()}:{}}}set(t,e){const{textLayoutProperties:r}=this.constructor;super.set(t,e);let i=!1,s=!1;if(typeof t=="object")for(const o in t)o==="path"&&this.setPathInfo(),i=i||r.includes(o),s=s||o==="path";else i=r.includes(t),s=t==="path";return s&&this.setPathInfo(),i&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(t,e,r){const i=sa(t,pr.ATTRIBUTE_NAMES,r),{textAnchor:s=fe,textDecoration:o="",dx:l=0,dy:u=0,top:h=0,left:d=0,fontSize:p=PA,strokeWidth:g=1,...v}={...e,...i},T=new this(xb(t.textContent||"").trim(),{left:d+l,top:h+u,underline:o.includes("underline"),overline:o.includes("overline"),linethrough:o.includes("line-through"),strokeWidth:0,fontSize:p,...v}),S=T.getScaledHeight()/T.height,w=((T.height+T.strokeWidth)*T.lineHeight-T.height)*S,E=T.getScaledHeight()+w;let D=0;return s===Gt&&(D=T.getScaledWidth()/2),s===on&&(D=T.getScaledWidth()),T.set({left:T.left-D,top:T.top-(E-T.fontSize*(.07+T._fontSizeFraction))/T.lineHeight,strokeWidth:g}),T}static fromObject(t){return this._fromObject({...t,styles:Aft(t.styles||{},t.text)},{extraParam:"text"})}}W(pr,"textLayoutProperties",HU),W(pr,"cacheProperties",[...ia,...$U]),W(pr,"ownDefaults",Kht),W(pr,"type","Text"),W(pr,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),W(pr,"ATTRIBUTE_NAMES",Hl.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),QU(pr,[class extends BU{_toSVG(){const n=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(t)}toSVG(n){const t=this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0}),e=this.path;return e?t+e._createBaseSVGMarkup(e._toSVG(),{reviver:n,withShadow:!0,additionalTransform:hm(this.calcOwnMatrix())}):t}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(n){let{textBgRects:t,textSpans:e}=n;const r=this.getSvgTextDecoration(this);return[t.join(""),'		<text xml:space="preserve" ',`font-family="${ne(this.fontFamily.replace(Sdt,"'"))}" `,`font-size="${ne(this.fontSize)}" `,this.fontStyle?`font-style="${ne(this.fontStyle)}" `:"",this.fontWeight?`font-weight="${ne(this.fontWeight)}" `:"",r?`text-decoration="${r}" `:"",this.direction==="rtl"?'direction="rtl" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.join(""),`</text>
`]}_getSVGTextAndBg(n,t){const e=[],r=[];let i,s=n;this.backgroundColor&&r.push(ix(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,l=this._textLines.length;o<l;o++)i=this._getLineLeftOffset(o),this.direction==="rtl"&&(i+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(r,o,t+i,s),this._setSVGTextLineText(e,o,t+i,s),s+=this.getHeightOfLine(o);return{textSpans:e,textBgRects:r}}_createTextCharSpan(n,t,e,r,i){const s=ve.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(t,n!==n.trim()||!!n.match(Tdt)),l=o?`style="${o}"`:"",u=t.deltaY,h=u?` dy="${Me(u,s)}" `:"",{angle:d,renderLeft:p,renderTop:g,width:v}=i;let T="";if(p!==void 0){const S=v/2;d&&(T=` rotate="${Me(Dl(d),s)}"`);const w=xf({angle:Dl(d)});w[4]=p,w[5]=g;const E=new tt(-S,0).transform(w);e=E.x,r=E.y}return`<tspan x="${Me(e,s)}" y="${Me(r,s)}" ${h}${T}${l}>${ne(n)}</tspan>`}_setSVGTextLineText(n,t,e,r){const i=this.getHeightOfLine(t),s=this.textAlign.includes(qs),o=this._textLines[t];let l,u,h,d,p,g="",v=0;r+=i*(1-this._fontSizeFraction)/this.lineHeight;for(let T=0,S=o.length-1;T<=S;T++)p=T===S||this.charSpacing||this.path,g+=o[T],h=this.__charBounds[t][T],v===0?(e+=h.kernedWidth-h.width,v+=h.width):v+=h.kernedWidth,s&&!p&&this._reSpaceAndTab.test(o[T])&&(p=!0),p||(l=l||this.getCompleteStyleDeclaration(t,T),u=this.getCompleteStyleDeclaration(t,T+1),p=YA(l,u,!0)),p&&(d=this._getStyleDeclaration(t,T),n.push(this._createTextCharSpan(g,d,e,r,h)),g="",l=u,this.direction==="rtl"?e-=v:e+=v,v=0)}_setSVGTextLineBg(n,t,e,r){const i=this._textLines[t],s=this.getHeightOfLine(t)/this.lineHeight;let o,l=0,u=0,h=this.getValueOfPropertyAt(t,0,"textBackgroundColor");for(let d=0;d<i.length;d++){const{left:p,width:g,kernedWidth:v}=this.__charBounds[t][d];o=this.getValueOfPropertyAt(t,d,"textBackgroundColor"),o!==h?(h&&n.push(ix(h,e+u,r,l,s)),u=p,l=g,h=o):l+=v}o&&n.push(ix(h,e+u,r,l,s))}getSvgStyles(n){return`${super.getSvgStyles(n)} text-decoration-thickness: ${Me(this.textDecorationThickness*this.getObjectScaling().y/10,ve.NUM_FRACTION_DIGITS)}%; white-space: pre;`}getSvgSpanStyles(n,t){const{fontFamily:e,strokeWidth:r,stroke:i,fill:s,fontSize:o,fontStyle:l,fontWeight:u,textDecorationThickness:h,linethrough:d,overline:p,underline:g}=n,v=this.getSvgTextDecoration({underline:g??this.underline,overline:p??this.overline,linethrough:d??this.linethrough}),T=h||this.textDecorationThickness;return[i?fm(si,i):"",r?`stroke-width: ${ne(r)}; `:"",e?`font-family: ${e.includes("'")||e.includes('"')?ne(e):`'${ne(e)}'`}; `:"",o?`font-size: ${ne(o)}px; `:"",l?`font-style: ${ne(l)}; `:"",u?`font-weight: ${ne(u)}; `:"",v?`text-decoration: ${v}; text-decoration-thickness: ${Me(T*this.getObjectScaling().y/10,ve.NUM_FRACTION_DIGITS)}%; `:"",s?fm(Fn,s):"",t?"white-space: pre; ":""].join("")}getSvgTextDecoration(n){return["overline","underline","line-through"].filter(t=>n[t.replace("-","")]).join(" ")}}]),_t.setClass(pr),_t.setSVGClass(pr);class wdt{constructor(t){W(this,"target",void 0),W(this,"__mouseDownInPlace",!1),W(this,"__dragStartFired",!1),W(this,"__isDraggingOver",!1),W(this,"__dragStartSelection",void 0),W(this,"__dragImageDisposer",void 0),W(this,"_dispose",void 0),this.target=t;const e=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{e.forEach(r=>r()),this._dispose=void 0}}isPointerOverSelection(t){const e=this.target,r=e.getSelectionStartFromPointer(t);return e.isEditing&&r>=e.selectionStart&&r<=e.selectionEnd&&e.selectionStart<e.selectionEnd}start(t){return this.__mouseDownInPlace=this.isPointerOverSelection(t)}isActive(){return this.__mouseDownInPlace}end(t){const e=this.isActive();return e&&!this.__dragStartFired&&(this.target.setCursorByClick(t),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,e}getDragStartSelection(){return this.__dragStartSelection}setDragImage(t,e){var r;let{selectionStart:i,selectionEnd:s}=e;const o=this.target,l=o.canvas,u=new tt(o.flipX?-1:1,o.flipY?-1:1),h=o._getCursorBoundaries(i),d=new tt(h.left+h.leftOffset,h.top+h.topOffset).multiply(u).transform(o.calcTransformMatrix()),p=l.getScenePoint(t).subtract(d),g=o.getCanvasRetinaScaling(),v=o.getBoundingRect(),T=d.subtract(new tt(v.left,v.top)),S=l.viewportTransform,w=T.add(p).transform(S,!0),E=o.backgroundColor,D=GA(o.styles);o.backgroundColor="";const P={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(P,0,i),o.setSelectionStyles(P,s,o.text.length),o.dirty=!0;const V=o.toCanvasElement({enableRetinaScaling:l.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=E,o.styles=D,o.dirty=!0,ZE(V,{position:"fixed",left:-V.width+"px",border:Br,width:V.width/g+"px",height:V.height/g+"px"}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{V.remove()},ts(t.target||this.target.hiddenTextarea).body.appendChild(V),(r=t.dataTransfer)===null||r===void 0||r.setDragImage(V,w.x,w.y)}onDragStart(t){this.__dragStartFired=!0;const e=this.target,r=this.isActive();if(r&&t.dataTransfer){const i=this.__dragStartSelection={selectionStart:e.selectionStart,selectionEnd:e.selectionEnd},s=e._text.slice(i.selectionStart,i.selectionEnd).join(""),o={text:e.text,value:s,...i};t.dataTransfer.setData("text/plain",s),t.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:e.getSelectionStyles(i.selectionStart,i.selectionEnd,!0)})),t.dataTransfer.effectAllowed="copyMove",this.setDragImage(t,o)}return e.abortCursorAnimation(),r}canDrop(t){if(this.target.editable&&!this.target.getActiveControl()&&!t.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const e=this.target.getSelectionStartFromPointer(t),r=this.__dragStartSelection;return e<r.selectionStart||e>r.selectionEnd}return!0}return!1}targetCanDrop(t){return this.target.canDrop(t)}dragEnterHandler(t){let{e}=t;const r=this.targetCanDrop(e);!this.__isDraggingOver&&r&&(this.__isDraggingOver=!0)}dragOverHandler(t){const{e}=t,r=this.targetCanDrop(e);!this.__isDraggingOver&&r?this.__isDraggingOver=!0:this.__isDraggingOver&&!r&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(e.preventDefault(),t.canDrop=!0,t.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(t){var e;const{e:r}=t,i=r.defaultPrevented;this.__isDraggingOver=!1,r.preventDefault();let s=(e=r.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain");if(s&&!i){const o=this.target,l=o.canvas;let u=o.getSelectionStartFromPointer(r);const{styles:h}=r.dataTransfer.types.includes("application/fabric")?JSON.parse(r.dataTransfer.getData("application/fabric")):{},d=s[Math.max(0,s.length-1)],p=0;if(this.__dragStartSelection){const g=this.__dragStartSelection.selectionStart,v=this.__dragStartSelection.selectionEnd;u>g&&u<=v?u=g:u>v&&(u-=v-g),o.removeChars(g,v),delete this.__dragStartSelection}o._reNewline.test(d)&&(o._reNewline.test(o._text[u])||u===o._text.length)&&(s=s.trimEnd()),t.didDrop=!0,t.dropTarget=o,o.insertChars(s,h,u),l.setActiveObject(o),o.enterEditing(r),o.selectionStart=Math.min(u+p,o._text.length),o.selectionEnd=Math.min(o.selectionStart+s.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(yb,{index:u+p,action:"drop"}),l.fire("text:changed",{target:o}),l.contextTopDirty=!0,l.requestRenderAll()}}dragEndHandler(t){let{e}=t;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var r;const i=this.target,s=this.target.canvas,{selectionStart:o,selectionEnd:l}=this.__dragStartSelection,u=((r=e.dataTransfer)===null||r===void 0?void 0:r.dropEffect)||Br;u===Br?(i.selectionStart=o,i.selectionEnd=l,i._updateTextarea(),i.hiddenTextarea.focus()):(i.clearContextTop(),u==="move"&&(i.removeChars(o,l),i.selectionStart=i.selectionEnd=o,i.hiddenTextarea&&(i.hiddenTextarea.value=i.text),i._updateTextarea(),i.fire(yb,{index:o,action:"dragend"}),s.fire("text:changed",{target:i}),s.requestRenderAll()),i.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const GN=/[ \n\.,;!\?\-]/;class xdt extends pr{constructor(){super(...arguments),W(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(t){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(t)}_animateCursor(t){let{toValue:e,duration:r,delay:i,onComplete:s}=t;return qU({startValue:this._currentCursorOpacity,endValue:e,duration:r,delay:i,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(t){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(t||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var t;(t=this._currentTickCompleteState)===null||t===void 0||t.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(t){this.abortCursorAnimation(),this._tick(t?0:this.cursorDelay)}abortCursorAnimation(){let t=!1;[this._currentTickState,this._currentTickCompleteState].forEach(e=>{e&&!e.isDone()&&(t=!0,e.abort())}),this._currentCursorOpacity=1,t&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(t=>!t||t.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(t){let e=0,r=t-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)e++,r--;for(;/\S/.test(this._text[r])&&r>-1;)e++,r--;return t-e}findWordBoundaryRight(t){let e=0,r=t;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)e++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)e++,r++;return t+e}findLineBoundaryLeft(t){let e=0,r=t-1;for(;!/\n/.test(this._text[r])&&r>-1;)e++,r--;return t-e}findLineBoundaryRight(t){let e=0,r=t;for(;!/\n/.test(this._text[r])&&r<this._text.length;)e++,r++;return t+e}searchWordBoundary(t,e){const r=this._text;let i=t>0&&this._reSpace.test(r[t])&&(e===-1||!NA.test(r[t-1]))?t-1:t,s=r[i];for(;i>0&&i<r.length&&!GN.test(s);)i+=e,s=r[i];return e===-1&&GN.test(s)&&i++,i}selectWord(t){t=t??this.selectionStart;const e=this.searchWordBoundary(t,-1),r=Math.max(e,this.searchWordBoundary(t,1));this.selectionStart=e,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(t){t=t??this.selectionStart;const e=this.findLineBoundaryLeft(t),r=this.findLineBoundaryRight(t);this.selectionStart=e,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(t){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",t?{e:t}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e:t}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(t){if(this.getActiveControl())return;const e=this.hiddenTextarea;ts(e).activeElement!==e&&e.focus();const r=this.getSelectionStartFromPointer(t),i=this.selectionStart,s=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&i!==s||i!==r&&s!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(t,e,r){const i=r.slice(0,t),s=this.graphemeSplit(i).length;if(t===e)return{selectionStart:s,selectionEnd:s};const o=r.slice(t,e);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(t,e,r){const i=r.slice(0,t).join("").length;return t===e?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+r.slice(t,e).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){const{hiddenTextarea:t,direction:e,textAlign:r,inCompositionMode:i}=this;if(!t)return;const s=r!==qs?r.replace("justify-",""):e===Dc?fe:on,o=this.getPositionByOrigin(s,"top");this.cursorOffsetCache={},this.text=t.value,this.set("dirty",!0),this.initDimensions(),this.setPositionByOrigin(o,s,"top"),this.setCoords();const l=this.fromStringToGraphemeSelection(t.selectionStart,t.selectionEnd,t.value);this.selectionEnd=this.selectionStart=l.selectionEnd,i||(this.selectionStart=l.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),r=this.get2DCursorLocation(t),i=r.lineIndex,s=r.charIndex,o=this.getValueOfPropertyAt(i,s,"fontSize")*this.lineHeight,l=e.leftOffset,u=this.getCanvasRetinaScaling(),h=this.canvas.upperCanvasEl,d=h.width/u,p=h.height/u,g=d-o,v=p-o,T=new tt(e.left+l,e.top+e.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new tt(h.clientWidth/d,h.clientHeight/p));return T.x<0&&(T.x=0),T.x>g&&(T.x=g),T.y<0&&(T.y=0),T.y>v&&(T.y=v),T.x+=this.canvas._offset.left,T.y+=this.canvas._offset.top,{left:`${T.x}px`,top:`${T.y}px`,fontSize:`${o}px`,charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}exitEditingImpl(){const t=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,t&&(t.blur&&t.blur(),t.parentNode&&t.parentNode.removeChild(t)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const t=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),t&&this.fire(vb),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const t in this.styles)this._textLines[t]||delete this.styles[t]}removeStyleFromTo(t,e){const{lineIndex:r,charIndex:i}=this.get2DCursorLocation(t,!0),{lineIndex:s,charIndex:o}=this.get2DCursorLocation(e,!0);if(r!==s){if(this.styles[r])for(let l=i;l<this._unwrappedTextLines[r].length;l++)delete this.styles[r][l];if(this.styles[s])for(let l=o;l<this._unwrappedTextLines[s].length;l++){const u=this.styles[s][l];u&&(this.styles[r]||(this.styles[r]={}),this.styles[r][i+l-o]=u)}for(let l=r+1;l<=s;l++)delete this.styles[l];this.shiftLineStyles(s,r-s)}else if(this.styles[r]){const l=this.styles[r],u=o-i;for(let h=i;h<o;h++)delete l[h];for(const h in this.styles[r]){const d=parseInt(h,10);d>=o&&(l[d-u]=l[h],delete l[h])}}}shiftLineStyles(t,e){const r=Object.assign({},this.styles);for(const i in this.styles){const s=parseInt(i,10);s>t&&(this.styles[s+e]=r[s],r[s-e]||delete this.styles[s])}}insertNewlineStyleObject(t,e,r,i){const s={},o=this._unwrappedTextLines[t].length,l=o===e;let u=!1;r||(r=1),this.shiftLineStyles(t,r);const h=this.styles[t]?this.styles[t][e===0?e:e-1]:void 0;for(const p in this.styles[t]){const g=parseInt(p,10);g>=e&&(u=!0,s[g-e]=this.styles[t][p],l&&e===0||delete this.styles[t][p])}let d=!1;for(u&&!l&&(this.styles[t+r]=s,d=!0),(d||o>e)&&r--;r>0;)i&&i[r-1]?this.styles[t+r]={0:{...i[r-1]}}:h?this.styles[t+r]={0:{...h}}:delete this.styles[t+r],r--;this._forceClearCache=!0}insertCharStyleObject(t,e,r,i){this.styles||(this.styles={});const s=this.styles[t],o=s?{...s}:{};r||(r=1);for(const u in o){const h=parseInt(u,10);h>=e&&(s[h+r]=o[h],o[h-r]||delete s[h])}if(this._forceClearCache=!0,i){for(;r--;)Object.keys(i[r]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+r]={...i[r]});return}if(!s)return;const l=s[e?e-1:1];for(;l&&r--;)this.styles[t][e+r]={...l}}insertNewStyleBlock(t,e,r){const i=this.get2DCursorLocation(e,!0),s=[0];let o,l=0;for(let u=0;u<t.length;u++)t[u]===`
`?(l++,s[l]=0):s[l]++;for(s[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,s[0],r),r=r&&r.slice(s[0]+1)),l&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+s[0],l),o=1;o<l;o++)s[o]>0?this.insertCharStyleObject(i.lineIndex+o,0,s[o],r):r&&this.styles[i.lineIndex+o]&&r[0]&&(this.styles[i.lineIndex+o][0]=r[0]),r=r&&r.slice(s[o]+1);s[o]>0&&this.insertCharStyleObject(i.lineIndex+o,0,s[o],r)}removeChars(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t+1;this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(t,e,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;i>r&&this.removeStyleFromTo(r,i);const s=this.graphemeSplit(t);this.insertNewStyleBlock(s,r,e),this._text=[...this._text.slice(0,r),...s,...this._text.slice(i)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(t,e,r){r<=t?(e===t?this._selectionDirection=fe:this._selectionDirection===on&&(this._selectionDirection=fe,this.selectionEnd=t),this.selectionStart=r):r>t&&r<e?this._selectionDirection===on?this.selectionEnd=r:this.selectionStart=r:(e===t?this._selectionDirection=on:this._selectionDirection===fe&&(this._selectionDirection=on,this.selectionStart=e),this.selectionEnd=r)}}class Edt extends xdt{initHiddenTextarea(){const t=this.canvas&&ts(this.canvas.getElement())||Tf(),e=t.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map(o=>{let[l,u]=o;return e.setAttribute(l,u)});const{top:r,left:i,fontSize:s}=this._calcTextareaPosition();e.style.cssText=`position: absolute; top: ${r}; left: ${i}; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ${s};`,(this.hiddenTextareaContainer||t.body).appendChild(e),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[l,u]=o;return e.addEventListener(l,this[u].bind(this))}),this.hiddenTextarea=e}blur(){this.abortCursorAnimation()}onKeyDown(t){if(!this.isEditing)return;const e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(t){const e=this.fromPaste,{value:r,selectionStart:i,selectionEnd:s}=this.hiddenTextarea;if(this.fromPaste=!1,t&&t.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(yb),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const l=this._splitTextIntoLines(r).graphemeText,u=this._text.length,h=l.length,d=this.selectionStart,p=this.selectionEnd,g=d!==p;let v,T,S,w,E=h-u;const D=this.fromStringToGraphemeSelection(i,s,r),P=d>D.selectionStart;g?(T=this._text.slice(d,p),E+=p-d):h<u&&(T=P?this._text.slice(p+E,p):this._text.slice(d,d-E));const V=l.slice(D.selectionEnd-E,D.selectionEnd);if(T&&T.length&&(V.length&&(v=this.getSelectionStyles(d,d+1,!1),v=V.map(()=>v[0])),g?(S=d,w=p):P?(S=p-T.length,w=p):(S=p,w=p+T.length),this.removeStyleFromTo(S,w)),V.length){const{copyPasteData:N}=io();e&&V.join("")===N.copiedText&&!ve.disableStyleCopyPaste&&(v=N.copiedTextStyle),this.insertNewStyleBlock(V,d,v)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(t){let{target:e}=t;const{selectionStart:r,selectionEnd:i}=e;this.compositionStart=r,this.compositionEnd=i,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:t}=io();t.copiedText=this.getSelectedText(),ve.disableStyleCopyPaste?t.copiedTextStyle=void 0:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(t,e){let r,i=this._getLineLeftOffset(t);return e>0&&(r=this.__charBounds[t][e-1],i+=r.left+r.width),i}getDownCursorOffset(t,e){const r=this._getSelectionForOffset(t,e),i=this.get2DCursorLocation(r),s=i.lineIndex;if(s===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-r;const o=i.charIndex,l=this._getWidthBeforeCursor(s,o),u=this._getIndexOnLine(s+1,l);return this._textLines[s].slice(o).length+u+1+this.missingNewlineOffset(s)}_getSelectionForOffset(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart}getUpCursorOffset(t,e){const r=this._getSelectionForOffset(t,e),i=this.get2DCursorLocation(r),s=i.lineIndex;if(s===0||t.metaKey||t.keyCode===33)return-r;const o=i.charIndex,l=this._getWidthBeforeCursor(s,o),u=this._getIndexOnLine(s-1,l),h=this._textLines[s].slice(0,o),d=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+u-h.length+(1-d)}_getIndexOnLine(t,e){const r=this._textLines[t];let i,s,o=this._getLineLeftOffset(t),l=0;for(let u=0,h=r.length;u<h;u++)if(i=this.__charBounds[t][u].width,o+=i,o>e){s=!0;const d=o-i,p=o,g=Math.abs(d-e);l=Math.abs(p-e)<g?u:u-1;break}return s||(l=r.length-1),l}moveCursorDown(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)}moveCursorUp(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)}_moveCursorUpOrDown(t,e){const r=this[`get${t}CursorOffset`](e,this._selectionDirection===on);if(e.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),r!==0){const i=this.text.length;this.selectionStart=of(0,this.selectionStart,i),this.selectionEnd=of(0,this.selectionEnd,i),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(t){const e=this._selectionDirection===fe?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0}moveCursorWithoutShift(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0}moveCursorLeft(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)}_move(t,e,r){let i;if(t.altKey)i=this[`findWordBoundary${r}`](this[e]);else{if(!t.metaKey&&t.keyCode!==35&&t.keyCode!==36)return this[e]+=r==="Left"?-1:1,!0;i=this[`findLineBoundary${r}`](this[e])}return i!==void 0&&this[e]!==i&&(this[e]=i,!0)}_moveLeft(t,e){return this._move(t,e,"Left")}_moveRight(t,e){return this._move(t,e,"Right")}moveCursorLeftWithoutShift(t){let e=!0;return this._selectionDirection=fe,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e}moveCursorLeftWithShift(t){return this._selectionDirection===on&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=fe,this._moveLeft(t,"selectionStart")):void 0}moveCursorRight(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)}_moveCursorLeftOrRight(t,e){const r=`moveCursor${t}${e.shiftKey?"WithShift":"WithoutShift"}`;this._currentCursorOpacity=1,this[r](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(t){return this._selectionDirection===fe&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=on,this._moveRight(t,"selectionEnd")):void 0}moveCursorRightWithoutShift(t){let e=!0;return this._selectionDirection=on,this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e}}const YN=n=>!!n.button;class Cdt extends Edt{constructor(){super(...arguments),W(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new wdt(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(t){return this.draggableTextDelegate.onDragStart(t)}canDrop(t){return this.draggableTextDelegate.canDrop(t)}doubleClickHandler(t){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}tripleClickHandler(t){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(t.e)),this.renderCursorOrSelection())}_mouseDownHandler(t){let{e,alreadySelected:r}=t;this.canvas&&this.editable&&!YN(e)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(e)||(this.canvas.textEditingManager.register(this),r&&(this.inCompositionMode=!1,this.setCursorByClick(e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=r||this.isEditing)))}mouseUpHandler(t){let{e,transform:r}=t;const i=this.draggableTextDelegate.end(e);if(this.canvas){this.canvas.textEditingManager.unregister(this);const s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||r&&r.actionPerformed||YN(e)||i||this.selected&&!this.getActiveControl()&&(this.enterEditing(e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(t){const e=this.getSelectionStartFromPointer(t),r=this.selectionStart,i=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(r,i,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(t){const e=this.canvas.getScenePoint(t).transform(rs(this.calcTransformMatrix())).add(new tt(-this._getLeftOffset(),-this._getTopOffset()));let r=0,i=0,s=0;for(let h=0;h<this._textLines.length&&r<=e.y;h++)r+=this.getHeightOfLine(h),s=h,h>0&&(i+=this._textLines[h-1].length+this.missingNewlineOffset(h-1));let o=Math.abs(this._getLineLeftOffset(s));const l=this._textLines[s].length,u=this.__charBounds[s];for(let h=0;h<l;h++){const d=o+u[h].kernedWidth;if(e.x<=d){Math.abs(e.x-d)<=Math.abs(e.x-o)&&i++;break}o=d,i++}return Math.min(this.flipX?l-i:i,this._text.length)}}const Qy="moveCursorUp",Jy="moveCursorDown",Zy="moveCursorLeft",t0="moveCursorRight",e0="exitEditing",KN=(n,t)=>{const e=t.getRetinaScaling();n.setTransform(e,0,0,e,0,0);const r=t.viewportTransform;n.transform(r[0],r[1],r[2],r[3],r[4],r[5])},Adt={selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:e0,27:e0,33:Qy,34:Jy,35:t0,36:Zy,37:Zy,38:Qy,39:t0,40:Jy},keysMapRtl:{9:e0,27:e0,33:Qy,34:Jy,35:Zy,36:t0,37:t0,38:Qy,39:Zy,40:Jy},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"},_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1};class Bo extends Cdt{static getDefaults(){return{...super.getDefaults(),...Bo.ownDefaults}}get type(){const t=super.type;return t==="itext"?"i-text":t}constructor(t,e){super(t,{...Bo.ownDefaults,...e}),this.initBehavior()}_set(t,e){return this.isEditing&&this._savedProps&&t in this._savedProps?(this._savedProps[t]=e,this):(t==="canvas"&&(this.canvas instanceof t1&&this.canvas.textEditingManager.remove(this),e instanceof t1&&e.textEditingManager.add(this)),super._set(t,e))}setSelectionStart(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)}setSelectionEnd(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)}_updateAndFire(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,r=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(t,e,r)}setSelectionStyles(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(t,e,r)}get2DCursorLocation(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(t,e)}render(t){super.render(t),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(t){const e=this.isEditing;this.isEditing=!1;const r=super.toCanvasElement(t);return this.isEditing=e,r}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const t=this.clearContextTop(!0);if(!t)return;const e=this._getCursorBoundaries(),r=this.findAncestorsWithClipPath(),i=r.length>0;let s,o=t;if(i){s=Pi(t.canvas),o=s.getContext("2d"),KN(o,this.canvas);const l=this.calcTransformMatrix();o.transform(l[0],l[1],l[2],l[3],l[4],l[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,e):this.renderCursor(o,e),i)for(const l of r){const u=l.clipPath,h=Pi(t.canvas),d=h.getContext("2d");if(KN(d,this.canvas),!u.absolutePositioned){const p=l.calcTransformMatrix();d.transform(p[0],p[1],p[2],p[3],p[4],p[5])}u.transform(d),u.drawObject(d,!0,{}),this.drawClipPathOnCache(o,u,h)}i&&(t.setTransform(1,0,0,1,0,0),t.drawImage(s,0,0)),this.canvas.contextTopDirty=!0,t.restore()}findAncestorsWithClipPath(){const t=[];let e=this;for(;e;)e.clipPath&&t.push(e),e=e.parent;return t}_getCursorBoundaries(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1?arguments[1]:void 0;const r=this._getLeftOffset(),i=this._getTopOffset(),s=this._getCursorBoundariesOffsets(t,e);return{left:r,top:i,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(t,e){return e?this.__getCursorBoundariesOffsets(t):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(t)}__getCursorBoundariesOffsets(t){let e=0,r=0;const{charIndex:i,lineIndex:s}=this.get2DCursorLocation(t),{textAlign:o,direction:l}=this;for(let p=0;p<s;p++)e+=this.getHeightOfLine(p);const u=this._getLineLeftOffset(s),h=this.__charBounds[s][i];h&&(r=h.left),this.charSpacing!==0&&i===this._textLines[s].length&&(r-=this._getWidthOfCharSpacing());let d=u+(r>0?r:0);return l===Ro&&(o===on||o===qs||o===Rp?d*=-1:o===fe||o===Eb?d=u-(r>0?r:0):o!==Gt&&o!==Ip||(d=u-(r>0?r:0))),{top:e,left:d}}renderCursorAt(t){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(t,!0),t)}renderCursor(t,e){this._renderCursor(t,e,this.selectionStart)}getCursorRenderingData(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(t);const r=this.get2DCursorLocation(t),i=r.lineIndex,s=r.charIndex>0?r.charIndex-1:0,o=this.getValueOfPropertyAt(i,s,"fontSize"),l=this.getObjectScaling().x*this.canvas.getZoom(),u=this.cursorWidth/l,h=this.getValueOfPropertyAt(i,s,"deltaY"),d=e.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(i,s,"fill"),opacity:this._currentCursorOpacity,left:e.left+e.leftOffset-u/2,top:d+e.top+h,width:u,height:o}}_renderCursor(t,e,r){const{color:i,opacity:s,left:o,top:l,width:u,height:h}=this.getCursorRenderingData(r,e);t.fillStyle=i,t.globalAlpha=s,t.fillRect(o,l,u,h)}renderSelection(t,e){const r={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(t,r,e)}renderDragSourceEffect(){const t=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,t,this._getCursorBoundaries(t.selectionStart,!0))}renderDropTargetEffect(t){const e=this.getSelectionStartFromPointer(t);this.renderCursorAt(e)}_renderSelection(t,e,r){const{textAlign:i,direction:s}=this,o=e.selectionStart,l=e.selectionEnd,u=i.includes(qs),h=this.get2DCursorLocation(o),d=this.get2DCursorLocation(l),p=h.lineIndex,g=d.lineIndex,v=h.charIndex<0?0:h.charIndex,T=d.charIndex<0?0:d.charIndex;for(let S=p;S<=g;S++){const w=this._getLineLeftOffset(S)||0;let E=this.getHeightOfLine(S),D=0,P=0,V=0;if(S===p&&(P=this.__charBounds[p][v].left),S>=p&&S<g)V=u&&!this.isEndOfWrapping(S)?this.width:this.getLineWidth(S)||5;else if(S===g)if(T===0)V=this.__charBounds[g][T].left;else{const R=this._getWidthOfCharSpacing();V=this.__charBounds[g][T-1].left+this.__charBounds[g][T-1].width-R}D=E,(this.lineHeight<1||S===g&&this.lineHeight>1)&&(E/=this.lineHeight);let N=r.left+w+P,q=E,M=0;const k=V-P;this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",q=1,M=E):t.fillStyle=this.selectionColor,s===Ro&&(i===on||i===qs||i===Rp?N=this.width-N-k:i===fe||i===Eb?N=r.left+w-V:i!==Gt&&i!==Ip||(N=r.left+w-V)),t.fillRect(N,r.top+r.topOffset+M,k,q),r.topOffset+=D}}getCurrentCharFontSize(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")}getCurrentCharColor(){const t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,Fn)}_getCurrentCharIndex(){const t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}W(Bo,"ownDefaults",Adt),W(Bo,"type","IText"),_t.setClass(Bo),_t.setClass(Bo,"i-text");class zc extends Bo{static getDefaults(){return{...super.getDefaults(),...zc.ownDefaults}}constructor(t,e){super(t,{...zc.ownDefaults,...e})}static createControls(){return{controls:Sft()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(qs)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(t){let e=0,r=0,i=0;const s={};for(let o=0;o<t.graphemeLines.length;o++)t.graphemeText[i]===`
`&&o>0?(r=0,i++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[i])&&o>0&&(r++,i++),s[o]={line:e,offset:r},i+=t.graphemeLines[o].length,r+=t.graphemeLines[o].length;return s}styleHas(t,e){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[e];r&&(e=r.line)}return super.styleHas(t,e)}isEmptyStyles(t){if(!this.styles)return!0;let e,r=0,i=t+1,s=!1;const o=this._styleMap[t],l=this._styleMap[t+1];o&&(t=o.line,r=o.offset),l&&(i=l.line,s=i===t,e=l.offset);const u=t===void 0?this.styles:{line:this.styles[t]};for(const h in u)for(const d in u[h]){const p=parseInt(d,10);if(p>=r&&(!s||p<e))for(const g in u[h][d])return!1}return!0}_getStyleDeclaration(t,e){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[t];if(!r)return{};t=r.line,e=r.offset+e}return super._getStyleDeclaration(t,e)}_setStyleDeclaration(t,e,r){const i=this._styleMap[t];super._setStyleDeclaration(i.line,i.offset+e,r)}_deleteStyleDeclaration(t,e){const r=this._styleMap[t];super._deleteStyleDeclaration(r.line,r.offset+e)}_getLineStyle(t){const e=this._styleMap[t];return!!this.styles[e.line]}_setLineStyle(t){const e=this._styleMap[t];super._setLineStyle(e.line)}_wrapText(t,e){this.isWrapping=!0;const r=this.getGraphemeDataForRender(t),i=[];for(let s=0;s<r.wordsData.length;s++)i.push(...this._wrapLine(s,e,r));return this.isWrapping=!1,i}getGraphemeDataForRender(t){const e=this.splitByGrapheme,r=e?"":" ";let i=0;return{wordsData:t.map((s,o)=>{let l=0;const u=e?this.graphemeSplit(s):this.wordSplit(s);return u.length===0?[{word:[],width:0}]:u.map(h=>{const d=e?[h]:this.graphemeSplit(h),p=this._measureWord(d,o,l);return i=Math.max(p,i),l+=d.length+r.length,{word:d,width:p}})}),largestWordWidth:i}}_measureWord(t,e){let r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let o=0,l=t.length;o<l;o++)s+=this._getGraphemeBox(t[o],e,o+i,r,!0).kernedWidth,r=t[o];return s}wordSplit(t){return t.split(this._wordJoiners)}_wrapLine(t,e,r){let{largestWordWidth:i,wordsData:s}=r,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const l=this._getWidthOfCharSpacing(),u=this.splitByGrapheme,h=[],d=u?"":" ";let p=0,g=[],v=0,T=0,S=!0;e-=o;const w=Math.max(e,i,this.dynamicMinWidth),E=s[t];let D;for(v=0,D=0;D<E.length;D++){const{word:P,width:V}=E[D];v+=P.length,p+=T+V-l,p>w&&!S?(h.push(g),g=[],p=V,S=!0):p+=l,S||u||g.push(d),g=g.concat(P),T=u?0:this._measureWord([d],t,v),v++,S=!1}return D&&h.push(g),i+o>this.dynamicMinWidth&&(this.dynamicMinWidth=i-l+o),h}isEndOfWrapping(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line}missingNewlineOffset(t,e){return this.splitByGrapheme&&!e?this.isEndOfWrapping(t)?1:0:1}_splitTextIntoLines(t){const e=super._splitTextIntoLines(t),r=this._wrapText(e.lines,this.width),i=new Array(r.length);for(let s=0;s<r.length;s++)i[s]=r[s].join("");return e.lines=i,e.graphemeLines=r,e}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const t=new Map;for(const e in this._styleMap){const r=parseInt(e,10);if(this._textLines[r]){const i=this._styleMap[e].line;t.set(`${i}`,!0)}}for(const e in this.styles)t.has(e)||delete this.styles[e]}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...t])}}W(zc,"type","Textbox"),W(zc,"textLayoutProperties",[...Bo.textLayoutProperties,"width"]),W(zc,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),_t.setClass(zc);class XN extends D_{shouldPerformLayout(t){return!!t.target.clipPath&&super.shouldPerformLayout(t)}shouldLayoutClipPath(){return!1}calcLayoutResult(t,e){const{target:r}=t,{clipPath:i,group:s}=r;if(!i||!this.shouldPerformLayout(t))return;const{width:o,height:l}=Wo(tz(r,i)),u=new tt(o,l);if(i.absolutePositioned)return{center:sf(i.getRelativeCenterPoint(),void 0,s?s.calcTransformMatrix():void 0),size:u};{const h=i.getRelativeCenterPoint().transform(r.calcOwnMatrix(),!0);if(this.shouldPerformLayout(t)){const{center:d=new tt,correction:p=new tt}=this.calcBoundingBox(e,t)||{};return{center:d.add(h),correction:p.subtract(h),size:u}}return{center:r.getRelativeCenterPoint().add(h),size:u}}}}W(XN,"type","clip-path"),_t.setClass(XN);class QN extends D_{getInitialSize(t,e){let{target:r}=t,{size:i}=e;return new tt(r.width||i.x,r.height||i.y)}}W(QN,"type","fixed"),_t.setClass(QN);class kdt extends pm{subscribeTargets(t){const e=t.target;t.targets.reduce((r,i)=>(i.parent&&r.add(i.parent),r),new Set).forEach(r=>{r.layoutManager.subscribeTargets({target:r,targets:[e]})})}unsubscribeTargets(t){const e=t.target,r=e.getObjects();t.targets.reduce((i,s)=>(s.parent&&i.add(s.parent),i),new Set).forEach(i=>{!r.some(s=>s.parent===i)&&i.layoutManager.unsubscribeTargets({target:i,targets:[e]})})}}class Hc extends Qc{static getDefaults(){return{...super.getDefaults(),...Hc.ownDefaults}}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Hc.ownDefaults),this.setOptions(e);const{left:r,top:i,layoutManager:s}=e;this.groupInit(t,{left:r,top:i,layoutManager:s??new kdt})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.multiSelectionStacking==="selection-order"?this.add(...e):e.forEach(i=>{const s=this._objects.findIndex(l=>l.isInFrontOf(i)),o=s===-1?this.size():s;this.insertAt(o,i)})}canEnterGroup(t){return this.getObjects().some(e=>e.isDescendantOf(t)||t.isDescendantOf(e))?(kl("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(t)}enterGroup(t,e){t.parent&&t.parent===t.group?t.parent._exitGroup(t):t.group&&t.parent!==t.group&&t.group.remove(t),this._enterGroup(t,e)}exitGroup(t,e){this._exitGroup(t,e),t.parent&&t.parent._enterGroup(t,!0)}_onAfterObjectsChange(t,e){super._onAfterObjectsChange(t,e);const r=new Set;e.forEach(i=>{const{parent:s}=i;s&&r.add(s)}),t===XA?r.forEach(i=>{i._onAfterObjectsChange(Cb,e)}):r.forEach(i=>{i._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return`#<ActiveSelection: (${this.complexity()})>`}shouldCache(){return!1}isOnACache(){return!1}_renderControls(t,e,r){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const i={hasControls:!1,...r,forActiveSelection:!0};for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(t,i);super._renderControls(t,e),t.restore()}}W(Hc,"type","ActiveSelection"),W(Hc,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),_t.setClass(Hc),_t.setClass(Hc,"activeSelection");class Mdt{constructor(){W(this,"resources",{})}applyFilters(t,e,r,i,s){const o=s.getContext("2d",{willReadFrequently:!0,desynchronized:!0});if(!o)return;o.drawImage(e,0,0,r,i);const l={sourceWidth:r,sourceHeight:i,imageData:o.getImageData(0,0,r,i),originalEl:e,originalImageData:o.getImageData(0,0,r,i),canvasEl:s,ctx:o,filterBackend:this};t.forEach(h=>{h.applyTo(l)});const{imageData:u}=l;return u.width===r&&u.height===i||(s.width=u.width,s.height=u.height),o.putImageData(u,0,0),l}}class yz{constructor(){let{tileSize:t=ve.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),W(this,"resources",{}),this.tileSize=t,this.setupGLContext(t,t),this.captureGPUInfo()}setupGLContext(t,e){this.dispose(),this.createWebGLCanvas(t,e)}createWebGLCanvas(t,e){const r=Pi({width:t,height:e}),i=r.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});i&&(i.clearColor(0,0,0,0),this.canvas=r,this.gl=i)}applyFilters(t,e,r,i,s,o){const l=this.gl,u=s.getContext("2d");if(!l||!u)return;let h;o&&(h=this.getCachedTexture(o,e));const d={originalWidth:e.width||e.naturalWidth||0,originalHeight:e.height||e.naturalHeight||0,sourceWidth:r,sourceHeight:i,destinationWidth:r,destinationHeight:i,context:l,sourceTexture:this.createTexture(l,r,i,h?void 0:e),targetTexture:this.createTexture(l,r,i),originalTexture:h||this.createTexture(l,r,i,h?void 0:e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},p=l.createFramebuffer();return l.bindFramebuffer(l.FRAMEBUFFER,p),t.forEach(g=>{g&&g.applyTo(d)}),(function(g){const v=g.targetCanvas,T=v.width,S=v.height,w=g.destinationWidth,E=g.destinationHeight;T===w&&S===E||(v.width=w,v.height=E)})(d),this.copyGLTo2D(l,d),l.bindTexture(l.TEXTURE_2D,null),l.deleteTexture(d.sourceTexture),l.deleteTexture(d.targetTexture),l.deleteFramebuffer(p),u.setTransform(1,0,0,1,0,0),d}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(t,e,r,i,s){const{NEAREST:o,TEXTURE_2D:l,RGBA:u,UNSIGNED_BYTE:h,CLAMP_TO_EDGE:d,TEXTURE_MAG_FILTER:p,TEXTURE_MIN_FILTER:g,TEXTURE_WRAP_S:v,TEXTURE_WRAP_T:T}=t,S=t.createTexture();return t.bindTexture(l,S),t.texParameteri(l,p,s||o),t.texParameteri(l,g,s||o),t.texParameteri(l,v,d),t.texParameteri(l,T,d),i?t.texImage2D(l,0,u,u,h,i):t.texImage2D(l,0,u,e,r,0,u,h,null),S}getCachedTexture(t,e,r){const{textureCache:i}=this;if(i[t])return i[t];{const s=this.createTexture(this.gl,e.width,e.height,e,r);return s&&(i[t]=s),s}}evictCachesForKey(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])}copyGLTo2D(t,e){const r=t.canvas,i=e.targetCanvas,s=i.getContext("2d");if(!s)return;s.translate(0,i.height),s.scale(1,-1);const o=r.height-i.height;s.drawImage(r,0,o,i.width,i.height,0,0,i.width,i.height)}copyGLTo2DPutImageData(t,e){const r=e.targetCanvas.getContext("2d"),i=e.destinationWidth,s=e.destinationHeight,o=i*s*4;if(!r)return;const l=new Uint8Array(this.imageBuffer,0,o),u=new Uint8ClampedArray(this.imageBuffer,0,o);t.readPixels(0,0,i,s,t.RGBA,t.UNSIGNED_BYTE,l);const h=new ImageData(u,i,s);r.putImageData(h,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const t=this.gl,e={renderer:"",vendor:""};if(!t)return e;const r=t.getExtension("WEBGL_debug_renderer_info");if(r){const i=t.getParameter(r.UNMASKED_RENDERER_WEBGL),s=t.getParameter(r.UNMASKED_VENDOR_WEBGL);i&&(e.renderer=i.toLowerCase()),s&&(e.vendor=s.toLowerCase())}return this.gpuInfo=e,e}}let ox;function Ddt(){const{WebGLProbe:n}=io();return n.queryWebGL(ea()),ve.enableGLFiltering&&n.isSupported(ve.textureSize)?new yz({tileSize:ve.textureSize}):new Mdt}function ax(){return!ox&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(ox=Ddt()),ox}const vz=["cropX","cropY"];class zs extends or{static getDefaults(){return{...super.getDefaults(),...zs.ownDefaults}}constructor(t,e){super(),W(this,"_lastScaleX",1),W(this,"_lastScaleY",1),W(this,"_filterScalingX",1),W(this,"_filterScalingY",1),this.filters=[],Object.assign(this,zs.ownDefaults),this.setOptions(e),this.cacheKey=`texture${Ml()}`,this.setElement(typeof t=="string"?(this.canvas&&ts(this.canvas.getElement())||Tf()).getElementById(t):t,e)}getElement(){return this._element}setElement(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._element=t,this._originalElement=t,this._setWidthHeight(e),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(t){const e=ax(!1);e instanceof yz&&e.evictCachesForKey(t)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture(`${this.cacheKey}_filtered`),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(t=>{const e=this[t];e&&io().dispose(e),this[t]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const t=this.getElement();return t?{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}:{width:0,height:0}}_stroke(t){if(!this.stroke||this.strokeWidth===0)return;const e=this.width/2,r=this.height/2;t.beginPath(),t.moveTo(-e,-r),t.lineTo(e,-r),t.lineTo(e,r),t.lineTo(-e,r),t.lineTo(-e,-r),t.closePath()}toObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const e=[];return this.filters.forEach(r=>{r&&e.push(r.toObject())}),{...super.toObject([...vz,...t]),src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:e,...this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{}}}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const t=[],e=this._element,r=-this.width/2,i=-this.height/2;let s=[],o=[],l="",u="";if(!e)return[];if(this.hasCrop()){const h=Ml();s.push('<clipPath id="imageCrop_'+h+`">
`,'	<rect x="'+r+'" y="'+i+'" width="'+ne(this.width)+'" height="'+ne(this.height)+`" />
`,`</clipPath>
`),l=' clip-path="url(#imageCrop_'+h+')" '}if(this.imageSmoothing||(u=' image-rendering="optimizeSpeed"'),t.push("	<image ","COMMON_PARTS",`xlink:href="${ne(this.getSrc(!0))}" x="${r-this.cropX}" y="${i-this.cropY}" width="${e.width||e.naturalWidth}" height="${e.height||e.naturalHeight}"${u}${l}></image>
`),this.stroke||this.strokeDashArray){const h=this.fill;this.fill=null,o=[`	<rect x="${r}" y="${i}" width="${ne(this.width)}" height="${ne(this.height)}" style="${this.getSvgStyles()}" />
`],this.fill=h}return s=this.paintFirst!==Fn?s.concat(o,t):s.concat(t,o),s}getSrc(t){const e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src")||"":e.src:this.src||""}getSvgSrc(t){return this.getSrc(t)}setSrc(t){let{crossOrigin:e,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return G0(t,{crossOrigin:e,signal:r}).then(i=>{e!==void 0&&this.set({crossOrigin:e}),this.setElement(i)})}toString(){return`#<Image: { src: "${this.getSrc()}" }>`}applyResizeFilters(){const t=this.resizeFilter,e=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),i=r.x,s=r.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||i>e&&s>e)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=s);const l=Pi(o),{width:u,height:h}=o;this._element=l,this._lastScaleX=t.scaleX=i,this._lastScaleY=t.scaleY=s,ax().applyFilters([t],o,u,h,this._element),this._filterScalingX=l.width/this._originalElement.width,this._filterScalingY=l.height/this._originalElement.height}applyFilters(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(t=t.filter(s=>s&&!s.isNeutralState()),this.set("dirty",!0),this.removeTexture(`${this.cacheKey}_filtered`),t.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const e=this._originalElement,r=e.naturalWidth||e.width,i=e.naturalHeight||e.height;if(this._element===this._originalElement){const s=Pi({width:r,height:i});this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,i),this._lastScaleX=1,this._lastScaleY=1);ax().applyFilters(t,this._originalElement,r,i,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(t){t.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)}drawCacheOnCanvas(t){t.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(t)}shouldCache(){return this.needsItsOwnCache()}_renderFill(t){const e=this._element;if(!e)return;const r=this._filterScalingX,i=this._filterScalingY,s=this.width,o=this.height,l=Math.max(this.cropX,0),u=Math.max(this.cropY,0),h=e.naturalWidth||e.width,d=e.naturalHeight||e.height,p=l*r,g=u*i,v=Math.min(s*r,h-p),T=Math.min(o*i,d-g),S=-s/2,w=-o/2,E=Math.min(s,h/r-l),D=Math.min(o,d/i-u);e&&t.drawImage(e,p,g,v,T,S,w,E,D)}_needsResize(){const t=this.getTotalObjectScaling();return t.x!==this._lastScaleX||t.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:t,height:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=this.getOriginalSize();this.width=t||r.width,this.height=e||r.height}parsePreserveAspectRatioAttribute(){const t=Ght(this.preserveAspectRatio||""),e=this.width,r=this.height,i={width:e,height:r};let s,o=this._element.width,l=this._element.height,u=1,h=1,d=0,p=0,g=0,v=0;return!t||t.alignX===Br&&t.alignY===Br?(u=e/o,h=r/l):(t.meetOrSlice==="meet"&&(u=h=Gft(this._element,i),s=(e-o*u)/2,t.alignX==="Min"&&(d=-s),t.alignX==="Max"&&(d=s),s=(r-l*h)/2,t.alignY==="Min"&&(p=-s),t.alignY==="Max"&&(p=s)),t.meetOrSlice==="slice"&&(u=h=Yft(this._element,i),s=o-e/u,t.alignX==="Mid"&&(g=s/2),t.alignX==="Max"&&(g=s),s=l-r/h,t.alignY==="Mid"&&(v=s/2),t.alignY==="Max"&&(v=s),o=e/u,l=r/h)),{width:o,height:l,scaleX:u,scaleY:h,offsetLeft:d,offsetTop:p,cropX:g,cropY:v}}static fromObject(t,e){let{filters:r,resizeFilter:i,src:s,crossOrigin:o,type:l,...u}=t;return Promise.all([G0(s,{...e,crossOrigin:o}),r&&um(r,e),i?um([i],e):[],C_(u,e)]).then(h=>{let[d,p=[],[g],v={}]=h;return new this(d,{...u,src:s,filters:p,resizeFilter:g,...v})})}static fromURL(t){let{crossOrigin:e=null,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return G0(t,{crossOrigin:e,signal:r}).then(s=>new this(s,i))}static async fromElement(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const i=sa(t,this.ATTRIBUTE_NAMES,r);return this.fromURL(i["xlink:href"]||i.href,e,i).catch(s=>(kl("log","Unable to parse Image",s),null))}}W(zs,"type","Image"),W(zs,"cacheProperties",[...ia,...vz]),W(zs,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),W(zs,"ATTRIBUTE_NAMES",[...Hl,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),_t.setClass(zs),_t.setSVGClass(zs);k_(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const R_=n=>n.webgl!==void 0,QA="precision highp float",Odt=`
    ${QA};
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`,Rdt=new RegExp(QA,"g");class kn{get type(){return this.constructor.type}constructor(){let{type:t,...e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return Odt}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:i="highp"}}=io();i!=="highp"&&(e=e.replace(Rdt,QA.replace("highp",i)));const s=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER),l=t.createProgram();if(!s||!o||!l)throw new $s("Vertex, fragment shader or program creation error");if(t.shaderSource(s,r),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))throw new $s(`Vertex shader compile error for ${this.type}: ${t.getShaderInfoLog(s)}`);if(t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new $s(`Fragment shader compile error for ${this.type}: ${t.getShaderInfoLog(o)}`);if(t.attachShader(l,s),t.attachShader(l,o),t.linkProgram(l),!t.getProgramParameter(l,t.LINK_STATUS))throw new $s(`Shader link error for "${this.type}" ${t.getProgramInfoLog(l)}`);const u=this.getUniformLocations(t,l)||{};return u.uStepW=t.getUniformLocation(l,"uStepW"),u.uStepH=t.getUniformLocation(l,"uStepH"),{program:l,attributeLocations:this.getAttributeLocations(t,l),uniformLocations:u}}getAttributeLocations(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}}getUniformLocations(t,e){const r=this.constructor.uniformLocations,i={};for(let s=0;s<r.length;s++)i[r[s]]=t.getUniformLocation(e,r[s]);return i}sendAttributeData(t,e,r){const i=e.aPosition,s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW)}_setupFrameBuffer(t){const e=t.context;if(t.passes>1){const r=t.destinationWidth,i=t.destinationHeight;t.sourceWidth===r&&t.sourceHeight===i||(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,r,i)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)}else e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish()}_swapTextures(t){t.passes--,t.pass++;const e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e}isNeutralState(t){return!1}applyTo(t){R_(t)?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){}getCacheKey(){return this.type}retrieveShader(t){const e=this.getCacheKey();return t.programCache[e]||(t.programCache[e]=this.createProgram(t.context)),t.programCache[e]}applyToWebGL(t){const e=t.context,r=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(r.program),this.sendAttributeData(e,r.attributeLocations,t.aPosition),e.uniform1f(r.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(r.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,r.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(t,e,r){t.activeTexture(r),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)}unbindAdditionalTexture(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)}sendUniformData(t,e){}createHelpLayer(t){if(!t.helpLayer){const{sourceWidth:e,sourceHeight:r}=t,i=Pi({width:e,height:r});t.helpLayer=i}}toObject(){const t=Object.keys(this.constructor.defaults||{});return{type:this.type,...t.reduce((e,r)=>(e[r]=this[r],e),{})}}toJSON(){return this.toObject()}static async fromObject(t,e){let{type:r,...i}=t;return new this(i)}}W(kn,"type","BaseFilter"),W(kn,"uniformLocations",[]);const Idt={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class n0 extends kn{getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          ${Idt[this.mode]}
        }
      }
      `}applyTo2d(t){let{imageData:{data:e}}=t;const r=new xe(this.color).getSource(),i=this.alpha,s=r[0]*i,o=r[1]*i,l=r[2]*i,u=1-i;for(let h=0;h<e.length;h+=4){const d=e[h],p=e[h+1],g=e[h+2];let v,T,S;switch(this.mode){case"multiply":v=d*s/255,T=p*o/255,S=g*l/255;break;case"screen":v=255-(255-d)*(255-s)/255,T=255-(255-p)*(255-o)/255,S=255-(255-g)*(255-l)/255;break;case"add":v=d+s,T=p+o,S=g+l;break;case"difference":v=Math.abs(d-s),T=Math.abs(p-o),S=Math.abs(g-l);break;case"subtract":v=d-s,T=p-o,S=g-l;break;case"darken":v=Math.min(d,s),T=Math.min(p,o),S=Math.min(g,l);break;case"lighten":v=Math.max(d,s),T=Math.max(p,o),S=Math.max(g,l);break;case"overlay":v=s<128?2*d*s/255:255-2*(255-d)*(255-s)/255,T=o<128?2*p*o/255:255-2*(255-p)*(255-o)/255,S=l<128?2*g*l/255:255-2*(255-g)*(255-l)/255;break;case"exclusion":v=s+d-2*s*d/255,T=o+p-2*o*p/255,S=l+g-2*l*g/255;break;case"tint":v=s+d*u,T=o+p*u,S=l+g*u}e[h]=v,e[h+1]=T,e[h+2]=S}}sendUniformData(t,e){const r=new xe(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,t.uniform4fv(e.uColor,r)}}W(n0,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),W(n0,"type","BlendColor"),W(n0,"uniformLocations",["uColor"]),_t.setClass(n0);const Pdt={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `};class r0 extends kn{getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return Pdt[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(t){const e=t.context,r=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,r,e.TEXTURE1),super.applyToWebGL(t),this.unbindAdditionalTexture(e,e.TEXTURE1)}createTexture(t,e){return t.getCachedTexture(e.cacheKey,e.getElement())}calculateMatrix(){const t=this.image,{width:e,height:r}=t.getElement();return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/r,1]}applyTo2d(t){let{imageData:{data:e,width:r,height:i},filterBackend:{resources:s}}=t;const o=this.image;s.blendImage||(s.blendImage=ea());const l=s.blendImage,u=l.getContext("2d");l.width!==r||l.height!==i?(l.width=r,l.height=i):u.clearRect(0,0,r,i),u.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),u.drawImage(o.getElement(),0,0,r,i);const h=u.getImageData(0,0,r,i).data;for(let d=0;d<e.length;d+=4){const p=e[d],g=e[d+1],v=e[d+2],T=e[d+3],S=h[d],w=h[d+1],E=h[d+2],D=h[d+3];switch(this.mode){case"multiply":e[d]=p*S/255,e[d+1]=g*w/255,e[d+2]=v*E/255,e[d+3]=T*D/255;break;case"mask":e[d+3]=D}}}sendUniformData(t,e){const r=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,r)}toObject(){return{...super.toObject(),image:this.image&&this.image.toObject()}}static async fromObject(t,e){let{type:r,image:i,...s}=t;return zs.fromObject(i,e).then(o=>new this({...s,image:o}))}}W(r0,"type","BlendImage"),W(r0,"defaults",{mode:"multiply",alpha:1}),W(r0,"uniformLocations",["uTransformMatrix","uImage"]),_t.setClass(r0);class i0 extends kn{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(t){R_(t)?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)}applyTo2d(t){let{imageData:{data:e,width:r,height:i}}=t;this.aspectRatio=r/i,this.horizontal=!0;let s=this.getBlurValue()*r;const o=new Uint8ClampedArray(e),l=15,u=4*r;for(let h=0;h<e.length;h+=4){let d=0,p=0,g=0,v=0,T=0;const S=h-h%u,w=S+u;for(let E=-14;E<l;E++){const D=E/l,P=4*Math.floor(s*D),V=1-Math.abs(D);let N=h+P;N<S?N=S:N>w&&(N=w);const q=e[N+3]*V;d+=e[N]*q,p+=e[N+1]*q,g+=e[N+2]*q,v+=q,T+=V}o[h]=d/v,o[h+1]=p/v,o[h+2]=g/v,o[h+3]=v/T}this.horizontal=!1,s=this.getBlurValue()*i;for(let h=0;h<o.length;h+=4){let d=0,p=0,g=0,v=0,T=0;const S=h%u,w=o.length-u+S;for(let E=-14;E<l;E++){const D=E/l,P=Math.floor(s*D)*u,V=1-Math.abs(D);let N=h+P;N<S?N=S:N>w&&(N=w);const q=o[N+3]*V;d+=o[N]*q,p+=o[N+1]*q,g+=o[N+2]*q,v+=q,T+=V}e[h]=d/v,e[h+1]=p/v,e[h+2]=g/v,e[h+3]=v/T}}sendUniformData(t,e){const r=this.chooseRightDelta();t.uniform2fv(e.uDelta,r)}isNeutralState(){return this.blur===0}getBlurValue(){let t=1;const{horizontal:e,aspectRatio:r}=this;return e?r>1&&(t=1/r):r<1&&(t=r),t*this.blur*.12}chooseRightDelta(){const t=this.getBlurValue();return this.horizontal?[t,0]:[0,t]}}W(i0,"type","Blur"),W(i0,"defaults",{blur:0}),W(i0,"uniformLocations",["uDelta"]),_t.setClass(i0);class s0 extends kn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const r=Math.round(255*this.brightness);for(let i=0;i<e.length;i+=4)e[i]+=r,e[i+1]+=r,e[i+2]+=r}isNeutralState(){return this.brightness===0}sendUniformData(t,e){t.uniform1f(e.uBrightness,this.brightness)}}W(s0,"type","Brightness"),W(s0,"defaults",{brightness:0}),W(s0,"uniformLocations",["uBrightness"]),_t.setClass(s0);const bz={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Dh extends kn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(t){const e=t.imageData.data,r=this.matrix,i=this.colorsOnly;for(let s=0;s<e.length;s+=4){const o=e[s],l=e[s+1],u=e[s+2];if(e[s]=o*r[0]+l*r[1]+u*r[2]+255*r[4],e[s+1]=o*r[5]+l*r[6]+u*r[7]+255*r[9],e[s+2]=o*r[10]+l*r[11]+u*r[12]+255*r[14],!i){const h=e[s+3];e[s]+=h*r[3],e[s+1]+=h*r[8],e[s+2]+=h*r[13],e[s+3]=o*r[15]+l*r[16]+u*r[17]+h*r[18]+255*r[19]}}}sendUniformData(t,e){const r=this.matrix,i=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],s=[r[4],r[9],r[14],r[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,i),t.uniform4fv(e.uConstants,s)}toObject(){return{...super.toObject(),matrix:[...this.matrix]}}}function bu(n,t){var e;const r=(W(e=class extends Dh{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",n),W(e,"defaults",{colorsOnly:!1,matrix:t}),e);return _t.setClass(r,n),r}W(Dh,"type","ColorMatrix"),W(Dh,"defaults",bz),W(Dh,"uniformLocations",["uColorMatrix","uConstants"]),_t.setClass(Dh);bu("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);bu("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);bu("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);bu("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);bu("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);bu("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);bu("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class JN extends kn{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.subFilters=t.subFilters||[]}applyTo(t){R_(t)&&(t.passes+=this.subFilters.length-1),this.subFilters.forEach(e=>{e.applyTo(t)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(t=>t.toObject())}}isNeutralState(){return!this.subFilters.some(t=>!t.isNeutralState())}static fromObject(t,e){return Promise.all((t.subFilters||[]).map(r=>_t.getClass(r.type).fromObject(r,e))).then(r=>new this({subFilters:r}))}}W(JN,"type","Composed"),_t.setClass(JN);class o0 extends kn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(t){let{imageData:{data:e}}=t;const r=Math.floor(255*this.contrast),i=259*(r+255)/(255*(259-r));for(let s=0;s<e.length;s+=4)e[s]=i*(e[s]-128)+128,e[s+1]=i*(e[s+1]-128)+128,e[s+2]=i*(e[s+2]-128)+128}sendUniformData(t,e){t.uniform1f(e.uContrast,this.contrast)}}W(o0,"type","Contrast"),W(o0,"defaults",{contrast:0}),W(o0,"uniformLocations",["uContrast"]),_t.setClass(o0);const Ndt={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class a0 extends kn{getCacheKey(){return`${this.type}_${Math.sqrt(this.matrix.length)}_${this.opaque?1:0}`}getFragmentSource(){return Ndt[this.getCacheKey()]}applyTo2d(t){const e=t.imageData,r=e.data,i=this.matrix,s=Math.round(Math.sqrt(i.length)),o=Math.floor(s/2),l=e.width,u=e.height,h=t.ctx.createImageData(l,u),d=h.data,p=this.opaque?1:0;let g,v,T,S,w,E,D,P,V,N,q,M,k;for(q=0;q<u;q++)for(N=0;N<l;N++){for(w=4*(q*l+N),g=0,v=0,T=0,S=0,k=0;k<s;k++)for(M=0;M<s;M++)D=q+k-o,E=N+M-o,D<0||D>=u||E<0||E>=l||(P=4*(D*l+E),V=i[k*s+M],g+=r[P]*V,v+=r[P+1]*V,T+=r[P+2]*V,p||(S+=r[P+3]*V));d[w]=g,d[w+1]=v,d[w+2]=T,d[w+3]=p?r[w+3]:S}t.imageData=h}sendUniformData(t,e){t.uniform1fv(e.uMatrix,this.matrix)}toObject(){return{...super.toObject(),opaque:this.opaque,matrix:[...this.matrix]}}}W(a0,"type","Convolute"),W(a0,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),W(a0,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),_t.setClass(a0);const _z="Gamma";class l0 extends kn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(t),this.gamma=t.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(t){let{imageData:{data:e}}=t;const r=this.gamma,i=1/r[0],s=1/r[1],o=1/r[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const l=this.rgbValues;for(let u=0;u<256;u++)l.r[u]=255*Math.pow(u/255,i),l.g[u]=255*Math.pow(u/255,s),l.b[u]=255*Math.pow(u/255,o);for(let u=0;u<e.length;u+=4)e[u]=l.r[e[u]],e[u+1]=l.g[e[u+1]],e[u+2]=l.b[e[u+2]]}sendUniformData(t,e){t.uniform3fv(e.uGamma,this.gamma)}isNeutralState(){const{gamma:t}=this;return t[0]===1&&t[1]===1&&t[2]===1}toObject(){return{type:_z,gamma:this.gamma.concat()}}}W(l0,"type",_z),W(l0,"defaults",{gamma:[1,1,1]}),W(l0,"uniformLocations",["uGamma"]),_t.setClass(l0);const Ldt={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class c0 extends kn{applyTo2d(t){let{imageData:{data:e}}=t;for(let r,i=0;i<e.length;i+=4){const s=e[i],o=e[i+1],l=e[i+2];switch(this.mode){case"average":r=(s+o+l)/3;break;case"lightness":r=(Math.min(s,o,l)+Math.max(s,o,l))/2;break;case"luminosity":r=.21*s+.72*o+.07*l}e[i+2]=e[i+1]=e[i]=r}}getCacheKey(){return`${this.type}_${this.mode}`}getFragmentSource(){return Ldt[this.mode]}sendUniformData(t,e){t.uniform1i(e.uMode,1)}isNeutralState(){return!1}}W(c0,"type","Grayscale"),W(c0,"defaults",{mode:"average"}),W(c0,"uniformLocations",["uMode"]),_t.setClass(c0);const Vdt={...bz,rotation:0};class lx extends Dh{calculateMatrix(){const t=this.rotation*Math.PI,e=Zo(t),r=ta(t),i=1/3,s=Math.sqrt(i)*r,o=1-e;this.matrix=[e+o/3,i*o-s,i*o+s,0,0,i*o+s,e+i*o,i*o-s,0,0,i*o-s,i*o+s,e+i*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(t){this.calculateMatrix(),super.applyTo(t)}toObject(){return{type:this.type,rotation:this.rotation}}}W(lx,"type","HueRotation"),W(lx,"defaults",Vdt),_t.setClass(lx);class u0 extends kn{applyTo2d(t){let{imageData:{data:e}}=t;for(let r=0;r<e.length;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2],this.alpha&&(e[r+3]=255-e[r+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(t,e){t.uniform1i(e.uInvert,Number(this.invert)),t.uniform1i(e.uAlpha,Number(this.alpha))}}W(u0,"type","Invert"),W(u0,"defaults",{alpha:!1,invert:!0}),W(u0,"uniformLocations",["uInvert","uAlpha"]),_t.setClass(u0);class h0 extends kn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const r=this.noise;for(let i=0;i<e.length;i+=4){const s=(.5-Math.random())*r;e[i]+=s,e[i+1]+=s,e[i+2]+=s}}sendUniformData(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())}isNeutralState(){return this.noise===0}}W(h0,"type","Noise"),W(h0,"defaults",{noise:0}),W(h0,"uniformLocations",["uNoise","uSeed"]),_t.setClass(h0);class f0 extends kn{applyTo2d(t){let{imageData:{data:e,width:r,height:i}}=t;for(let s=0;s<i;s+=this.blocksize)for(let o=0;o<r;o+=this.blocksize){const l=4*s*r+4*o,u=e[l],h=e[l+1],d=e[l+2],p=e[l+3];for(let g=s;g<Math.min(s+this.blocksize,i);g++)for(let v=o;v<Math.min(o+this.blocksize,r);v++){const T=4*g*r+4*v;e[T]=u,e[T+1]=h,e[T+2]=d,e[T+3]=p}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}W(f0,"type","Pixelate"),W(f0,"defaults",{blocksize:4}),W(f0,"uniformLocations",["uBlocksize"]),_t.setClass(f0);class d0 extends kn{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(t){let{imageData:{data:e}}=t;const r=255*this.distance,i=new xe(this.color).getSource(),s=[i[0]-r,i[1]-r,i[2]-r],o=[i[0]+r,i[1]+r,i[2]+r];for(let l=0;l<e.length;l+=4){const u=e[l],h=e[l+1],d=e[l+2];u>s[0]&&h>s[1]&&d>s[2]&&u<o[0]&&h<o[1]&&d<o[2]&&(e[l+3]=0)}}sendUniformData(t,e){const r=new xe(this.color).getSource(),i=this.distance,s=[0+r[0]/255-i,0+r[1]/255-i,0+r[2]/255-i,1],o=[r[0]/255+i,r[1]/255+i,r[2]/255+i,1];t.uniform4fv(e.uLow,s),t.uniform4fv(e.uHigh,o)}}W(d0,"type","RemoveColor"),W(d0,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),W(d0,"uniformLocations",["uLow","uHigh"]),_t.setClass(d0);class p0 extends kn{sendUniformData(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)}getFilterWindow(){const t=this.tempScale;return Math.ceil(this.lanczosLobes/t)}getCacheKey(){const t=this.getFilterWindow();return`${this.type}_${t}`}getFragmentSource(){const t=this.getFilterWindow();return this.generateShader(t)}getTaps(){const t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,r=this.getFilterWindow(),i=new Array(r);for(let s=1;s<=r;s++)i[s-1]=t(s*e);return i}generateShader(t){const e=new Array(t);for(let r=1;r<=t;r++)e[r-1]=`${r}.0 * uDelta`;return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[${t}];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        ${e.map((r,i)=>`
              color += texture2D(uTexture, vTexCoord + ${r}) * uTaps[${i}] + texture2D(uTexture, vTexCoord - ${r}) * uTaps[${i}];
              sum += 2.0 * uTaps[${i}];
            `).join(`
`)}
        gl_FragColor = color / sum;
      }
    `}applyToForWebgl(t){t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,super.applyTo(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,super.applyTo(t),t.sourceHeight=t.destinationHeight}applyTo(t){R_(t)?this.applyToForWebgl(t):this.applyTo2d(t)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(t){return e=>{if(e>=t||e<=-t)return 0;if(e<11920929e-14&&e>-11920929e-14)return 1;const r=(e*=Math.PI)/t;return Math.sin(e)/e*Math.sin(r)/r}}applyTo2d(t){const e=t.imageData,r=this.scaleX,i=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/i;const s=e.width,o=e.height,l=Math.round(s*r),u=Math.round(o*i);let h;h=this.resizeType==="sliceHack"?this.sliceByTwo(t,s,o,l,u):this.resizeType==="hermite"?this.hermiteFastResize(t,s,o,l,u):this.resizeType==="bilinear"?this.bilinearFiltering(t,s,o,l,u):this.resizeType==="lanczos"?this.lanczosResize(t,s,o,l,u):new ImageData(l,u),t.imageData=h}sliceByTwo(t,e,r,i,s){const o=t.imageData,l=.5;let u=!1,h=!1,d=e*l,p=r*l;const g=t.filterBackend.resources;let v=0,T=0;const S=e;let w=0;g.sliceByTwo||(g.sliceByTwo=ea());const E=g.sliceByTwo;(E.width<1.5*e||E.height<r)&&(E.width=1.5*e,E.height=r);const D=E.getContext("2d");for(D.clearRect(0,0,1.5*e,r),D.putImageData(o,0,0),i=Math.floor(i),s=Math.floor(s);!u||!h;)e=d,r=p,i<Math.floor(d*l)?d=Math.floor(d*l):(d=i,u=!0),s<Math.floor(p*l)?p=Math.floor(p*l):(p=s,h=!0),D.drawImage(E,v,T,e,r,S,w,d,p),v=S,T=w,w+=p;return D.getImageData(v,T,i,s)}lanczosResize(t,e,r,i,s){const o=t.imageData.data,l=t.ctx.createImageData(i,s),u=l.data,h=this.lanczosCreate(this.lanczosLobes),d=this.rcpScaleX,p=this.rcpScaleY,g=2/this.rcpScaleX,v=2/this.rcpScaleY,T=Math.ceil(d*this.lanczosLobes/2),S=Math.ceil(p*this.lanczosLobes/2),w={},E={x:0,y:0},D={x:0,y:0};return(function P(V){let N,q,M,k,R,F,U,H,j,yt,xt;for(E.x=(V+.5)*d,D.x=Math.floor(E.x),N=0;N<s;N++){for(E.y=(N+.5)*p,D.y=Math.floor(E.y),R=0,F=0,U=0,H=0,j=0,q=D.x-T;q<=D.x+T;q++)if(!(q<0||q>=e)){yt=Math.floor(1e3*Math.abs(q-E.x)),w[yt]||(w[yt]={});for(let J=D.y-S;J<=D.y+S;J++)J<0||J>=r||(xt=Math.floor(1e3*Math.abs(J-E.y)),w[yt][xt]||(w[yt][xt]=h(Math.sqrt(Math.pow(yt*g,2)+Math.pow(xt*v,2))/1e3)),M=w[yt][xt],M>0&&(k=4*(J*e+q),R+=M,F+=M*o[k],U+=M*o[k+1],H+=M*o[k+2],j+=M*o[k+3]))}k=4*(N*i+V),u[k]=F/R,u[k+1]=U/R,u[k+2]=H/R,u[k+3]=j/R}return++V<i?P(V):l})(0)}bilinearFiltering(t,e,r,i,s){let o,l,u,h,d,p,g,v,T,S,w,E,D,P=0;const V=this.rcpScaleX,N=this.rcpScaleY,q=4*(e-1),M=t.imageData.data,k=t.ctx.createImageData(i,s),R=k.data;for(g=0;g<s;g++)for(v=0;v<i;v++)for(d=Math.floor(V*v),p=Math.floor(N*g),T=V*v-d,S=N*g-p,D=4*(p*e+d),w=0;w<4;w++)o=M[D+w],l=M[D+4+w],u=M[D+q+w],h=M[D+q+4+w],E=o*(1-T)*(1-S)+l*T*(1-S)+u*S*(1-T)+h*T*S,R[P++]=E;return k}hermiteFastResize(t,e,r,i,s){const o=this.rcpScaleX,l=this.rcpScaleY,u=Math.ceil(o/2),h=Math.ceil(l/2),d=t.imageData.data,p=t.ctx.createImageData(i,s),g=p.data;for(let v=0;v<s;v++)for(let T=0;T<i;T++){const S=4*(T+v*i);let w=0,E=0,D=0,P=0,V=0,N=0,q=0;const M=(v+.5)*l;for(let k=Math.floor(v*l);k<(v+1)*l;k++){const R=Math.abs(M-(k+.5))/h,F=(T+.5)*o,U=R*R;for(let H=Math.floor(T*o);H<(T+1)*o;H++){let j=Math.abs(F-(H+.5))/u;const yt=Math.sqrt(U+j*j);yt>1&&yt<-1||(w=2*yt*yt*yt-3*yt*yt+1,w>0&&(j=4*(H+k*e),q+=w*d[j+3],D+=w,d[j+3]<255&&(w=w*d[j+3]/250),P+=w*d[j],V+=w*d[j+1],N+=w*d[j+2],E+=w))}}g[S]=P/E,g[S+1]=V/E,g[S+2]=N/E,g[S+3]=q/D}return p}}W(p0,"type","Resize"),W(p0,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),W(p0,"uniformLocations",["uDelta","uTaps"]),_t.setClass(p0);class m0 extends kn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const r=-this.saturation;for(let i=0;i<e.length;i+=4){const s=e[i],o=e[i+1],l=e[i+2],u=Math.max(s,o,l);e[i]+=u!==s?(u-s)*r:0,e[i+1]+=u!==o?(u-o)*r:0,e[i+2]+=u!==l?(u-l)*r:0}}sendUniformData(t,e){t.uniform1f(e.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}W(m0,"type","Saturation"),W(m0,"defaults",{saturation:0}),W(m0,"uniformLocations",["uSaturation"]),_t.setClass(m0);class g0 extends kn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(t){let{imageData:{data:e}}=t;const r=-this.vibrance;for(let i=0;i<e.length;i+=4){const s=e[i],o=e[i+1],l=e[i+2],u=Math.max(s,o,l),h=(s+o+l)/3,d=2*Math.abs(u-h)/255*r;e[i]+=u!==s?(u-s)*d:0,e[i+1]+=u!==o?(u-o)*d:0,e[i+2]+=u!==l?(u-l)*d:0}}sendUniformData(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}W(g0,"type","Vibrance"),W(g0,"defaults",{vibrance:0}),W(g0,"uniformLocations",["uVibrance"]),_t.setClass(g0);const y0=["#2D2D2D","#FF6B6B","#FFB347","#FDFD96","#77DD77","#89CFF0","#B19CD9","#FFB6C1","#FFFFFF"],jdt=2,Fdt=30,ZN=5,Bdt="#FFFFFF";function Udt({width:n,height:t,onSave:e,onClose:r}){const i=L.useRef(null),s=L.useRef(null),[o,l]=L.useState("pencil"),[u,h]=L.useState(y0[0]),[d,p]=L.useState(ZN),g=L.useRef(y0[0]);L.useEffect(()=>{if(!i.current)return;const w=new t1(i.current,{isDrawingMode:!0,width:n,height:t,backgroundColor:"#FFFFFF"}),E=new Mb(w);return E.color=y0[0],E.width=ZN,w.freeDrawingBrush=E,s.current=w,()=>{w.dispose(),s.current=null}},[n,t]),L.useEffect(()=>{const w=s.current;!w||!w.freeDrawingBrush||(o==="eraser"?(w.freeDrawingBrush.color=Bdt,w.freeDrawingBrush.width=d*3):(w.freeDrawingBrush.color=u,w.freeDrawingBrush.width=d))},[o,u,d]);const v=L.useCallback(w=>{w==="pencil"&&o==="eraser"&&h(g.current),w==="eraser"&&o==="pencil"&&(g.current=u),l(w)},[o,u]),T=L.useCallback(w=>{h(w),g.current=w,o==="eraser"&&l("pencil")},[o]),S=L.useCallback(()=>{const w=s.current;if(w)try{const E=w.toDataURL({format:"png"});e(E)}catch(E){console.error("Failed to export canvas:",E)}},[e]);return B.jsxs("div",{className:"flex flex-col items-center",children:[B.jsxs("div",{className:"flex flex-wrap items-center gap-3 p-3 bg-white/90 backdrop-blur rounded-2xl shadow-md mb-3 w-full max-w-[600px]",children:[B.jsxs("div",{className:"flex gap-1",children:[B.jsx("button",{type:"button",onClick:()=>v("pencil"),className:`px-3 py-1.5 rounded-xl text-sm font-['Poppins'] font-medium transition-colors cursor-pointer ${o==="pencil"?"bg-pink-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,"aria-label":"Pencil tool",children:" Pencil"}),B.jsx("button",{type:"button",onClick:()=>v("eraser"),className:`px-3 py-1.5 rounded-xl text-sm font-['Poppins'] font-medium transition-colors cursor-pointer ${o==="eraser"?"bg-pink-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,"aria-label":"Eraser tool",children:" Eraser"})]}),B.jsx("div",{className:"w-px h-6 bg-gray-200"}),B.jsx("div",{className:"flex gap-1 flex-wrap",children:y0.map(w=>B.jsx("button",{type:"button",onClick:()=>T(w),className:`w-6 h-6 rounded-full border-2 transition-transform cursor-pointer ${u===w&&o==="pencil"?"border-pink-500 scale-110":"border-gray-200 hover:scale-105"}`,style:{backgroundColor:w},"aria-label":`Color ${w}`},w))}),B.jsx("div",{className:"w-px h-6 bg-gray-200"}),B.jsxs("div",{className:"flex items-center gap-2",children:[B.jsx("span",{className:"text-xs font-['Poppins'] text-gray-500",children:"Size"}),B.jsx("input",{type:"range",min:jdt,max:Fdt,value:d,onChange:w=>p(Number(w.target.value)),className:"w-20 accent-pink-500","aria-label":"Brush size"}),B.jsx("span",{className:"text-xs font-['Poppins'] text-gray-500 w-5 text-center",children:d})]})]}),B.jsx("div",{className:"rounded-2xl overflow-hidden border border-pink-100 shadow-sm bg-white",children:B.jsx("canvas",{ref:i})}),B.jsxs("div",{className:"flex gap-3 mt-3",children:[B.jsx("button",{type:"button",onClick:r,className:"px-6 py-2 rounded-xl font-['Poppins'] text-sm font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors cursor-pointer",children:"Cancel"}),B.jsx("button",{type:"button",onClick:S,className:"px-6 py-2 rounded-xl font-['Poppins'] text-sm font-medium bg-pink-500 text-white hover:bg-pink-600 transition-colors shadow-md cursor-pointer",children:" Save Drawing"})]})]})}const JA="dearme-draft",zdt=3e4;function tL(){try{const n=localStorage.getItem(JA);return n?JSON.parse(n):null}catch{return null}}function Hdt(n){try{localStorage.setItem(JA,JSON.stringify(n))}catch{}}function eL(){localStorage.removeItem(JA)}function $dt(){const{entryId:n}=$H(),t=ym(),{user:e}=Rm(),[r,i]=L.useState(""),[s,o]=L.useState("neutral"),[l,u]=L.useState([]),[h,d]=L.useState(null),[p,g]=L.useState([]),[v,T]=L.useState(!1),[S,w]=L.useState(!1),[E,D]=L.useState(!!n),[P,V]=L.useState(!1),[N,q]=L.useState(n||null),[M,k]=L.useState(null),[R,F]=L.useState(!1),[U,H]=L.useState(!1),[j,yt]=L.useState(null),[xt,J]=L.useState(!1),st=L.useRef(n||(typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))),ht=L.useRef(null),Ct=L.useRef(null),Vt=L.useRef(!1),$=fct({extensions:[Jut,cU,fU,rht,iht,lht.configure({multicolor:!0})],content:"<p>Start writing your thoughts...</p>",editorProps:{attributes:{class:"prose prose-sm sm:prose-base max-w-none focus:outline-none min-h-[300px] font-['Poppins'] text-gray-800 p-4"}},onUpdate:()=>{Vt.current=!0}});L.useEffect(()=>{if(!n||!e)return;let Mt=!1;async function be(){try{D(!0);const Oe=await mU(n,e.uid);if(Mt)return;i(Oe.title||""),o(Oe.mood||"neutral"),u(Oe.images||[]),d(Oe.drawingURL||null),q(n),$&&Oe.content&&$.commands.setContent(Oe.content)}catch(Oe){Mt||g([Oe.message||"Failed to load entry"])}finally{Mt||D(!1)}}return be(),()=>{Mt=!0}},[n,e,$]),L.useEffect(()=>{if(n)return;const Mt=tL();Mt&&(Mt.title||Mt.mood!=="neutral"||Mt.content)&&V(!0)},[n]);const ot=L.useCallback(()=>{const Mt=tL();Mt&&(Mt.title&&i(Mt.title),Mt.mood&&o(Mt.mood),$&&Mt.content&&$.commands.setContent(Mt.content),V(!1))},[$]),dt=L.useCallback(()=>{eL(),V(!1)},[]);L.useEffect(()=>{if(!n)return Ct.current=setInterval(()=>{if(!$)return;const Mt={title:r,mood:s,content:$.getJSON(),savedAt:new Date().toISOString()};Hdt(Mt)},zdt),()=>{Ct.current&&clearInterval(Ct.current)}},[n,r,s,$]);const mt=L.useCallback(async Mt=>{const be=Mt.target.files?.[0];if(be){if(ht.current&&(ht.current.value=""),k(null),l.length>=kc){k(`Maximum ${kc} images per entry`);return}if(be.size>_B){k("Image must be under 5MB");return}if(!TB.includes(be.type)){k("Please upload a JPEG, PNG, GIF, or WebP image");return}F(!0);try{const Oe=N||st.current,Cr=await mht(e.uid,Oe,be);u(li=>[...li,Cr])}catch(Oe){k(Oe.message||"Failed to upload image. Please try again.")}finally{F(!1)}}},[l,N,e]),Ot=L.useCallback(Mt=>{u(be=>be.filter((Oe,Cr)=>Cr!==Mt))},[]),It=L.useCallback(async Mt=>{if(e){yt(null),J(!0);try{const be=N||st.current,Oe=await ght(e.uid,be,Mt);d(Oe),H(!1)}catch(be){yt(be.message||"Could not save your drawing. Please try simplifying it.")}finally{J(!1)}}},[e,N]),Ut=L.useCallback(()=>{H(!1)},[]),Fe=L.useCallback(()=>{d(null)},[]),he=L.useCallback(async()=>{if(!$||!e)return;const Mt=[],be=dU(r);be.valid||Mt.push(be.error);const Oe=pU(new Date);if(Oe.valid||Mt.push(Oe.error),Mt.length>0){g(Mt);return}g([]),T(!0);try{const Cr={title:r.trim(),content:$.getJSON(),mood:s,images:l,drawingURL:h,theme:"pastel-pink",date:new Date};await dht(e.uid,Cr,N||void 0),eL(),w(!0),setTimeout(()=>{t("/dashboard")},1200)}catch(Cr){g([Cr.message||"Failed to save entry"])}finally{T(!1)}},[$,e,r,s,l,h,N,t]);return E?B.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:B.jsxs("div",{className:"text-center",children:[B.jsx("div",{className:"w-10 h-10 border-4 border-pink-200 border-t-pink-500 rounded-full animate-spin mx-auto mb-3"}),B.jsx("p",{className:"font-['Poppins'] text-gray-500",children:"Loading entry..."})]})}):B.jsxs("div",{className:"max-w-3xl mx-auto p-4 sm:p-6",children:[B.jsx(V0,{children:S&&B.jsx(Cn.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/20",children:B.jsxs(Cn.div,{initial:{y:20},animate:{y:0},className:"bg-white rounded-3xl p-8 shadow-2xl text-center",children:[B.jsx("span",{className:"text-5xl mb-3 block",children:""}),B.jsx("p",{className:"font-['Caveat'] text-2xl text-pink-600",children:"Entry saved!"})]})})}),B.jsx(V0,{children:P&&B.jsxs(Cn.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-2xl flex items-center justify-between",children:[B.jsx("p",{className:"font-['Poppins'] text-sm text-yellow-800",children:"You have an unsaved draft. Would you like to restore it?"}),B.jsxs("div",{className:"flex gap-2 ml-4",children:[B.jsx("button",{type:"button",onClick:ot,className:"px-3 py-1.5 bg-yellow-400 text-yellow-900 rounded-lg text-sm font-medium hover:bg-yellow-500 transition-colors",children:"Restore"}),B.jsx("button",{type:"button",onClick:dt,className:"px-3 py-1.5 bg-white text-gray-600 rounded-lg text-sm border border-gray-200 hover:bg-gray-50 transition-colors",children:"Discard"})]})]})}),B.jsx("h1",{className:"font-['Caveat'] text-3xl sm:text-4xl text-[var(--color-text,#4A2040)] mb-6",children:N?" Edit Entry":" New Entry"}),p.length>0&&B.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-2xl",role:"alert",children:p.map((Mt,be)=>B.jsx("p",{className:"font-['Poppins'] text-sm text-red-600",children:Mt},be))}),B.jsxs("div",{className:"mb-4",children:[B.jsx("label",{htmlFor:"entry-title",className:"block font-['Poppins'] text-sm text-gray-600 mb-1",children:"Title"}),B.jsx("input",{id:"entry-title",type:"text",value:r,onChange:Mt=>i(Mt.target.value),placeholder:"Give your entry a title...",maxLength:200,className:"w-full px-4 py-3 rounded-2xl border border-pink-200 bg-white font-['Caveat'] text-xl text-gray-800 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-300 focus:border-transparent transition-shadow"}),B.jsxs("p",{className:"mt-1 text-xs font-['Poppins'] text-gray-400 text-right",children:[r.length,"/200"]})]}),B.jsxs("div",{className:"mb-6",children:[B.jsx("p",{className:"font-['Poppins'] text-sm text-gray-600 mb-2",children:"How are you feeling?"}),B.jsx(SB,{value:s,onChange:o})]}),B.jsx(Tht,{editor:$}),B.jsx("div",{className:"bg-white rounded-2xl border border-pink-100 shadow-sm min-h-[350px] mb-6 overflow-hidden",style:{backgroundImage:"repeating-linear-gradient(transparent, transparent 31px, #f9e4ec 31px, #f9e4ec 32px)",backgroundSize:"100% 32px"},children:B.jsx(I5,{editor:$})}),B.jsxs("div",{className:"mb-6",children:[B.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[B.jsxs("label",{className:"font-['Poppins'] text-sm text-gray-600",children:["Images (",l.length,"/",kc,")"]}),B.jsx("input",{ref:ht,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:mt,className:"hidden",id:"image-upload","aria-label":"Upload image"}),B.jsx("button",{type:"button",onClick:()=>ht.current?.click(),disabled:R||l.length>=kc,className:`px-4 py-1.5 rounded-xl font-['Poppins'] text-sm font-medium transition-colors ${R||l.length>=kc?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-pink-100 text-pink-600 hover:bg-pink-200 cursor-pointer"}`,children:R?"Uploading...":" Add Image"}),B.jsx("button",{type:"button",onClick:()=>H(!0),className:"px-4 py-1.5 rounded-xl font-['Poppins'] text-sm font-medium bg-purple-100 text-purple-600 hover:bg-purple-200 transition-colors cursor-pointer",children:" Open Drawing"})]}),M&&B.jsx("p",{className:"font-['Poppins'] text-sm text-red-500 mb-2",role:"alert",children:M}),j&&B.jsx("p",{className:"font-['Poppins'] text-sm text-red-500 mb-2",role:"alert",children:j}),l.length>0&&B.jsx("div",{className:"flex flex-wrap gap-3",children:l.map((Mt,be)=>B.jsxs("div",{className:"relative group w-24 h-24 rounded-xl overflow-hidden border border-pink-100 shadow-sm",children:[B.jsx("img",{src:Mt,alt:`Upload ${be+1}`,className:"w-full h-full object-cover"}),B.jsx("button",{type:"button",onClick:()=>Ot(be),className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer","aria-label":`Remove image ${be+1}`,children:""})]},Mt))}),h&&B.jsxs("div",{className:"mt-3",children:[B.jsx("p",{className:"font-['Poppins'] text-sm text-gray-600 mb-1",children:"Drawing"}),B.jsxs("div",{className:"relative group w-32 h-24 rounded-xl overflow-hidden border border-purple-200 shadow-sm bg-white",children:[B.jsx("img",{src:h,alt:"Saved drawing",className:"w-full h-full object-contain"}),B.jsx("button",{type:"button",onClick:Fe,className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer","aria-label":"Remove drawing",children:""})]})]})]}),B.jsx(V0,{children:U&&B.jsx(Cn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",children:B.jsxs(Cn.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white/95 rounded-3xl p-4 sm:p-6 shadow-2xl max-w-[650px] w-full max-h-[90vh] overflow-auto",children:[B.jsx("h2",{className:"font-['Caveat'] text-2xl text-purple-600 mb-3 text-center",children:" Draw Something"}),xt&&B.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[B.jsx("div",{className:"w-4 h-4 border-2 border-purple-200 border-t-purple-500 rounded-full animate-spin"}),B.jsx("span",{className:"font-['Poppins'] text-sm text-gray-500",children:"Saving drawing..."})]}),B.jsx(Udt,{width:560,height:400,onSave:It,onClose:Ut})]})})}),B.jsx("div",{className:"flex justify-end",children:B.jsx(Cn.button,{type:"button",onClick:he,disabled:v,whileHover:{scale:1.02},whileTap:{scale:.98},className:`px-8 py-3 rounded-2xl font-['Poppins'] font-medium text-white shadow-lg transition-colors ${v?"bg-pink-300 cursor-not-allowed":"bg-pink-500 hover:bg-pink-600 cursor-pointer"}`,children:v?"Saving...":N?"Update Entry":"Save Entry"})})]})}const qdt={happy:"bg-yellow-300",sad:"bg-blue-300",productive:"bg-green-300",romantic:"bg-pink-300",anxious:"bg-orange-300",calm:"bg-teal-300",neutral:"bg-gray-300"},Wdt=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function Gdt(n){if(!n)return"";if(typeof n=="string")return n;const t=[],e=r=>{r.text&&t.push(r.text),r.content&&r.content.forEach(e)};return e(n),t.join(" ")}function Ydt({entry:n,onClose:t}){if(!n)return null;const e=n.date?.toDate?Qp(n.date.toDate(),"MMMM d, yyyy"):Qp(new Date(n.date),"MMMM d, yyyy");return B.jsx(V0,{children:B.jsx(Cn.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,children:B.jsxs(Cn.div,{className:"bg-white rounded-3xl shadow-2xl max-w-lg w-full max-h-[85vh] overflow-y-auto p-6 relative",initial:{rotateY:-90,opacity:0},animate:{rotateY:0,opacity:1},exit:{rotateY:90,opacity:0},transition:{duration:.5,ease:"easeInOut"},onClick:r=>r.stopPropagation(),style:{perspective:1200},children:[B.jsx("button",{onClick:t,className:"absolute top-4 right-4 w-8 h-8 flex items-center justify-center rounded-full bg-pink-100 hover:bg-pink-200 text-pink-600 transition-colors cursor-pointer","aria-label":"Close",children:""}),B.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.mood&&B.jsx("span",{className:"text-3xl",children:Av[n.mood]||""}),B.jsxs("div",{children:[B.jsx("h2",{className:"font-['Pacifico'] text-2xl text-[var(--color-text,#4A2040)]",children:n.title||"Untitled"}),B.jsx("p",{className:"font-['Poppins'] text-sm text-gray-400",children:e})]})]}),B.jsx("div",{className:"font-['Poppins'] text-[var(--color-text,#4A2040)] leading-relaxed whitespace-pre-wrap mb-4",children:Gdt(n.content)}),n.images&&n.images.length>0&&B.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:n.images.map((r,i)=>B.jsx("img",{src:r,alt:`Entry image ${i+1}`,className:"rounded-xl object-cover w-full h-32"},i))}),n.drawingURL&&B.jsxs("div",{className:"mb-4",children:[B.jsx("p",{className:"font-['Caveat'] text-lg text-gray-500 mb-1",children:"Drawing "}),B.jsx("img",{src:n.drawingURL,alt:"Drawing",className:"rounded-xl border border-pink-100 w-full"})]})]})})})}function Kdt(){const{user:n}=Rm(),[t,e]=L.useState(new Date),[r,i]=L.useState([]),[s,o]=L.useState(!0),[l,u]=L.useState(null),[h,d]=L.useState(!1),p=L.useCallback(async()=>{if(n){o(!0);try{const N=t.getFullYear(),q=t.getMonth(),M=await pht(n.uid,N,q);i(M)}catch(N){console.error("Failed to load calendar entries:",N),i([])}finally{o(!1)}}},[n,t]);L.useEffect(()=>{p()},[p]);const g=pB(t),v=dB(t),T=Kh(g),S=Ret(v),w=Det({start:T,end:S}),E=N=>r.find(q=>PI(q.date,N)),D=async N=>{const q=E(N);if(!(!q||!n))try{const M=await mU(q.entryId,n.uid);u(M),d(!0)}catch(M){console.error("Failed to load entry:",M)}},P=()=>e(N=>Rnt(N)),V=()=>e(N=>qC(N,1));return B.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[B.jsxs("div",{className:"flex items-center justify-between mb-6",children:[B.jsx("button",{onClick:P,className:"w-10 h-10 flex items-center justify-center rounded-full bg-white/80 shadow-sm border border-pink-100 hover:bg-pink-50 transition-colors cursor-pointer","aria-label":"Previous month",children:""}),B.jsxs("h1",{className:"font-['Pacifico'] text-2xl sm:text-3xl text-[var(--color-text,#4A2040)]",children:[Qp(t,"MMMM yyyy")," "]}),B.jsx("button",{onClick:V,className:"w-10 h-10 flex items-center justify-center rounded-full bg-white/80 shadow-sm border border-pink-100 hover:bg-pink-50 transition-colors cursor-pointer","aria-label":"Next month",children:""})]}),B.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:Wdt.map(N=>B.jsx("div",{className:"text-center font-['Poppins'] text-xs font-semibold text-gray-400 py-1",children:N},N))}),s?B.jsx("div",{className:"grid grid-cols-7 gap-1",children:Array.from({length:35}).map((N,q)=>B.jsx("div",{className:"aspect-square rounded-2xl bg-pink-50/50 animate-pulse"},q))}):B.jsx("div",{className:"grid grid-cols-7 gap-1",children:w.map(N=>{const q=Ont(N,t),M=E(N),k=PI(N,new Date);return B.jsxs(Cn.button,{whileHover:M?{scale:1.08}:{},whileTap:M?{scale:.95}:{},onClick:()=>D(N),className:`
                  aspect-square rounded-2xl flex flex-col items-center justify-center gap-1
                  transition-all text-sm font-['Poppins'] relative
                  ${q?"text-[var(--color-text,#4A2040)]":"text-gray-300"}
                  ${k?"ring-2 ring-pink-300 bg-pink-50":"bg-white/60"}
                  ${M?"cursor-pointer hover:shadow-md hover:bg-white":"cursor-default"}
                  shadow-sm border border-pink-50
                `,disabled:!M,children:[B.jsx("span",{className:`text-xs ${k?"font-bold":""}`,children:Qp(N,"d")}),M&&B.jsx("span",{className:`w-2.5 h-2.5 rounded-full ${qdt[M.mood]||"bg-gray-300"}`,title:M.mood})]},N.toISOString())})}),h&&l&&B.jsx(Ydt,{entry:l,onClose:()=>{d(!1),u(null)}})]})}function Xdt(){return B.jsx(wX,{children:B.jsx(M9,{children:B.jsxs(s9,{children:[B.jsx($a,{path:"/login",element:B.jsx(Tet,{})}),B.jsx($a,{element:B.jsx(CX,{}),children:B.jsxs($a,{element:B.jsx(EX,{}),children:[B.jsx($a,{path:"/dashboard",element:B.jsx(ort,{})}),B.jsx($a,{path:"/editor/:entryId?",element:B.jsx($dt,{})}),B.jsx($a,{path:"/calendar",element:B.jsx(Kdt,{})})]})}),B.jsx($a,{path:"*",element:B.jsx(yL,{to:"/dashboard",replace:!0})})]})})})}sH.createRoot(document.getElementById("root")).render(B.jsx(L.StrictMode,{children:B.jsx(Xdt,{})}));
